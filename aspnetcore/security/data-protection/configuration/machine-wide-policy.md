---
title: Stratégie de Protection des données à l’échelle de l’ordinateur prend en charge dans ASP.NET Core
author: rick-anderson
description: Découvrez la prise en charge pour la définition d’une stratégie de l’ordinateur par défaut pour toutes les applications qui utilisent la Protection des données ASP.NET Core.
ms.author: riande
ms.date: 10/14/2016
uid: security/data-protection/configuration/machine-wide-policy
ms.openlocfilehash: 70aaca7afcd3df22cebb4466fbd9845a2277688c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57055586"
---
# <a name="data-protection-machine-wide-policy-support-in-aspnet-core"></a><span data-ttu-id="4aba6-103">Stratégie de Protection des données à l’échelle de l’ordinateur prend en charge dans ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="4aba6-103">Data Protection machine-wide policy support in ASP.NET Core</span></span>

<span data-ttu-id="4aba6-104">Par [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="4aba6-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="4aba6-105">Lors de l’exécution sur Windows, le système de Protection des données prend en charge limitée pour la définition d’une stratégie de l’ordinateur par défaut pour toutes les applications qui utilisent la Protection des données ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4aba6-105">When running on Windows, the Data Protection system has limited support for setting a default machine-wide policy for all apps that consume ASP.NET Core Data Protection.</span></span> <span data-ttu-id="4aba6-106">L’idée générale est qu’un administrateur peut souhaiter modifier un paramètre par défaut, tels que les algorithmes utilisés ou la durée de vie des clés, sans avoir à mettre à jour manuellement chaque application sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="4aba6-106">The general idea is that an administrator might wish to change a default setting, such as the algorithms used or key lifetime, without the need to manually update every app on the machine.</span></span>

> [!WARNING]
> <span data-ttu-id="4aba6-107">L’administrateur système peut définir la stratégie par défaut, mais ils ne peuvent pas l’appliquer.</span><span class="sxs-lookup"><span data-stu-id="4aba6-107">The system administrator can set default policy, but they can't enforce it.</span></span> <span data-ttu-id="4aba6-108">Le développeur d’application peut toujours remplacer n’importe quelle valeur avec l’un de leurs propres choix.</span><span class="sxs-lookup"><span data-stu-id="4aba6-108">The app developer can always override any value with one of their own choosing.</span></span> <span data-ttu-id="4aba6-109">La stratégie par défaut affecte uniquement les applications où le développeur n’a pas spécifié une valeur explicite pour un paramètre.</span><span class="sxs-lookup"><span data-stu-id="4aba6-109">The default policy only affects apps where the developer hasn't specified an explicit value for a setting.</span></span>

## <a name="setting-default-policy"></a><span data-ttu-id="4aba6-110">Définition de la stratégie par défaut</span><span class="sxs-lookup"><span data-stu-id="4aba6-110">Setting default policy</span></span>

<span data-ttu-id="4aba6-111">Pour définir la stratégie par défaut, un administrateur peut définir des valeurs connues dans le Registre système sous la clé de Registre suivante :</span><span class="sxs-lookup"><span data-stu-id="4aba6-111">To set default policy, an administrator can set known values in the system registry under the following registry key:</span></span>

<span data-ttu-id="4aba6-112">**HKLM\SOFTWARE\Microsoft\DotNetPackages\Microsoft.AspNetCore.DataProtection**</span><span class="sxs-lookup"><span data-stu-id="4aba6-112">**HKLM\SOFTWARE\Microsoft\DotNetPackages\Microsoft.AspNetCore.DataProtection**</span></span>

<span data-ttu-id="4aba6-113">Si vous êtes sur un système d’exploitation 64 bits et que vous souhaitez affecter le comportement des applications 32 bits, pensez à configurer l’équivalent Wow6432Node de la clé ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="4aba6-113">If you're on a 64-bit operating system and want to affect the behavior of 32-bit apps, remember to configure the Wow6432Node equivalent of the above key.</span></span>

<span data-ttu-id="4aba6-114">Les valeurs prises en charge sont indiquées ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="4aba6-114">The supported values are shown below.</span></span>

| <span data-ttu-id="4aba6-115">Value</span><span class="sxs-lookup"><span data-stu-id="4aba6-115">Value</span></span>              | <span data-ttu-id="4aba6-116">Type</span><span class="sxs-lookup"><span data-stu-id="4aba6-116">Type</span></span>   | <span data-ttu-id="4aba6-117">Description</span><span class="sxs-lookup"><span data-stu-id="4aba6-117">Description</span></span> |
| ------------------ | :----: | ----------- |
| <span data-ttu-id="4aba6-118">EncryptionType</span><span class="sxs-lookup"><span data-stu-id="4aba6-118">EncryptionType</span></span>     | <span data-ttu-id="4aba6-119">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-119">string</span></span> | <span data-ttu-id="4aba6-120">Spécifie les algorithmes qui doivent être utilisés pour la protection des données.</span><span class="sxs-lookup"><span data-stu-id="4aba6-120">Specifies which algorithms should be used for data protection.</span></span> <span data-ttu-id="4aba6-121">La valeur doit être CNG-CBC, CNG-GCM ou géré et est décrite plus en détail ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="4aba6-121">The value must be CNG-CBC, CNG-GCM, or Managed and is described in more detail below.</span></span> |
| <span data-ttu-id="4aba6-122">DefaultKeyLifetime</span><span class="sxs-lookup"><span data-stu-id="4aba6-122">DefaultKeyLifetime</span></span> | <span data-ttu-id="4aba6-123">DWORD</span><span class="sxs-lookup"><span data-stu-id="4aba6-123">DWORD</span></span>  | <span data-ttu-id="4aba6-124">Spécifie la durée de vie des clés qui vient d’être généré.</span><span class="sxs-lookup"><span data-stu-id="4aba6-124">Specifies the lifetime for newly-generated keys.</span></span> <span data-ttu-id="4aba6-125">La valeur est spécifiée en jours et doit être > = 7.</span><span class="sxs-lookup"><span data-stu-id="4aba6-125">The value is specified in days and must be >= 7.</span></span> |
| <span data-ttu-id="4aba6-126">KeyEscrowSinks</span><span class="sxs-lookup"><span data-stu-id="4aba6-126">KeyEscrowSinks</span></span>     | <span data-ttu-id="4aba6-127">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-127">string</span></span> | <span data-ttu-id="4aba6-128">Spécifie les types qui sont utilisés pour le dépôt de clé.</span><span class="sxs-lookup"><span data-stu-id="4aba6-128">Specifies the types that are used for key escrow.</span></span> <span data-ttu-id="4aba6-129">La valeur est une liste délimitée par des points-virgules des récepteurs de dépôt de clé, où chaque élément dans la liste est le nom qualifié d’assembly d’un type qui implémente [IKeyEscrowSink](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink).</span><span class="sxs-lookup"><span data-stu-id="4aba6-129">The value is a semicolon-delimited list of key escrow sinks, where each element in the list is the assembly-qualified name of a type that implements [IKeyEscrowSink](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink).</span></span> |

## <a name="encryption-types"></a><span data-ttu-id="4aba6-130">Types de chiffrement</span><span class="sxs-lookup"><span data-stu-id="4aba6-130">Encryption types</span></span>

<span data-ttu-id="4aba6-131">Si EncryptionType est CNG-CBC, le système est configuré pour utiliser un chiffrement par bloc symétriques d’en mode CBC pour la confidentialité et HMAC authenticité avec les services fournis par Windows CNG (consultez [spécifiant les algorithmes CNG de Windows personnalisés](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) pour plus de détails).</span><span class="sxs-lookup"><span data-stu-id="4aba6-131">If EncryptionType is CNG-CBC, the system is configured to use a CBC-mode symmetric block cipher for confidentiality and HMAC for authenticity with services provided by Windows CNG (see [Specifying custom Windows CNG algorithms](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) for more details).</span></span> <span data-ttu-id="4aba6-132">Les valeurs supplémentaires suivantes sont prises en charge, chacun d’eux correspondant à une propriété sur le type CngCbcAuthenticatedEncryptionSettings.</span><span class="sxs-lookup"><span data-stu-id="4aba6-132">The following additional values are supported, each of which corresponds to a property on the CngCbcAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="4aba6-133">Value</span><span class="sxs-lookup"><span data-stu-id="4aba6-133">Value</span></span>                       | <span data-ttu-id="4aba6-134">Type</span><span class="sxs-lookup"><span data-stu-id="4aba6-134">Type</span></span>   | <span data-ttu-id="4aba6-135">Description</span><span class="sxs-lookup"><span data-stu-id="4aba6-135">Description</span></span> |
| --------------------------- | :----: | ----------- |
| <span data-ttu-id="4aba6-136">EncryptionAlgorithm</span><span class="sxs-lookup"><span data-stu-id="4aba6-136">EncryptionAlgorithm</span></span>         | <span data-ttu-id="4aba6-137">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-137">string</span></span> | <span data-ttu-id="4aba6-138">Le nom d’un algorithme de chiffrement symétrique compris par CNG.</span><span class="sxs-lookup"><span data-stu-id="4aba6-138">The name of a symmetric block cipher algorithm understood by CNG.</span></span> <span data-ttu-id="4aba6-139">Cet algorithme est ouvert en mode CBC.</span><span class="sxs-lookup"><span data-stu-id="4aba6-139">This algorithm is opened in CBC mode.</span></span> |
| <span data-ttu-id="4aba6-140">EncryptionAlgorithmProvider</span><span class="sxs-lookup"><span data-stu-id="4aba6-140">EncryptionAlgorithmProvider</span></span> | <span data-ttu-id="4aba6-141">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-141">string</span></span> | <span data-ttu-id="4aba6-142">Le nom de l’implémentation de fournisseur CNG qui peut produire l’algorithme EncryptionAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="4aba6-142">The name of the CNG provider implementation that can produce the algorithm EncryptionAlgorithm.</span></span> |
| <span data-ttu-id="4aba6-143">EncryptionAlgorithmKeySize</span><span class="sxs-lookup"><span data-stu-id="4aba6-143">EncryptionAlgorithmKeySize</span></span>  | <span data-ttu-id="4aba6-144">DWORD</span><span class="sxs-lookup"><span data-stu-id="4aba6-144">DWORD</span></span>  | <span data-ttu-id="4aba6-145">La longueur (en bits) de la clé à dériver pour l’algorithme de chiffrement par bloc symétriques.</span><span class="sxs-lookup"><span data-stu-id="4aba6-145">The length (in bits) of the key to derive for the symmetric block cipher algorithm.</span></span> |
| <span data-ttu-id="4aba6-146">Élément HashAlgorithm Impossible</span><span class="sxs-lookup"><span data-stu-id="4aba6-146">HashAlgorithm</span></span>               | <span data-ttu-id="4aba6-147">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-147">string</span></span> | <span data-ttu-id="4aba6-148">Le nom d’un algorithme de hachage compris par CNG.</span><span class="sxs-lookup"><span data-stu-id="4aba6-148">The name of a hash algorithm understood by CNG.</span></span> <span data-ttu-id="4aba6-149">Cet algorithme est ouvert en mode HMAC.</span><span class="sxs-lookup"><span data-stu-id="4aba6-149">This algorithm is opened in HMAC mode.</span></span> |
| <span data-ttu-id="4aba6-150">HashAlgorithmProvider</span><span class="sxs-lookup"><span data-stu-id="4aba6-150">HashAlgorithmProvider</span></span>       | <span data-ttu-id="4aba6-151">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-151">string</span></span> | <span data-ttu-id="4aba6-152">Le nom de l’implémentation de fournisseur CNG qui peut produire l’algorithme HashAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="4aba6-152">The name of the CNG provider implementation that can produce the algorithm HashAlgorithm.</span></span> |

<span data-ttu-id="4aba6-153">Si EncryptionType est CNG-GCM, le système est configuré pour utiliser un chiffrement par bloc symétriques de Mode Galois/compteur pour la confidentialité et l’authenticité avec les services fournis par Windows CNG (consultez [spécifiant les algorithmes CNG de Windows personnalisés](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) Pour plus d’informations.)</span><span class="sxs-lookup"><span data-stu-id="4aba6-153">If EncryptionType is CNG-GCM, the system is configured to use a Galois/Counter Mode symmetric block cipher for confidentiality and authenticity with services provided by Windows CNG (see [Specifying custom Windows CNG algorithms](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) for more details).</span></span> <span data-ttu-id="4aba6-154">Les valeurs supplémentaires suivantes sont prises en charge, chacun d’eux correspondant à une propriété sur le type CngGcmAuthenticatedEncryptionSettings.</span><span class="sxs-lookup"><span data-stu-id="4aba6-154">The following additional values are supported, each of which corresponds to a property on the CngGcmAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="4aba6-155">Value</span><span class="sxs-lookup"><span data-stu-id="4aba6-155">Value</span></span>                       | <span data-ttu-id="4aba6-156">Type</span><span class="sxs-lookup"><span data-stu-id="4aba6-156">Type</span></span>   | <span data-ttu-id="4aba6-157">Description</span><span class="sxs-lookup"><span data-stu-id="4aba6-157">Description</span></span> |
| --------------------------- | :----: | ----------- |
| <span data-ttu-id="4aba6-158">EncryptionAlgorithm</span><span class="sxs-lookup"><span data-stu-id="4aba6-158">EncryptionAlgorithm</span></span>         | <span data-ttu-id="4aba6-159">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-159">string</span></span> | <span data-ttu-id="4aba6-160">Le nom d’un algorithme de chiffrement symétrique compris par CNG.</span><span class="sxs-lookup"><span data-stu-id="4aba6-160">The name of a symmetric block cipher algorithm understood by CNG.</span></span> <span data-ttu-id="4aba6-161">Cet algorithme est ouvert en Mode de compteur/Galois.</span><span class="sxs-lookup"><span data-stu-id="4aba6-161">This algorithm is opened in Galois/Counter Mode.</span></span> |
| <span data-ttu-id="4aba6-162">EncryptionAlgorithmProvider</span><span class="sxs-lookup"><span data-stu-id="4aba6-162">EncryptionAlgorithmProvider</span></span> | <span data-ttu-id="4aba6-163">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-163">string</span></span> | <span data-ttu-id="4aba6-164">Le nom de l’implémentation de fournisseur CNG qui peut produire l’algorithme EncryptionAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="4aba6-164">The name of the CNG provider implementation that can produce the algorithm EncryptionAlgorithm.</span></span> |
| <span data-ttu-id="4aba6-165">EncryptionAlgorithmKeySize</span><span class="sxs-lookup"><span data-stu-id="4aba6-165">EncryptionAlgorithmKeySize</span></span>  | <span data-ttu-id="4aba6-166">DWORD</span><span class="sxs-lookup"><span data-stu-id="4aba6-166">DWORD</span></span>  | <span data-ttu-id="4aba6-167">La longueur (en bits) de la clé à dériver pour l’algorithme de chiffrement par bloc symétriques.</span><span class="sxs-lookup"><span data-stu-id="4aba6-167">The length (in bits) of the key to derive for the symmetric block cipher algorithm.</span></span> |

<span data-ttu-id="4aba6-168">Si EncryptionType est géré, le système est configuré pour utiliser un SymmetricAlgorithm géré pour la confidentialité et l’élément KeyedHashAlgorithm impossible pour l’authenticité (consultez [spécification personnalisé géré algorithmes](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) pour plus d’informations).</span><span class="sxs-lookup"><span data-stu-id="4aba6-168">If EncryptionType is Managed, the system is configured to use a managed SymmetricAlgorithm for confidentiality and KeyedHashAlgorithm for authenticity (see [Specifying custom managed algorithms](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) for more details).</span></span> <span data-ttu-id="4aba6-169">Les valeurs supplémentaires suivantes sont prises en charge, chacun d’eux correspondant à une propriété sur le type ManagedAuthenticatedEncryptionSettings.</span><span class="sxs-lookup"><span data-stu-id="4aba6-169">The following additional values are supported, each of which corresponds to a property on the ManagedAuthenticatedEncryptionSettings type.</span></span>

| <span data-ttu-id="4aba6-170">Value</span><span class="sxs-lookup"><span data-stu-id="4aba6-170">Value</span></span>                      | <span data-ttu-id="4aba6-171">Type</span><span class="sxs-lookup"><span data-stu-id="4aba6-171">Type</span></span>   | <span data-ttu-id="4aba6-172">Description</span><span class="sxs-lookup"><span data-stu-id="4aba6-172">Description</span></span> |
| -------------------------- | :----: | ----------- |
| <span data-ttu-id="4aba6-173">EncryptionAlgorithmType</span><span class="sxs-lookup"><span data-stu-id="4aba6-173">EncryptionAlgorithmType</span></span>    | <span data-ttu-id="4aba6-174">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-174">string</span></span> | <span data-ttu-id="4aba6-175">Le nom qualifié d’assembly d’un type qui implémente SymmetricAlgorithm.</span><span class="sxs-lookup"><span data-stu-id="4aba6-175">The assembly-qualified name of a type that implements SymmetricAlgorithm.</span></span> |
| <span data-ttu-id="4aba6-176">EncryptionAlgorithmKeySize</span><span class="sxs-lookup"><span data-stu-id="4aba6-176">EncryptionAlgorithmKeySize</span></span> | <span data-ttu-id="4aba6-177">DWORD</span><span class="sxs-lookup"><span data-stu-id="4aba6-177">DWORD</span></span>  | <span data-ttu-id="4aba6-178">La longueur (en bits) de la clé à dériver pour l’algorithme de chiffrement symétrique.</span><span class="sxs-lookup"><span data-stu-id="4aba6-178">The length (in bits) of the key to derive for the symmetric encryption algorithm.</span></span> |
| <span data-ttu-id="4aba6-179">ValidationAlgorithmType</span><span class="sxs-lookup"><span data-stu-id="4aba6-179">ValidationAlgorithmType</span></span>    | <span data-ttu-id="4aba6-180">string</span><span class="sxs-lookup"><span data-stu-id="4aba6-180">string</span></span> | <span data-ttu-id="4aba6-181">Le nom qualifié d’assembly d’un type qui implémente l’élément KeyedHashAlgorithm impossible.</span><span class="sxs-lookup"><span data-stu-id="4aba6-181">The assembly-qualified name of a type that implements KeyedHashAlgorithm.</span></span> |

<span data-ttu-id="4aba6-182">Si EncryptionType a toute autre valeur différente de null ou vide, le système de Protection de données lève une exception au démarrage.</span><span class="sxs-lookup"><span data-stu-id="4aba6-182">If EncryptionType has any other value other than null or empty, the Data Protection system throws an exception at startup.</span></span>

> [!WARNING]
> <span data-ttu-id="4aba6-183">Lorsque vous configurez un paramètre de stratégie par défaut qui implique des noms de types (EncryptionAlgorithmType, ValidationAlgorithmType, KeyEscrowSinks), les types doivent être disponibles pour l’application.</span><span class="sxs-lookup"><span data-stu-id="4aba6-183">When configuring a default policy setting that involves type names (EncryptionAlgorithmType, ValidationAlgorithmType, KeyEscrowSinks), the types must be available to the app.</span></span> <span data-ttu-id="4aba6-184">Cela signifie que pour les applications qui s’exécutent sur le CLR de bureau, les assemblys qui contiennent ces types doivent figurer dans le Global Assembly Cache (GAC).</span><span class="sxs-lookup"><span data-stu-id="4aba6-184">This means that for apps running on Desktop CLR, the assemblies that contain these types should be present in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="4aba6-185">Pour les applications ASP.NET Core s’exécutant sur .NET Core, les packages qui contiennent ces types doivent être installés.</span><span class="sxs-lookup"><span data-stu-id="4aba6-185">For ASP.NET Core apps running on .NET Core, the packages that contain these types should be installed.</span></span>
