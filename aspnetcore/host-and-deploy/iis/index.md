---
title: Héberger ASP.NET Core sur Windows avec IIS
author: guardrex
description: Découvrez comment héberger des applications ASP.NET Core sur Windows Server Internet Information Services (IIS).
ms.author: riande
ms.custom: mvc
ms.date: 02/19/2019
uid: host-and-deploy/iis/index
---
# <a name="host-aspnet-core-on-windows-with-iis"></a><span data-ttu-id="50a1a-103">Héberger ASP.NET Core sur Windows avec IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-103">Host ASP.NET Core on Windows with IIS</span></span>

<span data-ttu-id="50a1a-104">Par [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="50a1a-104">By [Luke Latham](https://github.com/guardrex)</span></span>

[<span data-ttu-id="50a1a-105">Installer le bundle d’hébergement .NET Core</span><span class="sxs-lookup"><span data-stu-id="50a1a-105">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="50a1a-106">Systèmes d'exploitation pris en charge</span><span class="sxs-lookup"><span data-stu-id="50a1a-106">Supported operating systems</span></span>

<span data-ttu-id="50a1a-107">Les systèmes d’exploitation suivants sont pris en charge :</span><span class="sxs-lookup"><span data-stu-id="50a1a-107">The following operating systems are supported:</span></span>

* <span data-ttu-id="50a1a-108">Windows 7 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-108">Windows 7 or later</span></span>
* <span data-ttu-id="50a1a-109">Windows Server 2008 R2 ou une version ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-109">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="50a1a-110">Le [serveur HTTP.sys](xref:fundamentals/servers/httpsys) (anciennement WebListener) ne fonctionne pas dans une configuration de proxy inverse avec IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-110">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="50a1a-111">Utilisez le [serveur Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="50a1a-111">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="50a1a-112">Pour plus d’informations sur l’hébergement dans Azure, consultez <xref:host-and-deploy/azure-apps/index>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-112">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="50a1a-113">Plateformes prises en charge</span><span class="sxs-lookup"><span data-stu-id="50a1a-113">Supported platforms</span></span>

<span data-ttu-id="50a1a-114">Les applications publiées pour les déploiements 32 bits (x86) et 64 bits (x64) sont prises en charge.</span><span class="sxs-lookup"><span data-stu-id="50a1a-114">Apps published for 32-bit (x86) and 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="50a1a-115">Déployez une application 32 bits, sauf si l’application :</span><span class="sxs-lookup"><span data-stu-id="50a1a-115">Deploy a 32-bit app unless the app:</span></span>

* <span data-ttu-id="50a1a-116">Nécessite l’espace d’adressage de mémoire virtuelle le plus grand disponible pour une application 64 bits.</span><span class="sxs-lookup"><span data-stu-id="50a1a-116">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="50a1a-117">Nécessite la taille de pile IIS la plus grande disponible.</span><span class="sxs-lookup"><span data-stu-id="50a1a-117">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="50a1a-118">A des dépendances natives 64 bits.</span><span class="sxs-lookup"><span data-stu-id="50a1a-118">Has 64-bit native dependencies.</span></span>

## <a name="application-configuration"></a><span data-ttu-id="50a1a-119">Configuration d’application</span><span class="sxs-lookup"><span data-stu-id="50a1a-119">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="50a1a-120">Activer les composants IISIntegration</span><span class="sxs-lookup"><span data-stu-id="50a1a-120">Enable the IISIntegration components</span></span>

::: moniker range=">= aspnetcore-2.1"

<span data-ttu-id="50a1a-121">Un fichier *Program.cs* standard appelle <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> pour commencer à configurer un hôte :</span><span class="sxs-lookup"><span data-stu-id="50a1a-121">A typical *Program.cs* calls <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> to begin setting up a host:</span></span>

```csharp
public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

::: moniker-end

::: moniker range="= aspnetcore-2.0"

<span data-ttu-id="50a1a-122">Un fichier *Program.cs* standard appelle <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> pour commencer à configurer un hôte :</span><span class="sxs-lookup"><span data-stu-id="50a1a-122">A typical *Program.cs* calls <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> to begin setting up a host:</span></span>

```csharp
public static IWebHost BuildWebHost(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

::: moniker-end

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="50a1a-123">**Modèle d’hébergement in-process**</span><span class="sxs-lookup"><span data-stu-id="50a1a-123">**In-process hosting model**</span></span>

<span data-ttu-id="50a1a-124">`CreateDefaultBuilder` appelle la méthode `UseIIS` pour démarrer le [CoreCLR](/dotnet/standard/glossary#coreclr) et héberger l’application à l’intérieur du processus Worker (*w3wp.exe* ou *iisexpress.exe*).</span><span class="sxs-lookup"><span data-stu-id="50a1a-124">`CreateDefaultBuilder` calls the `UseIIS` method to boot the [CoreCLR](/dotnet/standard/glossary#coreclr) and host the app inside of the IIS worker process (*w3wp.exe* or *iisexpress.exe*).</span></span> <span data-ttu-id="50a1a-125">Les tests de performance indiquent que l’hébergement d’une application.NET Core in-process fournit un débit de requêtes beaucoup plus élevé que l’hébergement de l’application out-of-process et la redirection par le biais d’un proxy des requêtes vers le serveur [Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="50a1a-125">Performance tests indicate that hosting a .NET Core app in-process delivers significantly higher request throughput compared to hosting the app out-of-process and proxying requests to [Kestrel](xref:fundamentals/servers/kestrel) server.</span></span>

<span data-ttu-id="50a1a-126">Le modèle d’hébergement in-process n’est pas pris en charge pour les applications ASP.NET Core qui ciblent le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="50a1a-126">The in-process hosting model isn't supported for ASP.NET Core apps that target the .NET Framework.</span></span>

<span data-ttu-id="50a1a-127">**Modèle d’hébergement out-of-process**</span><span class="sxs-lookup"><span data-stu-id="50a1a-127">**Out-of-process hosting model**</span></span>

<span data-ttu-id="50a1a-128">Pour l’hébergement out-of-process avec IIS, `CreateDefaultBuilder` configure le serveur [Kestrel](xref:fundamentals/servers/kestrel) comme serveur web et permet l’intégration IIS en configurant le chemin de base et le port du [module ASP.NET Core ](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="50a1a-128">For out-of-process hosting with IIS, `CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) server as the web server and enables IIS Integration by configuring the base path and port for the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="50a1a-129">Le module ASP.NET Core génère un port dynamique à assigner au processus backend.</span><span class="sxs-lookup"><span data-stu-id="50a1a-129">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="50a1a-130">`CreateDefaultBuilder` appelle la méthode <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-130">`CreateDefaultBuilder` calls the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> method.</span></span> <span data-ttu-id="50a1a-131">`UseIISIntegration` configure Kestrel pour écouter sur le port dynamique à l’adresse IP localhost (`127.0.0.1`).</span><span class="sxs-lookup"><span data-stu-id="50a1a-131">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`127.0.0.1`).</span></span> <span data-ttu-id="50a1a-132">Si le port dynamique est 1234, Kestrel écoute sur `127.0.0.1:1234`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-132">If the dynamic port is 1234, Kestrel listens at `127.0.0.1:1234`.</span></span> <span data-ttu-id="50a1a-133">Cette configuration remplace les autres configurations URL fournies par :</span><span class="sxs-lookup"><span data-stu-id="50a1a-133">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* [<span data-ttu-id="50a1a-134">API d’écoute Kestrel</span><span class="sxs-lookup"><span data-stu-id="50a1a-134">Kestrel's Listen API</span></span>](xref:fundamentals/servers/kestrel#endpoint-configuration)
* <span data-ttu-id="50a1a-135">[Configuration](xref:fundamentals/configuration/index) (ou [options --url de ligne de commande](xref:fundamentals/host/web-host#override-configuration))</span><span class="sxs-lookup"><span data-stu-id="50a1a-135">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="50a1a-136">L’utilisation du module évite les appels à `UseUrls` ou à l’API `Listen` de Kestrel.</span><span class="sxs-lookup"><span data-stu-id="50a1a-136">Calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="50a1a-137">Si `UseUrls` ou `Listen` est appelé, Kestrel écoute sur les ports spécifiés uniquement lors de l’exécution de l’application sans IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-137">If `UseUrls` or `Listen` is called, Kestrel listens on the ports specified only when running the app without IIS.</span></span>

<span data-ttu-id="50a1a-138">Pour plus d’informations sur les modèles d’hébergement in-process et out-of-process, consultez [Module ASP.NET Core](xref:host-and-deploy/aspnet-core-module) et [Informations de référence sur la configuration du module ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="50a1a-138">For more information on the in-process and out-of-process hosting models, see [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module).</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.1"

<span data-ttu-id="50a1a-139">`CreateDefaultBuilder` configure le serveur [Kestrel](xref:fundamentals/servers/kestrel) comme serveur web et active l’intégration d’IIS en configurant le chemin et le port de base pour le [module ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="50a1a-139">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) server as the web server and enables IIS Integration by configuring the base path and port for the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="50a1a-140">Le module ASP.NET Core génère un port dynamique à assigner au processus backend.</span><span class="sxs-lookup"><span data-stu-id="50a1a-140">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="50a1a-141">`CreateDefaultBuilder` appelle la méthode <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-141">`CreateDefaultBuilder` calls the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> method.</span></span> <span data-ttu-id="50a1a-142">`UseIISIntegration` configure Kestrel pour écouter sur le port dynamique à l’adresse IP localhost (`127.0.0.1`).</span><span class="sxs-lookup"><span data-stu-id="50a1a-142">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`127.0.0.1`).</span></span> <span data-ttu-id="50a1a-143">Si le port dynamique est 1234, Kestrel écoute sur `127.0.0.1:1234`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-143">If the dynamic port is 1234, Kestrel listens at `127.0.0.1:1234`.</span></span> <span data-ttu-id="50a1a-144">Cette configuration remplace les autres configurations URL fournies par :</span><span class="sxs-lookup"><span data-stu-id="50a1a-144">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* [<span data-ttu-id="50a1a-145">API d’écoute Kestrel</span><span class="sxs-lookup"><span data-stu-id="50a1a-145">Kestrel's Listen API</span></span>](xref:fundamentals/servers/kestrel#endpoint-configuration)
* <span data-ttu-id="50a1a-146">[Configuration](xref:fundamentals/configuration/index) (ou [options --url de ligne de commande](xref:fundamentals/host/web-host#override-configuration))</span><span class="sxs-lookup"><span data-stu-id="50a1a-146">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="50a1a-147">L’utilisation du module évite les appels à `UseUrls` ou à l’API `Listen` de Kestrel.</span><span class="sxs-lookup"><span data-stu-id="50a1a-147">Calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="50a1a-148">Si `UseUrls` ou `Listen` est appelé, Kestrel écoute sur le port spécifié uniquement lors de l’exécution de l’application sans IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-148">If `UseUrls` or `Listen` is called, Kestrel listens on the port specified only when running the app without IIS.</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.0"

<span data-ttu-id="50a1a-149">`CreateDefaultBuilder` configure le serveur [Kestrel](xref:fundamentals/servers/kestrel) comme serveur web et active l’intégration d’IIS en configurant le chemin et le port de base pour le [module ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="50a1a-149">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) server as the web server and enables IIS Integration by configuring the base path and port for the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="50a1a-150">Le module ASP.NET Core génère un port dynamique à assigner au processus backend.</span><span class="sxs-lookup"><span data-stu-id="50a1a-150">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="50a1a-151">`CreateDefaultBuilder` appelle la méthode <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-151">`CreateDefaultBuilder` calls the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> method.</span></span> <span data-ttu-id="50a1a-152">`UseIISIntegration` configure Kestrel pour écouter sur le port dynamique à l’adresse IP localhost (`localhost`).</span><span class="sxs-lookup"><span data-stu-id="50a1a-152">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`localhost`).</span></span> <span data-ttu-id="50a1a-153">Si le port dynamique est 1234, Kestrel écoute sur `localhost:1234`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-153">If the dynamic port is 1234, Kestrel listens at `localhost:1234`.</span></span> <span data-ttu-id="50a1a-154">Cette configuration remplace les autres configurations URL fournies par :</span><span class="sxs-lookup"><span data-stu-id="50a1a-154">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* [<span data-ttu-id="50a1a-155">API d’écoute Kestrel</span><span class="sxs-lookup"><span data-stu-id="50a1a-155">Kestrel's Listen API</span></span>](xref:fundamentals/servers/kestrel#endpoint-configuration)
* <span data-ttu-id="50a1a-156">[Configuration](xref:fundamentals/configuration/index) (ou [options --url de ligne de commande](xref:fundamentals/host/web-host#override-configuration))</span><span class="sxs-lookup"><span data-stu-id="50a1a-156">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="50a1a-157">L’utilisation du module évite les appels à `UseUrls` ou à l’API `Listen` de Kestrel.</span><span class="sxs-lookup"><span data-stu-id="50a1a-157">Calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="50a1a-158">Si `UseUrls` ou `Listen` est appelé, Kestrel écoute sur le port spécifié uniquement lors de l’exécution de l’application sans IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-158">If `UseUrls` or `Listen` is called, Kestrel listens on the port specified only when running the app without IIS.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.0"

<span data-ttu-id="50a1a-159">Incluez une dépendance envers le package [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) dans les dépendances de l’application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-159">Include a dependency on the [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) package in the app's dependencies.</span></span> <span data-ttu-id="50a1a-160">Utilisez l’intergiciel (middleware) d’intégration IIS en ajoutant la méthode d’extension <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> à <xref:Microsoft.AspNetCore.Hosting.WebHostBuilder> :</span><span class="sxs-lookup"><span data-stu-id="50a1a-160">Use IIS Integration middleware by adding the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> extension method to <xref:Microsoft.AspNetCore.Hosting.WebHostBuilder>:</span></span>

```csharp
var host = new WebHostBuilder()
    .UseKestrel()
    .UseIISIntegration()
    ...
```

<span data-ttu-id="50a1a-161"><xref:Microsoft.AspNetCore.Hosting.WebHostBuilderKestrelExtensions.UseKestrel*> et <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> sont tous deux obligatoires.</span><span class="sxs-lookup"><span data-stu-id="50a1a-161">Both <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderKestrelExtensions.UseKestrel*> and <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> are required.</span></span> <span data-ttu-id="50a1a-162">Le code qui appelle `UseIISIntegration` n’affecte pas la portabilité du code.</span><span class="sxs-lookup"><span data-stu-id="50a1a-162">Code calling `UseIISIntegration` doesn't affect code portability.</span></span> <span data-ttu-id="50a1a-163">Si l’application n’est pas exécutée derrière IIS (par exemple si l’application est exécutée directement sur Kestrel), `UseIISIntegration` n’effectue pas d’opérations.</span><span class="sxs-lookup"><span data-stu-id="50a1a-163">If the app isn't run behind IIS (for example, the app is run directly on Kestrel), `UseIISIntegration` doesn't operate.</span></span>

<span data-ttu-id="50a1a-164">Le module ASP.NET Core génère un port dynamique à assigner au processus backend.</span><span class="sxs-lookup"><span data-stu-id="50a1a-164">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="50a1a-165">`UseIISIntegration` configure Kestrel pour écouter sur le port dynamique à l’adresse IP localhost (`localhost`).</span><span class="sxs-lookup"><span data-stu-id="50a1a-165">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`localhost`).</span></span> <span data-ttu-id="50a1a-166">Si le port dynamique est 1234, Kestrel écoute sur `localhost:1234`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-166">If the dynamic port is 1234, Kestrel listens at `localhost:1234`.</span></span> <span data-ttu-id="50a1a-167">Cette configuration remplace les autres configurations URL fournies par :</span><span class="sxs-lookup"><span data-stu-id="50a1a-167">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* <span data-ttu-id="50a1a-168">[Configuration](xref:fundamentals/configuration/index) (ou [options --url de ligne de commande](xref:fundamentals/host/web-host#override-configuration))</span><span class="sxs-lookup"><span data-stu-id="50a1a-168">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="50a1a-169">L’utilisation du module rend inutile tout appel à `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-169">A call to `UseUrls` isn't required when using the module.</span></span> <span data-ttu-id="50a1a-170">Si `UseUrls` est appelé, Kestrel écoute sur le port spécifié uniquement lors de l’exécution de l’application sans IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-170">If `UseUrls` is called, Kestrel listens on the port specified only when running the app without IIS.</span></span>

<span data-ttu-id="50a1a-171">Si `UseUrls` est appelé dans une application ASP.NET Core 1.0, appelez-le **avant** d’appeler `UseIISIntegration` pour que le port configuré par le module ne soit pas remplacé.</span><span class="sxs-lookup"><span data-stu-id="50a1a-171">If `UseUrls` is called in an ASP.NET Core 1.0 app, call it **before** calling `UseIISIntegration` so that the module-configured port isn't overwritten.</span></span> <span data-ttu-id="50a1a-172">Cet ordre d’appel est inutile avec ASP.NET Core 1.1, car le paramètre du module remplace `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-172">This calling order isn't required with ASP.NET Core 1.1 because the module setting overrides `UseUrls`.</span></span>

::: moniker-end

<span data-ttu-id="50a1a-173">Pour plus d’informations sur l’hébergement, consultez [Héberger dans ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="50a1a-173">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

### <a name="iis-options"></a><span data-ttu-id="50a1a-174">Options IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-174">IIS options</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="50a1a-175">**Modèle d’hébergement in-process**</span><span class="sxs-lookup"><span data-stu-id="50a1a-175">**In-process hosting model**</span></span>

<span data-ttu-id="50a1a-176">Pour configurer les options IIS Server, incluez une configuration de service pour <xref:Microsoft.AspNetCore.Builder.IISServerOptions> dans <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-176">To configure IIS Server options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="50a1a-177">L’exemple suivant désactive AutomaticAuthentication :</span><span class="sxs-lookup"><span data-stu-id="50a1a-177">The following example disables AutomaticAuthentication:</span></span>

```csharp
services.Configure<IISServerOptions>(options => 
{
    options.AutomaticAuthentication = false;
});
```

| <span data-ttu-id="50a1a-178">Option</span><span class="sxs-lookup"><span data-stu-id="50a1a-178">Option</span></span>                         | <span data-ttu-id="50a1a-179">Par défaut</span><span class="sxs-lookup"><span data-stu-id="50a1a-179">Default</span></span> | <span data-ttu-id="50a1a-180">Paramètre</span><span class="sxs-lookup"><span data-stu-id="50a1a-180">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="50a1a-181">Si `true`, IIS Server définit le `HttpContext.User` authentifié par [Authentification Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="50a1a-181">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="50a1a-182">Si `false`, le serveur fournit uniquement une identité pour `HttpContext.User` et répond aux questions explicitement posées par `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-182">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="50a1a-183">L’authentification Windows doit être activée dans IIS pour que `AutomaticAuthentication` fonctionne.</span><span class="sxs-lookup"><span data-stu-id="50a1a-183">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="50a1a-184">Pour plus d’informations, consultez [Authentification Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="50a1a-184">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="50a1a-185">Définit le nom d’affichage montré aux utilisateurs sur les pages de connexion.</span><span class="sxs-lookup"><span data-stu-id="50a1a-185">Sets the display name shown to users on login pages.</span></span> |

<span data-ttu-id="50a1a-186">**Modèle d’hébergement out-of-process**</span><span class="sxs-lookup"><span data-stu-id="50a1a-186">**Out-of-process hosting model**</span></span>

::: moniker-end

<span data-ttu-id="50a1a-187">Pour configurer les options IIS, incluez une configuration de service pour <xref:Microsoft.AspNetCore.Builder.IISOptions> dans <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-187">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="50a1a-188">L’exemple suivant empêche l’application d’être renseignée `HttpContext.Connection.ClientCertificate` :</span><span class="sxs-lookup"><span data-stu-id="50a1a-188">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="50a1a-189">Option</span><span class="sxs-lookup"><span data-stu-id="50a1a-189">Option</span></span>                         | <span data-ttu-id="50a1a-190">Par défaut</span><span class="sxs-lookup"><span data-stu-id="50a1a-190">Default</span></span> | <span data-ttu-id="50a1a-191">Paramètre</span><span class="sxs-lookup"><span data-stu-id="50a1a-191">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="50a1a-192">Si `true`, l’Intergiciel (Middleware) d’intégration IIS définit le `HttpContext.User` authentifié par [Authentification Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="50a1a-192">If `true`, IIS Integration Middleware sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="50a1a-193">Si `false`, l’intergiciel (middleware) fournit uniquement une identité pour `HttpContext.User` et répond aux questions explicitement posées par `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-193">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="50a1a-194">L’authentification Windows doit être activée dans IIS pour que `AutomaticAuthentication` fonctionne.</span><span class="sxs-lookup"><span data-stu-id="50a1a-194">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="50a1a-195">Pour plus d'informations, consultez la rubrique [Authentification Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="50a1a-195">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="50a1a-196">Définit le nom d’affichage montré aux utilisateurs sur les pages de connexion.</span><span class="sxs-lookup"><span data-stu-id="50a1a-196">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="50a1a-197">Si la valeur est `true` et que l’en-tête de requête `MS-ASPNETCORE-CLIENTCERT` est présent, `HttpContext.Connection.ClientCertificate` est renseigné.</span><span class="sxs-lookup"><span data-stu-id="50a1a-197">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="50a1a-198">Scénarios avec un serveur proxy et un équilibreur de charge</span><span class="sxs-lookup"><span data-stu-id="50a1a-198">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="50a1a-199">L’intergiciel (middleware) d’intégration IIS, qui configure l’intergiciel des en-têtes transférés, et le module ASP.NET Core, sont configurés pour transférer le schéma (HTTP/HTTPS) et l’adresse IP distante d’où provient la requête.</span><span class="sxs-lookup"><span data-stu-id="50a1a-199">The IIS Integration Middleware, which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="50a1a-200">Une configuration supplémentaire peut être nécessaire pour les applications hébergées derrière des serveurs proxy et des équilibreurs de charge supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="50a1a-200">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="50a1a-201">Pour plus d’informations, consultez [Configurer ASP.NET Core pour l’utilisation de serveurs proxy et d’équilibreurs de charge](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="50a1a-201">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="50a1a-202">fichier web.config</span><span class="sxs-lookup"><span data-stu-id="50a1a-202">web.config file</span></span>

<span data-ttu-id="50a1a-203">Le fichier *web.config* configure le [Module ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="50a1a-203">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="50a1a-204">La création, la transformation et la publication du fichier *web.config* sont gérées par une cible MSBuild (`_TransformWebConfig`) quand le projet est publié.</span><span class="sxs-lookup"><span data-stu-id="50a1a-204">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="50a1a-205">Cette cible est présente dans les cibles du SDK web (`Microsoft.NET.Sdk.Web`).</span><span class="sxs-lookup"><span data-stu-id="50a1a-205">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="50a1a-206">Le SDK est défini en haut du fichier projet :</span><span class="sxs-lookup"><span data-stu-id="50a1a-206">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="50a1a-207">Si le projet ne contient pas de fichier *web.config*, le fichier est créé avec le *processPath* et les *arguments* corrects pour configurer le [Module ASP.NET Core](xref:host-and-deploy/aspnet-core-module), puis il est déplacé vers la [sortie publiée](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="50a1a-207">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="50a1a-208">Si un fichier *web.config* se trouve dans le projet, il est transformé avec le *processPath* et les *arguments* corrects pour configurer le Module ASP.NET Core, puis il est déplacé vers la sortie publiée.</span><span class="sxs-lookup"><span data-stu-id="50a1a-208">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="50a1a-209">La transformation ne modifie pas les paramètres de configuration IIS dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="50a1a-209">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="50a1a-210">Le fichier *web.config* peut fournir des paramètres de configuration IIS supplémentaires qui contrôlent les modules IIS actifs.</span><span class="sxs-lookup"><span data-stu-id="50a1a-210">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="50a1a-211">Pour plus d’informations sur les modules IIS capables de traiter les requêtes avec des applications ASP.NET Core, consultez la rubrique [Modules IIS](xref:host-and-deploy/iis/modules).</span><span class="sxs-lookup"><span data-stu-id="50a1a-211">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="50a1a-212">Pour empêcher le Kit de développement logiciel (SDK) Web de transformer le fichier *web.config*, ajoutez la propriété **\<IsTransformWebConfigDisabled>** au fichier projet :</span><span class="sxs-lookup"><span data-stu-id="50a1a-212">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="50a1a-213">Lorsque vous désactivez le Kit de développement logiciel (SDK) Web en transformant le fichier, le *processPath* et les *arguments* doivent être définis manuellement par le développeur.</span><span class="sxs-lookup"><span data-stu-id="50a1a-213">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="50a1a-214">Pour plus d’informations, consultez les [Informations de référence sur la configuration du module ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="50a1a-214">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module).</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="50a1a-215">emplacement du fichier web.config</span><span class="sxs-lookup"><span data-stu-id="50a1a-215">web.config file location</span></span>

<span data-ttu-id="50a1a-216">Pour configurer le [module ASP.NET Core](xref:host-and-deploy/aspnet-core-module) correctement, le fichier *web.config* doit être présent dans le chemin de racine de contenu (généralement le chemin de base de l’application) de l’application déployée.</span><span class="sxs-lookup"><span data-stu-id="50a1a-216">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the content root path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="50a1a-217">Il s’agit du même emplacement que le chemin physique du site Web fourni à IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-217">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="50a1a-218">Le fichier *web.config* est nécessaire à la racine de l’application pour permettre la publication de plusieurs applications à l’aide de Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="50a1a-218">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="50a1a-219">Il existe des fichiers sensibles sur le chemin physique de l’application, notamment *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (commentaires de documentation XML) et *\<assembly>.deps.json*.</span><span class="sxs-lookup"><span data-stu-id="50a1a-219">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json*.</span></span> <span data-ttu-id="50a1a-220">Lorsque le fichier *web.config* est présent et que le site démarre normalement, IIS ne traite pas ces fichiers sensibles s’ils sont requis.</span><span class="sxs-lookup"><span data-stu-id="50a1a-220">When the *web.config* file is present and and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="50a1a-221">Si le fichier *web.config* est absent, nommé de manière incorrecte ou s’il est incapable de configurer le site pour un démarrage normal, IIS peut traiter des fichiers sensibles publiquement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-221">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="50a1a-222">**Le fichier *web.config* doit être présent dans le déploiement en permanence, correctement nommé et capable de configurer le site pour un démarrage normal. Ne retirez jamais le fichier *web.config* d’un déploiement de production.**</span><span class="sxs-lookup"><span data-stu-id="50a1a-222">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="50a1a-223">Transformer web.config</span><span class="sxs-lookup"><span data-stu-id="50a1a-223">Transform web.config</span></span>

<span data-ttu-id="50a1a-224">Si vous devez transformer *web.config* lors de la publication (par exemple, définir les variables d’environnement basées sur la configuration, le profil ou l’environnement), consultez <xref:host-and-deploy/iis/transform-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-224">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="50a1a-225">Configuration d’IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-225">IIS configuration</span></span>

<span data-ttu-id="50a1a-226">**Systèmes d’exploitation Windows Server**</span><span class="sxs-lookup"><span data-stu-id="50a1a-226">**Windows Server operating systems**</span></span>

<span data-ttu-id="50a1a-227">Activez le rôle serveur **Serveur Web (IIS)** et établissez des services de rôle.</span><span class="sxs-lookup"><span data-stu-id="50a1a-227">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="50a1a-228">Utilisez l’Assistant **Ajouter des rôles et des fonctionnalités** par le biais du menu **Gérer** ou du lien dans **Gestionnaire de serveur**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-228">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="50a1a-229">À l’étape **Rôles de serveurs**, cochez la case **Serveur Web (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-229">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

   ![Le rôle Serveur Web IIS est sélectionné à l’étape Sélectionner des rôles de serveurs.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="50a1a-231">Après l’étape **Fonctionnalités**, l’étape **Services de rôle** se charge pour le serveur Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="50a1a-231">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="50a1a-232">Sélectionnez les services de rôle IIS souhaités ou acceptez les services de rôle par défaut fournis.</span><span class="sxs-lookup"><span data-stu-id="50a1a-232">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Les services de rôle par défaut sont sélectionnés à l’étape Sélectionner des services de rôle.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="50a1a-234">**Authentification Windows (facultatif)**</span><span class="sxs-lookup"><span data-stu-id="50a1a-234">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="50a1a-235">Pour activer l’authentification Windows, développez les nœuds suivants : **Serveur web** > **Sécurité**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-235">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security**.</span></span> <span data-ttu-id="50a1a-236">Sélectionnez la fonctionnalité **Authentification Windows**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-236">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="50a1a-237">Pour plus d’informations, consultez [Authentification Windows\<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) et [Configurer l’authentification Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="50a1a-237">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="50a1a-238">**WebSockets (facultatif)**</span><span class="sxs-lookup"><span data-stu-id="50a1a-238">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="50a1a-239">WebSockets est pris en charge avec ASP.NET Core 1.1 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="50a1a-239">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="50a1a-240">Pour activer WebSockets, développez les nœuds suivants : **Serveur web** > **Développement d’applications**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-240">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development**.</span></span> <span data-ttu-id="50a1a-241">Sélectionnez la fonctionnalité **Protocole WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-241">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="50a1a-242">Pour plus d’informations, consultez [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="50a1a-242">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="50a1a-243">Validez l’étape de **Confirmation** pour installer les services et le rôle de serveur web.</span><span class="sxs-lookup"><span data-stu-id="50a1a-243">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="50a1a-244">Un redémarrage du serveur/d’IIS n’est pas nécessaire après l’installation du rôle **Serveur Web (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-244">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="50a1a-245">**Systèmes d’exploitation Windows Desktop**</span><span class="sxs-lookup"><span data-stu-id="50a1a-245">**Windows desktop operating systems**</span></span>

<span data-ttu-id="50a1a-246">Activez la **Console de gestion IIS** et les **Services World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-246">Enable the **IIS Management Console** and **World Wide Web Services**.</span></span>

1. <span data-ttu-id="50a1a-247">Accédez à **Panneau de configuration** > **Programmes** > **Programmes et fonctionnalités** > **Activer ou désactiver des fonctionnalités Windows** (à gauche de l’écran).</span><span class="sxs-lookup"><span data-stu-id="50a1a-247">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="50a1a-248">Ouvrez le nœud **Internet Information Services**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-248">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="50a1a-249">Ouvrez le nœud **Outils de gestion Web**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-249">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="50a1a-250">Cochez la case **Console de gestion IIS**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-250">Check the box for **IIS Management Console**.</span></span>

1. <span data-ttu-id="50a1a-251">Cochez la case **Services World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-251">Check the box for **World Wide Web Services**.</span></span>

1. <span data-ttu-id="50a1a-252">Acceptez les fonctionnalités par défaut pour **Services World Wide Web** ou personnalisez les fonctionnalités d’IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-252">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="50a1a-253">**Authentification Windows (facultatif)**</span><span class="sxs-lookup"><span data-stu-id="50a1a-253">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="50a1a-254">Pour activer l’authentification Windows, développez les nœuds suivants : **Services World Wide Web** > **Sécurité**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-254">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security**.</span></span> <span data-ttu-id="50a1a-255">Sélectionnez la fonctionnalité **Authentification Windows**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-255">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="50a1a-256">Pour plus d’informations, consultez [Authentification Windows\<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) et [Configurer l’authentification Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="50a1a-256">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="50a1a-257">**WebSockets (facultatif)**</span><span class="sxs-lookup"><span data-stu-id="50a1a-257">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="50a1a-258">WebSockets est pris en charge avec ASP.NET Core 1.1 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="50a1a-258">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="50a1a-259">Pour activer WebSockets, développez les nœuds suivants : **Services World Wide Web** > **Fonctionnalités de développement d’applications**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-259">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features**.</span></span> <span data-ttu-id="50a1a-260">Sélectionnez la fonctionnalité **Protocole WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-260">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="50a1a-261">Pour plus d’informations, consultez [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="50a1a-261">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="50a1a-262">Si l’installation d’IIS requiert un redémarrage, redémarrez le système.</span><span class="sxs-lookup"><span data-stu-id="50a1a-262">If the IIS installation requires a restart, restart the system.</span></span>

![Console de gestion IIS et Services World Wide Web sont sélectionnés dans Fonctionnalités de Windows.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="50a1a-264">Installer le bundle d’hébergement .NET Core</span><span class="sxs-lookup"><span data-stu-id="50a1a-264">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="50a1a-265">Installez le *bundle d’hébergement .NET Core* sur le système hôte.</span><span class="sxs-lookup"><span data-stu-id="50a1a-265">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="50a1a-266">Le bundle installe le Runtime .NET Core, la bibliothèque .NET Core et le [Module ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="50a1a-266">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="50a1a-267">Le module permet aux applications ASP.NET Core de s’exécuter derrière IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-267">The module allows ASP.NET Core apps to run behind IIS.</span></span> <span data-ttu-id="50a1a-268">Si le système n’a pas de connexion Internet, obtenez et installez [Microsoft Visual C++ 2015 Redistributable](https://www.microsoft.com/download/details.aspx?id=53840) avant d’installer le bundle d’hébergement .NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-268">If the system doesn't have an Internet connection, obtain and install the [Microsoft Visual C++ 2015 Redistributable](https://www.microsoft.com/download/details.aspx?id=53840) before installing the .NET Core Hosting Bundle.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="50a1a-269">Si le bundle d’hébergement est installé avant IIS, l’installation du bundle doit être réparée.</span><span class="sxs-lookup"><span data-stu-id="50a1a-269">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="50a1a-270">Après avoir installé IIS, réexécutez le programme d’installation du bundle d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-270">Run the Hosting Bundle installer again after installing IIS.</span></span>

### <a name="direct-download-current-version"></a><span data-ttu-id="50a1a-271">Téléchargement direct (version actuelle)</span><span class="sxs-lookup"><span data-stu-id="50a1a-271">Direct download (current version)</span></span>

<span data-ttu-id="50a1a-272">Téléchargez le programme d’installation à l’aide du lien suivant :</span><span class="sxs-lookup"><span data-stu-id="50a1a-272">Download the installer using the following link:</span></span>

[<span data-ttu-id="50a1a-273">Programme d’installation du bundle d’hébergement .NET Core actuel (téléchargement direct)</span><span class="sxs-lookup"><span data-stu-id="50a1a-273">Current .NET Core Hosting Bundle installer (direct download)</span></span>](https://www.microsoft.com/net/permalink/dotnetcore-current-windows-runtime-bundle-installer)

### <a name="earlier-versions-of-the-installer"></a><span data-ttu-id="50a1a-274">Versions antérieures du programme d’installation</span><span class="sxs-lookup"><span data-stu-id="50a1a-274">Earlier versions of the installer</span></span>

<span data-ttu-id="50a1a-275">Pour obtenir une version antérieure du programme d’installation :</span><span class="sxs-lookup"><span data-stu-id="50a1a-275">To obtain an earlier version of the installer:</span></span>

1. <span data-ttu-id="50a1a-276">Accédez aux [archives des téléchargements .NET](https://www.microsoft.com/net/download/archives).</span><span class="sxs-lookup"><span data-stu-id="50a1a-276">Navigate to the [.NET download archives](https://www.microsoft.com/net/download/archives).</span></span>
1. <span data-ttu-id="50a1a-277">Sous **.NET Core**, sélectionnez la version de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-277">Under **.NET Core**, select the .NET Core version.</span></span>
1. <span data-ttu-id="50a1a-278">Dans la colonne **Run apps - Runtime**, recherchez la ligne de la version du runtime .NET Core souhaitée.</span><span class="sxs-lookup"><span data-stu-id="50a1a-278">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="50a1a-279">Téléchargez le programme d’installation à l’aide du lien **Runtime & Hosting Bundle**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-279">Download the installer using the **Runtime & Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="50a1a-280">Certains programmes d’installation contiennent des versions qui sont arrivées à leur fin de vie (EOL) et qui ne sont plus prises en charge par Microsoft.</span><span class="sxs-lookup"><span data-stu-id="50a1a-280">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="50a1a-281">Pour plus d’informations, consultez la [politique de support](https://www.microsoft.com/net/download/dotnet-core/2.0).</span><span class="sxs-lookup"><span data-stu-id="50a1a-281">For more information, see the [support policy](https://www.microsoft.com/net/download/dotnet-core/2.0).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="50a1a-282">Installer le bundle d’hébergement</span><span class="sxs-lookup"><span data-stu-id="50a1a-282">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="50a1a-283">Exécutez le programme d’installation sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="50a1a-283">Run the installer on the server.</span></span> <span data-ttu-id="50a1a-284">Les paramètres suivants sont disponibles lorsque vous exécutez le programme d’installation à partir d’un shell de commande administrateur :</span><span class="sxs-lookup"><span data-stu-id="50a1a-284">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="50a1a-285">`OPT_NO_ANCM=1` &ndash; Sauter l’installation du module ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-285">`OPT_NO_ANCM=1` &ndash; Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="50a1a-286">`OPT_NO_RUNTIME=1` &ndash;Sauter l'installation du runtime .NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-286">`OPT_NO_RUNTIME=1` &ndash; Skip installing the .NET Core runtime.</span></span>
   * <span data-ttu-id="50a1a-287">`OPT_NO_SHAREDFX=1` &ndash; Sauter l'installation de l’infrastructure partagée ASP.NET (runtime ASP.NET).</span><span class="sxs-lookup"><span data-stu-id="50a1a-287">`OPT_NO_SHAREDFX=1` &ndash; Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span>
   * <span data-ttu-id="50a1a-288">`OPT_NO_X86=1` &ndash; Ignorer l’installation des runtimes x86.</span><span class="sxs-lookup"><span data-stu-id="50a1a-288">`OPT_NO_X86=1` &ndash; Skip installing x86 runtimes.</span></span> <span data-ttu-id="50a1a-289">Utilisez ce paramètre lorsque vous savez que vous n’hébergerez pas d’applications 32 bits.</span><span class="sxs-lookup"><span data-stu-id="50a1a-289">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="50a1a-290">Si vous n’excluez pas d’avoir à héberger des applications 32 bits et 64 bits dans le futur, n'utilisez pas ce paramètre et installez les deux runtimes.</span><span class="sxs-lookup"><span data-stu-id="50a1a-290">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="50a1a-291">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Désactivez la vérification d’utilisation d’une Configuration partagée IIS lorsque la configuration partagée (*applicationHost.config*) se trouve sur le même ordinateur que l’installation d’IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-291">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Disable the check for using an IIS Shared Configuration when the shared configuration (*applicationHost.config*) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="50a1a-292">*Disponible uniquement pour les programmes d’installation du pack d’hébergement ASP.NET Core 2.2 ou version ultérieure.*</span><span class="sxs-lookup"><span data-stu-id="50a1a-292">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="50a1a-293">Pour plus d'informations, consultez <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-293">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="50a1a-294">Redémarrez le système ou exécutez **net stop was /y** suivi de **net start w3svc** à partir d’un shell de commande.</span><span class="sxs-lookup"><span data-stu-id="50a1a-294">Restart the system or execute **net stop was /y** followed by **net start w3svc** from a command shell.</span></span> <span data-ttu-id="50a1a-295">Le redémarrage d’IIS récupère une modification apportée au CHEMIN D’ACCÈS du système, qui est une variable d’environnement, par le programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="50a1a-295">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

<span data-ttu-id="50a1a-296">Si le programme d'installation du pack d'hébergement Windows détecte qu’IIS requiert une réinitialisation pour terminer l’installation, le programme d’installation réinitialise IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-296">If the Windows Hosting Bundle installer detects that IIS requires a reset in order to complete installation, the installer resets IIS.</span></span> <span data-ttu-id="50a1a-297">Si le programme d’installation déclenche une réinitialisation d’IIS, tous les pools d’applications et sites Web IIS sont redémarrés.</span><span class="sxs-lookup"><span data-stu-id="50a1a-297">If the installer triggers an IIS reset, all of the IIS app pools and websites are restarted.</span></span>

> [!NOTE]
> <span data-ttu-id="50a1a-298">Pour plus d’informations sur la configuration partagée IIS, consultez [Module ASP.NET Core avec configuration partagée des services Internet (IIS)](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="50a1a-298">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="50a1a-299">Installer Web Deploy lors de la publication avec Visual Studio</span><span class="sxs-lookup"><span data-stu-id="50a1a-299">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="50a1a-300">Quand vous déployez des applications sur un serveur avec [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy), installez la dernière version de Web Deploy sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="50a1a-300">When deploying apps to servers with [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="50a1a-301">Pour installer Web Deploy, utilisez [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) ou obtenez un programme d’installation directement à partir du [Centre de téléchargement Microsoft](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="50a1a-301">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="50a1a-302">La méthode recommandée est d’utiliser WebPI.</span><span class="sxs-lookup"><span data-stu-id="50a1a-302">The preferred method is to use WebPI.</span></span> <span data-ttu-id="50a1a-303">WebPI offre une installation autonome et une configuration pour les fournisseurs d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-303">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="50a1a-304">Créer le site IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-304">Create the IIS site</span></span>

1. <span data-ttu-id="50a1a-305">Sur le système d’hébergement, créez un dossier pour contenir les fichiers et dossiers publiés de l’application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-305">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="50a1a-306">Une disposition du déploiement de l’application est décrite dans la rubrique [Structure des répertoires](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="50a1a-306">An app's deployment layout is described in the [Directory Structure](xref:host-and-deploy/directory-structure) topic.</span></span>

1. <span data-ttu-id="50a1a-307">Dans le Gestionnaire IIS, ouvrez le nœud du serveur dans le panneau **Connexions**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-307">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="50a1a-308">Cliquez avec le bouton de droite sur le dossier **Sites**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-308">Right-click the **Sites** folder.</span></span> <span data-ttu-id="50a1a-309">Sélectionnez **Ajouter un site Web** dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="50a1a-309">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="50a1a-310">Spécifiez le **Nom du site** et définissez le **Chemin physique** sur le dossier de déploiement de l’application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-310">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="50a1a-311">Spécifiez la configuration **Liaison** et créez le site Web en sélectionnant **OK** :</span><span class="sxs-lookup"><span data-stu-id="50a1a-311">Provide the **Binding** configuration and create the website by selecting **OK**:</span></span>

   ![Spécifiez le nom du site, le chemin physique et le nom d’hôte à l’étape Ajouter un site Web.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="50a1a-313">Les liaisons génériques de niveau supérieur (`http://*:80/` et `http://+:80`) ne doivent **pas** être utilisées.</span><span class="sxs-lookup"><span data-stu-id="50a1a-313">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="50a1a-314">Les liaisons génériques de niveau supérieur peuvent exposer votre application à des failles de sécurité.</span><span class="sxs-lookup"><span data-stu-id="50a1a-314">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="50a1a-315">Cela s’applique aux caractères génériques forts et faibles.</span><span class="sxs-lookup"><span data-stu-id="50a1a-315">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="50a1a-316">Utilisez des noms d’hôte explicites plutôt que des caractères génériques.</span><span class="sxs-lookup"><span data-stu-id="50a1a-316">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="50a1a-317">Une liaison générique de sous-domaine (par exemple, `*.mysub.com`) ne présente pas ce risque de sécurité si vous contrôlez le domaine parent en entier (par opposition à `*.com`, qui est vulnérable).</span><span class="sxs-lookup"><span data-stu-id="50a1a-317">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="50a1a-318">Consultez la [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="50a1a-318">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="50a1a-319">Sous le nœud du serveur, sélectionnez **Pools d’applications**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-319">Under the server's node, select **Application Pools**.</span></span>

1. <span data-ttu-id="50a1a-320">Cliquez avec le bouton de droite sur le pool d’applications du site et sélectionnez **Paramètres de base** dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="50a1a-320">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="50a1a-321">Dans la fenêtre **Modifier le pool d’applications**, définissez la **version .NET CLR** sur **Aucun code managé** :</span><span class="sxs-lookup"><span data-stu-id="50a1a-321">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code**:</span></span>

   ![Définissez Aucun code managé pour la version CLR .NET.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="50a1a-323">ASP.NET Core s’exécute dans un processus séparé et gère l’exécution.</span><span class="sxs-lookup"><span data-stu-id="50a1a-323">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="50a1a-324">ASP.NET Core ne repose pas sur le chargement du CLR de bureau.</span><span class="sxs-lookup"><span data-stu-id="50a1a-324">ASP.NET Core doesn't rely on loading the desktop CLR.</span></span> <span data-ttu-id="50a1a-325">La configuration de la **version CLR .NET** sur **Aucun code managé** est facultative.</span><span class="sxs-lookup"><span data-stu-id="50a1a-325">Setting the **.NET CLR version** to **No Managed Code** is optional.</span></span>

1. <span data-ttu-id="50a1a-326">*ASP.NET Core 2.2 ou version ultérieure* : Pour un [déploiement autonome](/dotnet/core/deploying/#self-contained-deployments-scd) 64 bits (x64) qui utilise le [modèle d’hébergement In-process](xref:fundamentals/servers/index#in-process-hosting-model), désactivez le pool d’applications pour les processus 32 bits (x86).</span><span class="sxs-lookup"><span data-stu-id="50a1a-326">*ASP.NET Core 2.2 or later*: For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](xref:fundamentals/servers/index#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="50a1a-327">Dans la barre latérale **Actions** du gestionnaire IIS > **Pools d’applications**, sélectionnez **Définir les valeurs par défaut du pool d’applications** ou **Paramètres avancés**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-327">In the **Actions** sidebar of IIS Manager > **Application Pools**, select **Set Application Pool Defaults** or **Advanced Settings**.</span></span> <span data-ttu-id="50a1a-328">Recherchez **Activer les applications 32 bits** et définissez la valeur sur `False`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-328">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="50a1a-329">Ce paramètre n’affecte pas les applications déployées pour l’[hébergement Out-of-process](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span><span class="sxs-lookup"><span data-stu-id="50a1a-329">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="50a1a-330">Vérifiez que l’identité de modèle de processus dispose des autorisations appropriées.</span><span class="sxs-lookup"><span data-stu-id="50a1a-330">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="50a1a-331">Si l’identité par défaut du pool d’applications (**Modèle de processus** > **Identité**) **ApplicationPoolIdentity** est remplacée par une autre identité, vérifiez que la nouvelle identité dispose des autorisations nécessaires pour accéder au dossier de l’application, à la base de données et aux autres ressources nécessaires.</span><span class="sxs-lookup"><span data-stu-id="50a1a-331">If the default identity of the app pool (**Process Model** > **Identity**) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="50a1a-332">Par exemple, le pool d’applications nécessite l’accès en lecture et en écriture aux dossiers dans lesquels l’application lit et écrit des fichiers.</span><span class="sxs-lookup"><span data-stu-id="50a1a-332">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="50a1a-333">**Configuration de l’authentification Windows (facultatif)**</span><span class="sxs-lookup"><span data-stu-id="50a1a-333">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="50a1a-334">Pour plus d'informations, consultez la rubrique [Configurer l’authentification Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="50a1a-334">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="50a1a-335">Déployer l’application</span><span class="sxs-lookup"><span data-stu-id="50a1a-335">Deploy the app</span></span>

<span data-ttu-id="50a1a-336">Déployez l’application vers le dossier créé sur le système d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-336">Deploy the app to the folder created on the hosting system.</span></span> <span data-ttu-id="50a1a-337">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) est le mécanisme recommandé pour le déploiement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-337">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="50a1a-338">Web Deploy avec Visual Studio</span><span class="sxs-lookup"><span data-stu-id="50a1a-338">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="50a1a-339">Pour découvrir comment créer un profil de publication pour une utilisation avec Web Deploy, consultez la rubrique [Profils de publication Visual Studio pour le déploiement d’applications ASP.NET Core](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles).</span><span class="sxs-lookup"><span data-stu-id="50a1a-339">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="50a1a-340">Si le fournisseur d’hébergement fournit un profil de publication ou prend en charge sa création, téléchargez son profil et importez-le à l’aide de la boîte de dialogue **Publier** de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="50a1a-340">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog.</span></span>

![Boîte de dialogue Publier](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="50a1a-342">Web Deploy en dehors de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="50a1a-342">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="50a1a-343">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) peut également être utilisé en dehors de Visual Studio à partir de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="50a1a-343">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="50a1a-344">Pour plus d’informations, consultez [Web Deployment Tool (Outil de déploiement Web)](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="50a1a-344">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="50a1a-345">Alternatives à Web Deploy</span><span class="sxs-lookup"><span data-stu-id="50a1a-345">Alternatives to Web Deploy</span></span>

<span data-ttu-id="50a1a-346">Utilisez la méthode de votre choix, telle que la copie manuelle, Xcopy, Robocopy ou PowerShell, pour déplacer l’application vers le système d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-346">Use any of several methods to move the app to the hosting system, such as manual copy, Xcopy, Robocopy, or PowerShell.</span></span>

<span data-ttu-id="50a1a-347">Pour plus d’informations sur le déploiement d’ASP.NET Core sur IIS, consultez la section [Déploiement de ressources pour les administrateurs IIS](#deployment-resources-for-iis-administrators).</span><span class="sxs-lookup"><span data-stu-id="50a1a-347">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="50a1a-348">Parcourir le site web</span><span class="sxs-lookup"><span data-stu-id="50a1a-348">Browse the website</span></span>

![Le navigateur Microsoft Edge a chargé la page de démarrage IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="50a1a-350">Fichiers de déploiement verrouillés</span><span class="sxs-lookup"><span data-stu-id="50a1a-350">Locked deployment files</span></span>

<span data-ttu-id="50a1a-351">Les fichiers dans le dossier de déploiement sont verrouillés quand l’application est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="50a1a-351">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="50a1a-352">Les fichiers verrouillés ne peuvent pas être remplacés au cours du déploiement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-352">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="50a1a-353">Pour libérer des fichiers verrouillés dans un déploiement, arrêtez le pool d’applications à l’aide **d’une** des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="50a1a-353">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="50a1a-354">Utilisez Web Deploy et référencez `Microsoft.NET.Sdk.Web` dans le fichier projet.</span><span class="sxs-lookup"><span data-stu-id="50a1a-354">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="50a1a-355">Un fichier *app_offline.htm* est placé à la racine du répertoire de l’application web.</span><span class="sxs-lookup"><span data-stu-id="50a1a-355">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="50a1a-356">Quand le fichier est présent, le module ASP.NET Core ferme l’application normalement et sert le fichier *app_offline.htm* pendant le déploiement.</span><span class="sxs-lookup"><span data-stu-id="50a1a-356">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="50a1a-357">Pour plus d’informations, consultez les [Informations de référence sur la configuration du module ASP.NET Core](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="50a1a-357">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="50a1a-358">Arrêtez manuellement le pool d’applications dans le Gestionnaire IIS sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="50a1a-358">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="50a1a-359">Utilisez PowerShell pour supprimer *app_offline.html* (nécessite PowerShell 5 ou ultérieur) :</span><span class="sxs-lookup"><span data-stu-id="50a1a-359">Use PowerShell to drop *app_offline.html* (requires PowerShell 5 or later):</span></span>

  ```PowerShell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="50a1a-360">Protection des données</span><span class="sxs-lookup"><span data-stu-id="50a1a-360">Data protection</span></span>

<span data-ttu-id="50a1a-361">La [pile de protection des données ASP.NET Core](xref:security/data-protection/introduction) est utilisée par plusieurs [intergiciels (middlewares)](xref:fundamentals/middleware/index) ASP.NET Core, y compris l’intergiciel utilisé dans l’authentification.</span><span class="sxs-lookup"><span data-stu-id="50a1a-361">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="50a1a-362">Même si les API de protection des données ne sont pas appelées par le code de l’utilisateur, la protection des données doit être configurée avec un script de déploiement ou dans un code utilisateur pour créer un [magasin de clés](xref:security/data-protection/implementation/key-management) de chiffrement persistantes.</span><span class="sxs-lookup"><span data-stu-id="50a1a-362">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="50a1a-363">Si la protection des données n’est pas configurée, les clés sont conservées en mémoire et ignorées au redémarrage de l’application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-363">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="50a1a-364">Si le Key Ring est stocké en mémoire, au redémarrage de l’application :</span><span class="sxs-lookup"><span data-stu-id="50a1a-364">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="50a1a-365">tous les jetons d’authentification basés sur des cookies sont invalidés</span><span class="sxs-lookup"><span data-stu-id="50a1a-365">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="50a1a-366">Les utilisateurs doivent se reconnecter pour envoyer leur prochaine demande.</span><span class="sxs-lookup"><span data-stu-id="50a1a-366">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="50a1a-367">toutes les données protégées par le Key Ring ne peuvent plus être déchiffrées.</span><span class="sxs-lookup"><span data-stu-id="50a1a-367">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="50a1a-368">Ceci peut inclure des [jetons CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) et des [cookies TempData ASP.NET Core MVC](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="50a1a-368">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="50a1a-369">Pour configurer la protection des données sous IIS afin de rendre persistante le Key Ring, adoptez **l’une** des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="50a1a-369">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="50a1a-370">**Créer des clés de Registre de la protection des données**</span><span class="sxs-lookup"><span data-stu-id="50a1a-370">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="50a1a-371">Les clés de la protection des données utilisées par les applications ASP.NET Core sont stockées dans le registre externe aux applications.</span><span class="sxs-lookup"><span data-stu-id="50a1a-371">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="50a1a-372">Afin de conserver les clés pour une application donnée, créez des clés de Registre pour le pool d’applications.</span><span class="sxs-lookup"><span data-stu-id="50a1a-372">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="50a1a-373">Pour les installations IIS autonomes hors d’une batterie de serveurs, le [script PowerShell Provision-AutoGenKeys.ps1 de protection des données](https://github.com/aspnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) peut être utilisé pour chaque pool d’applications utilisé avec une application ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-373">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/aspnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="50a1a-374">Ce script crée une clé de Registre dans le Registre HKLM, accessible uniquement pour le compte du processus Worker du pool d’applications de l’application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-374">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="50a1a-375">Les clés sont chiffrées au repos à l’aide de DPAPI avec une clé à l’échelle de la machine.</span><span class="sxs-lookup"><span data-stu-id="50a1a-375">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="50a1a-376">Dans les scénarios de batterie de serveurs Web, vous pouvez configurer une application afin qu’elle utilise un chemin UNC pour stocker son Key Ring de protection des données.</span><span class="sxs-lookup"><span data-stu-id="50a1a-376">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="50a1a-377">Par défaut, les clés de protection des données ne sont pas chiffrées.</span><span class="sxs-lookup"><span data-stu-id="50a1a-377">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="50a1a-378">Vérifiez que les autorisations de fichiers pour le partage réseau sont limitées au compte Windows sous lequel s’exécute l’application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-378">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="50a1a-379">Un certificat X509 peut être utilisé pour protéger les clés au repos.</span><span class="sxs-lookup"><span data-stu-id="50a1a-379">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="50a1a-380">Mettez en œuvre un mécanisme permettant aux utilisateurs de charger des certificats : Placez les certificats dans le magasin de certificats approuvés de l’utilisateur et vérifiez qu’ils sont disponibles sur toutes les machines où s’exécute l’application de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="50a1a-380">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="50a1a-381">Pour plus d’informations, consultez [Configurer la protection des données ASP.NET Core](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="50a1a-381">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="50a1a-382">**Configurer le pool d’applications IIS pour charger le profil utilisateur**</span><span class="sxs-lookup"><span data-stu-id="50a1a-382">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="50a1a-383">Ce paramètre se trouve dans la section **Modèle de processus** sous les **Paramètres avancés** du pool d’applications.</span><span class="sxs-lookup"><span data-stu-id="50a1a-383">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="50a1a-384">Affectez la valeur `True` à **Charger le profil utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-384">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="50a1a-385">Lorsqu’elle est définie sur `True`, les clés sont stockées dans le répertoire du profil utilisateur, protégées à l’aide de DPAPI avec une clé propre au compte d’utilisateur utilisé pour le pool d’applications.</span><span class="sxs-lookup"><span data-stu-id="50a1a-385">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="50a1a-386">Les clés sont persistantes dans le dossier *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys*.</span><span class="sxs-lookup"><span data-stu-id="50a1a-386">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="50a1a-387">L’[attribut setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) du pool d’applications doit également être activé.</span><span class="sxs-lookup"><span data-stu-id="50a1a-387">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="50a1a-388">La valeur par défaut de `setProfileEnvironment` est `true`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-388">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="50a1a-389">Dans certains scénarios (par exemple pour le système d’exploitation Windows), `setProfileEnvironment` est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-389">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="50a1a-390">Si les clés ne sont pas stockées dans le répertoire de profil utilisateur comme prévu :</span><span class="sxs-lookup"><span data-stu-id="50a1a-390">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="50a1a-391">Accédez au dossier *%windir%/system32/inetsrv/config*.</span><span class="sxs-lookup"><span data-stu-id="50a1a-391">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="50a1a-392">Ouvrez le fichier *applicationHost.config*.</span><span class="sxs-lookup"><span data-stu-id="50a1a-392">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="50a1a-393">Recherchez l’élément `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` .</span><span class="sxs-lookup"><span data-stu-id="50a1a-393">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="50a1a-394">Confirmez que l’attribut `setProfileEnvironment` n’est pas présent, ce qui implique que la valeur par défaut est `true`, ou définissez de manière explicite la valeur de l’attribut sur `true`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-394">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="50a1a-395">**Utiliser le système de fichiers comme magasin de Key Ring**</span><span class="sxs-lookup"><span data-stu-id="50a1a-395">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="50a1a-396">Ajustez le code d’application pour [utiliser le système de fichiers comme magasin de porte-clés](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="50a1a-396">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="50a1a-397">Utilisez un certificat X509 pour protéger le Key Ring et vérifiez qu’il s’agit d’un certificat approuvé.</span><span class="sxs-lookup"><span data-stu-id="50a1a-397">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="50a1a-398">S’il s’agit d’un certificat auto-signé, placez-le dans le magasin Racine approuvée.</span><span class="sxs-lookup"><span data-stu-id="50a1a-398">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="50a1a-399">Quand vous utilisez IIS dans une batterie de serveurs web :</span><span class="sxs-lookup"><span data-stu-id="50a1a-399">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="50a1a-400">Utilisez un partage de fichiers accessible par tous les ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="50a1a-400">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="50a1a-401">Déployez un certificat X509 sur chaque ordinateur.</span><span class="sxs-lookup"><span data-stu-id="50a1a-401">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="50a1a-402">Configurez la [protection des données dans le code](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="50a1a-402">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="50a1a-403">**Définir une stratégie au niveau de l’ordinateur pour la protection des données**</span><span class="sxs-lookup"><span data-stu-id="50a1a-403">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="50a1a-404">Le système de protection des données offre une prise en charge limitée de la définition d’une [stratégie au niveau de l’ordinateur](xref:security/data-protection/configuration/machine-wide-policy) par défaut pour toutes les applications qui utilisent les API de protection des données.</span><span class="sxs-lookup"><span data-stu-id="50a1a-404">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="50a1a-405">Pour plus d'informations, consultez <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-405">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="50a1a-406">Répertoires virtuels</span><span class="sxs-lookup"><span data-stu-id="50a1a-406">Virtual Directories</span></span>

<span data-ttu-id="50a1a-407">Les [répertoires virtuels IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) ne sont pas pris en charge avec les applications ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-407">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="50a1a-408">Une application peut être hébergée en tant que [sous-application](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="50a1a-408">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="50a1a-409">Sous-applications</span><span class="sxs-lookup"><span data-stu-id="50a1a-409">Sub-applications</span></span>

<span data-ttu-id="50a1a-410">Une application ASP.NET Core peut être hébergée en tant que [sous-application IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span><span class="sxs-lookup"><span data-stu-id="50a1a-410">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="50a1a-411">Le chemin d'accès de la sous-application devient partie intégrante de l’URL de l’application racine.</span><span class="sxs-lookup"><span data-stu-id="50a1a-411">The sub-app's path becomes part of the root app's URL.</span></span>

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="50a1a-412">Une sous-application ne doit pas inclure le module ASP.NET Core en tant que gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="50a1a-412">A sub-app shouldn't include the ASP.NET Core Module as a handler.</span></span> <span data-ttu-id="50a1a-413">Si le module est ajouté en guise de gestionnaire dans le fichier *web.config* d’une sous-application, une *Erreur de serveur interne 500.19* faisant référence au fichier config défaillant est reçue lors de la tentative de navigation dans la sous-application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-413">If the module is added as a handler in a sub-app's *web.config* file, a *500.19 Internal Server Error* referencing the faulty config file is received when attempting to browse the sub-app.</span></span>

<span data-ttu-id="50a1a-414">L’exemple suivant présente un fichier *web.config* publié pour une sous-application ASP.NET Core :</span><span class="sxs-lookup"><span data-stu-id="50a1a-414">The following example shows a published *web.config* file for an ASP.NET Core sub-app:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="50a1a-415">Si vous hébergez une sous-application non-ASP.NET Core sous une application ASP.NET Core, supprimez explicitement le gestionnaire hérité dans le fichier *web.config* de la sous-application :</span><span class="sxs-lookup"><span data-stu-id="50a1a-415">When hosting a non-ASP.NET Core sub-app underneath an ASP.NET Core app, explicitly remove the inherited handler in the sub-app's *web.config* file:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <remove name="aspNetCore" />
    </handlers>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

::: moniker-end

<span data-ttu-id="50a1a-416">Les liens de ressources statiques au sein de la sous-application doivent utiliser la notation tilde-barre oblique (`~/`).</span><span class="sxs-lookup"><span data-stu-id="50a1a-416">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="50a1a-417">La notation tilde-barre oblique déclenche un [Tag Helper](xref:mvc/views/tag-helpers/intro) afin d’ajouter l’élément pathbase de la sous-application au lien relatif rendu.</span><span class="sxs-lookup"><span data-stu-id="50a1a-417">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="50a1a-418">Pour une sous-application dans `/subapp_path`, une image liée à `src="~/image.png"` est restituée sous la forme `src="/subapp_path/image.png"`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-418">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="50a1a-419">Le composant Static File Middleware de l’application racine ne traite la demande de fichiers statiques.</span><span class="sxs-lookup"><span data-stu-id="50a1a-419">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="50a1a-420">La demande est traitée par le composant Static File Middleware de la sous-application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-420">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="50a1a-421">Si l’attribut `src` d’une ressource statique est défini sur un chemin d’accès absolu (par exemple, `src="/image.png"`), le lien apparaît sans l’élément pathbase de la sous-application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-421">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="50a1a-422">Le composant Static File Middleware de l’application racine tente de traiter la ressource à partir de l’élément [webroot](xref:fundamentals/index#web-root) de l’application racine, ce qui entraîne une erreur *404 - Introuvable*, sauf si la ressource statique est disponible depuis l’application racine.</span><span class="sxs-lookup"><span data-stu-id="50a1a-422">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="50a1a-423">Pour héberger une application ASP.NET Core en tant que sous-application d’une autre application ASP.NET Core :</span><span class="sxs-lookup"><span data-stu-id="50a1a-423">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="50a1a-424">Établissez un pool d’applications pour la sous-application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-424">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="50a1a-425">Affectez la valeur **Aucun code managé** à **Version du CLR .NET**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-425">Set the **.NET CLR Version** to **No Managed Code**.</span></span>

1. <span data-ttu-id="50a1a-426">Ajoutez le site racine dans IIS Manager en plaçant la sous-application dans un dossier du site racine.</span><span class="sxs-lookup"><span data-stu-id="50a1a-426">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="50a1a-427">Cliquez avec le bouton droit sur le dossier de la sous-application dans IIS Manager, puis sélectionnez **Convertir en application**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-427">Right-click the sub-app folder in IIS Manager and select **Convert to Application**.</span></span>

1. <span data-ttu-id="50a1a-428">Dans la boîte de dialogue **Ajouter une application**, utilisez le bouton **Sélectionner** de l’option **Pool d’applications** pour affecter le pool d’applications que vous avez créé pour la sous-application.</span><span class="sxs-lookup"><span data-stu-id="50a1a-428">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="50a1a-429">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-429">Select **OK**.</span></span>

<span data-ttu-id="50a1a-430">L’attribution d’un pool d’applications distinct à la sous-application est obligatoire lorsque vous utilisez le modèle d’hébergement in-process.</span><span class="sxs-lookup"><span data-stu-id="50a1a-430">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="50a1a-431">Pour plus d’informations sur le modèle d’hébergement in-process et la configuration du module ASP.NET Core, consultez <xref:host-and-deploy/aspnet-core-module> et <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-431">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module> and <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="50a1a-432">Configuration d’IIS avec web.config</span><span class="sxs-lookup"><span data-stu-id="50a1a-432">Configuration of IIS with web.config</span></span>

<span data-ttu-id="50a1a-433">La configuration d’IIS est influencée par la section `<system.webServer>` de *web.config* pour les scénarios IIS qui sont fonctionnels pour les applications ASP.NET Core avec le module ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-433">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="50a1a-434">Par exemple, la configuration IIS est fonctionnelle pour la compression dynamique.</span><span class="sxs-lookup"><span data-stu-id="50a1a-434">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="50a1a-435">Si IIS est configuré au niveau du serveur pour utiliser la compression dynamique, l’élément `<urlCompression>` dans le fichier *web.config* de l’application peut le désactiver pour une application ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-435">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="50a1a-436">Pour plus d’informations, consultez [Informations de référence sur la configuration de \<system.webServer>](/iis/configuration/system.webServer/), [Informations de référence sur la configuration du module ASP.NET Core](xref:host-and-deploy/aspnet-core-module) et [Modules IIS avec ASP.NET Core](xref:host-and-deploy/iis/modules).</span><span class="sxs-lookup"><span data-stu-id="50a1a-436">For more information, see the [configuration reference for \<system.webServer>](/iis/configuration/system.webServer/), [ASP.NET Core Module Configuration Reference](xref:host-and-deploy/aspnet-core-module), and [IIS Modules with ASP.NET Core](xref:host-and-deploy/iis/modules).</span></span> <span data-ttu-id="50a1a-437">Pour définir des variables d’environnement pour des applications individuelles exécutées dans des pools de données isolés, (prises en charge pour IIS 10.0 ou version ultérieure), consultez la section *AppCmd.exe command* de la rubrique [Variables d’environnement \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) dans la documentation de référence IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-437">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="50a1a-438">Sections de configuration de web.config</span><span class="sxs-lookup"><span data-stu-id="50a1a-438">Configuration sections of web.config</span></span>

<span data-ttu-id="50a1a-439">Les sections de configuration des applications ASP.NET 4.x dans *web.config* ne sont pas utilisées par les applications ASP.NET Core pour la configuration :</span><span class="sxs-lookup"><span data-stu-id="50a1a-439">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="50a1a-440">Les applications ASP.NET Core sont configurées à l’aide d’autres fournisseurs de configuration.</span><span class="sxs-lookup"><span data-stu-id="50a1a-440">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="50a1a-441">Pour plus d’informations, consultez [Configuration](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="50a1a-441">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="50a1a-442">Pools d'applications</span><span class="sxs-lookup"><span data-stu-id="50a1a-442">Application Pools</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="50a1a-443">L’isolation des pools d’applications est déterminée par le modèle d’hébergement :</span><span class="sxs-lookup"><span data-stu-id="50a1a-443">App pool isolation is determined by the hosting model:</span></span>

* <span data-ttu-id="50a1a-444">Hébergement in-process &ndash; Les applications doivent s’exécuter dans des pools d’applications distincts.</span><span class="sxs-lookup"><span data-stu-id="50a1a-444">In-process hosting &ndash; Apps are required to run in separate app pools.</span></span>
* <span data-ttu-id="50a1a-445">Hébergement out-of-process &ndash; Nous vous recommandons d’isoler les applications les unes des autres en exécutant chaque application dans son propre pool d’applications.</span><span class="sxs-lookup"><span data-stu-id="50a1a-445">Out-of-process hosting &ndash; We recommend isolating the apps from each other by running each app in its own app pool.</span></span>

<span data-ttu-id="50a1a-446">La boîte de dialogue **Ajouter un site web** d’IIS applique un seul pool d’applications par application par défaut.</span><span class="sxs-lookup"><span data-stu-id="50a1a-446">The IIS **Add Website** dialog defaults to a single app pool per app.</span></span> <span data-ttu-id="50a1a-447">Quand un **Nom du site** est fourni, le texte est automatiquement transféré vers la zone de texte **Pool d’applications**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-447">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="50a1a-448">Un nouveau pool d’applications est créé avec le nom du site une fois qu’il est ajouté.</span><span class="sxs-lookup"><span data-stu-id="50a1a-448">A new app pool is created using the site name when the site is added.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="50a1a-449">Quand vous hébergez plusieurs sites Web sur un même serveur, nous vous recommandons d’isoler les applications les unes des autres en exécutant chaque application dans son propre pool d’applications.</span><span class="sxs-lookup"><span data-stu-id="50a1a-449">When hosting multiple websites on a server, we recommend isolating the apps from each other by running each app in its own app pool.</span></span> <span data-ttu-id="50a1a-450">La boîte de dialogue **Ajouter un site Web** d’IIS applique cette configuration par défaut.</span><span class="sxs-lookup"><span data-stu-id="50a1a-450">The IIS **Add Website** dialog defaults to this configuration.</span></span> <span data-ttu-id="50a1a-451">Quand un **Nom du site** est fourni, le texte est automatiquement transféré vers la zone de texte **Pool d’applications**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-451">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="50a1a-452">Un nouveau pool d’applications est créé avec le nom du site une fois qu’il est ajouté.</span><span class="sxs-lookup"><span data-stu-id="50a1a-452">A new app pool is created using the site name when the site is added.</span></span>

::: moniker-end

## <a name="application-pool-identity"></a><span data-ttu-id="50a1a-453">Identité du pool d’applications</span><span class="sxs-lookup"><span data-stu-id="50a1a-453">Application Pool Identity</span></span>

<span data-ttu-id="50a1a-454">Un compte d’identité du pool d’applications permet à une application de s’exécuter sous un compte unique sans qu’il soit nécessaire de créer et de gérer des domaines ou des comptes locaux.</span><span class="sxs-lookup"><span data-stu-id="50a1a-454">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="50a1a-455">Sur IIS 8.0 ou version ultérieure, le processus Worker d’administration IIS (WAS) crée un compte virtuel avec le nom du nouveau pool d’applications et exécute les processus Worker du pool d’applications sous ce compte par défaut.</span><span class="sxs-lookup"><span data-stu-id="50a1a-455">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="50a1a-456">Dans la console de gestion IIS, sous **Paramètres avancés** pour le pool d’applications, vérifiez que **l’Identité** est configurée pour utiliser **ApplicationPoolIdentity** :</span><span class="sxs-lookup"><span data-stu-id="50a1a-456">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity**:</span></span>

![Boîte de dialogue Paramètres avancés du pool applications](index/_static/apppool-identity.png)

<span data-ttu-id="50a1a-458">Le processus de gestion IIS crée un identificateur sécurisé avec le nom du pool d’applications dans le système de sécurité Windows.</span><span class="sxs-lookup"><span data-stu-id="50a1a-458">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="50a1a-459">Les ressources peuvent être sécurisées à l’aide de cette identité.</span><span class="sxs-lookup"><span data-stu-id="50a1a-459">Resources can be secured using this identity.</span></span> <span data-ttu-id="50a1a-460">Toutefois, cette identité n’est pas un compte d’utilisateur réel et n’apparaît pas dans la console de gestion d’utilisateurs Windows.</span><span class="sxs-lookup"><span data-stu-id="50a1a-460">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="50a1a-461">Si le processus Worker IIS a besoin d’un accès élevé à l’application, modifiez la liste de contrôle d’accès (ACL) du répertoire contenant l’application :</span><span class="sxs-lookup"><span data-stu-id="50a1a-461">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="50a1a-462">Ouvrez l’Explorateur Windows et accédez au répertoire.</span><span class="sxs-lookup"><span data-stu-id="50a1a-462">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="50a1a-463">Cliquez avec le bouton droit sur le répertoire et sélectionnez **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-463">Right-click on the directory and select **Properties**.</span></span>

1. <span data-ttu-id="50a1a-464">Sous l’onglet **Sécurité**, sélectionnez le bouton **Modifier**, puis le bouton **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-464">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="50a1a-465">Sélectionnez le bouton **Emplacements**, puis vérifiez que le système est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="50a1a-465">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="50a1a-466">Entrez **IIS AppPool\\<app_pool_name>** dans la zone **Entrer les noms des objets à sélectionner**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-466">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="50a1a-467">Sélectionnez le bouton **Vérifier les noms**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-467">Select the **Check Names** button.</span></span> <span data-ttu-id="50a1a-468">Pour le *DefaultAppPool*, vérifiez les noms à l’aide de **IIS AppPool\DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-468">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool**.</span></span> <span data-ttu-id="50a1a-469">Lorsque le bouton **Vérifier les noms** est sélectionné, une valeur de **DefaultAppPool** est indiquée dans la zone des noms d’objets.</span><span class="sxs-lookup"><span data-stu-id="50a1a-469">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="50a1a-470">Il n’est pas possible d’entrer le nom du pool d’applications directement dans la zone des noms d’objets.</span><span class="sxs-lookup"><span data-stu-id="50a1a-470">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="50a1a-471">Utilisez le format **IIS AppPool\\<app_pool_name>** lors de la vérification du nom de l’objet.</span><span class="sxs-lookup"><span data-stu-id="50a1a-471">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Boîte de dialogue de sélection d’utilisateurs ou de groupes pour le dossier d’application : Ajoutez le nom du pool d’applications « DefaultAppPool » à « IIS AppPool\" dans la zone des noms d’objets avant de sélectionner « Vérifier les noms ».](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="50a1a-473">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-473">Select **OK**.</span></span>

   ![Boîte de dialogue de sélection d’utilisateurs ou de groupes pour le dossier d’application : Après avoir sélectionné « Vérifier les noms », le nom d’objet « DefaultAppPool » est indiqué dans la zone des noms d’objets.](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="50a1a-475">Les autorisations Lire &amp; exécuter doivent être accordées par défaut.</span><span class="sxs-lookup"><span data-stu-id="50a1a-475">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="50a1a-476">Fournissez des autorisations supplémentaires si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="50a1a-476">Provide additional permissions as needed.</span></span>

<span data-ttu-id="50a1a-477">L’accès peut également être octroyé par le biais d’une invite de commandes à l’aide de l’outil **ICACLS**.</span><span class="sxs-lookup"><span data-stu-id="50a1a-477">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="50a1a-478">À l’aide de *DefaultAppPool* en exemple, la commande suivante est utilisée :</span><span class="sxs-lookup"><span data-stu-id="50a1a-478">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="50a1a-479">Pour plus d’informations, consultez la rubrique [icacls](/windows-server/administration/windows-commands/icacls).</span><span class="sxs-lookup"><span data-stu-id="50a1a-479">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="50a1a-480">Prise en charge de HTTP/2</span><span class="sxs-lookup"><span data-stu-id="50a1a-480">HTTP/2 support</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="50a1a-481">[HTTP/2](https://httpwg.org/specs/rfc7540.html) est pris en charge avec ASP.NET Core dans les scénarios de déploiement IIS suivants :</span><span class="sxs-lookup"><span data-stu-id="50a1a-481">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported with ASP.NET Core in the following IIS deployment scenarios:</span></span>

* <span data-ttu-id="50a1a-482">In-process</span><span class="sxs-lookup"><span data-stu-id="50a1a-482">In-process</span></span>
  * <span data-ttu-id="50a1a-483">Windows Server 2016/Windows 10 ou version ultérieure ; IIS 10 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-483">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="50a1a-484">TLS 1.2 ou connexion ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-484">TLS 1.2 or later connection</span></span>
* <span data-ttu-id="50a1a-485">Out-of-process</span><span class="sxs-lookup"><span data-stu-id="50a1a-485">Out-of-process</span></span>
  * <span data-ttu-id="50a1a-486">Windows Server 2016/Windows 10 ou version ultérieure ; IIS 10 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-486">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="50a1a-487">Les connexions au serveur périphérique public utilisent HTTP/2, mais la connexion de proxy inverse pour le [serveur Kestrel](xref:fundamentals/servers/kestrel) utilise HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="50a1a-487">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
  * <span data-ttu-id="50a1a-488">TLS 1.2 ou connexion ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-488">TLS 1.2 or later connection</span></span>

<span data-ttu-id="50a1a-489">Pour un déploiement in-process lorsqu’une connexion HTTP/2 est établie, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) retourne `HTTP/2`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-489">For an in-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span> <span data-ttu-id="50a1a-490">Pour un déploiement in-process lorsqu’une connexion HTTP/2 est établie, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) retourne `HTTP/1.1`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-490">For an out-of-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="50a1a-491">Pour plus d’informations sur les modèles d’hébergement in-process et out-of-process, consultez la rubrique <xref:host-and-deploy/aspnet-core-module> et <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="50a1a-491">For more information on the in-process and out-of-process hosting models, see the <xref:host-and-deploy/aspnet-core-module> topic and the <xref:host-and-deploy/aspnet-core-module>.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="50a1a-492">[HTTP/2](https://httpwg.org/specs/rfc7540.html) est pris en charge pour les déploiements out-of-process qui répondent aux exigences de base suivantes :</span><span class="sxs-lookup"><span data-stu-id="50a1a-492">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported for out-of-process deployments that meet the following base requirements:</span></span>

* <span data-ttu-id="50a1a-493">Windows Server 2016/Windows 10 ou version ultérieure ; IIS 10 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-493">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
* <span data-ttu-id="50a1a-494">Les connexions au serveur périphérique public utilisent HTTP/2, mais la connexion de proxy inverse pour le [serveur Kestrel](xref:fundamentals/servers/kestrel) utilise HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="50a1a-494">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
* <span data-ttu-id="50a1a-495">Version cible de .NET Framework : Non applicable aux déploiements out-of-process, étant donné que la connexion HTTP/2 est gérée entièrement par IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-495">Target framework: Not applicable to out-of-process deployments, since the HTTP/2 connection is handled entirely by IIS.</span></span>
* <span data-ttu-id="50a1a-496">TLS 1.2 ou connexion ultérieure</span><span class="sxs-lookup"><span data-stu-id="50a1a-496">TLS 1.2 or later connection</span></span>

<span data-ttu-id="50a1a-497">Si une connexion HTTP/2 est établie, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) retourne `HTTP/1.1`.</span><span class="sxs-lookup"><span data-stu-id="50a1a-497">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

::: moniker-end

<span data-ttu-id="50a1a-498">HTTP/2 est activé par défaut.</span><span class="sxs-lookup"><span data-stu-id="50a1a-498">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="50a1a-499">Les connexions reviennent à HTTP/1.1 si une connexion HTTP/2 n’est pas établie.</span><span class="sxs-lookup"><span data-stu-id="50a1a-499">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="50a1a-500">Pour plus d’informations sur la configuration de HTTP/2 avec les déploiements IIS, consultez [HTTP/2 sur IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="50a1a-500">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="50a1a-501">Requêtes préliminaires CORS</span><span class="sxs-lookup"><span data-stu-id="50a1a-501">CORS preflight requests</span></span>

<span data-ttu-id="50a1a-502">*Cette section s’applique uniquement aux applications ASP.NET Core qui ciblent le .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="50a1a-502">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="50a1a-503">Pour une application ASP.NET Core qui cible le .NET Framework, les requêtes OPTIONS ne sont pas transmises à l’application par défaut dans IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-503">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="50a1a-504">Pour savoir comment configurer les gestionnaires IIS de l’application dans *web.config* pour transmettre les requêtes OPTIONS, consultez [Activer les requêtes cross-origin dans l’API Web ASP.NET 2 : Fonctionnement de CORS](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="50a1a-504">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="50a1a-505">Déploiement de ressources pour les administrateurs IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-505">Deployment resources for IIS administrators</span></span>

<span data-ttu-id="50a1a-506">Pour en savoir plus sur IIS, consultez la documentation IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-506">Learn about IIS in-depth in the IIS documentation.</span></span>  
[<span data-ttu-id="50a1a-507">Documentation IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-507">IIS documentation</span></span>](/iis)

<span data-ttu-id="50a1a-508">Découvrez les modèles de déploiement d’application .NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-508">Learn about .NET Core app deployment models.</span></span>  
[<span data-ttu-id="50a1a-509">Déploiement d’applications .NET Core</span><span class="sxs-lookup"><span data-stu-id="50a1a-509">.NET Core application deployment</span></span>](/dotnet/core/deploying/)

<span data-ttu-id="50a1a-510">Découvrez comment le module ASP.NET Core permet au serveur web Kestrel d’utiliser IIS ou IIS Express en tant que serveur proxy inverse.</span><span class="sxs-lookup"><span data-stu-id="50a1a-510">Learn how the ASP.NET Core Module allows the Kestrel web server to use IIS or IIS Express as a reverse proxy server.</span></span>  
[<span data-ttu-id="50a1a-511">Module ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="50a1a-511">ASP.NET Core Module</span></span>](xref:host-and-deploy/aspnet-core-module)

<span data-ttu-id="50a1a-512">Découvrez comment configurer le module ASP.NET Core pour héberger des applications ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-512">Learn how to configure the ASP.NET Core Module for hosting ASP.NET Core apps.</span></span>  
[<span data-ttu-id="50a1a-513">Informations de référence sur la configuration du Module ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="50a1a-513">ASP.NET Core Module configuration reference</span></span>](xref:host-and-deploy/aspnet-core-module)

<span data-ttu-id="50a1a-514">Découvrez la structure de répertoires des applications ASP.NET Core publiées.</span><span class="sxs-lookup"><span data-stu-id="50a1a-514">Learn about the directory structure of published ASP.NET Core apps.</span></span>  
[<span data-ttu-id="50a1a-515">Structure de répertoires</span><span class="sxs-lookup"><span data-stu-id="50a1a-515">Directory structure</span></span>](xref:host-and-deploy/directory-structure)

<span data-ttu-id="50a1a-516">Découvrez les modules IIS actifs et inactifs pour les applications ASP.NET Core et comment gérer les modules IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-516">Discover active and inactive IIS modules for ASP.NET Core apps and how to manage IIS modules.</span></span>  
[<span data-ttu-id="50a1a-517">Modules IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-517">IIS modules</span></span>](xref:host-and-deploy/iis/troubleshoot)

<span data-ttu-id="50a1a-518">Découvrez comment diagnostiquer les problèmes liés aux déploiements IIS d’applications ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="50a1a-518">Learn how to diagnose problems with IIS deployments of ASP.NET Core apps.</span></span>  
[<span data-ttu-id="50a1a-519">Résoudre les problèmes</span><span class="sxs-lookup"><span data-stu-id="50a1a-519">Troubleshoot</span></span>](xref:host-and-deploy/iis/troubleshoot)

<span data-ttu-id="50a1a-520">Repérer les erreurs courantes liées à l’hébergement d’applications ASP.NET Core sur IIS.</span><span class="sxs-lookup"><span data-stu-id="50a1a-520">Distinguish common errors when hosting ASP.NET Core apps on IIS.</span></span>  
[<span data-ttu-id="50a1a-521">Informations de référence sur les erreurs courantes pour Azure App Service et IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-521">Common errors reference for Azure App Service and IIS</span></span>](xref:host-and-deploy/azure-iis-errors-reference)

## <a name="additional-resources"></a><span data-ttu-id="50a1a-522">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="50a1a-522">Additional resources</span></span>

* <xref:test/troubleshoot>
* [<span data-ttu-id="50a1a-523">Présentation d’ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="50a1a-523">Introduction to ASP.NET Core</span></span>](xref:index)
* [<span data-ttu-id="50a1a-524">Site officiel de Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-524">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="50a1a-525">Bibliothèque de contenu technique Windows Server</span><span class="sxs-lookup"><span data-stu-id="50a1a-525">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="50a1a-526">HTTP/2 sur IIS</span><span class="sxs-lookup"><span data-stu-id="50a1a-526">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>
