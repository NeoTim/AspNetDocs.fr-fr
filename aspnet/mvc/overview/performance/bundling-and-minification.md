---
uid: mvc/overview/performance/bundling-and-minification
title: Regroupement et minimisation | Microsoft Docs
author: Rick-Anderson
description: Le regroupement et la minimisation sont deux techniques que vous pouvez utiliser dans ASP.NET 4,5 pour améliorer le temps de chargement des demandes. Le regroupement et la minimisation améliorent le temps de chargement par reducin...
ms.author: riande
ms.date: 08/23/2012
ms.assetid: 5894dc13-5d45-4dad-8096-136499120f1d
msc.legacyurl: /mvc/overview/performance/bundling-and-minification
msc.type: authoredcontent
ms.openlocfilehash: 61bfe5dbac04b57e1461183b66ead2f01fe0734c
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78538597"
---
# <a name="bundling-and-minification"></a><span data-ttu-id="7690a-104">Bundles et minimisation</span><span class="sxs-lookup"><span data-stu-id="7690a-104">Bundling and Minification</span></span>

<span data-ttu-id="7690a-105">par [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="7690a-105">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="7690a-106">Le regroupement et la minimisation sont deux techniques que vous pouvez utiliser dans ASP.NET 4,5 pour améliorer le temps de chargement des demandes.</span><span class="sxs-lookup"><span data-stu-id="7690a-106">Bundling and minification are two techniques you can use in ASP.NET 4.5 to improve request load time.</span></span> <span data-ttu-id="7690a-107">Le regroupement et la minimisation améliorent le temps de chargement en réduisant le nombre de demandes au serveur et en réduisant la taille des ressources demandées (telles que CSS et JavaScript).</span><span class="sxs-lookup"><span data-stu-id="7690a-107">Bundling and minification improves load time by reducing the number of requests to the server and reducing the size of requested assets (such as CSS and JavaScript.)</span></span>

<span data-ttu-id="7690a-108">La plupart des navigateurs principaux actuels limitent le nombre de [connexions simultanées](http://www.browserscope.org/?category=network) par nom d’hôte à six.</span><span class="sxs-lookup"><span data-stu-id="7690a-108">Most of the current major browsers limit the number of [simultaneous connections](http://www.browserscope.org/?category=network) per each hostname to six.</span></span> <span data-ttu-id="7690a-109">Cela signifie que si six demandes sont traitées, les demandes supplémentaires de ressources sur un ordinateur hôte sont mises en file d’attente par le navigateur.</span><span class="sxs-lookup"><span data-stu-id="7690a-109">That means that while six requests are being processed, additional requests for assets on a host will be queued by the browser.</span></span> <span data-ttu-id="7690a-110">Dans l’image ci-dessous, les onglets réseau des outils de développement Internet Explorer F12 affichent le minutage des ressources requises par la vue à propos d’un exemple d’application.</span><span class="sxs-lookup"><span data-stu-id="7690a-110">In the image below, the IE F12 developer tools network tabs shows the timing for assets required by the About view of a sample application.</span></span>

![B/M](bundling-and-minification/_static/image1.png)

<span data-ttu-id="7690a-112">Les barres grises indiquent l’heure à laquelle la demande est mise en file d’attente par le navigateur qui attend la limite de six connexions.</span><span class="sxs-lookup"><span data-stu-id="7690a-112">The gray bars show the time the request is queued by the browser waiting on the six connection limit.</span></span> <span data-ttu-id="7690a-113">La barre jaune représente la durée de la demande jusqu’au premier octet, c’est-à-dire le temps nécessaire pour envoyer la demande et recevoir la première réponse du serveur.</span><span class="sxs-lookup"><span data-stu-id="7690a-113">The yellow bar is the request time to first byte, that is, the time taken to send the request and receive the first response from the server.</span></span> <span data-ttu-id="7690a-114">Les barres bleues indiquent le temps nécessaire pour recevoir les données de réponse du serveur.</span><span class="sxs-lookup"><span data-stu-id="7690a-114">The blue bars show the time taken to receive the response data from the server.</span></span> <span data-ttu-id="7690a-115">Vous pouvez double-cliquer sur un élément multimédia pour obtenir des informations détaillées sur la temporisation.</span><span class="sxs-lookup"><span data-stu-id="7690a-115">You can double-click on an asset to get detailed timing information.</span></span> <span data-ttu-id="7690a-116">Par exemple, l’image suivante montre les détails de minutage du chargement du fichier */scripts/myscripts/JavaScript6.js* .</span><span class="sxs-lookup"><span data-stu-id="7690a-116">For example, the following image shows the timing details for loading the */Scripts/MyScripts/JavaScript6.js* file.</span></span>

![](bundling-and-minification/_static/image2.png)

<span data-ttu-id="7690a-117">L’image précédente montre l’événement **Start** , qui indique l’heure à laquelle la demande a été mise en file d’attente, car le navigateur limite le nombre de connexions simultanées.</span><span class="sxs-lookup"><span data-stu-id="7690a-117">The preceding image shows the **Start** event, which gives the time the request was queued because of the browser limit the number of simultaneous connections.</span></span> <span data-ttu-id="7690a-118">Dans ce cas, la demande a été mise en file d’attente pendant 46 millisecondes en attendant la fin d’une autre requête.</span><span class="sxs-lookup"><span data-stu-id="7690a-118">In this case, the request was queued for 46 milliseconds waiting for another request to complete.</span></span>

## <a name="bundling"></a><span data-ttu-id="7690a-119">Regroupement</span><span class="sxs-lookup"><span data-stu-id="7690a-119">Bundling</span></span>

<span data-ttu-id="7690a-120">Le regroupement est une nouvelle fonctionnalité de ASP.NET 4,5 qui facilite la combinaison ou le regroupement de plusieurs fichiers dans un seul fichier.</span><span class="sxs-lookup"><span data-stu-id="7690a-120">Bundling is a new feature in ASP.NET 4.5 that makes it easy to combine or bundle multiple files into a single file.</span></span> <span data-ttu-id="7690a-121">Vous pouvez créer des packs CSS, JavaScript et autres.</span><span class="sxs-lookup"><span data-stu-id="7690a-121">You can create CSS, JavaScript and other bundles.</span></span> <span data-ttu-id="7690a-122">Moins de fichiers signifie moins de requêtes HTTP et peuvent améliorer les performances de chargement de la première page.</span><span class="sxs-lookup"><span data-stu-id="7690a-122">Fewer files means fewer HTTP requests and that can improve first page load performance.</span></span>

<span data-ttu-id="7690a-123">L’illustration suivante montre la même vue de minuterie de la vue about présentée précédemment, mais cette fois avec le regroupement et la minimisation activés.</span><span class="sxs-lookup"><span data-stu-id="7690a-123">The following image shows the same timing view of the About view shown previously, but this time with bundling and minification enabled.</span></span>

![](bundling-and-minification/_static/image3.png)

## <a name="minification"></a><span data-ttu-id="7690a-124">Réduction</span><span class="sxs-lookup"><span data-stu-id="7690a-124">Minification</span></span>

<span data-ttu-id="7690a-125">La minimisation effectue une grande variété d’optimisations du code pour les scripts ou la CSS, par exemple la suppression des espaces et des commentaires inutiles et le raccourcissement des noms de variables en un seul caractère.</span><span class="sxs-lookup"><span data-stu-id="7690a-125">Minification performs a variety of different code optimizations to scripts or css, such as removing unnecessary white space and comments and shortening variable names to one character.</span></span> <span data-ttu-id="7690a-126">Considérons la fonction JavaScript suivante.</span><span class="sxs-lookup"><span data-stu-id="7690a-126">Consider the following JavaScript function.</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample1.js)]

<span data-ttu-id="7690a-127">Après la minimisation, la fonction est réduite à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="7690a-127">After minification, the function is reduced to the following:</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample2.js)]

<span data-ttu-id="7690a-128">En plus de supprimer les commentaires et les espaces superflus, les noms de variables et les paramètres suivants ont été renommés (raccourcis) comme suit :</span><span class="sxs-lookup"><span data-stu-id="7690a-128">In addition to removing the comments and unnecessary whitespace, the following parameters and variable names were renamed (shortened) as follows:</span></span>

| <span data-ttu-id="7690a-129">**Ressource d’origine**</span><span class="sxs-lookup"><span data-stu-id="7690a-129">**Original**</span></span> | <span data-ttu-id="7690a-130">**Renommé**</span><span class="sxs-lookup"><span data-stu-id="7690a-130">**Renamed**</span></span> |
| --- | --- |
| <span data-ttu-id="7690a-131">imageTagAndImageID</span><span class="sxs-lookup"><span data-stu-id="7690a-131">imageTagAndImageID</span></span> | <span data-ttu-id="7690a-132">n</span><span class="sxs-lookup"><span data-stu-id="7690a-132">n</span></span> |
| <span data-ttu-id="7690a-133">imageContext</span><span class="sxs-lookup"><span data-stu-id="7690a-133">imageContext</span></span> | <span data-ttu-id="7690a-134">t</span><span class="sxs-lookup"><span data-stu-id="7690a-134">t</span></span> |
| <span data-ttu-id="7690a-135">imageElement</span><span class="sxs-lookup"><span data-stu-id="7690a-135">imageElement</span></span> | <span data-ttu-id="7690a-136">i</span><span class="sxs-lookup"><span data-stu-id="7690a-136">i</span></span> |

## <a name="impact-of-bundling-and-minification"></a><span data-ttu-id="7690a-137">Impact du regroupement et de la minimisation</span><span class="sxs-lookup"><span data-stu-id="7690a-137">Impact of Bundling and Minification</span></span>

<span data-ttu-id="7690a-138">Le tableau suivant présente plusieurs différences importantes entre la liste de toutes les ressources individuellement et l’utilisation du regroupement et de la minimisation (B/M) dans l’exemple de programme.</span><span class="sxs-lookup"><span data-stu-id="7690a-138">The following table shows several important differences between listing all the assets individually and using bundling and minification (B/M) in the sample program.</span></span>

|  | <span data-ttu-id="7690a-139">**Utilisation de B/M**</span><span class="sxs-lookup"><span data-stu-id="7690a-139">**Using B/M**</span></span> | <span data-ttu-id="7690a-140">**Sans B/M**</span><span class="sxs-lookup"><span data-stu-id="7690a-140">**Without B/M**</span></span> | <span data-ttu-id="7690a-141">**Changement**</span><span class="sxs-lookup"><span data-stu-id="7690a-141">**Change**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="7690a-142">**Demandes de fichier**</span><span class="sxs-lookup"><span data-stu-id="7690a-142">**File Requests**</span></span> | <span data-ttu-id="7690a-143">9</span><span class="sxs-lookup"><span data-stu-id="7690a-143">9</span></span> | <span data-ttu-id="7690a-144">34</span><span class="sxs-lookup"><span data-stu-id="7690a-144">34</span></span> | <span data-ttu-id="7690a-145">256%</span><span class="sxs-lookup"><span data-stu-id="7690a-145">256%</span></span> |
| <span data-ttu-id="7690a-146">**Ko envoyés**</span><span class="sxs-lookup"><span data-stu-id="7690a-146">**KB Sent**</span></span> | <span data-ttu-id="7690a-147">3.26</span><span class="sxs-lookup"><span data-stu-id="7690a-147">3.26</span></span> | <span data-ttu-id="7690a-148">11.92</span><span class="sxs-lookup"><span data-stu-id="7690a-148">11.92</span></span> | <span data-ttu-id="7690a-149">266%</span><span class="sxs-lookup"><span data-stu-id="7690a-149">266%</span></span> |
| <span data-ttu-id="7690a-150">**Ko reçus**</span><span class="sxs-lookup"><span data-stu-id="7690a-150">**KB Received**</span></span> | <span data-ttu-id="7690a-151">388.51</span><span class="sxs-lookup"><span data-stu-id="7690a-151">388.51</span></span> | <span data-ttu-id="7690a-152">530</span><span class="sxs-lookup"><span data-stu-id="7690a-152">530</span></span> | <span data-ttu-id="7690a-153">36%</span><span class="sxs-lookup"><span data-stu-id="7690a-153">36%</span></span> |
| <span data-ttu-id="7690a-154">**Temps de chargement**</span><span class="sxs-lookup"><span data-stu-id="7690a-154">**Load Time**</span></span> | <span data-ttu-id="7690a-155">510 MS</span><span class="sxs-lookup"><span data-stu-id="7690a-155">510 MS</span></span> | <span data-ttu-id="7690a-156">780 MS</span><span class="sxs-lookup"><span data-stu-id="7690a-156">780 MS</span></span> | <span data-ttu-id="7690a-157">53%</span><span class="sxs-lookup"><span data-stu-id="7690a-157">53%</span></span> |

<span data-ttu-id="7690a-158">Les octets envoyés ont subi une réduction significative du regroupement, car les navigateurs sont relativement détaillés avec les en-têtes HTTP qu’ils appliquent sur les requêtes.</span><span class="sxs-lookup"><span data-stu-id="7690a-158">The bytes sent had a significant reduction with bundling as browsers are fairly verbose with the HTTP headers they apply on requests.</span></span> <span data-ttu-id="7690a-159">La réduction des octets reçus n’est pas aussi importante, car les fichiers les plus volumineux (*scripts\\jQuery-UI-1.8.11. min. js* et *scripts\\jQuery-1.7.1. min. js*) sont déjà minimisés.</span><span class="sxs-lookup"><span data-stu-id="7690a-159">The received bytes reduction is not as large because the largest files (*Scripts\\jquery-ui-1.8.11.min.js* and *Scripts\\jquery-1.7.1.min.js*) are already minified.</span></span> <span data-ttu-id="7690a-160">Remarque : le minutage de l’exemple de programme a utilisé l’outil [Fiddler](http://www.fiddler2.com/fiddler2/) pour simuler un réseau lent.</span><span class="sxs-lookup"><span data-stu-id="7690a-160">Note: The timings on the sample program used the [Fiddler](http://www.fiddler2.com/fiddler2/) tool to simulate a slow network.</span></span> <span data-ttu-id="7690a-161">(Dans le menu **règles** de Fiddler, sélectionnez **performances** , puis **simuler les vitesses de modem**.)</span><span class="sxs-lookup"><span data-stu-id="7690a-161">(From the Fiddler **Rules** menu, select **Performance** then **Simulate Modem Speeds**.)</span></span>

## <a name="debugging-bundled-and-minified-javascript"></a><span data-ttu-id="7690a-162">Débogage du code JavaScript groupé et minimisés</span><span class="sxs-lookup"><span data-stu-id="7690a-162">Debugging Bundled and Minified JavaScript</span></span>

<span data-ttu-id="7690a-163">Il est facile de déboguer votre code JavaScript dans un environnement de développement (où l' [élément compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) du fichier *Web. config* a la valeur `debug="true"`), car les fichiers JavaScript ne sont pas regroupés ou minimisés.</span><span class="sxs-lookup"><span data-stu-id="7690a-163">It's easy to debug your JavaScript in a development environment (where the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx) in the *Web.config* file is set to `debug="true"` ) because the JavaScript files are not bundled or minified.</span></span> <span data-ttu-id="7690a-164">Vous pouvez également déboguer une version Release où vos fichiers JavaScript sont regroupés et minimisés.</span><span class="sxs-lookup"><span data-stu-id="7690a-164">You can also debug a release build where your JavaScript files are bundled and minified.</span></span> <span data-ttu-id="7690a-165">À l’aide des outils de développement Internet Explorer F12, vous déboguez une fonction JavaScript incluse dans un bundle minimisés à l’aide de l’approche suivante :</span><span class="sxs-lookup"><span data-stu-id="7690a-165">Using the IE F12 developer tools, you debug a JavaScript function included in a minified bundle using the following approach:</span></span>

1. <span data-ttu-id="7690a-166">Sélectionnez l’onglet **script** , puis cliquez sur le bouton **Démarrer le débogage** .</span><span class="sxs-lookup"><span data-stu-id="7690a-166">Select the **Script** tab and then select the **Start debugging** button.</span></span>
2. <span data-ttu-id="7690a-167">Sélectionnez le bundle contenant la fonction JavaScript que vous souhaitez déboguer à l’aide du bouton composants.</span><span class="sxs-lookup"><span data-stu-id="7690a-167">Select the bundle containing the JavaScript function you want to debug using the assets button.</span></span>  
    ![](bundling-and-minification/_static/image4.png)
3. <span data-ttu-id="7690a-168">Mettez en forme le JavaScript minimisés en sélectionnant le **bouton de Configuration** ![](bundling-and-minification/_static/image5.png), puis en sélectionnant **format JavaScript**.</span><span class="sxs-lookup"><span data-stu-id="7690a-168">Format the minified JavaScript by selecting the **Configuration button** ![](bundling-and-minification/_static/image5.png), and then selecting **Format JavaScript**.</span></span>
4. <span data-ttu-id="7690a-169">Dans la zone de texte **Rechercher un script** , sélectionnez le nom de la fonction que vous souhaitez déboguer.</span><span class="sxs-lookup"><span data-stu-id="7690a-169">In the **Search Script** input box, select the name of the function you want to debug.</span></span> <span data-ttu-id="7690a-170">Dans l’image suivante, **AddAltToImg** a été entré dans la zone de texte Rechercher dans le **script** .</span><span class="sxs-lookup"><span data-stu-id="7690a-170">In the following image, **AddAltToImg** was entered in the **Search Script** input box.</span></span>  
    ![](bundling-and-minification/_static/image6.png)

<span data-ttu-id="7690a-171">Pour plus d’informations sur le débogage avec les outils de développement F12, consultez l’article MSDN [utilisation de la touche f12 outils de développement pour déboguer les erreurs JavaScript](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="7690a-171">For more information on debugging with the F12 developer tools, see the MSDN article [Using the F12 Developer Tools to Debug JavaScript Errors](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span></span>

## <a name="controlling-bundling-and-minification"></a><span data-ttu-id="7690a-172">Contrôle du regroupement et de la minimisation</span><span class="sxs-lookup"><span data-stu-id="7690a-172">Controlling Bundling and Minification</span></span>

<span data-ttu-id="7690a-173">Le regroupement et la minimisation sont activés ou désactivés en définissant la valeur de l’attribut de débogage dans l' [élément compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) du fichier *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="7690a-173">Bundling and minification is enabled or disabled by setting the value of the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file.</span></span> <span data-ttu-id="7690a-174">Dans le code XML suivant, `debug` a la valeur true pour que le regroupement et la minimisation soient désactivés.</span><span class="sxs-lookup"><span data-stu-id="7690a-174">In the following XML, `debug` is set to true so bundling and minification is disabled.</span></span>

[!code-xml[Main](bundling-and-minification/samples/sample3.xml?highlight=2)]

<span data-ttu-id="7690a-175">Pour activer le regroupement et la minimisation, définissez la valeur `debug` sur « false ».</span><span class="sxs-lookup"><span data-stu-id="7690a-175">To enable bundling and minification, set the `debug` value to "false".</span></span> <span data-ttu-id="7690a-176">Vous pouvez remplacer le paramètre *Web. config* par la propriété `EnableOptimizations` de la classe `BundleTable`.</span><span class="sxs-lookup"><span data-stu-id="7690a-176">You can override the *Web.config* setting with the `EnableOptimizations` property on the `BundleTable` class.</span></span> <span data-ttu-id="7690a-177">Le code suivant active le regroupement et la minimisation et remplace tout paramètre dans le fichier *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="7690a-177">The following code enables bundling and minification and overrides any setting in the *Web.config* file.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample4.cs?highlight=7)]

> [!NOTE]
> <span data-ttu-id="7690a-178">Sauf si `EnableOptimizations` est `true` ou si l’attribut de débogage de l' [élément compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) dans le fichier *Web. config* est défini sur `false`, les fichiers ne seront pas regroupés ou minimisés.</span><span class="sxs-lookup"><span data-stu-id="7690a-178">Unless `EnableOptimizations` is `true` or the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file is set to `false`, files will not be bundled or minified.</span></span> <span data-ttu-id="7690a-179">En outre, la version. min des fichiers ne sera pas utilisée, les versions de débogage complètes seront sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="7690a-179">Additionally, the .min version of files will not be used, the full debug versions will be selected.</span></span> <span data-ttu-id="7690a-180">`EnableOptimizations` remplace l’attribut debug dans l' [élément compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) du fichier *Web. config*</span><span class="sxs-lookup"><span data-stu-id="7690a-180">`EnableOptimizations` overrides the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file</span></span>

## <a name="using-bundling-and-minification-with-aspnet-web-forms-and-web-pages"></a><span data-ttu-id="7690a-181">Utilisation du regroupement et de la minimisation avec ASP.NET Web Forms et les pages Web</span><span class="sxs-lookup"><span data-stu-id="7690a-181">Using Bundling and Minification with ASP.NET Web Forms and Web Pages</span></span>

- <span data-ttu-id="7690a-182">Pour les pages Web, consultez l’entrée de blog [Ajout de l’optimisation Web à un site Web pages](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span><span class="sxs-lookup"><span data-stu-id="7690a-182">For Web Pages, see the blog entry [Adding Web Optimization to a Web Pages Site](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span></span>
- <span data-ttu-id="7690a-183">Pour Web Forms, consultez l’entrée de blog [Ajout de regroupement et minimisation à Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span><span class="sxs-lookup"><span data-stu-id="7690a-183">For Web Forms, see the blog entry [Adding Bundling and Minification to Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span></span>

## <a name="using-bundling-and-minification-with-aspnet-mvc"></a><span data-ttu-id="7690a-184">Utilisation du regroupement et de la minimisation avec ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="7690a-184">Using Bundling and Minification with ASP.NET MVC</span></span>

<span data-ttu-id="7690a-185">Dans cette section, nous allons créer un projet MVC ASP.NET pour examiner le regroupement et la minimisation.</span><span class="sxs-lookup"><span data-stu-id="7690a-185">In this section we will create an ASP.NET MVC project to examine bundling and minification.</span></span> <span data-ttu-id="7690a-186">Commencez par créer un nouveau projet ASP.NET MVC Internet nommé **MvcBM** sans modifier les valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="7690a-186">First, create a new ASP.NET MVC internet project named **MvcBM** without changing any of the defaults.</span></span>

<span data-ttu-id="7690a-187">Ouvrez l' *application\\\_démarrer\\fichier BundleConfig.cs* et examinez la méthode `RegisterBundles` qui est utilisée pour créer, inscrire et configurer des offres groupées.</span><span class="sxs-lookup"><span data-stu-id="7690a-187">Open the *App\\\_Start\\BundleConfig.cs* file and examine the `RegisterBundles` method which is used to create, register and configure bundles.</span></span> <span data-ttu-id="7690a-188">Le code suivant illustre une partie de la méthode `RegisterBundles`.</span><span class="sxs-lookup"><span data-stu-id="7690a-188">The following code shows a portion of the `RegisterBundles` method.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample5.cs)]

<span data-ttu-id="7690a-189">Le code précédent crée un lot JavaScript nommé *~/bundles/jQuery* qui comprend tous les fichiers appropriés (c’est-à-dire débogage ou minimisés, mais pas. *vsdoc*) dans le dossier *scripts* qui correspondent à la chaîne générique « ~/scripts/jQuery-{version}.js ».</span><span class="sxs-lookup"><span data-stu-id="7690a-189">The  preceding code creates a new JavaScript bundle named *~/bundles/jquery* that includes all the appropriate (that is debug or minified but not .*vsdoc*) files in the *Scripts* folder that match the wild card string "~/Scripts/jquery-{version}.js".</span></span> <span data-ttu-id="7690a-190">Pour ASP.NET MVC 4, cela signifie qu’avec une configuration Debug, le fichier *jQuery-1.7.1. js* est ajouté au bundle.</span><span class="sxs-lookup"><span data-stu-id="7690a-190">For ASP.NET MVC 4, this means with a debug configuration, the file *jquery-1.7.1.js* will be added to the bundle.</span></span> <span data-ttu-id="7690a-191">Dans une configuration Release, *jQuery-1.7.1. min. js* sera ajouté.</span><span class="sxs-lookup"><span data-stu-id="7690a-191">In a release configuration, *jquery-1.7.1.min.js* will be added.</span></span> <span data-ttu-id="7690a-192">L’infrastructure de regroupement suit plusieurs conventions courantes, telles que :</span><span class="sxs-lookup"><span data-stu-id="7690a-192">The bundling framework follows several common conventions such as:</span></span>

- <span data-ttu-id="7690a-193">Sélection du fichier « . min » pour la mise en sortie quand *FileX. min. js* et *FileX. js* existent.</span><span class="sxs-lookup"><span data-stu-id="7690a-193">Selecting ".min" file for release when *FileX.min.js* and *FileX.js* exist.</span></span>
- <span data-ttu-id="7690a-194">Sélection de la version non « . min » pour Debug.</span><span class="sxs-lookup"><span data-stu-id="7690a-194">Selecting the non ".min" version for debug.</span></span>
- <span data-ttu-id="7690a-195">Fichiers « -vsdoc » ignorés (par exemple, *jQuery-1.7.1-vsdoc. js*), utilisés uniquement par IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="7690a-195">Ignoring "-vsdoc" files (such as *jquery-1.7.1-vsdoc.js*), which are used only by IntelliSense.</span></span>

<span data-ttu-id="7690a-196">Le `{version}` caractère générique correspondant indiqué ci-dessus est utilisé pour créer automatiquement un bundle jQuery avec la version appropriée de jQuery dans votre dossier de *scripts* .</span><span class="sxs-lookup"><span data-stu-id="7690a-196">The `{version}` wild card matching shown above is used to automatically create a jQuery bundle with the appropriate version of jQuery in your *Scripts* folder.</span></span> <span data-ttu-id="7690a-197">Dans cet exemple, l’utilisation d’un caractère générique offre les avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="7690a-197">In this example, using a wild card provides the following benefits:</span></span>

- <span data-ttu-id="7690a-198">Vous permet d’utiliser NuGet pour effectuer une mise à jour vers une version jQuery plus récente sans modifier le code de regroupement précédent ou les références jQuery dans vos pages d’affichage.</span><span class="sxs-lookup"><span data-stu-id="7690a-198">Allows you to use NuGet to update to a newer jQuery version without changing the preceding bundling code or jQuery references in your view pages.</span></span>
- <span data-ttu-id="7690a-199">Sélectionne automatiquement la version complète des configurations de débogage et la version « . min » pour les versions release.</span><span class="sxs-lookup"><span data-stu-id="7690a-199">Automatically selects the full version for debug configurations and the ".min" version for release builds.</span></span>

## <a name="using-a-cdn"></a><span data-ttu-id="7690a-200">Utilisation d’un CDN</span><span class="sxs-lookup"><span data-stu-id="7690a-200">Using a CDN</span></span>

 <span data-ttu-id="7690a-201">Le code suivant remplace l’offre jQuery locale par un bundle jQuery de CDN.</span><span class="sxs-lookup"><span data-stu-id="7690a-201">The follow code replaces the local jQuery bundle with a CDN jQuery bundle.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample6.cs)]

<span data-ttu-id="7690a-202">Dans le code ci-dessus, jQuery sera demandé à partir du CDN en mode release et la version Debug de jQuery sera extraite localement en mode débogage.</span><span class="sxs-lookup"><span data-stu-id="7690a-202">In the code above, jQuery will be requested from the CDN while in release mode and the debug version of jQuery will be fetched locally in debug mode.</span></span> <span data-ttu-id="7690a-203">Lorsque vous utilisez un CDN, vous devez disposer d’un mécanisme de secours en cas d’échec de la demande CDN.</span><span class="sxs-lookup"><span data-stu-id="7690a-203">When using a CDN, you should have a fallback mechanism in case the CDN request fails.</span></span> <span data-ttu-id="7690a-204">Le fragment de balisage suivant à partir de la fin du fichier de disposition indique que le script a été ajouté pour demander jQuery si le CDN échoue.</span><span class="sxs-lookup"><span data-stu-id="7690a-204">The following markup fragment from the end of the layout file shows script added to request jQuery should the CDN fail.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample7.cshtml?highlight=5-13)]

## <a name="creating-a-bundle"></a><span data-ttu-id="7690a-205">Création d’un bundle</span><span class="sxs-lookup"><span data-stu-id="7690a-205">Creating a Bundle</span></span>

<span data-ttu-id="7690a-206">La classe [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `Include` méthode prend un tableau de chaînes, où chaque chaîne est un chemin d’accès virtuel à la ressource.</span><span class="sxs-lookup"><span data-stu-id="7690a-206">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `Include` method takes an array of strings, where each string is a virtual path to resource.</span></span> <span data-ttu-id="7690a-207">Le code suivant de la méthode `RegisterBundles` dans l' *application\\\_Start\\fichier BundleConfig.cs* montre comment plusieurs fichiers sont ajoutés à un bundle :</span><span class="sxs-lookup"><span data-stu-id="7690a-207">The following code from the `RegisterBundles` method in the *App\\\_Start\\BundleConfig.cs* file shows how multiple files are added to a bundle:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample8.cs)]

<span data-ttu-id="7690a-208">La classe [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `IncludeDirectory` méthode est fournie pour ajouter tous les fichiers d’un répertoire (et éventuellement tous ses sous-répertoires) qui correspondent à un modèle de recherche.</span><span class="sxs-lookup"><span data-stu-id="7690a-208">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` method is provided to add all the files in a directory (and optionally all subdirectories) which match a search pattern.</span></span> <span data-ttu-id="7690a-209">La classe [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `IncludeDirectory` API est illustrée ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="7690a-209">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` API is shown below:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample9.cs)]

<span data-ttu-id="7690a-210">Les offres groupées sont référencées dans les vues à l’aide de la méthode Render, (`Styles.Render` pour CSS et `Scripts.Render` pour JavaScript).</span><span class="sxs-lookup"><span data-stu-id="7690a-210">Bundles are referenced in views using the Render method, (`Styles.Render` for CSS and `Scripts.Render` for JavaScript).</span></span> <span data-ttu-id="7690a-211">Le balisage suivant des *vues\\fichier shared\\\_Layout. cshtml* montre comment les vues de projet Internet ASP.NET par défaut référencent les lots CSS et JavaScript.</span><span class="sxs-lookup"><span data-stu-id="7690a-211">The following markup from the *Views\\Shared\\\_Layout.cshtml* file shows how the default ASP.NET internet project views reference CSS and JavaScript bundles.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample10.cshtml?highlight=5-6,11)]

<span data-ttu-id="7690a-212">Notez que les méthodes Render prennent un tableau de chaînes, ce qui vous permet d’ajouter plusieurs offres groupées en une seule ligne de code.</span><span class="sxs-lookup"><span data-stu-id="7690a-212">Notice the Render methods takes an array of strings, so you can add multiple bundles in one line of code.</span></span> <span data-ttu-id="7690a-213">En général, vous souhaitez utiliser les méthodes Render qui créent le code HTML nécessaire pour référencer l’élément multimédia.</span><span class="sxs-lookup"><span data-stu-id="7690a-213">You will generally want to use the Render methods which create the necessary HTML to reference the asset.</span></span> <span data-ttu-id="7690a-214">Vous pouvez utiliser la méthode `Url` pour générer l’URL de l’élément multimédia sans le balisage nécessaire pour faire référence à l’élément multimédia.</span><span class="sxs-lookup"><span data-stu-id="7690a-214">You can use the `Url` method to generate the URL to the asset without the markup needed to reference the asset.</span></span> <span data-ttu-id="7690a-215">Supposons que vous souhaitiez utiliser le nouvel attribut HTML5 [Async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) .</span><span class="sxs-lookup"><span data-stu-id="7690a-215">Suppose you wanted to use the new HTML5 [async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) attribute.</span></span> <span data-ttu-id="7690a-216">Le code suivant montre comment faire référence à Modernizr à l’aide de la méthode `Url`.</span><span class="sxs-lookup"><span data-stu-id="7690a-216">The following code shows how to reference modernizr using the `Url` method.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample11.cshtml?highlight=11)]

## <a name="using-the--wildcard-character-to-select-files"></a><span data-ttu-id="7690a-217">Utilisation du caractère générique «\*» pour sélectionner des fichiers</span><span class="sxs-lookup"><span data-stu-id="7690a-217">Using the "\*" Wildcard Character to Select Files</span></span>

<span data-ttu-id="7690a-218">Le chemin d’accès virtuel spécifié dans la méthode `Include` et le modèle de recherche dans la méthode `IncludeDirectory` peuvent accepter un caractère générique «\*» comme préfixe ou suffixe dans le dernier segment de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="7690a-218">The virtual path specified in the `Include` method and the search pattern in the `IncludeDirectory` method can accept one "\*" wildcard character as a prefix or suffix to in the last path segment.</span></span> <span data-ttu-id="7690a-219">La chaîne de recherche ne respecte pas la casse.</span><span class="sxs-lookup"><span data-stu-id="7690a-219">The search string is case insensitive.</span></span> <span data-ttu-id="7690a-220">La méthode `IncludeDirectory` a la possibilité de rechercher des sous-répertoires.</span><span class="sxs-lookup"><span data-stu-id="7690a-220">The `IncludeDirectory` method has the option of searching subdirectories.</span></span>

<span data-ttu-id="7690a-221">Imaginez un projet avec les fichiers JavaScript suivants :</span><span class="sxs-lookup"><span data-stu-id="7690a-221">Consider a project with the following JavaScript files:</span></span>

- <span data-ttu-id="7690a-222">*Scripts\\Common\\AddAltToImg. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-222">*Scripts\\Common\\AddAltToImg.js*</span></span>
- <span data-ttu-id="7690a-223">*Scripts\\Common\\ToggleDiv. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-223">*Scripts\\Common\\ToggleDiv.js*</span></span>
- <span data-ttu-id="7690a-224">*Scripts\\Common\\ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-224">*Scripts\\Common\\ToggleImg.js*</span></span>
- <span data-ttu-id="7690a-225">*Scripts\\\\s courantes Sub1\\ToggleLinks. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-225">*Scripts\\Common\\Sub1\\ToggleLinks.js*</span></span>

![Répertoire imag](bundling-and-minification/_static/image7.png)

<span data-ttu-id="7690a-227">Le tableau suivant montre les fichiers ajoutés à un regroupement à l’aide du caractère générique, comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="7690a-227">The following table shows the files added to a bundle using the wildcard as shown:</span></span>

| <span data-ttu-id="7690a-228">**Call**</span><span class="sxs-lookup"><span data-stu-id="7690a-228">**Call**</span></span> | <span data-ttu-id="7690a-229">**Fichiers ajoutés ou exception levée**</span><span class="sxs-lookup"><span data-stu-id="7690a-229">**Files Added or Exception Raised**</span></span> |
| --- | --- |
| <span data-ttu-id="7690a-230">Include ("~/Scripts/Common/\*. js")</span><span class="sxs-lookup"><span data-stu-id="7690a-230">Include("~/Scripts/Common/\*.js")</span></span> | <span data-ttu-id="7690a-231">*AddAltToImg. js*, *ToggleDiv. js*, *ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="7690a-232">Include ("~/Scripts/Common/T\*. js")</span><span class="sxs-lookup"><span data-stu-id="7690a-232">Include("~/Scripts/Common/T\*.js")</span></span> | <span data-ttu-id="7690a-233">Exception de modèle non valide.</span><span class="sxs-lookup"><span data-stu-id="7690a-233">Invalid pattern exception.</span></span> <span data-ttu-id="7690a-234">Le caractère générique est uniquement autorisé sur le préfixe ou le suffixe.</span><span class="sxs-lookup"><span data-stu-id="7690a-234">The wildcard character is only allowed on the prefix or suffix.</span></span> |
| <span data-ttu-id="7690a-235">Include ("~/Scripts/Common/\*og.\*»)</span><span class="sxs-lookup"><span data-stu-id="7690a-235">Include("~/Scripts/Common/\*og.\*")</span></span> | <span data-ttu-id="7690a-236">Exception de modèle non valide.</span><span class="sxs-lookup"><span data-stu-id="7690a-236">Invalid pattern exception.</span></span> <span data-ttu-id="7690a-237">Un seul caractère générique est autorisé.</span><span class="sxs-lookup"><span data-stu-id="7690a-237">Only one wildcard character is allowed.</span></span> |
| <span data-ttu-id="7690a-238">Include ("~/Scripts/Common/T\*")</span><span class="sxs-lookup"><span data-stu-id="7690a-238">Include("~/Scripts/Common/T\*")</span></span> | <span data-ttu-id="7690a-239">*ToggleDiv. js*, *ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-239">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="7690a-240">Include ("~/Scripts/Common/\*")</span><span class="sxs-lookup"><span data-stu-id="7690a-240">Include("~/Scripts/Common/\*")</span></span> | <span data-ttu-id="7690a-241">Exception de modèle non valide.</span><span class="sxs-lookup"><span data-stu-id="7690a-241">Invalid pattern exception.</span></span> <span data-ttu-id="7690a-242">Un segment de caractère générique pur n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="7690a-242">A pure wildcard segment is not valid.</span></span> |
| <span data-ttu-id="7690a-243">IncludeDirectory ("~/Scripts/Common", "T\*")</span><span class="sxs-lookup"><span data-stu-id="7690a-243">IncludeDirectory("~/Scripts/Common", "T\*")</span></span> | <span data-ttu-id="7690a-244">*ToggleDiv. js*, *ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-244">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="7690a-245">IncludeDirectory ("~/Scripts/Common", "T\*", true)</span><span class="sxs-lookup"><span data-stu-id="7690a-245">IncludeDirectory("~/Scripts/Common", "T\*", true)</span></span> | <span data-ttu-id="7690a-246">*ToggleDiv. js*, *ToggleImg. js*, *ToggleLinks. js*</span><span class="sxs-lookup"><span data-stu-id="7690a-246">*ToggleDiv.js*, *ToggleImg.js*, *ToggleLinks.js*</span></span> |

<span data-ttu-id="7690a-247">L’ajout explicite de chaque fichier à un bundle est généralement le chargement par défaut des fichiers avec caractères génériques, pour les raisons suivantes :</span><span class="sxs-lookup"><span data-stu-id="7690a-247">Explicitly adding each file to a bundle is generally the preferred over wildcard loading of files for the following reasons:</span></span>

- <span data-ttu-id="7690a-248">Par défaut, l’ajout de scripts par défaut permet de les charger dans l’ordre alphabétique, ce qui n’est généralement pas ce que vous voulez.</span><span class="sxs-lookup"><span data-stu-id="7690a-248">Adding scripts by wildcard defaults to loading them in alphabetical order, which is typically not what you want.</span></span> <span data-ttu-id="7690a-249">Les fichiers CSS et JavaScript doivent souvent être ajoutés dans un ordre spécifique (non alphabétique).</span><span class="sxs-lookup"><span data-stu-id="7690a-249">CSS and JavaScript files frequently need to be added in a specific (non-alphabetic) order.</span></span> <span data-ttu-id="7690a-250">Vous pouvez réduire ce risque en ajoutant une implémentation personnalisée de [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) , mais l’ajout explicite de chaque fichier est moins sujet aux erreurs.</span><span class="sxs-lookup"><span data-stu-id="7690a-250">You can mitigate this risk by adding a custom [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation, but explicitly adding each file is less error prone.</span></span> <span data-ttu-id="7690a-251">Par exemple, vous pouvez ajouter de nouvelles ressources à un dossier à l’avenir, ce qui peut nécessiter la modification de votre implémentation de [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="7690a-251">For example, you might add new assets to a folder in the future which might require you to modify your [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation.</span></span>
- <span data-ttu-id="7690a-252">Les fichiers spécifiques ajoutés à un répertoire à l’aide du chargement de caractères génériques peuvent être inclus dans toutes les vues qui font référence à cette offre groupée.</span><span class="sxs-lookup"><span data-stu-id="7690a-252">View specific files added to a directory using wild card loading can be included in all views referencing that bundle.</span></span> <span data-ttu-id="7690a-253">Si le script de vue spécifique est ajouté à un bundle, vous pouvez obtenir une erreur JavaScript sur d’autres vues qui référencent le bundle.</span><span class="sxs-lookup"><span data-stu-id="7690a-253">If the view specific script is added to a bundle, you may get a JavaScript error on other views that reference the bundle.</span></span>
- <span data-ttu-id="7690a-254">Les fichiers CSS qui importent d’autres fichiers entraînent le chargement des fichiers importés deux fois.</span><span class="sxs-lookup"><span data-stu-id="7690a-254">CSS files that import other files result in the imported files loaded twice.</span></span> <span data-ttu-id="7690a-255">Par exemple, le code suivant crée un bundle avec la plupart des fichiers CSS de thème de l’interface utilisateur jQuery chargés à deux reprises.</span><span class="sxs-lookup"><span data-stu-id="7690a-255">For example, the following code creates a bundle with most of the jQuery UI theme CSS files loaded twice.</span></span> 

    [!code-csharp[Main](bundling-and-minification/samples/sample12.cs)]

  <span data-ttu-id="7690a-256">Le sélecteur de caractères génériques «\*. CSS » réunit chaque fichier CSS dans le dossier, y compris le *contenu\\thèmes\\base\\le fichier jQuery. UI. All. CSS* .</span><span class="sxs-lookup"><span data-stu-id="7690a-256">The wild card selector "\*.css" brings in each CSS file in the folder, including the *Content\\themes\\base\\jquery.ui.all.css* file.</span></span> <span data-ttu-id="7690a-257">Le fichier *jQuery. UI. All. CSS* importe d’autres fichiers CSS.</span><span class="sxs-lookup"><span data-stu-id="7690a-257">The *jquery.ui.all.css* file imports other CSS files.</span></span>

## <a name="bundle-caching"></a><span data-ttu-id="7690a-258">Mise en cache de Bundle</span><span class="sxs-lookup"><span data-stu-id="7690a-258">Bundle Caching</span></span>

<span data-ttu-id="7690a-259">Les offres groupées définissent l’en-tête HTTP Expires un an à partir de la création du bundle.</span><span class="sxs-lookup"><span data-stu-id="7690a-259">Bundles set the HTTP Expires Header one year from when the bundle is created.</span></span> <span data-ttu-id="7690a-260">Si vous accédez à une page précédemment affichée, Fiddler indique qu’IE n’effectue pas de demande conditionnelle pour le bundle, autrement dit, qu’il n’y a aucune requête HTTP obtenir provenant d’IE pour les offres groupées et aucune réponse HTTP 304 du serveur.</span><span class="sxs-lookup"><span data-stu-id="7690a-260">If you navigate to a previously viewed page, Fiddler shows IE does not make a conditional request for the bundle, that is, there are no HTTP GET requests from IE for the bundles and no HTTP 304 responses from the server.</span></span> <span data-ttu-id="7690a-261">Vous pouvez forcer IE à effectuer une demande conditionnelle pour chaque bundle avec la touche F5 (ce qui génère une réponse HTTP 304 pour chaque Bundle).</span><span class="sxs-lookup"><span data-stu-id="7690a-261">You can force IE to make a conditional request for each bundle with the F5 key (resulting in a HTTP 304 response for each bundle).</span></span> <span data-ttu-id="7690a-262">Vous pouvez forcer une actualisation complète en utilisant ^ F5 (ce qui génère une réponse HTTP 200 pour chaque bundle.)</span><span class="sxs-lookup"><span data-stu-id="7690a-262">You can force a full refresh by using ^F5 (resulting in a HTTP 200 response for each bundle.)</span></span>

<span data-ttu-id="7690a-263">L’illustration suivante montre l’onglet **mise en cache** du volet de réponse Fiddler :</span><span class="sxs-lookup"><span data-stu-id="7690a-263">The following image shows the **Caching** tab of the Fiddler response pane:</span></span>

![image de mise en cache Fiddler](bundling-and-minification/_static/image8.png)

<span data-ttu-id="7690a-265">Requête.</span><span class="sxs-lookup"><span data-stu-id="7690a-265">The request</span></span>   
`http://localhost/MvcBM_time/bundles/AllMyScripts?v=r0sLDicvP58AIXN_mc3QdyVvVj5euZNzdsa2N1PKvb81`  
 <span data-ttu-id="7690a-266">est pour le bundle **AllMyScripts** et contient une paire de chaînes de requête **v = R0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span><span class="sxs-lookup"><span data-stu-id="7690a-266">is for the bundle **AllMyScripts** and contains a query string pair **v=r0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span></span> <span data-ttu-id="7690a-267">La chaîne de requête **v** a un jeton de valeur qui est un identificateur unique utilisé pour la mise en cache.</span><span class="sxs-lookup"><span data-stu-id="7690a-267">The query string **v** has a value token that is a unique identifier used for caching.</span></span> <span data-ttu-id="7690a-268">Tant que le bundle n’est pas modifié, l’application ASP.NET demande le bundle **AllMyScripts** à l’aide de ce jeton.</span><span class="sxs-lookup"><span data-stu-id="7690a-268">As long as the bundle doesn't change, the ASP.NET application will request the **AllMyScripts** bundle using this token.</span></span> <span data-ttu-id="7690a-269">Si un fichier du bundle change, l’infrastructure d’optimisation ASP.NET génère un nouveau jeton, garantissant ainsi que les demandes de navigateur pour le bundle obtiendront le dernier bundle.</span><span class="sxs-lookup"><span data-stu-id="7690a-269">If any file in the bundle changes, the ASP.NET optimization framework will generate a new token, guaranteeing that browser requests for the bundle will get the latest bundle.</span></span>

<span data-ttu-id="7690a-270">Si vous exécutez les outils de développement IE9 F12 et que vous accédez à une page précédemment chargée, IE affiche incorrectement les demandes d’accès conditionnel effectuées à chaque Bundle et le serveur retournant HTTP 304.</span><span class="sxs-lookup"><span data-stu-id="7690a-270">If you run the IE9 F12 developer tools and navigate to a previously loaded page, IE incorrectly shows conditional GET requests made to each bundle and the server returning HTTP 304.</span></span> <span data-ttu-id="7690a-271">Vous pouvez lire Pourquoi IE9 a des problèmes pour déterminer si une demande conditionnelle a été effectuée dans l’entrée de blog [à l’aide de CDN et expire pour améliorer les performances du site Web](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="7690a-271">You can read why IE9 has problems determining if a conditional request was made in the blog entry [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

## <a name="less-coffeescript-scss-sass-bundling"></a><span data-ttu-id="7690a-272">MOINS, CoffeeScript, SCSS, regroupement Sass.</span><span class="sxs-lookup"><span data-stu-id="7690a-272">LESS, CoffeeScript, SCSS, Sass Bundling.</span></span>

<span data-ttu-id="7690a-273">L’infrastructure de regroupement et de minimisation fournit un mécanisme de traitement des langages intermédiaires tels que [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [less](http://www.dotlesscss.org/) ou [CoffeeScript](http://coffeescript.org/), et applique des transformations telles que la minimisation au Bundle résultant.</span><span class="sxs-lookup"><span data-stu-id="7690a-273">The bundling and minification framework provides a mechanism to process intermediate languages such as [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [LESS](http://www.dotlesscss.org/) or [Coffeescript](http://coffeescript.org/), and apply transforms such as minification to the resulting bundle.</span></span> <span data-ttu-id="7690a-274">Par exemple, pour ajouter des fichiers [. less](http://www.dotlesscss.org/) à votre projet MVC 4 :</span><span class="sxs-lookup"><span data-stu-id="7690a-274">For example, to add [.less](http://www.dotlesscss.org/) files to your MVC 4 project:</span></span>

1. <span data-ttu-id="7690a-275">Créez un dossier pour votre contenu moins cher.</span><span class="sxs-lookup"><span data-stu-id="7690a-275">Create a folder for your LESS content.</span></span> <span data-ttu-id="7690a-276">L’exemple suivant utilise le dossier *Content\\MyLess* .</span><span class="sxs-lookup"><span data-stu-id="7690a-276">The following example uses the *Content\\MyLess* folder.</span></span>
2. <span data-ttu-id="7690a-277">Ajoutez **le package NuGet** [. moins sans](http://www.dotlesscss.org/) point à votre projet.</span><span class="sxs-lookup"><span data-stu-id="7690a-277">Add the [.less](http://www.dotlesscss.org/) NuGet package **dotless** to your project.</span></span>  
    <span data-ttu-id="7690a-278">![installation sans point NuGet](bundling-and-minification/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="7690a-278">![NuGet dotless install](bundling-and-minification/_static/image9.png)</span></span>
3. <span data-ttu-id="7690a-279">Ajoutez une classe qui implémente l’interface [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="7690a-279">Add a class that implements the [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) interface.</span></span> <span data-ttu-id="7690a-280">Pour la transformation. less, ajoutez le code suivant à votre projet.</span><span class="sxs-lookup"><span data-stu-id="7690a-280">For the .less transform, add the following code to your project.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample13.cs)]
4. <span data-ttu-id="7690a-281">Créez un groupe de fichiers moins avec les `LessTransform` et la transformation [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="7690a-281">Create a bundle of LESS files with the `LessTransform` and the [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) transform.</span></span> <span data-ttu-id="7690a-282">Ajoutez le code suivant à la méthode `RegisterBundles` dans le *\\d’application _Start\\fichier BundleConfig.cs* .</span><span class="sxs-lookup"><span data-stu-id="7690a-282">Add the following code to the `RegisterBundles` method in the *App\\_Start\\BundleConfig.cs* file.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample14.cs)]
5. <span data-ttu-id="7690a-283">Ajoutez le code suivant à toutes les vues qui font référence à l’offre moins groupée.</span><span class="sxs-lookup"><span data-stu-id="7690a-283">Add the following code to any views which references the LESS bundle.</span></span>

    [!code-cshtml[Main](bundling-and-minification/samples/sample15.cshtml)]

## <a name="bundle-considerations"></a><span data-ttu-id="7690a-284">Considérations relatives au Bundle</span><span class="sxs-lookup"><span data-stu-id="7690a-284">Bundle Considerations</span></span>

<span data-ttu-id="7690a-285">Une bonne Convention à suivre lors de la création d’offres groupées consiste à inclure « Bundle » comme préfixe dans le nom du bundle.</span><span class="sxs-lookup"><span data-stu-id="7690a-285">A good convention to follow when creating bundles is to include "bundle" as a prefix in the bundle name.</span></span> <span data-ttu-id="7690a-286">Cela empêchera un éventuel [conflit de routage](https://forums.asp.net/post/5012037.aspx).</span><span class="sxs-lookup"><span data-stu-id="7690a-286">This will prevent a possible [routing conflict](https://forums.asp.net/post/5012037.aspx).</span></span>

<span data-ttu-id="7690a-287">Une fois que vous avez mis à jour un fichier dans un bundle, un nouveau jeton est généré pour le paramètre de chaîne de requête de Bundle et le bundle complet doit être téléchargé la prochaine fois qu’un client demande une page contenant le bundle.</span><span class="sxs-lookup"><span data-stu-id="7690a-287">Once you update one file in a bundle, a new token is generated for the bundle query string parameter and the full bundle must be downloaded the next time a client requests a page containing the bundle.</span></span> <span data-ttu-id="7690a-288">Dans le balisage traditionnel où chaque élément multimédia est listé individuellement, seul le fichier modifié est téléchargé.</span><span class="sxs-lookup"><span data-stu-id="7690a-288">In traditional markup where each asset is listed individually, only the changed file would be downloaded.</span></span> <span data-ttu-id="7690a-289">Les ressources qui changent fréquemment peuvent ne pas être de bons candidats pour le regroupement.</span><span class="sxs-lookup"><span data-stu-id="7690a-289">Assets that change frequently may not be good candidates for bundling.</span></span>

<span data-ttu-id="7690a-290">Le regroupement et la minimisation améliorent principalement le temps de chargement de la première page de la demande.</span><span class="sxs-lookup"><span data-stu-id="7690a-290">Bundling and minification primarily improve the first page request load time.</span></span> <span data-ttu-id="7690a-291">Une fois qu’une page Web a été demandée, le navigateur met en cache les éléments multimédias (JavaScript, CSS et images), de sorte que le regroupement et la minimisation n’offrent aucune amélioration des performances lors de la demande de la même page ou des pages sur le même site qui demandent les mêmes ressources.</span><span class="sxs-lookup"><span data-stu-id="7690a-291">Once a webpage has been requested, the browser caches the assets (JavaScript, CSS and images) so bundling and minification won't provide any performance boost when requesting the same page, or pages on the same site requesting the same assets.</span></span> <span data-ttu-id="7690a-292">Si vous ne définissez pas correctement l’en-tête Expires sur vos ressources et que vous n’utilisez pas le regroupement et la minimisation, les heuristiques d’actualisation des navigateurs marqueront les ressources obsolètes après quelques jours et le navigateur nécessitera une demande de validation pour chaque ressource.</span><span class="sxs-lookup"><span data-stu-id="7690a-292">If you don't set the expires header correctly on your assets, and you don't use bundling and minification, the browsers freshness heuristics will mark the assets stale after a few days and the browser will require a validation request for each asset.</span></span> <span data-ttu-id="7690a-293">Dans ce cas, le regroupement et la minimisation offrent une augmentation des performances après la première demande de page.</span><span class="sxs-lookup"><span data-stu-id="7690a-293">In this case, bundling and minification provide a performance increase after the first page request.</span></span> <span data-ttu-id="7690a-294">Pour plus d’informations, consultez le blog [utilisation de CDN et Expires pour améliorer les performances d’un site Web](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="7690a-294">For details, see the blog [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

<span data-ttu-id="7690a-295">La limitation du navigateur de six connexions simultanées par nom d’hôte peut être atténuée à l’aide d’un [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="7690a-295">The browser limitation of six simultaneous connections per each hostname can be mitigated by using a [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span> <span data-ttu-id="7690a-296">Étant donné que le CDN aura un nom d’hôte différent de celui de votre site d’hébergement, les demandes de ressources du CDN ne seront pas décomptées par rapport à la limite de six connexions simultanées à votre environnement d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="7690a-296">Because the CDN will have a different hostname than your hosting site, asset requests from the CDN will not count against the six simultaneous connections limit to your hosting environment.</span></span> <span data-ttu-id="7690a-297">Un CDN peut également fournir des avantages courants en matière de mise en cache de packages et de mise en cache Edge.</span><span class="sxs-lookup"><span data-stu-id="7690a-297">A CDN can also provide common package caching and edge caching advantages.</span></span>

<span data-ttu-id="7690a-298">Les lots doivent être partitionnés par les pages qui en ont besoin.</span><span class="sxs-lookup"><span data-stu-id="7690a-298">Bundles should be partitioned by pages that need them.</span></span> <span data-ttu-id="7690a-299">Par exemple, le modèle MVC ASP.NET par défaut pour une application Internet crée un bundle de validation jQuery distinct de jQuery.</span><span class="sxs-lookup"><span data-stu-id="7690a-299">For example, the default ASP.NET MVC template for an internet application creates a jQuery Validation bundle separate from jQuery.</span></span> <span data-ttu-id="7690a-300">Comme les vues par défaut créées n’ont pas d’entrée et ne publient pas de valeurs, elles n’incluent pas le bundle de validation.</span><span class="sxs-lookup"><span data-stu-id="7690a-300">Because the default views created have no input and do not post values, they don't include the validation bundle.</span></span>

<span data-ttu-id="7690a-301">L’espace de noms `System.Web.Optimization` est implémenté dans *System. Web. Optimization. dll*.</span><span class="sxs-lookup"><span data-stu-id="7690a-301">The `System.Web.Optimization` namespace is implemented in *System.Web.Optimization.dll*.</span></span> <span data-ttu-id="7690a-302">Elle tire parti de la bibliothèque webgraissage (*webgraisse. dll*) pour les capacités de minimisation, qui à son tour utilise *Antlr3. Runtime. dll*.</span><span class="sxs-lookup"><span data-stu-id="7690a-302">It leverages the WebGrease library (*WebGrease.dll*) for minification capabilities, which in turn uses *Antlr3.Runtime.dll*.</span></span>

<span data-ttu-id="7690a-303">*J’utilise Twitter pour effectuer des publications rapides et partager des liens. Mon handle Twitter est*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="7690a-303">*I use Twitter to make quick posts and share links. My Twitter handle is*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="7690a-304">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="7690a-304">Additional resources</span></span>

- <span data-ttu-id="7690a-305">Vidéo :[regroupement et optimisation](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) par [Howard Dierking](https://twitter.com/#!/howard_dierking)</span><span class="sxs-lookup"><span data-stu-id="7690a-305">Video:[Bundling and Optimizing](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) by [Howard Dierking](https://twitter.com/#!/howard_dierking)</span></span>
- <span data-ttu-id="7690a-306">[Ajout de l’optimisation Web à un site Web pages](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span><span class="sxs-lookup"><span data-stu-id="7690a-306">[Adding Web Optimization to a Web Pages Site](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span></span>
- <span data-ttu-id="7690a-307">[Ajout d’un regroupement et minimisation à Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span><span class="sxs-lookup"><span data-stu-id="7690a-307">[Adding Bundling and Minification to Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span></span>
- <span data-ttu-id="7690a-308">[Implications sur les performances du regroupement et de la minimisation sur la navigation Web](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) par [clément F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span><span class="sxs-lookup"><span data-stu-id="7690a-308">[Performance Implications of Bundling and Minification on Web Browsing](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) by [Henrik F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span></span>
- <span data-ttu-id="7690a-309">[L’utilisation de CDN et expire pour améliorer les performances des sites Web](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) par Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="7690a-309">[Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) by Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span></span>
- [<span data-ttu-id="7690a-310">Réduire le temps RTT (aller-retour)</span><span class="sxs-lookup"><span data-stu-id="7690a-310">Minimize RTT (round-trip times)</span></span>](https://developers.google.com/speed/docs/best-practices/rtt)

## <a name="contributors"></a><span data-ttu-id="7690a-311">Contributors</span><span class="sxs-lookup"><span data-stu-id="7690a-311">Contributors</span></span>

- <span data-ttu-id="7690a-312">Hao Kung</span><span class="sxs-lookup"><span data-stu-id="7690a-312">Hao Kung</span></span>
- [<span data-ttu-id="7690a-313">Howard Dierking</span><span class="sxs-lookup"><span data-stu-id="7690a-313">Howard Dierking</span></span>](https://twitter.com/#!/howard_dierking)
- <span data-ttu-id="7690a-314">Diana LaRose</span><span class="sxs-lookup"><span data-stu-id="7690a-314">Diana LaRose</span></span>
