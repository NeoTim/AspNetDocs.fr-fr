---
uid: mvc/overview/security/preventing-open-redirection-attacks
title: Prévention des attaques par Redirection ouverte (c#) | Microsoft Docs
author: jongalloway
description: Ce didacticiel explique comment vous pouvez empêcher les attaques par redirection ouverte dans vos applications ASP.NET MVC. Ce didacticiel décrit les modifications qui ont été apportées...
ms.author: riande
ms.date: 02/27/2014
ms.assetid: 69fb02e0-f5b7-4c35-878c-fa87164fc785
msc.legacyurl: /mvc/overview/security/preventing-open-redirection-attacks
msc.type: authoredcontent
ms.openlocfilehash: cfa635d4fd14d031993c5b452325cbe334f82dc2
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65126434"
---
# <a name="preventing-open-redirection-attacks-c"></a><span data-ttu-id="30d8f-104">Blocage des attaques par redirection ouverte (C#)</span><span class="sxs-lookup"><span data-stu-id="30d8f-104">Preventing Open Redirection Attacks (C#)</span></span>

<span data-ttu-id="30d8f-105">par [Jon Galloway](https://github.com/jongalloway)</span><span class="sxs-lookup"><span data-stu-id="30d8f-105">by [Jon Galloway](https://github.com/jongalloway)</span></span>

> <span data-ttu-id="30d8f-106">Ce didacticiel explique comment vous pouvez empêcher les attaques par redirection ouverte dans vos applications ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="30d8f-106">This tutorial explains how you can prevent open redirection attacks in your ASP.NET MVC applications.</span></span> <span data-ttu-id="30d8f-107">Ce didacticiel décrit les modifications qui ont été apportées dans le contrôle AccountController dans ASP.NET MVC 3 et montre comment vous pouvez appliquer ces modifications dans votre ASP.NET MVC 1.0 existante et 2 applications.</span><span class="sxs-lookup"><span data-stu-id="30d8f-107">This tutorial discusses the changes that have been made in the AccountController in ASP.NET MVC 3 and demonstrates how you can apply these changes in your existing ASP.NET MVC 1.0 and 2 applications.</span></span>

## <a name="what-is-an-open-redirection-attack"></a><span data-ttu-id="30d8f-108">Qu’est une attaque de Redirection ouverte ?</span><span class="sxs-lookup"><span data-stu-id="30d8f-108">What is an Open Redirection Attack?</span></span>

<span data-ttu-id="30d8f-109">N’importe quelle application web qui redirige vers une URL qui est spécifiée par le biais de la demande tels que les données de chaîne de requête ou un formulaire peut potentiellement être falsifiée rediriger les utilisateurs vers une URL externe, malveillante.</span><span class="sxs-lookup"><span data-stu-id="30d8f-109">Any web application that redirects to a URL that is specified via the request such as the querystring or form data can potentially be tampered with to redirect users to an external, malicious URL.</span></span> <span data-ttu-id="30d8f-110">Cette manipulation est appelée une attaque de redirection ouverte.</span><span class="sxs-lookup"><span data-stu-id="30d8f-110">This tampering is called an open redirection attack.</span></span>

<span data-ttu-id="30d8f-111">Chaque fois que votre logique d’application redirige vers une URL spécifiée, vous devez vérifier que l’URL de redirection n’a pas été falsifiée.</span><span class="sxs-lookup"><span data-stu-id="30d8f-111">Whenever your application logic redirects to a specified URL, you must verify that the redirection URL hasn't been tampered with.</span></span> <span data-ttu-id="30d8f-112">La connexion utilisée dans la valeur par défaut AccountController pour ASP.NET MVC 1.0 et ASP.NET MVC 2 est vulnérable aux attaques par redirection d’ouvrir.</span><span class="sxs-lookup"><span data-stu-id="30d8f-112">The login used in the default AccountController for both ASP.NET MVC 1.0 and ASP.NET MVC 2 is vulnerable to open redirection attacks.</span></span> <span data-ttu-id="30d8f-113">Heureusement, il est facile de mettre à jour vos applications existantes pour utiliser les corrections à partir de la version préliminaire de ASP.NET MVC 3.</span><span class="sxs-lookup"><span data-stu-id="30d8f-113">Fortunately, it is easy to update your existing applications to use the corrections from the ASP.NET MVC 3 Preview.</span></span>

<span data-ttu-id="30d8f-114">Pour comprendre la vulnérabilité, examinons le fonctionnement de la redirection de connexion dans un projet d’Application Web de ASP.NET MVC 2 par défaut.</span><span class="sxs-lookup"><span data-stu-id="30d8f-114">To understand the vulnerability, let's look at how the login redirection works in a default ASP.NET MVC 2 Web Application project.</span></span> <span data-ttu-id="30d8f-115">Dans cette application, essayez de visiter une action de contrôleur qui possède l’attribut [Authorize] redirigera les utilisateurs non autorisés à la vue /Account/LogOn.</span><span class="sxs-lookup"><span data-stu-id="30d8f-115">In this application, attempting to visit a controller action that has the [Authorize] attribute will redirect unauthorized users to the /Account/LogOn view.</span></span> <span data-ttu-id="30d8f-116">Cette redirection vers /Account/LogOn inclut un paramètre de chaîne de requête returnUrl afin que l’utilisateur peut être retournée à l’URL demandée à l’origine une fois qu’ils ont connecté avec succès.</span><span class="sxs-lookup"><span data-stu-id="30d8f-116">This redirect to /Account/LogOn will include a returnUrl querystring parameter so that the user can be returned to the originally requested URL after they have successfully logged in.</span></span>

<span data-ttu-id="30d8f-117">Dans la capture d’écran ci-dessous, nous constatons qu’une tentative d’accès de la vue /Account/ChangePassword lorsque vous n’êtes ne pas connecté entraîne une redirection vers /Account/LogOn ? ReturnUrl = % 2fAccount % 2fChangePassword % 2f.</span><span class="sxs-lookup"><span data-stu-id="30d8f-117">In the screenshot below, we can see that an attempt to access the /Account/ChangePassword view when not logged in results in a redirect to /Account/LogOn?ReturnUrl=%2fAccount%2fChangePassword%2f.</span></span>

[![](preventing-open-redirection-attacks/_static/image2.png)](preventing-open-redirection-attacks/_static/image1.png)

<span data-ttu-id="30d8f-118">**Figure 01**: Page de connexion avec une redirection ouverte</span><span class="sxs-lookup"><span data-stu-id="30d8f-118">**Figure 01**: Login page with an open redirection</span></span>

<span data-ttu-id="30d8f-119">Dans la mesure où le paramètre de chaîne de requête ReturnUrl n’est pas validé, une personne malveillante peut le modifier pour injecter de n’importe quelle adresse URL dans le paramètre pour mener une attaque par redirection ouverte.</span><span class="sxs-lookup"><span data-stu-id="30d8f-119">Since the ReturnUrl querystring parameter is not validated, an attacker can modify it to inject any URL address into the parameter to conduct an open redirection attack.</span></span> <span data-ttu-id="30d8f-120">Pour illustrer cela, nous pouvons modifier le paramètre ReturnUrl à [ http://bing.com ](http://bing.com), de sorte que l’URL de connexion qui en résulte sera/compte / d’ouverture de session ? ReturnUrl =<http://www.bing.com/>.</span><span class="sxs-lookup"><span data-stu-id="30d8f-120">To demonstrate this, we can modify the ReturnUrl parameter to [http://bing.com](http://bing.com), so the resulting login URL will be /Account/LogOn?ReturnUrl=<http://www.bing.com/>.</span></span> <span data-ttu-id="30d8f-121">Lors de la connexion avec succès vers le site, nous sommes redirigés vers [ http://bing.com ](http://bing.com).</span><span class="sxs-lookup"><span data-stu-id="30d8f-121">Upon successfully logging in to the site, we are redirected to [http://bing.com](http://bing.com).</span></span> <span data-ttu-id="30d8f-122">Dans la mesure où cette redirection n’est pas validée, il pourrait pointer à la place vers un site malveillant qui tente de tromper l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="30d8f-122">Since this redirection is not validated, it could instead point to a malicious site that attempts to trick the user.</span></span>

### <a name="a-more-complex-open-redirection-attack"></a><span data-ttu-id="30d8f-123">Une attaque de Redirection ouverte plus complexes</span><span class="sxs-lookup"><span data-stu-id="30d8f-123">A more complex Open Redirection Attack</span></span>

<span data-ttu-id="30d8f-124">Attaques par redirection ouverte sont particulièrement dangereuses, car un attaquant sait que nous essayons pour vous connecter à un site Web spécifique, ce qui nous rend vulnérable à un [attaque par phishing](https://www.microsoft.com/protect/fraud/phishing/symptoms.aspx).</span><span class="sxs-lookup"><span data-stu-id="30d8f-124">Open redirection attacks are especially dangerous because an attacker knows that we're trying to log into a specific website, which makes us vulnerable to a [phishing attack](https://www.microsoft.com/protect/fraud/phishing/symptoms.aspx).</span></span> <span data-ttu-id="30d8f-125">Par exemple, un attaquant pourrait envoyer des messages électroniques malveillants pour les utilisateurs du site Web dans une tentative pour capturer leurs mots de passe.</span><span class="sxs-lookup"><span data-stu-id="30d8f-125">For example, an attacker could send malicious emails to website users in an attempt to capture their passwords.</span></span> <span data-ttu-id="30d8f-126">Nous allons voir comment cela fonctionnerait sur le site de NerdDinner.</span><span class="sxs-lookup"><span data-stu-id="30d8f-126">Let's look at how this would work on the NerdDinner site.</span></span> <span data-ttu-id="30d8f-127">(Notez que le site de NerdDinner actif a été mis à jour pour vous protéger contre les attaques par redirection ouverte).</span><span class="sxs-lookup"><span data-stu-id="30d8f-127">(Note that the live NerdDinner site has been updated to protect against open redirection attacks.)</span></span>

<span data-ttu-id="30d8f-128">Tout d’abord, une personne malveillante nous envoie un lien vers la page de connexion sur NerdDinner qui inclut une redirection vers leurs pages contrefaites :</span><span class="sxs-lookup"><span data-stu-id="30d8f-128">First, an attacker sends us a link to the login page on NerdDinner that includes a redirect to their forged page:</span></span>

[http://nerddinner.com/Account/LogOn?returnUrl=http://nerddiner.com/Account/LogOn](http://nerddinner.com/Account/LogOn?returnUrl=http://nerddiner.com/Account/LogOn)

<span data-ttu-id="30d8f-129">Notez que l’URL de retour pointe vers nerddiner.com, ce qui n’a pas un « n » à partir du dîner de word.</span><span class="sxs-lookup"><span data-stu-id="30d8f-129">Note that the return URL points to nerddiner.com, which is missing an "n" from the word dinner.</span></span> <span data-ttu-id="30d8f-130">Dans cet exemple, il s’agit d’un domaine qui contrôle l’attaquant.</span><span class="sxs-lookup"><span data-stu-id="30d8f-130">In this example, this is a domain that the attacker controls.</span></span> <span data-ttu-id="30d8f-131">Lorsque nous accédez le lien ci-dessus, nous allons dirigés vers la page de connexion NerdDinner.com légitime.</span><span class="sxs-lookup"><span data-stu-id="30d8f-131">When we access the above link, we're taken to the legitimate NerdDinner.com login page.</span></span>

[![](preventing-open-redirection-attacks/_static/image4.png)](preventing-open-redirection-attacks/_static/image3.png)

<span data-ttu-id="30d8f-132">**Figure 02**: Page de connexion de NerdDinner avec une redirection ouverte</span><span class="sxs-lookup"><span data-stu-id="30d8f-132">**Figure 02**: NerdDinner login page with an open redirection</span></span>

<span data-ttu-id="30d8f-133">Lorsque nous connecter correctement, action d’ouverture de session de l’ASP.NET MVC du contrôle AccountController nous redirige vers l’URL spécifiée dans le paramètre de chaîne de requête returnUrl.</span><span class="sxs-lookup"><span data-stu-id="30d8f-133">When we correctly log in, the ASP.NET MVC AccountController's LogOn action redirects us to the URL specified in the returnUrl querystring parameter.</span></span> <span data-ttu-id="30d8f-134">Dans ce cas, il est l’URL qui est passée à l’attaquant, qui est [ http://nerddiner.com/Account/LogOn ](http://nerddiner.com/Account/LogOn).</span><span class="sxs-lookup"><span data-stu-id="30d8f-134">In this case, it's the URL that the attacker has entered, which is [http://nerddiner.com/Account/LogOn](http://nerddiner.com/Account/LogOn).</span></span> <span data-ttu-id="30d8f-135">À moins que nous sommes extrêmement sont, qu'il est très probable que nous ne remarquerez pas cela, notamment parce que l’attaquant a veillé à vous assurer que leurs pages contrefaites est identique à la page de connexion légitime.</span><span class="sxs-lookup"><span data-stu-id="30d8f-135">Unless we're extremely watchful, it's very likely we won't notice this, especially because the attacker has been careful to make sure that their forged page looks exactly like the legitimate login page.</span></span> <span data-ttu-id="30d8f-136">Cette page de connexion inclut un message d’erreur demandant que nous connecter à nouveau.</span><span class="sxs-lookup"><span data-stu-id="30d8f-136">This login page includes an error message requesting that we login again.</span></span> <span data-ttu-id="30d8f-137">Maladroit nous, nous devons la saisie incorrecte notre mot de passe.</span><span class="sxs-lookup"><span data-stu-id="30d8f-137">Clumsy us, we must have mistyped our password.</span></span>

[![](preventing-open-redirection-attacks/_static/image6.png)](preventing-open-redirection-attacks/_static/image5.png)

<span data-ttu-id="30d8f-138">**Figure 03**: Écran de connexion de NerdDinner falsifiée</span><span class="sxs-lookup"><span data-stu-id="30d8f-138">**Figure 03**: Forged NerdDinner Login screen</span></span>

<span data-ttu-id="30d8f-139">Lorsque nous retapez notre nom d’utilisateur et le mot de passe, la page de connexion falsifiées enregistre les informations et nous envoie vers le site de NerdDinner.com légitime.</span><span class="sxs-lookup"><span data-stu-id="30d8f-139">When we retype our user name and password, the forged login page saves the information and sends us back to the legitimate NerdDinner.com site.</span></span> <span data-ttu-id="30d8f-140">À ce stade, le site de NerdDinner.com a déjà authentifié us, afin de la page de connexion falsifiées permettre rediriger directement vers cette page.</span><span class="sxs-lookup"><span data-stu-id="30d8f-140">At this point, the NerdDinner.com site has already authenticated us, so the forged login page can redirect directly to that page.</span></span> <span data-ttu-id="30d8f-141">Le résultat final est que l’attaquant a notre nom d’utilisateur et le mot de passe, et nous ne savent pas que nous vous avons fourni il leur.</span><span class="sxs-lookup"><span data-stu-id="30d8f-141">The end result is that the attacker has our user name and password, and we are unaware that we've provided it to them.</span></span>

## <a name="looking-at-the-vulnerable-code-in-the-accountcontroller-logon-action"></a><span data-ttu-id="30d8f-142">Le code vulnérable à une Action d’ouverture de session AccountController</span><span class="sxs-lookup"><span data-stu-id="30d8f-142">Looking at the vulnerable code in the AccountController LogOn Action</span></span>

<span data-ttu-id="30d8f-143">Le code pour l’action d’ouverture de session dans une application ASP.NET MVC 2 est indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="30d8f-143">The code for the LogOn action in an ASP.NET MVC 2 application is shown below.</span></span> <span data-ttu-id="30d8f-144">Notez que lors d’une connexion réussie, le contrôleur retourne une redirection vers l’élément returnUrl.</span><span class="sxs-lookup"><span data-stu-id="30d8f-144">Note that upon a successful login, the controller returns a redirect to the returnUrl.</span></span> <span data-ttu-id="30d8f-145">Vous pouvez voir qu’aucune validation n’est effectuée sur le paramètre returnUrl.</span><span class="sxs-lookup"><span data-stu-id="30d8f-145">You can see that no validation is being performed against the returnUrl parameter.</span></span>

<span data-ttu-id="30d8f-146">**Liste 1 – action d’ouverture de session ASP.NET MVC 2 dans `AccountController.cs`**</span><span class="sxs-lookup"><span data-stu-id="30d8f-146">**Listing 1 – ASP.NET MVC 2 LogOn action in `AccountController.cs`**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample1.cs)]

<span data-ttu-id="30d8f-147">Maintenant nous allons examiner les modifications apportées à l’action d’ouverture de session ASP.NET MVC 3.</span><span class="sxs-lookup"><span data-stu-id="30d8f-147">Now let's look at the changes to the ASP.NET MVC 3 LogOn action.</span></span> <span data-ttu-id="30d8f-148">Ce code a été modifié pour valider le paramètre returnUrl en appelant une nouvelle méthode dans la classe d’assistance System.Web.Mvc.Url nommée `IsLocalUrl()`.</span><span class="sxs-lookup"><span data-stu-id="30d8f-148">This code has been changed to validate the returnUrl parameter by calling a new method in the System.Web.Mvc.Url helper class named `IsLocalUrl()`.</span></span>

<span data-ttu-id="30d8f-149">**Listing 2 – action d’ouverture de session ASP.NET MVC 3 dans `AccountController.cs`**</span><span class="sxs-lookup"><span data-stu-id="30d8f-149">**Listing 2 – ASP.NET MVC 3 LogOn action in `AccountController.cs`**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample2.cs)]

<span data-ttu-id="30d8f-150">Cela a été modifié pour valider le paramètre URL de retour en appelant une nouvelle méthode dans la classe d’assistance System.Web.Mvc.Url, `IsLocalUrl()`.</span><span class="sxs-lookup"><span data-stu-id="30d8f-150">This has been changed to validate the return URL parameter by calling a new method in the System.Web.Mvc.Url helper class, `IsLocalUrl()`.</span></span>

## <a name="protecting-your-aspnet-mvc-10-and-mvc-2-applications"></a><span data-ttu-id="30d8f-151">Protection ASP.NET MVC 1.0 et MVC 2 vos Applications</span><span class="sxs-lookup"><span data-stu-id="30d8f-151">Protecting Your ASP.NET MVC 1.0 and MVC 2 Applications</span></span>

<span data-ttu-id="30d8f-152">Nous pouvons tirer parti des modifications d’ASP.NET MVC 3 dans notre ASP.NET MVC 1.0 existante et 2 applications en ajoutant la méthode d’assistance IsLocalUrl() et de la mise à jour de l’action d’ouverture de session pour valider le paramètre returnUrl.</span><span class="sxs-lookup"><span data-stu-id="30d8f-152">We can take advantage of the ASP.NET MVC 3 changes in our existing ASP.NET MVC 1.0 and 2 applications by adding the IsLocalUrl() helper method and updating the LogOn action to validate the returnUrl parameter.</span></span>

<span data-ttu-id="30d8f-153">La méthode UrlHelper IsLocalUrl() en fait appel à une méthode dans System.Web.WebPages, en tant que cette validation est également utilisée par les applications ASP.NET Web Pages.</span><span class="sxs-lookup"><span data-stu-id="30d8f-153">The UrlHelper IsLocalUrl() method actually just calling into a method in System.Web.WebPages, as this validation is also used by ASP.NET Web Pages applications.</span></span>

<span data-ttu-id="30d8f-154">**Liste 3 – la méthode IsLocalUrl() à partir de la UrlHelper de 3 ASP.NET MVC `class`**</span><span class="sxs-lookup"><span data-stu-id="30d8f-154">**Listing 3 – The IsLocalUrl() method from the ASP.NET MVC 3 UrlHelper `class`**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample3.cs)]

<span data-ttu-id="30d8f-155">La méthode IsUrlLocalToHost contient la logique de validation réelle, comme indiqué sur la liste 4.</span><span class="sxs-lookup"><span data-stu-id="30d8f-155">The IsUrlLocalToHost method contains the actual validation logic, as shown in Listing 4.</span></span>

<span data-ttu-id="30d8f-156">**Liste 4 – méthode IsUrlLocalToHost() à partir de la classe System.Web.WebPages RequestExtensions**</span><span class="sxs-lookup"><span data-stu-id="30d8f-156">**Listing 4 – IsUrlLocalToHost() method from the System.Web.WebPages RequestExtensions class**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample4.cs)]

<span data-ttu-id="30d8f-157">Dans notre ASP.NET MVC 1.0 ou une application 2, nous allons ajouter une méthode IsLocalUrl() à contrôle AccountController, mais vous êtes invités à ajouter à une classe d’assistance distincte si possible.</span><span class="sxs-lookup"><span data-stu-id="30d8f-157">In our ASP.NET MVC 1.0 or 2 application, we'll add a IsLocalUrl() method to the AccountController, but you're encouraged to add it to a separate helper class if possible.</span></span> <span data-ttu-id="30d8f-158">Nous apporterons deux petites modifications à la version d’ASP.NET MVC 3 de IsLocalUrl() pour qu’il fonctionne à l’intérieur du contrôle AccountController.</span><span class="sxs-lookup"><span data-stu-id="30d8f-158">We will make two small changes to the ASP.NET MVC 3 version of IsLocalUrl() so that it will work inside the AccountController.</span></span> <span data-ttu-id="30d8f-159">Tout d’abord, nous allons modifier cela à partir d’une méthode publique à une méthode privée, étant donné que les méthodes publiques dans les contrôleurs sont accessibles en tant qu’actions de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="30d8f-159">First, we'll change it from a public method to a private method, since public methods in controllers can be accessed as controller actions.</span></span> <span data-ttu-id="30d8f-160">Ensuite, nous allons modifier l’appel qui vérifie l’hôte de l’URL par rapport à l’hôte d’application.</span><span class="sxs-lookup"><span data-stu-id="30d8f-160">Second, we'll modify the call that checks the URL host against the application host.</span></span> <span data-ttu-id="30d8f-161">Qu’appel utilise un RequestContext local champ dans la classe UrlHelper.</span><span class="sxs-lookup"><span data-stu-id="30d8f-161">That call makes use of a local RequestContext field in the UrlHelper class.</span></span> <span data-ttu-id="30d8f-162">Au lieu d’utiliser cela. RequestContext.HttpContext.Request.Url.Host, nous utiliserons ce. Request.Url.Host.</span><span class="sxs-lookup"><span data-stu-id="30d8f-162">Instead of using this.RequestContext.HttpContext.Request.Url.Host, we will use this.Request.Url.Host.</span></span> <span data-ttu-id="30d8f-163">Le code suivant montre la méthode IsLocalUrl() modifiée pour une utilisation avec une classe de contrôleur dans ASP.NET MVC 1.0 et 2 applications.</span><span class="sxs-lookup"><span data-stu-id="30d8f-163">The following code shows the modified IsLocalUrl() method for use with a controller class in ASP.NET MVC 1.0 and 2 applications.</span></span>

<span data-ttu-id="30d8f-164">**Liste 5 – IsLocalUrl() (méthode), qui est modifiée pour une utilisation avec une classe de contrôleur MVC**</span><span class="sxs-lookup"><span data-stu-id="30d8f-164">**Listing 5 – IsLocalUrl() method, which is modified for use with an MVC Controller class**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample5.cs)]

<span data-ttu-id="30d8f-165">Maintenant que la méthode IsLocalUrl() est en place, nous pouvons l’appeler à partir de notre action d’ouverture de session pour valider le paramètre returnUrl, comme indiqué dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="30d8f-165">Now that the IsLocalUrl() method is in place, we can call it from our LogOn action to validate the returnUrl parameter, as shown in the following code.</span></span>

<span data-ttu-id="30d8f-166">**Liste 6 – méthode d’ouverture de session de mise à jour qui valide le paramètre returnUrl**</span><span class="sxs-lookup"><span data-stu-id="30d8f-166">**Listing 6 – Updated LogOn method which validates the returnUrl parameter**</span></span>

[!code-csharp[Main](preventing-open-redirection-attacks/samples/sample6.cs)]

<span data-ttu-id="30d8f-167">Maintenant, nous pouvons tester une attaque par redirection ouverte à une tentative de connexion à l’aide d’une URL de retournée externe.</span><span class="sxs-lookup"><span data-stu-id="30d8f-167">Now we can test an open redirection attack by attempting to log in using an external return URL.</span></span> <span data-ttu-id="30d8f-168">Nous allons utiliser /Account/LogOn ? ReturnUrl =<http://www.bing.com/> à nouveau.</span><span class="sxs-lookup"><span data-stu-id="30d8f-168">Let's use /Account/LogOn?ReturnUrl=<http://www.bing.com/> again.</span></span>

[![](preventing-open-redirection-attacks/_static/image8.png)](preventing-open-redirection-attacks/_static/image7.png)

<span data-ttu-id="30d8f-169">**Figure 04**: Pour tester l’Action d’ouverture de session de mise à jour</span><span class="sxs-lookup"><span data-stu-id="30d8f-169">**Figure 04**: Testing the updated LogOn Action</span></span>

<span data-ttu-id="30d8f-170">Après vous être connecté avec succès, nous sommes redirigés à l’action du contrôleur de Home/Index plutôt qu’à l’URL externe.</span><span class="sxs-lookup"><span data-stu-id="30d8f-170">After successfully logging in, we are redirected to the Home/Index Controller action rather than the external URL.</span></span>

[![](preventing-open-redirection-attacks/_static/image10.png)](preventing-open-redirection-attacks/_static/image9.png)

<span data-ttu-id="30d8f-171">**Figure 05**: Ouvrez l’attaque de Redirection vaincu</span><span class="sxs-lookup"><span data-stu-id="30d8f-171">**Figure 05**: Open Redirection attack defeated</span></span>

## <a name="summary"></a><span data-ttu-id="30d8f-172">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="30d8f-172">Summary</span></span>

<span data-ttu-id="30d8f-173">Attaques par redirection ouverte peuvent se produire lors de la redirection URL lui sont passées en tant que paramètres dans l’URL pour une application.</span><span class="sxs-lookup"><span data-stu-id="30d8f-173">Open redirection attacks can occur when redirection URLs are passed as parameters in the URL for an application.</span></span> <span data-ttu-id="30d8f-174">ASP.NET MVC 3, modèle inclut le code pour vous protéger contre les attaques par redirection d’ouvrir.</span><span class="sxs-lookup"><span data-stu-id="30d8f-174">The ASP.NET MVC 3 template includes code to protect against open redirection attacks.</span></span> <span data-ttu-id="30d8f-175">Vous pouvez ajouter ce code avec quelques modifications à ASP.NET MVC 1.0 et 2 applications.</span><span class="sxs-lookup"><span data-stu-id="30d8f-175">You can add this code with some modification to ASP.NET MVC 1.0 and 2 applications.</span></span> <span data-ttu-id="30d8f-176">Pour vous protéger contre les attaques par redirection ouverte lors de la journalisation dans ASP.NET 1.0 et 2 applications, ajoutez une méthode IsLocalUrl() et valider le paramètre returnUrl dans l’action d’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="30d8f-176">To protect against open redirection attacks when logging into ASP.NET 1.0 and 2 applications, add a IsLocalUrl() method and validate the returnUrl parameter in the LogOn action.</span></span>
