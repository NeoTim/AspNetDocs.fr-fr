---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view
title: Examen des méthodes de modification et de la vue Edit (C#) | Microsoft Docs
author: Rick-Anderson
description: Ce didacticiel vous apprend les bases de la création d’une application Web ASP.NET MVC à l’aide de Microsoft Visual Web Developer 2010 Express Service Pack 1, qui est en cours...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: 1d266bf0-a61e-423b-a3d2-13773d7dafe2
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view
msc.type: authoredcontent
ms.openlocfilehash: 6ed989173f7f687e37c73b89217b1cd81e056f75
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57031976"
---
<a name="examining-the-edit-methods-and-edit-view-c"></a><span data-ttu-id="16be7-103">Examen des méthodes de modification et de la vue de modification (C#)</span><span class="sxs-lookup"><span data-stu-id="16be7-103">Examining the Edit Methods and Edit View (C#)</span></span>
====================
<span data-ttu-id="16be7-104">par [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="16be7-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> > [!NOTE]
> > <span data-ttu-id="16be7-105">Une version mise à jour de ce didacticiel est disponible [ici](../../../getting-started/introduction/getting-started.md) qui utilise ASP.NET MVC 5 et Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="16be7-105">An updated version of this tutorial is available [here](../../../getting-started/introduction/getting-started.md) that uses ASP.NET MVC 5 and Visual Studio 2013.</span></span> <span data-ttu-id="16be7-106">Il est plus sécurisé, beaucoup plus simple à suivre et illustre plusieurs fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="16be7-106">It's more secure, much simpler to follow and demonstrates more features.</span></span>
> 
> 
> <span data-ttu-id="16be7-107">Ce didacticiel vous apprend les notions de base de la création d’une application Web ASP.NET MVC à l’aide de Microsoft Visual Web Developer 2010 Express Service Pack 1, qui est une version gratuite de Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="16be7-107">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="16be7-108">Avant de commencer, assurez-vous que vous avez installé les composants requis listés ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="16be7-108">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="16be7-109">Vous pouvez installer tous les en cliquant sur le lien suivant : [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="16be7-109">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="16be7-110">Vous pouvez également installer individuellement les conditions préalables à l’aide des liens suivants :</span><span class="sxs-lookup"><span data-stu-id="16be7-110">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="16be7-111">Prérequis pour le Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="16be7-111">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="16be7-112">Mettre à jour des outils ASP.NET MVC 3</span><span class="sxs-lookup"><span data-stu-id="16be7-112">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="16be7-113">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + outils prennent en charge)</span><span class="sxs-lookup"><span data-stu-id="16be7-113">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="16be7-114">Si vous utilisez Visual Studio 2010 au lieu de Visual Web Developer 2010, installez les composants requis en cliquant sur le lien suivant : [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="16be7-114">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="16be7-115">Un projet de Visual Web Developer avec code source C# est disponible pour accompagner cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="16be7-115">A Visual Web Developer project with C# source code is available to accompany this topic.</span></span> <span data-ttu-id="16be7-116">[Téléchargez la version C#](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="16be7-116">[Download the C# version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="16be7-117">Si vous préférez Visual Basic, basculez vers le [version Visual Basic](../vb/intro-to-aspnet-mvc-3.md) de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="16be7-117">If you prefer Visual Basic, switch to the [Visual Basic version](../vb/intro-to-aspnet-mvc-3.md) of this tutorial.</span></span>


<span data-ttu-id="16be7-118">Dans cette section, vous allez examiner les méthodes d’action généré et les vues pour le contrôleur de film.</span><span class="sxs-lookup"><span data-stu-id="16be7-118">In this section, you'll examine the generated action methods and views for the movie controller.</span></span> <span data-ttu-id="16be7-119">Ensuite, vous allez ajouter une page de recherche personnalisée.</span><span class="sxs-lookup"><span data-stu-id="16be7-119">Then you'll add a custom search page.</span></span>

<span data-ttu-id="16be7-120">Exécutez l’application et accédez à la `Movies` contrôleur en ajoutant */Movies* à l’URL dans la barre d’adresses de votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="16be7-120">Run the application and browse to the `Movies` controller by appending */Movies* to the URL in the address bar of your browser.</span></span> <span data-ttu-id="16be7-121">Maintenez le pointeur de la souris sur un **modifier** lien pour afficher l’URL auxquelles il est lié.</span><span class="sxs-lookup"><span data-stu-id="16be7-121">Hold the mouse pointer over an **Edit** link to see the URL that it links to.</span></span>

<span data-ttu-id="16be7-122">[![EditLink_sm](examining-the-edit-methods-and-edit-view/_static/image2.png)](examining-the-edit-methods-and-edit-view/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-122">[![EditLink_sm](examining-the-edit-methods-and-edit-view/_static/image2.png)](examining-the-edit-methods-and-edit-view/_static/image1.png)</span></span>

<span data-ttu-id="16be7-123">Le **modifier** lien a été généré par le `Html.ActionLink` méthode dans le *Views\Movies\Index.cshtml* vue :</span><span class="sxs-lookup"><span data-stu-id="16be7-123">The **Edit** link was generated by the `Html.ActionLink` method in the *Views\Movies\Index.cshtml* view:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample1.cshtml)]

<span data-ttu-id="16be7-124">[![Html.ActionLink](examining-the-edit-methods-and-edit-view/_static/image4.png)](examining-the-edit-methods-and-edit-view/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-124">[![Html.ActionLink](examining-the-edit-methods-and-edit-view/_static/image4.png)](examining-the-edit-methods-and-edit-view/_static/image3.png)</span></span>

<span data-ttu-id="16be7-125">Le `Html` objet est une application d’assistance qui est exposée à l’aide d’une propriété sur le `WebViewPage` classe de base.</span><span class="sxs-lookup"><span data-stu-id="16be7-125">The `Html` object is a helper that's exposed using a property on the `WebViewPage` base class.</span></span> <span data-ttu-id="16be7-126">Le `ActionLink` méthode de l’application d’assistance facilite l’utilisation générer dynamiquement le code HTML des liens hypertexte aux méthodes d’action sur les contrôleurs.</span><span class="sxs-lookup"><span data-stu-id="16be7-126">The `ActionLink` method of the helper makes it easy to dynamically generate HTML hyperlinks that link to action methods on controllers.</span></span> <span data-ttu-id="16be7-127">Le premier argument de la `ActionLink` méthode est le texte de lien à afficher (par exemple, `<a>Edit Me</a>`).</span><span class="sxs-lookup"><span data-stu-id="16be7-127">The first argument to the `ActionLink` method is the link text to render (for example, `<a>Edit Me</a>`).</span></span> <span data-ttu-id="16be7-128">Le deuxième argument est le nom de la méthode d’action à appeler.</span><span class="sxs-lookup"><span data-stu-id="16be7-128">The second argument is the name of the action method to invoke.</span></span> <span data-ttu-id="16be7-129">L’argument final est un [objet anonyme](https://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx) qui génère les données d’itinéraire (dans ce cas, l’ID de 4).</span><span class="sxs-lookup"><span data-stu-id="16be7-129">The final argument is an [anonymous object](https://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx) that generates the route data (in this case, the ID of 4).</span></span>

<span data-ttu-id="16be7-130">Le lien généré indiqué dans l’image précédente est `http://localhost:xxxxx/Movies/Edit/4`.</span><span class="sxs-lookup"><span data-stu-id="16be7-130">The generated link shown in the previous image is `http://localhost:xxxxx/Movies/Edit/4`.</span></span> <span data-ttu-id="16be7-131">L’itinéraire par défaut prend le modèle d’URL `{controller}/{action}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="16be7-131">The default route takes the URL pattern `{controller}/{action}/{id}`.</span></span> <span data-ttu-id="16be7-132">Par conséquent, ASP.NET se traduit par `http://localhost:xxxxx/Movies/Edit/4` en une requête à la `Edit` méthode d’action de la `Movies` contrôleur avec le paramètre `ID` égal à 4.</span><span class="sxs-lookup"><span data-stu-id="16be7-132">Therefore, ASP.NET translates `http://localhost:xxxxx/Movies/Edit/4` into a request to the `Edit` action method of the `Movies` controller with the parameter `ID` equal to 4.</span></span>

<span data-ttu-id="16be7-133">Vous pouvez également transmettre des paramètres de méthode d’action à l’aide d’une chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="16be7-133">You can also pass action method parameters using a query string.</span></span> <span data-ttu-id="16be7-134">Par exemple, l’URL `http://localhost:xxxxx/Movies/Edit?ID=4` passe également le paramètre `ID` de 4 processeurs à la `Edit` méthode d’action de la `Movies` contrôleur.</span><span class="sxs-lookup"><span data-stu-id="16be7-134">For example, the URL `http://localhost:xxxxx/Movies/Edit?ID=4` also passes the parameter `ID` of 4 to the `Edit` action method of the `Movies` controller.</span></span>

<span data-ttu-id="16be7-135">[![EditQueryString](examining-the-edit-methods-and-edit-view/_static/image6.png)](examining-the-edit-methods-and-edit-view/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-135">[![EditQueryString](examining-the-edit-methods-and-edit-view/_static/image6.png)](examining-the-edit-methods-and-edit-view/_static/image5.png)</span></span>

<span data-ttu-id="16be7-136">Ouvrez la `Movies` contrôleur.</span><span class="sxs-lookup"><span data-stu-id="16be7-136">Open the `Movies` controller.</span></span> <span data-ttu-id="16be7-137">Les deux `Edit` méthodes d’action sont présentées ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="16be7-137">The two `Edit` action methods are shown below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample2.cs)]

<span data-ttu-id="16be7-138">Notez que la deuxième méthode d’action `Edit` est précédée de l’attribut `HttpPost`.</span><span class="sxs-lookup"><span data-stu-id="16be7-138">Notice the second `Edit` action method is preceded by the `HttpPost` attribute.</span></span> <span data-ttu-id="16be7-139">Cet attribut spécifie cette surcharge de la `Edit` méthode peut être appelée uniquement pour les requêtes POST.</span><span class="sxs-lookup"><span data-stu-id="16be7-139">This attribute specifies that overload of the `Edit` method can be invoked only for POST requests.</span></span> <span data-ttu-id="16be7-140">Vous pouvez appliquer la `HttpGet` modifier la méthode de l’attribut à la première, mais qui n’est pas nécessaire car il s’agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="16be7-140">You could apply the `HttpGet` attribute to the first edit method, but that's not necessary because it's the default.</span></span> <span data-ttu-id="16be7-141">(Nous allons nous référer aux méthodes d’action attribués de manière implicite le `HttpGet` sous la forme `HttpGet` méthodes.)</span><span class="sxs-lookup"><span data-stu-id="16be7-141">(We'll refer to action methods that are implicitly assigned the `HttpGet` attribute as `HttpGet` methods.)</span></span>

<span data-ttu-id="16be7-142">Le `HttpGet` `Edit` méthode prend le paramètre ID de film, recherche le film à l’aide d’Entity Framework `Find` (méthode) et retourne le film sélectionné à la vue Edit.</span><span class="sxs-lookup"><span data-stu-id="16be7-142">The `HttpGet` `Edit` method takes the movie ID parameter, looks up the movie using the Entity Framework `Find` method, and returns the selected movie to the Edit view.</span></span> <span data-ttu-id="16be7-143">Quand le système de génération de modèles automatique a créé la vue Edit, il a examiné la classe `Movie` et a créé le code pour restituer les éléments `<label>` et `<input>` de chaque propriété de la classe.</span><span class="sxs-lookup"><span data-stu-id="16be7-143">When the scaffolding system created the Edit view, it examined the `Movie` class and created code to render `<label>` and `<input>` elements for each property of the class.</span></span> <span data-ttu-id="16be7-144">L’exemple suivant montre la vue Edit qui a été générée :</span><span class="sxs-lookup"><span data-stu-id="16be7-144">The following example shows the Edit view that was generated:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample3.cshtml)]

<span data-ttu-id="16be7-145">Notez comment le modèle de vue a un `@model MvcMovie.Models.Movie` instruction en haut du fichier : Spécifie que la vue prévoit que le modèle pour le modèle de vue soit de type `Movie`.</span><span class="sxs-lookup"><span data-stu-id="16be7-145">Notice how the view template has a `@model MvcMovie.Models.Movie` statement at the top of the file — this specifies that the view expects the model for the view template to be of type `Movie`.</span></span>

<span data-ttu-id="16be7-146">Le code généré automatiquement utilise plusieurs *méthodes d’assistance* pour rationaliser le balisage HTML.</span><span class="sxs-lookup"><span data-stu-id="16be7-146">The scaffolded code uses several *helper methods* to streamline the HTML markup.</span></span> <span data-ttu-id="16be7-147">Le [ `Html.LabelFor` ](https://msdn.microsoft.com/library/gg401864(VS.98).aspx) helper affiche le nom du champ (« Title », « ReleaseDate », « Genre » ou « Price »).</span><span class="sxs-lookup"><span data-stu-id="16be7-147">The [`Html.LabelFor`](https://msdn.microsoft.com/library/gg401864(VS.98).aspx) helper displays the name of the field ("Title", "ReleaseDate", "Genre", or "Price").</span></span> <span data-ttu-id="16be7-148">Le [ `Html.EditorFor` ](https://msdn.microsoft.com/library/system.web.mvc.html.editorextensions.editorfor(VS.98).aspx) helper affiche HTML `<input>` élément.</span><span class="sxs-lookup"><span data-stu-id="16be7-148">The [`Html.EditorFor`](https://msdn.microsoft.com/library/system.web.mvc.html.editorextensions.editorfor(VS.98).aspx) helper displays an HTML `<input>` element.</span></span> <span data-ttu-id="16be7-149">Le [ `Html.ValidationMessageFor` ](https://msdn.microsoft.com/library/system.web.mvc.html.validationextensions.validationmessagefor(VS.98).aspx) helper affiche les messages de validation associés à cette propriété.</span><span class="sxs-lookup"><span data-stu-id="16be7-149">The [`Html.ValidationMessageFor`](https://msdn.microsoft.com/library/system.web.mvc.html.validationextensions.validationmessagefor(VS.98).aspx) helper displays any validation messages associated with that property.</span></span>

<span data-ttu-id="16be7-150">Exécutez l’application et accédez à la */Movies* URL.</span><span class="sxs-lookup"><span data-stu-id="16be7-150">Run the application and navigate to the */Movies* URL.</span></span> <span data-ttu-id="16be7-151">Cliquez sur un lien **Edit**.</span><span class="sxs-lookup"><span data-stu-id="16be7-151">Click an **Edit** link.</span></span> <span data-ttu-id="16be7-152">Dans le navigateur, affichez la source de la page.</span><span class="sxs-lookup"><span data-stu-id="16be7-152">In the browser, view the source for the page.</span></span> <span data-ttu-id="16be7-153">Le code HTML dans la page ressemble à l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="16be7-153">The HTML in the page looks like the following example.</span></span> <span data-ttu-id="16be7-154">(Le balisage de menu a été exclu par souci de clarté).</span><span class="sxs-lookup"><span data-stu-id="16be7-154">(The menu markup was excluded for clarity.)</span></span>

[!code-html[Main](examining-the-edit-methods-and-edit-view/samples/sample4.html)]

<span data-ttu-id="16be7-155">Le `<input>` sont des éléments dans le code HTML `<form>` élément dont `action` attribut a la valeur à valider dans le */Movies/Edit* URL.</span><span class="sxs-lookup"><span data-stu-id="16be7-155">The `<input>` elements are in an HTML `<form>` element whose `action` attribute is set to post to the */Movies/Edit* URL.</span></span> <span data-ttu-id="16be7-156">Les données du formulaire seront publiées sur le serveur lors de la **modifier** bouton.</span><span class="sxs-lookup"><span data-stu-id="16be7-156">The form data will be posted to the server when the **Edit** button is clicked.</span></span>

## <a name="processing-the-post-request"></a><span data-ttu-id="16be7-157">Traitement de la requête POST</span><span class="sxs-lookup"><span data-stu-id="16be7-157">Processing the POST Request</span></span>

<span data-ttu-id="16be7-158">Le code suivant montre la version `HttpPost` de la méthode d’action `Edit`.</span><span class="sxs-lookup"><span data-stu-id="16be7-158">The following listing shows the `HttpPost` version of the `Edit` action method.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample5.cs)]

<span data-ttu-id="16be7-159">Le binder de modèle ASP.NET framework prend les valeurs de formulaire publiées et crée un `Movie` objet qui est passé en tant que le `movie` paramètre.</span><span class="sxs-lookup"><span data-stu-id="16be7-159">The ASP.NET framework model binder takes the posted form values and creates a `Movie` object that's passed as the `movie` parameter.</span></span> <span data-ttu-id="16be7-160">Le `ModelState.IsValid` contrôle dans le code vérifie que les données envoyées dans le formulaire peuvent être utilisées pour modifier un `Movie` objet.</span><span class="sxs-lookup"><span data-stu-id="16be7-160">The `ModelState.IsValid` check in the code verifies that the data submitted in the form can be used to modify a `Movie` object.</span></span> <span data-ttu-id="16be7-161">Si les données sont valides, le code enregistre les données de film à la `Movies` collection de la `MovieDBContext` instance.</span><span class="sxs-lookup"><span data-stu-id="16be7-161">If the data is valid, the code saves the movie data to the `Movies` collection of the `MovieDBContext` instance.</span></span> <span data-ttu-id="16be7-162">Le code enregistre ensuite les nouvelles données de film à la base de données en appelant le `SaveChanges` méthode de `MovieDBContext`, ce qui rend les modifications de la base de données.</span><span class="sxs-lookup"><span data-stu-id="16be7-162">The code then saves the new movie data to the database by calling the `SaveChanges` method of `MovieDBContext`, which persists changes to the database.</span></span> <span data-ttu-id="16be7-163">Après avoir enregistré les données, le code redirige l’utilisateur vers le `Index` méthode d’action de la `MoviesController` (classe), ce qui provoque le film mis à jour à afficher dans la liste de films.</span><span class="sxs-lookup"><span data-stu-id="16be7-163">After saving the data, the code redirects the user to the `Index` action method of the `MoviesController` class, which causes the updated movie to be displayed in the listing of movies.</span></span>

<span data-ttu-id="16be7-164">Si les valeurs publiées ne sont pas valides, ils réapparaissent dans le formulaire.</span><span class="sxs-lookup"><span data-stu-id="16be7-164">If the posted values aren't valid, they are redisplayed in the form.</span></span> <span data-ttu-id="16be7-165">Le `Html.ValidationMessageFor` helpers dans les *Edit.cshtml* vue modèle de prendre en charge d’affichage des messages d’erreur appropriés.</span><span class="sxs-lookup"><span data-stu-id="16be7-165">The `Html.ValidationMessageFor` helpers in the *Edit.cshtml* view template take care of displaying appropriate error messages.</span></span>

<span data-ttu-id="16be7-166">[![abcNotValid](examining-the-edit-methods-and-edit-view/_static/image8.png)](examining-the-edit-methods-and-edit-view/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-166">[![abcNotValid](examining-the-edit-methods-and-edit-view/_static/image8.png)](examining-the-edit-methods-and-edit-view/_static/image7.png)</span></span>

> <span data-ttu-id="16be7-167">**Remarque sur les paramètres régionaux** si vous travaillez généralement avec des paramètres régionaux autres que l’anglais, consultez [prenant en charge la Validation ASP.NET MVC 3 avec les paramètres régionaux Non anglais.](https://msdn.microsoft.com/library/gg674880(VS.98).aspx)</span><span class="sxs-lookup"><span data-stu-id="16be7-167">**Note about locales** If you normally work with a locale other than English, see [Supporting ASP.NET MVC 3 Validation with Non-English Locales.](https://msdn.microsoft.com/library/gg674880(VS.98).aspx)</span></span>


## <a name="making-the-edit-method-more-robust"></a><span data-ttu-id="16be7-168">Rendre la méthode Edit plus robuste</span><span class="sxs-lookup"><span data-stu-id="16be7-168">Making the Edit Method More Robust</span></span>

<span data-ttu-id="16be7-169">Le `HttpGet` `Edit` méthode générée par le système de génération de modèles automatique ne vérifie pas que l’ID qui lui est passé est valide.</span><span class="sxs-lookup"><span data-stu-id="16be7-169">The `HttpGet` `Edit` method generated by the scaffolding system doesn't check that the ID that's passed to it is valid.</span></span> <span data-ttu-id="16be7-170">Si un utilisateur supprime le segment de l’ID de l’URL (`http://localhost:xxxxx/Movies/Edit`), l’erreur suivante s’affiche :</span><span class="sxs-lookup"><span data-stu-id="16be7-170">If a user removes the ID segment from the URL (`http://localhost:xxxxx/Movies/Edit`), the following error is displayed:</span></span>

<span data-ttu-id="16be7-171">[![Null_ID](examining-the-edit-methods-and-edit-view/_static/image10.png)](examining-the-edit-methods-and-edit-view/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-171">[![Null_ID](examining-the-edit-methods-and-edit-view/_static/image10.png)](examining-the-edit-methods-and-edit-view/_static/image9.png)</span></span>

<span data-ttu-id="16be7-172">Un utilisateur peut également passer un ID qui n’existe pas dans la base de données, tel que `http://localhost:xxxxx/Movies/Edit/1234`.</span><span class="sxs-lookup"><span data-stu-id="16be7-172">A user could also pass an ID that doesn't exist in the database, such as `http://localhost:xxxxx/Movies/Edit/1234`.</span></span> <span data-ttu-id="16be7-173">Vous pouvez apporter deux modifications à la `HttpGet` `Edit` méthode d’action pour contourner cette limitation.</span><span class="sxs-lookup"><span data-stu-id="16be7-173">You can make two changes to the `HttpGet` `Edit` action method to address this limitation.</span></span> <span data-ttu-id="16be7-174">Tout d’abord, modifiez le `ID` paramètre possède une valeur par défaut de zéro lorsqu’un ID n’est pas passé explicitement.</span><span class="sxs-lookup"><span data-stu-id="16be7-174">First, change the `ID` parameter to have a default value of zero when an ID isn't explicitly passed.</span></span> <span data-ttu-id="16be7-175">Vous pouvez également vérifier que le `Find` méthode trouvée en fait un film avant de retourner l’objet de film pour le modèle de vue.</span><span class="sxs-lookup"><span data-stu-id="16be7-175">You can also check that the `Find` method actually found a movie before returning the movie object to the view template.</span></span> <span data-ttu-id="16be7-176">La mise à jour `Edit` méthode est indiquée ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="16be7-176">The updated `Edit` method is shown below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample6.cs)]

<span data-ttu-id="16be7-177">Si aucun film n’est trouvé, le `HttpNotFound` méthode est appelée.</span><span class="sxs-lookup"><span data-stu-id="16be7-177">If no movie is found, the `HttpNotFound` method is called.</span></span>

<span data-ttu-id="16be7-178">Tous les `HttpGet` méthodes suivent un modèle similaire.</span><span class="sxs-lookup"><span data-stu-id="16be7-178">All the `HttpGet` methods follow a similar pattern.</span></span> <span data-ttu-id="16be7-179">Ils obtiennent un objet de film (ou une liste d’objets, dans le cas de `Index`) et passer le modèle à la vue.</span><span class="sxs-lookup"><span data-stu-id="16be7-179">They get a movie object (or list of objects, in the case of `Index`), and pass the model to the view.</span></span> <span data-ttu-id="16be7-180">Le `Create` méthode passe un objet de film vide à la vue de créer.</span><span class="sxs-lookup"><span data-stu-id="16be7-180">The `Create` method passes an empty movie object to the Create view.</span></span> <span data-ttu-id="16be7-181">Toutes les méthodes qui créent, modifient, suppriment ou changent d’une quelconque manière des données le font dans la surcharge `HttpPost` de la méthode.</span><span class="sxs-lookup"><span data-stu-id="16be7-181">All the methods that create, edit, delete, or otherwise modify data do so in the `HttpPost` overload of the method.</span></span> <span data-ttu-id="16be7-182">Modification des données dans une méthode HTTP GET est un risque de sécurité, comme décrit dans le billet de blog [ASP.NET MVC Conseil #46 : n’utilisez pas supprimer les liens, car ils créent des failles de sécurité](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx).</span><span class="sxs-lookup"><span data-stu-id="16be7-182">Modifying data in an HTTP GET method is a security risk, as described in the blog post entry [ASP.NET MVC Tip #46 – Don't use Delete Links because they create Security Holes](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx).</span></span> <span data-ttu-id="16be7-183">Modification des données dans une méthode GET enfreint également les bonnes pratiques HTTP et le modèle d’architecture REST, laquelle spécifie que les requêtes GET ne doivent pas changer l’état de votre application.</span><span class="sxs-lookup"><span data-stu-id="16be7-183">Modifying data in a GET method also violates HTTP best practices and the architectural REST pattern, which specifies that GET requests should not change the state of your application.</span></span> <span data-ttu-id="16be7-184">En d’autres termes, une opération GET doit être une opération sûre qui n’a aucun effet secondaire.</span><span class="sxs-lookup"><span data-stu-id="16be7-184">In other words, performing a GET operation should be a safe operation that has no side effects.</span></span>

## <a name="adding-a-search-method-and-search-view"></a><span data-ttu-id="16be7-185">Ajout d’une méthode de recherche et de la vue de la recherche</span><span class="sxs-lookup"><span data-stu-id="16be7-185">Adding a Search Method and Search View</span></span>

<span data-ttu-id="16be7-186">Dans cette section, vous ajouterez un `SearchIndex` méthode d’action qui vous permet de rechercher des films par genre ou le nom.</span><span class="sxs-lookup"><span data-stu-id="16be7-186">In this section you'll add a `SearchIndex` action method that lets you search movies by genre or name.</span></span> <span data-ttu-id="16be7-187">Ce sera disponible en utilisant le */Movies/SearchIndex* URL.</span><span class="sxs-lookup"><span data-stu-id="16be7-187">This will be available using the */Movies/SearchIndex* URL.</span></span> <span data-ttu-id="16be7-188">La requête affiche un formulaire HTML qui contient les éléments d’entrée qu’un utilisateur peut remplir dans afin de rechercher un film.</span><span class="sxs-lookup"><span data-stu-id="16be7-188">The request will display an HTML form that contains input elements that a user can fill in in order to search for a movie.</span></span> <span data-ttu-id="16be7-189">Lorsqu’un utilisateur soumet le formulaire, la méthode d’action sera obtenir les valeurs de recherche publiés par l’utilisateur et utiliser les valeurs à rechercher la base de données.</span><span class="sxs-lookup"><span data-stu-id="16be7-189">When a user submits the form, the action method will get the search values posted by the user and use the values to search the database.</span></span>

## <a name="displaying-the-searchindex-form"></a><span data-ttu-id="16be7-190">Afficher le formulaire SearchIndex</span><span class="sxs-lookup"><span data-stu-id="16be7-190">Displaying the SearchIndex Form</span></span>

<span data-ttu-id="16be7-191">Commencez par ajouter un `SearchIndex` méthode d’action à l’objet existant `MoviesController` classe.</span><span class="sxs-lookup"><span data-stu-id="16be7-191">Start by adding a `SearchIndex` action method to the existing `MoviesController` class.</span></span> <span data-ttu-id="16be7-192">La méthode retourne une vue qui contient un formulaire HTML.</span><span class="sxs-lookup"><span data-stu-id="16be7-192">The method will return a view that contains an HTML form.</span></span> <span data-ttu-id="16be7-193">Voici le code :</span><span class="sxs-lookup"><span data-stu-id="16be7-193">Here's the code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample7.cs)]

<span data-ttu-id="16be7-194">La première ligne de la `SearchIndex` méthode crée les éléments suivants [LINQ](https://msdn.microsoft.com/library/bb397926.aspx) requête pour sélectionner les films :</span><span class="sxs-lookup"><span data-stu-id="16be7-194">The first line of the `SearchIndex` method creates the following [LINQ](https://msdn.microsoft.com/library/bb397926.aspx) query to select the movies:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample8.cs)]

<span data-ttu-id="16be7-195">La requête est définie à ce stade, mais n’a pas encore été exécutée sur le magasin de données.</span><span class="sxs-lookup"><span data-stu-id="16be7-195">The query is defined at this point, but hasn't yet been run against the data store.</span></span>

<span data-ttu-id="16be7-196">Si le `searchString` paramètre contient une chaîne, la requête de films est modifiée pour filtrer sur la valeur de la chaîne de recherche, en utilisant le code suivant :</span><span class="sxs-lookup"><span data-stu-id="16be7-196">If the `searchString` parameter contains a string, the movies query is modified to filter on the value of the search string, using the following code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample9.cs)]

<span data-ttu-id="16be7-197">Requêtes LINQ ne sont pas exécutées quand elles sont définies ou quand elles sont modifiées en appelant une méthode telle que `Where` ou `OrderBy`.</span><span class="sxs-lookup"><span data-stu-id="16be7-197">LINQ queries are not executed when they are defined or when they are modified by calling a method such as `Where` or `OrderBy`.</span></span> <span data-ttu-id="16be7-198">Au lieu de cela, l’exécution de requête est différée, ce qui signifie que l’évaluation d’une expression est retardée jusqu'à ce que sa valeur réalisée est une itération réelle ou le [ `ToList` ](https://msdn.microsoft.com/library/bb342261.aspx) méthode est appelée.</span><span class="sxs-lookup"><span data-stu-id="16be7-198">Instead, query execution is deferred, which means that the evaluation of an expression is delayed until its realized value is actually iterated over or the [`ToList`](https://msdn.microsoft.com/library/bb342261.aspx) method is called.</span></span> <span data-ttu-id="16be7-199">Dans le `SearchIndex` exemple, la requête est exécutée dans la vue SearchIndex.</span><span class="sxs-lookup"><span data-stu-id="16be7-199">In the `SearchIndex` sample, the query is executed in the SearchIndex view.</span></span> <span data-ttu-id="16be7-200">Pour plus d’informations sur l’exécution différée des requêtes, consultez [Exécution de requête](https://msdn.microsoft.com/library/bb738633.aspx).</span><span class="sxs-lookup"><span data-stu-id="16be7-200">For more information about deferred query execution, see [Query Execution](https://msdn.microsoft.com/library/bb738633.aspx).</span></span>

<span data-ttu-id="16be7-201">Maintenant que vous pouvez implémenter la `SearchIndex` vue qui affiche le formulaire à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="16be7-201">Now you can implement the `SearchIndex` view that will display the form to the user.</span></span> <span data-ttu-id="16be7-202">Avec le bouton droit à l’intérieur de la `SearchIndex` (méthode), puis cliquez sur **ajouter une vue**.</span><span class="sxs-lookup"><span data-stu-id="16be7-202">Right-click inside the `SearchIndex` method and then click **Add View**.</span></span> <span data-ttu-id="16be7-203">Dans le **ajouter une vue** boîte de dialogue, spécifiez que vous allez passer un `Movie` objet pour le modèle de vue en tant que sa classe de modèle.</span><span class="sxs-lookup"><span data-stu-id="16be7-203">In the **Add View** dialog box, specify that you're going to pass a `Movie` object to the view template as its model class.</span></span> <span data-ttu-id="16be7-204">Dans le **modèle de structure** , choisissez **liste**, puis cliquez sur **ajouter**.</span><span class="sxs-lookup"><span data-stu-id="16be7-204">In the **Scaffold template** list, choose **List**, then click **Add**.</span></span>

<span data-ttu-id="16be7-205">[![AddSearchView](examining-the-edit-methods-and-edit-view/_static/image12.png)](examining-the-edit-methods-and-edit-view/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-205">[![AddSearchView](examining-the-edit-methods-and-edit-view/_static/image12.png)](examining-the-edit-methods-and-edit-view/_static/image11.png)</span></span>

<span data-ttu-id="16be7-206">Lorsque vous cliquez sur le **ajouter** bouton, le *Views\Movies\SearchIndex.cshtml* afficher le modèle est créé.</span><span class="sxs-lookup"><span data-stu-id="16be7-206">When you click the **Add** button, the *Views\Movies\SearchIndex.cshtml* view template is created.</span></span> <span data-ttu-id="16be7-207">Étant donné que vous avez sélectionné **liste** dans le **modèle de structure** répertorier, Visual Web Developer généré automatiquement (généré automatiquement) du contenu par défaut dans la vue.</span><span class="sxs-lookup"><span data-stu-id="16be7-207">Because you selected **List** in the **Scaffold template** list, Visual Web Developer automatically generated (scaffolded) some default content in the view.</span></span> <span data-ttu-id="16be7-208">La génération de modèles automatique créé un formulaire HTML.</span><span class="sxs-lookup"><span data-stu-id="16be7-208">The scaffolding created an HTML form.</span></span> <span data-ttu-id="16be7-209">Elle a étudié les `Movie` classe et a créé le code pour restituer `<label>` éléments pour chaque propriété de la classe.</span><span class="sxs-lookup"><span data-stu-id="16be7-209">It examined the `Movie` class and created code to render `<label>` elements for each property of the class.</span></span> <span data-ttu-id="16be7-210">La liste ci-dessous affiche la vue Create qui a été générée :</span><span class="sxs-lookup"><span data-stu-id="16be7-210">The listing below shows the Create view that was generated:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample10.cshtml)]

<span data-ttu-id="16be7-211">Exécutez l’application et accédez à */Movies/SearchIndex*.</span><span class="sxs-lookup"><span data-stu-id="16be7-211">Run the application and navigate to */Movies/SearchIndex*.</span></span> <span data-ttu-id="16be7-212">Ajoutez une chaîne de requête comme `?searchString=ghost` à l’URL.</span><span class="sxs-lookup"><span data-stu-id="16be7-212">Append a query string such as `?searchString=ghost` to the URL.</span></span> <span data-ttu-id="16be7-213">Les films filtrés sont affichés.</span><span class="sxs-lookup"><span data-stu-id="16be7-213">The filtered movies are displayed.</span></span>

<span data-ttu-id="16be7-214">[![SearchQryStr](examining-the-edit-methods-and-edit-view/_static/image14.png)](examining-the-edit-methods-and-edit-view/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-214">[![SearchQryStr](examining-the-edit-methods-and-edit-view/_static/image14.png)](examining-the-edit-methods-and-edit-view/_static/image13.png)</span></span>

<span data-ttu-id="16be7-215">Si vous modifiez la signature de la `SearchIndex` méthode d’avoir un paramètre nommé `id`, le `id` paramètre correspond à la `{id}` espace réservé pour la valeur par défaut achemine ensemble dans le *Global.asax* fichier.</span><span class="sxs-lookup"><span data-stu-id="16be7-215">If you change the signature of the `SearchIndex` method to have a parameter named `id`, the `id` parameter will match the `{id}` placeholder for the default routes set in the *Global.asax* file.</span></span>

[!code-json[Main](examining-the-edit-methods-and-edit-view/samples/sample11.json)]

<span data-ttu-id="16be7-216">Modifié `SearchIndex` méthode se présente comme suit :</span><span class="sxs-lookup"><span data-stu-id="16be7-216">The modified `SearchIndex` method would look as follows:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample12.cs)]

<span data-ttu-id="16be7-217">Vous pouvez maintenant passer le titre de la recherche en tant que données de routage (un segment de l’URL) et non pas en tant que valeur de chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="16be7-217">You can now pass the search title as route data (a URL segment) instead of as a query string value.</span></span>

<span data-ttu-id="16be7-218">[![SearchRouteData](examining-the-edit-methods-and-edit-view/_static/image16.png)](examining-the-edit-methods-and-edit-view/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-218">[![SearchRouteData](examining-the-edit-methods-and-edit-view/_static/image16.png)](examining-the-edit-methods-and-edit-view/_static/image15.png)</span></span>

<span data-ttu-id="16be7-219">Cependant, vous ne pouvez pas attendre des utilisateurs qu’ils modifient l’URL à chaque fois qu’ils veulent rechercher un film.</span><span class="sxs-lookup"><span data-stu-id="16be7-219">However, you can't expect users to modify the URL every time they want to search for a movie.</span></span> <span data-ttu-id="16be7-220">Maintenant vous vous allez ajouter une interface utilisateur pour aider à les filtrer les films.</span><span class="sxs-lookup"><span data-stu-id="16be7-220">So now you you'll add UI to help them filter movies.</span></span> <span data-ttu-id="16be7-221">Si vous avez modifié la signature de la `SearchIndex` méthode pour tester comment passer le paramètre ID de la limite de l’itinéraire, modifiez-le pour que votre `SearchIndex` méthode prend un paramètre de chaîne nommé `searchString`:</span><span class="sxs-lookup"><span data-stu-id="16be7-221">If you changed the signature of the `SearchIndex` method to test how to pass the route-bound ID parameter, change it back so that your `SearchIndex` method takes a string parameter named `searchString`:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample13.cs)]

<span data-ttu-id="16be7-222">Ouvrez le *Views\Movies\SearchIndex.cshtml* de fichiers et juste après `@Html.ActionLink("Create New", "Create")`, ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="16be7-222">Open the *Views\Movies\SearchIndex.cshtml* file, and just after `@Html.ActionLink("Create New", "Create")`, add the following:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample14.cshtml)]

<span data-ttu-id="16be7-223">L’exemple suivant montre une partie de la *Views\Movies\SearchIndex.cshtml* fichier avec la balise de filtrage ajoutée.</span><span class="sxs-lookup"><span data-stu-id="16be7-223">The following example shows a portion of the *Views\Movies\SearchIndex.cshtml* file with the added filtering markup.</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample15.cshtml)]

<span data-ttu-id="16be7-224">Le `Html.BeginForm` helper crée une ouverture `<form>` balise.</span><span class="sxs-lookup"><span data-stu-id="16be7-224">The `Html.BeginForm` helper creates an opening `<form>` tag.</span></span> <span data-ttu-id="16be7-225">Le `Html.BeginForm` helper, le formulaire à publier vers lui-même lorsque l’utilisateur envoie le formulaire en cliquant sur le **filtre** bouton.</span><span class="sxs-lookup"><span data-stu-id="16be7-225">The `Html.BeginForm` helper causes the form to post to itself when the user submits the form by clicking the **Filter** button.</span></span>

<span data-ttu-id="16be7-226">Exécutez l’application et essayez de rechercher un film.</span><span class="sxs-lookup"><span data-stu-id="16be7-226">Run the application and try searching for a movie.</span></span>

<span data-ttu-id="16be7-227">[![SearchIndxIE9_title](examining-the-edit-methods-and-edit-view/_static/image18.png)](examining-the-edit-methods-and-edit-view/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-227">[![SearchIndxIE9_title](examining-the-edit-methods-and-edit-view/_static/image18.png)](examining-the-edit-methods-and-edit-view/_static/image17.png)</span></span>

<span data-ttu-id="16be7-228">Il existe aucune `HttpPost` surcharge de la `SearchIndex` (méthode).</span><span class="sxs-lookup"><span data-stu-id="16be7-228">There's no `HttpPost` overload of the `SearchIndex` method.</span></span> <span data-ttu-id="16be7-229">Vous n’en avez besoin, car la méthode ne change pas l’état de l’application, filtrage des données.</span><span class="sxs-lookup"><span data-stu-id="16be7-229">You don't need it, because the method isn't changing the state of the application, just filtering data.</span></span>

<span data-ttu-id="16be7-230">Vous pourriez ajouter la méthode `HttpPost SearchIndex` suivante.</span><span class="sxs-lookup"><span data-stu-id="16be7-230">You could add the following `HttpPost SearchIndex` method.</span></span> <span data-ttu-id="16be7-231">Dans ce cas, le demandeur d’action correspondrait à la `HttpPost SearchIndex` (méthode) et le `HttpPost SearchIndex` méthode s’exécuterait comme indiqué dans l’image ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="16be7-231">In that case, the action invoker would match the `HttpPost SearchIndex` method, and the `HttpPost SearchIndex` method would run as shown in the image below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample16.cs)]

<span data-ttu-id="16be7-232">[![SearchPostGhost](examining-the-edit-methods-and-edit-view/_static/image20.png)](examining-the-edit-methods-and-edit-view/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-232">[![SearchPostGhost](examining-the-edit-methods-and-edit-view/_static/image20.png)](examining-the-edit-methods-and-edit-view/_static/image19.png)</span></span>

<span data-ttu-id="16be7-233">Cependant, même si vous ajoutez cette version `HttpPost` de la méthode `SearchIndex`, il existe une limitation dans la façon dont tout ceci a été implémenté.</span><span class="sxs-lookup"><span data-stu-id="16be7-233">However, even if you add this `HttpPost` version of the `SearchIndex` method, there's a limitation in how this has all been implemented.</span></span> <span data-ttu-id="16be7-234">Imaginez que vous voulez insérer un signet pour une recherche spécifique, ou que vous voulez envoyer un lien à vos amis sur lequel ils peuvent cliquer pour afficher la même liste filtrée de films.</span><span class="sxs-lookup"><span data-stu-id="16be7-234">Imagine that you want to bookmark a particular search or you want to send a link to friends that they can click in order to see the same filtered list of movies.</span></span> <span data-ttu-id="16be7-235">Notez que l’URL de la requête HTTP POST est identique à l’URL de la requête GET (localhost : XXXXX/Movies/SearchIndex) : il n’existe aucune information de recherche dans l’URL proprement dite.</span><span class="sxs-lookup"><span data-stu-id="16be7-235">Notice that the URL for the HTTP POST request is the same as the URL for the GET request (localhost:xxxxx/Movies/SearchIndex) -- there's no search information in the URL itself.</span></span> <span data-ttu-id="16be7-236">Droite désormais, les informations de chaîne de recherche sont envoyées au serveur en tant que valeur d’un champ de formulaire.</span><span class="sxs-lookup"><span data-stu-id="16be7-236">Right now, the search string information is sent to the server as a form field value.</span></span> <span data-ttu-id="16be7-237">Cela signifie que vous ne pouvez pas capturer ces informations de recherche pour créer un signet ou envoyer à vos amis dans une URL.</span><span class="sxs-lookup"><span data-stu-id="16be7-237">This means you can't capture that search information to bookmark or send to friends in a URL.</span></span>

<span data-ttu-id="16be7-238">La solution consiste à utiliser une surcharge de `BeginForm` qui spécifie que la requête POST doit ajouter les informations de recherche à l’URL et qui doit être acheminé vers la version HttpGet de la `SearchIndex` (méthode).</span><span class="sxs-lookup"><span data-stu-id="16be7-238">The solution is to use an overload of `BeginForm` that specifies that the POST request should add the search information to the URL and that is should be routed to the HttpGet version of the `SearchIndex` method.</span></span> <span data-ttu-id="16be7-239">Remplacer l’existant sans paramètre `BeginForm` méthode par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="16be7-239">Replace the existing parameterless `BeginForm` method with the following:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample17.cshtml)]

<span data-ttu-id="16be7-240">[![BeginFormPost_SM](examining-the-edit-methods-and-edit-view/_static/image22.png)](examining-the-edit-methods-and-edit-view/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-240">[![BeginFormPost_SM](examining-the-edit-methods-and-edit-view/_static/image22.png)](examining-the-edit-methods-and-edit-view/_static/image21.png)</span></span>

<span data-ttu-id="16be7-241">Maintenant lorsque vous soumettez une recherche, l’URL contient une chaîne de requête de recherche.</span><span class="sxs-lookup"><span data-stu-id="16be7-241">Now when you submit a search, the URL contains a search query string.</span></span> <span data-ttu-id="16be7-242">La recherche accède également à la méthode d’action `HttpGet SearchIndex`, même si vous avez une méthode `HttpPost SearchIndex`.</span><span class="sxs-lookup"><span data-stu-id="16be7-242">Searching will also go to the `HttpGet SearchIndex` action method, even if you have a `HttpPost SearchIndex` method.</span></span>

<span data-ttu-id="16be7-243">[![SearchIndexWithGetURL](examining-the-edit-methods-and-edit-view/_static/image24.png)](examining-the-edit-methods-and-edit-view/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="16be7-243">[![SearchIndexWithGetURL](examining-the-edit-methods-and-edit-view/_static/image24.png)](examining-the-edit-methods-and-edit-view/_static/image23.png)</span></span>

## <a name="adding-search-by-genre"></a><span data-ttu-id="16be7-244">Ajout de la recherche par Genre</span><span class="sxs-lookup"><span data-stu-id="16be7-244">Adding Search by Genre</span></span>

<span data-ttu-id="16be7-245">Si vous avez ajouté le `HttpPost` version de la `SearchIndex` (méthode), supprimez maintenant.</span><span class="sxs-lookup"><span data-stu-id="16be7-245">If you added the `HttpPost` version of the `SearchIndex` method, delete it now.</span></span>

<span data-ttu-id="16be7-246">Ensuite, vous allez ajouter une fonctionnalité pour permettre aux utilisateurs de rechercher des films par genre.</span><span class="sxs-lookup"><span data-stu-id="16be7-246">Next, you'll add a feature to let users search for movies by genre.</span></span> <span data-ttu-id="16be7-247">Remplacez la méthode `SearchIndex` par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="16be7-247">Replace the `SearchIndex` method with the following code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample18.cs)]

<span data-ttu-id="16be7-248">Cette version de la `SearchIndex` méthode prend un paramètre supplémentaire, à savoir `movieGenre`.</span><span class="sxs-lookup"><span data-stu-id="16be7-248">This version of the `SearchIndex` method takes an additional parameter, namely `movieGenre`.</span></span> <span data-ttu-id="16be7-249">Les premières lignes de code créent un `List` objet pour contenir les genres de film à partir de la base de données.</span><span class="sxs-lookup"><span data-stu-id="16be7-249">The first few lines of code create a `List` object to hold movie genres from the database.</span></span>

<span data-ttu-id="16be7-250">Le code suivant est une requête LINQ qui récupère tous les genres dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="16be7-250">The following code is a LINQ query that retrieves all the genres from the database.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample19.cs)]

<span data-ttu-id="16be7-251">Le code utilise le `AddRange` méthode du générique `List` collection pour ajouter tous les genres distincts à la liste.</span><span class="sxs-lookup"><span data-stu-id="16be7-251">The code uses the `AddRange` method of the generic `List` collection to add all the distinct genres to the list.</span></span> <span data-ttu-id="16be7-252">(Sans le `Distinct` modificateur, genres en doublon seraient ajoutés, par exemple, comédie est ajoutée à deux reprises dans notre exemple).</span><span class="sxs-lookup"><span data-stu-id="16be7-252">(Without the `Distinct` modifier, duplicate genres would be added — for example, comedy would be added twice in our sample).</span></span> <span data-ttu-id="16be7-253">Le code stocke ensuite la liste des genres dans le `ViewBag` objet.</span><span class="sxs-lookup"><span data-stu-id="16be7-253">The code then stores the list of genres in the `ViewBag` object.</span></span>

<span data-ttu-id="16be7-254">Le code suivant montre comment vérifier la `movieGenre` paramètre.</span><span class="sxs-lookup"><span data-stu-id="16be7-254">The following code shows how to check the `movieGenre` parameter.</span></span> <span data-ttu-id="16be7-255">S’il n’est pas vide le code plus contraint la requête de films pour limiter les films sélectionnés pour le genre spécifié.</span><span class="sxs-lookup"><span data-stu-id="16be7-255">If it's not empty the code further constrains the movies query to limit the selected movies to the specified genre.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample20.cs)]

## <a name="adding-markup-to-the-searchindex-view-to-support-search-by-genre"></a><span data-ttu-id="16be7-256">Ajout de balisage à la vue SearchIndex pour prendre en charge la recherche par Genre</span><span class="sxs-lookup"><span data-stu-id="16be7-256">Adding Markup to the SearchIndex View to Support Search by Genre</span></span>

<span data-ttu-id="16be7-257">Ajouter un `Html.DropDownList` helper pour le *Views\Movies\SearchIndex.cshtml* de fichiers, juste avant la `TextBox` helper.</span><span class="sxs-lookup"><span data-stu-id="16be7-257">Add an `Html.DropDownList` helper to the *Views\Movies\SearchIndex.cshtml* file, just before the `TextBox` helper.</span></span> <span data-ttu-id="16be7-258">Le balisage complet est indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="16be7-258">The completed markup is shown below:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample21.cshtml)]

<span data-ttu-id="16be7-259">Exécutez l’application et accédez à */Movies/SearchIndex*.</span><span class="sxs-lookup"><span data-stu-id="16be7-259">Run the application and browse to */Movies/SearchIndex*.</span></span> <span data-ttu-id="16be7-260">Essayez une recherche par genre, par le nom du film et par les deux critères.</span><span class="sxs-lookup"><span data-stu-id="16be7-260">Try a search by genre, by movie name, and by both criteria.</span></span>

<span data-ttu-id="16be7-261">Dans cette section, vous avez examiné les méthodes d’action CRUD et les vues générées par le framework.</span><span class="sxs-lookup"><span data-stu-id="16be7-261">In this section you examined the CRUD action methods and views generated by the framework.</span></span> <span data-ttu-id="16be7-262">Vous avez créé une méthode d’action de recherche et de la vue qui permettre aux utilisateurs de rechercher par titre de film et genre.</span><span class="sxs-lookup"><span data-stu-id="16be7-262">You created a search action method and view that let users search by movie title and genre.</span></span> <span data-ttu-id="16be7-263">Dans la section suivante, vous explorerez comment ajouter une propriété à la `Movie` modèle et comment ajouter un initialiseur qui crée automatiquement une base de données de test.</span><span class="sxs-lookup"><span data-stu-id="16be7-263">In the next section, you'll look at how to add a property to the `Movie` model and how to add an initializer that will automatically create a test database.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="16be7-264">[Précédent](accessing-your-models-data-from-a-controller.md)
> [Suivant](adding-a-new-field.md)</span><span class="sxs-lookup"><span data-stu-id="16be7-264">[Previous](accessing-your-models-data-from-a-controller.md)
[Next](adding-a-new-field.md)</span></span>
