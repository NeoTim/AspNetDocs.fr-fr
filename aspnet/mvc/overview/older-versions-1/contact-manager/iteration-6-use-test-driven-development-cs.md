---
uid: mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
title: 'Itération #6 - Utiliser le développement axé sur les tests (C) Microsoft Docs'
author: rick-anderson
description: Dans cette sixième itération, nous ajoutons de nouvelles fonctionnalités à notre application en écrivant d’abord des tests unitaires et en écrivant du code contre les tests unitaires. Dans cette itération,...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 013c3c26-7dc3-41d1-8064-f233c86008b5
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
msc.type: authoredcontent
ms.openlocfilehash: d0e8f30a075cc79c7410ffe1b8bf02da2bd44443
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542324"
---
# <a name="iteration-6--use-test-driven-development-c"></a><span data-ttu-id="24fe2-104">Itération #6 : Utiliser le développement piloté par les tests (C#)</span><span class="sxs-lookup"><span data-stu-id="24fe2-104">Iteration #6 – Use test-driven development (C#)</span></span>

<span data-ttu-id="24fe2-105">par [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="24fe2-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="24fe2-106">Code de téléchargement</span><span class="sxs-lookup"><span data-stu-id="24fe2-106">Download Code</span></span>](iteration-6-use-test-driven-development-cs/_static/contactmanager_6_cs1.zip)

> <span data-ttu-id="24fe2-107">Dans cette sixième itération, nous ajoutons de nouvelles fonctionnalités à notre application en écrivant d’abord des tests unitaires et en écrivant du code contre les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-107">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="24fe2-108">Dans cette itération, nous ajoutons des groupes de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-108">In this iteration, we add contact groups.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="24fe2-109">Construire une application de gestion des contacts ASP.NET MVC (CMD)</span><span class="sxs-lookup"><span data-stu-id="24fe2-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="24fe2-110">Dans cette série de tutoriels, nous construisons toute une application de gestion de contact du début à la fin.</span><span class="sxs-lookup"><span data-stu-id="24fe2-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="24fe2-111">L’application Contact Manager vous permet de stocker les coordonnées - noms, numéros de téléphone et adresses e-mail - pour une liste de personnes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="24fe2-112">Nous construisons l’application sur plusieurs itérations.</span><span class="sxs-lookup"><span data-stu-id="24fe2-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="24fe2-113">À chaque itération, nous améliorons progressivement l’application.</span><span class="sxs-lookup"><span data-stu-id="24fe2-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="24fe2-114">Le but de cette approche d’itération multiple est de vous permettre de comprendre la raison de chaque changement.</span><span class="sxs-lookup"><span data-stu-id="24fe2-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="24fe2-115">Itération #1 - Créer l’application.</span><span class="sxs-lookup"><span data-stu-id="24fe2-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="24fe2-116">Dans la première itération, nous créons le Gestionnaire de Contact de la manière la plus simple possible.</span><span class="sxs-lookup"><span data-stu-id="24fe2-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="24fe2-117">Nous ajoutons un support pour les opérations de base de base de base : Créer, lire, mettre à jour et supprimer (CRUD).</span><span class="sxs-lookup"><span data-stu-id="24fe2-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="24fe2-118">Itération #2 - Rendre l’application belle.</span><span class="sxs-lookup"><span data-stu-id="24fe2-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="24fe2-119">Dans cette itération, nous améliorons l’apparence de l’application en modifiant la page principale de vue par défaut ASP.NET MVC et la feuille de style en cascade.</span><span class="sxs-lookup"><span data-stu-id="24fe2-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="24fe2-120">Itération #3 - Ajouter la validation du formulaire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="24fe2-121">Dans la troisième itération, nous ajoutons la validation de forme de base.</span><span class="sxs-lookup"><span data-stu-id="24fe2-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="24fe2-122">Nous empêchons les gens de soumettre un formulaire sans remplir les champs de formulaire requis.</span><span class="sxs-lookup"><span data-stu-id="24fe2-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="24fe2-123">Nous validons également les adresses e-mail et les numéros de téléphone.</span><span class="sxs-lookup"><span data-stu-id="24fe2-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="24fe2-124">Itération #4 - Rendre l’application lâchement couplée.</span><span class="sxs-lookup"><span data-stu-id="24fe2-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="24fe2-125">Dans cette quatrième itération, nous profitons de plusieurs modèles de conception logicielle pour faciliter le maintien et la modification de l’application Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="24fe2-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="24fe2-126">Par exemple, nous refactorrons notre application pour utiliser le modèle de dépôt et le modèle d’injection de dépendance.</span><span class="sxs-lookup"><span data-stu-id="24fe2-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="24fe2-127">Itération #5 - Créer des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="24fe2-128">Dans la cinquième itération, nous rendons notre application plus facile à maintenir et à modifier en ajoutant des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="24fe2-129">Nous nous moquons de nos classes de modèles de données et construisons des tests unitaires pour nos contrôleurs et la logique de validation.</span><span class="sxs-lookup"><span data-stu-id="24fe2-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="24fe2-130">Itération #6 - Utilisez le développement axé sur les tests.</span><span class="sxs-lookup"><span data-stu-id="24fe2-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="24fe2-131">Dans cette sixième itération, nous ajoutons de nouvelles fonctionnalités à notre application en écrivant d’abord des tests unitaires et en écrivant du code contre les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="24fe2-132">Dans cette itération, nous ajoutons des groupes de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="24fe2-133">Itération #7 - Ajouter la fonctionnalité Ajax.</span><span class="sxs-lookup"><span data-stu-id="24fe2-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="24fe2-134">Dans la septième itération, nous améliorons la réactivité et la performance de notre application en ajoutant un soutien pour Ajax.</span><span class="sxs-lookup"><span data-stu-id="24fe2-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="24fe2-135">Cette Itération</span><span class="sxs-lookup"><span data-stu-id="24fe2-135">This Iteration</span></span>

<span data-ttu-id="24fe2-136">Lors de l’itération précédente de l’application Contact Manager, nous avons créé des tests unitaires pour fournir un filet de sécurité pour notre code.</span><span class="sxs-lookup"><span data-stu-id="24fe2-136">In the previous iteration of the Contact Manager application, we created unit tests to provide a safety net for our code.</span></span> <span data-ttu-id="24fe2-137">La motivation pour créer les tests unitaires était de rendre notre code plus résistant au changement.</span><span class="sxs-lookup"><span data-stu-id="24fe2-137">The motivation for creating the unit tests was to make our code more resilient to change.</span></span> <span data-ttu-id="24fe2-138">Avec des tests unitaires en place, nous pouvons heureusement apporter n’importe quelle modification à notre code et savoir immédiatement si nous avons cassé la fonctionnalité existante.</span><span class="sxs-lookup"><span data-stu-id="24fe2-138">With unit tests in place, we can happily make any change to our code and immediately know whether we have broken existing functionality.</span></span>

<span data-ttu-id="24fe2-139">Dans cette itération, nous utilisons des tests unitaires à des fins entièrement différentes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-139">In this iteration, we use unit tests for an entirely different purpose.</span></span> <span data-ttu-id="24fe2-140">Dans cette itération, nous utilisons des tests unitaires dans le cadre d’une philosophie de conception d’applications appelée *développement piloté par les tests.*</span><span class="sxs-lookup"><span data-stu-id="24fe2-140">In this iteration, we use unit tests as part of an application design philosophy called *test-driven development*.</span></span> <span data-ttu-id="24fe2-141">Lorsque vous pratiquez le développement axé sur les tests, vous écrivez d’abord des tests, puis écrivez du code contre les tests.</span><span class="sxs-lookup"><span data-stu-id="24fe2-141">When you practice test-driven development, you write tests first and then write code against the tests.</span></span>

<span data-ttu-id="24fe2-142">Plus précisément, lorsque vous pratiquez le développement piloté par les tests, il y a trois étapes que vous remplissez lors de la création de code (Rouge/Vert/Refactor) :</span><span class="sxs-lookup"><span data-stu-id="24fe2-142">More precisely, when practicing test-driven development, there are three steps that you complete when creating code (Red/ Green/Refactor):</span></span>

1. <span data-ttu-id="24fe2-143">Écrivez un test unitaire qui échoue (Rouge)</span><span class="sxs-lookup"><span data-stu-id="24fe2-143">Write a unit test that fails (Red)</span></span>
2. <span data-ttu-id="24fe2-144">Écrire du code qui passe le test unitaire (vert)</span><span class="sxs-lookup"><span data-stu-id="24fe2-144">Write code that passes the unit test (Green)</span></span>
3. <span data-ttu-id="24fe2-145">Refactor votre code (Refactor)</span><span class="sxs-lookup"><span data-stu-id="24fe2-145">Refactor your code (Refactor)</span></span>

<span data-ttu-id="24fe2-146">Tout d’abord, vous écrivez le test unitaire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-146">First, you write the unit test.</span></span> <span data-ttu-id="24fe2-147">Le test unitaire doit exprimer votre intention quant à la façon dont vous vous attendez à ce que votre code se comporte.</span><span class="sxs-lookup"><span data-stu-id="24fe2-147">The unit test should express your intention for how you expect your code to behave.</span></span> <span data-ttu-id="24fe2-148">Lorsque vous créez le test unitaire pour la première fois, le test unitaire doit échouer.</span><span class="sxs-lookup"><span data-stu-id="24fe2-148">When you first create the unit test, the unit test should fail.</span></span> <span data-ttu-id="24fe2-149">Le test doit échouer parce que vous n’avez pas encore écrit de code d’application qui satisfait le test.</span><span class="sxs-lookup"><span data-stu-id="24fe2-149">The test should fail because you have not yet written any application code that satisfies the test.</span></span>

<span data-ttu-id="24fe2-150">Ensuite, vous écrivez juste assez de code pour que le test unitaire passe.</span><span class="sxs-lookup"><span data-stu-id="24fe2-150">Next, you write just enough code in order for the unit test to pass.</span></span> <span data-ttu-id="24fe2-151">Le but est d’écrire le code de la manière la plus paresseuse, la plus bâclée et la plus rapide possible.</span><span class="sxs-lookup"><span data-stu-id="24fe2-151">The goal is to write the code in the laziest, sloppiest and fastest possible way.</span></span> <span data-ttu-id="24fe2-152">Vous ne devriez pas perdre de temps à penser à l’architecture de votre application.</span><span class="sxs-lookup"><span data-stu-id="24fe2-152">You should not waste time thinking about the architecture of your application.</span></span> <span data-ttu-id="24fe2-153">Au lieu de cela, vous devriez vous concentrer sur la rédaction de la quantité minimale de code nécessaire pour satisfaire l’intention exprimée par le test unitaire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-153">Instead, you should focus on writing the minimal amount of code necessary to satisfy the intention expressed by the unit test.</span></span>

<span data-ttu-id="24fe2-154">Enfin, après avoir écrit suffisamment de code, vous pouvez prendre du recul et considérer l’architecture globale de votre application.</span><span class="sxs-lookup"><span data-stu-id="24fe2-154">Finally, after you have written enough code, you can step back and consider the overall architecture of your application.</span></span> <span data-ttu-id="24fe2-155">Dans cette étape, vous réécrivez (refactor) votre code en profitant des modèles de conception logicielle - tels que le modèle de dépôt - de sorte que votre code est plus maintenable.</span><span class="sxs-lookup"><span data-stu-id="24fe2-155">In this step, you rewrite (refactor) your code by taking advantage of software design patterns -- such as the repository pattern -- so that your code is more maintainable.</span></span> <span data-ttu-id="24fe2-156">Vous pouvez réécrire sans crainte votre code dans cette étape parce que votre code est couvert par des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-156">You can fearlessly rewrite your code in this step because your code is covered by unit tests.</span></span>

<span data-ttu-id="24fe2-157">Il y a beaucoup d’avantages qui résultent de la pratique du développement axé sur les tests.</span><span class="sxs-lookup"><span data-stu-id="24fe2-157">There are many benefits that result from practicing test-driven development.</span></span> <span data-ttu-id="24fe2-158">Tout d’abord, le développement axé sur les tests vous oblige à vous concentrer sur le code qui doit réellement être écrit.</span><span class="sxs-lookup"><span data-stu-id="24fe2-158">First, test-driven development forces you to focus on code that actually needs to be written.</span></span> <span data-ttu-id="24fe2-159">Parce que vous êtes constamment concentré sur l’écriture juste assez de code pour passer un test particulier, vous êtes empêché d’errer dans les herbes et d’écrire des quantités massives de code que vous n’utiliserez jamais.</span><span class="sxs-lookup"><span data-stu-id="24fe2-159">Because you are constantly focused on just writing enough code to pass a particular test, you are prevented from wandering into the weeds and writing massive amounts of code that you will never use.</span></span>

<span data-ttu-id="24fe2-160">Deuxièmement, une méthodologie de conception « test d’abord » vous oblige à écrire du code du point de vue de la façon dont votre code sera utilisé.</span><span class="sxs-lookup"><span data-stu-id="24fe2-160">Second, a "test first" design methodology forces you to write code from the perspective of how your code will be used.</span></span> <span data-ttu-id="24fe2-161">En d’autres termes, lorsque vous pratiquez le développement axé sur les tests, vous écrivez constamment vos tests du point de vue de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="24fe2-161">In other words, when practicing test-driven development, you are constantly writing your tests from a user perspective.</span></span> <span data-ttu-id="24fe2-162">Par conséquent, le développement axé sur les tests peut entraîner des API plus propres et plus compréhensibles.</span><span class="sxs-lookup"><span data-stu-id="24fe2-162">Therefore, test-driven development can result in cleaner and more understandable APIs.</span></span>

<span data-ttu-id="24fe2-163">Enfin, le développement piloté par les tests vous oblige à écrire des tests unitaires dans le cadre du processus normal d’écriture d’une demande.</span><span class="sxs-lookup"><span data-stu-id="24fe2-163">Finally, test-driven development forces you to write unit tests as part of the normal process of writing an application.</span></span> <span data-ttu-id="24fe2-164">À l’approche de la date limite du projet, le test est généralement la première chose qui sort par la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="24fe2-164">As a project deadline approaches, testing is typically the first thing that goes out the window.</span></span> <span data-ttu-id="24fe2-165">Lors de la pratique du développement axé sur les tests, d’autre part, vous êtes plus susceptible d’être vertueux sur la rédaction de tests unitaires parce que le développement piloté par test rend les tests unitaires au cœur du processus de construction d’une application.</span><span class="sxs-lookup"><span data-stu-id="24fe2-165">When practicing test-driven development, on the other hand, you are more likely to be virtuous about writing unit tests because test-driven development makes unit tests central to the process of building an application.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="24fe2-166">Pour en savoir plus sur le développement axé sur les tests, je vous recommande de lire Michael Feathers livre **Working Effectively with Legacy Code**.</span><span class="sxs-lookup"><span data-stu-id="24fe2-166">To learn more about test-driven development, I recommend that you read Michael Feathers book **Working Effectively with Legacy Code**.</span></span>

<span data-ttu-id="24fe2-167">Dans cette itération, nous ajoutons une nouvelle fonctionnalité à notre application Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="24fe2-167">In this iteration, we add a new feature to our Contact Manager application.</span></span> <span data-ttu-id="24fe2-168">Nous ajoutons un soutien aux groupes de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-168">We add support for Contact Groups.</span></span> <span data-ttu-id="24fe2-169">Vous pouvez utiliser les groupes de contact pour organiser vos contacts en catégories telles que les groupes Business et Friend.</span><span class="sxs-lookup"><span data-stu-id="24fe2-169">You can use Contact Groups to organize your contacts into categories such as Business and Friend groups.</span></span>

<span data-ttu-id="24fe2-170">Nous ajouterons cette nouvelle fonctionnalité à notre application en suivant un processus de développement piloté par les tests.</span><span class="sxs-lookup"><span data-stu-id="24fe2-170">We'll add this new functionality to our application by following a process of test-driven development.</span></span> <span data-ttu-id="24fe2-171">Nous écrirons d’abord nos tests unitaires et nous écrirons tout notre code contre ces tests.</span><span class="sxs-lookup"><span data-stu-id="24fe2-171">We'll write our unit tests first and we'll write all of our code against these tests.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="24fe2-172">Ce qui est testé</span><span class="sxs-lookup"><span data-stu-id="24fe2-172">What Gets Tested</span></span>

<span data-ttu-id="24fe2-173">Comme nous l’avons mentionné dans l’itération précédente, vous n’écrivez généralement pas de tests unitaires pour la logique d’accès aux données ou de voir la logique.</span><span class="sxs-lookup"><span data-stu-id="24fe2-173">As we discussed in the previous iteration, you typically do not write unit tests for data access logic or view logic.</span></span> <span data-ttu-id="24fe2-174">Vous n’écrivez pas de tests unitaires pour la logique d’accès aux données parce que l’accès à une base de données est une opération relativement lente.</span><span class="sxs-lookup"><span data-stu-id="24fe2-174">You don t write unit tests for data access logic because accessing a database is a relatively slow operation.</span></span> <span data-ttu-id="24fe2-175">Vous n’écrivez pas de tests unitaires pour la logique de vue parce que l’accès à une vue nécessite de faire tourner vers le haut d’un serveur web qui est une opération relativement lente.</span><span class="sxs-lookup"><span data-stu-id="24fe2-175">You don t write unit tests for view logic because accessing a view requires spinning up a web server which is a relatively slow operation.</span></span> <span data-ttu-id="24fe2-176">Vous ne devriez pas écrire un test unitaire à moins que le test puisse être exécuté encore et encore très rapidement</span><span class="sxs-lookup"><span data-stu-id="24fe2-176">You shouldn't write a unit test unless the test can be executed over and over again very fast</span></span>

<span data-ttu-id="24fe2-177">Parce que le développement axé sur les tests est conduit par des tests unitaires, nous nous concentrons d’abord sur la rédaction de contrôleur et la logique d’affaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-177">Because test-driven development is driven by unit tests, we focus initially on writing controller and business logic.</span></span> <span data-ttu-id="24fe2-178">Nous évitons de toucher la base de données ou les vues.</span><span class="sxs-lookup"><span data-stu-id="24fe2-178">We avoid touching the database or views.</span></span> <span data-ttu-id="24fe2-179">Nous ne modifierons pas la base de données ou ne créerons pas nos vues avant la toute fin de ce tutoriel.</span><span class="sxs-lookup"><span data-stu-id="24fe2-179">We won't modify the database or create our views until the very end of this tutorial.</span></span> <span data-ttu-id="24fe2-180">Nous commençons par ce qui peut être testé.</span><span class="sxs-lookup"><span data-stu-id="24fe2-180">We start with what can be tested.</span></span>

## <a name="creating-user-stories"></a><span data-ttu-id="24fe2-181">Création d’histoires d’utilisateurs</span><span class="sxs-lookup"><span data-stu-id="24fe2-181">Creating User Stories</span></span>

<span data-ttu-id="24fe2-182">Lorsque vous pratiquez le développement axé sur les tests, vous commencez toujours par écrire un test.</span><span class="sxs-lookup"><span data-stu-id="24fe2-182">When practicing test-driven development, you always start by writing a test.</span></span> <span data-ttu-id="24fe2-183">Cela soulève immédiatement la question: Comment décidez-vous quel test écrire en premier?</span><span class="sxs-lookup"><span data-stu-id="24fe2-183">This immediately raises the question: How do you decide what test to write first?</span></span> <span data-ttu-id="24fe2-184">Pour répondre à cette question, vous devriez écrire un ensemble [**d’histoires d’utilisateurs**](http://en.wikipedia.org/wiki/User_stories).</span><span class="sxs-lookup"><span data-stu-id="24fe2-184">To answer this question, you should write a set of [**user stories**](http://en.wikipedia.org/wiki/User_stories).</span></span>

<span data-ttu-id="24fe2-185">Une histoire d’utilisateur est une description très brève (généralement une phrase) d’une exigence logicielle.</span><span class="sxs-lookup"><span data-stu-id="24fe2-185">A user story is a very brief (usually one sentence) description of a software requirement.</span></span> <span data-ttu-id="24fe2-186">Il devrait s’agir d’une description non technique d’une exigence écrite du point de vue de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="24fe2-186">It should be a non-technical description of a requirement written from a user perspective.</span></span>

<span data-ttu-id="24fe2-187">Voici l’ensemble d’histoires d’utilisateurs qui décrivent les fonctionnalités requises par la nouvelle fonctionnalité du Groupe de contact :</span><span class="sxs-lookup"><span data-stu-id="24fe2-187">Here s the set of user stories that describe the features required by the new Contact Group functionality:</span></span>

1. <span data-ttu-id="24fe2-188">L’utilisateur peut consulter une liste de groupes de contacts.</span><span class="sxs-lookup"><span data-stu-id="24fe2-188">User can view a list of contact groups.</span></span>
2. <span data-ttu-id="24fe2-189">L’utilisateur peut créer un nouveau groupe de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-189">User can create a new contact group.</span></span>
3. <span data-ttu-id="24fe2-190">L’utilisateur peut supprimer un groupe de contact existant.</span><span class="sxs-lookup"><span data-stu-id="24fe2-190">User can delete an existing contact group.</span></span>
4. <span data-ttu-id="24fe2-191">L’utilisateur peut sélectionner un groupe de contact lors de la création d’un nouveau contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-191">User can select a contact group when creating a new contact.</span></span>
5. <span data-ttu-id="24fe2-192">L’utilisateur peut sélectionner un groupe de contact lors de l’édition d’un contact existant.</span><span class="sxs-lookup"><span data-stu-id="24fe2-192">User can select a contact group when editing an existing contact.</span></span>
6. <span data-ttu-id="24fe2-193">Une liste des groupes de contact est affichée dans la vue de l’index.</span><span class="sxs-lookup"><span data-stu-id="24fe2-193">A list of contact groups is displayed in the Index view.</span></span>
7. <span data-ttu-id="24fe2-194">Lorsqu’un utilisateur clique sur un groupe de contact, une liste de contacts correspondants s’affiche.</span><span class="sxs-lookup"><span data-stu-id="24fe2-194">When a user clicks a contact group, a list of matching contacts is displayed.</span></span>

<span data-ttu-id="24fe2-195">Notez que cette liste d’histoires d’utilisateurs est tout à fait compréhensible par un client.</span><span class="sxs-lookup"><span data-stu-id="24fe2-195">Notice that this list of user stories is completely understandable by a customer.</span></span> <span data-ttu-id="24fe2-196">Il n’y a aucune mention des détails de la mise en œuvre technique.</span><span class="sxs-lookup"><span data-stu-id="24fe2-196">There is no mention of technical implementation details.</span></span>

<span data-ttu-id="24fe2-197">Pendant la construction de votre application, l’ensemble des histoires d’utilisateurs peut devenir plus raffiné.</span><span class="sxs-lookup"><span data-stu-id="24fe2-197">While in the process of building your application, the set of user stories can become more refined.</span></span> <span data-ttu-id="24fe2-198">Vous pouvez décomposer une histoire d’utilisateur en plusieurs histoires (exigences).</span><span class="sxs-lookup"><span data-stu-id="24fe2-198">You might break a user story into multiple stories (requirements).</span></span> <span data-ttu-id="24fe2-199">Par exemple, vous pouvez décider que la création d’un nouveau groupe de contact devrait impliquer la validation.</span><span class="sxs-lookup"><span data-stu-id="24fe2-199">For example, you might decide that creating a new contact group should involve validation.</span></span> <span data-ttu-id="24fe2-200">Soumettre un groupe de contact sans nom doit renvoyer une erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="24fe2-200">Submitting a contact group without a name should return a validation error.</span></span>

<span data-ttu-id="24fe2-201">Après avoir créé une liste d’histoires d’utilisateurs, vous êtes prêt à écrire votre premier test unitaire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-201">After you create a list of user stories, you are ready to write your first unit test.</span></span> <span data-ttu-id="24fe2-202">Nous commencerons par créer un test unitaire pour consulter la liste des groupes de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-202">We'll start by creating a unit test for viewing the list of contact groups.</span></span>

## <a name="listing-contact-groups"></a><span data-ttu-id="24fe2-203">Liste des groupes de contact</span><span class="sxs-lookup"><span data-stu-id="24fe2-203">Listing Contact Groups</span></span>

<span data-ttu-id="24fe2-204">Notre première histoire d’utilisateur est qu’un utilisateur doit être en mesure de voir une liste de groupes de contacts.</span><span class="sxs-lookup"><span data-stu-id="24fe2-204">Our first user story is that a user should be able to view a list of contact groups.</span></span> <span data-ttu-id="24fe2-205">Nous devons exprimer cette histoire avec un test.</span><span class="sxs-lookup"><span data-stu-id="24fe2-205">We need to express this story with a test.</span></span>

<span data-ttu-id="24fe2-206">Créez un nouveau test unitaire en cliquant à droite sur le dossier Controllers dans le projet ContactManager.Tests, en sélectionnant **Add, New Test**et en sélectionnant le modèle **de test unitaire** (voir la figure 1).</span><span class="sxs-lookup"><span data-stu-id="24fe2-206">Create a new unit test by right-clicking the Controllers folder in the ContactManager.Tests project, selecting **Add, New Test**, and selecting the **Unit Test** template (see Figure 1).</span></span> <span data-ttu-id="24fe2-207">Nommez le nouveau test unitaire GroupControllerTest.cs et cliquez sur le bouton **OK.**</span><span class="sxs-lookup"><span data-stu-id="24fe2-207">Name the new unit test GroupControllerTest.cs and click the **OK** button.</span></span>

<span data-ttu-id="24fe2-208">[![Ajout du test unitaire GroupControllerTest](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-208">[![Adding the GroupControllerTest unit test](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span></span>

<span data-ttu-id="24fe2-209">**Figure 01**: Ajout du test unitaire GroupControllerTest[(Cliquez pour voir l’image grandeur nature)](iteration-6-use-test-driven-development-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-209">**Figure 01**: Adding the GroupControllerTest unit test([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image2.png))</span></span>

<span data-ttu-id="24fe2-210">Notre premier test unitaire est contenu dans la liste 1.</span><span class="sxs-lookup"><span data-stu-id="24fe2-210">Our first unit test is contained in Listing 1.</span></span> <span data-ttu-id="24fe2-211">Ce test vérifie que la méthode Index() du contrôleur de groupe renvoie un ensemble de groupes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-211">This test verifies that the Index() method of the Group controller returns a set of Groups.</span></span> <span data-ttu-id="24fe2-212">Le test vérifie qu’une collection de groupes est retournée en vue des données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-212">The test verifies that a collection of Groups is returned in view data.</span></span>

<span data-ttu-id="24fe2-213">**Liste 1 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-213">**Listing 1 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample1.cs)]

<span data-ttu-id="24fe2-214">Lorsque vous tapez le code dans la liste 1 dans Visual Studio, vous obtiendrez beaucoup de lignes rouges squiggly.</span><span class="sxs-lookup"><span data-stu-id="24fe2-214">When you first type the code in Listing 1 in Visual Studio, you'll get a lot of red squiggly lines.</span></span> <span data-ttu-id="24fe2-215">Nous n’avons pas créé les classes GroupController ou Group.</span><span class="sxs-lookup"><span data-stu-id="24fe2-215">We have not created the GroupController or Group classes.</span></span>

<span data-ttu-id="24fe2-216">À ce stade, nous ne pouvons même pas construire notre application afin que nous puissions ne pas exécuter notre premier test unitaire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-216">At this point, we can t even build our application so we can t execute our first unit test.</span></span> <span data-ttu-id="24fe2-217">C’est bon.</span><span class="sxs-lookup"><span data-stu-id="24fe2-217">That s good.</span></span> <span data-ttu-id="24fe2-218">Cela compte comme un test défaillant.</span><span class="sxs-lookup"><span data-stu-id="24fe2-218">That counts as a failing test.</span></span> <span data-ttu-id="24fe2-219">Par conséquent, nous avons maintenant la permission de commencer à écrire le code d’application.</span><span class="sxs-lookup"><span data-stu-id="24fe2-219">Therefore, we now have permission to start writing application code.</span></span> <span data-ttu-id="24fe2-220">Nous devons écrire suffisamment de code pour exécuter notre test.</span><span class="sxs-lookup"><span data-stu-id="24fe2-220">We need to write enough code to execute our test.</span></span>

<span data-ttu-id="24fe2-221">La classe de contrôleur de groupe dans la liste 2 contient le strict minimum de code requis pour réussir le test unitaire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-221">The Group controller class in Listing 2 contains the bare minimum of code required to pass the unit test.</span></span> <span data-ttu-id="24fe2-222">L’action Index() renvoie une liste statique de groupes codés (la classe du Groupe est définie dans la liste 3).</span><span class="sxs-lookup"><span data-stu-id="24fe2-222">The Index() action returns a statically coded list of Groups (the Group class is defined in Listing 3).</span></span>

<span data-ttu-id="24fe2-223">**Liste 2 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-223">**Listing 2 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample2.cs)]

<span data-ttu-id="24fe2-224">**Liste 3 - Models-Group.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-224">**Listing 3 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample3.cs)]

<span data-ttu-id="24fe2-225">Après avoir ajouté les classes GroupController et Group à notre projet, notre premier test unitaire se termine avec succès (voir la figure 2).</span><span class="sxs-lookup"><span data-stu-id="24fe2-225">After we add the GroupController and Group classes to our project, our first unit test completes successfully (see Figure 2).</span></span> <span data-ttu-id="24fe2-226">Nous avons fait le travail minimum nécessaire pour passer le test.</span><span class="sxs-lookup"><span data-stu-id="24fe2-226">We have done the minimum work required to pass the test.</span></span> <span data-ttu-id="24fe2-227">Il est temps de célébrer.</span><span class="sxs-lookup"><span data-stu-id="24fe2-227">It is time to celebrate.</span></span>

<span data-ttu-id="24fe2-228">[![Succès!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-228">[![Success!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span></span>

<span data-ttu-id="24fe2-229">**Figure 02**: Succès! ([Cliquez pour voir l’image pleine grandeur](iteration-6-use-test-driven-development-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="24fe2-229">**Figure 02**: Success!([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image4.png))</span></span>

## <a name="creating-contact-groups"></a><span data-ttu-id="24fe2-230">Création de groupes de contact</span><span class="sxs-lookup"><span data-stu-id="24fe2-230">Creating Contact Groups</span></span>

<span data-ttu-id="24fe2-231">Maintenant, nous pouvons passer à la deuxième histoire d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="24fe2-231">Now we can move on to the second user story.</span></span> <span data-ttu-id="24fe2-232">Nous devons être en mesure de créer de nouveaux groupes de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-232">We need to be able to create new contact groups.</span></span> <span data-ttu-id="24fe2-233">Nous devons exprimer cette intention par un test.</span><span class="sxs-lookup"><span data-stu-id="24fe2-233">We need to express this intention with a test.</span></span>

<span data-ttu-id="24fe2-234">Le test de La Liste 4 vérifie que l’appel de la méthode Créer () avec un nouveau Groupe ajoute le Groupe à la liste des groupes retournés par la méthode Index().</span><span class="sxs-lookup"><span data-stu-id="24fe2-234">The test in Listing 4 verifies that calling the Create() method with a new Group adds the Group to the list of Groups returned by the Index() method.</span></span> <span data-ttu-id="24fe2-235">En d’autres termes, si je crée un nouveau groupe, je devrais être en mesure de récupérer le nouveau groupe de la liste des groupes retournés par la méthode Index() .</span><span class="sxs-lookup"><span data-stu-id="24fe2-235">In other words, if I create a new group then I should be able to get the new Group back from the list of Groups returned by the Index() method.</span></span>

<span data-ttu-id="24fe2-236">**Liste 4 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-236">**Listing 4 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample4.cs)]

<span data-ttu-id="24fe2-237">Le test dans La liste 4 appelle la méthode De création de contrôleur de groupe avec un nouveau groupe de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-237">The test in Listing 4 calls the Group controller Create() method with a new contact Group.</span></span> <span data-ttu-id="24fe2-238">Ensuite, le test vérifie que l’appel de la méthode Group Controller Index() renvoie le nouveau Groupe en vue des données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-238">Next, the test verifies that calling the Group controller Index() method returns the new Group in view data.</span></span>

<span data-ttu-id="24fe2-239">Le contrôleur de groupe modifié dans la liste 5 contient le strict minimum de modifications requises pour réussir le nouveau test.</span><span class="sxs-lookup"><span data-stu-id="24fe2-239">The modified Group controller in Listing 5 contains the bare minimum of changes required to pass the new test.</span></span>

<span data-ttu-id="24fe2-240">**Liste 5 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-240">**Listing 5 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample5.cs)]

## <a name="the-group-controller-in-listing-5-has-a-new-create-action-this-action-adds-a-group-to-a-collection-of-groups-notice-that-the-index-action-has-been-modified-to-return-the-contents-of-the-collection-of-groups"></a><span data-ttu-id="24fe2-241">Le contrôleur de groupe dans La liste 5 a une nouvelle action Create().</span><span class="sxs-lookup"><span data-stu-id="24fe2-241">The Group controller in Listing 5 has a new Create() action.</span></span> <span data-ttu-id="24fe2-242">Cette action ajoute un Groupe à une collection de groupes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-242">This action adds a Group to a collection of Groups.</span></span> <span data-ttu-id="24fe2-243">Notez que l’action Index() a été modifiée pour retourner le contenu de la collection des groupes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-243">Notice that the Index() action has been modified to return the contents of the collection of Groups.</span></span>

<span data-ttu-id="24fe2-244">Encore une fois, nous avons effectué le minimum de travail nécessaire pour réussir le test unitaire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-244">Once again, we have performed the bare minimum amount of work required to pass the unit test.</span></span> <span data-ttu-id="24fe2-245">Après avoir apporté ces modifications au contrôleur de groupe, tous nos tests unitaires passent.</span><span class="sxs-lookup"><span data-stu-id="24fe2-245">After we make these changes to the Group controller, all of our unit tests pass.</span></span>

## <a name="adding-validation"></a><span data-ttu-id="24fe2-246">Ajouter une validation</span><span class="sxs-lookup"><span data-stu-id="24fe2-246">Adding Validation</span></span>

<span data-ttu-id="24fe2-247">Cette exigence n’a pas été énoncée explicitement dans l’histoire de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="24fe2-247">This requirement was not stated explicitly in the user story.</span></span> <span data-ttu-id="24fe2-248">Toutefois, il est raisonnable d’exiger qu’un Groupe ait un nom.</span><span class="sxs-lookup"><span data-stu-id="24fe2-248">However, it is reasonable to require that a Group have a name.</span></span> <span data-ttu-id="24fe2-249">Sinon, l’organisation de contacts en groupes ne serait pas très utile.</span><span class="sxs-lookup"><span data-stu-id="24fe2-249">Otherwise, organizing contacts into Groups would not be very useful.</span></span>

<span data-ttu-id="24fe2-250">Liste 6 contient un nouveau test qui exprime cette intention.</span><span class="sxs-lookup"><span data-stu-id="24fe2-250">Listing 6 contains a new test that expresses this intention.</span></span> <span data-ttu-id="24fe2-251">Ce test vérifie que tenter de créer un groupe sans fournir de nom aboutit à un message d’erreur de validation dans l’état du modèle.</span><span class="sxs-lookup"><span data-stu-id="24fe2-251">This test verifies that attempting to create a Group without supplying a name results in a validation error message in model state.</span></span>

<span data-ttu-id="24fe2-252">**Liste 6 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-252">**Listing 6 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample6.cs)]

<span data-ttu-id="24fe2-253">Afin de satisfaire ce test, nous devons ajouter une propriété Nom à notre classe de groupe (voir Liste 7).</span><span class="sxs-lookup"><span data-stu-id="24fe2-253">In order to satisfy this test, we need to add a Name property to our Group class (see Listing 7).</span></span> <span data-ttu-id="24fe2-254">En outre, nous devons ajouter un tout petit peu de logique de validation à notre contrôleur de groupe s Créer () action (voir Liste 8).</span><span class="sxs-lookup"><span data-stu-id="24fe2-254">Furthermore, we need to add a tiny bit of validation logic to our Group controller s Create() action (see Listing 8).</span></span>

<span data-ttu-id="24fe2-255">**Liste 7 - Models-Group.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-255">**Listing 7 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample7.cs)]

<span data-ttu-id="24fe2-256">**Liste 8 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-256">**Listing 8 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample8.cs)]

<span data-ttu-id="24fe2-257">Notez que l’action De création () du contrôleur de groupe contient désormais à la fois la validation et la logique de base de données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-257">Notice that the Group controller Create() action now contains both validation and database logic.</span></span> <span data-ttu-id="24fe2-258">Actuellement, la base de données utilisée par le contrôleur de groupe se compose de rien de plus qu’une collection en mémoire.</span><span class="sxs-lookup"><span data-stu-id="24fe2-258">Currently, the database used by the Group controller consists of nothing more than an in-memory collection.</span></span>

## <a name="time-to-refactor"></a><span data-ttu-id="24fe2-259">Temps de Refactor</span><span class="sxs-lookup"><span data-stu-id="24fe2-259">Time to Refactor</span></span>

<span data-ttu-id="24fe2-260">La troisième étape dans Red/Green/Refactor est la partie Refactor.</span><span class="sxs-lookup"><span data-stu-id="24fe2-260">The third step in Red/Green/Refactor is the Refactor part.</span></span> <span data-ttu-id="24fe2-261">À ce stade, nous devons prendre du recul par chemin de notre code et réfléchir à la façon dont nous pouvons refactorer notre application pour améliorer sa conception.</span><span class="sxs-lookup"><span data-stu-id="24fe2-261">At this point, we need to step back from our code and consider how we can refactor our application to improve its design.</span></span> <span data-ttu-id="24fe2-262">L’étape Refactor est l’étape à laquelle nous pensons dur sur la meilleure façon de mettre en œuvre des principes et des modèles de conception de logiciels.</span><span class="sxs-lookup"><span data-stu-id="24fe2-262">The Refactor stage is the stage at which we think hard about the best way of implementing software design principles and patterns.</span></span>

<span data-ttu-id="24fe2-263">Nous sommes libres de modifier notre code de la manière que nous choisissons d’améliorer la conception du code.</span><span class="sxs-lookup"><span data-stu-id="24fe2-263">We are free to modify our code in any way that we choose to improve the design of the code.</span></span> <span data-ttu-id="24fe2-264">Nous disposons d’un filet de sécurité des tests unitaires qui nous empêchent de briser les fonctionnalités existantes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-264">We have a safety net of unit tests that prevent us from breaking existing functionality.</span></span>

<span data-ttu-id="24fe2-265">À l’heure actuelle, notre contrôleur de groupe est un gâchis du point de vue d’une bonne conception de logiciels.</span><span class="sxs-lookup"><span data-stu-id="24fe2-265">Right now, our Group controller is a mess from the perspective of good software design.</span></span> <span data-ttu-id="24fe2-266">Le contrôleur du groupe contient un désordre enchevêtré de validation et de code d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-266">The Group controller contains a tangled mess of validation and data access code.</span></span> <span data-ttu-id="24fe2-267">Pour éviter de violer le principe de responsabilité unique, nous devons séparer ces préoccupations en différentes classes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-267">To avoid violating the Single Responsibility Principle, we need to separate these concerns into different classes.</span></span>

<span data-ttu-id="24fe2-268">Notre classe de contrôleur de groupe refactorisé est contenue dans la liste 9.</span><span class="sxs-lookup"><span data-stu-id="24fe2-268">Our refactored Group controller class is contained in Listing 9.</span></span> <span data-ttu-id="24fe2-269">Le contrôleur a été modifié pour utiliser la couche de service ContactManager.</span><span class="sxs-lookup"><span data-stu-id="24fe2-269">The controller has been modified to use the ContactManager service layer.</span></span> <span data-ttu-id="24fe2-270">Il s’agit de la même couche de service que nous utilisons avec le contrôleur de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-270">This is the same service layer that we use with the Contact controller.</span></span>

<span data-ttu-id="24fe2-271">La liste 10 contient les nouvelles méthodes ajoutées à la couche de service ContactManager pour soutenir la validation, la liste et la création de groupes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-271">Listing 10 contains the new methods added to the ContactManager service layer to support validating, listing, and creating groups.</span></span> <span data-ttu-id="24fe2-272">L’interface IContactManagerService a été mise à jour pour inclure les nouvelles méthodes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-272">The IContactManagerService interface was updated to include the new methods.</span></span>

<span data-ttu-id="24fe2-273">La liste 11 contient une nouvelle classe FakeContactManagerRepository qui met en œuvre l’interface IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="24fe2-273">Listing 11 contains a new FakeContactManagerRepository class that implements the IContactManagerRepository interface.</span></span> <span data-ttu-id="24fe2-274">Contrairement à la classe EntityContactManagerRepository qui met également en œuvre l’interface IContactManagerRepository, notre nouvelle classe FakeContactManagerRepository ne communique pas avec la base de données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-274">Unlike the EntityContactManagerRepository class that also implements the IContactManagerRepository interface, our new FakeContactManagerRepository class does not communicate with the database.</span></span> <span data-ttu-id="24fe2-275">La classe FakeContactManagerRepository utilise une collection de mémoire comme proxy pour la base de données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-275">The FakeContactManagerRepository class uses an in-memory collection as a proxy for the database.</span></span> <span data-ttu-id="24fe2-276">Nous utiliserons cette classe dans nos tests unitaires comme une fausse couche de dépôt.</span><span class="sxs-lookup"><span data-stu-id="24fe2-276">We'll use this class in our unit tests as a fake repository layer.</span></span>

<span data-ttu-id="24fe2-277">**Liste 9 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-277">**Listing 9 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample9.cs)]

<span data-ttu-id="24fe2-278">**Liste 10 - Controllers-ContactManagerService.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-278">**Listing 10 - Controllers\ContactManagerService.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample10.cs)]

<span data-ttu-id="24fe2-279">**Liste 11 - Controllers-FakeContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-279">**Listing 11 - Controllers\FakeContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample11.cs)]

<span data-ttu-id="24fe2-280">La modification de l’interface IContactManagerRepository nécessite une utilisation pour implémenter les méthodes CreateGroup() et ListGroups() dans la classe EntityContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="24fe2-280">Modifying the IContactManagerRepository interface requires use to implement the CreateGroup() and ListGroups() methods in the EntityContactManagerRepository class.</span></span> <span data-ttu-id="24fe2-281">La façon la plus paresseuse et la plus rapide de le faire est d’ajouter des méthodes de talon qui ressemblent à ceci:</span><span class="sxs-lookup"><span data-stu-id="24fe2-281">The laziest and fastest way to do this is to add stub methods that look like this:</span></span>   

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample12.cs)]

<span data-ttu-id="24fe2-282">Enfin, ces changements à la conception de notre application nous obligent à apporter quelques modifications à nos tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-282">Finally, these changes to the design of our application require us to make some modifications to our unit tests.</span></span> <span data-ttu-id="24fe2-283">Nous devons maintenant utiliser le FakeContactManagerRepository lors de l’exécution des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-283">We now need to use the FakeContactManagerRepository when performing the unit tests.</span></span> <span data-ttu-id="24fe2-284">La classe GroupControllerTest mise à jour est contenue dans la liste 12.</span><span class="sxs-lookup"><span data-stu-id="24fe2-284">The updated GroupControllerTest class is contained in Listing 12.</span></span>

<span data-ttu-id="24fe2-285">**Liste 12 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-285">**Listing 12 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample13.cs)]

<span data-ttu-id="24fe2-286">Après avoir fait tous ces changements, une fois de plus, tous nos tests unitaires passent.</span><span class="sxs-lookup"><span data-stu-id="24fe2-286">After we make all of these changes, once again, all of our unit tests pass.</span></span> <span data-ttu-id="24fe2-287">Nous avons terminé tout le cycle de Red/Green/Refactor.</span><span class="sxs-lookup"><span data-stu-id="24fe2-287">We have completed the entire cycle of Red/Green/Refactor.</span></span> <span data-ttu-id="24fe2-288">Nous avons mis en œuvre les deux premières histoires d’utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="24fe2-288">We have implemented the first two user stories.</span></span> <span data-ttu-id="24fe2-289">Nous avons maintenant des tests unitaires à l’appui pour les exigences exprimées dans les histoires d’utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="24fe2-289">We now have supporting unit tests for the requirements expressed in the user stories.</span></span> <span data-ttu-id="24fe2-290">La mise en œuvre du reste des histoires d’utilisateurs implique de répéter le même cycle de Red/Green/Refactor.</span><span class="sxs-lookup"><span data-stu-id="24fe2-290">Implementing the remainder of the user stories involves repeating the same cycle of Red/Green/Refactor.</span></span>

## <a name="modifying-our-database"></a><span data-ttu-id="24fe2-291">Modification de notre base de données</span><span class="sxs-lookup"><span data-stu-id="24fe2-291">Modifying our Database</span></span>

<span data-ttu-id="24fe2-292">Malheureusement, même si nous avons satisfait à toutes les exigences exprimées par nos tests unitaires, notre travail n’est pas terminé.</span><span class="sxs-lookup"><span data-stu-id="24fe2-292">Unfortunately, even though we have satisfied all of the requirements expressed by our unit tests, our work is not done.</span></span> <span data-ttu-id="24fe2-293">Nous devons encore modifier notre base de données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-293">We still need to modify our database.</span></span>

<span data-ttu-id="24fe2-294">Nous devons créer une nouvelle table de base de données du Groupe.</span><span class="sxs-lookup"><span data-stu-id="24fe2-294">We need to create a new Group database table.</span></span> <span data-ttu-id="24fe2-295">Procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="24fe2-295">Follow these steps:</span></span>

1. <span data-ttu-id="24fe2-296">Dans la fenêtre Server Explorer, cliquez à droite sur le dossier Tables et sélectionnez l’option menu **Ajouter une nouvelle table**.</span><span class="sxs-lookup"><span data-stu-id="24fe2-296">In the Server Explorer window, right-click the Tables folder and select the menu option **Add New Table**.</span></span>
2. <span data-ttu-id="24fe2-297">Entrez les deux colonnes décrites ci-dessous dans le concepteur de table.</span><span class="sxs-lookup"><span data-stu-id="24fe2-297">Enter the two columns described below in the Table Designer.</span></span>
3. <span data-ttu-id="24fe2-298">Marquez la colonne Id comme clé principale et colonne d’identité.</span><span class="sxs-lookup"><span data-stu-id="24fe2-298">Mark the Id column as a primary key and Identity column.</span></span>
4. <span data-ttu-id="24fe2-299">Enregistrer la nouvelle table avec le nom Groupes en cliquant sur l’icône de la disquette.</span><span class="sxs-lookup"><span data-stu-id="24fe2-299">Save the new table with the name Groups by clicking the icon of the floppy.</span></span>

<a id="0.11_table01"></a>

| <span data-ttu-id="24fe2-300">**Nom de colonne**</span><span class="sxs-lookup"><span data-stu-id="24fe2-300">**Column Name**</span></span> | <span data-ttu-id="24fe2-301">**Type de données**</span><span class="sxs-lookup"><span data-stu-id="24fe2-301">**Data Type**</span></span> | <span data-ttu-id="24fe2-302">**Null autorisé**</span><span class="sxs-lookup"><span data-stu-id="24fe2-302">**Allow Nulls**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="24fe2-303">Id</span><span class="sxs-lookup"><span data-stu-id="24fe2-303">Id</span></span> | <span data-ttu-id="24fe2-304">int</span><span class="sxs-lookup"><span data-stu-id="24fe2-304">int</span></span> | <span data-ttu-id="24fe2-305">False</span><span class="sxs-lookup"><span data-stu-id="24fe2-305">False</span></span> |
| <span data-ttu-id="24fe2-306">Nom</span><span class="sxs-lookup"><span data-stu-id="24fe2-306">Name</span></span> | <span data-ttu-id="24fe2-307">nvarchar(50)</span><span class="sxs-lookup"><span data-stu-id="24fe2-307">nvarchar(50)</span></span> | <span data-ttu-id="24fe2-308">False</span><span class="sxs-lookup"><span data-stu-id="24fe2-308">False</span></span> |

<span data-ttu-id="24fe2-309">Ensuite, nous devons supprimer toutes les données de la table Contacts (sinon, nous ne serons pas en mesure de créer une relation entre les tableaux Contacts et Groupes).</span><span class="sxs-lookup"><span data-stu-id="24fe2-309">Next, we need to delete all of the data from the Contacts table (otherwise, we won't be able to create a relationship between the Contacts and Groups tables).</span></span> <span data-ttu-id="24fe2-310">Procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="24fe2-310">Follow these steps:</span></span>

1. <span data-ttu-id="24fe2-311">Cliquez à droite sur la table Contacts et sélectionnez l’option menu **Afficher les données de table**.</span><span class="sxs-lookup"><span data-stu-id="24fe2-311">Right-click the Contacts table and select the menu option **Show Table Data**.</span></span>
2. <span data-ttu-id="24fe2-312">Supprimer toutes les lignes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-312">Delete all of the rows.</span></span>

<span data-ttu-id="24fe2-313">Ensuite, nous devons définir une relation entre le tableau de base de données des groupes et le tableau de base de données Contacts existant.</span><span class="sxs-lookup"><span data-stu-id="24fe2-313">Next, we need to define a relationship between the Groups database table and the existing Contacts database table.</span></span> <span data-ttu-id="24fe2-314">Procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="24fe2-314">Follow these steps:</span></span>

1. <span data-ttu-id="24fe2-315">Double-cliquez sur la table Contacts dans la fenêtre Server Explorer pour ouvrir le concepteur de table.</span><span class="sxs-lookup"><span data-stu-id="24fe2-315">Double-click the Contacts table in the Server Explorer window to open the Table Designer.</span></span>
2. <span data-ttu-id="24fe2-316">Ajoutez une nouvelle colonne d’intégrer à la table Contacts nommée GroupId.</span><span class="sxs-lookup"><span data-stu-id="24fe2-316">Add a new integer column to the Contacts table named GroupId.</span></span>
3. <span data-ttu-id="24fe2-317">Cliquez sur le bouton Relation pour ouvrir le dialogue sur les relations avec les relations avec les clés étrangères (voir la figure 3).</span><span class="sxs-lookup"><span data-stu-id="24fe2-317">Click the Relationship button to open the Foreign Key Relationships dialog (see Figure 3).</span></span>
4. <span data-ttu-id="24fe2-318">Cliquez sur le bouton Ajouter.</span><span class="sxs-lookup"><span data-stu-id="24fe2-318">Click the Add button.</span></span>
5. <span data-ttu-id="24fe2-319">Cliquez sur le bouton ellipsis qui apparaît à côté du bouton De spécification de la table et des colonnes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-319">Click the ellipsis button that appears next to the Table and Columns Specification button.</span></span>
6. <span data-ttu-id="24fe2-320">Dans le dialogue Tableaux et Colonnes, sélectionnez les groupes comme tableau principal et Id comme colonne principale.</span><span class="sxs-lookup"><span data-stu-id="24fe2-320">In the Tables and Columns dialog, select Groups as the primary key table and Id as the primary key column.</span></span> <span data-ttu-id="24fe2-321">Sélectionnez Contacts comme tableau clé étranger et GroupId comme colonne clé étrangère (voir la figure 4).</span><span class="sxs-lookup"><span data-stu-id="24fe2-321">Select Contacts as the foreign key table and GroupId as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="24fe2-322">Cliquez sur le bouton OK.</span><span class="sxs-lookup"><span data-stu-id="24fe2-322">Click the OK button.</span></span>
7. <span data-ttu-id="24fe2-323">Dans le cadre **de la spécification INSERT et UPDATE**, sélectionnez la valeur **Cascade** pour supprimer **la règle**.</span><span class="sxs-lookup"><span data-stu-id="24fe2-323">Under **INSERT and UPDATE Specification**, select the value **Cascade** for **Delete Rule**.</span></span>
8. <span data-ttu-id="24fe2-324">Cliquez sur le bouton Fermer pour fermer le dialogue Foreign Key Relationships.</span><span class="sxs-lookup"><span data-stu-id="24fe2-324">Click the Close button to close the Foreign Key Relationships dialog.</span></span>
9. <span data-ttu-id="24fe2-325">Cliquez sur le bouton Enregistrer pour enregistrer les modifications apportées à la table Contacts.</span><span class="sxs-lookup"><span data-stu-id="24fe2-325">Click the Save button to save the changes to the Contacts table.</span></span>

<span data-ttu-id="24fe2-326">[![Création d’une relation de table de base de données](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-326">[![Creating a database table relationship](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span></span>

<span data-ttu-id="24fe2-327">**Figure 03**: Création d’une relation de table de base de données[(Cliquez pour voir l’image grandeur nature](iteration-6-use-test-driven-development-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="24fe2-327">**Figure 03**: Creating a database table relationship ([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image6.png))</span></span>

<span data-ttu-id="24fe2-328">[![Spécifier les relations de table](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-328">[![Specifying table relationships](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span></span>

<span data-ttu-id="24fe2-329">**Figure 04**: Spécifier les relations de table[(Cliquez pour voir l’image grandeur nature](iteration-6-use-test-driven-development-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="24fe2-329">**Figure 04**: Specifying table relationships([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image8.png))</span></span>

### <a name="updating-our-data-model"></a><span data-ttu-id="24fe2-330">Mise à jour de notre modèle de données</span><span class="sxs-lookup"><span data-stu-id="24fe2-330">Updating our Data Model</span></span>

<span data-ttu-id="24fe2-331">Ensuite, nous devons mettre à jour notre modèle de données pour représenter le nouveau tableau de base de données.</span><span class="sxs-lookup"><span data-stu-id="24fe2-331">Next, we need to update our data model to represent the new database table.</span></span> <span data-ttu-id="24fe2-332">Procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="24fe2-332">Follow these steps:</span></span>

1. <span data-ttu-id="24fe2-333">Double-cliquez sur le fichier ContactManagerModel.edmx dans le dossier Models pour ouvrir le concepteur d’entités.</span><span class="sxs-lookup"><span data-stu-id="24fe2-333">Double-click the ContactManagerModel.edmx file in the Models folder to open the Entity Designer.</span></span>
2. <span data-ttu-id="24fe2-334">Cliquez à droite sur la surface du Concepteur et sélectionnez le **modèle de mise à jour de l’option de**menu à partir de database .</span><span class="sxs-lookup"><span data-stu-id="24fe2-334">Right-click the Designer surface and select the menu option **Update Model from Database**.</span></span>
3. <span data-ttu-id="24fe2-335">Dans l’assistant de mise à jour, sélectionnez la table groupes et cliquez sur le bouton Finition (voir figure 5).</span><span class="sxs-lookup"><span data-stu-id="24fe2-335">In the Update Wizard, select the Groups table and click the Finish button (see Figure 5).</span></span>
4. <span data-ttu-id="24fe2-336">Cliquez à droite sur l’entité Groupes et sélectionnez l’option de menu **Renommer**.</span><span class="sxs-lookup"><span data-stu-id="24fe2-336">Right-click the Groups entity and select the menu option **Rename**.</span></span> <span data-ttu-id="24fe2-337">Changer le nom de l’entité *Groupes* en *Groupe* (singulier).</span><span class="sxs-lookup"><span data-stu-id="24fe2-337">Change the name of the *Groups* entity to *Group* (singular).</span></span>
5. <span data-ttu-id="24fe2-338">Cliquez à droite sur la propriété de navigation Des groupes qui apparaît au bas de l’entité Contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-338">Right-click the Groups navigation property that appears at the bottom of the Contact entity.</span></span> <span data-ttu-id="24fe2-339">Changer le nom de la propriété de navigation *des Groupes* en *Groupe* (singulier).</span><span class="sxs-lookup"><span data-stu-id="24fe2-339">Change the name of the *Groups* navigation property to *Group* (singular).</span></span>

<span data-ttu-id="24fe2-340">[![Mise à jour d’un modèle cadre d’entité à partir de la base de données](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-340">[![Updating an Entity Framework model from the database](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span></span>

<span data-ttu-id="24fe2-341">**Figure 05**: Mise à jour d’un modèle cadre d’entité à partir de la base de données[(Cliquez pour voir l’image grandeur nature](iteration-6-use-test-driven-development-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="24fe2-341">**Figure 05**: Updating an Entity Framework model from the database([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image10.png))</span></span>

<span data-ttu-id="24fe2-342">Une fois que vous aurez terminé ces étapes, votre modèle de données représentera à la fois les tableaux Contacts et Groupes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-342">After you complete these steps, your data model will represent both the Contacts and Groups tables.</span></span> <span data-ttu-id="24fe2-343">Le concepteur d’entités doit montrer les deux entités (voir la figure 6).</span><span class="sxs-lookup"><span data-stu-id="24fe2-343">The Entity Designer should show both entities (see Figure 6).</span></span>

<span data-ttu-id="24fe2-344">[![Concepteur d’entité affichant le groupe et le contact](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-344">[![Entity Designer displaying Group and Contact](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span></span>

<span data-ttu-id="24fe2-345">**Figure 06**: Entity Designer affichant le groupe et le contact ([Cliquez pour voir l’image grandeur nature](iteration-6-use-test-driven-development-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="24fe2-345">**Figure 06**: Entity Designer displaying Group and Contact([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image12.png))</span></span>

### <a name="creating-our-repository-classes"></a><span data-ttu-id="24fe2-346">Création de nos classes de dépôt</span><span class="sxs-lookup"><span data-stu-id="24fe2-346">Creating our Repository Classes</span></span>

<span data-ttu-id="24fe2-347">Ensuite, nous devons mettre en œuvre notre classe de dépôt.</span><span class="sxs-lookup"><span data-stu-id="24fe2-347">Next, we need to implement our repository class.</span></span> <span data-ttu-id="24fe2-348">Au cours de cette itération, nous avons ajouté plusieurs nouvelles méthodes à l’interface IContactManagerRepository tout en écrivant du code pour satisfaire nos tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-348">Over the course of this iteration, we added several new methods to the IContactManagerRepository interface while writing code to satisfy our unit tests.</span></span> <span data-ttu-id="24fe2-349">La version finale de l’interface IContactManagerRepository est contenue dans la liste 14.</span><span class="sxs-lookup"><span data-stu-id="24fe2-349">The final version of the IContactManagerRepository interface is contained in Listing 14.</span></span>

<span data-ttu-id="24fe2-350">**Liste 14 - Models-IContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-350">**Listing 14 - Models\IContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample14.cs)]

<span data-ttu-id="24fe2-351">Nous n’avons mis en œuvre aucune des méthodes liées au travail avec les groupes de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-351">We haven't actually implemented any of the methods related to working with contact groups.</span></span> <span data-ttu-id="24fe2-352">Actuellement, la classe EntityContactManagerRepository a des méthodes de talons pour chacune des méthodes de groupe de contact répertoriées dans l’interface IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="24fe2-352">Currently, the EntityContactManagerRepository class has stub methods for each of the contact group methods listed in the IContactManagerRepository interface.</span></span> <span data-ttu-id="24fe2-353">Par exemple, la méthode ListGroups() ressemble actuellement à ceci :</span><span class="sxs-lookup"><span data-stu-id="24fe2-353">For example, the ListGroups() method currently looks like this:</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample15.cs)]

<span data-ttu-id="24fe2-354">Les méthodes de talon nous ont permis de compiler notre application et de passer les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-354">The stub methods enabled us to compile our application and pass the unit tests.</span></span> <span data-ttu-id="24fe2-355">Cependant, il est maintenant temps de mettre en œuvre ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="24fe2-355">However, now it is time to actually implement these methods.</span></span> <span data-ttu-id="24fe2-356">La version finale de la classe EntityContactManagerRepository est contenue dans la liste 13.</span><span class="sxs-lookup"><span data-stu-id="24fe2-356">The final version of the EntityContactManagerRepository class is contained in Listing 13.</span></span>

<span data-ttu-id="24fe2-357">**Liste 13 - Models-EntityContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="24fe2-357">**Listing 13 - Models\EntityContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample16.cs)]

### <a name="creating-the-views"></a><span data-ttu-id="24fe2-358">Création des vues</span><span class="sxs-lookup"><span data-stu-id="24fe2-358">Creating the Views</span></span>

<span data-ttu-id="24fe2-359">ASP.NET’application MVC lorsque vous utilisez le moteur de vue par défaut ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="24fe2-359">ASP.NET MVC application when you use the default ASP.NET view engine.</span></span> <span data-ttu-id="24fe2-360">Ainsi, vous ne créez pas de vues en réponse à un test unitaire particulier.</span><span class="sxs-lookup"><span data-stu-id="24fe2-360">So, you don t create views in response to a particular unit test.</span></span> <span data-ttu-id="24fe2-361">Cependant, parce qu’une application serait inutile sans vues, nous ne pouvons pas compléter cette itération sans créer et modifier les vues contenues dans l’application Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="24fe2-361">However, because an application would be useless without views, we can t complete this iteration without creating and modifying the views contained in the Contact Manager application.</span></span>

<span data-ttu-id="24fe2-362">Nous devons créer les nouveaux points de vue suivants pour la gestion des groupes de contact (voir la figure 7) :</span><span class="sxs-lookup"><span data-stu-id="24fe2-362">We need to create the following new views for managing contact groups (see Figure 7):</span></span>

- <span data-ttu-id="24fe2-363">Views-Group.Index.aspx - Affiche la liste des groupes de contact</span><span class="sxs-lookup"><span data-stu-id="24fe2-363">Views\Group\Index.aspx - Displays list of contact groups</span></span>
- <span data-ttu-id="24fe2-364">Vues-Groupe-Supprimer.aspx - Affiche le formulaire de confirmation pour la suppression d’un groupe de contact</span><span class="sxs-lookup"><span data-stu-id="24fe2-364">Views\Group\Delete.aspx - Displays confirmation form for deleting a contact group</span></span>

<span data-ttu-id="24fe2-365">[![La vue de l’indice du Groupe](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-365">[![The Group Index view](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span></span>

<span data-ttu-id="24fe2-366">**Figure 07**: La vue de l’indice de groupe ([Cliquez pour voir l’image grandeur nature](iteration-6-use-test-driven-development-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="24fe2-366">**Figure 07**: The Group Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image14.png))</span></span>

<span data-ttu-id="24fe2-367">Nous devons modifier les points de vue existants suivants afin qu’ils comprennent les groupes de contact :</span><span class="sxs-lookup"><span data-stu-id="24fe2-367">We need to modify the following existing views so that they include contact groups:</span></span>

- <span data-ttu-id="24fe2-368">Vues-Home-Create.aspx</span><span class="sxs-lookup"><span data-stu-id="24fe2-368">Views\Home\Create.aspx</span></span>
- <span data-ttu-id="24fe2-369">Vues-Accueil-Edit.aspx</span><span class="sxs-lookup"><span data-stu-id="24fe2-369">Views\Home\Edit.aspx</span></span>
- <span data-ttu-id="24fe2-370">Vues-Home-Index.aspx</span><span class="sxs-lookup"><span data-stu-id="24fe2-370">Views\Home\Index.aspx</span></span>

<span data-ttu-id="24fe2-371">Vous pouvez voir les vues modifiées en regardant l’application Visual Studio qui accompagne ce tutoriel.</span><span class="sxs-lookup"><span data-stu-id="24fe2-371">You can see the modified views by looking at the Visual Studio application that accompanies this tutorial.</span></span> <span data-ttu-id="24fe2-372">Par exemple, la figure 8 illustre la vue de l’indice de contact.</span><span class="sxs-lookup"><span data-stu-id="24fe2-372">For example, Figure 8 illustrates the Contact Index view.</span></span>

<span data-ttu-id="24fe2-373">[![La vue de l’indice de contact](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="24fe2-373">[![The Contact Index view](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span></span>

<span data-ttu-id="24fe2-374">**Figure 08**: La vue de l’indice de contact ([Cliquez pour voir l’image grandeur nature](iteration-6-use-test-driven-development-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="24fe2-374">**Figure 08**: The Contact Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image16.png))</span></span>

## <a name="summary"></a><span data-ttu-id="24fe2-375">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="24fe2-375">Summary</span></span>

<span data-ttu-id="24fe2-376">Dans cette itération, nous avons ajouté de nouvelles fonctionnalités à notre application Contact Manager en suivant une méthodologie de conception d’applications de développement axée sur les tests.</span><span class="sxs-lookup"><span data-stu-id="24fe2-376">In this iteration, we added new functionality to our Contact Manager application by following a test-driven development application design methodology.</span></span> <span data-ttu-id="24fe2-377">Nous avons commencé par créer un ensemble d’histoires d’utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="24fe2-377">We started by creating a set of user stories.</span></span> <span data-ttu-id="24fe2-378">Nous avons créé un ensemble de tests unitaires qui correspondent aux exigences exprimées par les histoires d’utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="24fe2-378">We created a set of unit tests that corresponds to the requirements expressed by the user stories.</span></span> <span data-ttu-id="24fe2-379">Enfin, nous avons écrit juste assez de code pour satisfaire aux exigences exprimées par les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="24fe2-379">Finally, we wrote just enough code to satisfy the requirements expressed by the unit tests.</span></span>

<span data-ttu-id="24fe2-380">Après avoir terminé l’écriture de suffisamment de code pour satisfaire aux exigences exprimées par les tests unitaires, nous avons mis à jour notre base de données et nos vues.</span><span class="sxs-lookup"><span data-stu-id="24fe2-380">After we finished writing enough code to satisfy the requirements expressed by the unit tests, we updated our database and views.</span></span> <span data-ttu-id="24fe2-381">Nous avons ajouté un nouveau tableau des groupes à notre base de données et mis à jour notre modèle de données cadre d’entités.</span><span class="sxs-lookup"><span data-stu-id="24fe2-381">We added a new Groups table to our database and updated our Entity Framework Data Model.</span></span> <span data-ttu-id="24fe2-382">Nous avons également créé et modifié un ensemble de vues.</span><span class="sxs-lookup"><span data-stu-id="24fe2-382">We also created and modified a set of views.</span></span>

<span data-ttu-id="24fe2-383">Dans la prochaine itération - l’itération finale - nous réécrivons notre application pour profiter de l’Ajax.</span><span class="sxs-lookup"><span data-stu-id="24fe2-383">In the next iteration -- the final iteration -- we rewrite our application to take advantage of Ajax.</span></span> <span data-ttu-id="24fe2-384">En profitant de l’Ajax, nous améliorerons la réactivité et les performances de l’application Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="24fe2-384">By taking advantage of Ajax, we'll improve the responsiveness and performance of the Contact Manager application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="24fe2-385">[Suivant précédent](iteration-5-create-unit-tests-cs.md)
> [Next](iteration-7-add-ajax-functionality-cs.md)</span><span class="sxs-lookup"><span data-stu-id="24fe2-385">[Previous](iteration-5-create-unit-tests-cs.md)
[Next](iteration-7-add-ajax-functionality-cs.md)</span></span>
