---
uid: mvc/overview/older-versions-1/contact-manager/iteration-3-add-form-validation-cs
title: '#3 d’itération – ajouter la validationC#de formulaire () | Microsoft Docs'
author: microsoft
description: Dans la troisième itération, nous ajoutons la validation de base du formulaire. Nous empêchons les utilisateurs de soumettre un formulaire sans remplir les champs de formulaire requis. Nous validons également emai...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 51a0d175-913b-43d8-95e3-840fb96ad1a9
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-3-add-form-validation-cs
msc.type: authoredcontent
ms.openlocfilehash: af2e86e820f60f0a3d8e3db8f78eba67ef63579a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78544470"
---
# <a name="iteration-3--add-form-validation-c"></a><span data-ttu-id="6c226-105">#3 d’itération – ajouter une validationC#de formulaire ()</span><span class="sxs-lookup"><span data-stu-id="6c226-105">Iteration #3 – Add form validation (C#)</span></span>

<span data-ttu-id="6c226-106">par [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="6c226-106">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="6c226-107">Télécharger le code</span><span class="sxs-lookup"><span data-stu-id="6c226-107">Download Code</span></span>](iteration-3-add-form-validation-cs/_static/contactmanager_3_cs1.zip)

> <span data-ttu-id="6c226-108">Dans la troisième itération, nous ajoutons la validation de base du formulaire.</span><span class="sxs-lookup"><span data-stu-id="6c226-108">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="6c226-109">Nous empêchons les utilisateurs de soumettre un formulaire sans remplir les champs de formulaire requis.</span><span class="sxs-lookup"><span data-stu-id="6c226-109">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="6c226-110">Nous validons également les adresses de messagerie et les numéros de téléphone.</span><span class="sxs-lookup"><span data-stu-id="6c226-110">We also validate email addresses and phone numbers.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="6c226-111">Création d’une application MVC ASP.NET de gestionC#des contacts ()</span><span class="sxs-lookup"><span data-stu-id="6c226-111">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="6c226-112">Dans cette série de didacticiels, nous créons une application de gestion de contacts entière du début à la fin.</span><span class="sxs-lookup"><span data-stu-id="6c226-112">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="6c226-113">L’application Gestionnaire de contacts vous permet de stocker les informations de contact, les noms de téléphone et les adresses de messagerie, pour obtenir la liste des personnes.</span><span class="sxs-lookup"><span data-stu-id="6c226-113">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="6c226-114">Nous générons l’application sur plusieurs itérations.</span><span class="sxs-lookup"><span data-stu-id="6c226-114">We build the application over multiple iterations.</span></span> <span data-ttu-id="6c226-115">À chaque itération, nous améliorons progressivement l’application.</span><span class="sxs-lookup"><span data-stu-id="6c226-115">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="6c226-116">L’objectif de cette approche à plusieurs itérations est de vous permettre de comprendre la raison de chaque modification.</span><span class="sxs-lookup"><span data-stu-id="6c226-116">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="6c226-117">#1 d’itération : créez l’application.</span><span class="sxs-lookup"><span data-stu-id="6c226-117">Iteration #1 - Create the application.</span></span> <span data-ttu-id="6c226-118">Dans la première itération, nous créons le gestionnaire de contacts de la manière la plus simple possible.</span><span class="sxs-lookup"><span data-stu-id="6c226-118">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="6c226-119">Nous ajoutons la prise en charge des opérations de base de données de base : créer, lire, mettre à jour et supprimer (CRUD).</span><span class="sxs-lookup"><span data-stu-id="6c226-119">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="6c226-120">Itération #2 : rendez l’application agréable.</span><span class="sxs-lookup"><span data-stu-id="6c226-120">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="6c226-121">Dans cette itération, nous améliorons l’apparence de l’application en modifiant la page maître par défaut de la vue MVC ASP.NET et la feuille de style en cascade.</span><span class="sxs-lookup"><span data-stu-id="6c226-121">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="6c226-122">Itération #3 : ajouter une validation de formulaire.</span><span class="sxs-lookup"><span data-stu-id="6c226-122">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="6c226-123">Dans la troisième itération, nous ajoutons la validation de base du formulaire.</span><span class="sxs-lookup"><span data-stu-id="6c226-123">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="6c226-124">Nous empêchons les utilisateurs de soumettre un formulaire sans remplir les champs de formulaire requis.</span><span class="sxs-lookup"><span data-stu-id="6c226-124">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="6c226-125">Nous validons également les adresses de messagerie et les numéros de téléphone.</span><span class="sxs-lookup"><span data-stu-id="6c226-125">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="6c226-126">Itération #4 : rendez l’application faiblement couplée.</span><span class="sxs-lookup"><span data-stu-id="6c226-126">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="6c226-127">Dans cette quatrième itération, nous tirant parti de plusieurs modèles de conception de logiciels pour faciliter la gestion et la modification de l’application de gestionnaire de contacts.</span><span class="sxs-lookup"><span data-stu-id="6c226-127">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="6c226-128">Par exemple, nous refactorisons notre application pour utiliser le modèle de référentiel et le modèle d’injection de dépendances.</span><span class="sxs-lookup"><span data-stu-id="6c226-128">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="6c226-129">#5 d’itération-créer des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="6c226-129">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="6c226-130">Dans la cinquième itération, nous rendons notre application plus facile à gérer et à modifier en ajoutant des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="6c226-130">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="6c226-131">Nous imitons nos classes de modèle de données et créons des tests unitaires pour nos contrôleurs et la logique de validation.</span><span class="sxs-lookup"><span data-stu-id="6c226-131">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="6c226-132">Itération #6-Utilisez le développement piloté par les tests.</span><span class="sxs-lookup"><span data-stu-id="6c226-132">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="6c226-133">Dans cette sixième itération, nous ajoutons de nouvelles fonctionnalités à notre application en écrivant d’abord des tests unitaires et en écrivant du code sur les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="6c226-133">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="6c226-134">Dans cette itération, nous ajoutons des groupes de contacts.</span><span class="sxs-lookup"><span data-stu-id="6c226-134">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="6c226-135">#7 d’itération-ajoutez des fonctionnalités AJAX.</span><span class="sxs-lookup"><span data-stu-id="6c226-135">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="6c226-136">Dans la septième itération, nous améliorons la réactivité et les performances de notre application en ajoutant la prise en charge d’Ajax.</span><span class="sxs-lookup"><span data-stu-id="6c226-136">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="6c226-137">Cette itération</span><span class="sxs-lookup"><span data-stu-id="6c226-137">This Iteration</span></span>

<span data-ttu-id="6c226-138">Dans cette deuxième itération de l’application du gestionnaire de contacts, nous ajoutons la validation de base du formulaire.</span><span class="sxs-lookup"><span data-stu-id="6c226-138">In this second iteration of the Contact Manager application, we add basic form validation.</span></span> <span data-ttu-id="6c226-139">Nous empêchons les utilisateurs d’envoyer un contact sans entrer de valeurs pour les champs de formulaire requis.</span><span class="sxs-lookup"><span data-stu-id="6c226-139">We prevent people from submitting a contact without entering values for required form fields.</span></span> <span data-ttu-id="6c226-140">Nous validons également les numéros de téléphone et les adresses de messagerie (voir figure 1).</span><span class="sxs-lookup"><span data-stu-id="6c226-140">We also validate phone numbers and email addresses (see Figure 1).</span></span>

<span data-ttu-id="6c226-141">[![la boîte de dialogue Nouveau projet](iteration-3-add-form-validation-cs/_static/image1.jpg)](iteration-3-add-form-validation-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6c226-141">[![The New Project dialog box](iteration-3-add-form-validation-cs/_static/image1.jpg)](iteration-3-add-form-validation-cs/_static/image1.png)</span></span>

<span data-ttu-id="6c226-142">**Figure 01**: formulaire avec validation ([cliquez pour afficher l’image en taille réelle](iteration-3-add-form-validation-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="6c226-142">**Figure 01**: A form with validation ([Click to view full-size image](iteration-3-add-form-validation-cs/_static/image2.png))</span></span>

<span data-ttu-id="6c226-143">Dans cette itération, nous ajoutons la logique de validation directement aux actions du contrôleur.</span><span class="sxs-lookup"><span data-stu-id="6c226-143">In this iteration, we add the validation logic directly to the controller actions.</span></span> <span data-ttu-id="6c226-144">En général, il ne s’agit pas de la méthode recommandée pour ajouter la validation à une application MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6c226-144">In general, this is not the recommended way to add validation to an ASP.NET MVC application.</span></span> <span data-ttu-id="6c226-145">Une meilleure approche consiste à placer une logique de validation d’application dans une [couche de service](http://martinfowler.com/eaaCatalog/serviceLayer.html)distincte.</span><span class="sxs-lookup"><span data-stu-id="6c226-145">A better approach is to place an application s validation logic in a separate [service layer](http://martinfowler.com/eaaCatalog/serviceLayer.html).</span></span> <span data-ttu-id="6c226-146">Dans l’itération suivante, nous refactorisons l’application du gestionnaire de contacts pour rendre l’application plus facile à gérer.</span><span class="sxs-lookup"><span data-stu-id="6c226-146">In the next iteration, we refactor the Contact Manager application to make the application more maintainable.</span></span>

<span data-ttu-id="6c226-147">Dans cette itération, pour simplifier les choses, nous écrivons tout le code de validation à la main.</span><span class="sxs-lookup"><span data-stu-id="6c226-147">In this iteration, to keep things simple, we write all of the validation code by hand.</span></span> <span data-ttu-id="6c226-148">Au lieu d’écrire le code de validation, nous pouvons tirer parti d’un Framework de validation.</span><span class="sxs-lookup"><span data-stu-id="6c226-148">Instead of writing the validation code ourselves, we could take advantage of a validation framework.</span></span> <span data-ttu-id="6c226-149">Par exemple, vous pouvez utiliser le bloc d’application de validation Microsoft Enterprise Library (Library) pour implémenter la logique de validation de votre application ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="6c226-149">For example, you can use the Microsoft Enterprise Library Validation Application Block (VAB) to implement the validation logic for your ASP.NET MVC application.</span></span> <span data-ttu-id="6c226-150">Pour en savoir plus sur le bloc d’application de validation, consultez :</span><span class="sxs-lookup"><span data-stu-id="6c226-150">To learn more about the Validation Application Block, see:</span></span>

[*http://msdn.microsoft.com/library/dd203099.aspx*](https://msdn.microsoft.com/library/dd203099.aspx)

## <a name="adding-validation-to-the-create-view"></a><span data-ttu-id="6c226-151">Ajout d’une validation à la vue Create</span><span class="sxs-lookup"><span data-stu-id="6c226-151">Adding Validation to the Create View</span></span>

<span data-ttu-id="6c226-152">Commençons par ajouter une logique de validation à la vue Create.</span><span class="sxs-lookup"><span data-stu-id="6c226-152">Let s start by adding validation logic to the Create view.</span></span> <span data-ttu-id="6c226-153">Heureusement, étant donné que nous avons généré la vue Create avec Visual Studio, la vue Create contient déjà la logique d’interface utilisateur nécessaire pour afficher les messages de validation.</span><span class="sxs-lookup"><span data-stu-id="6c226-153">Fortunately, because we generated the Create view with Visual Studio, the Create view already contains all of the necessary user interface logic to display validation messages.</span></span> <span data-ttu-id="6c226-154">La vue Create est contenue dans la liste 1.</span><span class="sxs-lookup"><span data-stu-id="6c226-154">The Create view is contained in Listing 1.</span></span>

<span data-ttu-id="6c226-155">**Liste 1-\Views\Contact\Create.aspx**</span><span class="sxs-lookup"><span data-stu-id="6c226-155">**Listing 1 - \Views\Contact\Create.aspx**</span></span>

[!code-aspx[Main](iteration-3-add-form-validation-cs/samples/sample1.aspx)]

<span data-ttu-id="6c226-156">Notez l’appel à la méthode d’assistance HTML. ValidationSummary () qui s’affiche immédiatement au-dessus du formulaire HTML.</span><span class="sxs-lookup"><span data-stu-id="6c226-156">Notice the call to the Html.ValidationSummary() helper method that appears immediately above the HTML form.</span></span> <span data-ttu-id="6c226-157">En présence de messages d’erreur de validation, cette méthode affiche les messages de validation dans une liste à puces.</span><span class="sxs-lookup"><span data-stu-id="6c226-157">If there are validation error messages, then this method displays validation messages in a bulleted list.</span></span>

<span data-ttu-id="6c226-158">Notez, en outre, les appels à html. ValidationMessage () qui s’affichent en regard de chaque champ de formulaire.</span><span class="sxs-lookup"><span data-stu-id="6c226-158">Notice, furthermore, the calls to Html.ValidationMessage() that appear next to each form field.</span></span> <span data-ttu-id="6c226-159">L’assistance ValidationMessage () affiche un message d’erreur de validation individuel.</span><span class="sxs-lookup"><span data-stu-id="6c226-159">The ValidationMessage() helper displays an individual validation error message.</span></span> <span data-ttu-id="6c226-160">Dans le cas de listing 1, un astérisque s’affiche en cas d’erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="6c226-160">In the case of Listing 1, an asterisk is displayed when there is a validation error.</span></span>

<span data-ttu-id="6c226-161">Enfin, le programme d’assistance HTML. TextBox () restitue automatiquement une classe de feuille de style en cascade quand une erreur de validation est associée à la propriété affichée par le programme d’assistance.</span><span class="sxs-lookup"><span data-stu-id="6c226-161">Finally, the Html.TextBox() helper automatically renders a Cascading Style Sheet class when there is a validation error associated with the property displayed by the helper.</span></span> <span data-ttu-id="6c226-162">L’assistance HTML. TextBox () restitue une classe nommée **entrée-validation-erreur**.</span><span class="sxs-lookup"><span data-stu-id="6c226-162">The Html.TextBox() helper renders a class named **input-validation-error**.</span></span>

<span data-ttu-id="6c226-163">Lorsque vous créez une application MVC ASP.NET, une feuille de style nommée site. CSS est automatiquement créée dans le dossier Content.</span><span class="sxs-lookup"><span data-stu-id="6c226-163">When you create a new ASP.NET MVC application, a style sheet named Site.css is created in the Content folder automatically.</span></span> <span data-ttu-id="6c226-164">Cette feuille de style contient les définitions suivantes pour les classes CSS associées à l’apparence des messages d’erreur de validation :</span><span class="sxs-lookup"><span data-stu-id="6c226-164">This style sheet contains the following definitions for CSS classes related to the appearance of validation error messages:</span></span>

[!code-css[Main](iteration-3-add-form-validation-cs/samples/sample2.css)]

<span data-ttu-id="6c226-165">La classe Field-validation-Error est utilisée pour appliquer un style à la sortie rendue par l’assistance HTML. ValidationMessage ().</span><span class="sxs-lookup"><span data-stu-id="6c226-165">The field-validation-error class is used to style the output rendered by the Html.ValidationMessage() helper.</span></span> <span data-ttu-id="6c226-166">La classe d’erreur de validation d’entrée est utilisée pour appliquer un style à la zone de texte (entrée) rendue par l’assistance HTML. TextBox ().</span><span class="sxs-lookup"><span data-stu-id="6c226-166">The input-validation-error class is used to style the textbox (input) rendered by the Html.TextBox() helper.</span></span> <span data-ttu-id="6c226-167">La classe validation-Summary-Errors est utilisée pour appliquer un style à la liste non triée rendue par l’assistance HTML. ValidationSummary ().</span><span class="sxs-lookup"><span data-stu-id="6c226-167">The validation-summary-errors class is used to style the unordered list rendered by the Html.ValidationSummary() helper.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6c226-168">Vous pouvez modifier les classes de feuille de style décrites dans cette section pour personnaliser l’apparence des messages d’erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="6c226-168">You can modify the style sheet classes described in this section to customize the appearance of validation error messages.</span></span>

## <a name="adding-validation-logic-to-the-create-action"></a><span data-ttu-id="6c226-169">Ajout d’une logique de validation à l’action de création</span><span class="sxs-lookup"><span data-stu-id="6c226-169">Adding Validation Logic to the Create Action</span></span>

<span data-ttu-id="6c226-170">Pour le moment, la vue Create View n’affiche jamais de messages d’erreur de validation, car nous n’avons pas écrit la logique pour générer des messages.</span><span class="sxs-lookup"><span data-stu-id="6c226-170">Right now, the Create view never displays validation error messages because we have not written the logic to generate any messages.</span></span> <span data-ttu-id="6c226-171">Pour afficher les messages d’erreur de validation, vous devez ajouter les messages d’erreur à ModelState.</span><span class="sxs-lookup"><span data-stu-id="6c226-171">In order to display validation error messages, you need to add the error messages to ModelState.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6c226-172">La méthode UpdateModel () ajoute automatiquement des messages d’erreur à ModelState en cas d’erreur lors de l’assignation de la valeur d’un champ de formulaire à une propriété.</span><span class="sxs-lookup"><span data-stu-id="6c226-172">The UpdateModel() method adds error messages to ModelState automatically when there is an error assigning the value of a form field to a property.</span></span> <span data-ttu-id="6c226-173">Par exemple, si vous tentez d’assigner la chaîne « Apple » à une propriété BirthDate qui accepte les valeurs DateTime, la méthode UpdateModel () ajoute une erreur à ModelState.</span><span class="sxs-lookup"><span data-stu-id="6c226-173">For example, if you attempt to assign the string "apple" to a BirthDate property that accepts DateTime values, then the UpdateModel() method adds an error to ModelState.</span></span>

<span data-ttu-id="6c226-174">La méthode Create () modifiée dans Listing 2 contient une nouvelle section qui valide les propriétés de la classe contact avant que le nouveau contact soit inséré dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="6c226-174">The modified Create() method in Listing 2 contains a new section that validates the properties of the Contact class before the new contact is inserted into the database.</span></span>

<span data-ttu-id="6c226-175">**Liste 2-Controllers\ContactController.cs (création avec validation)**</span><span class="sxs-lookup"><span data-stu-id="6c226-175">**Listing 2 - Controllers\ContactController.cs (Create with validation)**</span></span>

[!code-csharp[Main](iteration-3-add-form-validation-cs/samples/sample3.cs)]

<span data-ttu-id="6c226-176">La section Validate applique quatre règles de validation distinctes :</span><span class="sxs-lookup"><span data-stu-id="6c226-176">The validate section enforces four distinct validation rules:</span></span>

- <span data-ttu-id="6c226-177">La propriété FirstName doit avoir une longueur supérieure à zéro (et ne peut pas se composer uniquement d’espaces)</span><span class="sxs-lookup"><span data-stu-id="6c226-177">The FirstName property must have a length greater than zero (and it cannot consist solely of spaces)</span></span>
- <span data-ttu-id="6c226-178">La propriété LastName doit avoir une longueur supérieure à zéro (et ne peut pas se composer uniquement d’espaces)</span><span class="sxs-lookup"><span data-stu-id="6c226-178">The LastName property must have a length greater than zero (and it cannot consist solely of spaces)</span></span>
- <span data-ttu-id="6c226-179">Si la propriété Phone a une valeur (a une longueur supérieure à 0), la propriété Phone doit correspondre à une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="6c226-179">If the Phone property has a value (has a length greater than 0) then the Phone property must match a regular expression.</span></span>
- <span data-ttu-id="6c226-180">Si la propriété E-mail a une valeur (a une longueur supérieure à 0), la propriété email doit correspondre à une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="6c226-180">If the Email property has a value (has a length greater than 0) then the Email property must match a regular expression.</span></span>

<span data-ttu-id="6c226-181">En cas de violation de règle de validation, un message d’erreur est ajouté à ModelState à l’aide de la méthode AddModelError ().</span><span class="sxs-lookup"><span data-stu-id="6c226-181">When there is a validation rule violation, an error message is added to ModelState with the help of the AddModelError() method.</span></span> <span data-ttu-id="6c226-182">Lorsque vous ajoutez un message à ModelState, vous fournissez le nom d’une propriété et le texte d’un message d’erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="6c226-182">When you add a message to ModelState, you provide the name of a property and the text of a validation error message.</span></span> <span data-ttu-id="6c226-183">Ce message d’erreur s’affiche dans la vue par les méthodes d’assistance HTML. ValidationSummary () et html. ValidationMessage ().</span><span class="sxs-lookup"><span data-stu-id="6c226-183">This error message is displayed in the view by the Html.ValidationSummary() and Html.ValidationMessage() helper methods.</span></span>

<span data-ttu-id="6c226-184">Une fois les règles de validation exécutées, la propriété IsValid de ModelState est vérifiée.</span><span class="sxs-lookup"><span data-stu-id="6c226-184">After the validation rules are executed, the IsValid property of ModelState is checked.</span></span> <span data-ttu-id="6c226-185">La propriété IsValid retourne la valeur false lorsqu’un message d’erreur de validation a été ajouté à ModelState.</span><span class="sxs-lookup"><span data-stu-id="6c226-185">The IsValid property returns false when any validation error messages have been added to ModelState.</span></span> <span data-ttu-id="6c226-186">Si la validation échoue, le formulaire de création est réaffiché avec les messages d’erreur.</span><span class="sxs-lookup"><span data-stu-id="6c226-186">If validation fails, the Create form is redisplayed with the error messages.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6c226-187">J’ai obtenu les expressions régulières pour valider le numéro de téléphone et l’adresse de messagerie à partir du référentiel d’expressions régulières à [ *http://regexlib.com* ](http://regexlib.com)</span><span class="sxs-lookup"><span data-stu-id="6c226-187">I got the regular expressions for validating the phone number and email address from the regular expression repository at [*http://regexlib.com*](http://regexlib.com)</span></span>

## <a name="adding-validation-logic-to-the-edit-action"></a><span data-ttu-id="6c226-188">Ajout d’une logique de validation à l’action Edit</span><span class="sxs-lookup"><span data-stu-id="6c226-188">Adding Validation Logic to the Edit Action</span></span>

<span data-ttu-id="6c226-189">L’action Edit () met à jour un contact.</span><span class="sxs-lookup"><span data-stu-id="6c226-189">The Edit() action updates a Contact.</span></span> <span data-ttu-id="6c226-190">L’action Edit () doit effectuer exactement la même validation que l’action Create ().</span><span class="sxs-lookup"><span data-stu-id="6c226-190">The Edit() action needs to perform exactly the same validation as the Create() action.</span></span> <span data-ttu-id="6c226-191">Au lieu de dupliquer le même code de validation, nous devons Refactoriser le contrôleur de contact afin que les actions Create () et Edit () appellent la même méthode de validation.</span><span class="sxs-lookup"><span data-stu-id="6c226-191">Instead of duplicating the same validation code, we should refactor the Contact controller so that both the Create() and Edit() actions call the same validation method.</span></span>

<span data-ttu-id="6c226-192">La classe de contrôleur de contact modifiée est contenue dans la liste 3.</span><span class="sxs-lookup"><span data-stu-id="6c226-192">The modified Contact controller class is contained in Listing 3.</span></span> <span data-ttu-id="6c226-193">Cette classe a une nouvelle méthode ValidateContact () qui est appelée dans les actions Create () et Edit ().</span><span class="sxs-lookup"><span data-stu-id="6c226-193">This class has a new ValidateContact() method that is called within both the Create() and Edit() actions.</span></span>

<span data-ttu-id="6c226-194">**Liste 3-Controllers\ContactController.cs**</span><span class="sxs-lookup"><span data-stu-id="6c226-194">**Listing 3 - Controllers\ContactController.cs**</span></span>

[!code-csharp[Main](iteration-3-add-form-validation-cs/samples/sample4.cs)]

## <a name="summary"></a><span data-ttu-id="6c226-195">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="6c226-195">Summary</span></span>

<span data-ttu-id="6c226-196">Dans cette itération, nous avons ajouté la validation de base de formulaire à notre application de gestion des contacts.</span><span class="sxs-lookup"><span data-stu-id="6c226-196">In this iteration, we added basic form validation to our Contact Manager application.</span></span> <span data-ttu-id="6c226-197">Notre logique de validation empêche les utilisateurs d’envoyer un nouveau contact ou de modifier un contact existant sans fournir de valeurs pour les propriétés FirstName et LastName.</span><span class="sxs-lookup"><span data-stu-id="6c226-197">Our validation logic prevents users from submitting a new contact or editing an existing contact without supplying values for the FirstName and LastName properties.</span></span> <span data-ttu-id="6c226-198">En outre, les utilisateurs doivent fournir des numéros de téléphone et des adresses de messagerie valides.</span><span class="sxs-lookup"><span data-stu-id="6c226-198">Furthermore, users must supply valid phone numbers and email addresses.</span></span>

<span data-ttu-id="6c226-199">Dans cette itération, nous avons ajouté la logique de validation à notre application de gestionnaire de contacts de la manière la plus simple possible.</span><span class="sxs-lookup"><span data-stu-id="6c226-199">In this iteration, we added the validation logic to our Contact Manager application in the easiest way possible.</span></span> <span data-ttu-id="6c226-200">Toutefois, la combinaison de notre logique de validation dans notre logique de contrôleur va créer des problèmes pour nous à long terme.</span><span class="sxs-lookup"><span data-stu-id="6c226-200">However, mixing our validation logic into our controller logic will create problems for us in the long term.</span></span> <span data-ttu-id="6c226-201">Notre application sera plus difficile à gérer et à modifier au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="6c226-201">Our application will be more difficult to maintain and modify over time.</span></span>

<span data-ttu-id="6c226-202">Dans l’itération suivante, nous refactorisons notre logique de validation et la logique d’accès à la base de données à partir de nos contrôleurs.</span><span class="sxs-lookup"><span data-stu-id="6c226-202">In the next iteration, we will refactor our validation logic and database access logic out of our controllers.</span></span> <span data-ttu-id="6c226-203">Nous allons tirer parti de plusieurs principes de conception de logiciels pour nous permettre de créer une application plus faiblement couplée et plus facile à gérer.</span><span class="sxs-lookup"><span data-stu-id="6c226-203">We'll take advantage of several software design principles to enable us to create a more loosely coupled, and more maintainable, application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6c226-204">[Précédent](iteration-2-make-the-application-look-nice-cs.md)
> [Suivant](iteration-4-make-the-application-loosely-coupled-cs.md)</span><span class="sxs-lookup"><span data-stu-id="6c226-204">[Previous](iteration-2-make-the-application-look-nice-cs.md)
[Next](iteration-4-make-the-application-loosely-coupled-cs.md)</span></span>
