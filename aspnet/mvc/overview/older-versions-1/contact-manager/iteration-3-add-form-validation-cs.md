---
uid: mvc/overview/older-versions-1/contact-manager/iteration-3-add-form-validation-cs
title: 'Itération #3 - Validation de formulaire d’ajout (C) Microsoft Docs'
author: rick-anderson
description: Dans la troisième itération, nous ajoutons la validation de forme de base. Nous empêchons les gens de soumettre un formulaire sans remplir les champs de formulaire requis. Nous validons également emai...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 51a0d175-913b-43d8-95e3-840fb96ad1a9
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-3-add-form-validation-cs
msc.type: authoredcontent
ms.openlocfilehash: c8442574d4901045f044f53ea12cd8330e8eaaa3
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542376"
---
# <a name="iteration-3--add-form-validation-c"></a><span data-ttu-id="02d12-105">Itération #3 : Ajouter une validation de formulaire (C#)</span><span class="sxs-lookup"><span data-stu-id="02d12-105">Iteration #3 – Add form validation (C#)</span></span>

<span data-ttu-id="02d12-106">par [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="02d12-106">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="02d12-107">Code de téléchargement</span><span class="sxs-lookup"><span data-stu-id="02d12-107">Download Code</span></span>](iteration-3-add-form-validation-cs/_static/contactmanager_3_cs1.zip)

> <span data-ttu-id="02d12-108">Dans la troisième itération, nous ajoutons la validation de forme de base.</span><span class="sxs-lookup"><span data-stu-id="02d12-108">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="02d12-109">Nous empêchons les gens de soumettre un formulaire sans remplir les champs de formulaire requis.</span><span class="sxs-lookup"><span data-stu-id="02d12-109">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="02d12-110">Nous validons également les adresses e-mail et les numéros de téléphone.</span><span class="sxs-lookup"><span data-stu-id="02d12-110">We also validate email addresses and phone numbers.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="02d12-111">Construire une application de gestion des contacts ASP.NET MVC (CMD)</span><span class="sxs-lookup"><span data-stu-id="02d12-111">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="02d12-112">Dans cette série de tutoriels, nous construisons toute une application de gestion de contact du début à la fin.</span><span class="sxs-lookup"><span data-stu-id="02d12-112">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="02d12-113">L’application Contact Manager vous permet de stocker les coordonnées - noms, numéros de téléphone et adresses e-mail - pour une liste de personnes.</span><span class="sxs-lookup"><span data-stu-id="02d12-113">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="02d12-114">Nous construisons l’application sur plusieurs itérations.</span><span class="sxs-lookup"><span data-stu-id="02d12-114">We build the application over multiple iterations.</span></span> <span data-ttu-id="02d12-115">À chaque itération, nous améliorons progressivement l’application.</span><span class="sxs-lookup"><span data-stu-id="02d12-115">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="02d12-116">Le but de cette approche d’itération multiple est de vous permettre de comprendre la raison de chaque changement.</span><span class="sxs-lookup"><span data-stu-id="02d12-116">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="02d12-117">Itération #1 - Créer l’application.</span><span class="sxs-lookup"><span data-stu-id="02d12-117">Iteration #1 - Create the application.</span></span> <span data-ttu-id="02d12-118">Dans la première itération, nous créons le Gestionnaire de Contact de la manière la plus simple possible.</span><span class="sxs-lookup"><span data-stu-id="02d12-118">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="02d12-119">Nous ajoutons un support pour les opérations de base de base de base : Créer, lire, mettre à jour et supprimer (CRUD).</span><span class="sxs-lookup"><span data-stu-id="02d12-119">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="02d12-120">Itération #2 - Rendre l’application belle.</span><span class="sxs-lookup"><span data-stu-id="02d12-120">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="02d12-121">Dans cette itération, nous améliorons l’apparence de l’application en modifiant la page principale de vue par défaut ASP.NET MVC et la feuille de style en cascade.</span><span class="sxs-lookup"><span data-stu-id="02d12-121">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="02d12-122">Itération #3 - Ajouter la validation du formulaire.</span><span class="sxs-lookup"><span data-stu-id="02d12-122">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="02d12-123">Dans la troisième itération, nous ajoutons la validation de forme de base.</span><span class="sxs-lookup"><span data-stu-id="02d12-123">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="02d12-124">Nous empêchons les gens de soumettre un formulaire sans remplir les champs de formulaire requis.</span><span class="sxs-lookup"><span data-stu-id="02d12-124">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="02d12-125">Nous validons également les adresses e-mail et les numéros de téléphone.</span><span class="sxs-lookup"><span data-stu-id="02d12-125">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="02d12-126">Itération #4 - Rendre l’application lâchement couplée.</span><span class="sxs-lookup"><span data-stu-id="02d12-126">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="02d12-127">Dans cette quatrième itération, nous profitons de plusieurs modèles de conception logicielle pour faciliter le maintien et la modification de l’application Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="02d12-127">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="02d12-128">Par exemple, nous refactorrons notre application pour utiliser le modèle de dépôt et le modèle d’injection de dépendance.</span><span class="sxs-lookup"><span data-stu-id="02d12-128">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="02d12-129">Itération #5 - Créer des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="02d12-129">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="02d12-130">Dans la cinquième itération, nous rendons notre application plus facile à maintenir et à modifier en ajoutant des tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="02d12-130">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="02d12-131">Nous nous moquons de nos classes de modèles de données et construisons des tests unitaires pour nos contrôleurs et la logique de validation.</span><span class="sxs-lookup"><span data-stu-id="02d12-131">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="02d12-132">Itération #6 - Utilisez le développement axé sur les tests.</span><span class="sxs-lookup"><span data-stu-id="02d12-132">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="02d12-133">Dans cette sixième itération, nous ajoutons de nouvelles fonctionnalités à notre application en écrivant d’abord des tests unitaires et en écrivant du code contre les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="02d12-133">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="02d12-134">Dans cette itération, nous ajoutons des groupes de contact.</span><span class="sxs-lookup"><span data-stu-id="02d12-134">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="02d12-135">Itération #7 - Ajouter la fonctionnalité Ajax.</span><span class="sxs-lookup"><span data-stu-id="02d12-135">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="02d12-136">Dans la septième itération, nous améliorons la réactivité et la performance de notre application en ajoutant un soutien pour Ajax.</span><span class="sxs-lookup"><span data-stu-id="02d12-136">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="02d12-137">Cette Itération</span><span class="sxs-lookup"><span data-stu-id="02d12-137">This Iteration</span></span>

<span data-ttu-id="02d12-138">Dans cette deuxième itération de l’application Contact Manager, nous ajoutons la validation de formulaire de base.</span><span class="sxs-lookup"><span data-stu-id="02d12-138">In this second iteration of the Contact Manager application, we add basic form validation.</span></span> <span data-ttu-id="02d12-139">Nous empêchons les gens de soumettre un contact sans entrer des valeurs pour les champs de forme requis.</span><span class="sxs-lookup"><span data-stu-id="02d12-139">We prevent people from submitting a contact without entering values for required form fields.</span></span> <span data-ttu-id="02d12-140">Nous validons également les numéros de téléphone et les adresses électroniques (voir la figure 1).</span><span class="sxs-lookup"><span data-stu-id="02d12-140">We also validate phone numbers and email addresses (see Figure 1).</span></span>

<span data-ttu-id="02d12-141">[![Boîte de dialogue New Project](iteration-3-add-form-validation-cs/_static/image1.jpg)](iteration-3-add-form-validation-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="02d12-141">[![The New Project dialog box](iteration-3-add-form-validation-cs/_static/image1.jpg)](iteration-3-add-form-validation-cs/_static/image1.png)</span></span>

<span data-ttu-id="02d12-142">**Figure 01**: Un formulaire de validation[(Cliquez pour voir l’image grandeur nature](iteration-3-add-form-validation-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="02d12-142">**Figure 01**: A form with validation ([Click to view full-size image](iteration-3-add-form-validation-cs/_static/image2.png))</span></span>

<span data-ttu-id="02d12-143">Dans cette itération, nous ajoutons la logique de validation directement aux actions du contrôleur.</span><span class="sxs-lookup"><span data-stu-id="02d12-143">In this iteration, we add the validation logic directly to the controller actions.</span></span> <span data-ttu-id="02d12-144">En général, ce n’est pas la façon recommandée d’ajouter la validation à une application MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="02d12-144">In general, this is not the recommended way to add validation to an ASP.NET MVC application.</span></span> <span data-ttu-id="02d12-145">Une meilleure approche consiste à placer une logique de validation d une application dans une [couche de service](http://martinfowler.com/eaaCatalog/serviceLayer.html)distincte.</span><span class="sxs-lookup"><span data-stu-id="02d12-145">A better approach is to place an application s validation logic in a separate [service layer](http://martinfowler.com/eaaCatalog/serviceLayer.html).</span></span> <span data-ttu-id="02d12-146">Dans la prochaine itération, nous refactorons l’application Contact Manager pour rendre l’application plus maintenable.</span><span class="sxs-lookup"><span data-stu-id="02d12-146">In the next iteration, we refactor the Contact Manager application to make the application more maintainable.</span></span>

<span data-ttu-id="02d12-147">Dans cette itération, pour garder les choses simples, nous écrivons tout le code de validation à la main.</span><span class="sxs-lookup"><span data-stu-id="02d12-147">In this iteration, to keep things simple, we write all of the validation code by hand.</span></span> <span data-ttu-id="02d12-148">Au lieu d’écrire le code de validation nous-mêmes, nous pourrions profiter d’un cadre de validation.</span><span class="sxs-lookup"><span data-stu-id="02d12-148">Instead of writing the validation code ourselves, we could take advantage of a validation framework.</span></span> <span data-ttu-id="02d12-149">Par exemple, vous pouvez utiliser le bloc d’application de validation de bibliothèque d’entreprise Microsoft (VAB) pour implémenter la logique de validation de votre application ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="02d12-149">For example, you can use the Microsoft Enterprise Library Validation Application Block (VAB) to implement the validation logic for your ASP.NET MVC application.</span></span> <span data-ttu-id="02d12-150">Pour en savoir plus sur le bloc d’applications de validation, voir :</span><span class="sxs-lookup"><span data-stu-id="02d12-150">To learn more about the Validation Application Block, see:</span></span>

[*http://msdn.microsoft.com/library/dd203099.aspx*](https://msdn.microsoft.com/library/dd203099.aspx)

## <a name="adding-validation-to-the-create-view"></a><span data-ttu-id="02d12-151">Ajout de validation à la vue de création</span><span class="sxs-lookup"><span data-stu-id="02d12-151">Adding Validation to the Create View</span></span>

<span data-ttu-id="02d12-152">Commençons par ajouter la logique de validation à la vue Créer.</span><span class="sxs-lookup"><span data-stu-id="02d12-152">Let s start by adding validation logic to the Create view.</span></span> <span data-ttu-id="02d12-153">Heureusement, parce que nous avons généré la vue Create avec Visual Studio, la vue Create contient déjà toute la logique d’interface utilisateur nécessaire pour afficher des messages de validation.</span><span class="sxs-lookup"><span data-stu-id="02d12-153">Fortunately, because we generated the Create view with Visual Studio, the Create view already contains all of the necessary user interface logic to display validation messages.</span></span> <span data-ttu-id="02d12-154">La vue Créer est contenue dans la liste 1.</span><span class="sxs-lookup"><span data-stu-id="02d12-154">The Create view is contained in Listing 1.</span></span>

<span data-ttu-id="02d12-155">**Liste 1 - 'Views’Contact’Create.aspx**</span><span class="sxs-lookup"><span data-stu-id="02d12-155">**Listing 1 - \Views\Contact\Create.aspx**</span></span>

[!code-aspx[Main](iteration-3-add-form-validation-cs/samples/sample1.aspx)]

<span data-ttu-id="02d12-156">Notez l’appel à la méthode d’aide Html.ValidationSummary() qui apparaît immédiatement au-dessus du formulaire HTML.</span><span class="sxs-lookup"><span data-stu-id="02d12-156">Notice the call to the Html.ValidationSummary() helper method that appears immediately above the HTML form.</span></span> <span data-ttu-id="02d12-157">S’il y a des messages d’erreur de validation, cette méthode affiche les messages de validation dans une liste de balles.</span><span class="sxs-lookup"><span data-stu-id="02d12-157">If there are validation error messages, then this method displays validation messages in a bulleted list.</span></span>

<span data-ttu-id="02d12-158">Notez, en outre, les appels à Html.ValidationMessage() qui apparaissent à côté de chaque champ de formulaire.</span><span class="sxs-lookup"><span data-stu-id="02d12-158">Notice, furthermore, the calls to Html.ValidationMessage() that appear next to each form field.</span></span> <span data-ttu-id="02d12-159">L’aide ValidationMessage () affiche un message d’erreur de validation individuel.</span><span class="sxs-lookup"><span data-stu-id="02d12-159">The ValidationMessage() helper displays an individual validation error message.</span></span> <span data-ttu-id="02d12-160">Dans le cas de la liste 1, un astérisque s’affiche lorsqu’il y a une erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="02d12-160">In the case of Listing 1, an asterisk is displayed when there is a validation error.</span></span>

<span data-ttu-id="02d12-161">Enfin, l’aide Html.TextBox() rend automatiquement une classe De feuille de style en cascade lorsqu’il y a une erreur de validation associée à la propriété affichée par l’aide.</span><span class="sxs-lookup"><span data-stu-id="02d12-161">Finally, the Html.TextBox() helper automatically renders a Cascading Style Sheet class when there is a validation error associated with the property displayed by the helper.</span></span> <span data-ttu-id="02d12-162">L’aide Html.TextBox() rend une classe nommée **entrée-validation-erreur**.</span><span class="sxs-lookup"><span data-stu-id="02d12-162">The Html.TextBox() helper renders a class named **input-validation-error**.</span></span>

<span data-ttu-id="02d12-163">Lorsque vous créez une nouvelle application ASP.NET MVC, une feuille de style nommée Site.css est créée automatiquement dans le dossier Content.</span><span class="sxs-lookup"><span data-stu-id="02d12-163">When you create a new ASP.NET MVC application, a style sheet named Site.css is created in the Content folder automatically.</span></span> <span data-ttu-id="02d12-164">Cette feuille de style contient les définitions suivantes pour les classes CSS liées à l’apparition de messages d’erreur de validation :</span><span class="sxs-lookup"><span data-stu-id="02d12-164">This style sheet contains the following definitions for CSS classes related to the appearance of validation error messages:</span></span>

[!code-css[Main](iteration-3-add-form-validation-cs/samples/sample2.css)]

<span data-ttu-id="02d12-165">La classe de validation-erreur de champ est utilisée pour coiffer la sortie rendue par l’aide Html.ValidationMessage().</span><span class="sxs-lookup"><span data-stu-id="02d12-165">The field-validation-error class is used to style the output rendered by the Html.ValidationMessage() helper.</span></span> <span data-ttu-id="02d12-166">La classe d’entrée-validation-erreur est utilisée pour coiffer la boîte de texte (entrée) rendue par l’assistant Html.TextBox().</span><span class="sxs-lookup"><span data-stu-id="02d12-166">The input-validation-error class is used to style the textbox (input) rendered by the Html.TextBox() helper.</span></span> <span data-ttu-id="02d12-167">La classe validation-résumé-erreurs est utilisée pour coiffer la liste non ordonnée rendue par l’aide Html.ValidationSummary().</span><span class="sxs-lookup"><span data-stu-id="02d12-167">The validation-summary-errors class is used to style the unordered list rendered by the Html.ValidationSummary() helper.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="02d12-168">Vous pouvez modifier les classes de feuille de style décrites dans cette section pour personnaliser l’apparence des messages d’erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="02d12-168">You can modify the style sheet classes described in this section to customize the appearance of validation error messages.</span></span>

## <a name="adding-validation-logic-to-the-create-action"></a><span data-ttu-id="02d12-169">Ajout de la logique de validation à l’action de création</span><span class="sxs-lookup"><span data-stu-id="02d12-169">Adding Validation Logic to the Create Action</span></span>

<span data-ttu-id="02d12-170">À l’heure actuelle, la vue Create n’affiche jamais les messages d’erreur de validation parce que nous n’avons pas écrit la logique pour générer des messages.</span><span class="sxs-lookup"><span data-stu-id="02d12-170">Right now, the Create view never displays validation error messages because we have not written the logic to generate any messages.</span></span> <span data-ttu-id="02d12-171">Afin d’afficher des messages d’erreur de validation, vous devez ajouter les messages d’erreur à ModelState.</span><span class="sxs-lookup"><span data-stu-id="02d12-171">In order to display validation error messages, you need to add the error messages to ModelState.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="02d12-172">La méthode UpdateModel() ajoute automatiquement des messages d’erreur à ModelState lorsqu’une erreur attribue la valeur d’un champ de formulaire à une propriété.</span><span class="sxs-lookup"><span data-stu-id="02d12-172">The UpdateModel() method adds error messages to ModelState automatically when there is an error assigning the value of a form field to a property.</span></span> <span data-ttu-id="02d12-173">Par exemple, si vous essayez d’attribuer la chaîne "pomme" à une propriété BirthDate qui accepte les valeurs DateTime, alors la méthode UpdateModel() ajoute une erreur à ModelState.</span><span class="sxs-lookup"><span data-stu-id="02d12-173">For example, if you attempt to assign the string "apple" to a BirthDate property that accepts DateTime values, then the UpdateModel() method adds an error to ModelState.</span></span>

<span data-ttu-id="02d12-174">La méthode Modifiée Créer() dans la liste 2 contient une nouvelle section qui valide les propriétés de la classe De contact avant que le nouveau contact ne soit inséré dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="02d12-174">The modified Create() method in Listing 2 contains a new section that validates the properties of the Contact class before the new contact is inserted into the database.</span></span>

<span data-ttu-id="02d12-175">**Liste 2 - Controllers-ContactController.cs (Créer avec validation)**</span><span class="sxs-lookup"><span data-stu-id="02d12-175">**Listing 2 - Controllers\ContactController.cs (Create with validation)**</span></span>

[!code-csharp[Main](iteration-3-add-form-validation-cs/samples/sample3.cs)]

<span data-ttu-id="02d12-176">La section de validation applique quatre règles de validation distinctes :</span><span class="sxs-lookup"><span data-stu-id="02d12-176">The validate section enforces four distinct validation rules:</span></span>

- <span data-ttu-id="02d12-177">La propriété FirstName doit avoir une longueur supérieure à zéro (et elle ne peut pas se composer uniquement d’espaces)</span><span class="sxs-lookup"><span data-stu-id="02d12-177">The FirstName property must have a length greater than zero (and it cannot consist solely of spaces)</span></span>
- <span data-ttu-id="02d12-178">La propriété LastName doit avoir une longueur supérieure à zéro (et elle ne peut pas se composer uniquement d’espaces)</span><span class="sxs-lookup"><span data-stu-id="02d12-178">The LastName property must have a length greater than zero (and it cannot consist solely of spaces)</span></span>
- <span data-ttu-id="02d12-179">Si la propriété De téléphone a une valeur (a une longueur supérieure à 0) alors la propriété de téléphone doit correspondre à une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="02d12-179">If the Phone property has a value (has a length greater than 0) then the Phone property must match a regular expression.</span></span>
- <span data-ttu-id="02d12-180">Si la propriété Email a une valeur (a une longueur supérieure à 0), alors la propriété Email doit correspondre à une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="02d12-180">If the Email property has a value (has a length greater than 0) then the Email property must match a regular expression.</span></span>

<span data-ttu-id="02d12-181">Lorsqu’il y a violation de la règle de validation, un message d’erreur est ajouté à ModelState à l’aide de la méthode AddModelError() .</span><span class="sxs-lookup"><span data-stu-id="02d12-181">When there is a validation rule violation, an error message is added to ModelState with the help of the AddModelError() method.</span></span> <span data-ttu-id="02d12-182">Lorsque vous ajoutez un message à ModelState, vous fournissez le nom d’une propriété et le texte d’un message d’erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="02d12-182">When you add a message to ModelState, you provide the name of a property and the text of a validation error message.</span></span> <span data-ttu-id="02d12-183">Ce message d’erreur est affiché dans la vue par les méthodes d’aide Html.ValidationSummary() et Html.ValidationMessage().</span><span class="sxs-lookup"><span data-stu-id="02d12-183">This error message is displayed in the view by the Html.ValidationSummary() and Html.ValidationMessage() helper methods.</span></span>

<span data-ttu-id="02d12-184">Une fois les règles de validation exécutées, la propriété IsValid de ModelState est vérifiée.</span><span class="sxs-lookup"><span data-stu-id="02d12-184">After the validation rules are executed, the IsValid property of ModelState is checked.</span></span> <span data-ttu-id="02d12-185">La propriété IsValid revient fausse lorsque des messages d’erreur de validation ont été ajoutés à ModelState.</span><span class="sxs-lookup"><span data-stu-id="02d12-185">The IsValid property returns false when any validation error messages have been added to ModelState.</span></span> <span data-ttu-id="02d12-186">En cas d’échec de validation, le formulaire Create est redisjoué avec les messages d’erreur.</span><span class="sxs-lookup"><span data-stu-id="02d12-186">If validation fails, the Create form is redisplayed with the error messages.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="02d12-187">J’ai obtenu les expressions régulières pour valider le numéro de téléphone et l’adresse e-mail à partir du référentiel d’expression régulière à[*http://regexlib.com*](http://regexlib.com)</span><span class="sxs-lookup"><span data-stu-id="02d12-187">I got the regular expressions for validating the phone number and email address from the regular expression repository at [*http://regexlib.com*](http://regexlib.com)</span></span>

## <a name="adding-validation-logic-to-the-edit-action"></a><span data-ttu-id="02d12-188">Ajout de la logique de validation à l’action d’édition</span><span class="sxs-lookup"><span data-stu-id="02d12-188">Adding Validation Logic to the Edit Action</span></span>

<span data-ttu-id="02d12-189">L’action Edit() met à jour un contact.</span><span class="sxs-lookup"><span data-stu-id="02d12-189">The Edit() action updates a Contact.</span></span> <span data-ttu-id="02d12-190">L’action Edit() doit effectuer exactement la même validation que l’action Créer()</span><span class="sxs-lookup"><span data-stu-id="02d12-190">The Edit() action needs to perform exactly the same validation as the Create() action.</span></span> <span data-ttu-id="02d12-191">Au lieu de dupliquer le même code de validation, nous devrions refactorer le contrôleur de contact de sorte que les actions Create() et Edit() appellent la même méthode de validation.</span><span class="sxs-lookup"><span data-stu-id="02d12-191">Instead of duplicating the same validation code, we should refactor the Contact controller so that both the Create() and Edit() actions call the same validation method.</span></span>

<span data-ttu-id="02d12-192">La classe modifiée de contrôleur de contact est contenue dans la liste 3.</span><span class="sxs-lookup"><span data-stu-id="02d12-192">The modified Contact controller class is contained in Listing 3.</span></span> <span data-ttu-id="02d12-193">Cette classe a une nouvelle méthode ValidateContact() qui est appelée à la fois dans les actions Créer() et Modifier().</span><span class="sxs-lookup"><span data-stu-id="02d12-193">This class has a new ValidateContact() method that is called within both the Create() and Edit() actions.</span></span>

<span data-ttu-id="02d12-194">**Liste 3 - Controllers-ContactController.cs**</span><span class="sxs-lookup"><span data-stu-id="02d12-194">**Listing 3 - Controllers\ContactController.cs**</span></span>

[!code-csharp[Main](iteration-3-add-form-validation-cs/samples/sample4.cs)]

## <a name="summary"></a><span data-ttu-id="02d12-195">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="02d12-195">Summary</span></span>

<span data-ttu-id="02d12-196">Dans cette itération, nous avons ajouté la validation de formulaire de base à notre application Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="02d12-196">In this iteration, we added basic form validation to our Contact Manager application.</span></span> <span data-ttu-id="02d12-197">Notre logique de validation empêche les utilisateurs de soumettre un nouveau contact ou d’éditer un contact existant sans fournir de valeurs pour les propriétés FirstName et LastName.</span><span class="sxs-lookup"><span data-stu-id="02d12-197">Our validation logic prevents users from submitting a new contact or editing an existing contact without supplying values for the FirstName and LastName properties.</span></span> <span data-ttu-id="02d12-198">De plus, les utilisateurs doivent fournir des numéros de téléphone et des adresses e-mail valides.</span><span class="sxs-lookup"><span data-stu-id="02d12-198">Furthermore, users must supply valid phone numbers and email addresses.</span></span>

<span data-ttu-id="02d12-199">Dans cette itération, nous avons ajouté la logique de validation à notre application Contact Manager de la manière la plus simple possible.</span><span class="sxs-lookup"><span data-stu-id="02d12-199">In this iteration, we added the validation logic to our Contact Manager application in the easiest way possible.</span></span> <span data-ttu-id="02d12-200">Cependant, le mélange de notre logique de validation dans notre logique de contrôleur va créer des problèmes pour nous à long terme.</span><span class="sxs-lookup"><span data-stu-id="02d12-200">However, mixing our validation logic into our controller logic will create problems for us in the long term.</span></span> <span data-ttu-id="02d12-201">Notre application sera plus difficile à maintenir et à modifier au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="02d12-201">Our application will be more difficult to maintain and modify over time.</span></span>

<span data-ttu-id="02d12-202">Dans la prochaine itération, nous allons refactorer notre logique de validation et la logique d’accès à la base de données de nos contrôleurs.</span><span class="sxs-lookup"><span data-stu-id="02d12-202">In the next iteration, we will refactor our validation logic and database access logic out of our controllers.</span></span> <span data-ttu-id="02d12-203">Nous profiterons de plusieurs principes de conception de logiciels pour nous permettre de créer une application plus vaguement couplée et plus maintenable.</span><span class="sxs-lookup"><span data-stu-id="02d12-203">We'll take advantage of several software design principles to enable us to create a more loosely coupled, and more maintainable, application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="02d12-204">[Suivant précédent](iteration-2-make-the-application-look-nice-cs.md)
> [Next](iteration-4-make-the-application-loosely-coupled-cs.md)</span><span class="sxs-lookup"><span data-stu-id="02d12-204">[Previous](iteration-2-make-the-application-look-nice-cs.md)
[Next](iteration-4-make-the-application-loosely-coupled-cs.md)</span></span>
