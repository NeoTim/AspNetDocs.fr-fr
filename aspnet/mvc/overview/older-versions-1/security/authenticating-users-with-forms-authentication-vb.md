---
uid: mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-vb
title: Authentifier les utilisateurs avec l’authentification des formulaires (VB) Microsoft Docs
author: rick-anderson
description: Apprenez à utiliser l’attribut [Autoriser] pour protéger les pages particulières de votre application MVC. Vous apprenez à utiliser l’administration du site Web trop ...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 4341f5b1-6fe5-44c5-8b8a-18fa84f80177
msc.legacyurl: /mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-vb
msc.type: authoredcontent
ms.openlocfilehash: 9e3117af55db2effed20b6421c2322f1c265f1c7
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2020
ms.locfileid: "81540816"
---
# <a name="authenticating-users-with-forms-authentication-vb"></a><span data-ttu-id="18c5e-104">Authentification des utilisateurs avec l’authentification par formulaire (VB)</span><span class="sxs-lookup"><span data-stu-id="18c5e-104">Authenticating Users with Forms Authentication (VB)</span></span>

<span data-ttu-id="18c5e-105">par [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="18c5e-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="18c5e-106">Apprenez à utiliser l’attribut [Autoriser] pour protéger les pages particulières de votre application MVC.</span><span class="sxs-lookup"><span data-stu-id="18c5e-106">Learn how to use the [Authorize] attribute to password protect particular pages in your MVC application.</span></span> <span data-ttu-id="18c5e-107">Vous apprenez à utiliser l’outil d’administration de site Web pour créer et gérer les utilisateurs et les rôles.</span><span class="sxs-lookup"><span data-stu-id="18c5e-107">You learn how to use the Web Site Administration Tool to create and manage users and roles.</span></span> <span data-ttu-id="18c5e-108">Vous apprenez également à configurer l’endroit où les informations de compte utilisateur et de rôle sont stockées.</span><span class="sxs-lookup"><span data-stu-id="18c5e-108">You also learn how to configure where user account and role information is stored.</span></span>

<span data-ttu-id="18c5e-109">Le but de ce tutoriel est d’expliquer comment vous pouvez utiliser l’authentification des formulaires pour protéger les vues de votre ASP.NET applications MVC.</span><span class="sxs-lookup"><span data-stu-id="18c5e-109">The goal of this tutorial is to explain how you can use Forms authentication to password protect the views in your ASP.NET MVC applications.</span></span> <span data-ttu-id="18c5e-110">Vous apprenez à utiliser l’outil d’administration du site Web pour créer des utilisateurs et des rôles.</span><span class="sxs-lookup"><span data-stu-id="18c5e-110">You learn how to use the Web Site Administration Tool to create users and roles.</span></span> <span data-ttu-id="18c5e-111">Vous apprenez également comment empêcher les utilisateurs non autorisés d’invoquer des actions de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="18c5e-111">You also learn how to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="18c5e-112">Enfin, vous apprenez à configurer où les noms d’utilisateur et les mots de passe sont stockés.</span><span class="sxs-lookup"><span data-stu-id="18c5e-112">Finally, you learn how to configure where user names and passwords are stored.</span></span>

#### <a name="using-the-web-site-administration-tool"></a><span data-ttu-id="18c5e-113">Utilisation de l’outil d’administration du site Web</span><span class="sxs-lookup"><span data-stu-id="18c5e-113">Using the Web Site Administration Tool</span></span>

<span data-ttu-id="18c5e-114">Avant de faire autre chose, nous devrions commencer par créer des utilisateurs et des rôles.</span><span class="sxs-lookup"><span data-stu-id="18c5e-114">Before we do anything else, we should start by creating some users and roles.</span></span> <span data-ttu-id="18c5e-115">La façon la plus simple de créer de nouveaux utilisateurs et de nouveaux rôles est de profiter de l’outil d’administration du site Web Visual Studio 2008.</span><span class="sxs-lookup"><span data-stu-id="18c5e-115">The easiest way to create new users and roles is to take advantage of the Visual Studio 2008 Web Site Administration Tool.</span></span> <span data-ttu-id="18c5e-116">Vous pouvez lancer cet outil en sélectionnant l’option de menu **Project, ASP.NET Configuration**.</span><span class="sxs-lookup"><span data-stu-id="18c5e-116">You can launch this tool by selecting the menu option **Project, ASP.NET Configuration**.</span></span> <span data-ttu-id="18c5e-117">Alternativement, vous pouvez lancer l’outil d’administration du site Web en cliquant sur l’icône (un peu effrayante) du marteau frapper le monde qui apparaît en haut de la fenêtre Solution Explorer (voir la figure 1).</span><span class="sxs-lookup"><span data-stu-id="18c5e-117">Alternatively, you can launch the Web Site Administration Tool by clicking the (somewhat scary) icon of the hammer hitting the world that appears at the top of the Solution Explorer window (see Figure 1).</span></span>

<span data-ttu-id="18c5e-118">**Figure 1 - Lancement de l’outil d’administration du site Web**</span><span class="sxs-lookup"><span data-stu-id="18c5e-118">**Figure 1 – Launching the Web Site Administration Tool**</span></span>

![clip_image002[4]](authenticating-users-with-forms-authentication-vb/_static/image1.jpg)

<span data-ttu-id="18c5e-120">Dans l’outil d’administration du site Web, vous créez de nouveaux utilisateurs et de nouveaux rôles en sélectionnant l’onglet Sécurité. Cliquez sur le lien **utilisateur Créer** pour créer un nouvel utilisateur nommé Stephen (voir la figure 2).</span><span class="sxs-lookup"><span data-stu-id="18c5e-120">Within the Web Site Administration Tool, you create new users and roles by selecting the Security tab. Click the **Create user** link to create a new user named Stephen (see Figure 2).</span></span> <span data-ttu-id="18c5e-121">Fournir à l’utilisateur Stephen n’importe quel mot de passe que vous voulez (par exemple, *secret*).</span><span class="sxs-lookup"><span data-stu-id="18c5e-121">Provide the Stephen user with any password that you want (for example, *secret*).</span></span>

<span data-ttu-id="18c5e-122">**Figure 2 - Création d’un nouvel utilisateur**</span><span class="sxs-lookup"><span data-stu-id="18c5e-122">**Figure 2 – Creating a new user**</span></span>

![clip_image004[4]](authenticating-users-with-forms-authentication-vb/_static/image2.jpg)

<span data-ttu-id="18c5e-124">Vous créez de nouveaux rôles en habilitantant d’abord les rôles et en définissant un ou plusieurs rôles.</span><span class="sxs-lookup"><span data-stu-id="18c5e-124">You create new roles by first enabling roles and defining one or more roles.</span></span> <span data-ttu-id="18c5e-125">Activez les rôles en cliquant sur le lien **des rôles Enable.**</span><span class="sxs-lookup"><span data-stu-id="18c5e-125">Enable roles by clicking the **Enable roles** link.</span></span> <span data-ttu-id="18c5e-126">Ensuite, créez un rôle nommé *Administrateurs* en cliquant sur le lien **Créer ou gérer les rôles** (voir la figure 3).</span><span class="sxs-lookup"><span data-stu-id="18c5e-126">Next, create a role named *Administrators* by clicking the **Create or Manage roles** link (see Figure 3).</span></span>

<span data-ttu-id="18c5e-127">**Figure 3 - Création d’un nouveau rôle**</span><span class="sxs-lookup"><span data-stu-id="18c5e-127">**Figure 3 – Creating a new role**</span></span>

![clip_image006[4]](authenticating-users-with-forms-authentication-vb/_static/image3.jpg)

<span data-ttu-id="18c5e-129">Enfin, créez un nouvel utilisateur nommé Sally et associez Sally au rôle des administrateurs en cliquant sur le lien Créer l’utilisateur et en sélectionnant les administrateurs lors de la création de Sally (voir la figure 4).</span><span class="sxs-lookup"><span data-stu-id="18c5e-129">Finally, create a new user named Sally and associate Sally with the Administrators role by clicking the Create User link and selecting Administrators when creating Sally (see Figure 4).</span></span>

<span data-ttu-id="18c5e-130">**Figure 4 - Ajout d’un utilisateur à un rôle**</span><span class="sxs-lookup"><span data-stu-id="18c5e-130">**Figure 4 – Adding a user to a role**</span></span>

![clip_image008[4]](authenticating-users-with-forms-authentication-vb/_static/image4.jpg)

<span data-ttu-id="18c5e-132">Quand tout est dit et fait, vous devriez avoir deux nouveaux utilisateurs nommés Stephen et Sally.</span><span class="sxs-lookup"><span data-stu-id="18c5e-132">When all is said and done, you should have two new users named Stephen and Sally.</span></span> <span data-ttu-id="18c5e-133">Vous devez également avoir un nouveau rôle nommé Administrateurs.</span><span class="sxs-lookup"><span data-stu-id="18c5e-133">You should also have a new role named Administrators.</span></span> <span data-ttu-id="18c5e-134">Sally est membre du rôle des administrateurs et Stephen ne l’est pas.</span><span class="sxs-lookup"><span data-stu-id="18c5e-134">Sally is a member of the Administrators role and Stephen is not.</span></span>

#### <a name="requiring-authorization"></a><span data-ttu-id="18c5e-135">Exiger l’autorisation</span><span class="sxs-lookup"><span data-stu-id="18c5e-135">Requiring Authorization</span></span>

<span data-ttu-id="18c5e-136">Vous pouvez exiger qu’un utilisateur soit authentifié avant que l’utilisateur invoque une action de contrôleur en ajoutant l’attribut [Autoriser] à l’action.</span><span class="sxs-lookup"><span data-stu-id="18c5e-136">You can require a user to be authenticated before the user invokes a controller action by adding the [Authorize] attribute to the action.</span></span> <span data-ttu-id="18c5e-137">Vous pouvez appliquer l’attribut [Autoriser] à une action individuelle de contrôleur ou vous pouvez appliquer cet attribut à toute une classe de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="18c5e-137">You can apply the [Authorize] attribute to an individual controller action or you can apply this attribute to an entire controller class.</span></span>

<span data-ttu-id="18c5e-138">Par exemple, le contrôleur dans la liste 1 expose une action nommée CompanySecrets().</span><span class="sxs-lookup"><span data-stu-id="18c5e-138">For example, the controller in Listing 1 exposes an action named CompanySecrets().</span></span> <span data-ttu-id="18c5e-139">Parce que cette action est décorée de l’attribut [Autoriser], cette action ne peut être invoquée à moins qu’un utilisateur ne soit authentifié.</span><span class="sxs-lookup"><span data-stu-id="18c5e-139">Because this action is decorated with the [Authorize] attribute, this action cannot be invoked unless a user is authenticated.</span></span>

<span data-ttu-id="18c5e-140">**Liste 1 - Controllers-HomeController.vb**</span><span class="sxs-lookup"><span data-stu-id="18c5e-140">**Listing 1 – Controllers\HomeController.vb**</span></span>

[!code-vb[Main](authenticating-users-with-forms-authentication-vb/samples/sample1.vb)]

<span data-ttu-id="18c5e-141">Si vous invoquez l’action CompanySecrets() en entrant l’URL /Home/CompanySecrets dans la barre d’adresse de votre navigateur, et que vous n’êtes pas un utilisateur authentifié, vous serez redirigé automatiquement vers la vue Login (voir la figure 5).</span><span class="sxs-lookup"><span data-stu-id="18c5e-141">If you invoke the CompanySecrets() action by entering the URL /Home/CompanySecrets in the address bar of your browser, and you are not an authenticated user, then you will be redirected to the Login view automatically (see Figure 5).</span></span>

<span data-ttu-id="18c5e-142">**Figure 5 - La vue de connexion**</span><span class="sxs-lookup"><span data-stu-id="18c5e-142">**Figure 5 – The Login view**</span></span>

![clip_image010[4]](authenticating-users-with-forms-authentication-vb/_static/image5.jpg)

<span data-ttu-id="18c5e-144">Vous pouvez utiliser la vue Login pour entrer votre nom d’utilisateur et mot de passe.</span><span class="sxs-lookup"><span data-stu-id="18c5e-144">You can use the Login view to enter your user name and password.</span></span> <span data-ttu-id="18c5e-145">Si vous n’êtes pas un utilisateur enregistré, vous pouvez cliquer sur le lien **de registre** pour naviguer vers la vue du Registre (voir la figure 6).</span><span class="sxs-lookup"><span data-stu-id="18c5e-145">If you are not a registered user then you can click the **register** link to navigate to the Register view (see Figure 6).</span></span> <span data-ttu-id="18c5e-146">Vous pouvez utiliser la vue Du Registre pour créer un nouveau compte utilisateur.</span><span class="sxs-lookup"><span data-stu-id="18c5e-146">You can use the Register view to create a new user account.</span></span>

<span data-ttu-id="18c5e-147">**Figure 6 - Vue du registre**</span><span class="sxs-lookup"><span data-stu-id="18c5e-147">**Figure 6 – The Register view**</span></span>

![clip_image012](authenticating-users-with-forms-authentication-vb/_static/image6.jpg)

<span data-ttu-id="18c5e-149">Après avoir réussi à vous connecter, vous pouvez voir la vue CompanySecrets (voir la figure 7).</span><span class="sxs-lookup"><span data-stu-id="18c5e-149">After you successfully log in, you can see the CompanySecrets view (see Figure 7).</span></span> <span data-ttu-id="18c5e-150">Par défaut, vous continuerez à être connecté jusqu’à ce que vous fermiez la fenêtre de votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="18c5e-150">By default, you will continue to be logged in until you close your browser window.</span></span>

<span data-ttu-id="18c5e-151">**Figure 7 - Vue de la sociétéSecrets**</span><span class="sxs-lookup"><span data-stu-id="18c5e-151">**Figure 7 – The CompanySecrets view**</span></span>

![clip_image014](authenticating-users-with-forms-authentication-vb/_static/image7.jpg)

#### <a name="authorizing-by-user-name-or-user-role"></a><span data-ttu-id="18c5e-153">Autoriser par nom d’utilisateur ou rôle d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="18c5e-153">Authorizing by User Name or User Role</span></span>

<span data-ttu-id="18c5e-154">Vous pouvez utiliser l’attribut [Autoriser] pour limiter l’accès à une action de contrôleur à un ensemble particulier d’utilisateurs ou à un ensemble particulier de rôles d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="18c5e-154">You can use the [Authorize] attribute to restrict access to a controller action to a particular set of users or a particular set of user roles.</span></span> <span data-ttu-id="18c5e-155">Par exemple, le contrôleur d’accueil modifié dans la liste 2 contient deux nouvelles actions nommées StephenSecrets() et AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="18c5e-155">For example, the modified Home controller in Listing 2 contains two new actions named StephenSecrets() and AdministratorSecrets().</span></span>

<span data-ttu-id="18c5e-156">**Liste 2 - Controllers-HomeController.vb**</span><span class="sxs-lookup"><span data-stu-id="18c5e-156">**Listing 2 – Controllers\HomeController.vb**</span></span>

[!code-vb[Main](authenticating-users-with-forms-authentication-vb/samples/sample2.vb)]

<span data-ttu-id="18c5e-157">Seul un utilisateur avec le nom d’utilisateur Stephen peut invoquer l’action StephenSecrets().</span><span class="sxs-lookup"><span data-stu-id="18c5e-157">Only a user with the user name Stephen can invoke the StephenSecrets() action.</span></span> <span data-ttu-id="18c5e-158">Tous les autres utilisateurs sont redirigés vers la vue Login.</span><span class="sxs-lookup"><span data-stu-id="18c5e-158">All other users get redirected to the Login view.</span></span> <span data-ttu-id="18c5e-159">La propriété Users accepte une liste de noms de compte d’utilisateur séparée par virgule.</span><span class="sxs-lookup"><span data-stu-id="18c5e-159">The Users property accepts a comma separated list of user account names.</span></span>

<span data-ttu-id="18c5e-160">Seuls les utilisateurs dans le rôle des administrateurs peuvent invoquer l’action AdministratorSecrets() .</span><span class="sxs-lookup"><span data-stu-id="18c5e-160">Only users in the Administrators role can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="18c5e-161">Par exemple, parce que Sally est membre du groupe des administrateurs, elle peut invoquer l’action AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="18c5e-161">For example, because Sally is a member of the Administrators group, she can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="18c5e-162">Tous les autres utilisateurs sont redirigés vers la vue Login.</span><span class="sxs-lookup"><span data-stu-id="18c5e-162">All other users get redirected to the Login view.</span></span> <span data-ttu-id="18c5e-163">La propriété Roles accepte une liste de noms de rôle séparées par virgule.</span><span class="sxs-lookup"><span data-stu-id="18c5e-163">The Roles property accepts a comma separated list of role names.</span></span>

#### <a name="configuring-authentication"></a><span data-ttu-id="18c5e-164">Configurer l’authentification</span><span class="sxs-lookup"><span data-stu-id="18c5e-164">Configuring Authentication</span></span>

<span data-ttu-id="18c5e-165">À ce stade, vous vous demandez peut-être où le compte utilisateur et les informations de rôle sont stockés.</span><span class="sxs-lookup"><span data-stu-id="18c5e-165">At this point, you might be wondering where the user account and role information is being stored.</span></span> <span data-ttu-id="18c5e-166">Par défaut, les informations sont stockées dans une base de données SQL Express (RANU)\_nommée ASPNETDB.mdf située dans le dossier App Data de votre application MVC.</span><span class="sxs-lookup"><span data-stu-id="18c5e-166">By default, the information is stored in a (RANU) SQL Express database named ASPNETDB.mdf located in your MVC application's App\_Data folder.</span></span> <span data-ttu-id="18c5e-167">Cette base de données est générée par le cadre ASP.NET automatiquement lorsque vous commencez à utiliser l’adhésion.</span><span class="sxs-lookup"><span data-stu-id="18c5e-167">This database is generated by the ASP.NET framework automatically when you start using membership.</span></span>

<span data-ttu-id="18c5e-168">Pour voir la base de données ASPNETDB.mdf dans la fenêtre Solution Explorer, vous devez d’abord sélectionner l’option menu Project, Afficher tous les fichiers.</span><span class="sxs-lookup"><span data-stu-id="18c5e-168">In order to see the ASPNETDB.mdf database in the Solution Explorer window, you first need to select the menu option Project, Show All Files.</span></span>

<span data-ttu-id="18c5e-169">L’utilisation de la base de données SQL Express par défaut est très bien lors du développement d’une application.</span><span class="sxs-lookup"><span data-stu-id="18c5e-169">Using the default SQL Express database is fine when developing an application.</span></span> <span data-ttu-id="18c5e-170">Très probablement, cependant, vous ne voudrez pas utiliser la base de données ASPNETDB.mdf par défaut pour une application de production.</span><span class="sxs-lookup"><span data-stu-id="18c5e-170">Most likely, however, you won't want to use the default ASPNETDB.mdf database for a production application.</span></span> <span data-ttu-id="18c5e-171">Dans ce cas, vous pouvez modifier l’endroit où les informations du compte utilisateur sont stockées en remplissant les deux étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="18c5e-171">In that case, you can change where user account information is stored by completing the following two steps:</span></span>

1. <span data-ttu-id="18c5e-172">Ajoutez les objets de base de données de Services d’applications à votre base de données de production - Modifiez votre chaîne de connexion d’application pour indiquer votre base de données de production</span><span class="sxs-lookup"><span data-stu-id="18c5e-172">Add the Application Services database objects to your production database - Change your application connection string to point to your production database</span></span>

<span data-ttu-id="18c5e-173">La première étape consiste à ajouter tous les objets de base de données nécessaires (tableaux et procédures stockées) à votre base de données de production.</span><span class="sxs-lookup"><span data-stu-id="18c5e-173">The first step is to add all of the necessary database objects (tables and stored procedures) to your production database.</span></span> <span data-ttu-id="18c5e-174">La façon la plus simple d’ajouter ces objets à une nouvelle base de données est de profiter de la ASP.NET SQL Server Setup Wizard (voir la figure 8).</span><span class="sxs-lookup"><span data-stu-id="18c5e-174">The easiest way to add these objects to a new database is to take advantage of the ASP.NET SQL Server Setup Wizard (see Figure 8).</span></span> <span data-ttu-id="18c5e-175">Vous pouvez lancer cet outil en ouvrant le Visual Studio 2008 Command Prompt à partir du groupe de programme Microsoft Visual Studio 2008 et en exécutant la commande suivante à partir de l’invite de commande :</span><span class="sxs-lookup"><span data-stu-id="18c5e-175">You can launch this tool by opening the Visual Studio 2008 Command Prompt from the Microsoft Visual Studio 2008 program group and executing the following command from the command prompt:</span></span>

<span data-ttu-id="18c5e-176">aspnet\_regsql</span><span class="sxs-lookup"><span data-stu-id="18c5e-176">aspnet\_regsql</span></span>

<span data-ttu-id="18c5e-177">**Figure 8 - Le ASP.NET SQL Server Setup Wizard**</span><span class="sxs-lookup"><span data-stu-id="18c5e-177">**Figure 8 – The ASP.NET SQL Server Setup Wizard**</span></span>

![clip_image016](authenticating-users-with-forms-authentication-vb/_static/image8.jpg)

<span data-ttu-id="18c5e-179">Le ASP.NET SQL Server Setup Wizard vous permet de sélectionner une base de données SQL Server sur votre réseau et d’installer tous les objets de base de données requis par les services d’application ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="18c5e-179">The ASP.NET SQL Server Setup Wizard enables you to select a SQL Server database on your network and install all of the database objects required by the ASP.NET application services.</span></span> <span data-ttu-id="18c5e-180">Le serveur de base de données n’est pas tenu d’être situé sur votre machine locale.</span><span class="sxs-lookup"><span data-stu-id="18c5e-180">The database server is not required to be located on your local machine.</span></span>

> [!NOTE]
> <span data-ttu-id="18c5e-181">Si vous ne souhaitez pas utiliser le ASP.NET SQL Server Setup Wizard, vous pouvez trouver des scripts SQL pour ajouter les objets de base de données des services d’application dans le dossier suivant :</span><span class="sxs-lookup"><span data-stu-id="18c5e-181">If you don't want to use the ASP.NET SQL Server Setup Wizard, then you can find SQL scripts for adding the application services database objects in the following folder:</span></span>
> 
> 
> <span data-ttu-id="18c5e-182">C : Windows-Microsoft.NET-Framework-v2.0.50727</span><span class="sxs-lookup"><span data-stu-id="18c5e-182">C:\Windows\Microsoft.NET\Framework\v2.0.50727</span></span>

<span data-ttu-id="18c5e-183">Après avoir créé les objets de base de données nécessaires, vous devez modifier la connexion de base de données utilisée par votre application MVC.</span><span class="sxs-lookup"><span data-stu-id="18c5e-183">After you create the necessary database objects, you need to modify the database connection used by your MVC application.</span></span> <span data-ttu-id="18c5e-184">Modifiez la chaîne de connexion ApplicationServices dans votre fichier de configuration web (web.config) afin qu’il indique la base de données de production.</span><span class="sxs-lookup"><span data-stu-id="18c5e-184">Modify the ApplicationServices connection string in your web configuration (web.config) file so that it points to the production database.</span></span> <span data-ttu-id="18c5e-185">Par exemple, la connexion modifiée dans La liste 3 points à une base de données nommée MyProductionDB (la chaîne de connexion d’origine ApplicationServices a été commentée).</span><span class="sxs-lookup"><span data-stu-id="18c5e-185">For example, the modified connection in Listing 3 points to a database named MyProductionDB (the original ApplicationServices connection string has been commented out).</span></span>

<span data-ttu-id="18c5e-186">**Liste 3 - Web.config**</span><span class="sxs-lookup"><span data-stu-id="18c5e-186">**Listing 3 – Web.config**</span></span>

[!code-xml[Main](authenticating-users-with-forms-authentication-vb/samples/sample3.xml)]

#### <a name="configuring-database-permissions"></a><span data-ttu-id="18c5e-187">Configurer les autorisations de base de données</span><span class="sxs-lookup"><span data-stu-id="18c5e-187">Configuring Database Permissions</span></span>

<span data-ttu-id="18c5e-188">Si vous utilisez la sécurité intégrée pour vous connecter à votre base de données, vous devrez ajouter le compte utilisateur Windows correct en tant que connexion à votre base de données.</span><span class="sxs-lookup"><span data-stu-id="18c5e-188">If you use Integrated Security to connect to your database then you will need to add the correct Windows user account as a login to your database.</span></span> <span data-ttu-id="18c5e-189">Le compte correct dépend si vous utilisez le serveur de développement ASP.NET ou les services d’information Internet comme serveur web.</span><span class="sxs-lookup"><span data-stu-id="18c5e-189">The correct account depends on whether you are using the ASP.NET Development Server or Internet Information Services as your web server.</span></span> <span data-ttu-id="18c5e-190">Le compte utilisateur correct dépend également de votre système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="18c5e-190">The correct user account also depends on your operating system.</span></span>

<span data-ttu-id="18c5e-191">Si vous utilisez le serveur de développement ASP.NET (le serveur Web par défaut utilisé par Visual Studio), votre application s’exécute dans le contexte de votre compte utilisateur Windows.</span><span class="sxs-lookup"><span data-stu-id="18c5e-191">If you are using the ASP.NET Development Server (the default web server used by Visual Studio) then your application executes within the context of your Windows user account.</span></span> <span data-ttu-id="18c5e-192">Dans ce cas, vous devez ajouter votre compte utilisateur Windows comme identifiant serveur de base de données.</span><span class="sxs-lookup"><span data-stu-id="18c5e-192">In that case, you need to add your Windows user account as a database server login.</span></span>

<span data-ttu-id="18c5e-193">Alternativement, si vous utilisez les services d’information Internet, vous devez ajouter soit le compte ASPNET ou le compte NT AUTHORITY/NETWORK SERVICE en tant que connexion serveur de base de données.</span><span class="sxs-lookup"><span data-stu-id="18c5e-193">Alternatively, if you are using Internet Information Services then you need to add either the ASPNET account or the NT AUTHORITY/NETWORK SERVICE account as a database server login.</span></span> <span data-ttu-id="18c5e-194">Si vous utilisez Windows XP, ajoutez le compte ASPNET comme connexion à votre base de données.</span><span class="sxs-lookup"><span data-stu-id="18c5e-194">If you are using Windows XP then add the ASPNET account as a login to your database.</span></span> <span data-ttu-id="18c5e-195">Si vous utilisez un système d’exploitation plus récent, tel que Windows Vista ou Windows Server 2008, ajoutez le compte NT AUTHORITY/NETWORK SERVICE comme connexion de base de données.</span><span class="sxs-lookup"><span data-stu-id="18c5e-195">If you are using a more recent operating system, such as Windows Vista or Windows Server 2008, then add the NT AUTHORITY/NETWORK SERVICE account as the database login.</span></span>

<span data-ttu-id="18c5e-196">Vous pouvez ajouter un nouveau compte utilisateur à votre base de données en utilisant Microsoft SQL Server Management Studio (voir figure 9).</span><span class="sxs-lookup"><span data-stu-id="18c5e-196">You can add a new user account to your database by using Microsoft SQL Server Management Studio (see Figure 9).</span></span>

<span data-ttu-id="18c5e-197">**Figure 9 - Création d’une nouvelle connexion Microsoft SQL Server**</span><span class="sxs-lookup"><span data-stu-id="18c5e-197">**Figure 9 – Creating a new Microsoft SQL Server login**</span></span>

![clip_image018](authenticating-users-with-forms-authentication-vb/_static/image9.jpg)

<span data-ttu-id="18c5e-199">Après avoir créé la connexion requise, vous devez cartographier la connexion à un utilisateur de base de données avec les bons rôles de base de données.</span><span class="sxs-lookup"><span data-stu-id="18c5e-199">After you create the required login, you need to map the login to a database user with the right database roles.</span></span> <span data-ttu-id="18c5e-200">Double-cliquez sur la connexion et sélectionnez l’onglet Map d’utilisateur. Sélectionnez un ou plusieurs rôles de base de données de services d’application.</span><span class="sxs-lookup"><span data-stu-id="18c5e-200">Double-click the login and select the User Mapping tab. Select one or more application services database roles.</span></span> <span data-ttu-id="18c5e-201">Par exemple, afin d’authentifier les utilisateurs,\_\_vous devez activer le rôle de base de base d’adhésion aspnet BasicAccess.</span><span class="sxs-lookup"><span data-stu-id="18c5e-201">For example, in order to authenticate users, you need to enable the aspnet\_Membership\_BasicAccess database role.</span></span> <span data-ttu-id="18c5e-202">Afin de créer de nouveaux utilisateurs, vous\_devez\_activer le rôle de base de données Aspnet Membership FullAccess (voir la figure 10).</span><span class="sxs-lookup"><span data-stu-id="18c5e-202">In order to create new users, you need to enable the aspnet\_Membership\_FullAccess database role (see Figure 10).</span></span>

<span data-ttu-id="18c5e-203">**Figure 10 - Ajout de rôles de base de données sur les services d’applications**</span><span class="sxs-lookup"><span data-stu-id="18c5e-203">**Figure 10 – Adding Application Services database roles**</span></span>

![clip_image020](authenticating-users-with-forms-authentication-vb/_static/image10.jpg)

#### <a name="summary"></a><span data-ttu-id="18c5e-205">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="18c5e-205">Summary</span></span>

<span data-ttu-id="18c5e-206">Dans ce tutoriel, vous avez appris à utiliser l’authentification des formes lors de la construction d’une application MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="18c5e-206">In this tutorial, you learned how to use Forms authentication when building an ASP.NET MVC application.</span></span> <span data-ttu-id="18c5e-207">Tout d’abord, vous avez appris à créer de nouveaux utilisateurs et de nouveaux rôles en profitant de l’outil d’administration du site Web.</span><span class="sxs-lookup"><span data-stu-id="18c5e-207">First, you learned how to create new users and roles by taking advantage of the Web Site Administration Tool.</span></span> <span data-ttu-id="18c5e-208">Ensuite, vous avez appris à utiliser l’attribut [Autoriser] pour empêcher les utilisateurs non autorisés d’invoquer des actions de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="18c5e-208">Next, you learned how to use the [Authorize] attribute to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="18c5e-209">Enfin, vous avez appris à configurer votre application MVC pour stocker des informations utilisateur et rôle dans une base de données de production.</span><span class="sxs-lookup"><span data-stu-id="18c5e-209">Finally, you learned how to configure your MVC application to store user and role information in a production database.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="18c5e-210">[Suivant précédent](preventing-javascript-injection-attacks-cs.md)
> [Next](authenticating-users-with-windows-authentication-vb.md)</span><span class="sxs-lookup"><span data-stu-id="18c5e-210">[Previous](preventing-javascript-injection-attacks-cs.md)
[Next](authenticating-users-with-windows-authentication-vb.md)</span></span>
