---
uid: mvc/overview/older-versions-1/getting-started-with-mvc/getting-started-with-mvc-part6
title: Ajout d’une méthode de création et créer la vue | Microsoft Docs
author: shanselman
description: Il s’agit d’un didacticiel de débutant qui présente les principes de base d’ASP.NET MVC. Créer une application web simple qui lit et écrit à partir d’une base de données.
ms.author: riande
ms.date: 08/14/2010
ms.assetid: a3a90963-0286-4fa0-9b3d-c230cc18b0a3
msc.legacyurl: /mvc/overview/older-versions-1/getting-started-with-mvc/getting-started-with-mvc-part6
msc.type: authoredcontent
ms.openlocfilehash: 546c3e0a24ecd0d916c79e9ad12f62b926c760c5
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57045186"
---
<a name="adding-a-create-method-and-create-view"></a><span data-ttu-id="0b214-104">Ajout d’une méthode de création et d’une vue de création</span><span class="sxs-lookup"><span data-stu-id="0b214-104">Adding a Create Method and Create View</span></span>
====================
<span data-ttu-id="0b214-105">par [Scott Hanselman](https://github.com/shanselman)</span><span class="sxs-lookup"><span data-stu-id="0b214-105">by [Scott Hanselman](https://github.com/shanselman)</span></span>

> <span data-ttu-id="0b214-106">Il s’agit d’un didacticiel de débutant qui présente les principes de base d’ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="0b214-106">This is a beginner tutorial that introduces the basics of ASP.NET MVC.</span></span> <span data-ttu-id="0b214-107">Vous allez créer une application web simple qui lit et écrit à partir d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="0b214-107">You'll create a simple web application that reads and writes from a database.</span></span> <span data-ttu-id="0b214-108">Visitez le [centre d’apprentissage ASP.NET MVC](../../../index.md) pour rechercher d’autres ASP.NET MVC didacticiels et exemples.</span><span class="sxs-lookup"><span data-stu-id="0b214-108">Visit the [ASP.NET MVC learning center](../../../index.md) to find other ASP.NET MVC tutorials and samples.</span></span>


<span data-ttu-id="0b214-109">Dans cette section, nous allons implémenter la prise en charge nécessaire pour permettre aux utilisateurs de créer de nouveaux films dans notre base de données.</span><span class="sxs-lookup"><span data-stu-id="0b214-109">In this section we are going to implement the support necessary to enable users to create new movies in our database.</span></span> <span data-ttu-id="0b214-110">Pour cela, nous allons implémenter l’action de l’URL de films/Create.</span><span class="sxs-lookup"><span data-stu-id="0b214-110">We'll do this by implementing the /Movies/Create URL action.</span></span>

<span data-ttu-id="0b214-111">Implémentation de l’URL de films/Créer est un processus en deux étapes.</span><span class="sxs-lookup"><span data-stu-id="0b214-111">Implementing the /Movies/Create URL is a two step process.</span></span> <span data-ttu-id="0b214-112">Lorsqu’un utilisateur visite tout d’abord l’URL de films/Créer nous voulons leur montrer un formulaire HTML qui peut remplir à entrer un nouveau film.</span><span class="sxs-lookup"><span data-stu-id="0b214-112">When a user first visits the /Movies/Create URL we want to show them an HTML form that they can fill out to enter a new movie.</span></span> <span data-ttu-id="0b214-113">Ensuite, lorsque l’utilisateur soumet le formulaire et les publications, les données dans le serveur, nous voulons récupérer le contenu publié et enregistrez-le dans notre base de données.</span><span class="sxs-lookup"><span data-stu-id="0b214-113">Then, when the user submits the form and posts the data back to the server, we want to retrieve the posted contents and save it into our database.</span></span>

<span data-ttu-id="0b214-114">Nous allons implémenter ces deux étapes dans les deux méthodes Create() au sein de notre classe MoviesController.</span><span class="sxs-lookup"><span data-stu-id="0b214-114">We'll implement these two steps within two Create() methods within our MoviesController class.</span></span> <span data-ttu-id="0b214-115">Une méthode affichera le &lt;formulaire&gt; que l’utilisateur doit renseigner pour créer un nouveau film.</span><span class="sxs-lookup"><span data-stu-id="0b214-115">One method will show the &lt;form&gt; that the user should fill out to create a new movie.</span></span> <span data-ttu-id="0b214-116">La deuxième méthode gère le traitement des données publiées lorsque l’utilisateur soumet le &lt;formulaire&gt; sur le serveur et enregistrer un nouveau film dans notre base de données.</span><span class="sxs-lookup"><span data-stu-id="0b214-116">The second method will handle processing the posted data when the user submits the &lt;form&gt; back to the server, and save a new Movie within our database.</span></span>

<span data-ttu-id="0b214-117">Voici le code nous ajouterons à notre classe MoviesController pour implémenter cela :</span><span class="sxs-lookup"><span data-stu-id="0b214-117">Below is the code we'll add to our MoviesController class to implement this:</span></span>

[!code-csharp[Main](getting-started-with-mvc-part6/samples/sample1.cs)]

<span data-ttu-id="0b214-118">Le code ci-dessus contient tout le code qu’il nous faudrait au sein de notre contrôleur.</span><span class="sxs-lookup"><span data-stu-id="0b214-118">The above code contains all of the code that we'll need within our Controller.</span></span>

<span data-ttu-id="0b214-119">Nous allons maintenant implémenter le modèle Create View que nous allons utiliser pour afficher un formulaire à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0b214-119">Let's now implement the Create View template that we'll use to display a form to the user.</span></span> <span data-ttu-id="0b214-120">Nous allons cliquez avec le bouton droit dans la première méthode de création et sélectionnez « Ajouter une vue « pour créer le modèle de vue pour notre formulaire de film.</span><span class="sxs-lookup"><span data-stu-id="0b214-120">We'll right click in the first Create method and select "Add View" to create the view template for our Movie form.</span></span>

<span data-ttu-id="0b214-121">Nous allons sélectionner nous fera passer le modèle de vue une « séquence » en tant que classe de données d’affichage, et indiquer que nous voulons « structurer » un modèle « Créer ».</span><span class="sxs-lookup"><span data-stu-id="0b214-121">We'll select that we are going to pass the view template a "Movie" as its view data class, and indicate that we want to "scaffold" a "Create" template.</span></span>

<span data-ttu-id="0b214-122">[![Ajouter une vue](getting-started-with-mvc-part6/_static/image2.png)](getting-started-with-mvc-part6/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0b214-122">[![Add View](getting-started-with-mvc-part6/_static/image2.png)](getting-started-with-mvc-part6/_static/image1.png)</span></span>

<span data-ttu-id="0b214-123">Après avoir cliqué sur le bouton Ajouter, modèle de vue \Movies\Create.aspx sera créé pour vous.</span><span class="sxs-lookup"><span data-stu-id="0b214-123">After you click the Add button, \Movies\Create.aspx View template will be created for you.</span></span> <span data-ttu-id="0b214-124">Étant donné que nous avons sélectionné « Créer » dans la liste déroulante « Afficher le contenu », la boîte de dialogue Ajouter une vue « été généré automatiquement » du contenu par défaut pour nous.</span><span class="sxs-lookup"><span data-stu-id="0b214-124">Because we selected "Create" from the "view content" dropdown, the Add View dialog automatically "scaffolded" some default content for us.</span></span> <span data-ttu-id="0b214-125">La génération de modèles automatique créé HTML &lt;formulaire&gt;, un emplacement pour l’erreur de validation des messages pour accéder et dans la mesure où la structure connaît des films, il créé étiquette et les champs pour chaque propriété de la classe.</span><span class="sxs-lookup"><span data-stu-id="0b214-125">The scaffolding created an HTML &lt;form&gt;, a place for validation error messages to go, and since scaffolding knows about Movies, it created Label and Fields for each property of our class.</span></span>

[!code-aspx[Main](getting-started-with-mvc-part6/samples/sample2.aspx)]

<span data-ttu-id="0b214-126">Étant donné que notre base de données fournit automatiquement un ID d’un film, nous allons supprimer ces champs de ce modèle de référence. ID à partir de notre Create View.</span><span class="sxs-lookup"><span data-stu-id="0b214-126">Since our database automatically gives a Movie an ID, let's remove those fields that reference model.Id from our Create View.</span></span> <span data-ttu-id="0b214-127">Supprimez les 7 lignes après &lt;légende&gt;champs&lt;/legend&gt; comme ils indiquent le champ ID que nous ne voulons pas.</span><span class="sxs-lookup"><span data-stu-id="0b214-127">Remove the 7 lines after &lt;legend&gt;Fields&lt;/legend&gt; as they show the ID field that we don't want.</span></span>

<span data-ttu-id="0b214-128">Nous allons maintenant créer un nouveau film et l’ajouter à la base de données.</span><span class="sxs-lookup"><span data-stu-id="0b214-128">Let's now create a new movie and add it to the database.</span></span> <span data-ttu-id="0b214-129">Nous allons faire en exécutant à nouveau l’application et visitez le « / Movies » URL et cliquez sur la « créer » lien pour ajouter un nouveau film.</span><span class="sxs-lookup"><span data-stu-id="0b214-129">We'll do this by running the application again and visit the "/Movies" URL and click the "Create" link to add a new Movie.</span></span>

<span data-ttu-id="0b214-130">[![Créer - Windows Internet Explorer](getting-started-with-mvc-part6/_static/image4.png)](getting-started-with-mvc-part6/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="0b214-130">[![Create - Windows Internet Explorer](getting-started-with-mvc-part6/_static/image4.png)](getting-started-with-mvc-part6/_static/image3.png)</span></span>

<span data-ttu-id="0b214-131">Lorsque nous cliquons sur le bouton Créer, nous allons y publier (par HTTP POST) les données sur ce formulaire à la méthode /Movies/Create que nous venons de créer.</span><span class="sxs-lookup"><span data-stu-id="0b214-131">When we click the Create button, we'll be posting back (via HTTP POST) the data on this form to the /Movies/Create method that we just created.</span></span> <span data-ttu-id="0b214-132">Comme lorsque le système a pris le paramètre « numTimes » et « name » en dehors de l’URL et automatiquement les mappés à des paramètres sur une méthode précédemment, le système sera automatiquement prendre les champs de formulaire à partir d’une publication et les mapper à un objet.</span><span class="sxs-lookup"><span data-stu-id="0b214-132">Just like when the system automatically took the "numTimes" and "name " parameter out of the URL and mapped them to parameters on a method earlier, the system will automatically take the Form Fields from a POST and map them to an object.</span></span> <span data-ttu-id="0b214-133">Dans ce cas, les valeurs des champs au format HTML tels que « ReleaseDate » et « Title » seront automatiquement placées dans les propriétés appropriées d’une nouvelle instance d’un film.</span><span class="sxs-lookup"><span data-stu-id="0b214-133">In this case, values from fields in HTML like "ReleaseDate" and "Title" will automatically be put into the correct properties of a new instance of a Movie.</span></span>

<span data-ttu-id="0b214-134">Nous allons examiner la deuxième méthode de création de notre MoviesController à nouveau.</span><span class="sxs-lookup"><span data-stu-id="0b214-134">Let's look at the second Create method from our MoviesController again.</span></span> <span data-ttu-id="0b214-135">Remarquez comment il prend un objet « Vidéo » en tant qu’argument :</span><span class="sxs-lookup"><span data-stu-id="0b214-135">Notice how it takes a "Movie" object as an argument:</span></span>

[!code-csharp[Main](getting-started-with-mvc-part6/samples/sample3.cs)]

<span data-ttu-id="0b214-136">Cet objet de film a été ensuite transmis vers la version de [HttpPost] de notre méthode d’action de création, et nous avons enregistré dans la base de données et puis l’utilisateur est redirigé vers la méthode d’action Index() qui affiche le résultat enregistré dans la liste de films :</span><span class="sxs-lookup"><span data-stu-id="0b214-136">This Movie object was then passed to the [HttpPost] version of our Create action method, and we saved it in the database and then redirected the user back to the Index() action method which will show the saved result in the movie list:</span></span>

<span data-ttu-id="0b214-137">[![Liste de films - Windows Internet Explorer](getting-started-with-mvc-part6/_static/image6.png)](getting-started-with-mvc-part6/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0b214-137">[![Movie List - Windows Internet Explorer](getting-started-with-mvc-part6/_static/image6.png)](getting-started-with-mvc-part6/_static/image5.png)</span></span>

<span data-ttu-id="0b214-138">Nous ne la vérification si notre films sont corrects, cependant, ainsi que la base de données ne nous permettre d’enregistrer un film avec aucun titre.</span><span class="sxs-lookup"><span data-stu-id="0b214-138">We aren't checking if our movies are correct, though, and the database won't allow us to save a movie with no Title.</span></span> <span data-ttu-id="0b214-139">Il serait intéressant que nous pourrions l’utilisateur qui a généré une erreur avant de la base de données.</span><span class="sxs-lookup"><span data-stu-id="0b214-139">It'd be nice if we could tell the user that before the database threw an error.</span></span> <span data-ttu-id="0b214-140">Nous allons faire ce qui suit en ajoutant la prise en charge de la validation à notre application.</span><span class="sxs-lookup"><span data-stu-id="0b214-140">We'll do this next by adding validation support to our application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0b214-141">[Précédent](getting-started-with-mvc-part5.md)
> [Suivant](getting-started-with-mvc-part7.md)</span><span class="sxs-lookup"><span data-stu-id="0b214-141">[Previous](getting-started-with-mvc-part5.md)
[Next](getting-started-with-mvc-part7.md)</span></span>
