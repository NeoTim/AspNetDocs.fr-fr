---
uid: mvc/overview/older-versions-1/getting-started-with-mvc/getting-started-with-mvc-part6
title: Ajout d’une méthode Create et création d’une vue | Microsoft Docs
author: shanselman
description: Il s’agit d’un didacticiel débutant qui présente les notions de base de ASP.NET MVC. Créer une application Web simple qui lit et écrit à partir d’une base de données.
ms.author: riande
ms.date: 08/14/2010
ms.assetid: a3a90963-0286-4fa0-9b3d-c230cc18b0a3
msc.legacyurl: /mvc/overview/older-versions-1/getting-started-with-mvc/getting-started-with-mvc-part6
msc.type: authoredcontent
ms.openlocfilehash: 05a281720f76b107fe8d902ef60d5d2e72af3ef5
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78543658"
---
# <a name="adding-a-create-method-and-create-view"></a><span data-ttu-id="7cab4-104">Ajout d’une méthode de création et d’une vue de création</span><span class="sxs-lookup"><span data-stu-id="7cab4-104">Adding a Create Method and Create View</span></span>

<span data-ttu-id="7cab4-105">par [Scott Hanselman](https://github.com/shanselman)</span><span class="sxs-lookup"><span data-stu-id="7cab4-105">by [Scott Hanselman](https://github.com/shanselman)</span></span>

> <span data-ttu-id="7cab4-106">Il s’agit d’un didacticiel débutant qui présente les notions de base de ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="7cab4-106">This is a beginner tutorial that introduces the basics of ASP.NET MVC.</span></span> <span data-ttu-id="7cab4-107">Vous allez créer une application Web simple qui lit et écrit à partir d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="7cab4-107">You'll create a simple web application that reads and writes from a database.</span></span> <span data-ttu-id="7cab4-108">Visitez le [Centre d’apprentissage ASP.NET MVC](../../../index.md) pour trouver d’autres didacticiels et exemples ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="7cab4-108">Visit the [ASP.NET MVC learning center](../../../index.md) to find other ASP.NET MVC tutorials and samples.</span></span>

<span data-ttu-id="7cab4-109">Dans cette section, nous allons implémenter la prise en charge nécessaire pour permettre aux utilisateurs de créer des films dans notre base de données.</span><span class="sxs-lookup"><span data-stu-id="7cab4-109">In this section we are going to implement the support necessary to enable users to create new movies in our database.</span></span> <span data-ttu-id="7cab4-110">Pour ce faire, nous allons implémenter l’action d’URL/Movies/Create.</span><span class="sxs-lookup"><span data-stu-id="7cab4-110">We'll do this by implementing the /Movies/Create URL action.</span></span>

<span data-ttu-id="7cab4-111">L’implémentation de l’URL/Movies/Create est un processus en deux étapes.</span><span class="sxs-lookup"><span data-stu-id="7cab4-111">Implementing the /Movies/Create URL is a two step process.</span></span> <span data-ttu-id="7cab4-112">Lorsqu’un utilisateur visite pour la première fois l’URL/Movies/Create, nous souhaitons afficher un formulaire HTML qu’il peut remplir pour entrer dans un nouveau film.</span><span class="sxs-lookup"><span data-stu-id="7cab4-112">When a user first visits the /Movies/Create URL we want to show them an HTML form that they can fill out to enter a new movie.</span></span> <span data-ttu-id="7cab4-113">Ensuite, lorsque l’utilisateur envoie le formulaire et publie les données sur le serveur, nous souhaitons récupérer le contenu publié et l’enregistrer dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="7cab4-113">Then, when the user submits the form and posts the data back to the server, we want to retrieve the posted contents and save it into our database.</span></span>

<span data-ttu-id="7cab4-114">Nous allons implémenter ces deux étapes dans deux méthodes Create () au sein de notre classe MoviesController.</span><span class="sxs-lookup"><span data-stu-id="7cab4-114">We'll implement these two steps within two Create() methods within our MoviesController class.</span></span> <span data-ttu-id="7cab4-115">Une méthode affiche le formulaire &lt;&gt; que l’utilisateur doit remplir pour créer un nouveau film.</span><span class="sxs-lookup"><span data-stu-id="7cab4-115">One method will show the &lt;form&gt; that the user should fill out to create a new movie.</span></span> <span data-ttu-id="7cab4-116">La deuxième méthode gère le traitement des données publiées lorsque l’utilisateur soumet le formulaire de &lt;&gt; à nouveau au serveur et enregistre un nouveau film dans notre base de données.</span><span class="sxs-lookup"><span data-stu-id="7cab4-116">The second method will handle processing the posted data when the user submits the &lt;form&gt; back to the server, and save a new Movie within our database.</span></span>

<span data-ttu-id="7cab4-117">Voici le code que nous ajouterons à notre classe MoviesController pour l’implémenter :</span><span class="sxs-lookup"><span data-stu-id="7cab4-117">Below is the code we'll add to our MoviesController class to implement this:</span></span>

[!code-csharp[Main](getting-started-with-mvc-part6/samples/sample1.cs)]

<span data-ttu-id="7cab4-118">Le code ci-dessus contient tout le code dont nous aurons besoin au sein de notre contrôleur.</span><span class="sxs-lookup"><span data-stu-id="7cab4-118">The above code contains all of the code that we'll need within our Controller.</span></span>

<span data-ttu-id="7cab4-119">Nous allons maintenant implémenter le modèle de vue créer que nous allons utiliser pour afficher un formulaire à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7cab4-119">Let's now implement the Create View template that we'll use to display a form to the user.</span></span> <span data-ttu-id="7cab4-120">Nous allons cliquer avec le bouton droit dans la première méthode Create et sélectionner « Add View » (ajouter une vue) pour créer le modèle de vue pour notre formulaire de film.</span><span class="sxs-lookup"><span data-stu-id="7cab4-120">We'll right click in the first Create method and select "Add View" to create the view template for our Movie form.</span></span>

<span data-ttu-id="7cab4-121">Nous allons sélectionner que nous allons passer le modèle de vue « Movie » comme classe de données de vue, et indiquer que nous voulons « échafauder » un modèle « Create » (créer).</span><span class="sxs-lookup"><span data-stu-id="7cab4-121">We'll select that we are going to pass the view template a "Movie" as its view data class, and indicate that we want to "scaffold" a "Create" template.</span></span>

<span data-ttu-id="7cab4-122">[![ajouter une vue](getting-started-with-mvc-part6/_static/image2.png)](getting-started-with-mvc-part6/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7cab4-122">[![Add View](getting-started-with-mvc-part6/_static/image2.png)](getting-started-with-mvc-part6/_static/image1.png)</span></span>

<span data-ttu-id="7cab4-123">Une fois que vous avez cliqué sur le bouton Ajouter, le modèle de vue \Movies\Create.aspx est créé pour vous.</span><span class="sxs-lookup"><span data-stu-id="7cab4-123">After you click the Add button, \Movies\Create.aspx View template will be created for you.</span></span> <span data-ttu-id="7cab4-124">Étant donné que nous avons sélectionné « créer » dans la liste déroulante « Afficher le contenu », la boîte de dialogue Ajouter une vue « échafaudait » automatiquement le contenu par défaut pour nous.</span><span class="sxs-lookup"><span data-stu-id="7cab4-124">Because we selected "Create" from the "view content" dropdown, the Add View dialog automatically "scaffolded" some default content for us.</span></span> <span data-ttu-id="7cab4-125">La génération de modèles automatique a créé un formulaire de &lt;HTML&gt;, un emplacement pour les messages d’erreur de validation, et puisque la génération de modèles automatique connaît les films, elle a créé des étiquettes et des champs pour chaque propriété de notre classe.</span><span class="sxs-lookup"><span data-stu-id="7cab4-125">The scaffolding created an HTML &lt;form&gt;, a place for validation error messages to go, and since scaffolding knows about Movies, it created Label and Fields for each property of our class.</span></span>

[!code-aspx[Main](getting-started-with-mvc-part6/samples/sample2.aspx)]

<span data-ttu-id="7cab4-126">Dans la mesure où notre base de données donne automatiquement un ID à un film, nous allons supprimer ces champs qui font référence au modèle. ID de notre vue Create.</span><span class="sxs-lookup"><span data-stu-id="7cab4-126">Since our database automatically gives a Movie an ID, let's remove those fields that reference model.Id from our Create View.</span></span> <span data-ttu-id="7cab4-127">Supprimez les 7 lignes après &lt;&gt;champs de légende&lt;la&gt;/Legend, car ils affichent le champ d’ID que nous ne souhaitons pas.</span><span class="sxs-lookup"><span data-stu-id="7cab4-127">Remove the 7 lines after &lt;legend&gt;Fields&lt;/legend&gt; as they show the ID field that we don't want.</span></span>

<span data-ttu-id="7cab4-128">Créons maintenant un nouveau film et l’ajoutons à la base de données.</span><span class="sxs-lookup"><span data-stu-id="7cab4-128">Let's now create a new movie and add it to the database.</span></span> <span data-ttu-id="7cab4-129">Pour ce faire, nous allons réexécuter l’application et accéder à l’URL « /movies », puis cliquer sur le lien « créer » pour ajouter un nouveau film.</span><span class="sxs-lookup"><span data-stu-id="7cab4-129">We'll do this by running the application again and visit the "/Movies" URL and click the "Create" link to add a new Movie.</span></span>

<span data-ttu-id="7cab4-130">[![créer-Windows Internet Explorer](getting-started-with-mvc-part6/_static/image4.png)](getting-started-with-mvc-part6/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="7cab4-130">[![Create - Windows Internet Explorer](getting-started-with-mvc-part6/_static/image4.png)](getting-started-with-mvc-part6/_static/image3.png)</span></span>

<span data-ttu-id="7cab4-131">Lorsque nous cliquons sur le bouton créer, nous publierons (via HTTP POST) les données de ce formulaire vers la méthode/Movies/Create que nous venons de créer.</span><span class="sxs-lookup"><span data-stu-id="7cab4-131">When we click the Create button, we'll be posting back (via HTTP POST) the data on this form to the /Movies/Create method that we just created.</span></span> <span data-ttu-id="7cab4-132">Tout comme lorsque le système a pris les paramètres « numTimes » et « Name » de l’URL et les a mappés à des paramètres sur une méthode précédemment, le système prend automatiquement les champs de formulaire d’une publication et les mappe à un objet.</span><span class="sxs-lookup"><span data-stu-id="7cab4-132">Just like when the system automatically took the "numTimes" and "name " parameter out of the URL and mapped them to parameters on a method earlier, the system will automatically take the Form Fields from a POST and map them to an object.</span></span> <span data-ttu-id="7cab4-133">Dans ce cas, les valeurs des champs en HTML, telles que « Released » et « title », sont automatiquement placées dans les propriétés appropriées d’une nouvelle instance d’un film.</span><span class="sxs-lookup"><span data-stu-id="7cab4-133">In this case, values from fields in HTML like "ReleaseDate" and "Title" will automatically be put into the correct properties of a new instance of a Movie.</span></span>

<span data-ttu-id="7cab4-134">Examinons à nouveau la deuxième méthode Create de notre MoviesController.</span><span class="sxs-lookup"><span data-stu-id="7cab4-134">Let's look at the second Create method from our MoviesController again.</span></span> <span data-ttu-id="7cab4-135">Notez qu’il prend un objet « Movie » comme argument :</span><span class="sxs-lookup"><span data-stu-id="7cab4-135">Notice how it takes a "Movie" object as an argument:</span></span>

[!code-csharp[Main](getting-started-with-mvc-part6/samples/sample3.cs)]

<span data-ttu-id="7cab4-136">Cet objet film a ensuite été transmis à la version [HttpPost] de notre méthode Create action et nous l’avons enregistré dans la base de données, puis Redirigé l’utilisateur vers la méthode d’action index (), qui affiche le résultat enregistré dans la liste de films :</span><span class="sxs-lookup"><span data-stu-id="7cab4-136">This Movie object was then passed to the [HttpPost] version of our Create action method, and we saved it in the database and then redirected the user back to the Index() action method which will show the saved result in the movie list:</span></span>

<span data-ttu-id="7cab4-137">[Liste des films ![-Windows Internet Explorer](getting-started-with-mvc-part6/_static/image6.png)](getting-started-with-mvc-part6/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7cab4-137">[![Movie List - Windows Internet Explorer](getting-started-with-mvc-part6/_static/image6.png)](getting-started-with-mvc-part6/_static/image5.png)</span></span>

<span data-ttu-id="7cab4-138">Toutefois, nous ne vérifions pas si nos films sont corrects et la base de données ne nous permettra pas d’enregistrer un film sans titre.</span><span class="sxs-lookup"><span data-stu-id="7cab4-138">We aren't checking if our movies are correct, though, and the database won't allow us to save a movie with no Title.</span></span> <span data-ttu-id="7cab4-139">C’est agréable si nous pouvions dire à l’utilisateur avant que la base de données ne relevait une erreur.</span><span class="sxs-lookup"><span data-stu-id="7cab4-139">It'd be nice if we could tell the user that before the database threw an error.</span></span> <span data-ttu-id="7cab4-140">Nous allons le faire ensuite en ajoutant la prise en charge de la validation à notre application.</span><span class="sxs-lookup"><span data-stu-id="7cab4-140">We'll do this next by adding validation support to our application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7cab4-141">[Précédent](getting-started-with-mvc-part5.md)
> [Suivant](getting-started-with-mvc-part7.md)</span><span class="sxs-lookup"><span data-stu-id="7cab4-141">[Previous](getting-started-with-mvc-part5.md)
[Next](getting-started-with-mvc-part7.md)</span></span>
