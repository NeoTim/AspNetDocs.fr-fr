---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-linq-to-sql-vb
title: Création de classes de modèle avec LINQ to SQL (VB) | Microsoft Docs
author: microsoft
description: L’objectif de ce didacticiel est d’expliquer une méthode de création de classes de modèle pour une application MVC ASP.NET. Dans ce didacticiel, vous allez apprendre à générer le modèle c...
ms.author: riande
ms.date: 10/07/2008
ms.assetid: a4a25a75-d71f-4509-98b4-df72e748985a
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-linq-to-sql-vb
msc.type: authoredcontent
ms.openlocfilehash: 88a5f1037d93ef3bdc95bf60b6005ebb254ab440
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78581269"
---
# <a name="creating-model-classes-with-linq-to-sql-vb"></a><span data-ttu-id="06e13-104">Création de classes de modèle avec LINQ to SQL (VB)</span><span class="sxs-lookup"><span data-stu-id="06e13-104">Creating Model Classes with LINQ to SQL (VB)</span></span>

<span data-ttu-id="06e13-105">par [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="06e13-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="06e13-106">Télécharger PDF</span><span class="sxs-lookup"><span data-stu-id="06e13-106">Download PDF</span></span>](https://download.microsoft.com/download/1/1/f/11f721aa-d749-4ed7-bb89-a681b68894e6/ASPNET_MVC_Tutorial_10_VB.pdf)

> <span data-ttu-id="06e13-107">L’objectif de ce didacticiel est d’expliquer une méthode de création de classes de modèle pour une application MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="06e13-107">The goal of this tutorial is to explain one method of creating model classes for an ASP.NET MVC application.</span></span> <span data-ttu-id="06e13-108">Dans ce didacticiel, vous allez apprendre à créer des classes de modèle et à effectuer l’accès à la base de données en tirant parti de Microsoft LINQ to SQL.</span><span class="sxs-lookup"><span data-stu-id="06e13-108">In this tutorial, you learn how to build model classes and perform database access by taking advantage of Microsoft LINQ to SQL.</span></span>

<span data-ttu-id="06e13-109">L’objectif de ce didacticiel est d’expliquer une méthode de création de classes de modèle pour une application MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="06e13-109">The goal of this tutorial is to explain one method of creating model classes for an ASP.NET MVC application.</span></span> <span data-ttu-id="06e13-110">Dans ce didacticiel, vous allez apprendre à créer des classes de modèle et à effectuer l’accès à la base de données en tirant parti de Microsoft LINQ to SQL.</span><span class="sxs-lookup"><span data-stu-id="06e13-110">In this tutorial, you learn how to build model classes and perform database access by taking advantage of Microsoft LINQ to SQL.</span></span>

<span data-ttu-id="06e13-111">Dans ce didacticiel, nous créons une application de base de données de vidéo de base.</span><span class="sxs-lookup"><span data-stu-id="06e13-111">In this tutorial, we build a basic Movie database application.</span></span> <span data-ttu-id="06e13-112">Nous commençons par créer l’application de base de données de films de la manière la plus rapide et la plus simple possible.</span><span class="sxs-lookup"><span data-stu-id="06e13-112">We start by creating the Movie database application in the fastest and easiest way possible.</span></span> <span data-ttu-id="06e13-113">Nous effectuons tous nos accès aux données directement à partir de nos actions de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="06e13-113">We perform all of our data access directly from our controller actions.</span></span>

<span data-ttu-id="06e13-114">Ensuite, vous allez apprendre à utiliser le modèle de référentiel.</span><span class="sxs-lookup"><span data-stu-id="06e13-114">Next, you learn how to use the Repository pattern.</span></span> <span data-ttu-id="06e13-115">L’utilisation du modèle de référentiel nécessite un peu plus de travail.</span><span class="sxs-lookup"><span data-stu-id="06e13-115">Using the Repository pattern requires a little more work.</span></span> <span data-ttu-id="06e13-116">Toutefois, l’adoption de ce modèle présente l’avantage de vous permettre de créer des applications adaptables pour les modifier et pouvant être facilement testées.</span><span class="sxs-lookup"><span data-stu-id="06e13-116">However, the advantage of adopting this pattern is that it enables you to build applications that are adaptable to change and can be easily tested.</span></span>

## <a name="what-is-a-model-class"></a><span data-ttu-id="06e13-117">Qu’est-ce qu’une classe de modèle ?</span><span class="sxs-lookup"><span data-stu-id="06e13-117">What is a Model Class?</span></span>

<span data-ttu-id="06e13-118">Un modèle MVC contient toute la logique d’application qui n’est pas contenue dans une vue MVC ou un contrôleur MVC.</span><span class="sxs-lookup"><span data-stu-id="06e13-118">An MVC model contains all of the application logic that is not contained in an MVC view or MVC controller.</span></span> <span data-ttu-id="06e13-119">En particulier, un modèle MVC contient toutes les logiques d’accès aux données et à l’entreprise de votre application.</span><span class="sxs-lookup"><span data-stu-id="06e13-119">In particular, an MVC model contains all of your application business and data access logic.</span></span>

<span data-ttu-id="06e13-120">Vous pouvez utiliser diverses technologies pour implémenter votre logique d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="06e13-120">You can use a variety of different technologies to implement your data access logic.</span></span> <span data-ttu-id="06e13-121">Par exemple, vous pouvez créer vos classes d’accès aux données à l’aide des classes Microsoft Entity Framework, NHibernate, SubSonic ou ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="06e13-121">For example, you can build your data access classes using the Microsoft Entity Framework, NHibernate, Subsonic, or ADO.NET classes.</span></span>

<span data-ttu-id="06e13-122">Dans ce didacticiel, j’utilise LINQ to SQL pour interroger et mettre à jour la base de données.</span><span class="sxs-lookup"><span data-stu-id="06e13-122">In this tutorial, I use LINQ to SQL to query and update the database.</span></span> <span data-ttu-id="06e13-123">LINQ to SQL vous offre une méthode très simple d’interaction avec une base de données Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="06e13-123">LINQ to SQL provides you with a very easy method of interacting with a Microsoft SQL Server database.</span></span> <span data-ttu-id="06e13-124">Toutefois, il est important de comprendre que l’infrastructure MVC ASP.NET n’est pas liée à LINQ to SQL de quelque manière que ce soit.</span><span class="sxs-lookup"><span data-stu-id="06e13-124">However, it is important to understand that the ASP.NET MVC framework is not tied to LINQ to SQL in any way.</span></span> <span data-ttu-id="06e13-125">ASP.NET MVC est compatible avec toutes les technologies d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="06e13-125">ASP.NET MVC is compatible with any data access technology.</span></span>

## <a name="create-a-movie-database"></a><span data-ttu-id="06e13-126">Créer une base de données de films</span><span class="sxs-lookup"><span data-stu-id="06e13-126">Create a Movie Database</span></span>

<span data-ttu-id="06e13-127">Dans ce didacticiel, afin d’illustrer comment vous pouvez créer des classes de modèle, nous créons une application de base de données de films simple.</span><span class="sxs-lookup"><span data-stu-id="06e13-127">In this tutorial -- in order to illustrate how you can build model classes -- we build a simple Movie database application.</span></span> <span data-ttu-id="06e13-128">La première étape consiste à créer une nouvelle base de données.</span><span class="sxs-lookup"><span data-stu-id="06e13-128">The first step is to create a new database.</span></span> <span data-ttu-id="06e13-129">Cliquez avec le bouton droit sur le dossier de données de l’application\_dans la fenêtre Explorateur de solutions et sélectionnez l’option de menu **Ajouter, nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="06e13-129">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span> <span data-ttu-id="06e13-130">Sélectionnez le modèle de base de données SQL Server, donnez-lui le nom MoviesDB. mdf, puis cliquez sur le bouton **Ajouter** (voir figure 1).</span><span class="sxs-lookup"><span data-stu-id="06e13-130">Select the SQL Server Database template, give it the name MoviesDB.mdf, and click the **Add** button (see Figure 1).</span></span>

<span data-ttu-id="06e13-131">[![de l’ajout d’une nouvelle base de données SQL Server](creating-model-classes-with-linq-to-sql-vb/_static/image2.png)](creating-model-classes-with-linq-to-sql-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="06e13-131">[![Adding a new SQL Server Database](creating-model-classes-with-linq-to-sql-vb/_static/image2.png)](creating-model-classes-with-linq-to-sql-vb/_static/image1.png)</span></span>

<span data-ttu-id="06e13-132">**Figure 01**: ajout d’une nouvelle base de données SQL Server ([cliquez pour afficher l’image en taille réelle](creating-model-classes-with-linq-to-sql-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="06e13-132">**Figure 01**: Adding a new SQL Server Database ([Click to view full-size image](creating-model-classes-with-linq-to-sql-vb/_static/image3.png))</span></span>

<span data-ttu-id="06e13-133">Après avoir créé la base de données, vous pouvez ouvrir la base de données en double-cliquant sur le fichier MoviesDB. mdf dans le dossier de données de l’application\_.</span><span class="sxs-lookup"><span data-stu-id="06e13-133">After you create the new database, you can open the database by double-clicking the MoviesDB.mdf file in the App\_Data folder.</span></span> <span data-ttu-id="06e13-134">Double-cliquez sur le fichier MoviesDB. mdf pour ouvrir la fenêtre Explorateur de serveurs (voir figure 2).</span><span class="sxs-lookup"><span data-stu-id="06e13-134">Double-clicking the MoviesDB.mdf file opens the Server Explorer window (see Figure 2).</span></span>

|   | <span data-ttu-id="06e13-135">La fenêtre Explorateur de serveurs s’appelle la fenêtre de explorateur de base de données lors de l’utilisation de Visual Web Developer.</span><span class="sxs-lookup"><span data-stu-id="06e13-135">The Server Explorer window is called the Database Explorer window when using Visual Web Developer.</span></span> |
|---|----------------------------------------------------------------------------------------------------|
|   |                                                                                                    |

<span data-ttu-id="06e13-136">[![à l’aide de la fenêtre Explorateur de serveurs](creating-model-classes-with-linq-to-sql-vb/_static/image5.png)](creating-model-classes-with-linq-to-sql-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="06e13-136">[![Using the Server Explorer window](creating-model-classes-with-linq-to-sql-vb/_static/image5.png)](creating-model-classes-with-linq-to-sql-vb/_static/image4.png)</span></span>

<span data-ttu-id="06e13-137">**Figure 02**: utilisation de la fenêtre Explorateur de serveurs ([cliquez pour afficher l’image en taille réelle](creating-model-classes-with-linq-to-sql-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="06e13-137">**Figure 02**: Using the Server Explorer window ([Click to view full-size image](creating-model-classes-with-linq-to-sql-vb/_static/image6.png))</span></span>

<span data-ttu-id="06e13-138">Nous devons ajouter une table à notre base de données qui représente nos films.</span><span class="sxs-lookup"><span data-stu-id="06e13-138">We need to add one table to our database that represents our movies.</span></span> <span data-ttu-id="06e13-139">Cliquez avec le bouton droit sur le dossier tables et sélectionnez l’option de menu **Ajouter une nouvelle table**.</span><span class="sxs-lookup"><span data-stu-id="06e13-139">Right-click the Tables folder and select the menu option **Add New Table**.</span></span> <span data-ttu-id="06e13-140">La sélection de cette option de menu ouvre le Concepteur de tables (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="06e13-140">Selecting this menu option opens the Table Designer (see Figure 3).</span></span>

<span data-ttu-id="06e13-141">[![à l’aide de la fenêtre Explorateur de serveurs](creating-model-classes-with-linq-to-sql-vb/_static/image8.png)](creating-model-classes-with-linq-to-sql-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="06e13-141">[![Using the Server Explorer window](creating-model-classes-with-linq-to-sql-vb/_static/image8.png)](creating-model-classes-with-linq-to-sql-vb/_static/image7.png)</span></span>

<span data-ttu-id="06e13-142">**Figure 03**: concepteur de tables ([cliquez pour afficher l’image en taille réelle](creating-model-classes-with-linq-to-sql-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="06e13-142">**Figure 03**: The Table Designer ([Click to view full-size image](creating-model-classes-with-linq-to-sql-vb/_static/image9.png))</span></span>

<span data-ttu-id="06e13-143">Nous devons ajouter les colonnes suivantes à la table de base de données :</span><span class="sxs-lookup"><span data-stu-id="06e13-143">We need to add the following columns to our database table:</span></span>

| <span data-ttu-id="06e13-144">**Nom de la colonne**</span><span class="sxs-lookup"><span data-stu-id="06e13-144">**Column Name**</span></span> | <span data-ttu-id="06e13-145">**Type de données**</span><span class="sxs-lookup"><span data-stu-id="06e13-145">**Data Type**</span></span> | <span data-ttu-id="06e13-146">**Null autorisé**</span><span class="sxs-lookup"><span data-stu-id="06e13-146">**Allow Nulls**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="06e13-147">Id</span><span class="sxs-lookup"><span data-stu-id="06e13-147">Id</span></span> | <span data-ttu-id="06e13-148">Int</span><span class="sxs-lookup"><span data-stu-id="06e13-148">Int</span></span> | <span data-ttu-id="06e13-149">False</span><span class="sxs-lookup"><span data-stu-id="06e13-149">False</span></span> |
| <span data-ttu-id="06e13-150">Titre</span><span class="sxs-lookup"><span data-stu-id="06e13-150">Title</span></span> | <span data-ttu-id="06e13-151">Nvarchar(200)</span><span class="sxs-lookup"><span data-stu-id="06e13-151">Nvarchar(200)</span></span> | <span data-ttu-id="06e13-152">False</span><span class="sxs-lookup"><span data-stu-id="06e13-152">False</span></span> |
| <span data-ttu-id="06e13-153">Directeur</span><span class="sxs-lookup"><span data-stu-id="06e13-153">Director</span></span> | <span data-ttu-id="06e13-154">Nvarchar(50)</span><span class="sxs-lookup"><span data-stu-id="06e13-154">Nvarchar(50)</span></span> | <span data-ttu-id="06e13-155">False</span><span class="sxs-lookup"><span data-stu-id="06e13-155">False</span></span> |

<span data-ttu-id="06e13-156">Vous devez effectuer deux opérations spéciales dans la colonne ID.</span><span class="sxs-lookup"><span data-stu-id="06e13-156">You need to do two special things to the Id column.</span></span> <span data-ttu-id="06e13-157">Tout d’abord, vous devez marquer la colonne ID en tant que colonne de clé primaire en sélectionnant la colonne dans la Concepteur de tables et en cliquant sur l’icône d’une clé.</span><span class="sxs-lookup"><span data-stu-id="06e13-157">First, you need to mark the Id column as a primary key column by selecting the column in the Table Designer and clicking the icon of a key.</span></span> <span data-ttu-id="06e13-158">LINQ to SQL vous oblige à spécifier vos colonnes de clé primaire lors de l’exécution d’insertions ou de mises à jour sur la base de données.</span><span class="sxs-lookup"><span data-stu-id="06e13-158">LINQ to SQL requires you to specify your primary key columns when performing inserts or updates against the database.</span></span>

<span data-ttu-id="06e13-159">Ensuite, vous devez marquer la colonne ID en tant que colonne d’identité en affectant la valeur yes à la propriété **is Identity** (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="06e13-159">Next, you need to mark the Id column as an Identity column by assigning the value Yes to the **Is Identity** property (see Figure 3).</span></span> <span data-ttu-id="06e13-160">Une colonne d’identité est une colonne à laquelle un nouveau numéro est affecté automatiquement chaque fois que vous ajoutez une nouvelle ligne de données à une table.</span><span class="sxs-lookup"><span data-stu-id="06e13-160">An Identity column is a column that is assigned a new number automatically whenever you add a new row of data to a table.</span></span>

<span data-ttu-id="06e13-161">Une fois ces modifications effectuées, enregistrez la table sous le nom tblMovie.</span><span class="sxs-lookup"><span data-stu-id="06e13-161">After you make these changes, save the table with the name tblMovie.</span></span> <span data-ttu-id="06e13-162">Vous pouvez enregistrer la table en cliquant sur le bouton enregistrer.</span><span class="sxs-lookup"><span data-stu-id="06e13-162">You can save the table by clicking the Save button.</span></span>

## <a name="create-linq-to-sql-classes"></a><span data-ttu-id="06e13-163">Créer des classes de LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="06e13-163">Create LINQ to SQL Classes</span></span>

<span data-ttu-id="06e13-164">Notre modèle MVC contient des classes LINQ to SQL qui représentent la table de base de données tblMovie.</span><span class="sxs-lookup"><span data-stu-id="06e13-164">Our MVC model will contain LINQ to SQL classes that represent the tblMovie database table.</span></span> <span data-ttu-id="06e13-165">Le moyen le plus simple de créer ces LINQ to SQL des classes consiste à cliquer avec le bouton droit sur le dossier modèles, à sélectionner **Ajouter, nouvel élément**, à sélectionner le modèle LINQ to SQL classes, à attribuer aux classes le nom Movie. dbml, puis à cliquer sur le bouton **Ajouter** (voir figure 4).</span><span class="sxs-lookup"><span data-stu-id="06e13-165">The easiest way to create these LINQ to SQL classes is to right-click the Models folder, select **Add, New Item**, select the LINQ to SQL Classes template, give the classes the name Movie.dbml, and click the **Add** button (see Figure 4).</span></span>

<span data-ttu-id="06e13-166">[![de la création de classes LINQ to SQL](creating-model-classes-with-linq-to-sql-vb/_static/image11.png)](creating-model-classes-with-linq-to-sql-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="06e13-166">[![Creating LINQ to SQL classes](creating-model-classes-with-linq-to-sql-vb/_static/image11.png)](creating-model-classes-with-linq-to-sql-vb/_static/image10.png)</span></span>

<span data-ttu-id="06e13-167">**Figure 04**: création de classes LINQ to SQL ([cliquez pour afficher l’image en taille réelle](creating-model-classes-with-linq-to-sql-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="06e13-167">**Figure 04**: Creating LINQ to SQL classes ([Click to view full-size image](creating-model-classes-with-linq-to-sql-vb/_static/image12.png))</span></span>

<span data-ttu-id="06e13-168">Immédiatement après avoir créé le film LINQ to SQL classes, le Concepteur Objet Relationnel s’affiche.</span><span class="sxs-lookup"><span data-stu-id="06e13-168">Immediately after you create the Movie LINQ to SQL Classes, the Object Relational Designer appears.</span></span> <span data-ttu-id="06e13-169">Vous pouvez faire glisser des tables de base de données de la fenêtre Explorateur de serveurs sur le Concepteur Objet Relationnel pour créer des classes LINQ to SQL qui représentent des tables de base de données particulières.</span><span class="sxs-lookup"><span data-stu-id="06e13-169">You can drag database tables from the Server Explorer window onto the Object Relational Designer to create LINQ to SQL Classes that represent particular database tables.</span></span> <span data-ttu-id="06e13-170">Nous devons ajouter la table de base de données tblMovie sur le Concepteur Objet Relationnel (voir figure 4).</span><span class="sxs-lookup"><span data-stu-id="06e13-170">We need to add the tblMovie database table onto the Object Relational Designer (see Figure 4).</span></span>

<span data-ttu-id="06e13-171">[![à l’aide de la Concepteur Objet Relationnel](creating-model-classes-with-linq-to-sql-vb/_static/image14.png)](creating-model-classes-with-linq-to-sql-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="06e13-171">[![Using the Object Relational Designer](creating-model-classes-with-linq-to-sql-vb/_static/image14.png)](creating-model-classes-with-linq-to-sql-vb/_static/image13.png)</span></span>

<span data-ttu-id="06e13-172">**Figure 05**: utilisation du concepteur objet relationnel ([cliquez pour afficher l’image en taille réelle](creating-model-classes-with-linq-to-sql-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="06e13-172">**Figure 05**: Using the Object Relational Designer ([Click to view full-size image](creating-model-classes-with-linq-to-sql-vb/_static/image15.png))</span></span>

<span data-ttu-id="06e13-173">Par défaut, le Concepteur Objet Relationnel crée une classe portant le même nom que la table de base de données que vous faites glisser sur le concepteur.</span><span class="sxs-lookup"><span data-stu-id="06e13-173">By default, the Object Relational Designer creates a class with the very same name as the database table that you drag onto the Designer.</span></span> <span data-ttu-id="06e13-174">Toutefois, nous ne souhaitons pas appeler notre classe tblMovie.</span><span class="sxs-lookup"><span data-stu-id="06e13-174">However, we don't want to call our class tblMovie.</span></span> <span data-ttu-id="06e13-175">Par conséquent, cliquez sur le nom de la classe dans le concepteur et remplacez le nom de la classe par Movie.</span><span class="sxs-lookup"><span data-stu-id="06e13-175">Therefore, click the name of the class in the Designer and change the name of the class to Movie.</span></span>

<span data-ttu-id="06e13-176">Enfin, n’oubliez pas de cliquer sur le bouton **Enregistrer** (l’image de la disquette) pour enregistrer les Classes de LINQ to SQL.</span><span class="sxs-lookup"><span data-stu-id="06e13-176">Finally, remember to click the **Save** button (the picture of the floppy) to save the LINQ to SQL Classes.</span></span> <span data-ttu-id="06e13-177">Dans le cas contraire, les classes LINQ to SQL ne seront pas générées par le Concepteur Objet Relationnel.</span><span class="sxs-lookup"><span data-stu-id="06e13-177">Otherwise, the LINQ to SQL Classes won't be generated by the Object Relational Designer.</span></span>

## <a name="using-linq-to-sql-in-a-controller-action"></a><span data-ttu-id="06e13-178">Utilisation de LINQ to SQL dans une action de contrôleur</span><span class="sxs-lookup"><span data-stu-id="06e13-178">Using LINQ to SQL in a Controller Action</span></span>

<span data-ttu-id="06e13-179">Maintenant que nous avons nos classes LINQ to SQL, nous pouvons utiliser ces classes pour récupérer des données de la base de données.</span><span class="sxs-lookup"><span data-stu-id="06e13-179">Now that we have our LINQ to SQL classes, we can use these classes to retrieve data from the database.</span></span> <span data-ttu-id="06e13-180">Dans cette section, vous allez apprendre à utiliser des classes de LINQ to SQL directement dans une action de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="06e13-180">In this section, you learn how to use LINQ to SQL classes directly within a controller action.</span></span> <span data-ttu-id="06e13-181">Nous allons afficher la liste des films à partir de la table de base de données tblMovies dans une vue MVC.</span><span class="sxs-lookup"><span data-stu-id="06e13-181">We'll display the list of movies from the tblMovies database table in an MVC view.</span></span>

<span data-ttu-id="06e13-182">Tout d’abord, nous devons modifier la classe HomeController.</span><span class="sxs-lookup"><span data-stu-id="06e13-182">First, we need to modify the HomeController class.</span></span> <span data-ttu-id="06e13-183">Cette classe se trouve dans le dossier Controllers de votre application.</span><span class="sxs-lookup"><span data-stu-id="06e13-183">This class can be found in the Controllers folder of your application.</span></span> <span data-ttu-id="06e13-184">Modifiez la classe pour qu’elle ressemble à la classe dans la liste 1.</span><span class="sxs-lookup"><span data-stu-id="06e13-184">Modify the class so it looks like the class in Listing 1.</span></span>

<span data-ttu-id="06e13-185">**Liste 1 – `Controllers\HomeController.vb`**</span><span class="sxs-lookup"><span data-stu-id="06e13-185">**Listing 1 – `Controllers\HomeController.vb`**</span></span>

[!code-vb[Main](creating-model-classes-with-linq-to-sql-vb/samples/sample1.vb)]

<span data-ttu-id="06e13-186">L’action index () dans la liste 1 utilise une LINQ to SQL classe DataContext (MovieDataContext) pour représenter la base de données MoviesDB.</span><span class="sxs-lookup"><span data-stu-id="06e13-186">The Index() action in Listing 1 uses a LINQ to SQL DataContext class (the MovieDataContext) to represent the MoviesDB database.</span></span> <span data-ttu-id="06e13-187">La classe MoveDataContext a été générée par l’Concepteur Objet Relationnel Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="06e13-187">The MoveDataContext class was generated by the Visual Studio Object Relational Designer.</span></span>

<span data-ttu-id="06e13-188">Une requête LINQ est exécutée sur le DataContext pour récupérer tous les films de la table de base de données tblMovies.</span><span class="sxs-lookup"><span data-stu-id="06e13-188">A LINQ query is performed against the DataContext to retrieve all of the movies from the tblMovies database table.</span></span> <span data-ttu-id="06e13-189">La liste des films est assignée à une variable locale nommée movies.</span><span class="sxs-lookup"><span data-stu-id="06e13-189">The list of movies is assigned to a local variable named movies.</span></span> <span data-ttu-id="06e13-190">Enfin, la liste des films est transmise à la vue par le biais de données d’affichage.</span><span class="sxs-lookup"><span data-stu-id="06e13-190">Finally, the list of movies is passed to the view through view data.</span></span>

<span data-ttu-id="06e13-191">Pour afficher les films, nous devons ensuite modifier la vue index.</span><span class="sxs-lookup"><span data-stu-id="06e13-191">In order to show the movies, we next need to modify the Index view.</span></span> <span data-ttu-id="06e13-192">Vous pouvez trouver la vue index dans le dossier Views\Home\.</span><span class="sxs-lookup"><span data-stu-id="06e13-192">You can find the Index view in the Views\Home\ folder.</span></span> <span data-ttu-id="06e13-193">Mettez à jour la vue index afin qu’elle ressemble à la vue dans la liste 2.</span><span class="sxs-lookup"><span data-stu-id="06e13-193">Update the Index view so that it looks like the view in Listing 2.</span></span>

<span data-ttu-id="06e13-194">**Liste 2 – `Views\Home\Index.aspx`**</span><span class="sxs-lookup"><span data-stu-id="06e13-194">**Listing 2 – `Views\Home\Index.aspx`**</span></span>

[!code-aspx[Main](creating-model-classes-with-linq-to-sql-vb/samples/sample2.aspx)]

<span data-ttu-id="06e13-195">Notez que la vue d’index modifiée comprend une directive &lt;% @ Import namespace%&gt; en haut de la vue.</span><span class="sxs-lookup"><span data-stu-id="06e13-195">Notice that the modified Index view includes an &lt;%@ import namespace %&gt; directive at the top of the view.</span></span> <span data-ttu-id="06e13-196">Cette directive importe l’espace de noms MvcApplication1.</span><span class="sxs-lookup"><span data-stu-id="06e13-196">This directive imports the MvcApplication1 namespace.</span></span> <span data-ttu-id="06e13-197">Nous avons besoin de cet espace de noms pour pouvoir utiliser les classes de modèle, en particulier la classe Movie, dans la vue.</span><span class="sxs-lookup"><span data-stu-id="06e13-197">We need this namespace in order to work with the model classes – in particular, the Movie class -- in the view.</span></span>

<span data-ttu-id="06e13-198">La vue dans la liste 2 contient une boucle for each qui itère au sein de tous les éléments représentés par la propriété ViewData. Model.</span><span class="sxs-lookup"><span data-stu-id="06e13-198">The view in Listing 2 contains a For Each loop that iterates through all of the items represented by the ViewData.Model property.</span></span> <span data-ttu-id="06e13-199">La valeur de la propriété titre est affichée pour chaque film.</span><span class="sxs-lookup"><span data-stu-id="06e13-199">The value of the Title property is displayed for each movie.</span></span>

<span data-ttu-id="06e13-200">Notez que la valeur de la propriété ViewData. Model est castée en IEnumerable.</span><span class="sxs-lookup"><span data-stu-id="06e13-200">Notice that the value of the ViewData.Model property is cast to an IEnumerable.</span></span> <span data-ttu-id="06e13-201">Cela est nécessaire pour effectuer une boucle dans le contenu de ViewData. Model.</span><span class="sxs-lookup"><span data-stu-id="06e13-201">This is necessary in order to loop through the contents of ViewData.Model.</span></span> <span data-ttu-id="06e13-202">Une autre option consiste à créer une vue fortement typée.</span><span class="sxs-lookup"><span data-stu-id="06e13-202">Another option here is to create a strongly-typed view.</span></span> <span data-ttu-id="06e13-203">Quand vous créez une vue fortement typée, vous effectuez un cast de la propriété ViewData. Model en un type particulier dans la classe code-behind d’une vue.</span><span class="sxs-lookup"><span data-stu-id="06e13-203">When you create a strongly-typed view, you cast the ViewData.Model property to a particular type in a view's code-behind class.</span></span>

<span data-ttu-id="06e13-204">Si vous exécutez l’application après avoir modifié la classe HomeController et la vue index, vous obtiendrez une page vierge.</span><span class="sxs-lookup"><span data-stu-id="06e13-204">If you run the application after modifying the HomeController class and the Index view then you will get a blank page.</span></span> <span data-ttu-id="06e13-205">Vous obtiendrez une page vide, car il n’y a pas d’enregistrement Movie dans la table de base de données tblMovies.</span><span class="sxs-lookup"><span data-stu-id="06e13-205">You'll get a blank page because there are no movie records in the tblMovies database table.</span></span>

<span data-ttu-id="06e13-206">Pour ajouter des enregistrements à la table de base de données tblMovies, cliquez avec le bouton droit sur la table de base de données tblMovies dans la fenêtre Explorateur de serveurs (fenêtre explorateur de base de données dans Visual Web Developer) et sélectionnez l’option de menu **afficher les données**de la table.</span><span class="sxs-lookup"><span data-stu-id="06e13-206">In order to add records to the tblMovies database table, right-click the tblMovies database table in the Server Explorer window (Database Explorer window in Visual Web Developer) and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="06e13-207">Vous pouvez insérer des enregistrements de films à l’aide de la grille qui s’affiche (voir figure 5).</span><span class="sxs-lookup"><span data-stu-id="06e13-207">You can insert movie records by using the grid that appears (see Figure 5).</span></span>

<span data-ttu-id="06e13-208">[![insertion de films](creating-model-classes-with-linq-to-sql-vb/_static/image17.png)](creating-model-classes-with-linq-to-sql-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="06e13-208">[![Inserting movies](creating-model-classes-with-linq-to-sql-vb/_static/image17.png)](creating-model-classes-with-linq-to-sql-vb/_static/image16.png)</span></span>

<span data-ttu-id="06e13-209">**Figure 06**: insertion de films ([cliquez pour afficher l’image en taille réelle](creating-model-classes-with-linq-to-sql-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="06e13-209">**Figure 06**: Inserting movies([Click to view full-size image](creating-model-classes-with-linq-to-sql-vb/_static/image18.png))</span></span>

<span data-ttu-id="06e13-210">Une fois que vous avez ajouté des enregistrements de base de données à la table tblMovies et que vous exécutez l’application, vous voyez la page de la figure 7.</span><span class="sxs-lookup"><span data-stu-id="06e13-210">After you add some database records to the tblMovies table, and you run the application, you'll see the page in Figure 7.</span></span> <span data-ttu-id="06e13-211">Tous les enregistrements de base de données de films s’affichent dans une liste à puces.</span><span class="sxs-lookup"><span data-stu-id="06e13-211">All of the movie database records are displayed in a bulleted list.</span></span>

<span data-ttu-id="06e13-212">[![affichage des films avec la vue index](creating-model-classes-with-linq-to-sql-vb/_static/image20.png)](creating-model-classes-with-linq-to-sql-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="06e13-212">[![Displaying movies with the Index view](creating-model-classes-with-linq-to-sql-vb/_static/image20.png)](creating-model-classes-with-linq-to-sql-vb/_static/image19.png)</span></span>

<span data-ttu-id="06e13-213">**Figure 07**: affichage des films avec la vue d’index ([cliquez pour afficher l’image en taille réelle](creating-model-classes-with-linq-to-sql-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="06e13-213">**Figure 07**: Displaying movies with the Index view([Click to view full-size image](creating-model-classes-with-linq-to-sql-vb/_static/image21.png))</span></span>

## <a name="using-the-repository-pattern"></a><span data-ttu-id="06e13-214">Utilisation du modèle de référentiel</span><span class="sxs-lookup"><span data-stu-id="06e13-214">Using the Repository Pattern</span></span>

<span data-ttu-id="06e13-215">Dans la section précédente, nous avons utilisé LINQ to SQL classes directement dans une action de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="06e13-215">In the previous section, we used LINQ to SQL classes directly within a controller action.</span></span> <span data-ttu-id="06e13-216">Nous avons utilisé la classe MovieDataContext directement à partir de l’action du contrôleur index ().</span><span class="sxs-lookup"><span data-stu-id="06e13-216">We used the MovieDataContext class directly from the Index() controller action.</span></span> <span data-ttu-id="06e13-217">Cela ne pose aucun problème dans le cas d’une application simple.</span><span class="sxs-lookup"><span data-stu-id="06e13-217">There is nothing wrong with doing this in the case of a simple application.</span></span> <span data-ttu-id="06e13-218">Toutefois, travailler directement avec LINQ to SQL dans une classe de contrôleur crée des problèmes lorsque vous devez créer une application plus complexe.</span><span class="sxs-lookup"><span data-stu-id="06e13-218">However, working directly with LINQ to SQL in a controller class creates problems when you need to build a more complex application.</span></span>

<span data-ttu-id="06e13-219">L’utilisation de LINQ to SQL au sein d’une classe de contrôleur rend difficile le changement futur des technologies d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="06e13-219">Using LINQ to SQL within a controller class makes it difficult to switch data access technologies in the future.</span></span> <span data-ttu-id="06e13-220">Par exemple, vous pouvez décider de passer de Microsoft LINQ to SQL à l’utilisation de la Entity Framework Microsoft comme technologie d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="06e13-220">For example, you might decide to switch from using Microsoft LINQ to SQL to using the Microsoft Entity Framework as your data access technology.</span></span> <span data-ttu-id="06e13-221">Dans ce cas, vous devez réécrire chaque contrôleur qui accède à la base de données au sein de votre application.</span><span class="sxs-lookup"><span data-stu-id="06e13-221">In that case, you would need to rewrite every controller that accesses the database within your application.</span></span>

<span data-ttu-id="06e13-222">L’utilisation de LINQ to SQL dans une classe de contrôleur rend également difficile la génération de tests unitaires pour votre application.</span><span class="sxs-lookup"><span data-stu-id="06e13-222">Using LINQ to SQL within a controller class also makes it difficult to build unit tests for your application.</span></span> <span data-ttu-id="06e13-223">Normalement, vous ne souhaitez pas interagir avec une base de données lors de l’exécution de tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="06e13-223">Normally, you do not want to interact with a database when performing unit tests.</span></span> <span data-ttu-id="06e13-224">Vous souhaitez utiliser vos tests unitaires pour tester la logique de votre application et non votre serveur de base de données.</span><span class="sxs-lookup"><span data-stu-id="06e13-224">You want to use your unit tests to test your application logic and not your database server.</span></span>

<span data-ttu-id="06e13-225">Pour générer une application MVC qui est plus adaptable aux modifications ultérieures et qui peut être testée plus facilement, vous devez envisager d’utiliser le modèle de référentiel.</span><span class="sxs-lookup"><span data-stu-id="06e13-225">In order to build an MVC application that is more adaptable to future change and that can be more easily tested, you should consider using the Repository pattern.</span></span> <span data-ttu-id="06e13-226">Lorsque vous utilisez le modèle de référentiel, vous créez une classe de référentiel distincte qui contient toute la logique d’accès à la base de données.</span><span class="sxs-lookup"><span data-stu-id="06e13-226">When you use the Repository pattern, you create a separate repository class that contains all of your database access logic.</span></span>

<span data-ttu-id="06e13-227">Lorsque vous créez la classe de référentiel, vous créez une interface qui représente toutes les méthodes utilisées par la classe de référentiel.</span><span class="sxs-lookup"><span data-stu-id="06e13-227">When you create the repository class, you create an interface that represents all of the methods used by the repository class.</span></span> <span data-ttu-id="06e13-228">Dans vos contrôleurs, vous écrivez votre code sur l’interface au lieu du référentiel.</span><span class="sxs-lookup"><span data-stu-id="06e13-228">Within your controllers, you write your code against the interface instead of the repository.</span></span> <span data-ttu-id="06e13-229">De cette façon, vous pouvez implémenter le référentiel à l’aide de différentes technologies d’accès aux données à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="06e13-229">That way, you can implement the repository using different data access technologies in the future.</span></span>

<span data-ttu-id="06e13-230">L’interface dans la liste 3 est nommée IMovieRepository et représente une méthode unique nommée ListAll ().</span><span class="sxs-lookup"><span data-stu-id="06e13-230">The interface in Listing 3 is named IMovieRepository and it represents a single method named ListAll().</span></span>

<span data-ttu-id="06e13-231">**Liste 3 – `Models\IMovieRepository.vb`**</span><span class="sxs-lookup"><span data-stu-id="06e13-231">**Listing 3 – `Models\IMovieRepository.vb`**</span></span>

[!code-vb[Main](creating-model-classes-with-linq-to-sql-vb/samples/sample3.vb)]

<span data-ttu-id="06e13-232">La classe de référentiel dans Listing 4 implémente l’interface IMovieRepository.</span><span class="sxs-lookup"><span data-stu-id="06e13-232">The repository class in Listing 4 implements the IMovieRepository interface.</span></span> <span data-ttu-id="06e13-233">Notez qu’il contient une méthode nommée ListAll () qui correspond à la méthode requise par l’interface IMovieRepository.</span><span class="sxs-lookup"><span data-stu-id="06e13-233">Notice that it contains a method named ListAll() that corresponds to the method required by the IMovieRepository interface.</span></span>

<span data-ttu-id="06e13-234">**Liste 4 – `Models\MovieRepository.vb`**</span><span class="sxs-lookup"><span data-stu-id="06e13-234">**Listing 4 – `Models\MovieRepository.vb`**</span></span>

[!code-vb[Main](creating-model-classes-with-linq-to-sql-vb/samples/sample4.vb)]

<span data-ttu-id="06e13-235">Enfin, la classe MoviesController de la liste 5 utilise le modèle de référentiel.</span><span class="sxs-lookup"><span data-stu-id="06e13-235">Finally, the MoviesController class in Listing 5 uses the Repository pattern.</span></span> <span data-ttu-id="06e13-236">Il n’utilise plus les classes LINQ to SQL directement.</span><span class="sxs-lookup"><span data-stu-id="06e13-236">It no longer uses LINQ to SQL classes directly.</span></span>

<span data-ttu-id="06e13-237">**Liste 5 – `Controllers\MoviesController.vb`**</span><span class="sxs-lookup"><span data-stu-id="06e13-237">**Listing 5 – `Controllers\MoviesController.vb`**</span></span>

[!code-vb[Main](creating-model-classes-with-linq-to-sql-vb/samples/sample5.vb)]

<span data-ttu-id="06e13-238">Notez que la classe MoviesController dans la liste 5 a deux constructeurs.</span><span class="sxs-lookup"><span data-stu-id="06e13-238">Notice that the MoviesController class in Listing 5 has two constructors.</span></span> <span data-ttu-id="06e13-239">Le premier constructeur, le constructeur sans paramètre, est appelé quand votre application est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="06e13-239">The first constructor, the parameterless constructor, is called when your application is running.</span></span> <span data-ttu-id="06e13-240">Ce constructeur crée une instance de la classe MovieRepository et la passe au deuxième constructeur.</span><span class="sxs-lookup"><span data-stu-id="06e13-240">This constructor creates an instance of the MovieRepository class and passes it to the second constructor.</span></span>

<span data-ttu-id="06e13-241">Le deuxième constructeur a un seul paramètre : un paramètre IMovieRepository.</span><span class="sxs-lookup"><span data-stu-id="06e13-241">The second constructor has a single parameter: an IMovieRepository parameter.</span></span> <span data-ttu-id="06e13-242">Ce constructeur assigne simplement la valeur du paramètre à un champ au niveau de la classe nommé \_référentiel.</span><span class="sxs-lookup"><span data-stu-id="06e13-242">This constructor simply assigns the value of the parameter to a class-level field named \_repository.</span></span>

<span data-ttu-id="06e13-243">La classe MoviesController tire parti d’un modèle de conception de logiciels appelé modèle d’injection de dépendances.</span><span class="sxs-lookup"><span data-stu-id="06e13-243">The MoviesController class is taking advantage of a software design pattern called the Dependency Injection pattern.</span></span> <span data-ttu-id="06e13-244">En particulier, il utilise un événement appelé injection de dépendances de constructeur.</span><span class="sxs-lookup"><span data-stu-id="06e13-244">In particular, it is using something called Constructor Dependency Injection.</span></span> <span data-ttu-id="06e13-245">Pour plus d’informations sur ce modèle, consultez l’article suivant de Martin Fowler :</span><span class="sxs-lookup"><span data-stu-id="06e13-245">You can read more about this pattern by reading the following article by Martin Fowler:</span></span>

[http://martinfowler.com/articles/injection.html](http://martinfowler.com/articles/injection.html)

<span data-ttu-id="06e13-246">Notez que tout le code de la classe MoviesController (à l’exception du premier constructeur) interagit avec l’interface IMovieRepository au lieu de la classe MovieRepository réelle.</span><span class="sxs-lookup"><span data-stu-id="06e13-246">Notice that all of the code in the MoviesController class (with the exception of the first constructor) interacts with the IMovieRepository interface instead of the actual MovieRepository class.</span></span> <span data-ttu-id="06e13-247">Le code interagit avec une interface abstraite au lieu d’une implémentation concrète de l’interface.</span><span class="sxs-lookup"><span data-stu-id="06e13-247">The code interacts with an abstract interface instead of a concrete implementation of the interface.</span></span>

<span data-ttu-id="06e13-248">Si vous souhaitez modifier la technologie d’accès aux données utilisée par l’application, il vous suffit d’implémenter l’interface IMovieRepository avec une classe qui utilise la technologie d’accès à la base de données de remplacement.</span><span class="sxs-lookup"><span data-stu-id="06e13-248">If you want to modify the data access technology used by the application then you can simply implement the IMovieRepository interface with a class that uses the alternative database access technology.</span></span> <span data-ttu-id="06e13-249">Par exemple, vous pouvez créer une classe EntityFrameworkMovieRepository ou une classe SubSonicMovieRepository.</span><span class="sxs-lookup"><span data-stu-id="06e13-249">For example, you could create an EntityFrameworkMovieRepository class or a SubSonicMovieRepository class.</span></span> <span data-ttu-id="06e13-250">Étant donné que la classe Controller est programmée par rapport à l’interface, vous pouvez passer une nouvelle implémentation de IMovieRepository à la classe Controller et la classe continuera à fonctionner.</span><span class="sxs-lookup"><span data-stu-id="06e13-250">Because the controller class is programmed against the interface, you can pass a new implementation of IMovieRepository to the controller class and the class would continue to work.</span></span>

<span data-ttu-id="06e13-251">En outre, si vous souhaitez tester la classe MoviesController, vous pouvez passer une classe de référentiel de films factices à MoviesController.</span><span class="sxs-lookup"><span data-stu-id="06e13-251">Furthermore, if you want to test the MoviesController class, then you can pass a fake movie repository class to the MoviesController.</span></span> <span data-ttu-id="06e13-252">Vous pouvez implémenter la classe IMovieRepository avec une classe qui n’accède pas réellement à la base de données, mais qui contient toutes les méthodes requises de l’interface IMovieRepository.</span><span class="sxs-lookup"><span data-stu-id="06e13-252">You can implement the IMovieRepository class with a class that does not actually access the database but contains all of the required methods of the IMovieRepository interface.</span></span> <span data-ttu-id="06e13-253">De cette façon, vous pouvez tester l’unité de la classe MoviesController sans réellement accéder à une base de données réelle.</span><span class="sxs-lookup"><span data-stu-id="06e13-253">That way, you can unit test the MoviesController class without actually accessing a real database.</span></span>

## <a name="summary"></a><span data-ttu-id="06e13-254">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="06e13-254">Summary</span></span>

<span data-ttu-id="06e13-255">L’objectif de ce didacticiel était de montrer comment vous pouvez créer des classes de modèle MVC en tirant parti de Microsoft LINQ to SQL.</span><span class="sxs-lookup"><span data-stu-id="06e13-255">The goal of this tutorial was to demonstrate how you can create MVC model classes by taking advantage of Microsoft LINQ to SQL.</span></span> <span data-ttu-id="06e13-256">Nous avons examiné deux stratégies d’affichage des données de base de données dans une application MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="06e13-256">We examined two strategies for displaying database data in an ASP.NET MVC application.</span></span> <span data-ttu-id="06e13-257">Tout d’abord, nous avons créé LINQ to SQL classes et utilisé les classes directement dans une action de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="06e13-257">First, we created LINQ to SQL classes and used the classes directly within a controller action.</span></span> <span data-ttu-id="06e13-258">L’utilisation de LINQ to SQL classes au sein d’un contrôleur vous permet d’afficher rapidement et facilement des données de base de données dans une application MVC.</span><span class="sxs-lookup"><span data-stu-id="06e13-258">Using LINQ to SQL classes within a controller enables you to quickly and easily display database data in an MVC application.</span></span>

<span data-ttu-id="06e13-259">Nous avons ensuite abordé un chemin légèrement plus difficile, mais bien plus vertueux, permettant d’afficher les données de la base de données.</span><span class="sxs-lookup"><span data-stu-id="06e13-259">Next, we explored a slightly more difficult, but definitely more virtuous, path for displaying database data.</span></span> <span data-ttu-id="06e13-260">Nous avons tiré parti du modèle de référentiel et placé toute notre logique d’accès à la base de données dans une classe de référentiel distincte.</span><span class="sxs-lookup"><span data-stu-id="06e13-260">We took advantage of the Repository pattern and placed all of our database access logic in a separate repository class.</span></span> <span data-ttu-id="06e13-261">Dans notre contrôleur, nous avons écrit l’ensemble de notre code sur une interface au lieu d’une classe concrète.</span><span class="sxs-lookup"><span data-stu-id="06e13-261">In our controller, we wrote all of our code against an interface instead of a concrete class.</span></span> <span data-ttu-id="06e13-262">L’avantage du modèle de référentiel est qu’il nous permet de modifier facilement les technologies d’accès aux bases de données à l’avenir. il nous permet de tester facilement nos classes de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="06e13-262">The advantage of the Repository pattern is that it enables us to easily change database access technologies in the future and it enables us to easily test our controller classes.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="06e13-263">[Précédent](creating-model-classes-with-the-entity-framework-vb.md)
> [Suivant](displaying-a-table-of-database-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="06e13-263">[Previous](creating-model-classes-with-the-entity-framework-vb.md)
[Next](displaying-a-table-of-database-data-vb.md)</span></span>
