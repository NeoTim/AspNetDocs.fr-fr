---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/queue-centric-work-pattern
title: Modèle de travail centré sur la file d’attente (génération d’applications Cloud réalistes avec Azure) | Microsoft Docs
author: MikeWasson
description: La création d’applications Cloud réelles avec Azure e-book est basée sur une présentation développée par Scott Guthrie. Il décrit 13 modèles et pratiques qui peuvent le faire...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: cc1ad51b-40c3-4c68-8620-9aaa0fd1f6cf
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/queue-centric-work-pattern
msc.type: authoredcontent
ms.openlocfilehash: c73b070f11366e781bcea70ffc84fd49a47d469a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74582775"
---
# <a name="queue-centric-work-pattern-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="e1b64-104">Modèle de travail centré sur la file d’attente (génération d’applications Cloud réalistes avec Azure)</span><span class="sxs-lookup"><span data-stu-id="e1b64-104">Queue-Centric Work Pattern (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="e1b64-105">par [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="e1b64-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="e1b64-106">[Télécharger le projet Fix it](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) ou [Télécharger le livre électronique](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1b64-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="e1b64-107">La **création d’applications Cloud réelles avec Azure** e-book est basée sur une présentation développée par Scott Guthrie.</span><span class="sxs-lookup"><span data-stu-id="e1b64-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="e1b64-108">Il décrit 13 modèles et pratiques qui peuvent vous aider à réussir le développement d’applications Web pour le Cloud.</span><span class="sxs-lookup"><span data-stu-id="e1b64-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="e1b64-109">Pour plus d’informations sur l’e-Book, consultez [le premier chapitre](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="e1b64-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="e1b64-110">Précédemment, nous avons vu que l’utilisation de plusieurs services peut aboutir à un contrat SLA « composite », où le contrat SLA effectif de l’application est le *produit* des contrats SLA individuels.</span><span class="sxs-lookup"><span data-stu-id="e1b64-110">Earlier, we saw that using multiple services can result in a "composite" SLA, where the app's effective SLA is the *product* of the individual SLAs.</span></span> <span data-ttu-id="e1b64-111">Par exemple, l’application Fix It utilise les sites Web, le stockage et les SQL Database.</span><span class="sxs-lookup"><span data-stu-id="e1b64-111">For example, the Fix It app uses Web Sites, Storage, and SQL Database.</span></span> <span data-ttu-id="e1b64-112">Si l’un de ces services échoue, l’application renvoie une erreur à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e1b64-112">If any one of these services fails, the app will return an error to the user.</span></span>

<span data-ttu-id="e1b64-113">La mise en cache est un bon moyen de gérer les défaillances temporaires pour le contenu en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="e1b64-113">Caching is a good way to handle transient failures for read-only content.</span></span> <span data-ttu-id="e1b64-114">Mais que se passe-t-il si votre application a besoin de travailler ?</span><span class="sxs-lookup"><span data-stu-id="e1b64-114">But what if your application needs to do work?</span></span> <span data-ttu-id="e1b64-115">Par exemple, lorsque l’utilisateur soumet une nouvelle tâche Fix it, l’application ne peut pas simplement placer la tâche dans le cache.</span><span class="sxs-lookup"><span data-stu-id="e1b64-115">For example, when the user submits a new Fix It task, the app can't just put the task into the cache.</span></span> <span data-ttu-id="e1b64-116">L’application doit écrire la tâche Fix it dans un magasin de données persistant, afin qu’elle puisse être traitée.</span><span class="sxs-lookup"><span data-stu-id="e1b64-116">The app needs to write the Fix It task into a persistent data store, so it can be processed.</span></span>

<span data-ttu-id="e1b64-117">C’est là qu’intervient le modèle de travail centré sur la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-117">That's where the queue-centric work pattern comes in.</span></span> <span data-ttu-id="e1b64-118">Ce modèle permet un couplage lâche entre un niveau Web et un service principal.</span><span class="sxs-lookup"><span data-stu-id="e1b64-118">This pattern enables loose coupling between a web tier and a backend service.</span></span>

<span data-ttu-id="e1b64-119">Voici comment fonctionne le modèle.</span><span class="sxs-lookup"><span data-stu-id="e1b64-119">Here's how the pattern works.</span></span> <span data-ttu-id="e1b64-120">Lorsque l’application reçoit une demande, elle place un élément de travail dans une file d’attente et retourne immédiatement la réponse.</span><span class="sxs-lookup"><span data-stu-id="e1b64-120">When the application gets a request, it puts a work item onto a queue and immediately returns the response.</span></span> <span data-ttu-id="e1b64-121">Ensuite, un processus principal distinct extrait des éléments de travail à partir de la file d’attente et effectue le travail.</span><span class="sxs-lookup"><span data-stu-id="e1b64-121">Then a separate backend process pulls work items from the queue and does the work.</span></span>

<span data-ttu-id="e1b64-122">Le modèle de travail centré sur la file d’attente est utile pour :</span><span class="sxs-lookup"><span data-stu-id="e1b64-122">The queue-centric work pattern is useful for:</span></span>

- <span data-ttu-id="e1b64-123">Travail qui prend du temps (latence élevée).</span><span class="sxs-lookup"><span data-stu-id="e1b64-123">Work that is time consuming (high latency).</span></span>
- <span data-ttu-id="e1b64-124">Travail nécessitant un service externe qui peut ne pas toujours être disponible.</span><span class="sxs-lookup"><span data-stu-id="e1b64-124">Work that requires an external service that might not always be available.</span></span>
- <span data-ttu-id="e1b64-125">Travail nécessitant beaucoup de ressources (UC élevée).</span><span class="sxs-lookup"><span data-stu-id="e1b64-125">Work that is resource-intensive (high CPU).</span></span>
- <span data-ttu-id="e1b64-126">Travail qui tirerait parti du niveau de tarif (soumis à des pics de charge soudains).</span><span class="sxs-lookup"><span data-stu-id="e1b64-126">Work that would benefit from rate leveling (subject to sudden load bursts).</span></span>

## <a name="reduced-latency"></a><span data-ttu-id="e1b64-127">Latence réduite</span><span class="sxs-lookup"><span data-stu-id="e1b64-127">Reduced Latency</span></span>

<span data-ttu-id="e1b64-128">Les files d’attente sont utiles chaque fois que vous effectuez des tâches fastidieuses.</span><span class="sxs-lookup"><span data-stu-id="e1b64-128">Queues are useful any time you are doing time-consuming work.</span></span> <span data-ttu-id="e1b64-129">Si une tâche prend quelques secondes ou plus, au lieu de bloquer l’utilisateur final, placez l’élément de travail dans une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-129">If a task takes a few seconds or longer, instead of blocking the end user, put the work item into a queue.</span></span> <span data-ttu-id="e1b64-130">Dites à l’utilisateur « nous travaillons dessus », puis utilisez un écouteur de file d’attente pour traiter la tâche en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="e1b64-130">Tell the user "We're working on it," and then use a queue listener to process the task in the background.</span></span>

<span data-ttu-id="e1b64-131">Par exemple, lorsque vous achetez un produit auprès d’un détaillant en ligne, le site Web confirme votre commande immédiatement.</span><span class="sxs-lookup"><span data-stu-id="e1b64-131">For example, when you purchase something at an online retailer, the web site confirms your order immediately.</span></span> <span data-ttu-id="e1b64-132">Mais cela ne signifie pas que vos éléments se trouvent déjà dans un camion en cours de livraison.</span><span class="sxs-lookup"><span data-stu-id="e1b64-132">But that doesn't mean your stuff is already in a truck being delivered.</span></span> <span data-ttu-id="e1b64-133">Ils placent une tâche dans une file d’attente, et en arrière-plan, elle procède à la vérification de solvabilité, prépare vos articles pour l’expédition, etc.</span><span class="sxs-lookup"><span data-stu-id="e1b64-133">They put a task in a queue, and in the background they are doing the credit check, preparing your items for shipping, and so forth.</span></span>

<span data-ttu-id="e1b64-134">Pour les scénarios avec une latence réduite, le temps total de bout en bout peut être plus long avec une file d’attente, par rapport à la tâche de façon synchrone.</span><span class="sxs-lookup"><span data-stu-id="e1b64-134">For scenarios with short latency, the total end-to-end time might be longer using a queue, compared with doing the task synchronously.</span></span> <span data-ttu-id="e1b64-135">Mais même les autres avantages peuvent l’emporter sur ce désavantage.</span><span class="sxs-lookup"><span data-stu-id="e1b64-135">But even then, the other benefits can outweigh that disadvantage.</span></span>

## <a name="increased-reliability"></a><span data-ttu-id="e1b64-136">Fiabilité accrue</span><span class="sxs-lookup"><span data-stu-id="e1b64-136">Increased Reliability</span></span>

<span data-ttu-id="e1b64-137">Dans la version de Fix it que nous avons examiné jusqu’à présent, le serveur Web frontal est étroitement couplé avec le serveur principal SQL Database.</span><span class="sxs-lookup"><span data-stu-id="e1b64-137">In the version of Fix It that we've been looking at so far, the web front-end is tightly coupled with the SQL Database back-end.</span></span> <span data-ttu-id="e1b64-138">Si le service de base de données SQL n’est pas disponible, l’utilisateur reçoit une erreur.</span><span class="sxs-lookup"><span data-stu-id="e1b64-138">If the SQL database service is unavailable, the user gets an error.</span></span> <span data-ttu-id="e1b64-139">Si les nouvelles tentatives ne fonctionnent pas (autrement dit, si l’échec est plus que temporaire), la seule chose que vous pouvez faire est d’afficher une erreur et de demander à l’utilisateur de réessayer ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="e1b64-139">If retries don't work (that is, the failure is more than transient), the only thing you can do is show an error and ask the user to try again later.</span></span>

![Diagramme montrant l’échec du serveur Web frontal en cas d’échec de SQL Database serveur principal](queue-centric-work-pattern/_static/image1.png)

<span data-ttu-id="e1b64-141">À l’aide de files d’attente, lorsqu’un utilisateur soumet une tâche Fix it, l’application écrit un message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-141">Using queues, when a user submits a Fix It task, the app writes a message to the queue.</span></span> <span data-ttu-id="e1b64-142">La charge utile de message est une représentation [JSON](http://json.org/) de la tâche.</span><span class="sxs-lookup"><span data-stu-id="e1b64-142">The message payload is a [JSON](http://json.org/) representation of the task.</span></span> <span data-ttu-id="e1b64-143">Dès que le message est écrit dans la file d’attente, l’application retourne et affiche immédiatement un message de réussite à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e1b64-143">As soon as the message is written to the queue, the app returns and immediately shows a success message to the user.</span></span>

<span data-ttu-id="e1b64-144">Si l’un des services principaux (par exemple, la base de données SQL ou l’écouteur de file d’attente) passe en mode hors connexion, les utilisateurs peuvent toujours soumettre de nouvelles tâches de réparation.</span><span class="sxs-lookup"><span data-stu-id="e1b64-144">If any of the backend services – such as the SQL database or the queue listener -- go offline, users can still submit new Fix It tasks.</span></span> <span data-ttu-id="e1b64-145">Les messages sont simplement mis en file d’attente jusqu’à ce que les services principaux soient à nouveau disponibles.</span><span class="sxs-lookup"><span data-stu-id="e1b64-145">The messages will just queue up until the backend services are available again.</span></span> <span data-ttu-id="e1b64-146">À ce stade, les services principaux vont rattraper le Backlog.</span><span class="sxs-lookup"><span data-stu-id="e1b64-146">At that point, the backend services will catch up on the backlog.</span></span>

![Diagramme montrant que le serveur Web frontal continue à fonctionner en cas d’erreur SQL Database](queue-centric-work-pattern/_static/image2.png)

<span data-ttu-id="e1b64-148">En outre, vous pouvez désormais ajouter davantage de logique backend sans vous soucier de la résilience du serveur frontal.</span><span class="sxs-lookup"><span data-stu-id="e1b64-148">Moreover, now you can add more backend logic without worrying about the resiliency of the front end.</span></span> <span data-ttu-id="e1b64-149">Par exemple, vous souhaiterez peut-être envoyer un message électronique ou SMS au propriétaire chaque fois qu’un nouveau correctif est attribué.</span><span class="sxs-lookup"><span data-stu-id="e1b64-149">For example, you might want to send an email or SMS message to the owner whenever a new Fix It is assigned.</span></span> <span data-ttu-id="e1b64-150">Si l’e-mail ou le service SMS n’est plus disponible, vous pouvez traiter tout le reste, puis placer un message dans une file d’attente distincte pour l’envoi de messages électroniques/SMS.</span><span class="sxs-lookup"><span data-stu-id="e1b64-150">If the email or SMS service becomes unavailable, you can process everything else, and then put a message into a separate queue for sending email/SMS messages.</span></span>

<span data-ttu-id="e1b64-151">Auparavant, notre contrat SLA effectif était Web Apps &times; de stockage &times; SQL Database = 99,7%.</span><span class="sxs-lookup"><span data-stu-id="e1b64-151">Previously, our effective SLA was Web Apps &times; Storage &times; SQL Database = 99.7%.</span></span> <span data-ttu-id="e1b64-152">(Voir [conception pour survivre aux échecs](design-to-survive-failures.md).)</span><span class="sxs-lookup"><span data-stu-id="e1b64-152">(See [Design to Survive Failures](design-to-survive-failures.md).)</span></span>

<span data-ttu-id="e1b64-153">Lorsque nous modifions l’application pour utiliser une file d’attente, le serveur Web frontal dépend uniquement de Web Apps et de stockage, pour un contrat SLA composite de 99,8%.</span><span class="sxs-lookup"><span data-stu-id="e1b64-153">When we change the app to use a queue, the web front end depends only on Web Apps and Storage, for a composite SLA of 99.8%.</span></span> <span data-ttu-id="e1b64-154">(Notez que les files d’attente font partie du service de stockage Azure, elles sont donc incluses dans le même contrat SLA que le stockage d’objets BLOB.)</span><span class="sxs-lookup"><span data-stu-id="e1b64-154">(Note that queues are part of the Azure storage service, so they are included in the same SLA as blob storage.)</span></span>

<span data-ttu-id="e1b64-155">Si vous avez besoin de plus de 99,8%, vous pouvez créer deux files d’attente dans deux régions différentes.</span><span class="sxs-lookup"><span data-stu-id="e1b64-155">If you need even better than 99.8%, you can create two queues in two different regions.</span></span> <span data-ttu-id="e1b64-156">Désignez-en un comme principal et l’autre comme secondaire.</span><span class="sxs-lookup"><span data-stu-id="e1b64-156">Designate one as the primary, and the other as the secondary.</span></span> <span data-ttu-id="e1b64-157">Dans votre application, basculez vers la file d’attente secondaire si la file d’attente principale n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="e1b64-157">In your app, fail over to the secondary queue if the primary queue is not available.</span></span> <span data-ttu-id="e1b64-158">Le risque d’être indisponible en même temps est très faible.</span><span class="sxs-lookup"><span data-stu-id="e1b64-158">The chance of both being unavailable at the same time is very small.</span></span>

## <a name="rate-leveling-and-independent-scaling"></a><span data-ttu-id="e1b64-159">Nivellement des taux et mise à l’échelle indépendante</span><span class="sxs-lookup"><span data-stu-id="e1b64-159">Rate Leveling and Independent Scaling</span></span>

<span data-ttu-id="e1b64-160">Les files d’attente sont également utiles pour un événement appelé audit des *taux* ou nivellement de la *charge*.</span><span class="sxs-lookup"><span data-stu-id="e1b64-160">Queues are also useful for something called *rate leveling* or *load leveling*.</span></span>

<span data-ttu-id="e1b64-161">Les applications Web sont souvent sujettes à des pics soudains dans le trafic.</span><span class="sxs-lookup"><span data-stu-id="e1b64-161">Web apps are often susceptible to sudden bursts in traffic.</span></span> <span data-ttu-id="e1b64-162">Bien que vous puissiez utiliser la mise à l’échelle automatique pour ajouter automatiquement des serveurs Web pour gérer l’augmentation du trafic Web, la mise à l’échelle automatique risque de ne pas pouvoir réagir suffisamment rapidement pour gérer les pics brusques de charge.</span><span class="sxs-lookup"><span data-stu-id="e1b64-162">While you can use autoscaling to automatically add web servers to handle increased web traffic, autoscaling might not be able to react quickly enough to handle abrupt spikes in load.</span></span> <span data-ttu-id="e1b64-163">Si les serveurs Web peuvent décharger une partie du travail qu’ils doivent effectuer en écrivant un message dans une file d’attente, ils peuvent gérer plus de trafic.</span><span class="sxs-lookup"><span data-stu-id="e1b64-163">If the web servers can offload some of the work they have to do by writing a message to a queue, they can handle more traffic.</span></span> <span data-ttu-id="e1b64-164">Un service principal peut ensuite lire les messages de la file d’attente et les traiter.</span><span class="sxs-lookup"><span data-stu-id="e1b64-164">A backend service can then read messages from the queue and process them.</span></span> <span data-ttu-id="e1b64-165">La profondeur de la file d’attente augmente ou diminue à mesure que la charge entrante varie.</span><span class="sxs-lookup"><span data-stu-id="e1b64-165">The depth of the queue will grow or shrink as the incoming load varies.</span></span>

<span data-ttu-id="e1b64-166">Avec une grande partie de son travail long à décharger sur un service principal, la couche Web peut répondre plus facilement aux pics soudains du trafic.</span><span class="sxs-lookup"><span data-stu-id="e1b64-166">With much of its time-consuming work off-loaded to a backend service, the web tier can more easily respond to sudden spikes in traffic.</span></span> <span data-ttu-id="e1b64-167">Et vous économisez de l’argent, car une quantité de trafic donnée peut être gérée par moins de serveurs Web.</span><span class="sxs-lookup"><span data-stu-id="e1b64-167">And you save money because any given amount of traffic can be handled by fewer web servers.</span></span>

<span data-ttu-id="e1b64-168">Vous pouvez mettre à l’échelle la couche Web et le service principal indépendamment.</span><span class="sxs-lookup"><span data-stu-id="e1b64-168">You can scale the web tier and backend service independently.</span></span> <span data-ttu-id="e1b64-169">Par exemple, vous pouvez avoir besoin de trois serveurs Web, mais un seul serveur qui traite les messages de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-169">For example, you might need three web servers but only one server processing queue messages.</span></span> <span data-ttu-id="e1b64-170">Ou, si vous exécutez une tâche nécessitant beaucoup de ressources en arrière-plan, vous aurez peut-être besoin de davantage de serveurs principaux.</span><span class="sxs-lookup"><span data-stu-id="e1b64-170">Or if you're running a compute-intensive task in the background, you might need more backend servers.</span></span>

![](queue-centric-work-pattern/_static/image3.png)

<span data-ttu-id="e1b64-171">La mise à l’échelle automatique fonctionne avec les services principaux et le niveau Web.</span><span class="sxs-lookup"><span data-stu-id="e1b64-171">Autoscaling works with backend services as well as with the web tier.</span></span> <span data-ttu-id="e1b64-172">Vous pouvez augmenter ou réduire le nombre de machines virtuelles qui traitent les tâches dans la file d’attente, en fonction de l’utilisation du processeur des machines virtuelles principales.</span><span class="sxs-lookup"><span data-stu-id="e1b64-172">You can scale up or scale down the number of VMs that are processing the tasks in the queue, based on the CPU usage of the backend VMs.</span></span> <span data-ttu-id="e1b64-173">Ou bien, vous pouvez mettre à l’échelle automatiquement en fonction du nombre d’éléments qui se trouvent dans une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-173">Or, you can autoscale based on how many items are in a queue.</span></span> <span data-ttu-id="e1b64-174">Par exemple, vous pouvez demander à la mise à l’échelle automatique d’essayer de ne pas conserver plus de 10 éléments dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-174">For example, you can tell autoscale to try to keep no more than 10 items in the queue.</span></span> <span data-ttu-id="e1b64-175">Si la file d’attente contient plus de 10 éléments, la mise à l’échelle automatique ajoutera des machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="e1b64-175">If the queue has more than 10 items, autoscale will add VMs.</span></span> <span data-ttu-id="e1b64-176">Lors de la rattrapage, la mise à l’échelle automatique supprimera les machines virtuelles supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="e1b64-176">When they catch up, autoscale will tear down the extra VMs.</span></span>

## <a name="adding-queues-to-the-fix-it-application"></a><span data-ttu-id="e1b64-177">Ajout de files d’attente à l’application Fix it</span><span class="sxs-lookup"><span data-stu-id="e1b64-177">Adding Queues to the Fix It Application</span></span>

<span data-ttu-id="e1b64-178">Pour implémenter le modèle de file d’attente, nous devons apporter deux modifications à l’application Fix it.</span><span class="sxs-lookup"><span data-stu-id="e1b64-178">To implement the queue pattern, we need to make two changes to the Fix It app.</span></span>

- <span data-ttu-id="e1b64-179">Lorsqu’un utilisateur soumet une nouvelle tâche Fix it, placez la tâche dans la file d’attente, au lieu de l’écrire dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="e1b64-179">When a user submits a new Fix It task, put the task in the queue, instead of writing it to the database.</span></span>
- <span data-ttu-id="e1b64-180">Créez un service principal qui traite les messages dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-180">Create a back-end service that processes messages in the queue.</span></span>

<span data-ttu-id="e1b64-181">Pour la file d’attente, nous allons utiliser le [service de stockage de files d’attente Azure](https://www.windowsazure.com/develop/net/how-to-guides/queue-service/).</span><span class="sxs-lookup"><span data-stu-id="e1b64-181">For the queue, we'll use the [Azure Queue Storage Service](https://www.windowsazure.com/develop/net/how-to-guides/queue-service/).</span></span> <span data-ttu-id="e1b64-182">Une autre option consiste à utiliser [Azure Service bus](https://docs.microsoft.com/azure/service-bus/).</span><span class="sxs-lookup"><span data-stu-id="e1b64-182">Another option is to use [Azure Service Bus](https://docs.microsoft.com/azure/service-bus/).</span></span>

<span data-ttu-id="e1b64-183">Pour déterminer le service de file d’attente à utiliser, réfléchissez à la manière dont votre application doit envoyer et recevoir les messages dans la file d’attente :</span><span class="sxs-lookup"><span data-stu-id="e1b64-183">To decide which queue service to use, consider how your app needs to send and receive the messages in the queue:</span></span>

- <span data-ttu-id="e1b64-184">Si vous avez des producteurs coopérants et des consommateurs concurrents, envisagez d’utiliser le service de stockage de files d’attente Azure.</span><span class="sxs-lookup"><span data-stu-id="e1b64-184">If you have cooperating producers and competing consumers, consider using Azure Queue Storage Service.</span></span> <span data-ttu-id="e1b64-185">« Producteurs coopérants » signifie que plusieurs processus ajoutent des messages à une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-185">"Cooperating producers" means multiple processes are adding messages to a queue.</span></span> <span data-ttu-id="e1b64-186">« Consommateurs concurrents » signifie que plusieurs processus extraient des messages de la file d’attente pour les traiter, mais qu’un message donné ne peut être traité que par un « consommateur ».</span><span class="sxs-lookup"><span data-stu-id="e1b64-186">"Competing consumers" means multiple processes are pulling messages off the queue to process them, but any given message can only be processed by one "consumer."</span></span> <span data-ttu-id="e1b64-187">Si vous avez besoin d’un débit supérieur à celui que vous pouvez obtenir avec une seule file d’attente, utilisez des files d’attente supplémentaires et/ou des comptes de stockage supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="e1b64-187">If you need more throughput than you can get with a single queue, use additional queues and/or additional storage accounts.</span></span>
- <span data-ttu-id="e1b64-188">Si vous avez besoin d’un [modèle de publication/abonnement](http://en.wikipedia.org/wiki/Publish/subscribe), envisagez d’utiliser Azure Service bus files d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-188">If you need a [publish/subscribe model](http://en.wikipedia.org/wiki/Publish/subscribe), consider using Azure Service Bus Queues.</span></span>

<span data-ttu-id="e1b64-189">L’application Fix it correspond aux producteurs coopérants et aux consommateurs concurrents.</span><span class="sxs-lookup"><span data-stu-id="e1b64-189">The Fix It app fits the cooperating producers and competing consumers model.</span></span>

<span data-ttu-id="e1b64-190">Une autre considération concerne la disponibilité des applications.</span><span class="sxs-lookup"><span data-stu-id="e1b64-190">Another consideration is application availability.</span></span> <span data-ttu-id="e1b64-191">Le service de stockage de file d’attente fait partie du même service que nous utilisons pour le stockage d’objets BLOB, donc son utilisation n’a aucun effet sur notre contrat SLA.</span><span class="sxs-lookup"><span data-stu-id="e1b64-191">The Queue Storage Service is part of the same service that we're using for blob storage, so using it has no effect on our SLA.</span></span> <span data-ttu-id="e1b64-192">Azure Service Bus est un service distinct avec son propre contrat SLA.</span><span class="sxs-lookup"><span data-stu-id="e1b64-192">Azure Service Bus is a separate service with its own SLA.</span></span> <span data-ttu-id="e1b64-193">Si nous avions utilisé Service Bus files d’attente, nous devrions tenir compte d’un pourcentage SLA supplémentaire et notre contrat SLA composite serait plus faible.</span><span class="sxs-lookup"><span data-stu-id="e1b64-193">If we used Service Bus Queues, we would have to factor in an additional SLA percentage, and our composite SLA would be lower.</span></span> <span data-ttu-id="e1b64-194">Lorsque vous choisissez un service de file d’attente, veillez à bien comprendre l’impact de votre choix sur la disponibilité des applications.</span><span class="sxs-lookup"><span data-stu-id="e1b64-194">When you're choosing a queue service, make sure you understand the impact of your choice on application availability.</span></span> <span data-ttu-id="e1b64-195">Pour plus d’informations, consultez la section [ressources](#resources) .</span><span class="sxs-lookup"><span data-stu-id="e1b64-195">For more information, see the [Resources](#resources) section.</span></span>

## <a name="creating-queue-messages"></a><span data-ttu-id="e1b64-196">Création de messages de file d’attente</span><span class="sxs-lookup"><span data-stu-id="e1b64-196">Creating Queue Messages</span></span>

<span data-ttu-id="e1b64-197">Pour placer une tâche Fix it sur la file d’attente, le serveur Web frontal effectue les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="e1b64-197">To put a Fix It task on the queue, the web front end performs the following steps:</span></span>

1. <span data-ttu-id="e1b64-198">Créez une instance [CloudQueueClient](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueueclient.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e1b64-198">Create a [CloudQueueClient](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueueclient.aspx) instance.</span></span> <span data-ttu-id="e1b64-199">L’instance de `CloudQueueClient` est utilisée pour exécuter des demandes sur le service de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-199">The `CloudQueueClient` instance is used to execute requests against the Queue Service.</span></span>
2. <span data-ttu-id="e1b64-200">Créez la file d’attente, si elle n’existe pas encore.</span><span class="sxs-lookup"><span data-stu-id="e1b64-200">Create the queue, if it doesn't exist yet.</span></span>
3. <span data-ttu-id="e1b64-201">Sérialisez la tâche Fix it.</span><span class="sxs-lookup"><span data-stu-id="e1b64-201">Serialize the Fix It task.</span></span>
4. <span data-ttu-id="e1b64-202">Appelez [CloudQueue. AddMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.addmessageasync.aspx) pour placer le message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-202">Call [CloudQueue.AddMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.addmessageasync.aspx) to put the message onto the queue.</span></span>

<span data-ttu-id="e1b64-203">Nous allons effectuer ce travail dans le constructeur et la méthode `SendMessageAsync` d’une nouvelle classe `FixItQueueManager`.</span><span class="sxs-lookup"><span data-stu-id="e1b64-203">We'll do this work in the constructor and `SendMessageAsync` method of a new `FixItQueueManager` class.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample1.cs?highlight=11-12,16,18-25)]

<span data-ttu-id="e1b64-204">Ici, nous utilisons la bibliothèque [JSON.net](https://github.com/JamesNK/Newtonsoft.Json) pour sérialiser le correctif au format JSON.</span><span class="sxs-lookup"><span data-stu-id="e1b64-204">Here we are using the [Json.NET](https://github.com/JamesNK/Newtonsoft.Json) library to serialize the fixit to JSON format.</span></span> <span data-ttu-id="e1b64-205">Vous pouvez utiliser l’approche de sérialisation que vous préférez.</span><span class="sxs-lookup"><span data-stu-id="e1b64-205">You can use whatever serialization approach you prefer.</span></span> <span data-ttu-id="e1b64-206">JSON présente l’avantage de pouvoir être explicite, tout en étant moins détaillé que XML.</span><span class="sxs-lookup"><span data-stu-id="e1b64-206">JSON has the advantage of being human-readable, while being less verbose than XML.</span></span>

<span data-ttu-id="e1b64-207">Le code de qualité de production ajoute une logique de gestion des erreurs, interrompt si la base de données n’est plus disponible, gère la récupération de manière plus propre, crée la file d’attente sur le démarrage de l’application et gère les[messages « incohérents »](https://msdn.microsoft.com/library/ms789028(v=vs.110).aspx).</span><span class="sxs-lookup"><span data-stu-id="e1b64-207">Production-quality code would add error handling logic, pause if the database became unavailable, handle recovery more cleanly, create the queue on application start-up, and manage "[poison" messages](https://msdn.microsoft.com/library/ms789028(v=vs.110).aspx).</span></span> <span data-ttu-id="e1b64-208">(Un message incohérent est un message qui ne peut pas être traité pour une raison quelconque.</span><span class="sxs-lookup"><span data-stu-id="e1b64-208">(A poison message is a message that cannot be processed for some reason.</span></span> <span data-ttu-id="e1b64-209">Vous ne souhaitez pas que les messages incohérents se trouvent dans la file d’attente, où le rôle de travail essaiera continuellement de les traiter, d’échouer, de réessayer, d’échouer, etc.).</span><span class="sxs-lookup"><span data-stu-id="e1b64-209">You don't want poison messages to sit in the queue, where the worker role will continually try to process them, fail, try again, fail, and so on.)</span></span>

<span data-ttu-id="e1b64-210">Dans l’application MVC frontale, nous devons mettre à jour le code qui crée une nouvelle tâche.</span><span class="sxs-lookup"><span data-stu-id="e1b64-210">In the front-end MVC application, we need to update the code that creates a new task.</span></span> <span data-ttu-id="e1b64-211">Au lieu de placer la tâche dans le référentiel, appelez la méthode `SendMessageAsync` présentée ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="e1b64-211">Instead of putting the task into the repository, call the `SendMessageAsync` method shown above.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample2.cs?highlight=10)]

## <a name="processing-queue-messages"></a><span data-ttu-id="e1b64-212">Traitement des messages de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="e1b64-212">Processing Queue Messages</span></span>

<span data-ttu-id="e1b64-213">Pour traiter les messages dans la file d’attente, nous allons créer un service principal.</span><span class="sxs-lookup"><span data-stu-id="e1b64-213">To process messages in the queue, we'll create a backend service.</span></span> <span data-ttu-id="e1b64-214">Le service principal exécutera une boucle infinie qui effectue les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="e1b64-214">The backend service will run an infinite loop that performs the following steps:</span></span>

1. <span data-ttu-id="e1b64-215">Obtient le message suivant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-215">Get the next message from the queue.</span></span>
2. <span data-ttu-id="e1b64-216">Désérialisez le message vers une tâche Fix it.</span><span class="sxs-lookup"><span data-stu-id="e1b64-216">Deserialize the message to a Fix It task.</span></span>
3. <span data-ttu-id="e1b64-217">Écrivez la tâche Fix it dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="e1b64-217">Write the Fix It task to the database.</span></span>

<span data-ttu-id="e1b64-218">Pour héberger le service principal, nous allons créer un service Cloud Azure qui contient un *rôle de travail*.</span><span class="sxs-lookup"><span data-stu-id="e1b64-218">To host the backend service, we'll create an Azure Cloud Service that contains a *worker role*.</span></span> <span data-ttu-id="e1b64-219">Un rôle de travail se compose d’une ou plusieurs machines virtuelles qui peuvent effectuer le traitement principal.</span><span class="sxs-lookup"><span data-stu-id="e1b64-219">A worker role consists of one or more VMs that can do backend processing.</span></span> <span data-ttu-id="e1b64-220">Le code qui s’exécute sur ces machines virtuelles extrait les messages de la file d’attente dès qu’ils sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="e1b64-220">The code that runs in these VMs will pull messages from the queue as they become available.</span></span> <span data-ttu-id="e1b64-221">Pour chaque message, nous allons désérialiser la charge utile JSON et écrire une instance de l’entité Fix it Task dans la base de données, en utilisant le même référentiel que celui utilisé précédemment dans la couche Web.</span><span class="sxs-lookup"><span data-stu-id="e1b64-221">For each message, we'll deserialize the JSON payload and write an instance of the Fix It Task entity to the database, using the same repository that we used earlier in the web tier.</span></span>

<span data-ttu-id="e1b64-222">Les étapes suivantes montrent comment ajouter un projet de rôle de travail à une solution qui a un projet Web standard.</span><span class="sxs-lookup"><span data-stu-id="e1b64-222">The following steps show how to add a worker role project to a solution that has a standard web project.</span></span> <span data-ttu-id="e1b64-223">Ces étapes ont déjà été effectuées dans le projet Fix it que vous pouvez télécharger.</span><span class="sxs-lookup"><span data-stu-id="e1b64-223">These steps have already been done in the Fix It project that you can download.</span></span>

<span data-ttu-id="e1b64-224">Tout d’abord, ajoutez un projet de service Cloud à la solution Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e1b64-224">First add a Cloud Service project to the Visual Studio solution.</span></span> <span data-ttu-id="e1b64-225">Cliquez avec le bouton droit sur la solution et sélectionnez **Ajouter**, puis **nouveau projet**.</span><span class="sxs-lookup"><span data-stu-id="e1b64-225">Right-click the solution and select **Add**, then **New Project**.</span></span> <span data-ttu-id="e1b64-226">Dans le volet gauche, développez **visuel C#**  et sélectionnez **Cloud**.</span><span class="sxs-lookup"><span data-stu-id="e1b64-226">In the left pane, expand **Visual C#** and select **Cloud**.</span></span>

[![](queue-centric-work-pattern/_static/image5.png)](queue-centric-work-pattern/_static/image4.png)

<span data-ttu-id="e1b64-227">Dans la boîte de dialogue **nouveau service Cloud Azure** , développez le nœud **visuel C#**  dans le volet gauche.</span><span class="sxs-lookup"><span data-stu-id="e1b64-227">In the **New Azure Cloud Service** dialog, expand the **Visual C#** node on the left pane.</span></span> <span data-ttu-id="e1b64-228">Sélectionnez **rôle de travail** , puis cliquez sur l’icône de flèche droite.</span><span class="sxs-lookup"><span data-stu-id="e1b64-228">Select **Worker Role** and click the right-arrow icon.</span></span>

![](queue-centric-work-pattern/_static/image6.png)

<span data-ttu-id="e1b64-229">(Notez que vous pouvez également ajouter un *rôle Web*.</span><span class="sxs-lookup"><span data-stu-id="e1b64-229">(Notice that you can also add a *web role*.</span></span> <span data-ttu-id="e1b64-230">Nous pourrions exécuter le correctif frontal Fix it dans le même service Cloud au lieu de l’exécuter sur un site Web Azure.</span><span class="sxs-lookup"><span data-stu-id="e1b64-230">We could run the Fix It front-end in the same Cloud Service instead of running it in an Azure Web Site.</span></span> <span data-ttu-id="e1b64-231">Cela présente des avantages pour faciliter la coordination des connexions entre les serveurs frontaux et principaux.</span><span class="sxs-lookup"><span data-stu-id="e1b64-231">That has some advantages in making connections between front-end and back-end easier to coordinate.</span></span> <span data-ttu-id="e1b64-232">Toutefois, pour simplifier cette démonstration, nous conservons le frontal dans une application Web Azure App Service et n’exécutons que le serveur principal dans un service Cloud.)</span><span class="sxs-lookup"><span data-stu-id="e1b64-232">However, to keep this demo simple, we're keeping the front-end in an Azure App Service Web App and only running the back-end in a Cloud Service.)</span></span>

<span data-ttu-id="e1b64-233">Un nom par défaut est affecté au rôle de travail.</span><span class="sxs-lookup"><span data-stu-id="e1b64-233">A default name is assigned to the worker role.</span></span> <span data-ttu-id="e1b64-234">Pour modifier le nom, pointez la souris sur le rôle de travail dans le volet droit, puis cliquez sur l’icône en forme de crayon.</span><span class="sxs-lookup"><span data-stu-id="e1b64-234">To change the name, hover the mouse over the worker role in the right pane, then click the pencil icon.</span></span>

![](queue-centric-work-pattern/_static/image7.png)

<span data-ttu-id="e1b64-235">Cliquez sur **OK** pour terminer la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="e1b64-235">Click **OK** to complete the dialog.</span></span> <span data-ttu-id="e1b64-236">Cela ajoute deux projets à la solution Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e1b64-236">This adds two projects to the Visual Studio solution.</span></span>

- <span data-ttu-id="e1b64-237">projet Azure qui définit le service Cloud, y compris les informations de configuration.</span><span class="sxs-lookup"><span data-stu-id="e1b64-237">an Azure project that defines the cloud service, including configuration information.</span></span>
- <span data-ttu-id="e1b64-238">Projet de rôle de travail qui définit le rôle de travail.</span><span class="sxs-lookup"><span data-stu-id="e1b64-238">A worker role project that defines the worker role.</span></span>

![](queue-centric-work-pattern/_static/image8.png)

<span data-ttu-id="e1b64-239">Pour plus d’informations, consultez [création d’un projet Azure avec Visual Studio.](https://msdn.microsoft.com/library/windowsazure/ee405487.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1b64-239">For more information, see [Creating an Azure Project with Visual Studio.](https://msdn.microsoft.com/library/windowsazure/ee405487.aspx)</span></span>

<span data-ttu-id="e1b64-240">Dans le rôle de travail, nous interrogeons les messages en appelant la méthode `ProcessMessageAsync` de la classe `FixItQueueManager` que nous avons vu précédemment.</span><span class="sxs-lookup"><span data-stu-id="e1b64-240">Inside the worker role, we poll for messages by calling the `ProcessMessageAsync` method of the `FixItQueueManager` class that we saw earlier.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample3.cs?highlight=25)]

<span data-ttu-id="e1b64-241">La méthode `ProcessMessagesAsync` vérifie s’il y a un message en attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-241">The `ProcessMessagesAsync` method checks if there's a message waiting.</span></span> <span data-ttu-id="e1b64-242">S’il en existe un, il désérialise le message dans une entité `FixItTask` et enregistre l’entité dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="e1b64-242">If there is one, it deserializes the message into a `FixItTask` entity and saves the entity in the database.</span></span> <span data-ttu-id="e1b64-243">Il effectue une boucle jusqu’à ce que la file d’attente soit vide.</span><span class="sxs-lookup"><span data-stu-id="e1b64-243">It loops until the queue is empty.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample4.cs)]

<span data-ttu-id="e1b64-244">L’interrogation des messages de la file d’attente entraîne des frais de transaction réduits. par conséquent, lorsqu’il n’y a aucun message en attente de traitement, la méthode `RunAsync` du rôle de travail attend une seconde avant d’interroger à nouveau en appelant `Task.Delay(1000)`.</span><span class="sxs-lookup"><span data-stu-id="e1b64-244">Polling for queue messages incurs a small transaction charge, so when there's no message waiting to be processed, the worker role's `RunAsync` method waits a second before polling again by calling `Task.Delay(1000)`.</span></span>

<span data-ttu-id="e1b64-245">Dans un projet Web, l’ajout de code asynchrone peut automatiquement améliorer les performances, car IIS gère un pool de threads limité.</span><span class="sxs-lookup"><span data-stu-id="e1b64-245">In a web project, adding asynchronous code can automatically improve performance because IIS manages a limited thread pool.</span></span> <span data-ttu-id="e1b64-246">Ce n’est pas le cas dans un projet de rôle de travail.</span><span class="sxs-lookup"><span data-stu-id="e1b64-246">That is not the case in a worker role project.</span></span> <span data-ttu-id="e1b64-247">Pour améliorer l’extensibilité du rôle de travail, vous pouvez écrire du code multithread ou utiliser du code asynchrone pour implémenter la [programmation parallèle](https://msdn.microsoft.com/library/ff963553.aspx).</span><span class="sxs-lookup"><span data-stu-id="e1b64-247">To improve scalability of the worker role, you can write multi-threaded code or use asynchronous code to implement [parallel programming](https://msdn.microsoft.com/library/ff963553.aspx).</span></span> <span data-ttu-id="e1b64-248">L’exemple n’implémente pas la programmation parallèle, mais montre comment rendre le code asynchrone afin de pouvoir implémenter la programmation parallèle.</span><span class="sxs-lookup"><span data-stu-id="e1b64-248">The sample doesn't implement parallel programming but shows how to make the code asynchronous so you can implement parallel programming.</span></span>

## <a name="summary"></a><span data-ttu-id="e1b64-249">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="e1b64-249">Summary</span></span>

<span data-ttu-id="e1b64-250">Dans ce chapitre, vous avez vu comment améliorer la réactivité, la fiabilité et l’évolutivité des applications en implémentant le modèle de travail centré sur la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="e1b64-250">In this chapter you've seen how to improve application responsiveness, reliability, and scalability by implementing the queue-centric work pattern.</span></span>

<span data-ttu-id="e1b64-251">Il s’agit du dernier des 13 modèles couverts dans ce livre électronique, mais il existe bien sûr beaucoup d’autres modèles et pratiques qui peuvent vous aider à créer des applications Cloud efficaces.</span><span class="sxs-lookup"><span data-stu-id="e1b64-251">This is the last of the 13 patterns covered in this e-book, but there are of course many other patterns and practices that can help you build successful cloud apps.</span></span> <span data-ttu-id="e1b64-252">Le [chapitre final](more-patterns-and-guidance.md) fournit des liens vers des ressources pour les rubriques qui n’ont pas été couvertes dans ces 13 modèles.</span><span class="sxs-lookup"><span data-stu-id="e1b64-252">The [final chapter](more-patterns-and-guidance.md) provides links to resources for topics that haven't been covered in these 13 patterns.</span></span>

<a id="resources"></a>
## <a name="resources"></a><span data-ttu-id="e1b64-253">Ressources</span><span class="sxs-lookup"><span data-stu-id="e1b64-253">Resources</span></span>

<span data-ttu-id="e1b64-254">Pour plus d’informations sur les files d’attente, consultez les ressources suivantes.</span><span class="sxs-lookup"><span data-stu-id="e1b64-254">For more information about queues, see the following resources.</span></span>

<span data-ttu-id="e1b64-255">Documentation :</span><span class="sxs-lookup"><span data-stu-id="e1b64-255">Documentation:</span></span>

- <span data-ttu-id="e1b64-256">[Stockage Microsoft Azure files d’attente, partie 1 : prise en main](https://www.red-gate.com/simple-talk/cloud/platform-as-a-service/microsoft-azure-storage-queues-part-1-getting-started/).</span><span class="sxs-lookup"><span data-stu-id="e1b64-256">[Microsoft Azure Storage Queues Part 1: Getting Started](https://www.red-gate.com/simple-talk/cloud/platform-as-a-service/microsoft-azure-storage-queues-part-1-getting-started/).</span></span> <span data-ttu-id="e1b64-257">Article par chiffre romain Schacherl.</span><span class="sxs-lookup"><span data-stu-id="e1b64-257">Article by Roman Schacherl.</span></span>
- <span data-ttu-id="e1b64-258">[Exécution de tâches en arrière-plan](https://msdn.microsoft.com/library/ff803365.aspx), chapitre 5 de [déplacement d’applications vers le Cloud, 3ème édition](https://msdn.microsoft.com/library/ff728592.aspx) à partir de Microsoft Patterns and Practices.</span><span class="sxs-lookup"><span data-stu-id="e1b64-258">[Executing Background Tasks](https://msdn.microsoft.com/library/ff803365.aspx), chapter 5 of [Moving Applications to the Cloud, 3rd Edition](https://msdn.microsoft.com/library/ff728592.aspx) from Microsoft Patterns and Practices.</span></span> <span data-ttu-id="e1b64-259">(En particulier, la section [« utilisation des files d’attente stockage Azure »](https://msdn.microsoft.com/library/ff803365.aspx#sec7).)</span><span class="sxs-lookup"><span data-stu-id="e1b64-259">(In particular, the section ["Using Azure Storage Queues"](https://msdn.microsoft.com/library/ff803365.aspx#sec7).)</span></span>
- <span data-ttu-id="e1b64-260">[Meilleures pratiques pour optimiser l’évolutivité et la rentabilité des solutions de messagerie basée sur les files d’attente sur Azure](https://msdn.microsoft.com/library/windowsazure/hh697709.aspx).</span><span class="sxs-lookup"><span data-stu-id="e1b64-260">[Best Practices for Maximizing Scalability and Cost Effectiveness of Queue-Based Messaging Solutions on Azure](https://msdn.microsoft.com/library/windowsazure/hh697709.aspx).</span></span> <span data-ttu-id="e1b64-261">Livre blanc de Valery Mizonov.</span><span class="sxs-lookup"><span data-stu-id="e1b64-261">White paper by Valery Mizonov.</span></span>
- <span data-ttu-id="e1b64-262">[Comparaison entre les files d’attente Azure et les files d’attente Service bus](https://msdn.microsoft.com/magazine/jj159884.aspx).</span><span class="sxs-lookup"><span data-stu-id="e1b64-262">[Comparing Azure Queues and Service Bus Queues](https://msdn.microsoft.com/magazine/jj159884.aspx).</span></span> <span data-ttu-id="e1b64-263">L’article MSDN Magazine fournit des informations supplémentaires qui peuvent vous aider à choisir le service de file d’attente à utiliser.</span><span class="sxs-lookup"><span data-stu-id="e1b64-263">MSDN Magazine article, provides additional information that can help you choose which queue service to use.</span></span> <span data-ttu-id="e1b64-264">L’article indique que Service Bus dépend des services ACS pour l’authentification, ce qui signifie que vos files d’attente SB seraient indisponibles quand ACS n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="e1b64-264">The article mentions that Service Bus is dependent on ACS for authentication, which means your SB queues would be unavailable when ACS is unavailable.</span></span> <span data-ttu-id="e1b64-265">Toutefois, depuis l’écriture de l’article, SB a été modifié pour vous permettre d’utiliser des [jetons](https://msdn.microsoft.com/library/windowsazure/dn170477.aspx) SAP comme alternative à ACS.</span><span class="sxs-lookup"><span data-stu-id="e1b64-265">However, since the article was written, SB was changed to enable you to use [SAS tokens](https://msdn.microsoft.com/library/windowsazure/dn170477.aspx) as an alternative to ACS.</span></span>
- <span data-ttu-id="e1b64-266">[Modèles et pratiques Microsoft-conseils Azure](https://msdn.microsoft.com/library/dn568099.aspx).</span><span class="sxs-lookup"><span data-stu-id="e1b64-266">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="e1b64-267">Consultez initiation à la messagerie asynchrone, modèle de canaux et de filtres, modèle de transaction de compensation, modèle de consommateurs concurrents, modèle CQRS.</span><span class="sxs-lookup"><span data-stu-id="e1b64-267">See Asynchronous Messaging primer, Pipes and Filters pattern, Compensating Transaction pattern, Competing Consumers pattern, CQRS pattern.</span></span>
- <span data-ttu-id="e1b64-268">[Passage CQRS](https://msdn.microsoft.com/library/jj554200).</span><span class="sxs-lookup"><span data-stu-id="e1b64-268">[CQRS Journey](https://msdn.microsoft.com/library/jj554200).</span></span> <span data-ttu-id="e1b64-269">Livre électronique sur CQRS par Microsoft Patterns and Practices.</span><span class="sxs-lookup"><span data-stu-id="e1b64-269">E-book about CQRS by Microsoft Patterns and Practices.</span></span>

<span data-ttu-id="e1b64-270">Vidéo :</span><span class="sxs-lookup"><span data-stu-id="e1b64-270">Video:</span></span>

- <span data-ttu-id="e1b64-271">[Failsafe : création de services Cloud évolutifs et résilients](https://channel9.msdn.com/Series/FailSafe).</span><span class="sxs-lookup"><span data-stu-id="e1b64-271">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="e1b64-272">Série de vidéos en neuf parties par Ulrich Homann, Marc Mercuri et Mark SIMM.</span><span class="sxs-lookup"><span data-stu-id="e1b64-272">Nine-part video series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="e1b64-273">Présente des concepts de haut niveau et des principes architecturaux de manière très accessible et intéressante, avec des histoires tirées de l’expérience de l’équipe de conseil clientèle de Microsoft avec les clients réels.</span><span class="sxs-lookup"><span data-stu-id="e1b64-273">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="e1b64-274">Pour obtenir une présentation du service et des files d’attente Azure Storage, consultez épisode 5 à partir de 35:13.</span><span class="sxs-lookup"><span data-stu-id="e1b64-274">For an introduction to the Azure Storage service and queues, see episode 5 starting at 35:13.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e1b64-275">[Précédent](distributed-caching.md)
> [Suivant](more-patterns-and-guidance.md)</span><span class="sxs-lookup"><span data-stu-id="e1b64-275">[Previous](distributed-caching.md)
[Next](more-patterns-and-guidance.md)</span></span>
