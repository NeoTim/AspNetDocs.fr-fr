---
uid: single-page-application/overview/introduction/knockoutjs-template
title: 'Application à page unique : modèle KnockoutJS | Microsoft Docs'
author: MikeWasson
description: Modèle Knockout
ms.author: riande
ms.date: 01/30/2013
ms.assetid: f9c07af0-4b20-4b08-af8f-47fc3df169a2
msc.legacyurl: /single-page-application/overview/introduction/knockoutjs-template
msc.type: authoredcontent
ms.openlocfilehash: 3a551db1caa9636eb7f2e04c287d3ef371263584
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78578693"
---
# <a name="single-page-application-knockoutjs-template"></a><span data-ttu-id="06bd4-103">Application à page unique : modèle KnockoutJS</span><span class="sxs-lookup"><span data-stu-id="06bd4-103">Single Page Application: KnockoutJS template</span></span>

<span data-ttu-id="06bd4-104">par [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="06bd4-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

> <span data-ttu-id="06bd4-105">Le modèle MVC Knockout fait partie des ASP.NET et Web Tools 2012,2</span><span class="sxs-lookup"><span data-stu-id="06bd4-105">The Knockout MVC Template is part of ASP.NET and Web Tools 2012.2</span></span>
> 
> [<span data-ttu-id="06bd4-106">Télécharger ASP.NET et Web Tools 2012,2</span><span class="sxs-lookup"><span data-stu-id="06bd4-106">Download ASP.NET and Web Tools 2012.2</span></span>](https://go.microsoft.com/fwlink/?LinkId=282650)

<span data-ttu-id="06bd4-107">La mise à jour ASP.NET et Web Tools 2012,2 comprend un modèle d’application à page unique (SPA) pour ASP.NET MVC 4.</span><span class="sxs-lookup"><span data-stu-id="06bd4-107">The ASP.NET and Web Tools 2012.2 update includes a Single-Page Application (SPA) template for ASP.NET MVC 4.</span></span> <span data-ttu-id="06bd4-108">Ce modèle est conçu pour vous aider à créer rapidement des applications Web interactives côté client.</span><span class="sxs-lookup"><span data-stu-id="06bd4-108">This template is designed to get you started quickly building interactive client-side web apps.</span></span>

<span data-ttu-id="06bd4-109">« Une application à page unique » (SPA) est le terme général pour une application Web qui charge une seule page HTML, puis met à jour la page dynamiquement, au lieu de charger de nouvelles pages.</span><span class="sxs-lookup"><span data-stu-id="06bd4-109">"Single-page application" (SPA) is the general term for a web application that loads a single HTML page and then updates the page dynamically, instead of loading new pages.</span></span> <span data-ttu-id="06bd4-110">Après le chargement initial de la page, le SPA discute avec le serveur via des demandes AJAX.</span><span class="sxs-lookup"><span data-stu-id="06bd4-110">After the initial page load, the SPA talks with the server through AJAX requests.</span></span>

![](knockoutjs-template/_static/image1.png)

<span data-ttu-id="06bd4-111">AJAX n’est pas nouveau, mais aujourd’hui, il existe des infrastructures JavaScript qui facilitent la création et la maintenance d’une application SPA sophistiquée de grande taille.</span><span class="sxs-lookup"><span data-stu-id="06bd4-111">AJAX is nothing new, but today there are JavaScript frameworks that make it easier to build and maintain a large sophisticated SPA application.</span></span> <span data-ttu-id="06bd4-112">En outre, HTML 5 et CSS3 facilitent la création d’interfaces utilisateur riches.</span><span class="sxs-lookup"><span data-stu-id="06bd4-112">Also, HTML 5 and CSS3 are making it easier to create rich UIs.</span></span>

<span data-ttu-id="06bd4-113">Pour vous aider à démarrer, le modèle SPA crée un exemple d’application « liste des tâches ».</span><span class="sxs-lookup"><span data-stu-id="06bd4-113">To get you started, the SPA template creates a sample "To-do list" application.</span></span> <span data-ttu-id="06bd4-114">Dans ce didacticiel, nous allons suivre une visite guidée du modèle.</span><span class="sxs-lookup"><span data-stu-id="06bd4-114">In this tutorial, we'll take a guided tour of the template.</span></span> <span data-ttu-id="06bd4-115">Tout d’abord, nous allons examiner l’application de la liste des tâches, puis examiner les éléments technologiques qui le font fonctionner.</span><span class="sxs-lookup"><span data-stu-id="06bd4-115">First we'll look at the To-do list application itself, then examine the technology pieces that make it work.</span></span>

## <a name="create-a-new-spa-template-project"></a><span data-ttu-id="06bd4-116">Créer un projet de modèle SPA</span><span class="sxs-lookup"><span data-stu-id="06bd4-116">Create a New SPA Template Project</span></span>

<span data-ttu-id="06bd4-117">Configuration requise :</span><span class="sxs-lookup"><span data-stu-id="06bd4-117">Requirements:</span></span>

- <span data-ttu-id="06bd4-118">Visual Studio 2012 ou Visual Studio Express 2012 pour le Web</span><span class="sxs-lookup"><span data-stu-id="06bd4-118">Visual Studio 2012 or Visual Studio Express 2012 for Web</span></span>
- <span data-ttu-id="06bd4-119">ASP.NET Web Tools 2012,2 Update.</span><span class="sxs-lookup"><span data-stu-id="06bd4-119">ASP.NET Web Tools 2012.2 update.</span></span> <span data-ttu-id="06bd4-120">Vous pouvez installer la mise à jour [ici](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span><span class="sxs-lookup"><span data-stu-id="06bd4-120">You can install the update [here](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span></span>

<span data-ttu-id="06bd4-121">Démarrez Visual Studio et sélectionnez **nouveau projet** dans la page de démarrage.</span><span class="sxs-lookup"><span data-stu-id="06bd4-121">Start Visual Studio and select **New Project** from the Start page.</span></span> <span data-ttu-id="06bd4-122">Ou, dans le menu **fichier** , sélectionnez **nouveau** , puis **projet**.</span><span class="sxs-lookup"><span data-stu-id="06bd4-122">Or, from the **File** menu, select **New** and then **Project**.</span></span>

<span data-ttu-id="06bd4-123">Dans le volet **modèles** , sélectionnez **modèles installés** , puis développez le nœud **visuel C#**  .</span><span class="sxs-lookup"><span data-stu-id="06bd4-123">In the **Templates** pane, select **Installed Templates** and expand the **Visual C#** node.</span></span> <span data-ttu-id="06bd4-124">Sous **visuel C#** , sélectionnez **Web**.</span><span class="sxs-lookup"><span data-stu-id="06bd4-124">Under **Visual C#**, select **Web**.</span></span> <span data-ttu-id="06bd4-125">Dans la liste des modèles de projet, sélectionnez **application Web ASP.NET MVC 4**.</span><span class="sxs-lookup"><span data-stu-id="06bd4-125">In the list of project templates, select **ASP.NET MVC 4 Web Application**.</span></span> <span data-ttu-id="06bd4-126">Nommez le projet, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="06bd4-126">Name the project and click **OK**.</span></span>

![](knockoutjs-template/_static/image2.png)

<span data-ttu-id="06bd4-127">Dans l’Assistant **nouveau projet** , sélectionnez **application à page unique**.</span><span class="sxs-lookup"><span data-stu-id="06bd4-127">In the **New Project** wizard, select **Single Page Application**.</span></span>

![](knockoutjs-template/_static/image3.png)

<span data-ttu-id="06bd4-128">Appuyez sur F5 pour générer et exécuter l'application.</span><span class="sxs-lookup"><span data-stu-id="06bd4-128">Press F5 to build and run the application.</span></span> <span data-ttu-id="06bd4-129">Lorsque l’application s’exécute pour la première fois, elle affiche un écran de connexion.</span><span class="sxs-lookup"><span data-stu-id="06bd4-129">When the application first runs, it displays a login screen.</span></span>

![](knockoutjs-template/_static/image4.png)

<span data-ttu-id="06bd4-130">Cliquez sur le lien &quot;vous inscrire&quot; et créez un nouvel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="06bd4-130">Click the &quot;Sign up&quot; link and create a new user.</span></span>

![](knockoutjs-template/_static/image5.png)

<span data-ttu-id="06bd4-131">Une fois que vous êtes connecté, l’application crée une liste TODO par défaut avec deux éléments.</span><span class="sxs-lookup"><span data-stu-id="06bd4-131">After you log in, the application creates a default Todo list with two items.</span></span> <span data-ttu-id="06bd4-132">Vous pouvez cliquer sur « Ajouter une liste TODO » pour ajouter une nouvelle liste.</span><span class="sxs-lookup"><span data-stu-id="06bd4-132">You can click "Add Todo list" to add a new list.</span></span>

![](knockoutjs-template/_static/image6.png)

<span data-ttu-id="06bd4-133">Renommez la liste, ajoutez des éléments à la liste et vérifiez-les.</span><span class="sxs-lookup"><span data-stu-id="06bd4-133">Rename the list, add items to the list, and check them off.</span></span> <span data-ttu-id="06bd4-134">Vous pouvez également supprimer des éléments ou supprimer une liste entière.</span><span class="sxs-lookup"><span data-stu-id="06bd4-134">You can also delete items or delete an entire list.</span></span> <span data-ttu-id="06bd4-135">Les modifications sont automatiquement conservées dans une base de données sur le serveur (en réalité, la base de données locale à ce stade, car vous exécutez l’application localement).</span><span class="sxs-lookup"><span data-stu-id="06bd4-135">The changes are automatically persisted to a database on the server (actually LocalDB at this point, because you are running the application locally).</span></span>

![](knockoutjs-template/_static/image7.png)

## <a name="architecture-of-the-spa-template"></a><span data-ttu-id="06bd4-136">Architecture du modèle SPA</span><span class="sxs-lookup"><span data-stu-id="06bd4-136">Architecture of the SPA Template</span></span>

<span data-ttu-id="06bd4-137">Ce diagramme montre les principaux blocs de construction de l’application.</span><span class="sxs-lookup"><span data-stu-id="06bd4-137">This diagram shows the main building blocks for the application.</span></span>

![](knockoutjs-template/_static/image8.png)

<span data-ttu-id="06bd4-138">Côté serveur, ASP.NET MVC sert le HTML et gère également l’authentification basée sur les formulaires.</span><span class="sxs-lookup"><span data-stu-id="06bd4-138">On the server side, ASP.NET MVC serves the HTML and also handles forms-based authentication.</span></span>

<span data-ttu-id="06bd4-139">API Web ASP.NET gère toutes les demandes relatives à ToDoLists et ToDoItems, y compris l’obtention, la création, la mise à jour et la suppression.</span><span class="sxs-lookup"><span data-stu-id="06bd4-139">ASP.NET Web API handles all requests that relate to the ToDoLists and ToDoItems, including getting, creating, updating and deleting.</span></span> <span data-ttu-id="06bd4-140">Le client échange des données avec l’API Web au format JSON.</span><span class="sxs-lookup"><span data-stu-id="06bd4-140">The client exchanges data with Web API in JSON format.</span></span>

<span data-ttu-id="06bd4-141">Entity Framework (EF) est la couche O/RM.</span><span class="sxs-lookup"><span data-stu-id="06bd4-141">Entity Framework (EF) is the O/RM layer.</span></span> <span data-ttu-id="06bd4-142">Elle sert de base au monde orienté objet de ASP.NET et à la base de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="06bd4-142">It mediates between the object-oriented world of ASP.NET and the underlying database.</span></span> <span data-ttu-id="06bd4-143">La base de données utilise la base de données locale, mais vous pouvez la modifier dans le fichier Web. config.</span><span class="sxs-lookup"><span data-stu-id="06bd4-143">The database uses LocalDB but you can change this in the Web.config file.</span></span> <span data-ttu-id="06bd4-144">En général, vous utilisez la base de données locale pour le développement local, puis vous déployez sur une base de données SQL sur le serveur, à l’aide de la migration du code d’erreur EF.</span><span class="sxs-lookup"><span data-stu-id="06bd4-144">Typically you would use LocalDB for local development and then deploy to a SQL database on the server, using EF code-first migration.</span></span>

<span data-ttu-id="06bd4-145">Côté client, la bibliothèque Knockout. js gère les mises à jour de page à partir des demandes AJAX.</span><span class="sxs-lookup"><span data-stu-id="06bd4-145">On the client side, the Knockout.js library handles page updates from AJAX requests.</span></span> <span data-ttu-id="06bd4-146">Knockout utilise la liaison de données pour synchroniser la page avec les données les plus récentes.</span><span class="sxs-lookup"><span data-stu-id="06bd4-146">Knockout uses data binding to synchronize the page with the latest data.</span></span> <span data-ttu-id="06bd4-147">De cette façon, vous n’êtes pas obligé d’écrire le code qui parcourt les données JSON et met à jour le DOM.</span><span class="sxs-lookup"><span data-stu-id="06bd4-147">That way, you don't have to write any of the code that walks through the JSON data and updates the DOM.</span></span> <span data-ttu-id="06bd4-148">Au lieu de cela, vous placez des attributs déclaratifs dans le code HTML qui indiquent à Knockout comment présenter les données.</span><span class="sxs-lookup"><span data-stu-id="06bd4-148">Instead, you put declarative attributes in the HTML that tell Knockout how to present the data.</span></span>

<span data-ttu-id="06bd4-149">L’un des grands avantages de cette architecture est qu’elle sépare la couche de présentation de la logique d’application.</span><span class="sxs-lookup"><span data-stu-id="06bd4-149">A big advantage of this architecture is that it separates the presentation layer from the application logic.</span></span> <span data-ttu-id="06bd4-150">Vous pouvez créer la partie API Web sans connaître l’aspect de votre page Web.</span><span class="sxs-lookup"><span data-stu-id="06bd4-150">You can create the Web API portion without knowing anything about how your web page will look.</span></span> <span data-ttu-id="06bd4-151">Côté client, vous créez un « modèle de vue » pour représenter ces données, et le modèle de vue utilise Knockout pour effectuer une liaison au code HTML.</span><span class="sxs-lookup"><span data-stu-id="06bd4-151">On the client side, you create a "view model" to represent that data, and the view model uses Knockout to bind to the HTML.</span></span> <span data-ttu-id="06bd4-152">Cela vous permet de modifier facilement le code HTML sans modifier le modèle de vue.</span><span class="sxs-lookup"><span data-stu-id="06bd4-152">That lets you easily change the HTML without changing the view model.</span></span> <span data-ttu-id="06bd4-153">(Nous allons examiner Knockout un peu plus tard.)</span><span class="sxs-lookup"><span data-stu-id="06bd4-153">(We'll look at Knockout a bit later.)</span></span>

## <a name="models"></a><span data-ttu-id="06bd4-154">Modèles</span><span class="sxs-lookup"><span data-stu-id="06bd4-154">Models</span></span>

<span data-ttu-id="06bd4-155">Dans le projet Visual Studio, le dossier modèles contient les modèles qui sont utilisés côté serveur.</span><span class="sxs-lookup"><span data-stu-id="06bd4-155">In the Visual Studio project, the Models folder contains the models that are used on the server side.</span></span> <span data-ttu-id="06bd4-156">(Il existe également des modèles côté client ; nous allons y accéder.)</span><span class="sxs-lookup"><span data-stu-id="06bd4-156">(There are also models on the client side; we'll get to those.)</span></span>

![](knockoutjs-template/_static/image9.png)

<span data-ttu-id="06bd4-157">**TodoItem, TodoList**</span><span class="sxs-lookup"><span data-stu-id="06bd4-157">**TodoItem, TodoList**</span></span>

<span data-ttu-id="06bd4-158">Il s’agit des modèles de base de données pour Entity Framework Code First.</span><span class="sxs-lookup"><span data-stu-id="06bd4-158">These are the database models for Entity Framework Code First.</span></span> <span data-ttu-id="06bd4-159">Notez que ces modèles ont des propriétés qui pointent les unes vers les autres.</span><span class="sxs-lookup"><span data-stu-id="06bd4-159">Notice that these models have properties that point to each other.</span></span> <span data-ttu-id="06bd4-160">`ToDoList` contient une collection de ToDoItems, et chaque `ToDoItem` a une référence à son ToDoList parent.</span><span class="sxs-lookup"><span data-stu-id="06bd4-160">`ToDoList` contains a collection of ToDoItems, and each `ToDoItem` has a reference back to its parent ToDoList.</span></span> <span data-ttu-id="06bd4-161">Ces propriétés sont appelées propriétés de navigation, et représentent la relation un-à-plusieurs à la liste des tâches et à ses éléments de tâche.</span><span class="sxs-lookup"><span data-stu-id="06bd4-161">These properties are called navigation properties, and they represent the one-to-many relation a to-do list and its to-do items.</span></span>

<span data-ttu-id="06bd4-162">La classe `ToDoItem` utilise également l’attribut **[ForeignKey]** pour spécifier que `ToDoListId` est une clé étrangère dans la table `ToDoList`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-162">The `ToDoItem` class also uses the **[ForeignKey]** attribute to specify that `ToDoListId` is a foreign key into the `ToDoList` table.</span></span> <span data-ttu-id="06bd4-163">Ce code indique à EF d’ajouter une contrainte de clé étrangère à la base de données.</span><span class="sxs-lookup"><span data-stu-id="06bd4-163">This tells EF to add a foreign-key constraint to the database.</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample1.cs)]

<span data-ttu-id="06bd4-164">**TodoItemDto, TodoListDto**</span><span class="sxs-lookup"><span data-stu-id="06bd4-164">**TodoItemDto, TodoListDto**</span></span>

<span data-ttu-id="06bd4-165">Ces classes définissent les données qui seront envoyées au client.</span><span class="sxs-lookup"><span data-stu-id="06bd4-165">These classes define the data that will be sent to the client.</span></span> <span data-ttu-id="06bd4-166">« DTO » signifie « objet de transfert de données ».</span><span class="sxs-lookup"><span data-stu-id="06bd4-166">"DTO" stands for "data transfer object."</span></span> <span data-ttu-id="06bd4-167">Le DTO définit la manière dont les entités seront sérialisées en JSON.</span><span class="sxs-lookup"><span data-stu-id="06bd4-167">The DTO defines how the entities will be serialized into JSON.</span></span> <span data-ttu-id="06bd4-168">En général, il existe plusieurs raisons d’utiliser les DTO :</span><span class="sxs-lookup"><span data-stu-id="06bd4-168">In general, there are several reasons to use DTOs:</span></span>

- <span data-ttu-id="06bd4-169">Pour contrôler les propriétés qui sont sérialisées.</span><span class="sxs-lookup"><span data-stu-id="06bd4-169">To control which properties are serialized.</span></span> <span data-ttu-id="06bd4-170">Le DTO peut contenir un sous-ensemble des propriétés du modèle de domaine.</span><span class="sxs-lookup"><span data-stu-id="06bd4-170">The DTO can contain a subset of the properties from the domain model.</span></span> <span data-ttu-id="06bd4-171">Vous pouvez effectuer cette opération pour des raisons de sécurité (pour masquer des données sensibles) ou simplement pour réduire la quantité de données que vous envoyez.</span><span class="sxs-lookup"><span data-stu-id="06bd4-171">You might do this for security reasons (to hide sensitive data) or simply to reduce the amount of data that you send.</span></span>
- <span data-ttu-id="06bd4-172">Pour modifier la forme des données, par exemple pour aplatir une structure de données plus complexe.</span><span class="sxs-lookup"><span data-stu-id="06bd4-172">To change the shape of the data – e.g. to flatten a more complex data structure.</span></span>
- <span data-ttu-id="06bd4-173">Pour éviter toute logique métier du DTO (séparation des préoccupations).</span><span class="sxs-lookup"><span data-stu-id="06bd4-173">To keep any business logic out of the DTO (separation of concerns).</span></span>
- <span data-ttu-id="06bd4-174">Si vos modèles de domaine ne peuvent pas être sérialisés pour une raison quelconque.</span><span class="sxs-lookup"><span data-stu-id="06bd4-174">If your domain models cannot be serialized for some reason.</span></span> <span data-ttu-id="06bd4-175">Par exemple, les références circulaires peuvent provoquer des problèmes lors de la sérialisation d’un objet. il existe des façons de gérer ce problème dans l’API Web (consultez [gestion des références d’objets circulaires](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); Toutefois, l’utilisation d’un DTO évite tout simplement le problème.</span><span class="sxs-lookup"><span data-stu-id="06bd4-175">For example, circular references can cause problems when you serialize an object There are ways to handle this problem in Web API (see [Handling Circular Object References](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); but using a DTO simply avoids the problem altogether.</span></span>

<span data-ttu-id="06bd4-176">Dans le modèle SPA, les DTO contiennent les mêmes données que les modèles de domaine.</span><span class="sxs-lookup"><span data-stu-id="06bd4-176">In the SPA template, the DTOs contains the same data as the domain models.</span></span> <span data-ttu-id="06bd4-177">Toutefois, ils sont toujours utiles car ils évitent les références circulaires à partir des propriétés de navigation, et ils illustrent le modèle de DTO général.</span><span class="sxs-lookup"><span data-stu-id="06bd4-177">However, they are still useful because they avoid circular references from the navigation properties, and they demonstrate the general DTO pattern.</span></span>

<span data-ttu-id="06bd4-178">**AccountModels.cs**</span><span class="sxs-lookup"><span data-stu-id="06bd4-178">**AccountModels.cs**</span></span>

<span data-ttu-id="06bd4-179">Ce fichier contient des modèles pour l’appartenance à un site.</span><span class="sxs-lookup"><span data-stu-id="06bd4-179">This file contains models for site membership.</span></span> <span data-ttu-id="06bd4-180">La classe `UserProfile` définit le schéma des profils utilisateur dans la base de la BDD d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="06bd4-180">The `UserProfile` class defines the schema for user profiles in the membership DB.</span></span> <span data-ttu-id="06bd4-181">(Dans ce cas, la seule information est l’ID utilisateur et le nom d’utilisateur.) Les autres classes de modèle de ce fichier sont utilisées pour créer les formulaires d’inscription et de connexion de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="06bd4-181">(In this case, the only information is the user ID and the user name.) The other model classes in this file are used to create the user registration and login forms.</span></span>

## <a name="entity-framework"></a><span data-ttu-id="06bd4-182">Entity Framework</span><span class="sxs-lookup"><span data-stu-id="06bd4-182">Entity Framework</span></span>

<span data-ttu-id="06bd4-183">Le modèle SPA utilise EF Code First.</span><span class="sxs-lookup"><span data-stu-id="06bd4-183">The SPA template uses EF Code First.</span></span> <span data-ttu-id="06bd4-184">Dans Code First développement, vous définissez les modèles en premier dans le code, puis EF utilise le modèle pour créer la base de données.</span><span class="sxs-lookup"><span data-stu-id="06bd4-184">In Code First development, you define the models first in code, and then EF uses the model to create the database.</span></span> <span data-ttu-id="06bd4-185">Vous pouvez également utiliser EF avec une base de données existante ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span><span class="sxs-lookup"><span data-stu-id="06bd4-185">You can also use EF with an existing database ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span></span>

<span data-ttu-id="06bd4-186">La classe `TodoItemContext` dans le dossier Models dérive de **DbContext**.</span><span class="sxs-lookup"><span data-stu-id="06bd4-186">The `TodoItemContext` class in the Models folder derives from **DbContext**.</span></span> <span data-ttu-id="06bd4-187">Cette classe fournit le « collage » entre les modèles et EF.</span><span class="sxs-lookup"><span data-stu-id="06bd4-187">This class provides the "glue" between the models and EF.</span></span> <span data-ttu-id="06bd4-188">Le `TodoItemContext` contient une collection `ToDoItem` et une collection `TodoList`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-188">The `TodoItemContext` holds a `ToDoItem` collection and a `TodoList` collection.</span></span> <span data-ttu-id="06bd4-189">Pour interroger la base de données, il vous suffit d’écrire une requête LINQ sur ces collections.</span><span class="sxs-lookup"><span data-stu-id="06bd4-189">To query the database, you simply write a LINQ query against these collections.</span></span> <span data-ttu-id="06bd4-190">Par exemple, voici comment vous pouvez sélectionner toutes les listes de tâches pour l’utilisateur « Alice » :</span><span class="sxs-lookup"><span data-stu-id="06bd4-190">For example, here is how you can select all of the to-do lists for user "Alice":</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample2.cs)]

<span data-ttu-id="06bd4-191">Vous pouvez également ajouter de nouveaux éléments à la collection, mettre à jour des éléments ou supprimer des éléments de la collection et conserver les modifications apportées à la base de données.</span><span class="sxs-lookup"><span data-stu-id="06bd4-191">You can also add new items to the collection, update items, or delete items from the collection, and persist the changes to the database.</span></span>

## <a name="aspnet-web-api-controllers"></a><span data-ttu-id="06bd4-192">Contrôleurs de API Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="06bd4-192">ASP.NET Web API Controllers</span></span>

<span data-ttu-id="06bd4-193">Dans API Web ASP.NET, les contrôleurs sont des objets qui gèrent les requêtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="06bd4-193">In ASP.NET Web API, controllers are objects that handle HTTP requests.</span></span> <span data-ttu-id="06bd4-194">Comme mentionné précédemment, le modèle SPA utilise l’API Web pour activer les opérations CRUD sur les instances `ToDoList` et `ToDoItem`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-194">As mentioned, the SPA template uses Web API to enable CRUD operations on `ToDoList` and `ToDoItem` instances.</span></span> <span data-ttu-id="06bd4-195">Les contrôleurs se trouvent dans le dossier Controllers de la solution.</span><span class="sxs-lookup"><span data-stu-id="06bd4-195">The controllers are located in the Controllers folder of the solution.</span></span>

![](knockoutjs-template/_static/image10.png)

- <span data-ttu-id="06bd4-196">`TodoController`: gère les requêtes HTTP pour les éléments de tâche</span><span class="sxs-lookup"><span data-stu-id="06bd4-196">`TodoController`: Handles HTTP requests for to-do items</span></span>
- <span data-ttu-id="06bd4-197">`TodoListController`: gère les requêtes HTTP pour les listes de tâches.</span><span class="sxs-lookup"><span data-stu-id="06bd4-197">`TodoListController`: Handles HTTP requests for to-do lists.</span></span>

<span data-ttu-id="06bd4-198">Ces noms sont significatifs, car l’API Web correspond au chemin d’accès de l’URI au nom du contrôleur.</span><span class="sxs-lookup"><span data-stu-id="06bd4-198">These names are significant, because Web API matches the URI path to the controller name.</span></span> <span data-ttu-id="06bd4-199">(Pour savoir comment l’API Web achemine les requêtes HTTP vers les contrôleurs, consultez [routage dans API Web ASP.net](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span><span class="sxs-lookup"><span data-stu-id="06bd4-199">(To learn how Web API routes HTTP requests to controllers, see [Routing in ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span></span>

<span data-ttu-id="06bd4-200">Examinons la classe `ToDoListController`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-200">Let's look at the `ToDoListController` class.</span></span> <span data-ttu-id="06bd4-201">Il contient un membre de données unique :</span><span class="sxs-lookup"><span data-stu-id="06bd4-201">It contains a single data member:</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample3.cs)]

<span data-ttu-id="06bd4-202">Le `TodoItemContext` est utilisé pour communiquer avec EF, comme décrit précédemment.</span><span class="sxs-lookup"><span data-stu-id="06bd4-202">The `TodoItemContext` is used to communicate with EF, as described earlier.</span></span> <span data-ttu-id="06bd4-203">Les méthodes sur le contrôleur implémentent les opérations CRUD.</span><span class="sxs-lookup"><span data-stu-id="06bd4-203">The methods on the controller implement the CRUD operations.</span></span> <span data-ttu-id="06bd4-204">L’API Web mappe les requêtes HTTP du client aux méthodes du contrôleur, comme suit :</span><span class="sxs-lookup"><span data-stu-id="06bd4-204">Web API maps HTTP requests from the client to controller methods, as follows:</span></span>

| <span data-ttu-id="06bd4-205">Demande HTTP</span><span class="sxs-lookup"><span data-stu-id="06bd4-205">HTTP Request</span></span> | <span data-ttu-id="06bd4-206">Méthode du contrôleur</span><span class="sxs-lookup"><span data-stu-id="06bd4-206">Controller Method</span></span> | <span data-ttu-id="06bd4-207">Description</span><span class="sxs-lookup"><span data-stu-id="06bd4-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="06bd4-208">GET /api/todo</span><span class="sxs-lookup"><span data-stu-id="06bd4-208">GET /api/todo</span></span> | `GetTodoLists` | <span data-ttu-id="06bd4-209">Obtient une collection de listes de tâches.</span><span class="sxs-lookup"><span data-stu-id="06bd4-209">Gets a collection of to-do lists.</span></span> |
| <span data-ttu-id="06bd4-210">Obtient l'*ID* /API/TODO/</span><span class="sxs-lookup"><span data-stu-id="06bd4-210">GET /api/todo/*id*</span></span> | `GetTodoList` | <span data-ttu-id="06bd4-211">Obtient une liste de tâches par ID</span><span class="sxs-lookup"><span data-stu-id="06bd4-211">Gets a to-do list by ID</span></span> |
| <span data-ttu-id="06bd4-212">*ID* /API/todo/put</span><span class="sxs-lookup"><span data-stu-id="06bd4-212">PUT /api/todo/*id*</span></span> | `PutTodoList` | <span data-ttu-id="06bd4-213">Met à jour une liste de tâches.</span><span class="sxs-lookup"><span data-stu-id="06bd4-213">Updates a to-do list.</span></span> |
| <span data-ttu-id="06bd4-214">POST /api/todo</span><span class="sxs-lookup"><span data-stu-id="06bd4-214">POST /api/todo</span></span> | `PostTodoList` | <span data-ttu-id="06bd4-215">Crée une liste des tâches.</span><span class="sxs-lookup"><span data-stu-id="06bd4-215">Creates a new to-do list.</span></span> |
| <span data-ttu-id="06bd4-216">SUPPRIMER l'*ID* /API/TODO/</span><span class="sxs-lookup"><span data-stu-id="06bd4-216">DELETE /api/todo/*id*</span></span> | `DeleteTodoList` | <span data-ttu-id="06bd4-217">Supprime une liste TODO.</span><span class="sxs-lookup"><span data-stu-id="06bd4-217">Deletes a TODO list.</span></span> |

<span data-ttu-id="06bd4-218">Notez que les URI de certaines opérations contiennent des espaces réservés pour la valeur d’ID.</span><span class="sxs-lookup"><span data-stu-id="06bd4-218">Notice that the URIs for some operations contain placeholders for the ID value.</span></span> <span data-ttu-id="06bd4-219">Par exemple, pour supprimer une liste à l’aide de l’ID 42, l’URI est `/api/todo/42`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-219">For example, to delete a to-list with an ID of 42, the URI is `/api/todo/42`.</span></span>

<span data-ttu-id="06bd4-220">Pour en savoir plus sur l’utilisation de l’API Web pour les opérations CRUD, consultez [création d’une API Web qui prend en charge les opérations CRUD](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span><span class="sxs-lookup"><span data-stu-id="06bd4-220">To learn more about using Web API for CRUD operations, see [Creating a Web API that Supports CRUD Operations](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span></span> <span data-ttu-id="06bd4-221">Le code de ce contrôleur est relativement simple.</span><span class="sxs-lookup"><span data-stu-id="06bd4-221">The code for this controller is fairly straightforward.</span></span> <span data-ttu-id="06bd4-222">Voici quelques points intéressants :</span><span class="sxs-lookup"><span data-stu-id="06bd4-222">Here are some interesting points:</span></span>

- <span data-ttu-id="06bd4-223">La méthode `GetTodoLists` utilise une requête LINQ pour filtrer les résultats en utilisant l’ID de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="06bd4-223">The `GetTodoLists` method uses a LINQ query to filter the results by the ID of the logged-in user.</span></span> <span data-ttu-id="06bd4-224">De cette façon, un utilisateur voit uniquement les données qui lui appartiennent.</span><span class="sxs-lookup"><span data-stu-id="06bd4-224">That way, a user only sees the data that belongs to him or her.</span></span> <span data-ttu-id="06bd4-225">Notez également qu’une instruction SELECT est utilisée pour convertir les instances `ToDoList` en instances `TodoListDto`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-225">Also, notice that a Select statement is used to convert the `ToDoList` instances into `TodoListDto` instances.</span></span>
- <span data-ttu-id="06bd4-226">Les méthodes PUT et poster vérifient l’état du modèle avant de modifier la base de données.</span><span class="sxs-lookup"><span data-stu-id="06bd4-226">The PUT and POST methods check the model state before modifying the database.</span></span> <span data-ttu-id="06bd4-227">Si **ModelState. IsValid** a la valeur false, ces méthodes retournent http 400, requête incorrecte.</span><span class="sxs-lookup"><span data-stu-id="06bd4-227">If **ModelState.IsValid** is false, these methods return HTTP 400, Bad Request.</span></span> <span data-ttu-id="06bd4-228">Pour en savoir plus sur la validation de modèle dans l’API Web, consultez [validation de modèle](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="06bd4-228">Read more about model validation in Web API at [Model Validation](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span></span>
- <span data-ttu-id="06bd4-229">La classe Controller est également décorée avec l’attribut **[Authorize]** .</span><span class="sxs-lookup"><span data-stu-id="06bd4-229">The controller class is also decorated with the **[Authorize]** attribute.</span></span> <span data-ttu-id="06bd4-230">Cet attribut vérifie si la requête HTTP est authentifiée.</span><span class="sxs-lookup"><span data-stu-id="06bd4-230">This attribute checks whether the HTTP request is authenticated.</span></span> <span data-ttu-id="06bd4-231">Si la demande n’est pas authentifiée, le client reçoit le protocole HTTP 401, non autorisé.</span><span class="sxs-lookup"><span data-stu-id="06bd4-231">If the request is not authenticated, the client receives HTTP 401, Unauthorized.</span></span> <span data-ttu-id="06bd4-232">Pour plus d’informations sur l’authentification [, consultez authentification et autorisation dans API Web ASP.net](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="06bd4-232">Read more about authentication at [Authentication and Authorization in ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span></span>

<span data-ttu-id="06bd4-233">La classe `TodoController` est très similaire à `TodoListController`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-233">The `TodoController` class is very similar to `TodoListController`.</span></span> <span data-ttu-id="06bd4-234">La plus grande différence est qu’elle ne définit pas de méthode d’extraction, car le client obtiendra les éléments de tâche avec chaque liste de tâches.</span><span class="sxs-lookup"><span data-stu-id="06bd4-234">The biggest difference is that it does not define any GET methods, because the client will get the to-do items along with each to-do list.</span></span>

## <a name="mvc-controllers-and-views"></a><span data-ttu-id="06bd4-235">Contrôleurs et vues MVC</span><span class="sxs-lookup"><span data-stu-id="06bd4-235">MVC Controllers and Views</span></span>

<span data-ttu-id="06bd4-236">Les contrôleurs MVC se trouvent également dans le dossier Controllers de la solution.</span><span class="sxs-lookup"><span data-stu-id="06bd4-236">The MVC controllers are also located in the Controllers folder of the solution.</span></span> <span data-ttu-id="06bd4-237">`HomeController` restitue le code HTML principal pour l’application.</span><span class="sxs-lookup"><span data-stu-id="06bd4-237">`HomeController` renders the main HTML for the application.</span></span> <span data-ttu-id="06bd4-238">La vue du contrôleur d’hébergement est définie dans views/orig/index. cshtml.</span><span class="sxs-lookup"><span data-stu-id="06bd4-238">The view for the Home controller is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="06bd4-239">La vue d’hébergement affiche un contenu différent selon que l’utilisateur a ouvert une session ou non :</span><span class="sxs-lookup"><span data-stu-id="06bd4-239">The Home view renders different content depending on whether the user is logged in:</span></span>

[!code-cshtml[Main](knockoutjs-template/samples/sample4.cshtml)]

<span data-ttu-id="06bd4-240">Lorsque les utilisateurs sont connectés, ils voient l’interface utilisateur principale.</span><span class="sxs-lookup"><span data-stu-id="06bd4-240">When users are logged in, they see the main UI.</span></span> <span data-ttu-id="06bd4-241">Dans le cas contraire, ils voient le panneau de connexion.</span><span class="sxs-lookup"><span data-stu-id="06bd4-241">Otherwise, they see the login panel.</span></span> <span data-ttu-id="06bd4-242">Notez que ce rendu conditionnel se produit côté serveur.</span><span class="sxs-lookup"><span data-stu-id="06bd4-242">Note that this conditional rendering happens on the server side.</span></span> <span data-ttu-id="06bd4-243">N’essayez jamais de masquer le contenu sensible côté&#8212;client tout ce que vous envoyez dans une réponse http est visible par une personne qui surveille les messages http bruts.</span><span class="sxs-lookup"><span data-stu-id="06bd4-243">Never try to hide sensitive content on the client side&#8212;anything that you send in an HTTP response is visible to someone who is watching the raw HTTP messages.</span></span>

## <a name="client-side-javascript-and-knockoutjs"></a><span data-ttu-id="06bd4-244">JavaScript côté client et Knockout. js</span><span class="sxs-lookup"><span data-stu-id="06bd4-244">Client-Side JavaScript and Knockout.js</span></span>

<span data-ttu-id="06bd4-245">Passons à présent du côté serveur de l’application au client.</span><span class="sxs-lookup"><span data-stu-id="06bd4-245">Now let's turn from the server side of the application to the client.</span></span> <span data-ttu-id="06bd4-246">Le modèle SPA utilise une combinaison de jQuery et Knockout. js pour créer une interface utilisateur fluide et interactive.</span><span class="sxs-lookup"><span data-stu-id="06bd4-246">The SPA template uses a combination of jQuery and Knockout.js to create a smooth, interactive UI.</span></span> <span data-ttu-id="06bd4-247">Knockout. js est une bibliothèque JavaScript qui facilite la liaison du code HTML aux données.</span><span class="sxs-lookup"><span data-stu-id="06bd4-247">Knockout.js is a JavaScript library that makes it easy to bind HTML to data.</span></span> <span data-ttu-id="06bd4-248">Knockout. js utilise un modèle appelé « Model-View-ViewModel ».</span><span class="sxs-lookup"><span data-stu-id="06bd4-248">Knockout.js uses a pattern called "Model-View-ViewModel."</span></span>

- <span data-ttu-id="06bd4-249">Le modèle est les données de domaine (listes de tâches et éléments ToDo).</span><span class="sxs-lookup"><span data-stu-id="06bd4-249">The model is the domain data (ToDo lists and ToDo items).</span></span>
- <span data-ttu-id="06bd4-250">La vue est le document HTML.</span><span class="sxs-lookup"><span data-stu-id="06bd4-250">The view is the HTML document.</span></span>
- <span data-ttu-id="06bd4-251">Le modèle d’affichage est un objet JavaScript qui contient les données du modèle.</span><span class="sxs-lookup"><span data-stu-id="06bd4-251">The view-model is a JavaScript object that holds the model data.</span></span> <span data-ttu-id="06bd4-252">Le modèle d’affichage est une abstraction du code de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="06bd4-252">The view-model is a code abstraction of the UI.</span></span> <span data-ttu-id="06bd4-253">Il n’a aucune connaissance de la représentation HTML.</span><span class="sxs-lookup"><span data-stu-id="06bd4-253">It has no knowledge of the HTML representation.</span></span> <span data-ttu-id="06bd4-254">Au lieu de cela, il représente des fonctionnalités abstraites de la vue, telles que « une liste d’éléments ToDo ».</span><span class="sxs-lookup"><span data-stu-id="06bd4-254">Instead, it represents abstract features of the view, such as "a list of ToDo items".</span></span>

<span data-ttu-id="06bd4-255">La vue est liée aux données du modèle d’affichage.</span><span class="sxs-lookup"><span data-stu-id="06bd4-255">The view is data-bound to the view-model.</span></span> <span data-ttu-id="06bd4-256">Les mises à jour du modèle d’affichage sont automatiquement reflétées dans la vue.</span><span class="sxs-lookup"><span data-stu-id="06bd4-256">Updates to the view-model are automatically reflected in the view.</span></span> <span data-ttu-id="06bd4-257">Les liaisons fonctionnent également dans l’autre direction.</span><span class="sxs-lookup"><span data-stu-id="06bd4-257">Bindings work the other direction as well.</span></span> <span data-ttu-id="06bd4-258">Les événements dans le DOM (tels que les clics) sont liés aux fonctions sur le modèle de vue, qui déclenchent des appels AJAX.</span><span class="sxs-lookup"><span data-stu-id="06bd4-258">Events in the DOM (such as clicks) are data-bound to functions on the view model, which trigger AJAX calls.</span></span>

<span data-ttu-id="06bd4-259">Le modèle SPA organise le code JavaScript côté client en trois couches :</span><span class="sxs-lookup"><span data-stu-id="06bd4-259">The SPA template organizes the client-side JavaScript into three layers:</span></span>

- <span data-ttu-id="06bd4-260">TODO. DataContext. js : envoie des demandes AJAX.</span><span class="sxs-lookup"><span data-stu-id="06bd4-260">todo.datacontext.js: Sends AJAX requests.</span></span>
- <span data-ttu-id="06bd4-261">TODO. Model. js : définit les modèles.</span><span class="sxs-lookup"><span data-stu-id="06bd4-261">todo.model.js: Defines the models.</span></span>
- <span data-ttu-id="06bd4-262">TODO. ViewModel. js : définit le modèle de vue.</span><span class="sxs-lookup"><span data-stu-id="06bd4-262">todo.viewmodel.js: Defines the view model.</span></span>

![](knockoutjs-template/_static/image11.png)

<span data-ttu-id="06bd4-263">Ces fichiers de script se trouvent dans le dossier scripts/app de la solution.</span><span class="sxs-lookup"><span data-stu-id="06bd4-263">These script files are located in the Scripts/app folder of the solution.</span></span>

![](knockoutjs-template/_static/image12.png)

<span data-ttu-id="06bd4-264">**TODO. DataContext** gère tous les appels AJAX aux contrôleurs d’API Web.</span><span class="sxs-lookup"><span data-stu-id="06bd4-264">**todo.datacontext** handles all AJAX calls to the Web API controllers.</span></span> <span data-ttu-id="06bd4-265">(Les appels AJAX pour la connexion sont définis ailleurs, dans ajaxLogin. js.)</span><span class="sxs-lookup"><span data-stu-id="06bd4-265">(The AJAX calls for logging in are defined elsewhere, in ajaxlogin.js.)</span></span>

<span data-ttu-id="06bd4-266">**TODO. Model. js** définit les modèles côté client (navigateur) pour les listes de tâches.</span><span class="sxs-lookup"><span data-stu-id="06bd4-266">**todo.model.js** defines the client-side (browser) models for the to-do lists.</span></span> <span data-ttu-id="06bd4-267">Il existe deux classes de modèle : todoItem et todoList.</span><span class="sxs-lookup"><span data-stu-id="06bd4-267">There are two model classes: todoItem and todoList.</span></span>

<span data-ttu-id="06bd4-268">La plupart des propriétés des classes de modèle sont de type « Ko. observable ».</span><span class="sxs-lookup"><span data-stu-id="06bd4-268">Many of the properties in the model classes are of type "ko.observable".</span></span> <span data-ttu-id="06bd4-269">Observables est la manière dont Knockout effectue sa magie.</span><span class="sxs-lookup"><span data-stu-id="06bd4-269">Observables are how Knockout does its magic.</span></span> <span data-ttu-id="06bd4-270">À partir de la [documentation Knockout](http://knockoutjs.com/documentation/introduction.html): un observable est un « objet JavaScript qui peut notifier les modifications aux abonnés. »</span><span class="sxs-lookup"><span data-stu-id="06bd4-270">From the [Knockout documentation](http://knockoutjs.com/documentation/introduction.html): An observable is a "JavaScript object that can notify subscribers about changes."</span></span> <span data-ttu-id="06bd4-271">Lorsque la valeur d’un observable change, Knockout met à jour tous les éléments HTML liés à ces observables.</span><span class="sxs-lookup"><span data-stu-id="06bd4-271">When the value of an observable changes, Knockout updates any HTML elements that are bound to those observables.</span></span> <span data-ttu-id="06bd4-272">Par exemple, todoItem a observables pour les propriétés Title et isDone :</span><span class="sxs-lookup"><span data-stu-id="06bd4-272">For example, todoItem has observables for the title and isDone properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample5.js)]

<span data-ttu-id="06bd4-273">Vous pouvez également vous abonner à un observable dans le code.</span><span class="sxs-lookup"><span data-stu-id="06bd4-273">You can also subscribe to an observable in code.</span></span> <span data-ttu-id="06bd4-274">Par exemple, la classe todoItem s’abonne aux modifications apportées aux propriétés « isDone » et « title » :</span><span class="sxs-lookup"><span data-stu-id="06bd4-274">For example, the todoItem class subscribes to changes in the "isDone" and "title" properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample6.js)]

<span data-ttu-id="06bd4-275">**Afficher le modèle**</span><span class="sxs-lookup"><span data-stu-id="06bd4-275">**View Model**</span></span>

<span data-ttu-id="06bd4-276">Le modèle de vue est défini dans todo. ViewModel. js.</span><span class="sxs-lookup"><span data-stu-id="06bd4-276">The view model is defined in todo.viewmodel.js.</span></span> <span data-ttu-id="06bd4-277">Le modèle de vue est le point central où l’application lie les éléments de page HTML aux données de domaine.</span><span class="sxs-lookup"><span data-stu-id="06bd4-277">The view model is the central point where the application binds the HTML page elements to the domain data.</span></span> <span data-ttu-id="06bd4-278">Dans le modèle SPA, le modèle de vue contient un tableau observable de todoLists.</span><span class="sxs-lookup"><span data-stu-id="06bd4-278">In the SPA template, the view model contains an observable array of todoLists.</span></span> <span data-ttu-id="06bd4-279">Le code suivant dans le modèle de vue indique à Knockout d’appliquer les liaisons :</span><span class="sxs-lookup"><span data-stu-id="06bd4-279">The following code in the view model tells Knockout to apply the bindings:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample7.js)]

## <a name="html-and-data-binding"></a><span data-ttu-id="06bd4-280">Liaison de données et HTML</span><span class="sxs-lookup"><span data-stu-id="06bd4-280">HTML and Data Binding</span></span>

<span data-ttu-id="06bd4-281">Le code HTML principal de la page est défini dans views/orig/index. cshtml.</span><span class="sxs-lookup"><span data-stu-id="06bd4-281">The main HTML for the page is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="06bd4-282">Étant donné que nous utilisons la liaison de données, le code HTML est uniquement un modèle pour ce qui est réellement rendu.</span><span class="sxs-lookup"><span data-stu-id="06bd4-282">Because we are using data-binding, the HTML is only a template for what actually gets rendered.</span></span> <span data-ttu-id="06bd4-283">Knockout utilise des liaisons *déclaratives* .</span><span class="sxs-lookup"><span data-stu-id="06bd4-283">Knockout uses *declarative* bindings.</span></span> <span data-ttu-id="06bd4-284">Vous liez des éléments de page à des données en ajoutant un attribut « Data-bind » à l’élément.</span><span class="sxs-lookup"><span data-stu-id="06bd4-284">You bind page elements to data by adding a "data-bind" attribute to the element.</span></span> <span data-ttu-id="06bd4-285">Voici un exemple très simple tiré de la documentation Knockout :</span><span class="sxs-lookup"><span data-stu-id="06bd4-285">Here is a very simple example, taken from the Knockout documentation:</span></span>

[!code-html[Main](knockoutjs-template/samples/sample8.html)]

<span data-ttu-id="06bd4-286">Dans cet exemple, Knockout met à jour le contenu de l’élément **&lt;span&gt;** avec la valeur de `myItems.count()`.</span><span class="sxs-lookup"><span data-stu-id="06bd4-286">In this example, Knockout updates the contents of the **&lt;span&gt;** element with the value of `myItems.count()`.</span></span> <span data-ttu-id="06bd4-287">Chaque fois que cette valeur change, Knockout met à jour le document.</span><span class="sxs-lookup"><span data-stu-id="06bd4-287">Whenever this value changes, Knockout updates the document.</span></span>

<span data-ttu-id="06bd4-288">Knockout fournit un certain nombre de types de liaison différents.</span><span class="sxs-lookup"><span data-stu-id="06bd4-288">Knockout provides a number of different binding types.</span></span> <span data-ttu-id="06bd4-289">Voici quelques-unes des liaisons utilisées dans le modèle SPA :</span><span class="sxs-lookup"><span data-stu-id="06bd4-289">Here are some of the bindings used in the SPA template:</span></span>

- <span data-ttu-id="06bd4-290">**foreach**: vous permet d’itérer au sein d’une boucle et d’appliquer la même balise à chaque élément de la liste.</span><span class="sxs-lookup"><span data-stu-id="06bd4-290">**foreach**: Lets you iterate through a loop and apply the same markup to each item in the list.</span></span> <span data-ttu-id="06bd4-291">Il est utilisé pour restituer les listes de tâches et les éléments de tâche.</span><span class="sxs-lookup"><span data-stu-id="06bd4-291">This is used to render the to-do lists and to-do items.</span></span> <span data-ttu-id="06bd4-292">Dans le **foreach**, les liaisons sont appliquées aux éléments de la liste.</span><span class="sxs-lookup"><span data-stu-id="06bd4-292">Within the **foreach**, the bindings are applied to the elements of the list.</span></span>
- <span data-ttu-id="06bd4-293">**visible**: permet d’activer/de désactiver la visibilité.</span><span class="sxs-lookup"><span data-stu-id="06bd4-293">**visible**: Used to toggle visibility.</span></span> <span data-ttu-id="06bd4-294">Masquer le balisage lorsqu’une collection est vide ou rendre visible le message d’erreur.</span><span class="sxs-lookup"><span data-stu-id="06bd4-294">Hide markup when a collection is empty, or make the error message visible.</span></span>
- <span data-ttu-id="06bd4-295">**valeur**: utilisée pour remplir les valeurs de formulaire.</span><span class="sxs-lookup"><span data-stu-id="06bd4-295">**value**: Used to populate form values.</span></span>
- <span data-ttu-id="06bd4-296">**Click**: lie un événement Click à une fonction sur le modèle de vue.</span><span class="sxs-lookup"><span data-stu-id="06bd4-296">**click**: Binds a click event to a function on the view model.</span></span>

## <a name="anti-csrf-protection"></a><span data-ttu-id="06bd4-297">Protection anti-CSRF</span><span class="sxs-lookup"><span data-stu-id="06bd4-297">Anti-CSRF Protection</span></span>

<span data-ttu-id="06bd4-298">La falsification de requête intersites (CSRF) est une attaque dans laquelle un site malveillant envoie une demande à un site vulnérable dans lequel l’utilisateur est actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="06bd4-298">Cross-Site Request Forgery (CSRF) is an attack where a malicious site sends a request to a vulnerable site where the user is currently logged in.</span></span> <span data-ttu-id="06bd4-299">Pour prévenir les attaques CSRF, ASP.NET MVC utilise des *jetons anti-contrefaçon*, également appelés jetons de vérification de demande.</span><span class="sxs-lookup"><span data-stu-id="06bd4-299">To help prevent CSRF attacks, ASP.NET MVC uses *anti-forgery tokens*, also called request verification tokens.</span></span> <span data-ttu-id="06bd4-300">L’idée est que le serveur place un jeton généré de manière aléatoire dans une page Web.</span><span class="sxs-lookup"><span data-stu-id="06bd4-300">The idea is that the server puts a randomly generated token into a web page.</span></span> <span data-ttu-id="06bd4-301">Lorsque le client envoie des données au serveur, il doit inclure cette valeur dans le message de demande.</span><span class="sxs-lookup"><span data-stu-id="06bd4-301">When the client submits data to the server, it must include this value in the request message.</span></span>

<span data-ttu-id="06bd4-302">Les jetons anti-contrefaçon fonctionnent parce que la page malveillante ne peut pas lire les jetons de l’utilisateur, en raison des stratégies de même origine.</span><span class="sxs-lookup"><span data-stu-id="06bd4-302">Anti-forgery tokens work because the malicious page cannot read the user's tokens, due to same-origin policies.</span></span> <span data-ttu-id="06bd4-303">(Les stratégies de même origine empêchent les documents hébergés sur deux sites différents d’accéder au contenu de l’autre.)</span><span class="sxs-lookup"><span data-stu-id="06bd4-303">(Same-origin policies prevent documents hosted on two different sites from accessing each other's content.)</span></span>

<span data-ttu-id="06bd4-304">ASP.NET MVC offre une prise en charge intégrée des jetons anti-contrefaçon, par le biais de la classe anti- [contrefaçon](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) et de l’attribut [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) .</span><span class="sxs-lookup"><span data-stu-id="06bd4-304">ASP.NET MVC provides built-in support for anti-forgery tokens, through the [AntiForgery](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) class and the [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) attribute.</span></span> <span data-ttu-id="06bd4-305">Actuellement, cette fonctionnalité n’est pas intégrée à l’API Web.</span><span class="sxs-lookup"><span data-stu-id="06bd4-305">Currently, this functionality is not built into Web API.</span></span> <span data-ttu-id="06bd4-306">Toutefois, le modèle SPA comprend une implémentation personnalisée pour l’API Web.</span><span class="sxs-lookup"><span data-stu-id="06bd4-306">However, the SPA template includes a custom implementation for Web API.</span></span> <span data-ttu-id="06bd4-307">Ce code est défini dans la classe `ValidateHttpAntiForgeryTokenAttribute`, qui se trouve dans le dossier Filters de la solution.</span><span class="sxs-lookup"><span data-stu-id="06bd4-307">This code is defined in the `ValidateHttpAntiForgeryTokenAttribute` class, which is located in the Filters folder of the solution.</span></span> <span data-ttu-id="06bd4-308">Pour en savoir plus sur l’anti-CSRF dans l’API Web, consultez [prévention des attaques de falsification de requête intersite (CSRF)](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span><span class="sxs-lookup"><span data-stu-id="06bd4-308">To learn more about anti-CSRF in Web API, see [Preventing Cross-Site Request Forgery (CSRF) Attacks](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="06bd4-309">Conclusion</span><span class="sxs-lookup"><span data-stu-id="06bd4-309">Conclusion</span></span>

<span data-ttu-id="06bd4-310">Le modèle SPA est conçu pour vous permettre de commencer rapidement à écrire des applications Web modernes et interactives.</span><span class="sxs-lookup"><span data-stu-id="06bd4-310">The SPA template is designed to get you started quickly writing modern, interactive web applications.</span></span> <span data-ttu-id="06bd4-311">Elle utilise la bibliothèque Knockout. js pour séparer la présentation (balisage HTML) de la logique de données et de l’application.</span><span class="sxs-lookup"><span data-stu-id="06bd4-311">It uses the Knockout.js library to separate presentation (HTML markup) from the data and application logic.</span></span> <span data-ttu-id="06bd4-312">Mais Knockout n’est pas la seule bibliothèque JavaScript que vous pouvez utiliser pour créer un SPA.</span><span class="sxs-lookup"><span data-stu-id="06bd4-312">But Knockout is not the only JavaScript library you can use to create a SPA.</span></span> <span data-ttu-id="06bd4-313">Si vous souhaitez explorer d’autres options, jetez un coup d’œil aux [modèles Spa créés par la communauté](../templates/index.md).</span><span class="sxs-lookup"><span data-stu-id="06bd4-313">If you want to explore some other options, take a look at the [community-created SPA templates](../templates/index.md).</span></span>
