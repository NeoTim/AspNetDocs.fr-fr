---
uid: web-pages/overview/getting-started/11-adding-email-to-your-web-site
title: Envoi d’E-mail à partir d’un site ASP.NET Web Pages (Razor) Site | Microsoft Docs
author: Rick-Anderson
description: Ce chapitre explique comment envoyer un message électronique automatisés à partir d’un site Web.
ms.author: riande
ms.date: 02/20/2014
ms.assetid: fc49bcb9-f1a9-4048-8c3f-b60951853200
msc.legacyurl: /web-pages/overview/getting-started/11-adding-email-to-your-web-site
msc.type: authoredcontent
ms.openlocfilehash: f388ac1a97bde39cffe6b592b436d7af0d419a5f
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57038396"
---
<a name="sending-email-from-an-aspnet-web-pages-razor-site"></a><span data-ttu-id="2c9c4-103">Envoi d’E-mails à partir d’un Site ASP.NET Web Pages (Razor)</span><span class="sxs-lookup"><span data-stu-id="2c9c4-103">Sending Email from an ASP.NET Web Pages (Razor) Site</span></span>
====================
<span data-ttu-id="2c9c4-104">par [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="2c9c4-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="2c9c4-105">Cet article explique comment envoyer un message électronique à partir d’un site Web lorsque vous utilisez les Pages Web ASP.NET (Razor).</span><span class="sxs-lookup"><span data-stu-id="2c9c4-105">This article explains how to send an email message from a website when you use ASP.NET Web Pages (Razor).</span></span>
> 
> <span data-ttu-id="2c9c4-106">Ce que vous allez apprendre :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-106">What you'll learn:</span></span>
> 
> - <span data-ttu-id="2c9c4-107">Comment envoyer un message électronique à partir de votre site Web.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-107">How to send an email message from your website.</span></span>
> - <span data-ttu-id="2c9c4-108">Guide pratique pour attacher un fichier à un message électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-108">How to attach a file to an email message.</span></span>
> 
> <span data-ttu-id="2c9c4-109">Il s’agit de la fonctionnalité d’ASP.NET introduite dans l’article :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-109">This is the ASP.NET feature introduced in the article:</span></span>
> 
> - <span data-ttu-id="2c9c4-110">Le `WebMail` helper.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-110">The `WebMail` helper.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="2c9c4-111">Versions des logiciels utilisées dans le didacticiel</span><span class="sxs-lookup"><span data-stu-id="2c9c4-111">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="2c9c4-112">ASP.NET Web Pages (Razor) 3</span><span class="sxs-lookup"><span data-stu-id="2c9c4-112">ASP.NET Web Pages (Razor) 3</span></span>
>   
> 
> <span data-ttu-id="2c9c4-113">Ce didacticiel fonctionne également avec ASP.NET Web Pages 2.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-113">This tutorial also works with ASP.NET Web Pages 2.</span></span>


<a id="Sending_Email_Messages"></a>
## <a name="sending-email-messages-from-your-website"></a><span data-ttu-id="2c9c4-114">Envoi d’E-mails à partir de votre site Web</span><span class="sxs-lookup"><span data-stu-id="2c9c4-114">Sending Email Messages from Your Website</span></span>

<span data-ttu-id="2c9c4-115">Il existe toutes sortes de raisons pour lesquelles vous devrez peut-être envoyer un e-mail à partir de votre site Web.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-115">There are all sorts of reasons why you might need to send email from your website.</span></span> <span data-ttu-id="2c9c4-116">Vous pouvez envoyer des messages de confirmation aux utilisateurs, ou vous pouvez envoyer des notifications à vous-même (par exemple, un nouvel utilisateur a enregistré.) Le `WebMail` helper facilite l’utilisation pour pouvoir envoyer un courrier électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-116">You might send confirmation messages to users, or you might send notifications to yourself (for example, that a new user has registered.) The `WebMail` helper makes it easy for you to send email.</span></span>

<span data-ttu-id="2c9c4-117">Pour utiliser le `WebMail` helper, vous devez avoir accès à un serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-117">To use the `WebMail` helper, you have to have access to an SMTP server.</span></span> <span data-ttu-id="2c9c4-118">(Abréviation de *Simple Mail Transfer Protocol*.) Un serveur SMTP est un serveur de messagerie qui transfère uniquement les messages vers le serveur du destinataire &#8212; doivent impérativement du côté sortant de courrier électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-118">(SMTP stands for *Simple Mail Transfer Protocol*.) An SMTP server is an email server that only forwards messages to the recipient's server &#8212; it's the outbound side of email.</span></span> <span data-ttu-id="2c9c4-119">Si vous utilisez un fournisseur d’hébergement pour votre site Web, ils probablement configurer vous avec l’adresse e-mail et il peuvent vous indiquer ce qui est le nom de votre serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-119">If you use a hosting provider for your website, they probably set you up with email and they can tell you what your SMTP server name is.</span></span> <span data-ttu-id="2c9c4-120">Si vous travaillez à l’intérieur d’un réseau d’entreprise, un administrateur ou votre service informatique peut généralement vous donner les informations sur un serveur SMTP que vous pouvez utiliser.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-120">If you're working inside a corporate network, an administrator or your IT department can usually give you the information about an SMTP server that you can use.</span></span> <span data-ttu-id="2c9c4-121">Si vous travaillez à domicile, vous pourrez même tester à l’aide de votre fournisseur de messagerie ordinaire, ce qui peut vous indiquer le nom du serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-121">If you're working at home, you might even be able to test using your ordinary email provider, who can tell you the name of their SMTP server.</span></span> <span data-ttu-id="2c9c4-122">Vous devez généralement :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-122">You typically need:</span></span>

- <span data-ttu-id="2c9c4-123">Le nom du serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-123">The name of the SMTP server.</span></span>
- <span data-ttu-id="2c9c4-124">Le numéro de port.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-124">The port number.</span></span> <span data-ttu-id="2c9c4-125">C’est presque toujours 25.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-125">This is almost always 25.</span></span> <span data-ttu-id="2c9c4-126">Toutefois, votre ISP vous obligent à utiliser le port 587.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-126">However, your ISP may require you to use port 587.</span></span> <span data-ttu-id="2c9c4-127">Si vous utilisez SSL (SSL) pour le courrier électronique, vous devrez peut-être un port différent.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-127">If you are using secure sockets layer (SSL) for email, you might need a different port.</span></span> <span data-ttu-id="2c9c4-128">Vérifiez auprès de votre fournisseur de messagerie.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-128">Check with your email provider.</span></span>
- <span data-ttu-id="2c9c4-129">Informations d’identification (nom d’utilisateur, mot de passe).</span><span class="sxs-lookup"><span data-stu-id="2c9c4-129">Credentials (user name, password).</span></span>

<span data-ttu-id="2c9c4-130">Dans cette procédure, vous créez deux pages.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-130">In this procedure, you create two pages.</span></span> <span data-ttu-id="2c9c4-131">La première page a un formulaire qui permet aux utilisateurs d’entrer une description, comme si elles ont été remplissant un formulaire de support technique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-131">The first page has a form that lets users enter a description, as if they were filling in a technical-support form.</span></span> <span data-ttu-id="2c9c4-132">La première page envoie ses informations à une deuxième page.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-132">The first page submits its information to a second page.</span></span> <span data-ttu-id="2c9c4-133">Dans la deuxième page, le code extrait des informations de l’utilisateur et envoie un message électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-133">In the second page, code extracts the user's information and sends an email message.</span></span> <span data-ttu-id="2c9c4-134">Il affiche également un message confirmant que le rapport de problème a été reçu.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-134">It also displays a message confirming that the problem report has been received.</span></span>

![[image]](11-adding-email-to-your-web-site/_static/image1.jpg)

> [!NOTE]
> <span data-ttu-id="2c9c4-136">Pour simplifier cet exemple, le code initialise le `WebMail` droite d’assistance dans la page où vous l’utilisez.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-136">To keep this example simple, the code initializes the `WebMail` helper right in the page where you use it.</span></span> <span data-ttu-id="2c9c4-137">Toutefois, pour les sites Web réels, il est plus judicieux de placer le code d’initialisation comme suit dans un fichier global, afin que vous initialisez le `WebMail` auxiliaire pour tous les fichiers dans votre site Web.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-137">However, for real websites, it's a better idea to put initialization code like this in a global file, so that you initialize the `WebMail` helper for all files in your website.</span></span> <span data-ttu-id="2c9c4-138">Pour plus d’informations, consultez [personnalisation du comportement de l’échelle du Site pour ASP.NET Web Pages](https://go.microsoft.com/fwlink/?LinkId=202906#Setting_Values_For_Helpers).</span><span class="sxs-lookup"><span data-stu-id="2c9c4-138">For more information, see [Customizing Site-Wide Behavior for ASP.NET Web Pages](https://go.microsoft.com/fwlink/?LinkId=202906#Setting_Values_For_Helpers).</span></span>


1. <span data-ttu-id="2c9c4-139">Créer un nouveau site Web.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-139">Create a new website.</span></span>
2. <span data-ttu-id="2c9c4-140">Ajoutez une nouvelle page nommée *EmailRequest.cshtml* et ajoutez le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-140">Add a new page named *EmailRequest.cshtml* and add the following markup:</span></span> 

    [!code-html[Main](11-adding-email-to-your-web-site/samples/sample1.html)]

    <span data-ttu-id="2c9c4-141">Notez que le `action` attribut de l’élément de formulaire a été défini sur *ProcessRequest.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-141">Notice that the `action` attribute of the form element has been set to *ProcessRequest.cshtml*.</span></span> <span data-ttu-id="2c9c4-142">Cela signifie que le formulaire est envoyé à cette page au lieu de nouveau à la page actuelle.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-142">This means that the form will be submitted to that page instead of back to the current page.</span></span>
3. <span data-ttu-id="2c9c4-143">Ajoutez une nouvelle page nommée *ProcessRequest.cshtml* au site Web et ajoutez le code et le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-143">Add a new page named *ProcessRequest.cshtml* to the website and add the following code and markup:</span></span>   

    [!code-cshtml[Main](11-adding-email-to-your-web-site/samples/sample2.cshtml)]

    <span data-ttu-id="2c9c4-144">Dans le code, vous obtenez les valeurs des champs de formulaire qui ont été soumises à la page.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-144">In the code, you get the values of the form fields that were submitted to the page.</span></span> <span data-ttu-id="2c9c4-145">Vous appelez ensuite la `WebMail` l’Assistant `Send` méthode pour créer et envoyer le message électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-145">You then call the `WebMail` helper's `Send` method to create and send the email message.</span></span> <span data-ttu-id="2c9c4-146">Dans ce cas, les valeurs à utiliser sont constituées de texte qui vous concaténez avec les valeurs qui ont été soumises à partir du formulaire.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-146">In this case, the values to use are made up of text that you concatenate with the values that were submitted from the form.</span></span>

    <span data-ttu-id="2c9c4-147">Le code de cette page est à l’intérieur d’un `try/catch` bloc.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-147">The code for this page is inside a `try/catch` block.</span></span> <span data-ttu-id="2c9c4-148">Si un message électronique ne fonctionne pas pour une raison quelconque la tentative d’envoi (par exemple, les paramètres ne sont pas droit), le code dans le `catch` bloc s’exécute et définit le `errorMessage` variable à l’erreur qui s’est produite.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-148">If for any reason the attempt to send an email doesn't work (for example, the settings aren't right), the code in the `catch` block runs and sets the `errorMessage` variable to the error that has occurred.</span></span> <span data-ttu-id="2c9c4-149">(Pour plus d’informations sur `try/catch` blocs ou les `<text>` balise, consultez [Introduction à ASP.NET Web Pages programmation à l’aide de la syntaxe Razor](https://go.microsoft.com/fwlink/?LinkID=251587#ID_HandlingErrors).)</span><span class="sxs-lookup"><span data-stu-id="2c9c4-149">(For more information about `try/catch` blocks or the `<text>` tag, see [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkID=251587#ID_HandlingErrors).)</span></span>

    <span data-ttu-id="2c9c4-150">Dans le corps de la page, si le `errorMessage` variable est vide (la valeur par défaut), l’utilisateur voit un message e-mail a été envoyé.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-150">In the body of the page, if the `errorMessage` variable is empty (the default), the user sees a message that the email message has been sent.</span></span> <span data-ttu-id="2c9c4-151">Si le `errorMessage` variable est définie sur true, l’utilisateur consulte un message qu’il a été un problème d’envoi du message.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-151">If the `errorMessage` variable is set to true, the user sees a message that there's been a problem sending the message.</span></span>

    <span data-ttu-id="2c9c4-152">Notez que dans la partie de la page qui affiche un message d’erreur, il existe un test supplémentaire : `if(debuggingFlag)`.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-152">Notice that in the portion of the page that displays an error message, there's an additional test: `if(debuggingFlag)`.</span></span> <span data-ttu-id="2c9c4-153">Il s’agit d’une variable que vous pouvez définir sur true si vous rencontrez des problèmes de l’envoi de courrier électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-153">This is a variable that you can set to true if you're having trouble sending email.</span></span> <span data-ttu-id="2c9c4-154">Lorsque `debuggingFlag` a la valeur true, et s’il existe un problème d’envoi de courrier électronique, un message d’erreur supplémentaires s’affiche qui indique ce que ASP.NET a signalé lorsqu’il a essayé d’envoyer le message électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-154">When `debuggingFlag` is true, and if there's a problem sending email, an additional error message is displayed that shows whatever ASP.NET has reported when it tried to send the email message.</span></span> <span data-ttu-id="2c9c4-155">Avertissement juste, toutefois : les messages d’erreur ASP.NET signale quand il ne peut pas envoyer un message électronique peuvent être génériques.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-155">Fair warning, though: the error messages that ASP.NET reports when it can't send an email message can be generic.</span></span> <span data-ttu-id="2c9c4-156">Par exemple, si ASP.NET ne peut pas contacter le serveur SMTP (par exemple, étant donné que vous fait une erreur dans le nom du serveur), l’erreur est `Failure sending mail`.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-156">For example, if ASP.NET can't contact the SMTP server (for example, because you made an error in the server name), the error is `Failure sending mail`.</span></span>

    > [!NOTE] 
    > 
    > <span data-ttu-id="2c9c4-157">**Important** si vous obtenez un message d’erreur d’un objet d’exception (`ex` dans le code), procédez comme *pas* transmet régulièrement ce message aux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-157">**Important** When you get an error message from an exception object (`ex` in the code), do *not* routinely pass that message through to users.</span></span> <span data-ttu-id="2c9c4-158">Objets d’exception incluent souvent des informations que les utilisateurs ne doivent pas voir et qui peut même être une faille de sécurité.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-158">Exception objects often include information that users should not see and that can even be a security vulnerability.</span></span> <span data-ttu-id="2c9c4-159">C’est pourquoi ce code inclut la variable `debuggingFlag` qui est utilisé comme un commutateur pour afficher le message d’erreur, et pourquoi la variable par défaut est définie sur false.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-159">That's why this code includes the variable `debuggingFlag` that's used as a switch to display the error message, and why the variable by default is set to false.</span></span> <span data-ttu-id="2c9c4-160">Vous devez définir cette variable sur true (et par conséquent afficher le message d’erreur) *uniquement* si vous rencontrez un problème avec l’envoi de courrier électronique et que vous devez déboguer.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-160">You should set that variable to true (and therefore display the error message) *only* if you're having a problem with sending email and you need to debug.</span></span> <span data-ttu-id="2c9c4-161">Une fois que vous avez résolu les problèmes, définir `debuggingFlag` à false.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-161">Once you have fixed any problems, set `debuggingFlag` back to false.</span></span>

    <span data-ttu-id="2c9c4-162">Modifier les paramètres associés dans le code de messagerie de ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-162">Modify the following email related settings in the code:</span></span>

   - <span data-ttu-id="2c9c4-163">Définissez `your-SMTP-host` au nom du serveur SMTP que vous avez accès.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-163">Set `your-SMTP-host` to the name of the SMTP server that you have access to.</span></span>
   - <span data-ttu-id="2c9c4-164">Définissez `your-user-name-here` au nom d’utilisateur pour votre compte de serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-164">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
   - <span data-ttu-id="2c9c4-165">Définissez `your-account-password` au mot de passe pour votre compte de serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-165">Set `your-account-password` to the password for your SMTP server account.</span></span>
   - <span data-ttu-id="2c9c4-166">Définissez `your-email-address-here` à votre propre adresse e-mail.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-166">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="2c9c4-167">Il s’agit de l’adresse de messagerie, le message est envoyé à partir de.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-167">This is the email address that the message is sent from.</span></span> <span data-ttu-id="2c9c4-168">(Certains fournisseurs de messagerie ne vous permettent de spécifier un autre `From` d’adresses et utilisera votre nom d’utilisateur en tant que le `From` adresse.)</span><span class="sxs-lookup"><span data-stu-id="2c9c4-168">(Some email providers don't let you specify a different `From` address and will use your user name as the `From` address.)</span></span>

     > [!TIP] 
     > 
     > <a id="configuring_email_settings"></a>
     > ### <a name="configuring-email-settings"></a><span data-ttu-id="2c9c4-169">Configuration des paramètres de messagerie</span><span class="sxs-lookup"><span data-stu-id="2c9c4-169">Configuring Email Settings</span></span>
     > 
     > <span data-ttu-id="2c9c4-170">Il peut être un défi parfois pour vous assurer que vous avez les bons paramètres pour le serveur SMTP, le numéro de port et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-170">It can be a challenge sometimes to make sure you have the right settings for the SMTP server, port number, and so on.</span></span> <span data-ttu-id="2c9c4-171">Voici quelques conseils :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-171">Here are a few tips:</span></span>
     > 
     > - <span data-ttu-id="2c9c4-172">Le nom du serveur SMTP est souvent quelque chose comme `smtp.provider.com` ou `smtp.provider.net`.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-172">The SMTP server name is often something like `smtp.provider.com` or `smtp.provider.net`.</span></span> <span data-ttu-id="2c9c4-173">Toutefois, si vous publiez votre site sur un fournisseur d’hébergement, le nom du serveur SMTP à ce stade peut être `localhost`.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-173">However, if you publish your site to a hosting provider, the SMTP server name at that point might be `localhost`.</span></span> <span data-ttu-id="2c9c4-174">Il s’agit, car une fois que vous avez publié et que votre site est en cours d’exécution sur le serveur du fournisseur, le serveur de messagerie peut être local du point de vue de votre application.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-174">This is because after you've published and your site is running on the provider's server, the email server might be local from the perspective of your application.</span></span> <span data-ttu-id="2c9c4-175">Cette modification dans les noms de serveur peut signifier que vous devez modifier le nom du serveur SMTP dans le cadre de votre processus de publication.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-175">This change in server names might mean you have to change the SMTP server name as part of your publishing process.</span></span>
     > - <span data-ttu-id="2c9c4-176">Le numéro de port est généralement 25.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-176">The port number is usually 25.</span></span> <span data-ttu-id="2c9c4-177">Toutefois, certains fournisseurs vous obligent à utiliser port 587 ou un autre port.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-177">However, some providers require you to use port 587 or some other port.</span></span>
     > - <span data-ttu-id="2c9c4-178">Assurez-vous que vous utilisez les informations d’identification correctes.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-178">Make sure that you use the right credentials.</span></span> <span data-ttu-id="2c9c4-179">Si vous avez publié votre site vers un fournisseur d’hébergement, utilisez les informations d’identification que le fournisseur a spécifiquement sont pour le courrier électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-179">If you've published your site to a hosting provider, use the credentials that the provider has specifically indicated are for email.</span></span> <span data-ttu-id="2c9c4-180">Ceux-ci peuvent différer les informations d’identification que vous utilisez pour publier.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-180">These might be different from the credentials you use to publish.</span></span>
     > - <span data-ttu-id="2c9c4-181">Parfois, vous n’avez pas besoin d’informations d’identification du tout.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-181">Sometimes you don't need credentials at all.</span></span> <span data-ttu-id="2c9c4-182">Si vous envoyez un e-mail à l’aide de votre fournisseur de services Internet, votre fournisseur de messagerie déjà connaissez peut-être vos informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-182">If you're sending email using your personal ISP, your email provider might already know your credentials.</span></span> <span data-ttu-id="2c9c4-183">Une fois que vous publiez, vous devrez peut-être utiliser différentes informations d’identification que lorsque vous testez sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-183">After you publish, you might need to use different credentials than when you test on your local computer.</span></span>
     > - <span data-ttu-id="2c9c4-184">Si votre fournisseur de messagerie utilise le chiffrement, vous devez définir `WebMail.EnableSsl` à `true`.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-184">If your email provider uses encryption, you have to set `WebMail.EnableSsl` to `true`.</span></span>
4. <span data-ttu-id="2c9c4-185">Exécutez le *EmailRequest.cshtml* page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-185">Run the *EmailRequest.cshtml* page in a browser.</span></span> <span data-ttu-id="2c9c4-186">(Assurez-vous que la page est sélectionnée dans le **fichiers** espace de travail avant de l’exécuter.)</span><span class="sxs-lookup"><span data-stu-id="2c9c4-186">(Make sure the page is selected in the **Files** workspace before you run it.)</span></span>
5. <span data-ttu-id="2c9c4-187">Entrez votre nom et une description du problème, puis cliquez sur le **envoyer** bouton.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-187">Enter your name and a problem description, and then click the **Submit** button.</span></span> <span data-ttu-id="2c9c4-188">Vous êtes redirigé vers la *ProcessRequest.cshtml* page, ce qui confirme votre message et qui vous envoie un message électronique.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-188">You're redirected to the *ProcessRequest.cshtml* page, which confirms your message and which sends you an email message.</span></span> 

    ![[image]](11-adding-email-to-your-web-site/_static/image2.jpg)

<a id="Sending_a_File"></a>
## <a name="sending-a-file-using-email"></a><span data-ttu-id="2c9c4-190">Envoi d’un fichier à l’aide de la messagerie</span><span class="sxs-lookup"><span data-stu-id="2c9c4-190">Sending a File Using Email</span></span>

<span data-ttu-id="2c9c4-191">Vous pouvez également envoyer des fichiers qui sont joints aux messages électroniques.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-191">You can also send files that are attached to email messages.</span></span> <span data-ttu-id="2c9c4-192">Dans cette procédure, vous créez un fichier texte et deux pages HTML.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-192">In this procedure, you create a text file and two HTML pages.</span></span> <span data-ttu-id="2c9c4-193">Vous allez utiliser le fichier texte en tant que pièce jointe d’e-mail.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-193">You'll use the text file as an email attachment.</span></span>

1. <span data-ttu-id="2c9c4-194">Dans le site Web, ajoutez un nouveau fichier texte et nommez-le *MyFile.txt*.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-194">In the website, add a new text file and name it *MyFile.txt*.</span></span>
2. <span data-ttu-id="2c9c4-195">Copiez le texte suivant et collez-le dans le fichier :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-195">Copy the following text and paste it in the file:</span></span> 

    `Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.`
3. <span data-ttu-id="2c9c4-196">Créez une page nommée *SendFile.cshtml* et ajoutez le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-196">Create a page named *SendFile.cshtml* and add the following markup:</span></span> 

    [!code-html[Main](11-adding-email-to-your-web-site/samples/sample3.html)]
4. <span data-ttu-id="2c9c4-197">Créez une page nommée *ProcessFile.cshtml* et ajoutez le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-197">Create a page named *ProcessFile.cshtml* and add the following markup:</span></span> 

    [!code-cshtml[Main](11-adding-email-to-your-web-site/samples/sample4.cshtml)]
5. <span data-ttu-id="2c9c4-198">Modifier les paramètres associés dans le code de l’exemple de messagerie de ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="2c9c4-198">Modify the following email related settings in the code from the example:</span></span>

    - <span data-ttu-id="2c9c4-199">Définissez `your-SMTP-host` au nom d’un serveur SMTP que vous avez accès.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-199">Set `your-SMTP-host` to the name of an SMTP server that you have access to.</span></span>
    - <span data-ttu-id="2c9c4-200">Définissez `your-user-name-here` au nom d’utilisateur pour votre compte de serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-200">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
    - <span data-ttu-id="2c9c4-201">Définissez `your-email-address-here` à votre propre adresse e-mail.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-201">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="2c9c4-202">Il s’agit de l’adresse de messagerie, le message est envoyé à partir de.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-202">This is the email address that the message is sent from.</span></span>
    - <span data-ttu-id="2c9c4-203">Définissez `your-account-password` au mot de passe pour votre compte de serveur SMTP.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-203">Set `your-account-password` to the password for your SMTP server account.</span></span>
    - <span data-ttu-id="2c9c4-204">Définissez `target-email-address-here` à votre propre adresse e-mail.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-204">Set `target-email-address-here` to your own email address.</span></span> <span data-ttu-id="2c9c4-205">(Comme avant, serait normalement d’envoyer un e-mail à quelqu'un d’autre, mais pour le test, vous pouvez l’envoyer à vous-même.)</span><span class="sxs-lookup"><span data-stu-id="2c9c4-205">(As before, you'd normally send an email to someone else, but for testing, you can send it to yourself.)</span></span>
6. <span data-ttu-id="2c9c4-206">Exécutez le *SendFile.cshtml* page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-206">Run the *SendFile.cshtml* page in a browser.</span></span>
7. <span data-ttu-id="2c9c4-207">Entrez votre nom, une ligne d’objet et le nom du fichier texte à joindre (*MyFile.txt*).</span><span class="sxs-lookup"><span data-stu-id="2c9c4-207">Enter your name, a subject line, and the name of the text file to attach (*MyFile.txt*).</span></span>
8. <span data-ttu-id="2c9c4-208">Cliquez sur le bouton `Submit`.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-208">Click the `Submit` button.</span></span> <span data-ttu-id="2c9c4-209">Comme auparavant, vous êtes redirigé vers la *ProcessFile.cshtml* page, ce qui confirme votre message et qui vous envoie un message électronique avec le fichier joint.</span><span class="sxs-lookup"><span data-stu-id="2c9c4-209">As before, you're redirected to the *ProcessFile.cshtml* page, which confirms your message and which sends you an email message with the attached file.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="2c9c4-210">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="2c9c4-210">Additional Resources</span></span>


- [<span data-ttu-id="2c9c4-211">ASP.NET Web Pages (Razor) - Guide de résolution des problèmes</span><span class="sxs-lookup"><span data-stu-id="2c9c4-211">ASP.NET Web Pages (Razor) Troubleshooting Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=253001)
- [<span data-ttu-id="2c9c4-212">Simple Mail Transfer Protocol</span><span class="sxs-lookup"><span data-stu-id="2c9c4-212">Simple Mail Transfer Protocol</span></span>](https://msdn.microsoft.com/library/aa480435.aspx)
- [<span data-ttu-id="2c9c4-213">Personnalisation du comportement de l’échelle du Site pour ASP.NET Web Pages</span><span class="sxs-lookup"><span data-stu-id="2c9c4-213">Customizing Site-Wide Behavior for ASP.NET Web Pages</span></span>](https://go.microsoft.com/fwlink/?LinkId=202906)
