---
uid: web-pages/overview/data/working-with-files
title: Utilisation de fichiers dans un site pages Web ASP.NET (Razor) | Microsoft Docs
author: Rick-Anderson
description: Ce chapitre explique comment lire, écrire, ajouter, supprimer et télécharger des fichiers.
ms.author: riande
ms.date: 02/20/2014
ms.assetid: eee916e4-ba4c-439a-a24e-68df7d45a569
msc.legacyurl: /web-pages/overview/data/working-with-files
msc.type: authoredcontent
ms.openlocfilehash: 684c47a8a8480dc040e5144144577c94c35d39e5
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78642365"
---
# <a name="working-with-files-in-an-aspnet-web-pages-razor-site"></a><span data-ttu-id="34e98-103">Utilisation de fichiers dans un site pages Web ASP.NET (Razor)</span><span class="sxs-lookup"><span data-stu-id="34e98-103">Working with Files in an ASP.NET Web Pages (Razor) Site</span></span>

<span data-ttu-id="34e98-104">par [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="34e98-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="34e98-105">Cet article explique comment lire, écrire, ajouter, supprimer et télécharger des fichiers sur un site pages Web ASP.NET (Razor).</span><span class="sxs-lookup"><span data-stu-id="34e98-105">This article explains how to read, write, append, delete, and upload files in an ASP.NET Web Pages (Razor) site.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="34e98-106">Si vous souhaitez télécharger des images et les manipuler (par exemple, les retourner ou les redimensionner), consultez [utilisation des images dans un Site pages Web ASP.net](/aspnet/web-pages/overview/ui-layouts-and-themes/9-working-with-images).</span><span class="sxs-lookup"><span data-stu-id="34e98-106">If you want to upload images and manipulate them (for example, flip or resize them), see [Working with Images in an ASP.NET Web Pages Site](/aspnet/web-pages/overview/ui-layouts-and-themes/9-working-with-images).</span></span>
> 
> 
> <span data-ttu-id="34e98-107">**Ce que vous allez apprendre :**</span><span class="sxs-lookup"><span data-stu-id="34e98-107">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="34e98-108">Comment créer un fichier texte et y écrire des données.</span><span class="sxs-lookup"><span data-stu-id="34e98-108">How to create a text file and write data to it.</span></span>
> - <span data-ttu-id="34e98-109">Comment ajouter des données à un fichier existant.</span><span class="sxs-lookup"><span data-stu-id="34e98-109">How to append data to an existing file.</span></span>
> - <span data-ttu-id="34e98-110">Comment lire un fichier et l’afficher à partir de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="34e98-110">How to read a file and display from it.</span></span>
> - <span data-ttu-id="34e98-111">Comment supprimer des fichiers d’un site Web.</span><span class="sxs-lookup"><span data-stu-id="34e98-111">How to delete files from a website.</span></span>
> - <span data-ttu-id="34e98-112">Comment permettre aux utilisateurs de télécharger un ou plusieurs fichiers.</span><span class="sxs-lookup"><span data-stu-id="34e98-112">How to let users upload one file or multiple files.</span></span>
> 
> <span data-ttu-id="34e98-113">Voici les fonctionnalités de programmation ASP.NET présentées dans l’article :</span><span class="sxs-lookup"><span data-stu-id="34e98-113">These are the ASP.NET programming features introduced in the article:</span></span>
> 
> - <span data-ttu-id="34e98-114">Objet `File`, qui permet de gérer les fichiers.</span><span class="sxs-lookup"><span data-stu-id="34e98-114">The `File` object, which provides a way to manage files.</span></span>
> - <span data-ttu-id="34e98-115">Le programme d’assistance `FileUpload`.</span><span class="sxs-lookup"><span data-stu-id="34e98-115">The `FileUpload` helper.</span></span>
> - <span data-ttu-id="34e98-116">Objet `Path`, qui fournit des méthodes qui vous permettent de manipuler les noms de chemin d’accès et de fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-116">The `Path` object, which provides methods that let you manipulate path and file names.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="34e98-117">Versions logicielles utilisées dans le didacticiel</span><span class="sxs-lookup"><span data-stu-id="34e98-117">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="34e98-118">Pages Web ASP.NET (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="34e98-118">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="34e98-119">WebMatrix 2</span><span class="sxs-lookup"><span data-stu-id="34e98-119">WebMatrix 2</span></span>
>   
> 
> <span data-ttu-id="34e98-120">Ce didacticiel fonctionne également avec WebMatrix 3.</span><span class="sxs-lookup"><span data-stu-id="34e98-120">This tutorial also works with WebMatrix 3.</span></span>

<a id="Creating_a_Text_File"></a>
## <a name="creating-a-text-file-and-writing-data-to-it"></a><span data-ttu-id="34e98-121">Création d’un fichier texte et écriture de données dans celui-ci</span><span class="sxs-lookup"><span data-stu-id="34e98-121">Creating a Text File and Writing Data to It</span></span>

<span data-ttu-id="34e98-122">Outre l’utilisation d’une base de données dans votre site Web, vous pouvez utiliser des fichiers.</span><span class="sxs-lookup"><span data-stu-id="34e98-122">In addition to using a database in your website, you might work with files.</span></span> <span data-ttu-id="34e98-123">Par exemple, vous pouvez utiliser des fichiers texte comme moyen simple pour stocker des données pour le site.</span><span class="sxs-lookup"><span data-stu-id="34e98-123">For example, you might use text files as a simple way to store data for the site.</span></span> <span data-ttu-id="34e98-124">(Un fichier texte utilisé pour stocker des données est parfois appelé *fichier plat*). Les fichiers texte peuvent être dans différents formats, tels que *. txt*, *. xml*ou *. csv* (valeurs délimitées par des virgules).</span><span class="sxs-lookup"><span data-stu-id="34e98-124">(A text file that's used to store data is sometimes called a *flat file*.) Text files can be in different formats, like *.txt*, *.xml*, or *.csv* (comma-delimited values).</span></span>

<span data-ttu-id="34e98-125">Si vous souhaitez stocker des données dans un fichier texte, vous pouvez utiliser la méthode `File.WriteAllText` pour spécifier le fichier à créer et les données à y écrire.</span><span class="sxs-lookup"><span data-stu-id="34e98-125">If you want to store data in a text file, you can use the `File.WriteAllText` method to specify the file to create and the data to write to it.</span></span> <span data-ttu-id="34e98-126">Dans cette procédure, vous allez créer une page qui contient un formulaire simple avec trois éléments `input` (prénom, nom et adresse de messagerie) et un bouton **Envoyer** .</span><span class="sxs-lookup"><span data-stu-id="34e98-126">In this procedure, you'll create a page that contains a simple form with three `input` elements (first name, last name, and email address) and a **Submit** button.</span></span> <span data-ttu-id="34e98-127">Lorsque l’utilisateur envoie le formulaire, vous stockez l’entrée de l’utilisateur dans un fichier texte.</span><span class="sxs-lookup"><span data-stu-id="34e98-127">When the user submits the form, you'll store the user's input in a text file.</span></span>

1. <span data-ttu-id="34e98-128">Créez un dossier nommé *App\_Data*, s’il n’existe pas déjà.</span><span class="sxs-lookup"><span data-stu-id="34e98-128">Create a new folder named *App\_Data*, if it doesn't exist already.</span></span>
2. <span data-ttu-id="34e98-129">À la racine de votre site Web, créez un nouveau fichier nommé *UserData. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="34e98-129">At the root of your website, create a new file named *UserData.cshtml*.</span></span>
3. <span data-ttu-id="34e98-130">Remplacez le contenu existant par ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-130">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample1.cshtml)]

    <span data-ttu-id="34e98-131">Le balisage HTML crée le formulaire avec les trois zones de texte.</span><span class="sxs-lookup"><span data-stu-id="34e98-131">The HTML markup creates the form with the three text boxes.</span></span> <span data-ttu-id="34e98-132">Dans le code, vous utilisez la propriété `IsPost` pour déterminer si la page a été envoyée avant de commencer le traitement.</span><span class="sxs-lookup"><span data-stu-id="34e98-132">In the code, you use the `IsPost` property to determine whether the page has been submitted before you start processing.</span></span>

    <span data-ttu-id="34e98-133">La première tâche consiste à récupérer l’entrée utilisateur et à l’attribuer à des variables.</span><span class="sxs-lookup"><span data-stu-id="34e98-133">The first task is to get the user input and assign it to variables.</span></span> <span data-ttu-id="34e98-134">Le code concatène ensuite les valeurs des variables distinctes en une chaîne délimitée par des virgules, qui est ensuite stockée dans une variable différente.</span><span class="sxs-lookup"><span data-stu-id="34e98-134">The code then concatenates the values of the separate variables into one comma-delimited string, which is then stored in a different variable.</span></span> <span data-ttu-id="34e98-135">Notez que le séparateur de virgule est une chaîne contenue entre guillemets (","), car vous incorporez littéralement une virgule dans la Big String que vous êtes en train de créer.</span><span class="sxs-lookup"><span data-stu-id="34e98-135">Notice that the comma separator is a string contained in quotation marks (","), because you're literally embedding a comma into the big string that you're creating.</span></span> <span data-ttu-id="34e98-136">À la fin des données que vous concaténez ensemble, vous ajoutez `Environment.NewLine`.</span><span class="sxs-lookup"><span data-stu-id="34e98-136">At the end of the data that you concatenate together, you add `Environment.NewLine`.</span></span> <span data-ttu-id="34e98-137">Cela ajoute un saut de ligne (un caractère de saut de ligne).</span><span class="sxs-lookup"><span data-stu-id="34e98-137">This adds a line break (a newline character).</span></span> <span data-ttu-id="34e98-138">Ce que vous créez avec toute cette concaténation est une chaîne qui ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="34e98-138">What you're creating with all this concatenation is a string that looks like this:</span></span>

    [!code-css[Main](working-with-files/samples/sample2.css)]

    <span data-ttu-id="34e98-139">(Avec un saut de ligne invisible à la fin.)</span><span class="sxs-lookup"><span data-stu-id="34e98-139">(With an invisible line break at the end.)</span></span>

    <span data-ttu-id="34e98-140">Vous créez ensuite une variable (`dataFile`) qui contient l’emplacement et le nom du fichier dans lequel stocker les données.</span><span class="sxs-lookup"><span data-stu-id="34e98-140">You then create a variable (`dataFile`) that contains the location and name of the file to store the data in.</span></span> <span data-ttu-id="34e98-141">La définition de l’emplacement nécessite un traitement spécial.</span><span class="sxs-lookup"><span data-stu-id="34e98-141">Setting the location requires some special handling.</span></span> <span data-ttu-id="34e98-142">Dans les sites Web, il est déconseillé de faire référence à des chemins d’accès absolus comme *C:\Folder\File.txt* pour les fichiers sur le serveur Web.</span><span class="sxs-lookup"><span data-stu-id="34e98-142">In websites, it's a bad practice to refer in code to absolute paths like *C:\Folder\File.txt* for files on the web server.</span></span> <span data-ttu-id="34e98-143">Si un site Web est déplacé, un chemin d’accès absolu est incorrect.</span><span class="sxs-lookup"><span data-stu-id="34e98-143">If a website is moved, an absolute path will be wrong.</span></span> <span data-ttu-id="34e98-144">En outre, pour un site hébergé (par opposition à sur votre ordinateur), vous ne connaissez pas le bon chemin d’accès lorsque vous écrivez le code.</span><span class="sxs-lookup"><span data-stu-id="34e98-144">Moreover, for a hosted site (as opposed to on your own computer) you typically don't even know what the correct path is when you're writing the code.</span></span>

    <span data-ttu-id="34e98-145">Mais parfois (comme maintenant, pour l’écriture d’un fichier), vous avez besoin d’un chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="34e98-145">But sometimes (like now, for writing a file) you do need a complete path.</span></span> <span data-ttu-id="34e98-146">La solution consiste à utiliser la méthode `MapPath` de l’objet `Server`.</span><span class="sxs-lookup"><span data-stu-id="34e98-146">The solution is to use the `MapPath` method of the `Server` object.</span></span> <span data-ttu-id="34e98-147">Cela retourne le chemin d’accès complet à votre site Web.</span><span class="sxs-lookup"><span data-stu-id="34e98-147">This returns the complete path to your website.</span></span> <span data-ttu-id="34e98-148">Pour obtenir le chemin d’accès à la racine du site Web, vous devez utiliser l’opérateur `~` (pour replacer la racine virtuelle du site) sur `MapPath`.</span><span class="sxs-lookup"><span data-stu-id="34e98-148">To get the path for the website root, you user the `~` operator (to represen the site's virtual root) to `MapPath`.</span></span> <span data-ttu-id="34e98-149">(Vous pouvez également lui transmettre un nom de sous-dossier, par exemple *~/App\_Data/* , pour obtenir le chemin d’accès à ce sous-dossier.) Vous pouvez ensuite concaténer des informations supplémentaires sur ce que la méthode retourne afin de créer un chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="34e98-149">(You can also pass a subfolder name to it, like *~/App\_Data/*, to get the path for that subfolder.) You can then concatenate additional information onto whatever the method returns in order to create a complete path.</span></span> <span data-ttu-id="34e98-150">Dans cet exemple, vous ajoutez un nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-150">In this example, you add a file name.</span></span> <span data-ttu-id="34e98-151">(Pour plus d’informations sur l’utilisation des chemins d’accès aux fichiers et aux dossiers, consultez [Introduction à la programmation d’pages Web ASP.net à l’aide de la syntaxe Razor](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span><span class="sxs-lookup"><span data-stu-id="34e98-151">(You can read more about how to work with file and folder paths in [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span></span>

    <span data-ttu-id="34e98-152">Le fichier est enregistré dans le dossier de données de l' *application\_* .</span><span class="sxs-lookup"><span data-stu-id="34e98-152">The file is saved in the *App\_Data* folder.</span></span> <span data-ttu-id="34e98-153">Ce dossier est un dossier spécial dans ASP.NET qui est utilisé pour stocker les fichiers de données, comme décrit dans [Introduction à l’utilisation d’une base de données dans des Sites pages Web ASP.net](https://go.microsoft.com/fwlink/?LinkId=195209).</span><span class="sxs-lookup"><span data-stu-id="34e98-153">This folder is a special folder in ASP.NET that's used to store data files, as described in [Introduction to Working with a Database in ASP.NET Web Pages Sites](https://go.microsoft.com/fwlink/?LinkId=195209).</span></span>

    <span data-ttu-id="34e98-154">La méthode `WriteAllText` de l’objet `File` écrit les données dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-154">The `WriteAllText` method of the `File` object writes the data to the file.</span></span> <span data-ttu-id="34e98-155">Cette méthode prend deux paramètres : le nom (avec le chemin d’accès) du fichier dans lequel écrire et les données réelles à écrire.</span><span class="sxs-lookup"><span data-stu-id="34e98-155">This method takes two parameters: the name (with path) of the file to write to, and the actual data to write.</span></span> <span data-ttu-id="34e98-156">Notez que le nom du premier paramètre a un caractère `@` en tant que préfixe.</span><span class="sxs-lookup"><span data-stu-id="34e98-156">Notice that the name of the first parameter has an `@` character as a prefix.</span></span> <span data-ttu-id="34e98-157">Cela indique à ASP.NET que vous fournissez un littéral de chaîne textuelle et que les caractères tels que « / » ne doivent pas être interprétés de manière spéciale.</span><span class="sxs-lookup"><span data-stu-id="34e98-157">This tells ASP.NET that you're providing a verbatim string literal, and that characters like "/" should not be interpreted in special ways.</span></span> <span data-ttu-id="34e98-158">(Pour plus d’informations, consultez [Présentation de la programmation Web ASP.net à l’aide de la syntaxe Razor](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span><span class="sxs-lookup"><span data-stu-id="34e98-158">(For more information, see [Introduction to ASP.NET Web Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span></span>

    > [!NOTE]
    > <span data-ttu-id="34e98-159">Pour que votre code puisse enregistrer des fichiers dans le dossier de données de l' *application\_* , l’application a besoin d’autorisations en lecture-écriture pour ce dossier.</span><span class="sxs-lookup"><span data-stu-id="34e98-159">In order for your code to save files in the *App\_Data* folder, the application needs read-write permissions for that folder.</span></span> <span data-ttu-id="34e98-160">Sur votre ordinateur de développement, ce n’est généralement pas un problème.</span><span class="sxs-lookup"><span data-stu-id="34e98-160">On your development computer this is not typically an issue.</span></span> <span data-ttu-id="34e98-161">Toutefois, lorsque vous publiez votre site sur le serveur Web d’un fournisseur d’hébergement, vous devrez peut-être définir explicitement ces autorisations.</span><span class="sxs-lookup"><span data-stu-id="34e98-161">However, when you publish your site to a hosting provider's web server, you might need to explicitly set those permissions.</span></span> <span data-ttu-id="34e98-162">Si vous exécutez ce code sur le serveur d’un fournisseur d’hébergement et que vous obtenez des erreurs, contactez le fournisseur d’hébergement pour savoir comment définir ces autorisations.</span><span class="sxs-lookup"><span data-stu-id="34e98-162">If you run this code on a hosting provider's server and get errors, check with the hosting provider to find out how to set those permissions.</span></span>

- <span data-ttu-id="34e98-163">Exécutez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="34e98-163">Run the page in a browser.</span></span> 

    ![](working-with-files/_static/image1.jpg)
- <span data-ttu-id="34e98-164">Entrez des valeurs dans les champs, puis cliquez sur **Envoyer**.</span><span class="sxs-lookup"><span data-stu-id="34e98-164">Enter values into the fields and then click **Submit**.</span></span>
- <span data-ttu-id="34e98-165">Fermez le navigateur.</span><span class="sxs-lookup"><span data-stu-id="34e98-165">Close the browser.</span></span>
- <span data-ttu-id="34e98-166">Revenez au projet et actualisez la vue.</span><span class="sxs-lookup"><span data-stu-id="34e98-166">Return to the project and refresh the view.</span></span>
- <span data-ttu-id="34e98-167">Ouvrez le fichier *Data. txt* .</span><span class="sxs-lookup"><span data-stu-id="34e98-167">Open the *data.txt* file.</span></span> <span data-ttu-id="34e98-168">Les données que vous avez envoyées dans le formulaire se trouvent dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-168">The data you submitted in the form is in the file.</span></span> 

    ![[image]](working-with-files/_static/image2.jpg)
- <span data-ttu-id="34e98-170">Fermez le fichier *Data. txt* .</span><span class="sxs-lookup"><span data-stu-id="34e98-170">Close the *data.txt* file.</span></span>

<a id="Appending_Data"></a>
## <a name="appending-data-to-an-existing-file"></a><span data-ttu-id="34e98-171">Ajout de données à un fichier existant</span><span class="sxs-lookup"><span data-stu-id="34e98-171">Appending Data to an Existing File</span></span>

<span data-ttu-id="34e98-172">Dans l’exemple précédent, vous avez utilisé `WriteAllText` pour créer un fichier texte contenant simplement un élément de données.</span><span class="sxs-lookup"><span data-stu-id="34e98-172">In the previous example, you used `WriteAllText` to create a text file that's got just one piece of data in it.</span></span> <span data-ttu-id="34e98-173">Si vous rappelez la méthode et que vous lui transmettez le même nom de fichier, le fichier existant est entièrement remplacé.</span><span class="sxs-lookup"><span data-stu-id="34e98-173">If you call the method again and pass it the same file name, the existing file is completely overwritten.</span></span> <span data-ttu-id="34e98-174">Toutefois, une fois que vous avez créé un fichier, vous souhaitez souvent ajouter de nouvelles données à la fin du fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-174">However, after you've created a file you often want to add new data to the end of the file.</span></span> <span data-ttu-id="34e98-175">Vous pouvez le faire à l’aide de la méthode `AppendAllText` de l’objet `File`.</span><span class="sxs-lookup"><span data-stu-id="34e98-175">You can do that using the `AppendAllText` method of the `File` object.</span></span>

1. <span data-ttu-id="34e98-176">Dans le site Web, effectuez une copie du fichier *UserData. cshtml* et nommez la copie *UserDataMultiple. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="34e98-176">In the website, make a copy of the *UserData.cshtml* file and name the copy *UserDataMultiple.cshtml*.</span></span>
2. <span data-ttu-id="34e98-177">Remplacez le bloc de code avant l’ouverture de la balise `<!DOCTYPE html>` par le bloc de code suivant :</span><span class="sxs-lookup"><span data-stu-id="34e98-177">Replace the code block before the opening `<!DOCTYPE html>` tag with the following code block:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample3.cshtml)]

    <span data-ttu-id="34e98-178">Ce code a une modification dans l’exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="34e98-178">This code has one change in it from the previous example.</span></span> <span data-ttu-id="34e98-179">Au lieu d’utiliser `WriteAllText`, elle utilise `the AppendAllText` méthode.</span><span class="sxs-lookup"><span data-stu-id="34e98-179">Instead of using `WriteAllText`, it uses `the AppendAllText` method.</span></span> <span data-ttu-id="34e98-180">Les méthodes sont similaires, à ceci près que `AppendAllText` ajoute les données à la fin du fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-180">The methods are similar, except that `AppendAllText` adds the data to the end of the file.</span></span> <span data-ttu-id="34e98-181">Comme avec `WriteAllText`, `AppendAllText` crée le fichier s’il n’existe pas déjà.</span><span class="sxs-lookup"><span data-stu-id="34e98-181">As with `WriteAllText`, `AppendAllText` creates the file if it doesn't already exist.</span></span>
3. <span data-ttu-id="34e98-182">Exécutez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="34e98-182">Run the page in a browser.</span></span>
4. <span data-ttu-id="34e98-183">Entrez des valeurs pour les champs, puis cliquez sur **Envoyer**.</span><span class="sxs-lookup"><span data-stu-id="34e98-183">Enter values for the fields and then click **Submit**.</span></span>
5. <span data-ttu-id="34e98-184">Ajoutez d’autres données et soumettez de nouveau le formulaire.</span><span class="sxs-lookup"><span data-stu-id="34e98-184">Add more data and submit the form again.</span></span>
6. <span data-ttu-id="34e98-185">Revenez à votre projet, cliquez avec le bouton droit sur le dossier du projet, puis cliquez sur **Actualiser**.</span><span class="sxs-lookup"><span data-stu-id="34e98-185">Return to your project, right-click the project folder, and then click **Refresh**.</span></span>
7. <span data-ttu-id="34e98-186">Ouvrez le fichier *Data. txt* .</span><span class="sxs-lookup"><span data-stu-id="34e98-186">Open the *data.txt* file.</span></span> <span data-ttu-id="34e98-187">Elle contient maintenant les nouvelles données que vous venez d’entrer.</span><span class="sxs-lookup"><span data-stu-id="34e98-187">It now contains the new data that you just entered.</span></span> 

    ![[image]](working-with-files/_static/image3.jpg)

<a id="Reading_and_Displaying_Data"></a>
## <a name="reading-and-displaying-data-from-a-file"></a><span data-ttu-id="34e98-189">Lecture et affichage de données à partir d’un fichier</span><span class="sxs-lookup"><span data-stu-id="34e98-189">Reading and Displaying Data from a File</span></span>

<span data-ttu-id="34e98-190">Même si vous n’avez pas besoin d’écrire des données dans un fichier texte, vous devrez probablement lire les données d’un.</span><span class="sxs-lookup"><span data-stu-id="34e98-190">Even if you don't need to write data to a text file, you'll probably sometimes need to read data from one.</span></span> <span data-ttu-id="34e98-191">Pour ce faire, vous pouvez utiliser à nouveau l’objet `File`.</span><span class="sxs-lookup"><span data-stu-id="34e98-191">To do this, you can again use the `File` object.</span></span> <span data-ttu-id="34e98-192">Vous pouvez utiliser l’objet `File` pour lire chaque ligne individuellement (séparées par des sauts de ligne) ou pour lire un élément individuel, quelle que soit la façon dont ils sont séparés.</span><span class="sxs-lookup"><span data-stu-id="34e98-192">You can use the `File` object to read each line individually (separated by line breaks) or to read individual item no matter how they're separated.</span></span>

<span data-ttu-id="34e98-193">Cette procédure vous montre comment lire et afficher les données que vous avez créées dans l’exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="34e98-193">This procedure shows you how to read and display the data that you created in the previous example.</span></span>

1. <span data-ttu-id="34e98-194">À la racine de votre site Web, créez un nouveau fichier nommé *displayData. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="34e98-194">At the root of your website, create a new file named *DisplayData.cshtml*.</span></span>
2. <span data-ttu-id="34e98-195">Remplacez le contenu existant par ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-195">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample4.cshtml)]

    <span data-ttu-id="34e98-196">Le code commence par lire le fichier que vous avez créé dans l’exemple précédent dans une variable nommée `userData`, à l’aide de cet appel de méthode :</span><span class="sxs-lookup"><span data-stu-id="34e98-196">The code starts by reading the file that you created in the previous example into a variable named `userData`, using this method call:</span></span>

    [!code-css[Main](working-with-files/samples/sample5.css)]

    <span data-ttu-id="34e98-197">Pour ce faire, le code est à l’intérieur d’une instruction `if`.</span><span class="sxs-lookup"><span data-stu-id="34e98-197">The code to do this is inside an `if` statement.</span></span> <span data-ttu-id="34e98-198">Lorsque vous souhaitez lire un fichier, il est judicieux d’utiliser la méthode `File.Exists` pour déterminer d’abord si le fichier est disponible.</span><span class="sxs-lookup"><span data-stu-id="34e98-198">When you want to read a file, it's a good idea to use the `File.Exists` method to determine first whether the file is available.</span></span> <span data-ttu-id="34e98-199">Le code vérifie également si le fichier est vide.</span><span class="sxs-lookup"><span data-stu-id="34e98-199">The code also checks whether the file is empty.</span></span>

    <span data-ttu-id="34e98-200">Le corps de la page contient deux boucles `foreach`, une imbriquée à l’intérieur de l’autre.</span><span class="sxs-lookup"><span data-stu-id="34e98-200">The body of the page contains two `foreach` loops, one nested inside the other.</span></span> <span data-ttu-id="34e98-201">La boucle `foreach` externe obtient une ligne à la fois à partir du fichier de données.</span><span class="sxs-lookup"><span data-stu-id="34e98-201">The outer `foreach` loop gets one line at a time from the data file.</span></span> <span data-ttu-id="34e98-202">Dans ce cas, les lignes sont définies par des sauts de ligne &#8212; dans le fichier qui est, chaque élément de données se trouve sur sa propre ligne.</span><span class="sxs-lookup"><span data-stu-id="34e98-202">In this case, the lines are defined by line breaks in the file &#8212; that is, each data item is on its own line.</span></span> <span data-ttu-id="34e98-203">La boucle externe crée un nouvel élément (élément`<li>`) à l’intérieur d’une liste triée (élément`<ol>`).</span><span class="sxs-lookup"><span data-stu-id="34e98-203">The outer loop creates a new item (`<li>` element) inside an ordered list (`<ol>` element).</span></span>

    <span data-ttu-id="34e98-204">La boucle interne fractionne chaque ligne de données en éléments (champs) à l’aide d’une virgule comme délimiteur.</span><span class="sxs-lookup"><span data-stu-id="34e98-204">The inner loop splits each data line into items (fields) using a comma as a delimiter.</span></span> <span data-ttu-id="34e98-205">(En fonction de l’exemple précédent, cela signifie que chaque ligne contient trois &#8212; champs, le prénom, le nom et l’adresse de messagerie, chacun étant séparé par une virgule.) La boucle interne crée également une liste de `<ul>` et affiche un élément de liste pour chaque champ de la ligne de données.</span><span class="sxs-lookup"><span data-stu-id="34e98-205">(Based on the previous example, this means that each line contains three fields &#8212; the first name, last name, and email address, each separated by a comma.) The inner loop also creates a `<ul>` list and displays one list item for each field in the data line.</span></span>

    <span data-ttu-id="34e98-206">Le code illustre l’utilisation de deux types de données : un tableau et le type de données `char`.</span><span class="sxs-lookup"><span data-stu-id="34e98-206">The code illustrates how to use two data types, an array and the `char` data type.</span></span> <span data-ttu-id="34e98-207">Le tableau est obligatoire, car la méthode `File.ReadAllLines` retourne les données sous forme de tableau.</span><span class="sxs-lookup"><span data-stu-id="34e98-207">The array is required because the `File.ReadAllLines` method returns data as an array.</span></span> <span data-ttu-id="34e98-208">Le type de données `char` est obligatoire, car la méthode `Split` retourne un `array` dans lequel chaque élément est de type `char`.</span><span class="sxs-lookup"><span data-stu-id="34e98-208">The `char` data type is required because the `Split` method returns an `array` in which each element is of the type `char`.</span></span> <span data-ttu-id="34e98-209">(Pour plus d’informations sur les tableaux, consultez [Introduction à la programmation Web ASP.net à l’aide de la syntaxe Razor](https://go.microsoft.com/fwlink/?LinkId=202890#ID_CollectionsAndObjects).)</span><span class="sxs-lookup"><span data-stu-id="34e98-209">(For information about arrays, see [Introduction to ASP.NET Web Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=202890#ID_CollectionsAndObjects).)</span></span>
3. <span data-ttu-id="34e98-210">Exécutez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="34e98-210">Run the page in a browser.</span></span> <span data-ttu-id="34e98-211">Les données que vous avez entrées pour les exemples précédents sont affichées.</span><span class="sxs-lookup"><span data-stu-id="34e98-211">The data you entered for the previous examples is displayed.</span></span> 

    ![[image]](working-with-files/_static/image4.jpg)

> [!TIP] 
> 
> <span data-ttu-id="34e98-213">**Affichage de données à partir d’un fichier délimité par des virgules Microsoft Excel**</span><span class="sxs-lookup"><span data-stu-id="34e98-213">**Displaying Data from a Microsoft Excel Comma-Delimited File**</span></span>
> 
> <span data-ttu-id="34e98-214">Vous pouvez utiliser Microsoft Excel pour enregistrer les données contenues dans une feuille de calcul sous la forme d’un fichier délimité par des virgules ( *. csv* ).</span><span class="sxs-lookup"><span data-stu-id="34e98-214">You can use Microsoft Excel to save the data contained in a spreadsheet as a comma-delimited file (*.csv* file).</span></span> <span data-ttu-id="34e98-215">Dans ce cas, le fichier est enregistré en texte brut, et non au format Excel.</span><span class="sxs-lookup"><span data-stu-id="34e98-215">When you do, the file is saved in plain text, not in Excel format.</span></span> <span data-ttu-id="34e98-216">Chaque ligne de la feuille de calcul est séparée par un saut de ligne dans le fichier texte, et chaque élément de données est séparé par une virgule.</span><span class="sxs-lookup"><span data-stu-id="34e98-216">Each row in the spreadsheet is separated by a line break in the text file, and each data item is separated by a comma.</span></span> <span data-ttu-id="34e98-217">Vous pouvez utiliser le code indiqué dans l’exemple précédent pour lire un fichier Excel délimité par des virgules simplement en modifiant le nom du fichier de données dans votre code.</span><span class="sxs-lookup"><span data-stu-id="34e98-217">You can use the code shown in the previous example to read an Excel comma-delimited file just by changing the name of the data file in your code.</span></span>

<a id="Deleting_Files"></a>
## <a name="deleting-files"></a><span data-ttu-id="34e98-218">Suppression de fichiers</span><span class="sxs-lookup"><span data-stu-id="34e98-218">Deleting Files</span></span>

<span data-ttu-id="34e98-219">Pour supprimer des fichiers de votre site Web, vous pouvez utiliser la méthode `File.Delete`.</span><span class="sxs-lookup"><span data-stu-id="34e98-219">To delete files from your website, you can use the `File.Delete` method.</span></span> <span data-ttu-id="34e98-220">Cette procédure montre comment permettre aux utilisateurs de supprimer une image (fichier *. jpg* ) d’un dossier *images* s’ils connaissent le nom du fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-220">This procedure shows how to let users delete an image (*.jpg* file) from an *images* folder if they know the name of the file.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="34e98-221">**Important** Dans un site Web de production, vous limitez généralement les personnes autorisées à apporter des modifications aux données.</span><span class="sxs-lookup"><span data-stu-id="34e98-221">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="34e98-222">Pour plus d’informations sur la configuration de l’appartenance et sur les façons d’autoriser les utilisateurs à effectuer des tâches sur le site, consultez [Ajout de la sécurité et de l’appartenance à un site pages Web ASP.net](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="34e98-222">For information about how to set up membership and about ways to authorize users to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="34e98-223">Dans le site Web, créez un sous-dossier nommé *images*.</span><span class="sxs-lookup"><span data-stu-id="34e98-223">In the website, create a subfolder named *images*.</span></span>
2. <span data-ttu-id="34e98-224">Copiez un ou plusieurs fichiers *. jpg* dans le dossier *images* .</span><span class="sxs-lookup"><span data-stu-id="34e98-224">Copy one or more *.jpg* files into the *images* folder.</span></span>
3. <span data-ttu-id="34e98-225">À la racine du site Web, créez un nouveau fichier nommé *FileDelete. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="34e98-225">In the root of the website, create a new file named *FileDelete.cshtml*.</span></span>
4. <span data-ttu-id="34e98-226">Remplacez le contenu existant par ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-226">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample6.cshtml)]

    <span data-ttu-id="34e98-227">Cette page contient un formulaire dans lequel les utilisateurs peuvent entrer le nom d’un fichier image.</span><span class="sxs-lookup"><span data-stu-id="34e98-227">This page contains a form where users can enter the name of an image file.</span></span> <span data-ttu-id="34e98-228">Ils n’entrent pas l’extension de nom de fichier *. jpg* ; en restreignant le nom de fichier comme celui-ci, vous pouvez empêcher les utilisateurs de supprimer des fichiers arbitraires sur votre site.</span><span class="sxs-lookup"><span data-stu-id="34e98-228">They don't enter the *.jpg* file-name extension; by restricting the file name like this, you help prevents users from deleting arbitrary files on your site.</span></span>

    <span data-ttu-id="34e98-229">Le code lit le nom de fichier que l’utilisateur a entré, puis construit un chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="34e98-229">The code reads the file name that the user has entered and then constructs a complete path.</span></span> <span data-ttu-id="34e98-230">Pour créer le chemin d’accès, le code utilise le chemin d’accès au site Web actuel (tel que retourné par la méthode `Server.MapPath`), le nom du dossier *images* , le nom que l’utilisateur a fourni et « . jpg » comme chaîne littérale.</span><span class="sxs-lookup"><span data-stu-id="34e98-230">To create the path, the code uses the current website path (as returned by the `Server.MapPath` method), the *images* folder name, the name that the user has provided, and ".jpg" as a literal string.</span></span>

    <span data-ttu-id="34e98-231">Pour supprimer le fichier, le code appelle la méthode `File.Delete`, en lui transmettant le chemin d’accès complet que vous venez de construire.</span><span class="sxs-lookup"><span data-stu-id="34e98-231">To delete the file, the code calls the `File.Delete` method, passing it the full path that you just constructed.</span></span> <span data-ttu-id="34e98-232">À la fin du balisage, le code affiche un message de confirmation indiquant que le fichier a été supprimé.</span><span class="sxs-lookup"><span data-stu-id="34e98-232">At the end of the markup, code displays a confirmation message that the file was deleted.</span></span>
5. <span data-ttu-id="34e98-233">Exécutez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="34e98-233">Run the page in a browser.</span></span> 

    ![[image]](working-with-files/_static/image5.jpg)
6. <span data-ttu-id="34e98-235">Entrez le nom du fichier à supprimer, puis cliquez sur **Envoyer**.</span><span class="sxs-lookup"><span data-stu-id="34e98-235">Enter the name of the file to delete and then click **Submit**.</span></span> <span data-ttu-id="34e98-236">Si le fichier a été supprimé, le nom du fichier s’affiche au bas de la page.</span><span class="sxs-lookup"><span data-stu-id="34e98-236">If the file was deleted, the name of the file is displayed at the bottom of the page.</span></span>

<a id="Letting_Users_Upload_a_File"></a>
## <a name="letting-users-upload-a-file"></a><span data-ttu-id="34e98-237">Permettre aux utilisateurs de charger un fichier</span><span class="sxs-lookup"><span data-stu-id="34e98-237">Letting Users Upload a File</span></span>

<span data-ttu-id="34e98-238">Le `FileUpload` Helper permet aux utilisateurs de charger des fichiers sur votre site Web.</span><span class="sxs-lookup"><span data-stu-id="34e98-238">The `FileUpload` helper lets users upload files to your website.</span></span> <span data-ttu-id="34e98-239">La procédure suivante vous montre comment permettre aux utilisateurs de charger un fichier unique.</span><span class="sxs-lookup"><span data-stu-id="34e98-239">The procedure below shows you how to let users upload a single file.</span></span>

1. <span data-ttu-id="34e98-240">Ajoutez la bibliothèque d’applications auxiliaires Web ASP.NET à votre site Web, comme décrit dans la rubrique [installation des applications d’assistance d’un Site pages Web ASP.net](https://go.microsoft.com/fwlink/?LinkId=252372), si vous ne l’avez pas encore ajoutée.</span><span class="sxs-lookup"><span data-stu-id="34e98-240">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you didn't add it previously.</span></span>
2. <span data-ttu-id="34e98-241">Dans le dossier de données de l' *application\_* , créez un dossier et nommez-le *uploadedfiles*.</span><span class="sxs-lookup"><span data-stu-id="34e98-241">In the *App\_Data* folder, create a new a folder and name it *UploadedFiles*.</span></span>
3. <span data-ttu-id="34e98-242">Dans la racine, créez un nouveau fichier nommé *FileUpload. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="34e98-242">In the root, create a new file named *FileUpload.cshtml*.</span></span>
4. <span data-ttu-id="34e98-243">Remplacez le contenu existant de la page par ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-243">Replace the existing content in the page with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample7.cshtml)]

    <span data-ttu-id="34e98-244">La partie du corps de la page utilise le programme d’assistance `FileUpload` pour créer la zone de téléchargement et les boutons que vous connaissez probablement :</span><span class="sxs-lookup"><span data-stu-id="34e98-244">The body portion of the page uses the `FileUpload` helper to create the upload box and buttons that you're probably familiar with:</span></span>

    ![[image]](working-with-files/_static/image6.jpg)

    <span data-ttu-id="34e98-246">Les propriétés que vous définissez pour le `FileUpload` Helper spécifient que vous souhaitez qu’une seule zone soit téléchargée pour le fichier et que vous souhaitiez que le bouton Envoyer Lise le **Téléchargement**.</span><span class="sxs-lookup"><span data-stu-id="34e98-246">The properties that you set for the `FileUpload` helper specify that you want a single box for the file to upload and that you want the submit button to read **Upload**.</span></span> <span data-ttu-id="34e98-247">(Vous ajouterez d’autres zones plus loin dans cet article.)</span><span class="sxs-lookup"><span data-stu-id="34e98-247">(You'll add more boxes later in the article.)</span></span>

    <span data-ttu-id="34e98-248">Quand l’utilisateur clique sur **Télécharger**, le code situé en haut de la page obtient le fichier et l’enregistre.</span><span class="sxs-lookup"><span data-stu-id="34e98-248">When the user clicks **Upload**, the code at the top of the page gets the file and saves it.</span></span> <span data-ttu-id="34e98-249">L’objet `Request` que vous utilisez habituellement pour obtenir des valeurs à partir des champs de formulaire possède également un tableau `Files` contenant le ou les fichiers qui ont été téléchargés.</span><span class="sxs-lookup"><span data-stu-id="34e98-249">The `Request` object that you normally use to get values from form fields also has a `Files` array that contains the file (or files) that have been uploaded.</span></span> <span data-ttu-id="34e98-250">Vous pouvez obtenir des fichiers individuels d’une position spécifique dans le &#8212; tableau. par exemple, pour obtenir le premier fichier téléchargé, vous avez `Request.Files[0]`, pour obtenir le deuxième fichier, vous devez obtenir `Request.Files[1]`, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="34e98-250">You can get individual files out of specific positions in the array &#8212; for example, to get the first uploaded file, you get `Request.Files[0]`, to get the second file, you get `Request.Files[1]`, and so on.</span></span> <span data-ttu-id="34e98-251">(N’oubliez pas que, en programmation, le comptage commence généralement à zéro.)</span><span class="sxs-lookup"><span data-stu-id="34e98-251">(Remember that in programming, counting usually starts at zero.)</span></span>

    <span data-ttu-id="34e98-252">Lorsque vous récupérez un fichier téléchargé, vous le placez dans une variable (ici, `uploadedFile`) afin de pouvoir le manipuler.</span><span class="sxs-lookup"><span data-stu-id="34e98-252">When you fetch an uploaded file, you put it in a variable (here, `uploadedFile`) so that you can manipulate it.</span></span> <span data-ttu-id="34e98-253">Pour déterminer le nom du fichier téléchargé, il vous suffit d’obtenir sa propriété `FileName`.</span><span class="sxs-lookup"><span data-stu-id="34e98-253">To determine the name of the uploaded file, you just get its `FileName` property.</span></span> <span data-ttu-id="34e98-254">Toutefois, lorsque l’utilisateur charge un fichier, `FileName` contient le nom d’origine de l’utilisateur, qui inclut le chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="34e98-254">However, when the user uploads a file, `FileName` contains the user's original name, which includes the entire path.</span></span> <span data-ttu-id="34e98-255">Elle peut se présenter comme suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-255">It might look like this:</span></span>

    <span data-ttu-id="34e98-256">*C:\Users\Public\Sample.txt*</span><span class="sxs-lookup"><span data-stu-id="34e98-256">*C:\Users\Public\Sample.txt*</span></span>

    <span data-ttu-id="34e98-257">Toutefois, vous ne souhaitez pas toutes ces informations de chemin d’accès, car il s’agit du chemin d’accès sur l’ordinateur de l’utilisateur, et non pas pour votre serveur.</span><span class="sxs-lookup"><span data-stu-id="34e98-257">You don't want all that path information, though, because that's the path on the user's computer, not for your server.</span></span> <span data-ttu-id="34e98-258">Vous souhaitez juste le nom de fichier réel (*Sample. txt*).</span><span class="sxs-lookup"><span data-stu-id="34e98-258">You just want the actual file name (*Sample.txt*).</span></span> <span data-ttu-id="34e98-259">Vous pouvez supprimer uniquement le fichier d’un chemin d’accès à l’aide de la méthode `Path.GetFileName`, comme suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-259">You can strip out just the file from a path by using the `Path.GetFileName` method, like this:</span></span>

    [!code-csharp[Main](working-with-files/samples/sample8.cs)]

    <span data-ttu-id="34e98-260">L’objet `Path` est un utilitaire qui a plusieurs méthodes comme celles-ci, que vous pouvez utiliser pour supprimer les chemins d’accès, combiner les chemins d’accès, etc.</span><span class="sxs-lookup"><span data-stu-id="34e98-260">The `Path` object is a utility that has a number of methods like this that you can use to strip paths, combine paths, and so on.</span></span>

    <span data-ttu-id="34e98-261">Une fois que vous avez obtenu le nom du fichier téléchargé, vous pouvez créer un nouveau chemin d’accès pour l’emplacement où vous souhaitez stocker le fichier chargé dans votre site Web.</span><span class="sxs-lookup"><span data-stu-id="34e98-261">Once you've gotten the name of the uploaded file, you can build a new path for where you want to store the uploaded file in your website.</span></span> <span data-ttu-id="34e98-262">Dans ce cas, vous combinez `Server.MapPath`, les noms de dossiers (*application\_Data/uploadedfiles*) et le nom de fichier nouvellement supprimé pour créer un nouveau chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="34e98-262">In this case, you combine `Server.MapPath`, the folder names (*App\_Data/UploadedFiles*), and the newly stripped file name to create a new path.</span></span> <span data-ttu-id="34e98-263">Vous pouvez ensuite appeler la méthode `SaveAs` du fichier chargé pour enregistrer le fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-263">You can then call the uploaded file's `SaveAs` method to actually save the file.</span></span>
5. <span data-ttu-id="34e98-264">Exécutez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="34e98-264">Run the page in a browser.</span></span> 

    ![[image]](working-with-files/_static/image7.jpg)
6. <span data-ttu-id="34e98-266">Cliquez sur **Parcourir** , puis sélectionnez un fichier à charger.</span><span class="sxs-lookup"><span data-stu-id="34e98-266">Click **Browse** and then select a file to upload.</span></span> 

    ![[image]](working-with-files/_static/image8.jpg)

    <span data-ttu-id="34e98-268">La zone de texte en regard du bouton **Parcourir** contient le chemin d’accès et l’emplacement du fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-268">The text box next to the **Browse** button will contain the path and file location.</span></span>

    ![[image]](working-with-files/_static/image9.jpg)
7. <span data-ttu-id="34e98-270">Cliquez sur **Upload**.</span><span class="sxs-lookup"><span data-stu-id="34e98-270">Click **Upload**.</span></span>
8. <span data-ttu-id="34e98-271">Dans le site Web, cliquez avec le bouton droit sur le dossier du projet, puis cliquez sur **Actualiser**.</span><span class="sxs-lookup"><span data-stu-id="34e98-271">In the website, right-click the project folder and then click **Refresh**.</span></span>
9. <span data-ttu-id="34e98-272">Ouvrez le dossier *uploadedfiles* .</span><span class="sxs-lookup"><span data-stu-id="34e98-272">Open the *UploadedFiles* folder.</span></span> <span data-ttu-id="34e98-273">Le fichier que vous avez chargé se trouve dans le dossier.</span><span class="sxs-lookup"><span data-stu-id="34e98-273">The file that you uploaded is in the folder.</span></span> 

    ![[image]](working-with-files/_static/image10.jpg)

<a id="Letting_Users_Upload_Multiple_Files"></a>
## <a name="letting-users-upload-multiple-files"></a><span data-ttu-id="34e98-275">Permettre aux utilisateurs de télécharger plusieurs fichiers</span><span class="sxs-lookup"><span data-stu-id="34e98-275">Letting Users Upload Multiple Files</span></span>

<span data-ttu-id="34e98-276">Dans l’exemple précédent, vous autorisez les utilisateurs à télécharger un fichier.</span><span class="sxs-lookup"><span data-stu-id="34e98-276">In the previous example, you let users upload one file.</span></span> <span data-ttu-id="34e98-277">Toutefois, vous pouvez utiliser le programme d’assistance `FileUpload` pour télécharger plusieurs fichiers à la fois.</span><span class="sxs-lookup"><span data-stu-id="34e98-277">But you can use the `FileUpload` helper to upload more than one file at a time.</span></span> <span data-ttu-id="34e98-278">Cela est pratique pour des scénarios tels que le chargement de photos, où le téléchargement d’un fichier à la fois est fastidieux.</span><span class="sxs-lookup"><span data-stu-id="34e98-278">This is handy for scenarios like uploading photos, where uploading one file at a time is tedious.</span></span> <span data-ttu-id="34e98-279">(Vous pouvez en savoir plus sur le chargement de photos dans [utilisation d’images dans un Site pages Web ASP.net](https://go.microsoft.com/fwlink/?LinkId=202897).) Cet exemple montre comment permettre aux utilisateurs de télécharger deux à la fois, bien que vous puissiez utiliser la même technique pour télécharger plus que cela.</span><span class="sxs-lookup"><span data-stu-id="34e98-279">(You can read about uploading photos in [Working with Images in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202897).) This example shows how to let users upload two at a time, although you can use the same technique to upload more than that.</span></span>

1. <span data-ttu-id="34e98-280">Ajoutez la bibliothèque d’applications auxiliaires Web ASP.NET à votre site Web, comme décrit dans la rubrique [installation des applications d’assistance d’un Site pages Web ASP.net](https://go.microsoft.com/fwlink/?LinkId=252372), si vous ne l’avez pas déjà fait.</span><span class="sxs-lookup"><span data-stu-id="34e98-280">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you haven't already.</span></span>
2. <span data-ttu-id="34e98-281">Créez une nouvelle page nommée *FileUploadMultiple. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="34e98-281">Create a new page named *FileUploadMultiple.cshtml*.</span></span>
3. <span data-ttu-id="34e98-282">Remplacez le contenu existant de la page par ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-282">Replace the existing content in the page with the following:</span></span>  

    [!code-cshtml[Main](working-with-files/samples/sample9.cshtml)]

    <span data-ttu-id="34e98-283">Dans cet exemple, le programme d’assistance `FileUpload` dans le corps de la page est configuré pour permettre aux utilisateurs de télécharger deux fichiers par défaut.</span><span class="sxs-lookup"><span data-stu-id="34e98-283">In this example, the `FileUpload` helper in the body of the page is configured to let users upload two files by default.</span></span> <span data-ttu-id="34e98-284">Étant donné que `allowMoreFilesToBeAdded` a la valeur `true`, le programme d’assistance affiche un lien qui permet à l’utilisateur d’ajouter d’autres zones de téléchargement :</span><span class="sxs-lookup"><span data-stu-id="34e98-284">Because `allowMoreFilesToBeAdded` is set to `true`, the helper renders a link that lets user add more upload boxes:</span></span>

    ![[image]](working-with-files/_static/image11.jpg)

    <span data-ttu-id="34e98-286">Pour traiter les fichiers que l’utilisateur charge, le code utilise la même technique de base que celle utilisée dans l’exemple &#8212; précédent pour obtenir un fichier de `Request.Files` puis l’enregistrer.</span><span class="sxs-lookup"><span data-stu-id="34e98-286">To process the files that the user uploads, the code uses the same basic technique that you used in the previous example &#8212; get a file from `Request.Files` and then save it.</span></span> <span data-ttu-id="34e98-287">(Y compris les différents éléments que vous devez faire pour connaître le nom de fichier et le chemin d’accès appropriés). Cette fois-ci, l’innovation est que l’utilisateur peut charger plusieurs fichiers et que vous n’en connaissez pas beaucoup.</span><span class="sxs-lookup"><span data-stu-id="34e98-287">(Including the various things you need to do to get the right file name and path.) The innovation this time is that the user might be uploading multiple files and you don't know many.</span></span> <span data-ttu-id="34e98-288">Pour en savoir plus, vous pouvez obtenir `Request.Files.Count`.</span><span class="sxs-lookup"><span data-stu-id="34e98-288">To find out, you can get `Request.Files.Count`.</span></span>

    <span data-ttu-id="34e98-289">Avec ce nombre en main, vous pouvez parcourir `Request.Files`, extraire chaque fichier à son tour, puis l’enregistrer.</span><span class="sxs-lookup"><span data-stu-id="34e98-289">With this number in hand, you can loop through `Request.Files`, fetch each file in turn, and save it.</span></span> <span data-ttu-id="34e98-290">Lorsque vous souhaitez effectuer une boucle d’un nombre de fois connu dans une collection, vous pouvez utiliser une boucle `for`, comme suit :</span><span class="sxs-lookup"><span data-stu-id="34e98-290">When you want to loop a known number of times through a collection, you can use a `for` loop, like this:</span></span>

    [!code-csharp[Main](working-with-files/samples/sample10.cs)]

    <span data-ttu-id="34e98-291">La variable `i` est simplement un compteur temporaire qui passera de zéro à la limite supérieure que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="34e98-291">The variable `i` is just a temporary counter that will go from zero to whatever upper limit you set.</span></span> <span data-ttu-id="34e98-292">Dans ce cas, la limite supérieure est le nombre de fichiers.</span><span class="sxs-lookup"><span data-stu-id="34e98-292">In this case, the upper limit is the number of files.</span></span> <span data-ttu-id="34e98-293">Toutefois, étant donné que le compteur commence à zéro, comme c’est généralement le cas pour les scénarios de comptage dans ASP.NET, la limite supérieure est en fait inférieure d’une unité au nombre de fichiers.</span><span class="sxs-lookup"><span data-stu-id="34e98-293">But because the counter starts at zero, as is typical for counting scenarios in ASP.NET, the upper limit is actually one less than the file count.</span></span> <span data-ttu-id="34e98-294">(Si trois fichiers sont téléchargés, le nombre est de 0 à 2.)</span><span class="sxs-lookup"><span data-stu-id="34e98-294">(If three files are uploaded, the count is zero to 2.)</span></span>

    <span data-ttu-id="34e98-295">La variable `uploadedCount` totalise tous les fichiers qui ont été téléchargés et enregistrés avec succès.</span><span class="sxs-lookup"><span data-stu-id="34e98-295">The `uploadedCount` variable totals all the files that are successfully uploaded and saved.</span></span> <span data-ttu-id="34e98-296">Ce code tient compte de la possibilité qu’un fichier attendu ne puisse pas être téléchargé.</span><span class="sxs-lookup"><span data-stu-id="34e98-296">This code accounts for the possibility that an expected file may not be able to be uploaded.</span></span>
4. <span data-ttu-id="34e98-297">Exécutez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="34e98-297">Run the page in a browser.</span></span> <span data-ttu-id="34e98-298">Le navigateur affiche la page et ses deux zones de téléchargement.</span><span class="sxs-lookup"><span data-stu-id="34e98-298">The browser displays the page and its two upload boxes.</span></span>
5. <span data-ttu-id="34e98-299">Sélectionnez deux fichiers à charger.</span><span class="sxs-lookup"><span data-stu-id="34e98-299">Select two files to upload.</span></span>
6. <span data-ttu-id="34e98-300">Cliquez sur **Ajouter un autre fichier**.</span><span class="sxs-lookup"><span data-stu-id="34e98-300">Click **Add another file**.</span></span> <span data-ttu-id="34e98-301">La page affiche une nouvelle zone de téléchargement.</span><span class="sxs-lookup"><span data-stu-id="34e98-301">The page displays a new upload box.</span></span> 

    ![[image]](working-with-files/_static/image12.jpg)
7. <span data-ttu-id="34e98-303">Cliquez sur **Upload**.</span><span class="sxs-lookup"><span data-stu-id="34e98-303">Click **Upload**.</span></span>
8. <span data-ttu-id="34e98-304">Dans le site Web, cliquez avec le bouton droit sur le dossier du projet, puis cliquez sur **Actualiser**.</span><span class="sxs-lookup"><span data-stu-id="34e98-304">In the website, right-click the project folder and then click **Refresh**.</span></span>
9. <span data-ttu-id="34e98-305">Ouvrez le dossier *uploadedfiles* pour voir les fichiers chargés avec succès.</span><span class="sxs-lookup"><span data-stu-id="34e98-305">Open the *UploadedFiles* folder to see the successfully uploaded files.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="34e98-306">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="34e98-306">Additional Resources</span></span>

[<span data-ttu-id="34e98-307">Utilisation d’images dans un site pages Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="34e98-307">Working with Images in an ASP.NET Web Pages Site</span></span>](https://go.microsoft.com/fwlink/?LinkId=202897)

[<span data-ttu-id="34e98-308">Exportation vers un fichier CSV</span><span class="sxs-lookup"><span data-stu-id="34e98-308">Exporting to a CSV File</span></span>](https://msdn.microsoft.com/library/ms155919.aspx)
