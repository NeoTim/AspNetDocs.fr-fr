---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/troubleshooting-the-packaging-process
title: Résolution des problèmes liés au processus d’empaquetage | Microsoft Docs
author: jrjlee
description: Cette rubrique décrit comment collecter des informations détaillées sur le processus d’empaquetage à l’aide de la propriété EnablePackageProcessLoggingAndAssert dans la section M...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 794bd819-00fc-47e2-876d-fc5d15e0de1c
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/troubleshooting-the-packaging-process
msc.type: authoredcontent
ms.openlocfilehash: 8ad649dfff085a8774cc13c11d8a3e3d48277d66
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78628211"
---
# <a name="troubleshooting-the-packaging-process"></a><span data-ttu-id="e2bab-103">Résolution des problèmes du processus d’empaquetage</span><span class="sxs-lookup"><span data-stu-id="e2bab-103">Troubleshooting the Packaging Process</span></span>

<span data-ttu-id="e2bab-104">par [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="e2bab-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="e2bab-105">Télécharger PDF</span><span class="sxs-lookup"><span data-stu-id="e2bab-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="e2bab-106">Cette rubrique décrit comment vous pouvez collecter des informations détaillées sur le processus d’empaquetage à l’aide de la propriété **EnablePackageProcessLoggingAndAssert** dans le Microsoft Build Engine (MSBuild).</span><span class="sxs-lookup"><span data-stu-id="e2bab-106">This topic describes how you can collect detailed information about the packaging process by using the **EnablePackageProcessLoggingAndAssert** property in the Microsoft Build Engine (MSBuild).</span></span>
> 
> <span data-ttu-id="e2bab-107">Lorsque vous affectez la **valeur true**à la propriété **EnablePackageProcessLoggingAndAssert** , MSBuild :</span><span class="sxs-lookup"><span data-stu-id="e2bab-107">When you set the **EnablePackageProcessLoggingAndAssert** property to **true**, MSBuild will:</span></span>
> 
> - <span data-ttu-id="e2bab-108">Ajoutez des informations supplémentaires sur le processus de création de package aux journaux de génération.</span><span class="sxs-lookup"><span data-stu-id="e2bab-108">Add additional information about the packaging process to the build logs.</span></span>
> - <span data-ttu-id="e2bab-109">Consignez les erreurs dans certaines conditions, par exemple, si des fichiers dupliqués sont trouvés dans la liste des packages.</span><span class="sxs-lookup"><span data-stu-id="e2bab-109">Log errors under certain conditions, for example, if duplicate files are found in the packaging list.</span></span>
> - <span data-ttu-id="e2bab-110">Créez un répertoire de journaux dans le dossier *ProjectName*\_package et utilisez-le pour enregistrer des informations sur les fichiers que vous empaquetez.</span><span class="sxs-lookup"><span data-stu-id="e2bab-110">Create a Log directory in the *ProjectName*\_Package folder and use it to record information about the files you're packaging.</span></span>
> 
> <span data-ttu-id="e2bab-111">Si le processus d’empaquetage échoue, ou si vos packages de déploiement Web ne contiennent pas les fichiers attendus, vous pouvez utiliser ces informations pour résoudre les problèmes liés au processus et identifier les problèmes qui se posent.</span><span class="sxs-lookup"><span data-stu-id="e2bab-111">If the packaging process is failing, or your web deployment packages don't contain the files that you expect, you can use this information to troubleshoot the process and pinpoint where things are going wrong.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="e2bab-112">La propriété **EnablePackageProcessLoggingAndAssert** ne fonctionne que si vous générez votre projet à l’aide de la configuration **Debug** .</span><span class="sxs-lookup"><span data-stu-id="e2bab-112">The **EnablePackageProcessLoggingAndAssert** property only works if you build your project using the **Debug** configuration.</span></span> <span data-ttu-id="e2bab-113">La propriété est ignorée dans les autres configurations.</span><span class="sxs-lookup"><span data-stu-id="e2bab-113">The property is ignored in other configurations.</span></span>

<span data-ttu-id="e2bab-114">Cette rubrique fait partie d’une série de didacticiels basés sur les exigences de déploiement en entreprise d’une société fictive nommée Fabrikam, Inc. Cette série de didacticiels utilise un&#x2014;exemple de solution de [gestion des contacts](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;pour représenter une application Web avec un niveau de complexité réaliste, y compris une application ASP.NET MVC 3, un service Windows Communication Foundation (WCF) et un projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="e2bab-114">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="e2bab-115">La méthode de déploiement au cœur de ces didacticiels est basée sur l’approche de fichier de projet fractionné décrite dans [fonctionnement du fichier projet](../web-deployment-in-the-enterprise/understanding-the-project-file.md), dans lequel le processus de génération est contrôlé&#x2014;par deux fichiers projet qui contiennent des instructions de génération qui s’appliquent à chaque environnement de destination, et un qui contient des paramètres de génération et de déploiement spécifiques à l’environnement.</span><span class="sxs-lookup"><span data-stu-id="e2bab-115">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="e2bab-116">Au moment de la génération, le fichier projet spécifique à l’environnement est fusionné dans le fichier projet indépendant de l’environnement pour former un ensemble complet d’instructions de génération.</span><span class="sxs-lookup"><span data-stu-id="e2bab-116">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="understanding-the-enablepackageprocessloggingandassert-property"></a><span data-ttu-id="e2bab-117">Fonctionnement de la propriété EnablePackageProcessLoggingAndAssert</span><span class="sxs-lookup"><span data-stu-id="e2bab-117">Understanding the EnablePackageProcessLoggingAndAssert Property</span></span>

<span data-ttu-id="e2bab-118">[Génération et empaquetage des projets d’application Web](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md) décrit comment le pipeline de publication Web (WPP) fournit un ensemble de cibles MSBuild qui étendent les fonctionnalités de MSBuild et lui permettent de s’intégrer à l’outil de déploiement Web (Web Deploy) Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="e2bab-118">[Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md) described how the Web Publishing Pipeline (WPP) provides a set of MSBuild targets that extend the functionality of MSBuild and enable it to integrate with the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span> <span data-ttu-id="e2bab-119">Lorsque vous empaquetez un projet d’application Web, vous appelez des cibles WPP.</span><span class="sxs-lookup"><span data-stu-id="e2bab-119">When you package a web application project, you're invoking WPP targets.</span></span>

<span data-ttu-id="e2bab-120">Un grand nombre de ces objectifs de WPP incluent la logique conditionnelle qui journalise des informations supplémentaires lorsque la propriété **EnablePackageProcessLoggingAndAssert** est définie sur **true**.</span><span class="sxs-lookup"><span data-stu-id="e2bab-120">Lots of these WPP targets include conditional logic that logs additional information when the **EnablePackageProcessLoggingAndAssert** property is set to **true**.</span></span> <span data-ttu-id="e2bab-121">Par exemple, si vous examinez la cible du **package** , vous pouvez voir qu’elle crée un répertoire de journal supplémentaire et écrit une liste de fichiers dans un fichier texte si **EnablePackageProcessLoggingAndAssert** est égal à **true**.</span><span class="sxs-lookup"><span data-stu-id="e2bab-121">For example, if you review the **Package** target, you can see that it creates an additional log directory and writes a list of files to a text file if **EnablePackageProcessLoggingAndAssert** is equal to **true**.</span></span>

[!code-xml[Main](troubleshooting-the-packaging-process/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="e2bab-122">Les cibles WPP sont définies dans le fichier *Microsoft. Web. Publishing. targets* dans le dossier% ProgramFiles (x86)% \ MSBuild\Microsoft\VisualStudio\v10.0\Web</span><span class="sxs-lookup"><span data-stu-id="e2bab-122">The WPP targets are defined in the *Microsoft.Web.Publishing.targets* file in the %PROGRAMFILES(x86)%\MSBuild\Microsoft\VisualStudio\v10.0\Web folder.</span></span> <span data-ttu-id="e2bab-123">Vous pouvez ouvrir ce fichier et passer en revue les cibles dans Visual Studio 2010 ou dans tout éditeur XML.</span><span class="sxs-lookup"><span data-stu-id="e2bab-123">You can open this file and review the targets in Visual Studio 2010 or any XML editor.</span></span> <span data-ttu-id="e2bab-124">Veillez à ne pas modifier le contenu du fichier.</span><span class="sxs-lookup"><span data-stu-id="e2bab-124">Take care not to modify the contents of the file.</span></span>

## <a name="enabling-the-additional-logging"></a><span data-ttu-id="e2bab-125">Activation de la journalisation supplémentaire</span><span class="sxs-lookup"><span data-stu-id="e2bab-125">Enabling the Additional Logging</span></span>

<span data-ttu-id="e2bab-126">Vous pouvez fournir une valeur pour la propriété **EnablePackageProcessLoggingAndAssert** de différentes manières, en fonction de la façon dont vous générez votre projet.</span><span class="sxs-lookup"><span data-stu-id="e2bab-126">You can supply a value for the **EnablePackageProcessLoggingAndAssert** property in various ways, depending on how you build your project.</span></span>

<span data-ttu-id="e2bab-127">Si vous générez votre projet à partir de la ligne de commande, vous pouvez fournir une valeur pour la propriété **EnablePackageProcessLoggingAndAssert** sous la forme d’un argument de ligne de commande :</span><span class="sxs-lookup"><span data-stu-id="e2bab-127">If you build your project from the command line, you can supply a value for the **EnablePackageProcessLoggingAndAssert** property as a command-line argument:</span></span>

[!code-console[Main](troubleshooting-the-packaging-process/samples/sample2.cmd)]

<span data-ttu-id="e2bab-128">Si vous utilisez un fichier projet personnalisé pour générer vos projets, vous pouvez inclure la valeur **EnablePackageProcessLoggingAndAssert** dans l’attribut **Properties** de la tâche **MSBuild** :</span><span class="sxs-lookup"><span data-stu-id="e2bab-128">If you're using a custom project file to build your projects, you can include the **EnablePackageProcessLoggingAndAssert** value in the **Properties** attribute of the **MSBuild** task:</span></span>

[!code-xml[Main](troubleshooting-the-packaging-process/samples/sample3.xml)]

<span data-ttu-id="e2bab-129">Si vous utilisez une définition de build Team Foundation Server (TFS) pour générer vos projets, vous pouvez fournir une valeur pour la propriété **EnablePackageProcessLoggingAndAssert** dans la ligne d' **Arguments MSBuild** :![](troubleshooting-the-packaging-process/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e2bab-129">If you're using a Team Foundation Server (TFS) build definition to build your projects, you can supply a value for the **EnablePackageProcessLoggingAndAssert** property in the **MSBuild Arguments** row:![](troubleshooting-the-packaging-process/_static/image1.png)</span></span>

> [!NOTE]
> <span data-ttu-id="e2bab-130">Pour plus d’informations sur la création et la configuration des définitions de build, consultez [création d’une définition de build qui prend en charge le déploiement](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="e2bab-130">For more information on creating and configuring build definitions, see [Creating a Build Definition That Supports Deployment](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md).</span></span>

<span data-ttu-id="e2bab-131">Si vous souhaitez inclure le package dans chaque Build, vous pouvez également modifier le fichier projet de votre projet d’application Web pour définir la propriété **EnablePackageProcessLoggingAndAssert** sur **true**.</span><span class="sxs-lookup"><span data-stu-id="e2bab-131">Alternatively, if you want to include the package in every build, you can modify the project file for your web application project to set the **EnablePackageProcessLoggingAndAssert** property to **true**.</span></span> <span data-ttu-id="e2bab-132">Vous devez ajouter la propriété au premier élément **PropertyGroup** dans votre fichier. csproj ou. vbproj.</span><span class="sxs-lookup"><span data-stu-id="e2bab-132">You should add the property to the first **PropertyGroup** element within your .csproj or .vbproj file.</span></span>

[!code-xml[Main](troubleshooting-the-packaging-process/samples/sample4.xml)]

## <a name="reviewing-the-log-files"></a><span data-ttu-id="e2bab-133">Examen des fichiers journaux</span><span class="sxs-lookup"><span data-stu-id="e2bab-133">Reviewing the Log Files</span></span>

<span data-ttu-id="e2bab-134">Quand vous générez et Empaquetez un projet d’application Web avec **EnablePackageProcessLoggingAndAssert** défini sur **true**, MSBuild crée un dossier supplémentaire nommé log dans le dossier *ProjectName*\_package.</span><span class="sxs-lookup"><span data-stu-id="e2bab-134">When you build and package a web application project with **EnablePackageProcessLoggingAndAssert** set to **true**, MSBuild creates an additional folder named Log in the *ProjectName*\_Package folder.</span></span> <span data-ttu-id="e2bab-135">Le dossier log contient différents fichiers :</span><span class="sxs-lookup"><span data-stu-id="e2bab-135">The Log folder contains various files:</span></span>

![](troubleshooting-the-packaging-process/_static/image2.png)

<span data-ttu-id="e2bab-136">La liste des fichiers que vous voyez varie en fonction des éléments de votre projet et de votre processus de génération.</span><span class="sxs-lookup"><span data-stu-id="e2bab-136">The list of files that you see will vary according to the things in your project and your build process.</span></span> <span data-ttu-id="e2bab-137">Toutefois, ces fichiers sont généralement utilisés pour enregistrer la liste des fichiers que le WPP recueille pour l’empaquetage, à différentes étapes du processus :</span><span class="sxs-lookup"><span data-stu-id="e2bab-137">However, these files are typically used to record the list of files that the WPP is collecting for packaging, at various stages of the process:</span></span>

- <span data-ttu-id="e2bab-138">Le fichier *PreExcludePipelineCollectFilesPhaseFileList. txt* répertorie les fichiers que MSBuild collecte pour l’empaquetage avant la suppression de tous les fichiers spécifiés pour l’exclusion.</span><span class="sxs-lookup"><span data-stu-id="e2bab-138">The *PreExcludePipelineCollectFilesPhaseFileList.txt* file lists the files that MSBuild collects for packaging before any files that are specified for exclusion are removed.</span></span>
- <span data-ttu-id="e2bab-139">Le fichier *AfterExcludeFilesFilesList. txt* contient la liste des fichiers modifiés après la suppression de tous les fichiers spécifiés pour l’exclusion.</span><span class="sxs-lookup"><span data-stu-id="e2bab-139">The *AfterExcludeFilesFilesList.txt* file contains the modified file list after any files that are specified for exclusion are removed.</span></span>

    > [!NOTE]
    > <span data-ttu-id="e2bab-140">Pour plus d’informations sur l’exclusion de fichiers et de dossiers du processus d’empaquetage, consultez [exclusion de fichiers et de dossiers du déploiement](excluding-files-and-folders-from-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="e2bab-140">For more information on excluding files and folders from the packaging process, see [Excluding Files and Folders from Deployment](excluding-files-and-folders-from-deployment.md).</span></span>
- <span data-ttu-id="e2bab-141">Le fichier *AfterTransformWebConfig. txt* répertorie les fichiers collectés pour l’empaquetage après l’exécution de toutes les transformations *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="e2bab-141">The *AfterTransformWebConfig.txt* file lists the files collected for packaging after any *Web.config* transforms have been performed.</span></span> <span data-ttu-id="e2bab-142">Dans cette liste, tous les fichiers de transformation *Web. config* spécifiques à la configuration, tels que *Web. Debug. config* et *Web. Release. config*, sont exclus de la liste des fichiers à empaqueter.</span><span class="sxs-lookup"><span data-stu-id="e2bab-142">In this list, any configuration-specific *Web.config* transform files, like *Web.Debug.config* and *Web.Release.config*, are excluded from the list of files for packaging.</span></span> <span data-ttu-id="e2bab-143">Un *fichier Web. config* transformé unique est inclus à leur place.</span><span class="sxs-lookup"><span data-stu-id="e2bab-143">A single transformed *Web.config* is included in their place.</span></span>
- <span data-ttu-id="e2bab-144">Le fichier *PostAutoParameterizationWebConfigConnectionStrings. txt* contient la liste des fichiers une fois que les chaînes de connexion dans le fichier *Web. config* ont été paramétrables.</span><span class="sxs-lookup"><span data-stu-id="e2bab-144">The *PostAutoParameterizationWebConfigConnectionStrings.txt* file contains the list of files after the connection strings in the *Web.config* file have been parameterized.</span></span> <span data-ttu-id="e2bab-145">C’est le processus qui vous permet de remplacer vos chaînes de connexion par les paramètres appropriés pour votre environnement cible lorsque vous déployez le package.</span><span class="sxs-lookup"><span data-stu-id="e2bab-145">This is the process that lets you replace your connection strings with the right settings for your target environment when you deploy the package.</span></span>
- <span data-ttu-id="e2bab-146">Le fichier de *préemballage. txt* contient la liste de prébuilds finalisée des fichiers à inclure dans le package.</span><span class="sxs-lookup"><span data-stu-id="e2bab-146">The *Prepackage.txt* file contains the finalized pre-build list of files to be included in the package.</span></span>

> [!NOTE]
> <span data-ttu-id="e2bab-147">Les noms des fichiers journaux supplémentaires correspondent généralement aux cibles WPP.</span><span class="sxs-lookup"><span data-stu-id="e2bab-147">The names of the additional log files typically correspond to WPP targets.</span></span> <span data-ttu-id="e2bab-148">Vous pouvez examiner ces cibles en examinant le fichier *Microsoft. Web. Publishing. targets* dans le dossier% ProgramFiles (x86)% \ MSBuild\Microsoft\VisualStudio\v10.0\Web</span><span class="sxs-lookup"><span data-stu-id="e2bab-148">You can review these targets by examining the *Microsoft.Web.Publishing.targets* file in the %PROGRAMFILES(x86)%\MSBuild\Microsoft\VisualStudio\v10.0\Web folder.</span></span>

<span data-ttu-id="e2bab-149">Si le contenu de votre package Web n’est pas ce que vous attendiez, l’examen de ces fichiers peut être un moyen utile d’identifier à quel moment du processus les problèmes se sont produits.</span><span class="sxs-lookup"><span data-stu-id="e2bab-149">If the contents of your web package aren't what you expected, reviewing these files can be a useful way to identify at what point in the process things went wrong.</span></span>

## <a name="conclusion"></a><span data-ttu-id="e2bab-150">Conclusion</span><span class="sxs-lookup"><span data-stu-id="e2bab-150">Conclusion</span></span>

<span data-ttu-id="e2bab-151">Cette rubrique a décrit comment vous pouvez utiliser la propriété **EnablePackageProcessLoggingAndAssert** dans MSBuild pour résoudre les problèmes liés au processus d’empaquetage.</span><span class="sxs-lookup"><span data-stu-id="e2bab-151">This topic described how you can use the **EnablePackageProcessLoggingAndAssert** property in MSBuild to troubleshoot the packaging process.</span></span> <span data-ttu-id="e2bab-152">Il a expliqué les différentes façons dont vous pouvez fournir la valeur de la propriété au processus de génération, et il a décrit les informations supplémentaires qui sont enregistrées lorsque vous affectez à la propriété la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="e2bab-152">It explained the different ways in which you can supply the property value to the build process, and it described the additional information that is recorded when you set the property to **true**.</span></span>

## <a name="further-reading"></a><span data-ttu-id="e2bab-153">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="e2bab-153">Further Reading</span></span>

<span data-ttu-id="e2bab-154">Pour plus d’informations sur l’utilisation de fichiers de projet MSBuild personnalisés pour contrôler le processus de déploiement, consultez [comprendre le fichier projet](../web-deployment-in-the-enterprise/understanding-the-project-file.md) et [comprendre le processus de génération](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="e2bab-154">For more information on using custom MSBuild project files to control the deployment process, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span> <span data-ttu-id="e2bab-155">Pour plus d’informations sur le WPP et la façon dont il gère le processus d’empaquetage, consultez [génération et empaquetage de projets d’application Web](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="e2bab-155">For more information on the WPP and how it manages the packaging process, see [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span></span> <span data-ttu-id="e2bab-156">Pour obtenir des conseils sur la façon d’exclure des fichiers et des dossiers spécifiques des packages de déploiement Web, consultez [exclusion de fichiers et de dossiers du déploiement](excluding-files-and-folders-from-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="e2bab-156">For guidance on how to exclude specific files and folders from web deployment packages, see [Excluding Files and Folders from Deployment](excluding-files-and-folders-from-deployment.md).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="e2bab-157">Précédent</span><span class="sxs-lookup"><span data-stu-id="e2bab-157">Previous</span></span>](running-windows-powershell-scripts-from-msbuild-project-files.md)
