---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-build-process
title: Fonctionnement du processus de génération | Microsoft Docs
author: jrjlee
description: Cette rubrique fournit une procédure pas à pas d’un processus de génération et de déploiement à l’échelle de l’entreprise. L’approche décrite dans cette rubrique utilise Microsoft Build engin personnalisé...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 5b982451-547b-4a2f-a5dc-79bc64d84d40
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-build-process
msc.type: authoredcontent
ms.openlocfilehash: 802d93f7ca987d018967275bae68b8c56d883a25
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78641140"
---
# <a name="understanding-the-build-process"></a><span data-ttu-id="0c511-104">Présentation du processus de génération</span><span class="sxs-lookup"><span data-stu-id="0c511-104">Understanding the Build Process</span></span>

<span data-ttu-id="0c511-105">par [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="0c511-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="0c511-106">Télécharger PDF</span><span class="sxs-lookup"><span data-stu-id="0c511-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="0c511-107">Cette rubrique fournit une procédure pas à pas d’un processus de génération et de déploiement à l’échelle de l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="0c511-107">This topic provides a walkthrough of an enterprise-scale build and deployment process.</span></span> <span data-ttu-id="0c511-108">L’approche décrite dans cette rubrique utilise des fichiers projet Microsoft Build Engine (MSBuild) personnalisés pour fournir un contrôle précis sur chaque aspect du processus.</span><span class="sxs-lookup"><span data-stu-id="0c511-108">The approach described in this topic uses custom Microsoft Build Engine (MSBuild) project files to provide fine-grained control over every aspect of the process.</span></span> <span data-ttu-id="0c511-109">Dans les fichiers projet, les cibles MSBuild personnalisées sont utilisées pour exécuter des utilitaires de déploiement tels que l’outil de déploiement Web Internet Information Services (IIS) (MSDeploy. exe) et l’utilitaire de déploiement de base de données VSDBCMD. exe.</span><span class="sxs-lookup"><span data-stu-id="0c511-109">Within the project files, custom MSBuild targets are used to run deployment utilities like the Internet Information Services (IIS) Web Deployment Tool (MSDeploy.exe) and the database deployment utility VSDBCMD.exe.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="0c511-110">La rubrique précédente, [comprenant le fichier projet](understanding-the-project-file.md), décrit les composants clés d’un fichier projet MSBuild et a introduit le concept de fichiers projet fractionnés pour prendre en charge le déploiement dans plusieurs environnements cibles.</span><span class="sxs-lookup"><span data-stu-id="0c511-110">The previous topic, [Understanding the Project File](understanding-the-project-file.md), described the key components of an MSBuild project file and introduced the concept of split project files to support deployment to multiple target environments.</span></span> <span data-ttu-id="0c511-111">Si vous n’êtes pas déjà familiarisé avec ces concepts, vous devez examiner [le fichier projet](understanding-the-project-file.md) avant d’utiliser cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="0c511-111">If you're not already familiar with these concepts, you should review [Understanding the Project File](understanding-the-project-file.md) before you work through this topic.</span></span>

<span data-ttu-id="0c511-112">Cette rubrique fait partie d’une série de didacticiels basés sur les exigences de déploiement en entreprise d’une société fictive nommée Fabrikam, Inc. Cette série de didacticiels utilise un&#x2014;exemple de solution de [gestion des contacts](the-contact-manager-solution.md)&#x2014;pour représenter une application Web avec un niveau de complexité réaliste, y compris une application ASP.NET MVC 3, un service Windows Communication Foundation (WCF) et un projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="0c511-112">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="0c511-113">La méthode de déploiement au cœur de ces didacticiels est basée sur l’approche de fichier de projet fractionné décrite dans [fonctionnement du fichier projet](understanding-the-project-file.md), dans lequel le processus de génération est contrôlé&#x2014;par deux fichiers projet qui contiennent des instructions de génération qui s’appliquent à chaque environnement de destination, et un qui contient des paramètres de génération et de déploiement spécifiques à l’environnement.</span><span class="sxs-lookup"><span data-stu-id="0c511-113">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="0c511-114">Au moment de la génération, le fichier projet spécifique à l’environnement est fusionné dans le fichier projet indépendant de l’environnement pour former un ensemble complet d’instructions de génération.</span><span class="sxs-lookup"><span data-stu-id="0c511-114">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="build-and-deployment-overview"></a><span data-ttu-id="0c511-115">Présentation de Build and Deployment</span><span class="sxs-lookup"><span data-stu-id="0c511-115">Build and Deployment Overview</span></span>

<span data-ttu-id="0c511-116">Dans la [solution du gestionnaire de contacts](the-contact-manager-solution.md), trois fichiers contrôlent le processus de génération et de déploiement :</span><span class="sxs-lookup"><span data-stu-id="0c511-116">In the [Contact Manager solution](the-contact-manager-solution.md), three files control the build and deployment process:</span></span>

- <span data-ttu-id="0c511-117">*Fichier projet universel* (*Publish. proj*).</span><span class="sxs-lookup"><span data-stu-id="0c511-117">A *universal project file* (*Publish.proj*).</span></span> <span data-ttu-id="0c511-118">Contient des instructions de génération et de déploiement qui ne changent pas entre les environnements de destination.</span><span class="sxs-lookup"><span data-stu-id="0c511-118">This contains build and deployment instructions that do not change between destination environments.</span></span>
- <span data-ttu-id="0c511-119">*Fichier projet spécifique à l’environnement* (*env-dev. proj*).</span><span class="sxs-lookup"><span data-stu-id="0c511-119">An *environment-specific project file* (*Env-Dev.proj*).</span></span> <span data-ttu-id="0c511-120">Contient des paramètres de build et de déploiement qui sont spécifiques à un environnement de destination particulier.</span><span class="sxs-lookup"><span data-stu-id="0c511-120">This contains build and deployment settings that are specific to a particular destination environment.</span></span> <span data-ttu-id="0c511-121">Par exemple, vous pouvez utiliser le fichier *env-dev. proj* pour fournir les paramètres d’un environnement de développement ou de test et créer un autre fichier nommé *env-stage. proj* pour fournir les paramètres d’un environnement intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="0c511-121">For example, you could use the *Env-Dev.proj* file to provide settings for a developer or test environment and create an alternative file named *Env-Stage.proj* to provide settings for a staging environment.</span></span>
- <span data-ttu-id="0c511-122">Un *fichier de commandes* (*Publish-dev. cmd*).</span><span class="sxs-lookup"><span data-stu-id="0c511-122">A *command file* (*Publish-Dev.cmd*).</span></span> <span data-ttu-id="0c511-123">Contient une commande MSBuild. exe qui spécifie les fichiers projet que vous souhaitez exécuter.</span><span class="sxs-lookup"><span data-stu-id="0c511-123">This contains an MSBuild.exe command that specifies which project files you want to execute.</span></span> <span data-ttu-id="0c511-124">Vous pouvez créer un fichier de commandes pour chaque environnement de destination, où chaque fichier contient une commande MSBuild. exe qui spécifie un autre fichier projet spécifique à l’environnement.</span><span class="sxs-lookup"><span data-stu-id="0c511-124">You can create a command file for every destination environment, where each file contains an MSBuild.exe command that specifies a different environment-specific project file.</span></span> <span data-ttu-id="0c511-125">Cela permet au développeur de déployer dans différents environnements simplement en exécutant le fichier de commandes approprié.</span><span class="sxs-lookup"><span data-stu-id="0c511-125">This lets the developer deploy to different environments simply by running the appropriate command file.</span></span>

<span data-ttu-id="0c511-126">Dans l’exemple de solution, vous pouvez trouver ces trois fichiers dans le dossier de la solution de publication.</span><span class="sxs-lookup"><span data-stu-id="0c511-126">In the sample solution, you can find these three files in the Publish solution folder.</span></span>

![](understanding-the-build-process/_static/image1.png)

<span data-ttu-id="0c511-127">Avant de consulter ces fichiers plus en détail, jetons un coup d’œil sur le fonctionnement de l’ensemble du processus de génération lorsque vous utilisez cette approche.</span><span class="sxs-lookup"><span data-stu-id="0c511-127">Before you look at these files in more detail, let's take a look at how the overall build process works when you use this approach.</span></span> <span data-ttu-id="0c511-128">À un niveau élevé, le processus de génération et de déploiement se présente comme suit :</span><span class="sxs-lookup"><span data-stu-id="0c511-128">At a high level, the build and deployment process looks like this:</span></span>

![](understanding-the-build-process/_static/image2.png)

<span data-ttu-id="0c511-129">La première chose qui se produit est que les deux fichiers&#x2014;projet qui contiennent des instructions de génération et de déploiement universelles et un qui&#x2014;contient des paramètres spécifiques à l’environnement sont fusionnés dans un seul fichier projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-129">The first thing that happens is that the two project files&#x2014;one containing universal build and deployment instructions, and one containing environment-specific settings&#x2014;are merged into a single project file.</span></span> <span data-ttu-id="0c511-130">MSBuild utilise ensuite les instructions du fichier projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-130">MSBuild then works through the instructions in the project file.</span></span> <span data-ttu-id="0c511-131">Il génère chacun des projets de la solution, en utilisant le fichier projet pour chaque projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-131">It builds each of the projects in the solution, using the project file for each project.</span></span> <span data-ttu-id="0c511-132">Il appelle ensuite d’autres outils, comme Web Deploy (MSDeploy. exe) et l’utilitaire VSDBCMD pour déployer le contenu et les bases de données Web dans l’environnement cible.</span><span class="sxs-lookup"><span data-stu-id="0c511-132">It then calls out to other tools, like Web Deploy (MSDeploy.exe) and the VSDBCMD utility to deploy your web content and databases to the target environment.</span></span>

<span data-ttu-id="0c511-133">Du début à la fin, le processus de génération et de déploiement effectue les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="0c511-133">From start to finish, the build and deployment process performs these tasks:</span></span>

1. <span data-ttu-id="0c511-134">Il supprime le contenu du répertoire de sortie, en vue d’une nouvelle Build.</span><span class="sxs-lookup"><span data-stu-id="0c511-134">It deletes the contents of the output directory, in preparation for a fresh build.</span></span>
2. <span data-ttu-id="0c511-135">Il génère chaque projet dans la solution :</span><span class="sxs-lookup"><span data-stu-id="0c511-135">It builds each project in the solution:</span></span>

    1. <span data-ttu-id="0c511-136">Pour les projets&#x2014;Web, dans ce cas, une application Web ASP.NET MVC et un service&#x2014;Web WCF, le processus de génération crée un package de déploiement Web pour chaque projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-136">For web projects&#x2014;in this case, an ASP.NET MVC web application and a WCF web service&#x2014;the build process creates a web deployment package for each project.</span></span>
    2. <span data-ttu-id="0c511-137">Pour les projets de base de données, le processus de génération crée un manifeste de déploiement (fichier. DeployManifest) pour chaque projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-137">For database projects, the build process creates a deployment manifest (.deploymanifest file) for each project.</span></span>
3. <span data-ttu-id="0c511-138">Elle utilise l’utilitaire VSDBCMD. exe pour déployer chaque projet de base de données dans la solution, à l’aide de&#x2014;différentes propriétés issues des fichiers projet d’une&#x2014;chaîne de connexion cible et d’un nom de base de données, ainsi que du fichier. DeployManifest.</span><span class="sxs-lookup"><span data-stu-id="0c511-138">It uses the VSDBCMD.exe utility to deploy each database project in the solution, using various properties from the project files&#x2014;a target connection string and a database name&#x2014;together with the .deploymanifest file.</span></span>
4. <span data-ttu-id="0c511-139">Elle utilise l’utilitaire MSDeploy. exe pour déployer chaque projet Web dans la solution, à l’aide de différentes propriétés des fichiers projet pour contrôler le processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="0c511-139">It uses the MSDeploy.exe utility to deploy each web project in the solution, using various properties from the project files to control the deployment process.</span></span>

<span data-ttu-id="0c511-140">Vous pouvez utiliser l’exemple de solution pour suivre ce processus plus en détail.</span><span class="sxs-lookup"><span data-stu-id="0c511-140">You can use the sample solution to trace this process in more detail.</span></span>

> [!NOTE]
> <span data-ttu-id="0c511-141">Pour obtenir des conseils sur la personnalisation des fichiers projet spécifiques à l’environnement pour vos propres environnements de serveur, consultez [configurer les propriétés de déploiement pour un environnement cible](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span><span class="sxs-lookup"><span data-stu-id="0c511-141">For guidance on how to customize the environment-specific project files for your own server environments, see [Configure Deployment Properties for a Target Environment](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span></span>

## <a name="invoking-the-build-and-deployment-process"></a><span data-ttu-id="0c511-142">Appel du processus de Build and Deployment</span><span class="sxs-lookup"><span data-stu-id="0c511-142">Invoking the Build and Deployment Process</span></span>

<span data-ttu-id="0c511-143">Pour déployer la solution gestionnaire de contacts dans un environnement de test de développement, le développeur exécute le fichier de commandes *Publish-dev. cmd* .</span><span class="sxs-lookup"><span data-stu-id="0c511-143">To deploy the Contact Manager solution to a developer test environment, the developer runs the *Publish-Dev.cmd* command file.</span></span> <span data-ttu-id="0c511-144">Ce code appelle MSBuild. exe, en spécifiant *Publish. proj* comme fichier projet à exécuter et *env-dev. proj* comme valeur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="0c511-144">This invokes MSBuild.exe, specifying *Publish.proj* as the project file to execute and *Env-Dev.proj* as a parameter value.</span></span>

[!code-console[Main](understanding-the-build-process/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="0c511-145">Le commutateur **/FL** (Short pour **/FileLogger**) enregistre la sortie de la génération dans un fichier nommé *MSBuild. log* dans le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="0c511-145">The **/fl** switch (short for **/fileLogger**) logs the build output to a file named *msbuild.log* in the current directory.</span></span> <span data-ttu-id="0c511-146">Pour plus d’informations, consultez la référence de la [ligne de commande MSBuild](https://msdn.microsoft.com/library/ms164311.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c511-146">For more information, see the [MSBuild Command Line Reference](https://msdn.microsoft.com/library/ms164311.aspx).</span></span>

<span data-ttu-id="0c511-147">À ce stade, MSBuild commence à s’exécuter, charge le fichier *Publish. proj* et commence à traiter les instructions qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="0c511-147">At this point, MSBuild starts running, loads the *Publish.proj* file, and starts processing the instructions within it.</span></span> <span data-ttu-id="0c511-148">La première instruction indique à MSBuild d’importer le fichier de projet que le paramètre **TargetEnvPropsFile** spécifie.</span><span class="sxs-lookup"><span data-stu-id="0c511-148">The first instruction tells MSBuild to import the project file that the **TargetEnvPropsFile** parameter specifies.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample2.xml)]

<span data-ttu-id="0c511-149">Le paramètre **TargetEnvPropsFile** spécifie le fichier *env-dev. proj* , de sorte que MSBuild fusionne le contenu du fichier *env-dev. proj* dans le fichier *Publish. proj* .</span><span class="sxs-lookup"><span data-stu-id="0c511-149">The **TargetEnvPropsFile** parameter specifies the *Env-Dev.proj* file, so MSBuild merges the contents of the *Env-Dev.proj* file into the *Publish.proj* file.</span></span>

<span data-ttu-id="0c511-150">Les éléments suivants que MSBuild rencontre dans le fichier projet fusionné sont des groupes de propriétés.</span><span class="sxs-lookup"><span data-stu-id="0c511-150">The next elements that MSBuild encounters in the merged project file are property groups.</span></span> <span data-ttu-id="0c511-151">Les propriétés sont traitées dans l’ordre dans lequel elles apparaissent dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="0c511-151">Properties are processed in the order in which they appear in the file.</span></span> <span data-ttu-id="0c511-152">MSBuild crée une paire clé-valeur pour chaque propriété, en indiquant que toutes les conditions spécifiées sont remplies.</span><span class="sxs-lookup"><span data-stu-id="0c511-152">MSBuild creates a key-value pair for each property, providing that any specified conditions are met.</span></span> <span data-ttu-id="0c511-153">Les propriétés définies ultérieurement dans le fichier remplacent toutes les propriétés portant le même nom et définies précédemment dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="0c511-153">Properties defined later in the file will overwrite any properties with the same name defined earlier in the file.</span></span> <span data-ttu-id="0c511-154">Par exemple, considérez les propriétés **OutputRoot** .</span><span class="sxs-lookup"><span data-stu-id="0c511-154">For example, consider the **OutputRoot** properties.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample3.xml)]

<span data-ttu-id="0c511-155">Lorsque MSBuild traite le premier élément **OutputRoot** , le fait de fournir un paramètre nommé de la même manière n’a pas été fourni, il définit la valeur de la propriété **OutputRoot** sur **.. \Publish\Out**. Lorsqu’il rencontre le deuxième élément **OutputRoot** , si la condition est évaluée à **true**, il remplace la valeur de la propriété **OutputRoot** par la valeur du paramètre **OutDir** .</span><span class="sxs-lookup"><span data-stu-id="0c511-155">When MSBuild processes the first **OutputRoot** element, providing a similarly named parameter has not been provided, it sets the value of the **OutputRoot** property to **..\Publish\Out**. When it encounters the second **OutputRoot** element, if the condition evaluates to **true**, it will overwrite the value of the **OutputRoot** property with the value of the **OutDir** parameter.</span></span>

<span data-ttu-id="0c511-156">L’élément suivant que MSBuild rencontre est un groupe d’éléments unique, contenant un élément nommé **ProjectsToBuild**.</span><span class="sxs-lookup"><span data-stu-id="0c511-156">The next element that MSBuild encounters is a single item group, containing an item named **ProjectsToBuild**.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample4.xml)]

<span data-ttu-id="0c511-157">MSBuild traite cette instruction en générant une liste d’éléments nommée **ProjectsToBuild**.</span><span class="sxs-lookup"><span data-stu-id="0c511-157">MSBuild processes this instruction by building an item list named **ProjectsToBuild**.</span></span> <span data-ttu-id="0c511-158">Dans ce cas, la liste d’éléments contient une valeur&#x2014;unique pour le chemin d’accès et le nom de fichier du fichier solution.</span><span class="sxs-lookup"><span data-stu-id="0c511-158">In this case, the item list contains a single value&#x2014;the path and filename of the solution file.</span></span>

<span data-ttu-id="0c511-159">À ce stade, les éléments restants sont des cibles.</span><span class="sxs-lookup"><span data-stu-id="0c511-159">At this point, the remaining elements are targets.</span></span> <span data-ttu-id="0c511-160">Les cibles sont traitées différemment des propriétés et&#x2014;des éléments, mais les cibles ne sont pas traitées à moins qu’elles soient explicitement spécifiées par l’utilisateur ou appelées par une autre construction dans le fichier projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-160">Targets are processed differently from properties and items&#x2014;essentially, targets are not processed unless they are either explicitly specified by the user or invoked by another construct within the project file.</span></span> <span data-ttu-id="0c511-161">Rappelez-vous que la balise de **projet** d’ouverture comprend un attribut **DefaultTargets** .</span><span class="sxs-lookup"><span data-stu-id="0c511-161">Recall that the opening **Project** tag includes a **DefaultTargets** attribute.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample5.xml)]

<span data-ttu-id="0c511-162">Cela indique à MSBuild d’appeler la cible **FullPublish** , si les cibles ne sont pas spécifiées lors de l’appel de MSBuild. exe.</span><span class="sxs-lookup"><span data-stu-id="0c511-162">This instructs MSBuild to invoke the **FullPublish** target, if targets are not specified when MSBuild.exe is invoked.</span></span> <span data-ttu-id="0c511-163">La cible **FullPublish** ne contient aucune tâche ; au lieu de cela, il spécifie simplement une liste de dépendances.</span><span class="sxs-lookup"><span data-stu-id="0c511-163">The **FullPublish** target doesn't contain any tasks; instead it simply specifies a list of dependencies.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample6.xml)]

<span data-ttu-id="0c511-164">Cette dépendance indique à MSBuild que pour exécuter la cible **FullPublish** , il doit appeler cette liste de cibles dans l’ordre indiqué :</span><span class="sxs-lookup"><span data-stu-id="0c511-164">This dependency tells MSBuild that in order to execute the **FullPublish** target, it needs to invoke this list of targets in the order provided:</span></span>

1. <span data-ttu-id="0c511-165">Il doit appeler la cible **Clean** .</span><span class="sxs-lookup"><span data-stu-id="0c511-165">It must invoke the **Clean** target.</span></span>
2. <span data-ttu-id="0c511-166">Il doit appeler la cible **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="0c511-166">It must invoke the **BuildProjects** target.</span></span>
3. <span data-ttu-id="0c511-167">Il doit appeler la cible **GatherPackagesForPublishing** .</span><span class="sxs-lookup"><span data-stu-id="0c511-167">It must invoke the **GatherPackagesForPublishing** target.</span></span>
4. <span data-ttu-id="0c511-168">Il doit appeler la cible **PublishDbPackages** .</span><span class="sxs-lookup"><span data-stu-id="0c511-168">It must invoke the **PublishDbPackages** target.</span></span>
5. <span data-ttu-id="0c511-169">Il doit appeler la cible **PublishWebPackages** .</span><span class="sxs-lookup"><span data-stu-id="0c511-169">It must invoke the **PublishWebPackages** target.</span></span>

### <a name="the-clean-target"></a><span data-ttu-id="0c511-170">La cible de nettoyage</span><span class="sxs-lookup"><span data-stu-id="0c511-170">The Clean Target</span></span>

<span data-ttu-id="0c511-171">La cible **Clean** supprime fondamentalement le répertoire de sortie et tout son contenu, comme la préparation d’une nouvelle Build.</span><span class="sxs-lookup"><span data-stu-id="0c511-171">The **Clean** target basically deletes the output directory and all its contents, as preparation for a fresh build.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample7.xml)]

<span data-ttu-id="0c511-172">Notez que la cible comprend un élément **ItemGroup** .</span><span class="sxs-lookup"><span data-stu-id="0c511-172">Notice that the target includes an **ItemGroup** element.</span></span> <span data-ttu-id="0c511-173">Lorsque vous définissez des propriétés ou des éléments dans un élément **cible** , vous créez des propriétés et des éléments *dynamiques* .</span><span class="sxs-lookup"><span data-stu-id="0c511-173">When you define properties or items within a **Target** element, you're creating *dynamic* properties and items.</span></span> <span data-ttu-id="0c511-174">En d’autres termes, les propriétés ou les éléments ne sont pas traités tant que la cible n’est pas exécutée.</span><span class="sxs-lookup"><span data-stu-id="0c511-174">In other words, the properties or items aren't processed until the target is executed.</span></span> <span data-ttu-id="0c511-175">Le répertoire de sortie n’existe peut-être pas ou contient des fichiers tant que le processus de génération n’a pas commencé. vous ne pouvez donc pas générer la liste **\_FilesToDelete** comme élément statique ; vous devez patienter jusqu’à ce que l’exécution soit en cours.</span><span class="sxs-lookup"><span data-stu-id="0c511-175">The output directory might not exist or contain any files until the build process begins, so you can't build the **\_FilesToDelete** list as a static item; you have to wait until execution is underway.</span></span> <span data-ttu-id="0c511-176">Ainsi, vous générez la liste en tant qu’élément dynamique dans la cible.</span><span class="sxs-lookup"><span data-stu-id="0c511-176">As such, you build the list as a dynamic item within the target.</span></span>

> [!NOTE]
> <span data-ttu-id="0c511-177">Dans ce cas, étant donné que la cible **Clean** est la première à être exécutée, il n’est pas vraiment nécessaire d’utiliser un groupe d’éléments dynamiques.</span><span class="sxs-lookup"><span data-stu-id="0c511-177">In this case, because the **Clean** target is the first to be executed, there's no real need to use a dynamic item group.</span></span> <span data-ttu-id="0c511-178">Toutefois, il est conseillé d’utiliser des propriétés et des éléments dynamiques dans ce type de scénario, car vous pouvez souhaiter exécuter des cibles dans un ordre différent à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="0c511-178">However, it's good practice to use dynamic properties and items in this type of scenario, as you might want to execute targets in a different order at some point.</span></span>  
> <span data-ttu-id="0c511-179">Vous devez également viser à éviter de déclarer des éléments qui ne seront jamais utilisés.</span><span class="sxs-lookup"><span data-stu-id="0c511-179">You should also aim to avoid declaring items that will never be used.</span></span> <span data-ttu-id="0c511-180">Si vous avez des éléments qui seront utilisés uniquement par une cible spécifique, pensez à les placer à l’intérieur de la cible pour supprimer toute surcharge inutile sur le processus de génération.</span><span class="sxs-lookup"><span data-stu-id="0c511-180">If you have items that will only be used by a specific target, consider placing them inside the target to remove any unnecessary overhead on the build process.</span></span>

<span data-ttu-id="0c511-181">Les éléments dynamiques de plus, la cible de **nettoyage** est relativement simple et utilise les tâches de **message**, de **suppression**et de **RemoveDir,** intégrées pour :</span><span class="sxs-lookup"><span data-stu-id="0c511-181">Dynamic items aside, the **Clean** target is fairly straightforward and makes use of the built-in **Message**, **Delete**, and **RemoveDir** tasks to:</span></span>

1. <span data-ttu-id="0c511-182">Envoie un message à l’enregistreur d’événements.</span><span class="sxs-lookup"><span data-stu-id="0c511-182">Send a message to the logger.</span></span>
2. <span data-ttu-id="0c511-183">Générez une liste de fichiers à supprimer.</span><span class="sxs-lookup"><span data-stu-id="0c511-183">Build a list of files to delete.</span></span>
3. <span data-ttu-id="0c511-184">Supprimez les fichiers.</span><span class="sxs-lookup"><span data-stu-id="0c511-184">Delete the files.</span></span>
4. <span data-ttu-id="0c511-185">Supprimez le répertoire de sortie.</span><span class="sxs-lookup"><span data-stu-id="0c511-185">Remove the output directory.</span></span>

### <a name="the-buildprojects-target"></a><span data-ttu-id="0c511-186">Cible BuildProjects</span><span class="sxs-lookup"><span data-stu-id="0c511-186">The BuildProjects Target</span></span>

<span data-ttu-id="0c511-187">La cible **BuildProjects** génère fondamentalement tous les projets dans l’exemple de solution.</span><span class="sxs-lookup"><span data-stu-id="0c511-187">The **BuildProjects** target basically builds all the projects in the sample solution.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample8.xml)]

<span data-ttu-id="0c511-188">Cette cible a été décrite plus en détail dans la rubrique précédente, à [savoir le fichier projet](understanding-the-project-file.md), pour illustrer comment les tâches et les cibles référencent les propriétés et les éléments.</span><span class="sxs-lookup"><span data-stu-id="0c511-188">This target was described in some detail in the previous topic, [Understanding the Project File](understanding-the-project-file.md), to illustrate how tasks and targets reference properties and items.</span></span> <span data-ttu-id="0c511-189">À ce stade, vous êtes principalement intéressé par la tâche **MSBuild** .</span><span class="sxs-lookup"><span data-stu-id="0c511-189">At this point, you're mainly interested in the **MSBuild** task.</span></span> <span data-ttu-id="0c511-190">Vous pouvez utiliser cette tâche pour générer plusieurs projets.</span><span class="sxs-lookup"><span data-stu-id="0c511-190">You can use this task to build multiple projects.</span></span> <span data-ttu-id="0c511-191">La tâche ne crée pas de nouvelle instance de MSBuild. exe ; elle utilise l’instance en cours d’exécution pour générer chaque projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-191">The task does not create a new instance of MSBuild.exe; it uses the current running instance to build each project.</span></span> <span data-ttu-id="0c511-192">Les points clés intéressants dans cet exemple sont les propriétés de déploiement :</span><span class="sxs-lookup"><span data-stu-id="0c511-192">The key points of interest in this example are the deployment properties:</span></span>

- <span data-ttu-id="0c511-193">La propriété **DeployOnBuild** indique à MSBuild d’exécuter toutes les instructions de déploiement dans les paramètres du projet lorsque la génération de chaque projet est terminée.</span><span class="sxs-lookup"><span data-stu-id="0c511-193">The **DeployOnBuild** property instructs MSBuild to run any deployment instructions in the project settings when the build of each project is complete.</span></span>
- <span data-ttu-id="0c511-194">La propriété **DeployTarget** identifie la cible que vous souhaitez appeler après la génération du projet.</span><span class="sxs-lookup"><span data-stu-id="0c511-194">The **DeployTarget** property identifies the target that you want to invoke after the project is built.</span></span> <span data-ttu-id="0c511-195">Dans ce cas, la cible du **package** génère la sortie du projet dans un package Web déployable.</span><span class="sxs-lookup"><span data-stu-id="0c511-195">In this case, the **Package** target builds the project output into a deployable web package.</span></span>

> [!NOTE]
> <span data-ttu-id="0c511-196">La cible du **package** appelle le pipeline de publication Web (WPP), qui permet l’intégration entre MSBuild et Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="0c511-196">The **Package** target invokes the Web Publishing Pipeline (WPP), which provides integration between MSBuild and Web Deploy.</span></span> <span data-ttu-id="0c511-197">Si vous souhaitez jeter un coup d’œil aux cibles intégrées fournies par le WPP, examinez le fichier *Microsoft. Web. Publishing. targets* dans le dossier% ProgramFiles (x86)% \ MSBuild\Microsoft\VisualStudio\v10.0\Web</span><span class="sxs-lookup"><span data-stu-id="0c511-197">If you want to take a look at the built-in targets that the WPP provides, review the *Microsoft.Web.Publishing.targets* file in the %PROGRAMFILES(x86)%\MSBuild\Microsoft\VisualStudio\v10.0\Web folder.</span></span>

### <a name="the-gatherpackagesforpublishing-target"></a><span data-ttu-id="0c511-198">Cible GatherPackagesForPublishing</span><span class="sxs-lookup"><span data-stu-id="0c511-198">The GatherPackagesForPublishing Target</span></span>

<span data-ttu-id="0c511-199">Si vous étudiez la cible **GatherPackagesForPublishing** , vous remarquerez qu’elle ne contient pas réellement de tâches.</span><span class="sxs-lookup"><span data-stu-id="0c511-199">If you study the **GatherPackagesForPublishing** target, you'll notice that it doesn't actually contain any tasks.</span></span> <span data-ttu-id="0c511-200">Au lieu de cela, il contient un groupe d’éléments unique qui définit trois éléments dynamiques.</span><span class="sxs-lookup"><span data-stu-id="0c511-200">Instead, it contains a single item group that defines three dynamic items.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample9.xml)]

<span data-ttu-id="0c511-201">Ces éléments font référence aux packages de déploiement qui ont été créés lors de l’exécution de la cible **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="0c511-201">These items refer to the deployment packages that were created when the **BuildProjects** target was executed.</span></span> <span data-ttu-id="0c511-202">Vous ne pouvez pas définir ces éléments de manière statique dans le fichier projet, car les fichiers auxquels ils font référence n’existent pas tant que la cible **BuildProjects** n’est pas exécutée.</span><span class="sxs-lookup"><span data-stu-id="0c511-202">You couldn't define these items statically in the project file, because the files to which the items refer don't exist until the **BuildProjects** target is executed.</span></span> <span data-ttu-id="0c511-203">Au lieu de cela, les éléments doivent être définis dynamiquement dans une cible qui n’est pas appelée avant l’exécution de la cible **BuildProjects** .</span><span class="sxs-lookup"><span data-stu-id="0c511-203">Instead, the items must be defined dynamically within a target that is not invoked until after the **BuildProjects** target is executed.</span></span>

<span data-ttu-id="0c511-204">Les éléments ne sont pas utilisés dans cette&#x2014;cible. cette cible génère simplement les éléments et les métadonnées associées à chaque valeur d’élément.</span><span class="sxs-lookup"><span data-stu-id="0c511-204">The items are not used within this target&#x2014;this target simply builds the items and the metadata associated with each item value.</span></span> <span data-ttu-id="0c511-205">Une fois ces éléments traités, l’élément **PublishPackages** contiendra deux valeurs, le chemin d’accès au fichier *ContactManager. Mvc. deploy. cmd* et le chemin d’accès au fichier *ContactManager. service. deploy. cmd* .</span><span class="sxs-lookup"><span data-stu-id="0c511-205">Once these elements are processed, the **PublishPackages** item will contain two values, the path to the *ContactManager.Mvc.deploy.cmd* file and the path to the *ContactManager.Service.deploy.cmd* file.</span></span> <span data-ttu-id="0c511-206">Web Deploy crée ces fichiers dans le cadre du package Web pour chaque projet, et il s’agit des fichiers que vous devez appeler sur le serveur de destination afin de déployer les packages.</span><span class="sxs-lookup"><span data-stu-id="0c511-206">Web Deploy creates these files as part of the web package for each project, and these are the files that you must invoke on the destination server in order to deploy the packages.</span></span> <span data-ttu-id="0c511-207">Si vous ouvrez l’un de ces fichiers, vous verrez fondamentalement une commande MSDeploy. exe avec différentes valeurs de paramètres spécifiques à la Build.</span><span class="sxs-lookup"><span data-stu-id="0c511-207">If you open up one of these files, you'll basically see an MSDeploy.exe command with various build-specific parameter values.</span></span>

<span data-ttu-id="0c511-208">L’élément **DbPublishPackages** contient une valeur unique, le chemin d’accès au fichier *ContactManager. Database. DeployManifest* .</span><span class="sxs-lookup"><span data-stu-id="0c511-208">The **DbPublishPackages** item will contain a single value, the path to the *ContactManager.Database.deploymanifest* file.</span></span>

> [!NOTE]
> <span data-ttu-id="0c511-209">Un fichier. DeployManifest est généré quand vous générez un projet de base de données et utilise le même schéma qu’un fichier projet MSBuild.</span><span class="sxs-lookup"><span data-stu-id="0c511-209">A .deploymanifest file is generated when you build a database project, and it uses the same schema as an MSBuild project file.</span></span> <span data-ttu-id="0c511-210">Il contient toutes les informations requises pour déployer une base de données, y compris l’emplacement du schéma de base de données (. dbschema) et les détails de tous les scripts de pré-déploiement et de prédéploiement.</span><span class="sxs-lookup"><span data-stu-id="0c511-210">It contains all the information required to deploy a database, including the location of the database schema (.dbschema) and details of any pre-deployment and post-deployment scripts.</span></span> <span data-ttu-id="0c511-211">Pour plus d’informations, consultez [vue d’ensemble de la Build and Deployment de base de données](https://msdn.microsoft.com/library/aa833165.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c511-211">For more information, see [An Overview of Database Build and Deployment](https://msdn.microsoft.com/library/aa833165.aspx).</span></span>

<span data-ttu-id="0c511-212">Vous en apprendrez davantage sur la façon dont les packages de déploiement et les manifestes de déploiement de base de données sont créés et utilisés dans la [génération et l’empaquetage](building-and-packaging-web-application-projects.md) des projets d’application Web et du [déploiement de projets](deploying-database-projects.md)</span><span class="sxs-lookup"><span data-stu-id="0c511-212">You'll learn more about how deployment packages and database deployment manifests are created and used in [Building and Packaging Web Application Projects](building-and-packaging-web-application-projects.md) and [Deploying Database Projects](deploying-database-projects.md).</span></span>

### <a name="the-publishdbpackages-target"></a><span data-ttu-id="0c511-213">Cible PublishDbPackages</span><span class="sxs-lookup"><span data-stu-id="0c511-213">The PublishDbPackages Target</span></span>

<span data-ttu-id="0c511-214">En bref, la cible **PublishDbPackages** appelle l’utilitaire VSDBCMD pour déployer la base de données **ContactManager** dans un environnement cible.</span><span class="sxs-lookup"><span data-stu-id="0c511-214">Briefly speaking, the **PublishDbPackages** target invokes the VSDBCMD utility to deploy the **ContactManager** database to a target environment.</span></span> <span data-ttu-id="0c511-215">La configuration du déploiement de base de données implique un grand nombre de décisions et de nuances. vous en apprendrez davantage sur le déploiement des [projets de base de données](deploying-database-projects.md) et la [Personnalisation des déploiements de bases de données pour plusieurs environnements](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="0c511-215">Configuring database deployment involves lots of decisions and nuances, and you'll learn more about this in [Deploying Database Projects](deploying-database-projects.md) and [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="0c511-216">Dans cette rubrique, nous allons nous concentrer sur le fonctionnement de cette cible.</span><span class="sxs-lookup"><span data-stu-id="0c511-216">In this topic, we'll focus on how this target actually functions.</span></span>

<span data-ttu-id="0c511-217">Tout d’abord, Notez que la balise d’ouverture comprend un attribut **Outputs** .</span><span class="sxs-lookup"><span data-stu-id="0c511-217">First, notice that the opening tag includes an **Outputs** attribute.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample10.xml)]

<span data-ttu-id="0c511-218">Il s’agit d’un exemple de *traitement par lots de cibles*.</span><span class="sxs-lookup"><span data-stu-id="0c511-218">This is an example of *target batching*.</span></span> <span data-ttu-id="0c511-219">Dans les fichiers projet MSBuild, le traitement par lot est une technique qui consiste à itérer au sein des collections.</span><span class="sxs-lookup"><span data-stu-id="0c511-219">In MSBuild project files, batching is a technique for iterating over collections.</span></span> <span data-ttu-id="0c511-220">La valeur de l’attribut **Outputs** , **« % (DbPublishPackages. Identity) »** , fait référence à la propriété des métadonnées d' **identité** de la liste d’éléments **DbPublishPackages** .</span><span class="sxs-lookup"><span data-stu-id="0c511-220">The value of the **Outputs** attribute, **"%(DbPublishPackages.Identity)"**, refers to the **Identity** metadata property of the **DbPublishPackages** item list.</span></span> <span data-ttu-id="0c511-221">Cette notation, \**sorties =% \* \* \* (ITEMLIST. ItemMetaDataName)* , est traduite comme suit :</span><span class="sxs-lookup"><span data-stu-id="0c511-221">This notation, \**Outputs=%\*\*\*(ItemList.ItemMetadataName)*, is translated as:</span></span>

- <span data-ttu-id="0c511-222">Fractionnez les éléments de **DbPublishPackages** en lots d’éléments qui contiennent la même valeur de métadonnées d' **identité** .</span><span class="sxs-lookup"><span data-stu-id="0c511-222">Split the items in **DbPublishPackages** into batches of items that contain the same **Identity** metadata value.</span></span>
- <span data-ttu-id="0c511-223">Exécutez la cible une fois par lot.</span><span class="sxs-lookup"><span data-stu-id="0c511-223">Execute the target once per batch.</span></span>

> [!NOTE]
> <span data-ttu-id="0c511-224">L' **identité** est l’une des [valeurs de métadonnées intégrées](https://msdn.microsoft.com/library/ms164313.aspx) qui est assignée à chaque élément lors de la création.</span><span class="sxs-lookup"><span data-stu-id="0c511-224">**Identity** is one of the [built-in metadata values](https://msdn.microsoft.com/library/ms164313.aspx) that is assigned to every item on creation.</span></span> <span data-ttu-id="0c511-225">Elle fait référence à la valeur de l’attribut **include** dans l'&#x2014;élément **Item** en d’autres termes, le chemin d’accès et le nom de fichier de l’élément.</span><span class="sxs-lookup"><span data-stu-id="0c511-225">It refers to the value of the **Include** attribute in the **Item** element&#x2014;in other words, the path and filename of the item.</span></span>

<span data-ttu-id="0c511-226">Dans ce cas, étant donné qu’il ne doit jamais y avoir plus d’un élément avec le même chemin d’accès et le même nom de fichier, nous travaillons essentiellement sur la taille des lots d’un.</span><span class="sxs-lookup"><span data-stu-id="0c511-226">In this case, because there should never be more than one item with the same path and filename, we're essentially working with batch sizes of one.</span></span> <span data-ttu-id="0c511-227">La cible est exécutée une fois pour chaque package de base de données.</span><span class="sxs-lookup"><span data-stu-id="0c511-227">The target is executed once for every database package.</span></span>

<span data-ttu-id="0c511-228">Vous pouvez voir une notation similaire dans la propriété **\_cmd** , qui génère une commande VSDBCMD avec les commutateurs appropriés.</span><span class="sxs-lookup"><span data-stu-id="0c511-228">You can see a similar notation in the **\_Cmd** property, which builds a VSDBCMD command with the appropriate switches.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample11.xml)]

<span data-ttu-id="0c511-229">Dans ce cas, **% (DbPublishPackages. DatabaseConnectionString)** , **% (DbPublishPackages. TargetDatabase)** et **% (DbPublishPackages. FullPath)** font tous référence aux valeurs de métadonnées de la collection d’éléments **DbPublishPackages** .</span><span class="sxs-lookup"><span data-stu-id="0c511-229">In this case, **%(DbPublishPackages.DatabaseConnectionString)**, **%(DbPublishPackages.TargetDatabase)**, and **%(DbPublishPackages.FullPath)** all refer to metadata values of the **DbPublishPackages** item collection.</span></span> <span data-ttu-id="0c511-230">La propriété **Cmd\_** est utilisée par la tâche **Exec** , qui appelle la commande.</span><span class="sxs-lookup"><span data-stu-id="0c511-230">The **\_Cmd** property is used by the **Exec** task, which invokes the command.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample12.xml)]

<span data-ttu-id="0c511-231">À la suite de cette notation, la tâche **Exec** créera des lots basés sur des combinaisons uniques des valeurs de métadonnées **DatabaseConnectionString**, **TargetDatabase**et **FullPath** , et la tâche s’exécutera une fois pour chaque lot.</span><span class="sxs-lookup"><span data-stu-id="0c511-231">As a result of this notation, the **Exec** task will create batches based on unique combinations of the **DatabaseConnectionString**, **TargetDatabase**, and **FullPath** metadata values, and the task will execute once for each batch.</span></span> <span data-ttu-id="0c511-232">Il s’agit d’un exemple de *traitement par lot de tâches*.</span><span class="sxs-lookup"><span data-stu-id="0c511-232">This is an example of *task batching*.</span></span> <span data-ttu-id="0c511-233">Toutefois, étant donné que le traitement par lot au niveau de la cible a déjà divisé notre collection d’éléments en lots à un seul élément, la tâche **Exec** s’exécutera une seule fois pour chaque itération de la cible.</span><span class="sxs-lookup"><span data-stu-id="0c511-233">However, because the target-level batching has already divided our item collection into single-item batches, the **Exec** task will run once and only once for each iteration of the target.</span></span> <span data-ttu-id="0c511-234">En d’autres termes, cette tâche appelle l’utilitaire VSDBCMD une fois pour chaque package de base de données de la solution.</span><span class="sxs-lookup"><span data-stu-id="0c511-234">In other words, this task invokes the VSDBCMD utility once for each database package in the solution.</span></span>

> [!NOTE]
> <span data-ttu-id="0c511-235">Pour plus d’informations sur le traitement par lots de cibles et de tâches, consultez [traitement](https://msdn.microsoft.com/library/ms171473.aspx)par lot MSBuild, [métadonnées d’élément dans le traitement par lots de cibles](https://msdn.microsoft.com/library/ms228229.aspx)et [métadonnées d’élément dans le traitement par lot des tâches](https://msdn.microsoft.com/library/ms171474.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c511-235">For more information on target and task batching, see MSBuild [Batching](https://msdn.microsoft.com/library/ms171473.aspx), [Item Metadata in Target Batching](https://msdn.microsoft.com/library/ms228229.aspx), and [Item Metadata in Task Batching](https://msdn.microsoft.com/library/ms171474.aspx).</span></span>

### <a name="the-publishwebpackages-target"></a><span data-ttu-id="0c511-236">Cible PublishWebPackages</span><span class="sxs-lookup"><span data-stu-id="0c511-236">The PublishWebPackages Target</span></span>

<span data-ttu-id="0c511-237">À ce stade, vous avez appelé la cible **BuildProjects** , qui génère un package de déploiement Web pour chaque projet de l’exemple de solution.</span><span class="sxs-lookup"><span data-stu-id="0c511-237">By this point, you've invoked the **BuildProjects** target, which generates a web deployment package for each project in the sample solution.</span></span> <span data-ttu-id="0c511-238">L’accompagnement de chaque package est un fichier *Deploy. cmd* , qui contient les commandes msdeploy. exe requises pour déployer le package dans l’environnement cible, et un fichier *SetParameters. xml* qui spécifie les détails nécessaires de l’environnement cible.</span><span class="sxs-lookup"><span data-stu-id="0c511-238">Accompanying each package is a *deploy.cmd* file, which contains the MSDeploy.exe commands required to deploy the package to the target environment, and a *SetParameters.xml* file, which specifies the necessary details of the target environment.</span></span> <span data-ttu-id="0c511-239">Vous avez également appelé la cible **GatherPackagesForPublishing** , qui génère une collection d’éléments contenant les fichiers *Deploy. cmd* qui vous intéressent.</span><span class="sxs-lookup"><span data-stu-id="0c511-239">You've also invoked the **GatherPackagesForPublishing** target, which generates an item collection containing the *deploy.cmd* files you're interested in.</span></span> <span data-ttu-id="0c511-240">Fondamentalement, la cible **PublishWebPackages** exécute les fonctions suivantes :</span><span class="sxs-lookup"><span data-stu-id="0c511-240">Essentially, the **PublishWebPackages** target performs these functions:</span></span>

- <span data-ttu-id="0c511-241">Il manipule le fichier *SetParameters. xml* de chaque package pour inclure les détails corrects de l’environnement cible, à l’aide de la tâche **XmlPoke** .</span><span class="sxs-lookup"><span data-stu-id="0c511-241">It manipulates the *SetParameters.xml* file for each package to include the correct details for the target environment, using the **XmlPoke** task.</span></span>
- <span data-ttu-id="0c511-242">Il appelle le fichier *Deploy. cmd* pour chaque package, à l’aide des commutateurs appropriés.</span><span class="sxs-lookup"><span data-stu-id="0c511-242">It invokes the *deploy.cmd* file for each package, using the appropriate switches.</span></span>

<span data-ttu-id="0c511-243">Tout comme la cible **PublishDbPackages** , la cible **PublishWebPackages** utilise le traitement par lots cible pour s’assurer que la cible est exécutée une fois pour chaque package Web.</span><span class="sxs-lookup"><span data-stu-id="0c511-243">Just like the **PublishDbPackages** target, the **PublishWebPackages** target uses target batching to ensure that the target is executed once for each web package.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample13.xml)]

<span data-ttu-id="0c511-244">Dans la cible, la tâche **Exec** est utilisée pour exécuter le fichier *Deploy. cmd* pour chaque package Web.</span><span class="sxs-lookup"><span data-stu-id="0c511-244">Within the target, the **Exec** task is used to run the *deploy.cmd* file for each web package.</span></span>

[!code-xml[Main](understanding-the-build-process/samples/sample14.xml)]

<span data-ttu-id="0c511-245">Pour plus d’informations sur la configuration du déploiement de packages Web, consultez [génération et empaquetage de projets d’application Web](building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="0c511-245">For more information on configuring the deployment of web packages, see [Building and Packaging Web Application Projects](building-and-packaging-web-application-projects.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="0c511-246">Conclusion</span><span class="sxs-lookup"><span data-stu-id="0c511-246">Conclusion</span></span>

<span data-ttu-id="0c511-247">Cette rubrique a fourni une procédure pas à pas sur la façon dont les fichiers de projet fractionné sont utilisés pour contrôler le processus de génération et de déploiement du début à la fin de l’exemple de solution du gestionnaire de contacts.</span><span class="sxs-lookup"><span data-stu-id="0c511-247">This topic provided a walkthrough of how split project files are used to control the build and deployment process from start to finish for the Contact Manager sample solution.</span></span> <span data-ttu-id="0c511-248">Cette approche vous permet d’exécuter des déploiements complexes à l’échelle de l’entreprise en une seule étape renouvelable, en exécutant simplement un fichier de commandes spécifique à l’environnement.</span><span class="sxs-lookup"><span data-stu-id="0c511-248">Using this approach lets you run complex, enterprise-scale deployments in a single, repeatable step, simply by running an environment-specific command file.</span></span>

## <a name="further-reading"></a><span data-ttu-id="0c511-249">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="0c511-249">Further Reading</span></span>

<span data-ttu-id="0c511-250">Pour une présentation plus approfondie des fichiers projet et du WPP, consultez à l' [intérieur du Microsoft Build Engine : utilisation de MSBuild et Team Foundation Build](http://amzn.com/0735645248) par Sayed Ibrahim Hashimi et William Bartholomew, ISBN : 978-0-7356-4524-0.</span><span class="sxs-lookup"><span data-stu-id="0c511-250">For a more in-depth introduction to project files and the WPP, see [Inside the Microsoft Build Engine: Using MSBuild and Team Foundation Build](http://amzn.com/0735645248) by Sayed Ibrahim Hashimi and William Bartholomew, ISBN: 978-0-7356-4524-0.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0c511-251">[Précédent](understanding-the-project-file.md)
> [Suivant](building-and-packaging-web-application-projects.md)</span><span class="sxs-lookup"><span data-stu-id="0c511-251">[Previous](understanding-the-project-file.md)
[Next](building-and-packaging-web-application-projects.md)</span></span>
