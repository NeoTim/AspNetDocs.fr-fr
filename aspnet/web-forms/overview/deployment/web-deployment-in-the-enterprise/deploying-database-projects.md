---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
title: Déploiement de projets de base de données | Microsoft Docs
author: jrjlee
description: 'Remarque : Dans un grand nombre de scénarios de déploiement d’entreprise, vous devez la possibilité de publier des mises à jour incrémentielles dans une base de données déployée. L’alternative consiste à recréer...'
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 832f226a-1aa3-4093-8c29-ce4196793259
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
msc.type: authoredcontent
ms.openlocfilehash: f5b7cecdd1a8dbd9be1bd781cec31c53c9096546
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59383217"
---
# <a name="deploying-database-projects"></a><span data-ttu-id="fc5ca-104">Déploiement de projets de base de données</span><span class="sxs-lookup"><span data-stu-id="fc5ca-104">Deploying Database Projects</span></span>

<span data-ttu-id="fc5ca-105">par [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="fc5ca-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="fc5ca-106">Télécharger PDF</span><span class="sxs-lookup"><span data-stu-id="fc5ca-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> [!NOTE]
> <span data-ttu-id="fc5ca-107">Dans un grand nombre de scénarios de déploiement d’entreprise, vous devez la possibilité de publier des mises à jour incrémentielles dans une base de données déployée.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-107">In lots of enterprise deployment scenarios, you need the ability to publish incremental updates to a deployed database.</span></span> <span data-ttu-id="fc5ca-108">L’alternative consiste à recréer la base de données sur chaque déploiement, ce qui signifie que vous perdez toutes les données dans la base de données existante.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-108">The alternative is to recreate the database on every deployment, which means you lose any data in the existing database.</span></span> <span data-ttu-id="fc5ca-109">Lorsque vous travaillez avec Visual Studio 2010, à l’aide de VSDBCMD est l’approche recommandée pour la publication de base de données incrémentielles.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-109">When you work with Visual Studio 2010, using VSDBCMD is the recommended approach to incremental database publishing.</span></span> <span data-ttu-id="fc5ca-110">Toutefois, la prochaine version de Visual Studio et le Pipeline de publication Web (WPP) inclut des outils qui prend en charge directement la publication incrémentielle.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-110">However, the next version of Visual Studio and the Web Publishing Pipeline (WPP) will include tooling that supports incremental publishing directly.</span></span>


<span data-ttu-id="fc5ca-111">Si vous ouvrez l’exemple de gestionnaire de contacts solution dans Visual Studio 2010, vous verrez que le projet de base de données inclut un dossier de propriétés qui contient quatre fichiers.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-111">If you open the Contact Manager sample solution in Visual Studio 2010, you'll see that the database project includes a Properties folder that contains four files.</span></span>

![](deploying-database-projects/_static/image1.png)

<span data-ttu-id="fc5ca-112">Avec le fichier projet (*ContactManager.Database.dbproj* dans ce cas), ces fichiers contrôlent divers aspects du processus de génération et de déploiement :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-112">Together with the project file (*ContactManager.Database.dbproj* in this case), these files control various aspects of the build and deployment process:</span></span>

- <span data-ttu-id="fc5ca-113">Le *Database.sqlcmdvars* fichier fournit des valeurs des variables SQLCMD que vous utilisez lorsque vous déployez le projet.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-113">The *Database.sqlcmdvars* file provides values for any SQLCMD variables you use when you deploy the project.</span></span> <span data-ttu-id="fc5ca-114">Chaque configuration de solution (par exemple, debug et release) pouvez spécifier un fichier .sqlcmdvars différent.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-114">Each solution configuration (for example, debug and release) can specify a different .sqlcmdvars file.</span></span>
- <span data-ttu-id="fc5ca-115">Le *Database.sqldeployment* fichier fournit des paramètres spécifiques au déploiement, comme s’il faut utiliser le classement défini dans votre projet ou le classement du serveur de destination, s’il faut recréer la base de données de destination chaque heure, ou simplement modifier la base de données existante pour mettre à jour et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-115">The *Database.sqldeployment* file provides deployment-specific settings, like whether to use the collation defined in your project or the collation of the destination server, whether to recreate the destination database every time or simply amend the existing database to bring it up to date, and so on.</span></span> <span data-ttu-id="fc5ca-116">Chaque configuration de solution peut spécifier un fichier de .sqldeployment différents.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-116">Each solution configuration can specify a different .sqldeployment file.</span></span>
- <span data-ttu-id="fc5ca-117">Le *Database.sqlpermissions* fichier est un document XML que vous pouvez utiliser pour définir des autorisations que vous souhaitez ajouter à la base de données cible.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-117">The *Database.sqlpermissions* file is an XML document that you can use to define any permissions you want to add to the target database.</span></span> <span data-ttu-id="fc5ca-118">Toutes les configurations de solution partagent le même fichier .sqlpermissions.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-118">All solution configurations share the same .sqlpermissions file.</span></span>
- <span data-ttu-id="fc5ca-119">Le *Database.sqlsettings* fichier spécifie les propriétés de niveau de base de données à utiliser lors de la création de la base de données, comme le classement à utiliser, le comportement des opérateurs de comparaison et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-119">The *Database.sqlsettings* file specifies the database-level properties to use when creating the database, like the collation to use, the behavior of comparison operators, and so on.</span></span> <span data-ttu-id="fc5ca-120">Toutes les configurations de solution partagent le même fichier .sqlsettings.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-120">All solution configurations share the same .sqlsettings file.</span></span>

<span data-ttu-id="fc5ca-121">Il est important de prendre un moment pour ouvrir ces fichiers dans Visual Studio et vous familiariser avec le contenu.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-121">It's worth taking a moment to open these files in Visual Studio and familiarize yourself with the contents.</span></span>

<span data-ttu-id="fc5ca-122">Lorsque vous générez un projet de base de données, le processus de génération crée deux fichiers :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-122">When you build a database project, the build process creates two files:</span></span>

- <span data-ttu-id="fc5ca-123">Un *schéma de base de données* (fichier .dbschema).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-123">A *database schema* (.dbschema file).</span></span> <span data-ttu-id="fc5ca-124">Cette section décrit le schéma de la base de données que vous voulez créer au format XML.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-124">This describes the schema of the database you want to create in XML format.</span></span>
- <span data-ttu-id="fc5ca-125">Un *manifeste de déploiement* (fichier .deploymanifest).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-125">A *deployment manifest* (.deploymanifest file).</span></span> <span data-ttu-id="fc5ca-126">Il contient toutes les informations requises pour créer et déployer votre base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-126">This contains all the information required to create and deploy your database.</span></span> <span data-ttu-id="fc5ca-127">Il fait référence au fichier .dbschema ainsi que d’autres ressources, telles que les instructions de déploiement (fichier .sqldeployment) et les scripts SQL de prédéploiement ou de post-déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-127">It references the .dbschema file along with other resources, like the deployment instructions (the .sqldeployment file) and any pre-deployment or post-deployment SQL scripts.</span></span>

<span data-ttu-id="fc5ca-128">Cet exemple montre la relation entre ces ressources :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-128">This shows the relationship between these resources:</span></span>

![](deploying-database-projects/_static/image2.png)

<span data-ttu-id="fc5ca-129">Comme vous pouvez le voir, le fichier .sqlsettings et le fichier .sqlpermissions sont entrées dans le processus de génération.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-129">As you can see, the .sqlsettings file and the .sqlpermissions file are inputs to the build process.</span></span> <span data-ttu-id="fc5ca-130">Ainsi que le fichier de projet de base de données, ces fichiers sont utilisés pour créer le fichier de schéma de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-130">Along with the database project file, these files are used to create the database schema file.</span></span> <span data-ttu-id="fc5ca-131">Le fichier .sqldeployment et le fichier .sqlcmdvars passent par le processus de génération inchangé.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-131">The .sqldeployment file and the .sqlcmdvars file pass through the build process unchanged.</span></span> <span data-ttu-id="fc5ca-132">Le manifeste de déploiement indique l’emplacement de tous les scripts SQL prédéploiement ou de post-déploiement, le fichier .sqlcmdvars, le schéma de base de données et le fichier .sqldeployment.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-132">The deployment manifest indicates the location of the database schema, the .sqldeployment file, the .sqlcmdvars file, and any pre-deployment or post-deployment SQL scripts.</span></span>

## <a name="why-use-vsdbcmd-to-deploy-a-database-project"></a><span data-ttu-id="fc5ca-133">Pourquoi utiliser VSDBCMD pour déployer un projet de base de données ?</span><span class="sxs-lookup"><span data-stu-id="fc5ca-133">Why Use VSDBCMD to Deploy a Database Project?</span></span>

<span data-ttu-id="fc5ca-134">Il existe différentes approches différentes pour déployer des projets de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-134">There are various different approaches to deploying database projects.</span></span> <span data-ttu-id="fc5ca-135">Toutefois, certaines d'entre elles ne conviennent pour le déploiement d’un projet de base de données sur des serveurs distants dans un environnement d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-135">However, not all of them are suitable for deploying a database project to remote servers in an enterprise environment.</span></span> <span data-ttu-id="fc5ca-136">Envisagez ce que vous souhaitez à partir d’un déploiement de projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-136">Consider what you want from a database project deployment.</span></span> <span data-ttu-id="fc5ca-137">Dans les scénarios de déploiement d’entreprise, vous êtes susceptible de vouloir :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-137">In enterprise deployment scenarios, you're likely to want:</span></span>

- <span data-ttu-id="fc5ca-138">La possibilité de déployer le projet de base de données à partir d’un emplacement distant.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-138">The ability to deploy the database project from a remote location.</span></span>
- <span data-ttu-id="fc5ca-139">La possibilité d’apporter des mises à jour incrémentielles à une base de données existante.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-139">The ability to make incremental updates to an existing database.</span></span>
- <span data-ttu-id="fc5ca-140">La possibilité d’inclure des scripts de prédéploiement ou post-déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-140">The ability to include pre-deployment scripts or post-deployment scripts.</span></span>
- <span data-ttu-id="fc5ca-141">La possibilité d’adapter le déploiement dans plusieurs environnements de destination.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-141">The ability to tailor the deployment to multiple destination environments.</span></span>
- <span data-ttu-id="fc5ca-142">La possibilité de déployer le projet de base de données dans le cadre d’une plus grande, généralement l’objet de scripts, déploiement d’une solution de la seule étape.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-142">The ability to deploy the database project as part of a larger, typically scripted, single-step solution deployment.</span></span>

<span data-ttu-id="fc5ca-143">Il existe trois approches principales, que vous pouvez utiliser pour déployer un projet de base de données :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-143">There are three main approaches you can use to deploy a database project:</span></span>

- <span data-ttu-id="fc5ca-144">Vous pouvez utiliser la fonctionnalité de déploiement avec le type de projet de base de données dans Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-144">You can use the deployment functionality with the database project type in Visual Studio 2010.</span></span> <span data-ttu-id="fc5ca-145">Lorsque vous générez et déployez un projet de base de données dans Visual Studio 2010, le processus de déploiement utilise le manifeste de déploiement pour générer un fichier de déploiement basé sur SQL spécifique à la configuration de build.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-145">When you build and deploy a database project in Visual Studio 2010, the deployment process uses the deployment manifest to generate a SQL-based deployment file specific to the build configuration.</span></span> <span data-ttu-id="fc5ca-146">Cette opération crée la base de données si elle n’existent déjà ou apportez les modifications nécessaires à la base de données s’il existe déjà.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-146">This will create the database if it doesn't already exist or make any necessary changes to the database if it does already exist.</span></span> <span data-ttu-id="fc5ca-147">Vous pouvez utiliser SQLCMD.exe pour exécuter ce fichier sur votre serveur de destination, ou vous pouvez configurer Visual Studio pour créer et exécuter le fichier.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-147">You can use SQLCMD.exe to run this file on your destination server, or you can set Visual Studio to create and run the file.</span></span> <span data-ttu-id="fc5ca-148">L’inconvénient de cette approche est que vous avez uniquement un contrôle limité sur les paramètres de déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-148">The disadvantage of this approach is that you have only limited control over the deployment settings.</span></span> <span data-ttu-id="fc5ca-149">Vous devrez peut-être également souvent modifier le fichier de déploiement SQL pour fournir les valeurs des variables spécifiques à l’environnement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-149">You may often also need to modify the SQL deployment file to provide environment-specific variable values.</span></span> <span data-ttu-id="fc5ca-150">Vous pouvez uniquement utiliser cette approche basée sur un ordinateur avec Visual Studio 2010 est installé et que le développeur doit connaître et fournir des chaînes de connexion et les informations d’identification pour tous les environnements de destination.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-150">You can only use this approach from a computer with Visual Studio 2010 installed, and the developer would need to know and provide connection strings and credentials for all destination environments.</span></span>
- <span data-ttu-id="fc5ca-151">Vous pouvez utiliser l’outil de déploiement Web Internet Information Services (IIS) (Web Deploy) pour [déployer une base de données en tant que partie d’un projet d’application web](https://msdn.microsoft.com/library/dd465343.aspx).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-151">You can use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to [deploy a database as part of a web application project](https://msdn.microsoft.com/library/dd465343.aspx).</span></span> <span data-ttu-id="fc5ca-152">Toutefois, cette approche est beaucoup plus complexe si vous souhaitez déployer un projet de base de données au lieu de simplement répliquer une base de données local existant sur un serveur de destination.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-152">However, this approach is a lot more complex if you want to deploy a database project rather than simply replicate an existing local database on a destination server.</span></span> <span data-ttu-id="fc5ca-153">Vous pouvez configurer Web Deploy pour exécuter le script de déploiement SQL qui génère le projet de base de données, mais pour ce faire, vous devez créer un fichier de cibles WPP personnalisé pour votre projet d’application web.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-153">You can configure Web Deploy to run the SQL deployment script that the database project generates, but in order to do this, you need to create a custom WPP targets file for your web application project.</span></span> <span data-ttu-id="fc5ca-154">Cela ajoute une quantité importante de complexité au processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-154">This adds a substantial amount of complexity to the deployment process.</span></span> <span data-ttu-id="fc5ca-155">En outre, Web Deploy ne pas directement en charge les mises à jour incrémentielles de bases de données existantes.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-155">In addition, Web Deploy does not directly support incremental updates to existing databases.</span></span> <span data-ttu-id="fc5ca-156">Pour plus d’informations sur cette approche, consultez [étendre le Pipeline de publication Web au projet de base de données de package déployé fichier SQL](https://go.microsoft.com/?linkid=9805121).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-156">For more information on this approach, see [Extending the Web Publishing Pipeline to package database project deployed SQL file](https://go.microsoft.com/?linkid=9805121).</span></span>
- <span data-ttu-id="fc5ca-157">Vous pouvez utiliser l’utilitaire VSDBCMD pour déployer la base de données, à l’aide du schéma de base de données ou le manifeste de déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-157">You can use the VSDBCMD utility to deploy the database, using either the database schema or the deployment manifest.</span></span> <span data-ttu-id="fc5ca-158">Vous pouvez appeler VSDBCMD.exe à partir d’une cible MSBuild, qui vous permet de publier des bases de données en tant que partie d’un processus de déploiement plus vastes et à l’aide de scripts.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-158">You can call VSDBCMD.exe from an MSBuild target, which lets you publish databases as part of a larger, scripted deployment process.</span></span> <span data-ttu-id="fc5ca-159">Vous pouvez remplacer les variables dans votre fichier .sqlcmdvars et de nombreux autres propriétés de base de données à partir d’une commande VSDBCMD, ce qui vous permet de personnaliser votre déploiement pour différents environnements sans créer plusieurs configurations de build.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-159">You can override the variables in your .sqlcmdvars file and lots of other database properties from a VSDBCMD command, which allows you to customize your deployment for different environments without creating multiple build configurations.</span></span> <span data-ttu-id="fc5ca-160">VSDBCMD fournit des fonctionnalités de différenciation, ce qui signifie qu’il effectue uniquement les modifications nécessaires pour aligner une base de données de destination avec votre schéma de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-160">VSDBCMD provides differentiation functionality, which means it will make only the necessary changes to align a destination database with your database schema.</span></span> <span data-ttu-id="fc5ca-161">VSDBCMD offre également un large éventail d’options de ligne de commande, ce qui vous donne un contrôle précis sur le processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-161">VSDBCMD also offers a wide range of command-line options, which give you fine-grained control over the deployment process.</span></span>

<span data-ttu-id="fc5ca-162">Cette vue d’ensemble, vous pouvez voir que l’utilisation de VSDBCMD avec MSBuild est l’approche la mieux adaptée à un scénario de déploiement standard de l’entreprise :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-162">From this overview, you can see that using VSDBCMD with MSBuild is the approach best suited to a typical enterprise deployment scenario:</span></span>

|  | <span data-ttu-id="fc5ca-163">Visual Studio 2010</span><span class="sxs-lookup"><span data-stu-id="fc5ca-163">Visual Studio 2010</span></span> | <span data-ttu-id="fc5ca-164">Web Deploy 2.0</span><span class="sxs-lookup"><span data-stu-id="fc5ca-164">Web Deploy 2.0</span></span> | <span data-ttu-id="fc5ca-165">VSDBCMD.exe</span><span class="sxs-lookup"><span data-stu-id="fc5ca-165">VSDBCMD.exe</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="fc5ca-166">Prend en charge le déploiement à distance ?</span><span class="sxs-lookup"><span data-stu-id="fc5ca-166">Supports remote deployment?</span></span> | <span data-ttu-id="fc5ca-167">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-167">Yes</span></span> | <span data-ttu-id="fc5ca-168">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-168">Yes</span></span> | <span data-ttu-id="fc5ca-169">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-169">Yes</span></span> |
| <span data-ttu-id="fc5ca-170">Prend en charge les mises à jour incrémentielles ?</span><span class="sxs-lookup"><span data-stu-id="fc5ca-170">Supports incremental updates?</span></span> | <span data-ttu-id="fc5ca-171">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-171">Yes</span></span> | <span data-ttu-id="fc5ca-172">Non</span><span class="sxs-lookup"><span data-stu-id="fc5ca-172">No</span></span> | <span data-ttu-id="fc5ca-173">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-173">Yes</span></span> |
| <span data-ttu-id="fc5ca-174">Prend en charge les scripts de pré et de post-déploiement ?</span><span class="sxs-lookup"><span data-stu-id="fc5ca-174">Supports pre/post-deployment scripts?</span></span> | <span data-ttu-id="fc5ca-175">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-175">Yes</span></span> | <span data-ttu-id="fc5ca-176">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-176">Yes</span></span> | <span data-ttu-id="fc5ca-177">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-177">Yes</span></span> |
| <span data-ttu-id="fc5ca-178">Prend en charge le déploiement de l’environnement multi ?</span><span class="sxs-lookup"><span data-stu-id="fc5ca-178">Supports multi-environment deployment?</span></span> | <span data-ttu-id="fc5ca-179">Limité</span><span class="sxs-lookup"><span data-stu-id="fc5ca-179">Limited</span></span> | <span data-ttu-id="fc5ca-180">Limité</span><span class="sxs-lookup"><span data-stu-id="fc5ca-180">Limited</span></span> | <span data-ttu-id="fc5ca-181">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-181">Yes</span></span> |
| <span data-ttu-id="fc5ca-182">Prend en charge de scripts de déploiement ?</span><span class="sxs-lookup"><span data-stu-id="fc5ca-182">Supports scripted deployment?</span></span> | <span data-ttu-id="fc5ca-183">Limité</span><span class="sxs-lookup"><span data-stu-id="fc5ca-183">Limited</span></span> | <span data-ttu-id="fc5ca-184">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-184">Yes</span></span> | <span data-ttu-id="fc5ca-185">Oui</span><span class="sxs-lookup"><span data-stu-id="fc5ca-185">Yes</span></span> |

<span data-ttu-id="fc5ca-186">Le reste de cette rubrique décrit l’utilisation de VSDBCMD avec MSBuild pour déployer des projets de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-186">The remainder of this topic describes the use of VSDBCMD with MSBuild to deploy database projects.</span></span>

## <a name="understanding-the-deployment-process"></a><span data-ttu-id="fc5ca-187">Présentation du processus de déploiement</span><span class="sxs-lookup"><span data-stu-id="fc5ca-187">Understanding the Deployment Process</span></span>

<span data-ttu-id="fc5ca-188">L’utilitaire VSDBCMD vous permet de déployer une base de données à l’aide du schéma de base de données (fichier .dbschema) ou le manifeste de déploiement (le fichier .deploymanifest).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-188">The VSDBCMD utility lets you deploy a database using either the database schema (the .dbschema file) or the deployment manifest (the .deploymanifest file).</span></span> <span data-ttu-id="fc5ca-189">Dans la pratique, vous utiliserez presque toujours le manifeste de déploiement, comme le manifeste de déploiement vous permet de fournir des valeurs par défaut pour les différentes propriétés de déploiement et identifier tout vous souhaitez exécuter les scripts SQL prédéploiement ou de post-déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-189">In practice, you'll almost always use the deployment manifest, as the deployment manifest lets you provide default values for various deployment properties and identify any pre-deployment or post-deployment SQL scripts you want to run.</span></span> <span data-ttu-id="fc5ca-190">Par exemple, cette commande VSDBCMD permet de déployer le **ContactManager** base de données à un serveur de base de données dans un environnement de test :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-190">For example, this VSDBCMD command is used to deploy the **ContactManager** database to a database server in a test environment:</span></span>


[!code-console[Main](deploying-database-projects/samples/sample1.cmd)]


<span data-ttu-id="fc5ca-191">Dans ce cas :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-191">In this case:</span></span>

- <span data-ttu-id="fc5ca-192">Le **/a** (ou **/action**) commutateur spécifie ce que vous voulez VSDBCMD à faire.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-192">The **/a** (or **/Action**) switch specifies what you want VSDBCMD to do.</span></span> <span data-ttu-id="fc5ca-193">Vous pouvez définir ici **importation** ou **déployer**.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-193">You can set this to **Import** or **Deploy**.</span></span> <span data-ttu-id="fc5ca-194">Le **importation** option est utilisée pour générer un fichier .dbschema à partir d’une base de données existante et le **déployer** option est utilisée pour déployer un fichier .dbschema sur une base de données cible.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-194">The **Import** option is used to generate a .dbschema file from an existing database, and the **Deploy** option is used to deploy a .dbschema file to a target database.</span></span>
- <span data-ttu-id="fc5ca-195">Le **de manifeste** (ou **MANIFESTFILE**) commutateur identifie le fichier .deploymanifest que vous souhaitez déployer.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-195">The **/manifest** (or **/ManifestFile**) switch identifies the .deploymanifest file you want to deploy.</span></span> <span data-ttu-id="fc5ca-196">Si vous souhaitez utiliser le fichier .dbschema au lieu de cela, vous utiliseriez le **/modèle** (ou **/ModelFile**) basculer.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-196">If you wanted to use the .dbschema file instead, you'd use the **/model** (or **/ModelFile**) switch.</span></span>
- <span data-ttu-id="fc5ca-197">Le **/cs.** (ou **/ConnectionString**) commutateur fournit la chaîne de connexion pour le serveur de base de données cible.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-197">The **/cs** (or **/ConnectionString**) switch provides the connection string for the target database server.</span></span> <span data-ttu-id="fc5ca-198">Notez que ceci n’inclut pas le nom de la base de données&#x2014;VSDBCMD doit se connecter au serveur pour créer la base de données ; Il n’a pas besoin de se connecter à une base de données individuel.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-198">Note that this doesn't include the name of the database&#x2014;VSDBCMD needs to connect to the server to create the database; it doesn't need to connect to an individual database.</span></span> <span data-ttu-id="fc5ca-199">Si votre fichier .deploymanifest inclut une chaîne de connexion, vous pouvez omettre ce commutateur.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-199">If your .deploymanifest file includes a connection string, you can omit this switch.</span></span> <span data-ttu-id="fc5ca-200">Si vous utilisez le commutateur tout de même, la valeur du commutateur remplacera la valeur .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-200">If you use the switch anyway, the switch value will override the .deploymanifest value.</span></span>
- <span data-ttu-id="fc5ca-201">Le <strong>/p : TargetDatabase</strong> fournit le nom que vous souhaitez affecter à la base de données cible lors de la création.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-201">The <strong>/p:TargetDatabase</strong> property provides the name you want to assign to the target database on creation.</span></span> <span data-ttu-id="fc5ca-202">Cela remplace la valeur de la <strong>TargetDatabase</strong> propriété dans le fichier .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-202">This overrides the value of the <strong>TargetDatabase</strong> property in the .deploymanifest file.</span></span> <span data-ttu-id="fc5ca-203">Vous pouvez utiliser la <strong>/p:</strong> <em>[nom_propriété]</em>syntaxe pour définir un large éventail de propriétés de déploiement et pour remplacer toutes les variables SQLCMD déclaré dans votre fichier .sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-203">You can use the <strong>/p:</strong> <em>[property name]</em>syntax to set a wide variety of deployment properties and to override any SQLCMD variables declared in your .sqlcmdvars file.</span></span>
- <span data-ttu-id="fc5ca-204">Le **/dd+** (ou **/DeployToDatabase+**) commutateur indique que vous souhaitez créer un déploiement et le déployer à l’environnement cible.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-204">The **/dd+** (or **/DeployToDatabase+**) switch indicates that you want to create a deployment and deploy it to the target environment.</span></span> <span data-ttu-id="fc5ca-205">Si vous spécifiez **/dd-**, ou omettre le commutateur, VSDBCMD génère un script de déploiement, mais il déploiera pas à l’environnement cible.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-205">If you specify **/dd-**, or omit the switch, VSDBCMD will generate a deployment script but will not deploy it to the target environment.</span></span> <span data-ttu-id="fc5ca-206">Ce commutateur est souvent la source de confusion et est expliqué plus en détail dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-206">This switch is often the source of confusion and is explained in more detail in the next section.</span></span>
- <span data-ttu-id="fc5ca-207">Le **/script** (ou **/DeploymentScriptFile**) commutateur spécifie où vous souhaitez générer le script de déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-207">The **/script** (or **/DeploymentScriptFile**) switch specifies where you want to generate the deployment script.</span></span> <span data-ttu-id="fc5ca-208">Cette valeur n’affecte pas le processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-208">This value does not affect the deployment process.</span></span>

<span data-ttu-id="fc5ca-209">Pour plus d’informations sur VSDBCMD, consultez [référence de ligne de commande pour VSDBCMD. EXE (déploiement et importation de schéma)](https://msdn.microsoft.com/library/dd193283.aspx) et [Comment : Préparer une base de données pour le déploiement à partir d’une invite de commandes à l’aide de VSDBCMD. EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-209">For more information on VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span></span>

<span data-ttu-id="fc5ca-210">Pour obtenir un exemple de comment vous pouvez utiliser VSDBCMD à partir d’un fichier projet MSBuild, consultez [comprendre le processus de génération](understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-210">For an example of how you can use VSDBCMD from an MSBuild project file, see [Understanding the Build Process](understanding-the-build-process.md).</span></span> <span data-ttu-id="fc5ca-211">Pour obtenir des exemples montrant comment configurer les paramètres de déploiement de base de données pour plusieurs environnements, consultez [personnalisation des déploiements de base de données pour plusieurs environnements](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-211">For examples of how to configure database deployment settings for multiple environments, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="understanding-the-deploytodatabase-switch"></a><span data-ttu-id="fc5ca-212">Présentation du commutateur DeployToDatabase</span><span class="sxs-lookup"><span data-stu-id="fc5ca-212">Understanding the DeployToDatabase Switch</span></span>

<span data-ttu-id="fc5ca-213">Le comportement de la **/DD** ou **/DeployToDatabase** commutateur varie selon que vous utilisez VSDBCMD avec un fichier .dbschema ou un fichier .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-213">The behavior of the **/dd** or **/DeployToDatabase** switch depends on whether you're using VSDBCMD with a .dbschema file or a .deploymanifest file.</span></span> <span data-ttu-id="fc5ca-214">Si vous utilisez un fichier .dbschema, le comportement est assez simple :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-214">If you're using a .dbschema file, the behavior is fairly straightforward:</span></span>

- <span data-ttu-id="fc5ca-215">Si vous spécifiez **/dd+** ou **/DD**, VSDBCMD génère un script de déploiement et déployer la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-215">If you specify **/dd+** or **/dd**, VSDBCMD will generate a deployment script and deploy the database.</span></span>
- <span data-ttu-id="fc5ca-216">Si vous spécifiez **/dd-** ou omettez le commutateur, VSDBCMD génère un script de déploiement uniquement.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-216">If you specify **/dd-** or omit the switch, VSDBCMD will generate a deployment script only.</span></span>

<span data-ttu-id="fc5ca-217">Si vous utilisez un fichier .deploymanifest, le comportement est beaucoup plus complexe.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-217">If you're using a .deploymanifest file, the behavior is a lot more complicated.</span></span> <span data-ttu-id="fc5ca-218">Il s’agit, car le fichier .deploymanifest contient un nom de propriété **DeployToDatabase** qui détermine également si la base de données est déployée.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-218">This is because the .deploymanifest file contains a property name **DeployToDatabase** that also determines whether the database is deployed.</span></span>


[!code-xml[Main](deploying-database-projects/samples/sample2.xml)]


<span data-ttu-id="fc5ca-219">La valeur de cette propriété est définie en fonction des propriétés du projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-219">The value of this property is set according to the properties of the database project.</span></span> <span data-ttu-id="fc5ca-220">Si vous définissez la **action de déploiement** à **créer un script de déploiement (.sql)**, la valeur sera **False**.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-220">If you set the **Deploy action** to **Create a deployment script (.sql)**, the value will be **False**.</span></span> <span data-ttu-id="fc5ca-221">Si vous définissez la **action de déploiement** à **créer un script de déploiement (.sql) et déployer la base de données**, la valeur sera **True**.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-221">If you set the **Deploy action** to **Create a deployment script (.sql) and deploy to the database**, the value will be **True**.</span></span>

> [!NOTE]
> <span data-ttu-id="fc5ca-222">Ces paramètres sont associés à une plateforme et la configuration de build spécifique.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-222">These settings are associated with a specific build configuration and platform.</span></span> <span data-ttu-id="fc5ca-223">Par exemple, si vous configurez des paramètres pour le **déboguer** configuration, puis publier à l’aide de la **version** configuration, vos paramètres ne seront pas utilisées.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-223">For example, if you configure settings for the **Debug** configuration and then publish using the **Release** configuration, your settings will not be used.</span></span>


![](deploying-database-projects/_static/image3.png)

> [!NOTE]
> <span data-ttu-id="fc5ca-224">Dans ce scénario, le **action de déploiement** doit toujours être définie sur **créer un script de déploiement (.sql)**, car vous ne souhaitez pas Visual Studio 2010 pour déployer votre base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-224">In this scenario, the **Deploy action** should always be set to **Create a deployment script (.sql)**, because you don't want Visual Studio 2010 to deploy your database.</span></span> <span data-ttu-id="fc5ca-225">En d’autres termes, le **DeployToDatabase** propriété doit toujours être **False**.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-225">In other words, the **DeployToDatabase** property should always be **False**.</span></span>


<span data-ttu-id="fc5ca-226">Quand un **DeployToDatabase** propriété est spécifiée, le **/DD** commutateur remplace uniquement la propriété si la valeur de propriété est **false**:</span><span class="sxs-lookup"><span data-stu-id="fc5ca-226">When a **DeployToDatabase** property is specified, the **/dd** switch will only override the property if the property value is **false**:</span></span>

- <span data-ttu-id="fc5ca-227">Si le **DeployToDatabase** propriété est **False**, et que vous spécifiez **/dd+** ou **/DD**, VSDBCMD remplacera le  **DeployToDatabase** propriété et déployer la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-227">If the **DeployToDatabase** property is **False**, and you specify **/dd+** or **/dd**, VSDBCMD will override the **DeployToDatabase** property and deploy the database.</span></span>
- <span data-ttu-id="fc5ca-228">Si le **DeployToDatabase** propriété est **False**, et que vous spécifiez **/dd-** ou omettez le commutateur, VSDBCMD ne déploiera pas de la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-228">If the **DeployToDatabase** property is **False**, and you specify **/dd-** or omit the switch, VSDBCMD will not deploy the database.</span></span>
- <span data-ttu-id="fc5ca-229">Si le **DeployToDatabase** propriété est **True**, VSDBCMD ignore le commutateur et déployer la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-229">If the **DeployToDatabase** property is **True**, VSDBCMD will ignore the switch and deploy the database.</span></span>
- <span data-ttu-id="fc5ca-230">Un script de déploiement est généré dans chaque cas, indépendamment de si vous déployez la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-230">A deployment script is generated in each case, regardless of whether you're deploying the database as well.</span></span>

## <a name="conclusion"></a><span data-ttu-id="fc5ca-231">Conclusion</span><span class="sxs-lookup"><span data-stu-id="fc5ca-231">Conclusion</span></span>

<span data-ttu-id="fc5ca-232">Cette rubrique fourni une vue d’ensemble du processus de génération et de déploiement pour les projets de base de données dans Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-232">This topic provided an overview of the build and deployment process for database projects in Visual Studio 2010.</span></span> <span data-ttu-id="fc5ca-233">Il décrit également comment vous pouvez utiliser VSDBCMD.exe avec MSBuild pour prendre en charge le déploiement de base de données de l’échelle de l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="fc5ca-233">It also described how you can use VSDBCMD.exe with MSBuild to support enterprise-scale database deployment.</span></span>

<span data-ttu-id="fc5ca-234">Pour plus d’informations sur la façon dont cela fonctionne dans la pratique, consultez [personnalisation des déploiements de base de données pour plusieurs environnements](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-234">For more information on how this works in practice, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="further-reading"></a><span data-ttu-id="fc5ca-235">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="fc5ca-235">Further Reading</span></span>

<span data-ttu-id="fc5ca-236">Pour plus d’informations sur la personnalisation des déploiements de base de données en créant un fichier de configuration de déploiement distinct pour chaque environnement, consultez [personnalisation des déploiements de base de données pour plusieurs environnements](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-236">For information on how to customize database deployments by creating a separate deployment configuration file for each environment, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="fc5ca-237">Pour obtenir des conseils sur la façon de configurer les appartenances aux rôles de base de données en exécutant un script de post-déploiement, consultez [déploiement des appartenances de rôle de base de données pour les environnements de Test](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-237">For guidance on how to configure database role memberships by running a post-deployment script, see [Deploying Database Role Memberships to Test Environments](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span></span> <span data-ttu-id="fc5ca-238">Pour obtenir des conseils sur la gestion de certains des défis uniques que l’appartenance des bases de données imposent, consultez [déploiement de bases de données d’appartenance pour les environnements d’entreprise](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span><span class="sxs-lookup"><span data-stu-id="fc5ca-238">For guidance on managing some of the unique challenges that membership databases impose, see [Deploying Membership Databases to Enterprise Environments](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span></span>

<span data-ttu-id="fc5ca-239">Ces rubriques sur MSDN fournissent des conseils plus large et des informations générales sur les projets de base de données de Visual Studio et le processus de déploiement de base de données :</span><span class="sxs-lookup"><span data-stu-id="fc5ca-239">These topics on MSDN provide broader guidance and background information on Visual Studio database projects and the database deployment process:</span></span>

- [<span data-ttu-id="fc5ca-240">Projets de base de données Visual Studio 2010 SQL Server</span><span class="sxs-lookup"><span data-stu-id="fc5ca-240">Visual Studio 2010 SQL Server Database Projects</span></span>](https://msdn.microsoft.com/library/ff678491.aspx)
- [<span data-ttu-id="fc5ca-241">Gestion des modifications de base de données</span><span class="sxs-lookup"><span data-stu-id="fc5ca-241">Managing Database Change</span></span>](https://msdn.microsoft.com/library/aa833404.aspx)
- [<span data-ttu-id="fc5ca-242">Guide pratique pour Préparer une base de données pour le déploiement à partir d’une invite de commandes à l’aide de VSDBCMD. EXE</span><span class="sxs-lookup"><span data-stu-id="fc5ca-242">How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE</span></span>](https://msdn.microsoft.com/library/dd193258.aspx)
- [<span data-ttu-id="fc5ca-243">Une vue d’ensemble de la génération de la base de données et de déploiement</span><span class="sxs-lookup"><span data-stu-id="fc5ca-243">An Overview of Database Build and Deployment</span></span>](https://msdn.microsoft.com/library/aa833165.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="fc5ca-244">[Précédent](deploying-web-packages.md)
> [Suivant](creating-and-running-a-deployment-command-file.md)</span><span class="sxs-lookup"><span data-stu-id="fc5ca-244">[Previous](deploying-web-packages.md)
[Next](creating-and-running-a-deployment-command-file.md)</span></span>
