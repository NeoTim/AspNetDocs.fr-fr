---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
title: Configuration des propriétés de déploiement pour un environnement cible | Microsoft Docs
author: jrjlee
description: Cette rubrique décrit comment configurer les propriétés spécifiques à l’environnement pour déployer l’exemple de solution de gestionnaire de contacts dans un environnement cible spécifique...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: b5b86e03-b8ed-46e6-90fa-e1da88ef34e9
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
msc.type: authoredcontent
ms.openlocfilehash: 9742be7d718384c1b108d5f2c0c43e8e8d4fe8a9
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108671"
---
# <a name="configuring-deployment-properties-for-a-target-environment"></a>Configuration des propriétés de déploiement pour un environnement cible

par [Jason Lee](https://github.com/jrjlee)

[Télécharger PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> Cette rubrique décrit comment configurer les propriétés spécifiques à l’environnement pour déployer l’exemple de solution de gestionnaire de contacts dans un environnement cible spécifique.

Cette rubrique fait partie d’une série de didacticiels basées sur les exigences de déploiement d’entreprise de la société fictive Fabrikam, Inc. Cette série de didacticiels utilise un exemple de solution&#x2014;le [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) solution&#x2014;pour représenter une application web avec un niveau réaliste de complexité, y compris une application ASP.NET MVC 3, une Communication de Windows Foundation (WCF) service et un projet de base de données.

La méthode de déploiement au cœur de ces didacticiels est basée sur l’approche de fichier de projet de fractionnement décrite dans [comprendre le processus de génération](../web-deployment-in-the-enterprise/understanding-the-build-process.md), dans lequel le processus de génération est contrôlé par deux fichiers de projet&#x2014;contenant un seul les instructions qui s’appliquent à chaque environnement de destination et celui qui contient les paramètres de génération et de déploiement spécifiques à l’environnement de génération. Au moment de la génération, le fichier de projet spécifique à l’environnement est fusionné dans le fichier de projet d’indépendant de l’environnement pour former un ensemble complet d’instructions de génération.

## <a name="process-overview"></a>Vue d’ensemble du processus

Le fichier de projet que vous utiliserez pour générer et déployer la solution Gestionnaire de contacts est divisé en deux fichiers physiques :

- Une qui contient universel génère les paramètres et les instructions (le *Publish.proj* fichier).
- Paramètres de build qui contient spécifiques à l’environnement (*Env-Dev.proj*, *Env-Stage.proj*, et ainsi de suite).

Au moment de la génération, le fichier de projet spécifiques à l’environnement approprié est fusionné dans universel *Publish.proj* fichier pour former un ensemble complet d’instructions de génération. Vous pouvez configurer le déploiement dans des environnements de destination spécifique en créant ou en personnalisant les fichiers de projet spécifique à un environnement avec des paramètres qui décrivent votre propre scénario de déploiement.

Un grand nombre de ces valeurs est déterminé par la configuration de votre environnement de destination&#x2014;en particulier, si votre serveur web de cible est configuré pour utiliser le Service de l’Agent de déploiement Web (l’agent distant) ou le Gestionnaire de déploiement Web. Pour plus d’informations sur ces approches et pour obtenir des conseils sur le choix de la bonne approche pour votre propre environnement, consultez [choix de l’approche de droite pour le déploiement Web](choosing-the-right-approach-to-web-deployment.md).

Le [Contact Manager scénario](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md) requiert deux fichiers de projet spécifique à l’environnement :

- Déploiement dans un environnement de test de développeur (*Env-Dev.proj*). L’environnement de test de développement est configuré pour accepter les déploiements à distance à l’aide de l’agent distant, comme décrit dans [scénario : Configuration d’un environnement de Test pour le déploiement Web](scenario-configuring-a-test-environment-for-web-deployment.md). Ce fichier doit fournir l’agent distant, adresse de point de terminaison ainsi que les paramètres spécifiques à l’emplacement tels que les chaînes de connexion et les points de terminaison de service.
- Déploiement dans un environnement intermédiaire (*Env-Stage.proj*). L’environnement intermédiaire est configuré pour accepter les déploiements à distance à l’aide du Gestionnaire de déploiement Web, comme décrit dans [scénario : Configuration d’un environnement de préproduction pour le déploiement Web](scenario-configuring-a-staging-environment-for-web-deployment.md). Ce fichier doit fournir l’adresse de point de terminaison de gestionnaire de déploiement Web ainsi que les paramètres de géolocalisation telles que des chaînes de connexion et de points de terminaison de service.

Il est important de noter que les paramètres configurés dans le fichier de projet spécifique à l’environnement n’affectent pas le contenu du package web lui-même&#x2014;au lieu de cela, ils contrôlent la manière dont le package est déployé et les valeurs de paramètre sont fournies lorsque le package est extraits. Vous importez le package web dans l’environnement de production manuellement, comme décrit dans [scénario : Configuration d’un environnement de Production pour le déploiement Web](scenario-configuring-a-production-environment-for-web-deployment.md) et [installer manuellement des Packages Web](../web-deployment-in-the-enterprise/manually-installing-web-packages.md), de sorte que peu importe quels paramètres vous avez utilisé dans le fichier de projet spécifique à un environnement quand vous avez généré le package. Gestionnaire des Services Internet (IIS) vous demandera des valeurs paramétrables, telles que des chaînes de connexion et les points de terminaison de service, lorsque vous importez le package.

Pour déployer la solution Gestionnaire de contacts sur votre propre environnement cible, vous pouvez personnaliser ce fichier ou utilisez-le comme modèle et créer votre propre fichier.

**Pour configurer les paramètres spécifiques à l’environnement de déploiement pour la solution Gestionnaire de contacts**

1. Ouvrez la solution ContactManager-WCF dans Visual Studio 2010.
2. Dans le **l’Explorateur de solutions** fenêtre, développez le **publier** dossier, développez le **EnvConfig** dossier, puis double-cliquez sur **Env-Dev.proj**.

    ![](configuring-deployment-properties-for-a-target-environment/_static/image1.png)
3. Remplacez les valeurs de propriété dans le *Env-Dev.proj* fichier avec les valeurs correctes pour votre propre environnement de test.

    > [!NOTE]
    > Le tableau qui suit cette procédure fournit plus d’informations sur chacune de ces propriétés.
4. Enregistrez votre travail et fermez le *Env-Dev.proj* fichier.

## <a name="choosing-the-right-deployment-properties"></a>En choisissant les propriétés de déploiement appropriée

Ce tableau décrit l’objectif de chaque propriété dans l’exemple de fichier de projet spécifique à l’environnement, *Env-Dev.proj*et fournit des conseils sur les valeurs que vous devez fournir.

|                                                        Nom de la propriété                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Détails                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              <strong>MSDeployComputerName</strong> le nom de la destination serveur ou le service point de terminaison web.               |                                                                                                                                                                                                                                              Si vous déployez dans le service de l’agent distant sur le serveur web de destination, vous pouvez spécifier le nom de l’ordinateur cible (par exemple, <strong>TESTWEB1</strong> ou <strong>TESTWEB1.fabrikam.net</strong>), ou vous pouvez spécifier l’instance distante point de terminaison de l’agent (par exemple, `http://TESTWEB1/MSDEPLOYAGENTSERVICE`). Le déploiement fonctionne de la même façon dans chaque cas. Si vous déployez dans le Gestionnaire de déploiement Web sur le serveur web de destination, vous devez spécifier le point de terminaison de service et inclure le nom du site Web IIS comme un paramètre de chaîne de requête (par exemple, `https://STAGEWEB1:8172/MSDeploy.axd?site=DemoSite`).                                                                                                                                                                                                                                              |
|         <strong>MSDeployAuth</strong> la méthode de déploiement Web doit utiliser pour s’authentifier auprès de l’ordinateur distant.          |                                                                                                                                                                                                                          Cela doit être défini sur <strong>NTLM</strong> ou <strong>base</strong>. En règle générale, vous allez utiliser <strong>NTLM</strong> si vous déployez vers le service de l’agent distant et <strong>base</strong> si vous déployez dans le Gestionnaire de déploiement Web. Si vous utilisez l’authentification de base, vous devez également spécifier le nom d’utilisateur et le mot de passe que doit emprunter l’identité de l’outil de déploiement Web IIS (Web Deploy) afin d’effectuer le déploiement. Dans cet exemple, ces valeurs sont fournies via le <strong>MSDeployUsername</strong> et <strong>MSDeployPassword</strong> propriétés. Si vous utilisez l’authentification NTLM, vous pouvez omettre ces propriétés ou les laisser vide.                                                                                                                                                                                                                          |
| <strong>MSDeployUsername</strong> si vous utilisez l’authentification de base, Web Deploy utilisera ce compte sur l’ordinateur distant.  |                                                                                                                                                                                                                                                                                                                                                                                                                       Cela doit prendre la forme <em>domaine</em>\** nom d’utilisateur (par exemple, <strong>FABRIKAM\matt</strong>). Cette valeur est utilisée uniquement si vous spécifiez l’authentification de base. Si vous utilisez l’authentification NTLM, la propriété peut être omise. Si une valeur est fournie, il sera ignoré.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <strong>MSDeployPassword</strong> si vous utilisez l’authentification de base, Web Deploy utilisera ce mot de passe sur l’ordinateur distant. |                                                                                                                                                                                                                                                                                                                                                                                                                    Il s’agit du mot de passe pour le compte d’utilisateur que vous avez spécifié dans le <strong>MSDeployUsername</strong> propriété. Cette valeur est utilisée uniquement si vous spécifiez l’authentification de base. Si vous utilisez l’authentification NTLM, la propriété peut être omise. Si une valeur est fournie, il sera ignoré.                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     <strong>ContactManagerIisPath</strong> chemin d’accès IIS sur lequel vous souhaitez déployer l’application MVC de gestionnaire de contacts.     |                                                                                                                                                                                                                                                                                                                                                                        Il doit s’agir du chemin d’accès tel qu’il apparaît dans le Gestionnaire des services Internet, sous la forme [<em>nom du site Web IIS</em>] / [<em>web</em><em>nom de l’application</em>]. N’oubliez pas que le site Web IIS doit exister avant de déployer votre application. Par exemple, si vous avez créé un site Web IIS nommé DemoSite, vous pouvez spécifier le chemin d’accès IIS pour l’application MVC comme DemoSite/ContactManager.                                                                                                                                                                                                                                                                                                                                                                        |
|   <strong>ContactManagerServiceIisPath</strong> chemin d’accès IIS sur lequel vous souhaitez déployer le service WCF de gestionnaire de contacts.    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Par exemple, si vous avez créé un site Web IIS nommé DemoSite, vous pouvez spécifier le chemin d’accès IIS pour le service WCF en tant que <strong>DemoSite/ContactManagerService</strong>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                  <strong>ContactManagerTargetUrl</strong> l’URL à laquelle le service WCF peut être contacté.                   |                                                                                                                                                     Cela prendra la forme [<em>URL racine du site Web IIS</em>] / [<em>nom de l’application service</em>] / [<em>point de terminaison de service</em>]. Par exemple, si vous avez créé un site Web IIS sur le port 85, l’URL prendrait la forme `http://localhost:85/ContactManagerService/ContactService.svc`. N’oubliez pas que l’application MVC et le service WCF sont déployés sur le même serveur. Par conséquent, cette URL est uniquement accessible à partir de l’ordinateur sur lequel il est installé. Pour cette raison, il est préférable d’utiliser localhost ou l’adresse IP, plutôt que le nom d’ordinateur ou un en-tête d’hôte, dans l’URL. Si vous utilisez le nom d’ordinateur ou un en-tête d’hôte, le [contrôle de bouclage](https://go.microsoft.com/?linkid=9805131) fonctionnalité de sécurité dans IIS peut-être bloquer l’URL et retourner un <strong>HTTP 401.1 - non autorisé</strong> erreur.                                                                                                                                                     |
|                  <strong>CmDatabaseConnectionString</strong> la chaîne de connexion pour le serveur de base de données.                  | La chaîne de connexion détermine à la fois les informations d’identification VSDBCMD utilisera pour contacter le serveur de base de données et de créer la base de données et les informations d’identification que le pool d’applications de serveur web utilisera pour contacter le serveur de base de données et interagir avec la base de données. Vous avez essentiellement ici deux possibilités. Vous pouvez spécifier <strong>Integrated Security = true</strong>, auquel cas l’authentification Windows intégrée est utilisée : <strong>Source de données = TESTDB1 ; Integrated Security = true</strong> dans ce cas, la base de données est créé avec les informations d’identification de l’utilisateur qui exécute l’exécutable VSDBCMD, et l’application doit accéder à la base de données à l’aide de l’identité de l’ordinateur serveur web compte. Vous pouvez également spécifier le nom d’utilisateur et le mot de passe d’un compte SQL Server. Dans ce cas, les informations d’identification SQL Server sont utilisées par VSDBCMD pour créer la base de données et par le pool d’applications d’interagir avec la base de données : <strong>Source de données = TESTDB1 ; Id d’utilisateur = ASqlUser ; Mot de passe = Pa$ $w0rd</strong> les procédures de cette rubrique supposent que vous allez utiliser l’authentification Windows intégrée. |
|        <strong>CmTargetDatabase</strong> le nom que vous souhaitez donner à la base de données que vous allez créer sur le serveur de base de données.        |                                                                                                                                                                                                                                                                                                                                                                                                                                                     La valeur que vous fournissez ici est ajoutée à la commande VSDBCMD en tant que paramètre. Il est également utilisé pour générer une chaîne de connexion complète que le pool d’applications sur le serveur web peut utiliser pour interagir avec la base de données.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

Ces exemples montrent comment vous pouvez configurer ces propriétés pour les scénarios de déploiement spécifiques.

### <a name="example-1x2014deployment-to-the-remote-agent-service"></a>Exemple 1&#x2014;déploiement vers le Service Agent distant

Dans cet exemple :

- Que vous déployez sur le service de l’agent distant sur TESTWEB1.
- Vous indiquez Web Deploy pour utiliser l’authentification NTLM. Web Deploy s’exécute en utilisant les informations d’identification que vous avez utilisé pour appeler Microsoft Build Engine (MSBuild).
- Vous utilisez l’authentification intégrée pour déployer le **ContactManager** base de données TESTDB1. La base de données sera déployée à l’aide des informations d’identification que vous avez utilisé pour appeler MSBuild.

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample1.xml)]

### <a name="example-2x2014deployment-to-the-web-deploy-handler-endpoint"></a>Exemple 2&#x2014;Gestionnaire de point de terminaison de déploiement de déploiement sur le Web

Dans cet exemple :

- Que vous déployez sur le point de terminaison du service Gestionnaire de déploiement Web sur STAGEWEB1.
- Vous indiquez Web Deploy utilise l’authentification de base.
- Vous spécifiez que Web Deploy doit emprunter l’identité du compte FABRIKAM\stagingdeployer sur l’ordinateur distant.
- Vous utilisez l’authentification SQL Server pour déployer le **ContactManager** STAGEDB1 base de données.

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample2.xml)]

## <a name="conclusion"></a>Conclusion

À ce stade, vos fichiers projet sont entièrement configurés pour créer et déployer la solution Gestionnaire de contacts dans un ou plusieurs environnements de destination.

Pour utiliser ces fichiers de projet en tant que partie d’un processus de déploiement pas à pas, reproductibles, vous devez exécuter le *Publish.proj* fichier à l’aide de MSBuild et passer à l’emplacement du fichier de projet spécifique à un environnement en tant que paramètre. Pour cela, de différentes manières :

- Pour une vue d’ensemble de MSBuild et une introduction aux fichiers de projet personnalisé, consultez [présentation du fichier projet](../web-deployment-in-the-enterprise/understanding-the-project-file.md).
- Pour plus d’informations sur comment formuler une commande MSBuild qui exécute vos fichiers de projet personnalisé, consultez [déploiement des Packages Web](../web-deployment-in-the-enterprise/deploying-web-packages.md).
- Pour plus d’informations sur comment incorporer vos commandes MSBuild dans un fichier de commandes pour les déploiements étape unique, reproductibles, consultez [création et exécution d’un fichier de commandes de déploiement](../web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file.md).
- Pour plus d’informations sur la façon d’exécuter vos fichiers de projet personnalisés à partir de Team Build, consultez [création d’une définition de Build que le déploiement prend en charge](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md).

> [!div class="step-by-step"]
> [Précédent](creating-a-server-farm-with-the-web-farm-framework.md)
