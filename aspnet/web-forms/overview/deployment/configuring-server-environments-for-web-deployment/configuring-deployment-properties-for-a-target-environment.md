---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
title: Configuration des propriétés de déploiement pour un environnement cible | Microsoft Docs
author: jrjlee
description: Cette rubrique explique comment configurer des propriétés spécifiques à l’environnement pour déployer l’exemple de solution de gestionnaire de contacts dans un environnement cible spécifique...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: b5b86e03-b8ed-46e6-90fa-e1da88ef34e9
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
msc.type: authoredcontent
ms.openlocfilehash: 9742be7d718384c1b108d5f2c0c43e8e8d4fe8a9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78636443"
---
# <a name="configuring-deployment-properties-for-a-target-environment"></a>Configuration des propriétés de déploiement pour un environnement cible

par [Jason Lee](https://github.com/jrjlee)

[Télécharger PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> Cette rubrique explique comment configurer des propriétés spécifiques à l’environnement pour déployer l’exemple de solution de gestionnaire de contacts dans un environnement cible spécifique.

Cette rubrique fait partie d’une série de didacticiels basés sur les exigences de déploiement en entreprise d’une société fictive nommée Fabrikam, Inc. Cette série de didacticiels utilise un&#x2014;exemple de solution de&#x2014;gestion des [contacts](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) pour représenter une application Web avec un niveau de complexité réaliste, y compris une application ASP.NET MVC 3, un service Windows Communication Foundation (WCF) et un projet de base de données.

La méthode de déploiement au cœur de ces didacticiels est basée sur l’approche de fichier de projet fractionné décrite dans [fonctionnement du processus de génération](../web-deployment-in-the-enterprise/understanding-the-build-process.md), dans lequel le processus de génération est&#x2014;contrôlé par deux fichiers projet contenant des instructions de génération qui s’appliquent à chaque environnement de destination, et un qui contient des paramètres de génération et de déploiement spécifiques à l’environnement. Au moment de la génération, le fichier projet spécifique à l’environnement est fusionné dans le fichier projet indépendant de l’environnement pour former un ensemble complet d’instructions de génération.

## <a name="process-overview"></a>Vue d’ensemble du processus

Le fichier projet que vous allez utiliser pour créer et déployer la solution du gestionnaire de contacts est divisé en deux fichiers physiques :

- Un qui contient des instructions et des paramètres de build universels (le fichier *Publish. proj* ).
- Un qui contient des paramètres de génération spécifiques à l’environnement (*env-dev. proj*, *env-stage. proj*, etc.).

Au moment de la génération, le fichier projet propre à l’environnement approprié est fusionné dans le fichier Universal *Publish. proj* pour former un ensemble complet d’instructions de génération. Vous pouvez configurer le déploiement sur des environnements de destination spécifiques en créant ou en personnalisant des fichiers projet spécifiques à l’environnement avec des paramètres qui décrivent votre propre scénario de déploiement.

Un grand nombre de ces valeurs sont déterminées par la configuration&#x2014;de votre environnement de destination en particulier, si votre serveur Web cible est configuré pour utiliser le Service de Deployment agent Web (l’agent distant) ou le gestionnaire de Web Deploy. Pour plus d’informations sur ces approches et pour obtenir des conseils sur le choix de l’approche adaptée à votre environnement, consultez [choix de l’approche appropriée pour le déploiement Web](choosing-the-right-approach-to-web-deployment.md).

Le [scénario du gestionnaire de contacts](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md) requiert deux fichiers projet spécifiques à l’environnement :

- Déploiement dans un environnement de test de développeur (*env-dev. proj*). L’environnement de test des développeurs est configuré pour accepter les déploiements à distance à l’aide de l’agent distant, comme décrit dans [scénario : configuration d’un environnement de test pour le déploiement Web](scenario-configuring-a-test-environment-for-web-deployment.md). Ce fichier doit fournir l’adresse du point de terminaison de l’agent distant ainsi que des paramètres spécifiques à l’emplacement, tels que les chaînes de connexion et les points de terminaison de service.
- Déploiement dans un environnement intermédiaire (*env-stage. proj*). L’environnement intermédiaire est configuré pour accepter les déploiements distants à l’aide du gestionnaire de Web Deploy, comme décrit dans [scénario : configuration d’un environnement intermédiaire pour le déploiement Web](scenario-configuring-a-staging-environment-for-web-deployment.md). Ce fichier doit fournir l’adresse du point de terminaison du gestionnaire Web Deploy ainsi que des paramètres spécifiques à l’emplacement, tels que les chaînes de connexion et les points de terminaison de service.

Il est important de noter que les paramètres que vous configurez dans le fichier projet spécifique à l’environnement n’affectent pas le contenu&#x2014;du package Web lui-même, mais ils contrôlent la façon dont le package est déployé et les valeurs de paramètre fournies lors de l’extraction du package. Vous importez manuellement le package Web dans l’environnement de production, comme décrit dans [scénario : configuration d’un environnement de production pour le déploiement Web](scenario-configuring-a-production-environment-for-web-deployment.md) et [installation manuelle de packages Web](../web-deployment-in-the-enterprise/manually-installing-web-packages.md), ce qui importe peu les paramètres que vous avez utilisés dans le fichier projet spécifique à l’environnement lorsque vous avez généré le package. Le gestionnaire de Internet Information Services (IIS) vous invite à entrer des valeurs paramétrables, telles que les chaînes de connexion et les points de terminaison de service, lorsque vous importez le package.

Pour déployer la solution gestionnaire de contacts dans votre propre environnement cible, vous pouvez personnaliser ce fichier ou l’utiliser comme modèle et créer votre propre fichier.

**Pour configurer des paramètres de déploiement spécifiques à l’environnement pour la solution du gestionnaire de contacts**

1. Ouvrez la solution ContactManager-WCF dans Visual Studio 2010.
2. Dans la fenêtre **Explorateur de solutions** , développez le dossier **Publish** , développez le dossier **EnvConfig** , puis double-cliquez sur **env-dev. proj**.

    ![](configuring-deployment-properties-for-a-target-environment/_static/image1.png)
3. Remplacez les valeurs de propriété dans le fichier *env-dev. proj* par les valeurs correctes pour votre propre environnement de test.

    > [!NOTE]
    > Le tableau qui suit cette procédure fournit plus d’informations sur chacune de ces propriétés.
4. Enregistrez votre travail, puis fermez le fichier *env-dev. proj* .

## <a name="choosing-the-right-deployment-properties"></a>Choix des propriétés de déploiement appropriées

Ce tableau décrit l’objectif de chaque propriété dans l’exemple de fichier projet spécifique à l’environnement, *env-dev. proj*, et fournit des conseils sur les valeurs que vous devez fournir.

|                                                        Nom de la propriété                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Détails                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              <strong>MSDeployComputerName</strong> Nom du serveur Web de destination ou du point de terminaison du service.               |                                                                                                                                                                                                                                              Si vous effectuez un déploiement sur le service de l’agent distant sur le serveur Web de destination, vous pouvez spécifier le nom de l’ordinateur cible (par exemple, <strong>TESTWEB1</strong> ou <strong>TESTWEB1.fabrikam.net</strong>), ou vous pouvez spécifier le point de terminaison de l’agent distant (par exemple, `http://TESTWEB1/MSDEPLOYAGENTSERVICE`). Le déploiement fonctionne de la même façon dans chaque cas. Si vous effectuez le déploiement sur le gestionnaire de Web Deploy sur le serveur Web de destination, vous devez spécifier le point de terminaison de service et inclure le nom du site Web IIS en tant que paramètre de chaîne de requête (par exemple, `https://STAGEWEB1:8172/MSDeploy.axd?site=DemoSite`).                                                                                                                                                                                                                                              |
|         <strong>MSDeployAuth</strong> Méthode que Web Deploy doit utiliser pour s’authentifier auprès de l’ordinateur distant.          |                                                                                                                                                                                                                          Cette valeur doit être définie sur <strong>NTLM</strong> ou de <strong>base</strong>. En règle générale, vous utiliserez <strong>NTLM</strong> si vous effectuez un déploiement sur le service de l’agent distant et de <strong>base</strong> si vous déployez sur le gestionnaire de Web Deploy. Si vous utilisez l’authentification de base, vous devez également spécifier le nom d’utilisateur et le mot de passe dont l’outil de déploiement Web IIS (Web Deploy) doit emprunter l’identité afin d’effectuer le déploiement. Dans cet exemple, ces valeurs sont fournies par le biais des propriétés <strong>MSDeployUsername</strong> et <strong>MSDeployPassword</strong> . Si vous utilisez l’authentification NTLM, vous pouvez omettre ces propriétés ou les laisser vides.                                                                                                                                                                                                                          |
| <strong>MSDeployUsername</strong> Si vous utilisez l’authentification de base, Web Deploy utilisera ce compte sur l’ordinateur distant.  |                                                                                                                                                                                                                                                                                                                                                                                                                       Elle doit prendre la forme <em>domaine</em>\*nom d’utilisateur * (par exemple, <strong>FABRIKAM\matt</strong>). Cette valeur est utilisée uniquement si vous spécifiez l’authentification de base. Si vous utilisez l’authentification NTLM, la propriété peut être omise. Si une valeur est fournie, elle sera ignorée.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <strong>MSDeployPassword</strong> Si vous utilisez l’authentification de base, Web Deploy utilise ce mot de passe sur l’ordinateur distant. |                                                                                                                                                                                                                                                                                                                                                                                                                    Il s’agit du mot de passe du compte d’utilisateur que vous avez spécifié dans la propriété <strong>MSDeployUsername</strong> . Cette valeur est utilisée uniquement si vous spécifiez l’authentification de base. Si vous utilisez l’authentification NTLM, la propriété peut être omise. Si une valeur est fournie, elle sera ignorée.                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     <strong>ContactManagerIisPath</strong> Le chemin d’accès IIS sur lequel vous souhaitez déployer l’application MVC du gestionnaire de contacts.     |                                                                                                                                                                                                                                                                                                                                                                        Il doit s’agir du chemin d’accès tel qu’il apparaît dans le gestionnaire des services Internet, sous la forme [<em>nom du site Web IIS</em>]/[nom de l'<em>application</em><em>Web</em>]. N’oubliez pas que le site Web IIS doit exister avant de déployer votre application. Par exemple, si vous avez créé un site Web IIS nommé DemoSite, vous pouvez spécifier le chemin d’accès IIS pour l’application MVC en tant que DemoSite/ContactManager.                                                                                                                                                                                                                                                                                                                                                                        |
|   <strong>ContactManagerServiceIisPath</strong> Le chemin d’accès IIS sur lequel vous voulez déployer le service WCF du gestionnaire de contacts.    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Par exemple, si vous avez créé un site Web IIS nommé DemoSite, vous pouvez spécifier le chemin d’accès IIS pour le service WCF en tant que <strong>DemoSite/ContactManagerService</strong>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                  <strong>ContactManagerTargetUrl</strong> URL à laquelle le service WCF peut être atteint.                   |                                                                                                                                                     Cela prend la forme [<em>URL racine du site Web IIS</em>]/[nom de l'<em>application de service</em>]/[point de<em>terminaison de service</em>]. Par exemple, si vous avez créé un site Web IIS sur le port 85, l’URL prend la forme `http://localhost:85/ContactManagerService/ContactService.svc`. N’oubliez pas que l’application MVC et le service WCF sont déployés sur le même serveur. Par conséquent, cette URL n’est jamais accessible à partir de l’ordinateur sur lequel elle est installée. Pour cette raison, il est préférable d’utiliser localhost ou l’adresse IP, plutôt que le nom de l’ordinateur ou un en-tête d’hôte, dans l’URL. Si vous utilisez le nom de l’ordinateur ou un en-tête d’hôte, la fonctionnalité de sécurité [vérification de bouclage](https://go.microsoft.com/?linkid=9805131) dans IIS peut bloquer l’URL et renvoyer une erreur <strong>http 401,1 non autorisée</strong> .                                                                                                                                                     |
|                  <strong>CmDatabaseConnectionString</strong> Chaîne de connexion pour le serveur de base de données.                  | La chaîne de connexion détermine les informations d’identification que VSDBCMD utilise pour contacter le serveur de base de données et créer la base de données, ainsi que les informations d’identification que le pool d’applications de serveur Web utilisera pour contacter le serveur de base de données et interagir avec la base de données. Pour l’essentiel, vous avez deux possibilités. Vous pouvez spécifier <strong>Integrated Security = True</strong>, auquel cas l’authentification Windows intégrée est utilisée : <strong>Data source = TESTDB1 ; Integrated Security = True</strong> dans ce cas, la base de données est créée à l’aide des informations d’identification de l’utilisateur qui exécute l’exécutable VSDBCMD, et l’application accède à la base de données à l’aide de l’identité du compte d’ordinateur du serveur Web. Vous pouvez également spécifier le nom d’utilisateur et le mot de passe d’un compte SQL Server. Dans ce cas, les informations d’identification de SQL Server sont utilisées à la fois par VSDBCMD pour créer la base de données et par le pool d’applications pour interagir avec la base de données : <strong>Data source = TESTDB1 ; ID d’utilisateur = ASqlUser ; Password = PA $ $w 0rd</strong> les procédures pas à pas de cette rubrique partent du principe que vous allez utiliser l’authentification Windows intégrée. |
|        <strong>CmTargetDatabase</strong> Nom que vous voulez attribuer à la base de données que vous allez créer sur le serveur de base de données.        |                                                                                                                                                                                                                                                                                                                                                                                                                                                     La valeur que vous fournissez ici est ajoutée à la commande VSDBCMD en tant que paramètre. Il est également utilisé pour générer une chaîne de connexion complète que le pool d’applications sur le serveur Web peut utiliser pour interagir avec la base de données.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

Ces exemples montrent comment vous pouvez configurer ces propriétés pour des scénarios de déploiement spécifiques.

### <a name="example-1x2014deployment-to-the-remote-agent-service"></a>Exemple 1&#x2014;déploiement sur le service de l’agent distant

Dans cet exemple :

- Vous effectuez le déploiement sur le service de l’agent distant sur TESTWEB1.
- Vous indiquez à Web Deploy d’utiliser l’authentification NTLM. Web Deploy s’exécutera à l’aide des informations d’identification que vous avez utilisées pour appeler le Microsoft Build Engine (MSBuild).
- Vous utilisez l’authentification intégrée pour déployer la base de données **ContactManager** sur TESTDB1. La base de données sera déployée à l’aide des informations d’identification que vous avez utilisées pour appeler MSBuild.

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample1.xml)]

### <a name="example-2x2014deployment-to-the-web-deploy-handler-endpoint"></a>Exemple 2&#x2014;déploiement sur le point de terminaison du gestionnaire de Web Deploy

Dans cet exemple :

- Vous effectuez le déploiement sur le point de terminaison du service du gestionnaire de Web Deploy sur STAGEWEB1.
- Vous indiquez à Web Deploy d’utiliser l’authentification de base.
- Vous spécifiez que Web Deploy doit emprunter l’identité du compte FABRIKAM\stagingdeployer sur l’ordinateur distant.
- Vous utilisez l’authentification SQL Server pour déployer la base de données **ContactManager** sur STAGEDB1.

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample2.xml)]

## <a name="conclusion"></a>Conclusion

À ce stade, les fichiers de votre projet sont entièrement configurés pour générer et déployer la solution du gestionnaire de contacts dans un ou plusieurs environnements de destination.

Pour utiliser ces fichiers projet dans le cadre d’un processus de déploiement à une seule étape, renouvelable, vous devez exécuter le fichier *Publish. proj* à l’aide de MSBuild et passer l’emplacement du fichier projet spécifique à l’environnement en tant que paramètre. Pour ce faire, vous pouvez procéder de différentes manières :

- Pour obtenir une vue d’ensemble de MSBuild et une introduction aux fichiers projet personnalisés, consultez [Présentation du fichier projet](../web-deployment-in-the-enterprise/understanding-the-project-file.md).
- Pour plus d’informations sur la façon de formuler une commande MSBuild qui exécute vos fichiers projet personnalisés, consultez [déploiement de packages Web](../web-deployment-in-the-enterprise/deploying-web-packages.md).
- Pour plus d’informations sur l’incorporation de vos commandes MSBuild dans un fichier de commandes pour les déploiements à une seule étape et reproductibles, consultez [création et exécution d’un fichier de commandes de déploiement](../web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file.md).
- Pour plus d’informations sur l’exécution de vos fichiers projet personnalisés à partir de Team Build, consultez [création d’une définition de build qui prend en charge le déploiement](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md).

> [!div class="step-by-step"]
> [Précédent](creating-a-server-farm-with-the-web-farm-framework.md)
