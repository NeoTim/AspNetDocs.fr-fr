---
uid: web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
title: Création d’une définition de build qui prend en charge le déploiement | Microsoft Docs
author: jrjlee
description: Si vous souhaitez exécuter tout type de build dans Team Foundation Server (TFS) 2010, vous devez créer une définition de build dans votre projet d’équipe. Cette rubrique des...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: fe47a018-f6d0-4979-80e7-5b1fa75a5865
msc.legacyurl: /web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
msc.type: authoredcontent
ms.openlocfilehash: e11c91a824446572aaf0b3bc6954b9b8ffb4eaff
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78603998"
---
# <a name="creating-a-build-definition-that-supports-deployment"></a><span data-ttu-id="b8535-104">Création d’une définition de build qui prend en charge le déploiement</span><span class="sxs-lookup"><span data-stu-id="b8535-104">Creating a Build Definition That Supports Deployment</span></span>

<span data-ttu-id="b8535-105">par [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="b8535-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="b8535-106">Télécharger PDF</span><span class="sxs-lookup"><span data-stu-id="b8535-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="b8535-107">Si vous souhaitez exécuter tout type de build dans Team Foundation Server (TFS) 2010, vous devez créer une définition de build dans votre projet d’équipe.</span><span class="sxs-lookup"><span data-stu-id="b8535-107">If you want to perform any kind of build in Team Foundation Server (TFS) 2010, you need to create a build definition within your team project.</span></span> <span data-ttu-id="b8535-108">Cette rubrique décrit comment créer une nouvelle définition de build dans TFS et comment contrôler le déploiement Web dans le cadre du processus de génération dans Team Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-108">This topic describes how to create a new build definition in TFS and how to control web deployment as part of the build process in Team Build.</span></span>

<span data-ttu-id="b8535-109">Cette rubrique fait partie d’une série de didacticiels basés sur les exigences de déploiement en entreprise d’une société fictive nommée Fabrikam, Inc. Cette série de didacticiels utilise un&#x2014;exemple de solution de [gestion des contacts](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;pour représenter une application Web avec un niveau de complexité réaliste, y compris une application ASP.NET MVC 3, un service Windows Communication Foundation (WCF) et un projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="b8535-109">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="b8535-110">La méthode de déploiement au cœur de ces didacticiels est basée sur l’approche de fichier de projet fractionné décrite dans [fonctionnement du fichier projet](../web-deployment-in-the-enterprise/understanding-the-project-file.md), dans lequel le processus de génération et de déploiement est&#x2014;contrôlé par deux fichiers projet qui contiennent des instructions de génération qui s’appliquent à chaque environnement de destination et un qui contient des paramètres de génération et de déploiement spécifiques à l’environnement.</span><span class="sxs-lookup"><span data-stu-id="b8535-110">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build and deployment process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="b8535-111">Au moment de la génération, le fichier projet spécifique à l’environnement est fusionné dans le fichier projet indépendant de l’environnement pour former un ensemble complet d’instructions de génération.</span><span class="sxs-lookup"><span data-stu-id="b8535-111">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="b8535-112">Vue d’ensemble des tâches</span><span class="sxs-lookup"><span data-stu-id="b8535-112">Task Overview</span></span>

<span data-ttu-id="b8535-113">Une définition de build est le mécanisme qui contrôle la manière et le moment où les builds se produisent pour les projets d’équipe dans TFS.</span><span class="sxs-lookup"><span data-stu-id="b8535-113">A build definition is the mechanism that controls how and when builds occur for team projects in TFS.</span></span> <span data-ttu-id="b8535-114">Chaque définition de build spécifie :</span><span class="sxs-lookup"><span data-stu-id="b8535-114">Each build definition specifies:</span></span>

- <span data-ttu-id="b8535-115">Les éléments que vous souhaitez générer, comme les fichiers solution Visual Studio ou les fichiers projet Microsoft Build Engine (MSBuild) personnalisés.</span><span class="sxs-lookup"><span data-stu-id="b8535-115">The things you want to build, like Visual Studio solution files or custom Microsoft Build Engine (MSBuild) project files.</span></span>
- <span data-ttu-id="b8535-116">Critères qui déterminent à quel moment une génération doit avoir lieu, comme les déclencheurs manuels, l’intégration continue (CI) ou les archivages contrôlés.</span><span class="sxs-lookup"><span data-stu-id="b8535-116">The criteria that determine when a build should take place, like manual triggers, continuous integration (CI), or gated check-ins.</span></span>
- <span data-ttu-id="b8535-117">Emplacement auquel Team Build doit envoyer les sorties de génération, y compris les artefacts de déploiement tels que les packages Web et les scripts de base de données.</span><span class="sxs-lookup"><span data-stu-id="b8535-117">The location to which Team Build should send build outputs, including deployment artifacts like web packages and database scripts.</span></span>
- <span data-ttu-id="b8535-118">Durée de conservation de chaque Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-118">The amount of time that each build should be retained.</span></span>
- <span data-ttu-id="b8535-119">Divers autres paramètres du processus de génération.</span><span class="sxs-lookup"><span data-stu-id="b8535-119">Various other parameters of the build process.</span></span>

> [!NOTE]
> <span data-ttu-id="b8535-120">Pour plus d’informations sur les définitions de build, consultez [définir votre processus de génération](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="b8535-120">For more information on build definitions, see [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span>

<span data-ttu-id="b8535-121">Cette rubrique vous montre comment créer une définition de build qui utilise CI, afin qu’une build soit déclenchée quand un développeur Archive un nouveau contenu.</span><span class="sxs-lookup"><span data-stu-id="b8535-121">This topic will show you how to create a build definition that uses CI, so that a build is triggered when a developer checks in new content.</span></span> <span data-ttu-id="b8535-122">Si la génération est réussie, le service de build exécute un fichier projet personnalisé pour déployer la solution dans un environnement de test.</span><span class="sxs-lookup"><span data-stu-id="b8535-122">If the build succeeds, the build service runs a custom project file to deploy the solution to a test environment.</span></span>

<span data-ttu-id="b8535-123">Lorsque vous déclenchez une build, ces actions doivent se produire :</span><span class="sxs-lookup"><span data-stu-id="b8535-123">When you trigger a build, these actions need to happen:</span></span>

- <span data-ttu-id="b8535-124">Tout d’abord, Team Build doit générer la solution.</span><span class="sxs-lookup"><span data-stu-id="b8535-124">First, Team Build should build the solution.</span></span> <span data-ttu-id="b8535-125">Dans le cadre de ce processus, Team Build appellera le pipeline de publication Web pour générer des packages de déploiement Web pour chacun des projets d’application Web de la solution.</span><span class="sxs-lookup"><span data-stu-id="b8535-125">As part of this process, Team Build will invoke the Web Publishing Pipeline (WPP) to generate web deployment packages for each of the web application projects in the solution.</span></span> <span data-ttu-id="b8535-126">Team Build exécute également tous les tests unitaires associés à la solution.</span><span class="sxs-lookup"><span data-stu-id="b8535-126">Team Build will also run any unit tests associated with the solution.</span></span>
- <span data-ttu-id="b8535-127">En cas d’échec de la génération de la solution, Team Build ne doit effectuer aucune action supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="b8535-127">If the solution build fails, Team Build should take no further action.</span></span> <span data-ttu-id="b8535-128">Les échecs des tests unitaires doivent être traités comme un échec de Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-128">Unit test failures should be treated as a build failure.</span></span>
- <span data-ttu-id="b8535-129">Si la génération de solution est réussie, Team Build doit exécuter le fichier projet personnalisé qui contrôle le déploiement de la solution.</span><span class="sxs-lookup"><span data-stu-id="b8535-129">If the solution build succeeds, Team Build should run the custom project file that controls the deployment of the solution.</span></span> <span data-ttu-id="b8535-130">Dans le cadre de ce processus, Team Build appellera l’outil de déploiement Web (Web Deploy) Internet Information Services (IIS) pour installer les applications Web packagées sur les serveurs Web de destination, et il appellera l’utilitaire VSDBCMD. exe pour exécuter la création de la base de données. scripts sur les serveurs de base de données de destination.</span><span class="sxs-lookup"><span data-stu-id="b8535-130">As part of this process, Team Build will invoke the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to install the packaged web applications on the destination web servers, and it will invoke the VSDBCMD.exe utility to run database creation scripts on the destination database servers.</span></span>

<span data-ttu-id="b8535-131">Cela illustre le processus :</span><span class="sxs-lookup"><span data-stu-id="b8535-131">This illustrates the process:</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image1.png)

<span data-ttu-id="b8535-132">L’exemple de solution du [Gestionnaire de contacts](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) comprend un fichier projet MSBuild personnalisé, *Publish. proj*, que vous pouvez exécuter à partir de MSBuild ou Team Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-132">The [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution includes a custom MSBuild project file, *Publish.proj*, that you can run from MSBuild or Team Build.</span></span> <span data-ttu-id="b8535-133">Comme décrit dans [la rubrique fonctionnement du processus de génération](../web-deployment-in-the-enterprise/understanding-the-build-process.md), ce fichier projet définit la logique qui déploie vos packages et bases de données Web dans un environnement cible.</span><span class="sxs-lookup"><span data-stu-id="b8535-133">As described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), this project file defines the logic that deploys your web packages and databases to a target environment.</span></span> <span data-ttu-id="b8535-134">Le fichier comprend une logique qui omet le processus de génération et d’empaquetage s’il s’exécute dans Team Build, en laissant uniquement les tâches de déploiement à exécuter.</span><span class="sxs-lookup"><span data-stu-id="b8535-134">The file includes logic that omits the building and packaging process if it's running in Team Build, leaving just the deployment tasks to run.</span></span> <span data-ttu-id="b8535-135">Cela est dû au fait que lorsque vous automatisez le déploiement de cette manière, vous souhaiterez généralement vous assurer que la solution se génère correctement et passe tous les tests unitaires avant le début du processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="b8535-135">This is because when you automate deployment in this way, you'll typically want to ensure that the solution builds successfully and passes any unit tests before the deployment process commences.</span></span>

<span data-ttu-id="b8535-136">La section suivante explique comment implémenter ce processus en créant une nouvelle définition de Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-136">The next section explains how to implement this process by creating a new build definition.</span></span>

> [!NOTE]
> <span data-ttu-id="b8535-137">Cette procédure&#x2014;dans laquelle un processus automatisé unique génère, teste et déploie une solution&#x2014;est susceptible d’être le plus adapté au déploiement dans des environnements de test.</span><span class="sxs-lookup"><span data-stu-id="b8535-137">This procedure&#x2014;in which a single automated process builds, tests, and deploys a solution&#x2014;is likely to be most suited to deployment to test environments.</span></span> <span data-ttu-id="b8535-138">Pour les environnements intermédiaires et de production, il est beaucoup plus probable de vouloir déployer du contenu à partir d’une build précédente que vous avez déjà vérifiée et validée dans un environnement de test.</span><span class="sxs-lookup"><span data-stu-id="b8535-138">For staging and production environments you're a lot more likely to want to deploy content from a previous build that you've already verified and validated in a test environment.</span></span> <span data-ttu-id="b8535-139">Cette approche est décrite dans la rubrique suivante, [déploiement d’une build spécifique](deploying-a-specific-build.md).</span><span class="sxs-lookup"><span data-stu-id="b8535-139">This approach is described in the next topic, [Deploying a Specific Build](deploying-a-specific-build.md).</span></span>

### <a name="who-performs-this-procedure"></a><span data-ttu-id="b8535-140">Qui effectue cette procédure ?</span><span class="sxs-lookup"><span data-stu-id="b8535-140">Who Performs This Procedure?</span></span>

<span data-ttu-id="b8535-141">En règle générale, un administrateur TFS effectue cette procédure.</span><span class="sxs-lookup"><span data-stu-id="b8535-141">Typically, a TFS administrator performs this procedure.</span></span> <span data-ttu-id="b8535-142">Dans certains cas, un responsable de l’équipe de développement peut assumer la responsabilité de la collection de projets d’équipe dans TFS.</span><span class="sxs-lookup"><span data-stu-id="b8535-142">In some cases, a developer team leader may take responsibility for the team project collection in TFS.</span></span> <span data-ttu-id="b8535-143">Pour créer une nouvelle définition de build, vous devez être membre du groupe administrateurs de build de la **collection de projets** pour la collection de projets d’équipe qui contient votre solution.</span><span class="sxs-lookup"><span data-stu-id="b8535-143">In order to create a new build definition, you need to be a member of the **Project Collection Build Administrators** group for the team project collection that contains your solution.</span></span>

## <a name="create-a-build-definition-for-ci-and-deployment"></a><span data-ttu-id="b8535-144">Créer une définition de build pour l’intégration continue et le déploiement</span><span class="sxs-lookup"><span data-stu-id="b8535-144">Create a Build Definition for CI and Deployment</span></span>

<span data-ttu-id="b8535-145">La procédure suivante décrit comment créer une définition de build qui est déclenchée par CI.</span><span class="sxs-lookup"><span data-stu-id="b8535-145">The next procedure describes how to create a build definition that CI triggers.</span></span> <span data-ttu-id="b8535-146">Si la génération est réussie, la solution est déployée à l’aide de la logique dans un fichier projet MSBuild personnalisé.</span><span class="sxs-lookup"><span data-stu-id="b8535-146">If the build succeeds, the solution is deployed using the logic in a custom MSBuild project file.</span></span>

<span data-ttu-id="b8535-147">**Pour créer une définition de build pour l’intégration continue et le déploiement**</span><span class="sxs-lookup"><span data-stu-id="b8535-147">**To create a build definition for CI and deployment**</span></span>

1. <span data-ttu-id="b8535-148">Dans Visual Studio 2010, dans la fenêtre **Team Explorer** , développez le nœud de votre projet d’équipe, cliquez avec le bouton droit sur **Builds**, puis cliquez sur **nouvelle définition de build**.</span><span class="sxs-lookup"><span data-stu-id="b8535-148">In Visual Studio 2010, in the **Team Explorer** window, expand your team project node, right-click **Builds**, and then click **New Build Definition**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image2.png)
2. <span data-ttu-id="b8535-149">Sous l’onglet **général** , attribuez un nom à la définition de build (par exemple, **DeployToTest**) et une description facultative.</span><span class="sxs-lookup"><span data-stu-id="b8535-149">On the **General** tab, give the build definition a name (for example, **DeployToTest**) and an optional description.</span></span>
3. <span data-ttu-id="b8535-150">Sous l’onglet **déclencheur** , sélectionnez les critères sur lesquels vous souhaitez déclencher une nouvelle Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-150">On the **Trigger** tab, select the criteria on which you want to trigger a new build.</span></span> <span data-ttu-id="b8535-151">Par exemple, si vous souhaitez générer la solution et le déployer dans l’environnement de test chaque fois qu’un développeur Archive un nouveau code, sélectionnez **intégration continue**.</span><span class="sxs-lookup"><span data-stu-id="b8535-151">For example, if you want to build the solution and deploy to the test environment every time a developer checks in new code, select **Continuous Integration**.</span></span>
4. <span data-ttu-id="b8535-152">Sous l’onglet **valeurs par défaut des builds** , dans la zone **copier la sortie de la génération dans le dossier de dépôt suivant** , tapez le chemin d’accès UNC (Universal Naming Convention) de votre dossier de dépôt (par exemple, **\\TFSBUILD\Drops**).</span><span class="sxs-lookup"><span data-stu-id="b8535-152">On the **Build Defaults** tab, in the **Copy build output to the following drop folder** box, type the Universal Naming Convention (UNC) path of your drop folder (for example, **\\TFSBUILD\Drops**).</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image3.png)

    > [!NOTE]
    > <span data-ttu-id="b8535-153">Cet emplacement de dépôt stocke plusieurs builds, selon la stratégie de rétention que vous configurez.</span><span class="sxs-lookup"><span data-stu-id="b8535-153">This drop location stores several builds, depending on the retention policy you configure.</span></span> <span data-ttu-id="b8535-154">Lorsque vous souhaitez publier des artefacts de déploiement à partir d’une build spécifique dans un environnement intermédiaire ou de production, c’est là que vous les trouvez.</span><span class="sxs-lookup"><span data-stu-id="b8535-154">When you want to publish deployment artifacts from a specific build to a staging or production environment, this is where you'll find them.</span></span>
5. <span data-ttu-id="b8535-155">Sous l’onglet **processus** , dans la liste déroulante **fichier de processus de génération** , laissez le fichier **DefaultTemplate. Xaml** sélectionné.</span><span class="sxs-lookup"><span data-stu-id="b8535-155">On the **Process** tab, in the **Build process file** dropdown list, leave **DefaultTemplate.xaml** selected.</span></span> <span data-ttu-id="b8535-156">Il s’agit de l’un des modèles de processus de génération par défaut qui sont ajoutés à tous les nouveaux projets d’équipe.</span><span class="sxs-lookup"><span data-stu-id="b8535-156">This is one of the default build process templates that get added to all new team projects.</span></span>
6. <span data-ttu-id="b8535-157">Dans le tableau **paramètres du processus de génération** , cliquez sur la ligne **éléments à générer** , puis cliquez sur le bouton de **sélection** .</span><span class="sxs-lookup"><span data-stu-id="b8535-157">In the **Build process parameters** table, click in the **Items to Build** row, and then click the **ellipsis** button.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image4.png)
7. <span data-ttu-id="b8535-158">Dans la boîte de dialogue **éléments à générer** , cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="b8535-158">In the **Items to Build** dialog box, click **Add**.</span></span>
8. <span data-ttu-id="b8535-159">Accédez à l’emplacement de votre fichier de solution, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b8535-159">Browse to the location of your solution file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image5.png)
9. <span data-ttu-id="b8535-160">Dans la boîte de dialogue **éléments à générer** , cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="b8535-160">In the **Items to Build** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="b8535-161">Dans la liste déroulante **éléments de type** , sélectionnez **fichiers projet MSBuild**.</span><span class="sxs-lookup"><span data-stu-id="b8535-161">In the **Items of type** dropdown list, select **MSBuild Project files**.</span></span>
11. <span data-ttu-id="b8535-162">Accédez à l’emplacement du fichier projet personnalisé avec lequel vous contrôlez le processus de déploiement, sélectionnez le fichier, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b8535-162">Browse to the location of the custom project file with which you control the deployment process, select the file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image6.png)
12. <span data-ttu-id="b8535-163">La boîte **de dialogue éléments à générer** doit maintenant afficher deux éléments.</span><span class="sxs-lookup"><span data-stu-id="b8535-163">The **Items to Build** dialog box should now show two items.</span></span> <span data-ttu-id="b8535-164">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b8535-164">Click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image7.png)
13. <span data-ttu-id="b8535-165">Sous l’onglet **processus** , dans le tableau **paramètres du processus de génération** , développez la section **avancé** .</span><span class="sxs-lookup"><span data-stu-id="b8535-165">On the **Process** tab, in the **Build process parameters** table, expand the **Advanced** section.</span></span>
14. <span data-ttu-id="b8535-166">Dans la ligne **arguments MSBuild** , ajoutez les arguments de ligne de commande MSBuild requis par l' *un* des éléments de la génération.</span><span class="sxs-lookup"><span data-stu-id="b8535-166">In the **MSBuild Arguments** row, add any MSBuild command-line arguments that *either* of your items to build requires.</span></span> <span data-ttu-id="b8535-167">Dans le scénario de solution du gestionnaire de contacts, ces arguments sont requis :</span><span class="sxs-lookup"><span data-stu-id="b8535-167">In the Contact Manager solution scenario, these arguments are required:</span></span>

    [!code-console[Main](creating-a-build-definition-that-supports-deployment/samples/sample1.cmd)]

    ![](creating-a-build-definition-that-supports-deployment/_static/image8.png)
15. <span data-ttu-id="b8535-168">Dans cet exemple :</span><span class="sxs-lookup"><span data-stu-id="b8535-168">In this example:</span></span>

    1. <span data-ttu-id="b8535-169">Les arguments **DeployOnBuild = true** et **DeployTarget = package** sont requis lorsque vous générez la solution du gestionnaire de contacts.</span><span class="sxs-lookup"><span data-stu-id="b8535-169">The **DeployOnBuild=true** and **DeployTarget=package** arguments are required when you build the Contact Manager solution.</span></span> <span data-ttu-id="b8535-170">Cela indique à MSBuild de créer des packages de déploiement Web après avoir généré chaque projet d’application Web, comme décrit dans [génération et empaquetage de projets d’application Web](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="b8535-170">This instructs MSBuild to create web deployment packages after building each web application project, as described in [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span></span>
    2. <span data-ttu-id="b8535-171">L’argument **TargetEnvPropsFile** est obligatoire lorsque vous générez le fichier *Publish. proj* .</span><span class="sxs-lookup"><span data-stu-id="b8535-171">The **TargetEnvPropsFile** argument is required when you build the *Publish.proj* file.</span></span> <span data-ttu-id="b8535-172">Cette propriété indique l’emplacement du fichier de configuration spécifique à l’environnement, comme décrit dans [fonctionnement du processus de génération](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="b8535-172">This property indicates the location of the environment-specific configuration file, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>
16. <span data-ttu-id="b8535-173">Sous l’onglet **stratégie de rétention** , configurez le nombre de builds de chaque type que vous souhaitez conserver en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="b8535-173">On the **Retention Policy** tab, configure how many builds of each type you want to retain as required.</span></span>
17. <span data-ttu-id="b8535-174">Cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="b8535-174">Click **Save**.</span></span>

## <a name="queue-a-build"></a><span data-ttu-id="b8535-175">Mettre une build en file d'attente</span><span class="sxs-lookup"><span data-stu-id="b8535-175">Queue a Build</span></span>

<span data-ttu-id="b8535-176">À ce stade, vous avez créé au moins une nouvelle définition de Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-176">At this point, you have created at least one new build definition.</span></span> <span data-ttu-id="b8535-177">Le processus de génération que vous avez défini s’exécutera maintenant en fonction des déclencheurs que vous avez spécifiés dans la définition de Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-177">The build process you defined will now run according to the triggers you specified in the build definition.</span></span>

<span data-ttu-id="b8535-178">Si vous avez configuré votre définition de build pour utiliser CI, vous pouvez tester votre définition de build de deux manières :</span><span class="sxs-lookup"><span data-stu-id="b8535-178">If you've configured your build definition to use CI, you can test your build definition in two ways:</span></span>

- <span data-ttu-id="b8535-179">Archivez du contenu dans le projet d’équipe pour déclencher une génération automatique.</span><span class="sxs-lookup"><span data-stu-id="b8535-179">Check in some content to the team project to trigger an automatic build.</span></span>
- <span data-ttu-id="b8535-180">Mettre en file d’attente une build manuellement.</span><span class="sxs-lookup"><span data-stu-id="b8535-180">Queue a build manually.</span></span>

<span data-ttu-id="b8535-181">**Pour mettre une build en file d’attente manuellement**</span><span class="sxs-lookup"><span data-stu-id="b8535-181">**To queue a build manually**</span></span>

1. <span data-ttu-id="b8535-182">Dans la fenêtre **Team Explorer** , cliquez avec le bouton droit sur la définition de build, puis cliquez sur **mettre en file d’attente une nouvelle build**.</span><span class="sxs-lookup"><span data-stu-id="b8535-182">In the **Team Explorer** window, right-click the build definition, and then click **Queue New Build**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image9.png)
2. <span data-ttu-id="b8535-183">Dans la boîte de dialogue **mettre en file d’attente** , passez en revue les propriétés de build, puis cliquez sur **file d’attente**.</span><span class="sxs-lookup"><span data-stu-id="b8535-183">In the **Queue Build** dialog box, review the build properties, and then click **Queue**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image10.png)

<span data-ttu-id="b8535-184">Pour examiner la progression et le résultat d’une build&#x2014;, qu’elle ait été déclenchée manuellement ou automatiquement&#x2014;, double-cliquez sur la définition de build dans la fenêtre **Team Explorer** .</span><span class="sxs-lookup"><span data-stu-id="b8535-184">To review the progress and the outcome of a build&#x2014;regardless of whether it was triggered manually or automatically&#x2014;double-click the build definition in the **Team Explorer** window.</span></span> <span data-ttu-id="b8535-185">L’onglet Explorateur de **Build** s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="b8535-185">This will open a **Build Explorer** tab.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image11.png)

<span data-ttu-id="b8535-186">À partir de là, vous pouvez résoudre les problèmes de build ayant échoué.</span><span class="sxs-lookup"><span data-stu-id="b8535-186">From here, you can troubleshoot failed builds.</span></span> <span data-ttu-id="b8535-187">Si vous double-cliquez sur une build individuelle, vous pouvez afficher des informations récapitulatives et cliquer pour accéder à des fichiers journaux détaillés.</span><span class="sxs-lookup"><span data-stu-id="b8535-187">If you double-click an individual build, you can view summary information and click through to detailed log files.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image12.png)

<span data-ttu-id="b8535-188">Vous pouvez utiliser ces informations pour résoudre les problèmes de build ayant échoué et résoudre les problèmes avant d’essayer une autre Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-188">You can use this information to troubleshoot failed builds and address any problems before you attempt another build.</span></span>

> [!NOTE]
> <span data-ttu-id="b8535-189">Les builds qui exécutent la logique de déploiement risquent d’échouer jusqu’à ce que vous ayez accordé au serveur de build toutes les autorisations requises dans l’environnement de destination.</span><span class="sxs-lookup"><span data-stu-id="b8535-189">Builds that execute deployment logic are likely to fail until you have granted the build server any permissions required in the destination environment.</span></span> <span data-ttu-id="b8535-190">Pour plus d’informations, consultez [Configuration des autorisations pour le déploiement Team Build](configuring-permissions-for-team-build-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="b8535-190">For more information, see [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md).</span></span>

## <a name="monitor-the-build-process"></a><span data-ttu-id="b8535-191">Surveiller le processus de génération</span><span class="sxs-lookup"><span data-stu-id="b8535-191">Monitor the Build Process</span></span>

<span data-ttu-id="b8535-192">TFS fournit une large gamme de fonctionnalités pour vous aider à surveiller le processus de génération.</span><span class="sxs-lookup"><span data-stu-id="b8535-192">TFS provides a broad range of functionality to help you monitor the build process.</span></span> <span data-ttu-id="b8535-193">Par exemple, TFS peut vous envoyer un e-mail ou afficher des alertes dans la zone de notification de la barre des tâches lorsqu’une build est terminée.</span><span class="sxs-lookup"><span data-stu-id="b8535-193">For example, TFS can send you an email or display alerts in your taskbar notification area when a build has completed.</span></span> <span data-ttu-id="b8535-194">Pour plus d’informations, consultez [exécuter et surveiller les builds](https://msdn.microsoft.com/library/ms181721.aspx).</span><span class="sxs-lookup"><span data-stu-id="b8535-194">For more information, see [Run and Monitor Builds](https://msdn.microsoft.com/library/ms181721.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="b8535-195">Conclusion</span><span class="sxs-lookup"><span data-stu-id="b8535-195">Conclusion</span></span>

<span data-ttu-id="b8535-196">Cette rubrique a décrit comment créer une définition de build dans TFS.</span><span class="sxs-lookup"><span data-stu-id="b8535-196">This topic described how to create a build definition in TFS.</span></span> <span data-ttu-id="b8535-197">La définition de build est configurée pour l’élément de configuration, de sorte que le processus de génération s’exécute chaque fois qu’un développeur Archive le contenu dans le projet d’équipe.</span><span class="sxs-lookup"><span data-stu-id="b8535-197">The build definition is configured for CI, so the build process runs whenever a developer checks in content to the team project.</span></span> <span data-ttu-id="b8535-198">La définition de build exécute un fichier projet MSBuild personnalisé pour déployer des packages Web et des scripts de base de données dans un environnement de serveur cible.</span><span class="sxs-lookup"><span data-stu-id="b8535-198">The build definition executes a custom MSBuild project file to deploy web packages and database scripts to a target server environment.</span></span>

<span data-ttu-id="b8535-199">Pour qu’un déploiement automatisé aboutisse dans le cadre d’un processus de génération, vous devez accorder les autorisations appropriées au compte de service de build sur les serveurs Web cibles et le serveur de base de données cible.</span><span class="sxs-lookup"><span data-stu-id="b8535-199">In order for an automated deployment to succeed as part of a build process, you'll need to grant appropriate permissions to the build service account on the target web servers and the target database server.</span></span> <span data-ttu-id="b8535-200">La dernière rubrique de ce didacticiel, [Configuration des autorisations pour le déploiement de Team Build](configuring-permissions-for-team-build-deployment.md), explique comment identifier et configurer les autorisations requises pour le déploiement automatisé à partir d’un serveur Team Build.</span><span class="sxs-lookup"><span data-stu-id="b8535-200">The final topic in this tutorial, [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md), describes how to identify and configure the permissions required for automated deployment from a Team Build server.</span></span>

## <a name="further-reading"></a><span data-ttu-id="b8535-201">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="b8535-201">Further Reading</span></span>

<span data-ttu-id="b8535-202">Pour plus d’informations sur la création de définitions de build, consultez [créer une définition de build de base](https://msdn.microsoft.com/library/ms181716.aspx) et [définir votre processus de génération](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="b8535-202">For more information on creating build definitions, see [Create a Basic Build Definition](https://msdn.microsoft.com/library/ms181716.aspx) and [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span> <span data-ttu-id="b8535-203">Pour plus d’informations sur la mise en file d’attente des builds, consultez [mettre en file d’attente une build](https://msdn.microsoft.com/library/ms181722.aspx).</span><span class="sxs-lookup"><span data-stu-id="b8535-203">For more guidance on queuing builds, see [Queue a Build](https://msdn.microsoft.com/library/ms181722.aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b8535-204">[Précédent](configuring-a-tfs-build-server-for-web-deployment.md)
> [Suivant](deploying-a-specific-build.md)</span><span class="sxs-lookup"><span data-stu-id="b8535-204">[Previous](configuring-a-tfs-build-server-for-web-deployment.md)
[Next](deploying-a-specific-build.md)</span></span>
