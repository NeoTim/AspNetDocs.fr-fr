---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-iis
title: 'Déploiement de Web ASP.NET à l’aide de Visual Studio : Déploiement sur Test | Microsoft Docs'
author: tdykstra
description: Cette série de didacticiels vous montre comment déployer (publier) un ASP.NET web application dans Azure App Service Web Apps ou à un fournisseur d’hébergement tiers, en utilisant des éléments...
ms.author: riande
ms.date: 01/16/2019
ms.assetid: 8bf2c4fb-4ee5-4841-bfc2-03462c1f7a7a
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-iis
msc.type: authoredcontent
ms.openlocfilehash: 39502e03196d2ba51e826d248ff0ff1e84258131
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59420196"
---
# <a name="aspnet-web-deployment-using-visual-studio-deploying-to-test"></a><span data-ttu-id="59d30-103">Déploiement de Web ASP.NET à l’aide de Visual Studio : Déploiement à des fins de test</span><span class="sxs-lookup"><span data-stu-id="59d30-103">ASP.NET Web Deployment using Visual Studio: Deploying to Test</span></span>

<span data-ttu-id="59d30-104">par [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="59d30-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="59d30-105">Cette série de didacticiels vous montre comment déployer (publier) un ASP.NET web application dans Azure App Service Web Apps ou à un fournisseur d’hébergement tiers à l’aide de Visual Studio 2017.</span><span class="sxs-lookup"><span data-stu-id="59d30-105">This tutorial series shows you how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider using Visual Studio 2017.</span></span> <span data-ttu-id="59d30-106">Pour plus d’informations sur la série, consultez [le premier didacticiel de la série](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="59d30-106">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>

## <a name="overview"></a><span data-ttu-id="59d30-107">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="59d30-107">Overview</span></span>

<span data-ttu-id="59d30-108">Dans ce didacticiel, vous allez déployer une application de web ASP.NET pour Internet Information Server (IIS) sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="59d30-108">In this tutorial, you'll deploy an ASP.NET web application to Internet Information Server (IIS) on your local computer.</span></span>

<span data-ttu-id="59d30-109">En général lorsque vous développez une application, vous exécutez et testez dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="59d30-109">Generally when you develop an application, you run it and test it in Visual Studio.</span></span> <span data-ttu-id="59d30-110">Par défaut, les projets d’application web dans Visual Studio 2017 utilisent IIS Express comme serveur web de développement.</span><span class="sxs-lookup"><span data-stu-id="59d30-110">By default, web application projects in Visual Studio 2017 use IIS Express as the development web server.</span></span> <span data-ttu-id="59d30-111">IIS Express se comporte davantage comme IIS complet que le serveur Visual Studio Development (également appelé « Cassini »), que Visual Studio 2017 utilise par défaut.</span><span class="sxs-lookup"><span data-stu-id="59d30-111">IIS Express behaves more like full IIS than the Visual Studio Development Server (also known as Cassini), which Visual Studio 2017 uses by default.</span></span> <span data-ttu-id="59d30-112">Mais aucun serveur web de développement fonctionne exactement comme IIS.</span><span class="sxs-lookup"><span data-stu-id="59d30-112">But neither development web server works exactly like IIS.</span></span> <span data-ttu-id="59d30-113">Par conséquent, une application peut exécuter et tester correctement dans Visual Studio, mais échouer lorsqu’elle est déployée sur IIS.</span><span class="sxs-lookup"><span data-stu-id="59d30-113">Consequently, an app could run and test correctly in Visual Studio but fail when it's deployed to IIS.</span></span>

<span data-ttu-id="59d30-114">Vous pouvez tester de manière fiable votre application de deux manières :</span><span class="sxs-lookup"><span data-stu-id="59d30-114">You can reliably test your application in two ways:</span></span>

1. <span data-ttu-id="59d30-115">Déployer votre application dans IIS sur votre ordinateur de développement en utilisant le même processus que vous utiliserez ultérieurement pour le déployer dans votre environnement de production.</span><span class="sxs-lookup"><span data-stu-id="59d30-115">Deploy your application to IIS on your development computer using the same process that you'll use later to deploy it to your production environment.</span></span>

   <span data-ttu-id="59d30-116">Vous pouvez configurer Visual Studio pour utiliser IIS lorsque vous exécutez un projet web, mais qui n’aurait pas tester votre processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="59d30-116">You can configure Visual Studio to use IIS when you run a web project, but that wouldn't test your deployment process.</span></span> <span data-ttu-id="59d30-117">Cette méthode valide votre processus de déploiement et que votre application s’exécute correctement sous IIS.</span><span class="sxs-lookup"><span data-stu-id="59d30-117">This method validates your deployment process and that your application runs correctly under IIS.</span></span>

2. <span data-ttu-id="59d30-118">Déployer votre application dans un environnement de test similaire à votre environnement de production.</span><span class="sxs-lookup"><span data-stu-id="59d30-118">Deploy your application to a test environment similar to your production environment.</span></span> 
 
   <span data-ttu-id="59d30-119">L’environnement de production pour ces didacticiels est Web Apps dans Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="59d30-119">The production environment for these tutorials is Web Apps in Azure App Service.</span></span> <span data-ttu-id="59d30-120">L’environnement de test idéal est une application web supplémentaires créée dans le Service Azure.</span><span class="sxs-lookup"><span data-stu-id="59d30-120">The ideal test environment is an additional web app created in the Azure Service.</span></span> <span data-ttu-id="59d30-121">Même si elle serait configurée comme une application web de production, vous serez uniquement l’utiliser pour le test.</span><span class="sxs-lookup"><span data-stu-id="59d30-121">Though it would be set up the same way as a production web app, you would only use it for testing.</span></span>

<span data-ttu-id="59d30-122">Option 2 est le moyen le plus fiable à tester.</span><span class="sxs-lookup"><span data-stu-id="59d30-122">Option 2 is the most reliable way to test.</span></span> <span data-ttu-id="59d30-123">Si vous utilisez l’option 2, ne pas nécessairement devoir utiliser l’option 1.</span><span class="sxs-lookup"><span data-stu-id="59d30-123">If you use option 2, you don't necessarily need to use option 1.</span></span> <span data-ttu-id="59d30-124">Toutefois si vous effectuez un déploiement à un tiers d’hébergement, option 2 peut ne pas être possible ou peut être coûteuse, par conséquent, cette série de didacticiels affiche les deux méthodes.</span><span class="sxs-lookup"><span data-stu-id="59d30-124">However if you're deploying to a third-party hosting provider, option 2 might not be feasible or might be expensive, so this tutorial series shows both methods.</span></span> <span data-ttu-id="59d30-125">Conseils pour l’option 2 sont fourni dans le [déploiement dans l’environnement de Production](deploying-to-production.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="59d30-125">Guidance for option 2 is provided in the [Deploying to the Production Environment](deploying-to-production.md) tutorial.</span></span>

<span data-ttu-id="59d30-126">Pour plus d’informations sur l’utilisation de serveurs web dans Visual Studio, consultez [serveurs Web dans Visual Studio pour les projets Web ASP.NET](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span><span class="sxs-lookup"><span data-stu-id="59d30-126">For more information about using web servers in Visual Studio, see [Web Servers in Visual Studio for ASP.NET Web Projects](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span></span>

<span data-ttu-id="59d30-127">Rappel : Si vous recevez un message d’erreur ou quelque chose ne fonctionne pas lorsque vous parcourez le didacticiel, veillez à consulter le [page Résolution des problèmes](troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="59d30-127">Reminder: If you receive an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](troubleshooting.md).</span></span>

## <a name="download-the-contoso-university-starter-project"></a><span data-ttu-id="59d30-128">Téléchargez le projet de démarrage de Contoso University</span><span class="sxs-lookup"><span data-stu-id="59d30-128">Download the Contoso University starter project</span></span>

<span data-ttu-id="59d30-129">Téléchargez et installez la solution de démarrage de Contoso University Visual Studio et le projet.</span><span class="sxs-lookup"><span data-stu-id="59d30-129">Download and install the Contoso University Visual Studio starter solution and project.</span></span> <span data-ttu-id="59d30-130">Cette solution contient à la fin du didacticiel.</span><span class="sxs-lookup"><span data-stu-id="59d30-130">This solution contains the completed tutorial.</span></span> 

[<span data-ttu-id="59d30-131">Télécharger le projet de démarrage</span><span class="sxs-lookup"><span data-stu-id="59d30-131">Download Starter Project</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=282627)

## <a name="install-iis"></a><span data-ttu-id="59d30-132">Installer IIS</span><span class="sxs-lookup"><span data-stu-id="59d30-132">Install IIS</span></span>

<span data-ttu-id="59d30-133">Pour déployer sur IIS sur votre ordinateur de développement, vérifiez que IIS et Web Deploy sont installés.</span><span class="sxs-lookup"><span data-stu-id="59d30-133">To deploy to IIS on your development computer, confirm that IIS and Web Deploy are installed.</span></span> <span data-ttu-id="59d30-134">Par défaut, Visual Studio installe Web Deploy, mais IIS n’est pas inclus dans la configuration par défaut de Windows 10, Windows 8 ou Windows 7.</span><span class="sxs-lookup"><span data-stu-id="59d30-134">By default, Visual Studio installs Web Deploy, but IIS isn't included in the default Windows 10, Windows 8, or Windows 7 configuration.</span></span> <span data-ttu-id="59d30-135">Si vous avez déjà installé IIS et le pool d’applications par défaut est déjà défini sur .NET 4, passez à [la section suivante](#sqlexpress).</span><span class="sxs-lookup"><span data-stu-id="59d30-135">If you've already installed IIS and the default application pool is already set to .NET 4, skip to [the next section](#sqlexpress).</span></span>

1. <span data-ttu-id="59d30-136">Il est recommandé d’utiliser le [Web Platform Installer (WPI)](https://www.microsoft.com/web/downloads/platform.aspx) pour installer IIS et Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="59d30-136">It's recommended you use the [Web Platform Installer (WPI)](https://www.microsoft.com/web/downloads/platform.aspx) to install IIS and Web Deploy.</span></span> <span data-ttu-id="59d30-137">WPI installe une configuration IIS recommandée qui décrit les conditions préalables IIS et Web Deploy si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="59d30-137">WPI installs a recommended IIS configuration that includes IIS and Web Deploy prerequisites if necessary.</span></span>

   <span data-ttu-id="59d30-138">Si vous avez déjà installé IIS, Web Deploy ou l’un de leurs composants obligatoires, l’identité WPI installe uniquement ce qui est manquant.</span><span class="sxs-lookup"><span data-stu-id="59d30-138">If you've already installed IIS, Web Deploy, or any of their required components, the WPI installs only what is missing.</span></span>

   * <span data-ttu-id="59d30-139">Utilisez Web Platform Installer pour installer IIS et Web Deploy :</span><span class="sxs-lookup"><span data-stu-id="59d30-139">Use the Web Platform Installer to install IIS and Web Deploy:</span></span>
    
     ![Installer IIS à l’aide de WPI](deploying-to-iis/_static/image30.png)

     ![Installer Web Deploy à l’aide de WPI](deploying-to-iis/_static/image31.png)

     <span data-ttu-id="59d30-142">Vous verrez des messages indiquant que IIS 7 sera installé.</span><span class="sxs-lookup"><span data-stu-id="59d30-142">You'll see messages indicating that IIS 7 will be installed.</span></span> <span data-ttu-id="59d30-143">Le lien fonctionne pour IIS 8 dans Windows 8 ; mais pour Windows 8 et versions ultérieures, suivez les étapes suivantes pour vous assurer que ASP.NET 4.7 est installé :</span><span class="sxs-lookup"><span data-stu-id="59d30-143">The link works for IIS 8 in Windows 8; but for Windows 8 and later, go through the following steps to make sure that ASP.NET 4.7 is installed:</span></span>

   * <span data-ttu-id="59d30-144">Ouvrez **le panneau de configuration** > **programmes** > **programmes et fonctionnalités** > **ou désactiver des fonctionnalités Windows activer** .</span><span class="sxs-lookup"><span data-stu-id="59d30-144">Open **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off**.</span></span>

   * <span data-ttu-id="59d30-145">Développez **Internet Information Services**, **Services World Wide Web**, et **fonctionnalités de développement d’applications**.</span><span class="sxs-lookup"><span data-stu-id="59d30-145">Expand **Internet Information Services**, **World Wide Web Services**, and **Application Development Features**.</span></span>
   
   * <span data-ttu-id="59d30-146">Vérifiez que **ASP.NET 4.7** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="59d30-146">Confirm that **ASP.NET 4.7** is selected.</span></span>

     ![Sélectionnez ASP.NET 4.7](deploying-to-iis/_static/image1a.png)

   * <span data-ttu-id="59d30-148">Vérifiez que **Services World Wide Web** et **Console de gestion IIS** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="59d30-148">Confirm that **World Wide Web Services** and **IIS Management Console** is selected.</span></span> <span data-ttu-id="59d30-149">Cette opération installe IIS et le Gestionnaire des services Internet.</span><span class="sxs-lookup"><span data-stu-id="59d30-149">This installs IIS and IIS Manager.</span></span>
    
     ![Sélectionnez les Services World Wide Web](deploying-to-iis/_static/image24.png)    
  
   * <span data-ttu-id="59d30-151">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="59d30-151">Select **OK**.</span></span> <span data-ttu-id="59d30-152">Messages de boîte de dialogue indiquant l’installation est en cours s’affichent.</span><span class="sxs-lookup"><span data-stu-id="59d30-152">Dialog box messages indicating installation is taking place appear.</span></span>

<span data-ttu-id="59d30-153">Après avoir installé IIS, exécutez **Gestionnaire des services Internet** pour vous assurer que le .NET Framework version 4 est affecté au pool d’applications par défaut.</span><span class="sxs-lookup"><span data-stu-id="59d30-153">After installing IIS, run **IIS Manager** to make sure that the .NET Framework version 4 is assigned to the default application pool.</span></span>

1. <span data-ttu-id="59d30-154">Appuyez sur la touche WINDOWS + R pour ouvrir la **exécuter** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="59d30-154">Press WINDOWS+R to open the **Run** dialog box.</span></span>

   <span data-ttu-id="59d30-155">(Sur Windows 8 ou version ultérieure, entrez « exécuter » sur le **Démarrer** page.</span><span class="sxs-lookup"><span data-stu-id="59d30-155">(On Windows 8 or later, enter "run" on the **Start** page.</span></span> <span data-ttu-id="59d30-156">Dans Windows 7, sélectionnez **exécuter** à partir de la **Démarrer** menu.</span><span class="sxs-lookup"><span data-stu-id="59d30-156">In Windows 7, select **Run** from the **Start** menu.</span></span> <span data-ttu-id="59d30-157">Si **exécuter** n’est pas dans le **Démarrer** menu, cliquez sur la barre des tâches, sélectionnez **propriétés**, sélectionnez le **Menu Démarrer** , sélectionnez **Personnaliser**, puis sélectionnez **exécuter la commande**.)</span><span class="sxs-lookup"><span data-stu-id="59d30-157">If **Run** isn't in the **Start** menu, right-click the taskbar, select **Properties**, select the **Start Menu** tab, select **Customize**, and select **Run command**.)</span></span>

2. <span data-ttu-id="59d30-158">Entrez « inetmgr » et sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="59d30-158">Enter "inetmgr" and select **OK**.</span></span>

3. <span data-ttu-id="59d30-159">Dans le **connexions** volet, développez le nœud du serveur, puis sélectionnez **Pools d’applications**.</span><span class="sxs-lookup"><span data-stu-id="59d30-159">In the **Connections** pane, expand the server node and select **Application Pools**.</span></span> <span data-ttu-id="59d30-160">Dans le **Pools d’applications** volet si **DefaultAppPool** est attribué pour le .NET framework version 4, comme dans l’illustration suivante, passez à la section suivante.</span><span class="sxs-lookup"><span data-stu-id="59d30-160">In the **Application Pools** pane if **DefaultAppPool** is assigned to the .NET framework version 4 as in the following illustration, skip to the next section.</span></span>

   ![Inetmgr_showing_4.0_app_pools](deploying-to-iis/_static/image5a.png)

4. <span data-ttu-id="59d30-162">Si vous voyez uniquement deux pools d’applications et les deux sont définies pour le .NET Framework 2.0, installer ASP.NET 4 dans IIS.</span><span class="sxs-lookup"><span data-stu-id="59d30-162">If you see only two application pools and both are set to .NET Framework 2.0, install ASP.NET 4 in IIS.</span></span>

   <span data-ttu-id="59d30-163">Pour Windows 8 ou version ultérieure, consultez les instructions de la section précédente pour s’assurer que ASP.NET 4.7 est installé ou [comment installer ASP.NET 4.5 sur Windows 8 et Windows Server 2012](https://support.microsoft.com/kb/2736284).</span><span class="sxs-lookup"><span data-stu-id="59d30-163">For Windows 8 or later, see the previous section's instructions for making sure that ASP.NET 4.7 is installed or see [How to install ASP.NET 4.5 on Windows 8 and Windows Server 2012](https://support.microsoft.com/kb/2736284).</span></span> <span data-ttu-id="59d30-164">Pour Windows 7, ouvrez une fenêtre d’invite de commandes en cliquant en **invite de commandes** dans le Windows **Démarrer** menu et en sélectionnant **exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="59d30-164">For Windows 7, open a command prompt window by right-clicking **Command Prompt** in the Windows **Start** menu and selecting **Run as Administrator**.</span></span> <span data-ttu-id="59d30-165">Exécutez [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) pour installer ASP.NET 4 dans IIS en utilisant les commandes suivantes.</span><span class="sxs-lookup"><span data-stu-id="59d30-165">Run [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) to install ASP.NET 4 in IIS using the following commands.</span></span> <span data-ttu-id="59d30-166">(Dans les systèmes 32 bits, remplacez « Framework64 » avec « Framework »).</span><span class="sxs-lookup"><span data-stu-id="59d30-166">(In 32-bit systems, replace "Framework64" with "Framework".)</span></span>

   [!code-console[Main](deploying-to-iis/samples/sample1.cmd)]

   <span data-ttu-id="59d30-167">Cette commande crée la nouvelle application que pools pour le .NET Framework 4, mais le pool d’applications par défaut reste définie sur 2.0.</span><span class="sxs-lookup"><span data-stu-id="59d30-167">This command creates new application pools for the .NET Framework 4, but the default application pool will remain set to 2.0.</span></span> <span data-ttu-id="59d30-168">Vous déployez une application que cibles .NET 4 à ce pool d’applications, modifiez par conséquent, le pool d’applications pour .NET 4.</span><span class="sxs-lookup"><span data-stu-id="59d30-168">You're deploying an application that targets .NET 4 to that application pool, so change the application pool to .NET 4.</span></span>

5. <span data-ttu-id="59d30-169">Si vous avez fermé **Gestionnaire des services Internet**, exécutez-le à nouveau, développez le nœud du serveur, puis sélectionnez **Pools d’applications**.</span><span class="sxs-lookup"><span data-stu-id="59d30-169">If you closed **IIS Manager**, run it again, expand the server node, and select **Application Pools**.</span></span>

6. <span data-ttu-id="59d30-170">Dans le **Pools d’applications** volet, sélectionnez **DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="59d30-170">In the **Application Pools** pane, select **DefaultAppPool**.</span></span> <span data-ttu-id="59d30-171">Dans le **Actions** volet, sélectionnez **paramètres de base**.</span><span class="sxs-lookup"><span data-stu-id="59d30-171">In the **Actions** pane, select **Basic Settings**.</span></span>

   ![Inetmgr_selecting_Basic_Settings_for_app_pool](deploying-to-iis/_static/image25.png)

7. <span data-ttu-id="59d30-173">Dans le **modifier le Pool d’Application** boîte de dialogue, choisissez le **version .NET CLR** à **.NET CLR v4.0.30319**.</span><span class="sxs-lookup"><span data-stu-id="59d30-173">In the **Edit Application Pool** dialog box, change the **.NET CLR version** to **.NET CLR v4.0.30319**.</span></span> <span data-ttu-id="59d30-174">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="59d30-174">Select **OK**.</span></span>

   ![Selecting_.NET_4_for_DefaultAppPool](deploying-to-iis/_static/image6a.png)

<span data-ttu-id="59d30-176">Vous êtes maintenant prêt à publier une application web vers IIS.</span><span class="sxs-lookup"><span data-stu-id="59d30-176">You're now ready to publish a web application to IIS.</span></span> <span data-ttu-id="59d30-177">Tout d’abord, cependant, créer des bases de données de test.</span><span class="sxs-lookup"><span data-stu-id="59d30-177">First, however, create databases for testing.</span></span>

<a id="sqlexpress"></a>

## <a name="install-sql-server-express"></a><span data-ttu-id="59d30-178">Installer SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="59d30-178">Install SQL Server Express</span></span>

<span data-ttu-id="59d30-179">Base de données locale n’est pas conçu pour fonctionner dans IIS, votre environnement de test doit donc avoir SQL Server Express est installé.</span><span class="sxs-lookup"><span data-stu-id="59d30-179">LocalDB isn't designed to work in IIS, so your test environment has to have SQL Server Express installed.</span></span> <span data-ttu-id="59d30-180">Si vous utilisez Visual Studio 2010 SQL Server Express, il est déjà installé par défaut.</span><span class="sxs-lookup"><span data-stu-id="59d30-180">If you're using Visual Studio 2010 SQL Server Express, it's already installed by default.</span></span> <span data-ttu-id="59d30-181">Si vous utilisez Visual Studio 2012 ou version ultérieure, installez SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="59d30-181">If you're using Visual Studio 2012 or later, install SQL Server Express.</span></span>

<span data-ttu-id="59d30-182">Pour installer SQL Server Express, téléchargez et installez-le à partir de [centre de téléchargement : Microsoft SQL Server 2017 Express edition](https://www.microsoft.com/sql-server/sql-server-editions-express).</span><span class="sxs-lookup"><span data-stu-id="59d30-182">To install SQL Server Express, download and install it from [Download Center: Microsoft SQL Server 2017 Express edition](https://www.microsoft.com/sql-server/sql-server-editions-express).</span></span> 

<span data-ttu-id="59d30-183">Sur la première page du centre d’Installation de SQL Server, sélectionnez **nouvelle installation SQL Server autonome ou ajout de fonctionnalités à une installation existante** et suivez les instructions acceptant les choix par défaut.</span><span class="sxs-lookup"><span data-stu-id="59d30-183">On the first page of the SQL Server Installation Center, select **New SQL Server stand-alone installation or add features to an existing installation** and follow the instructions accepting the default choices.</span></span> <span data-ttu-id="59d30-184">Dans l’Assistant installation, acceptez les paramètres par défaut.</span><span class="sxs-lookup"><span data-stu-id="59d30-184">In the installation wizard, accept the default settings.</span></span> <span data-ttu-id="59d30-185">Pour plus d’informations sur les options d’installation, consultez [installer SQL Server à partir de l’Assistant Installation (Setup)](https://msdn.microsoft.com/library/ms143219.aspx).</span><span class="sxs-lookup"><span data-stu-id="59d30-185">For more information about installation options, see [Install SQL Server from the Installation Wizard (Setup)](https://msdn.microsoft.com/library/ms143219.aspx).</span></span>

## <a name="create-sql-server-express-databases-for-the-test-environment"></a><span data-ttu-id="59d30-186">Créer des bases de données SQL Server Express pour l’environnement de test</span><span class="sxs-lookup"><span data-stu-id="59d30-186">Create SQL Server Express databases for the test environment</span></span>

<span data-ttu-id="59d30-187">L’application Contoso University a deux bases de données :</span><span class="sxs-lookup"><span data-stu-id="59d30-187">The Contoso University application has two databases:</span></span> 

1. <span data-ttu-id="59d30-188">Base de données d’appartenance</span><span class="sxs-lookup"><span data-stu-id="59d30-188">Membership database</span></span> 
2. <span data-ttu-id="59d30-189">base de données de l’application</span><span class="sxs-lookup"><span data-stu-id="59d30-189">Application database</span></span> 

<span data-ttu-id="59d30-190">Vous pouvez déployer ces bases de données pour les deux bases de données distinctes ou à une base de données unique.</span><span class="sxs-lookup"><span data-stu-id="59d30-190">You can deploy these databases to two separate databases or to a single database.</span></span> <span data-ttu-id="59d30-191">En les combinant rend les jointures de bases de données entre eux plus facile.</span><span class="sxs-lookup"><span data-stu-id="59d30-191">Combining them makes database joins between them easier.</span></span> 

<span data-ttu-id="59d30-192">Si vous déployez sur un fournisseur d’hébergement tiers, votre plan d’hébergement peut également vous donner une raison de les combiner.</span><span class="sxs-lookup"><span data-stu-id="59d30-192">If you're deploying to a third-party hosting provider, your hosting plan might also give you a reason to combine them.</span></span> <span data-ttu-id="59d30-193">Par exemple, le fournisseur peut facturent plus pour plusieurs bases de données ou ne peut pas même permettre plusieurs bases de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-193">For example, the provider might charge more for multiple databases or might not even allow more than one database.</span></span>

<span data-ttu-id="59d30-194">Dans ce didacticiel, vous allez déployer deux bases de données dans l’environnement de test et une base de données dans les environnements intermédiaire et de production.</span><span class="sxs-lookup"><span data-stu-id="59d30-194">In this tutorial, you'll deploy to two databases in the test environment and to one database in the staging and production environments.</span></span>

<span data-ttu-id="59d30-195">À partir de la **vue** menu dans Visual Studio, sélectionnez **Explorateur de serveurs** (**Database Explorer** dans Visual Web Developer).</span><span class="sxs-lookup"><span data-stu-id="59d30-195">From the **View** menu in Visual Studio, select **Server Explorer** (**Database Explorer** in Visual Web Developer).</span></span> <span data-ttu-id="59d30-196">Avec le bouton droit **des connexions de données** et sélectionnez **créer une nouvelle base de données SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="59d30-196">Right-click **Data Connections** and select **Create New SQL Server Database**.</span></span>

![Selecting_Create_New_SQL_Server_Database](deploying-to-iis/_static/image8.png)

<span data-ttu-id="59d30-198">Dans le **créer une nouvelle base de données SQL Server** boîte de dialogue, entrez «. \SQLExpress » dans le **nom du serveur** zone et « aspnet-ContosoUniversity » dans le **nouveau nom de base de données** boîte.</span><span class="sxs-lookup"><span data-stu-id="59d30-198">In the **Create New SQL Server Database** dialog box, enter ".\SQLExpress" in the **Server name** box and "aspnet-ContosoUniversity" in the **New database name** box.</span></span> <span data-ttu-id="59d30-199">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="59d30-199">Select **OK**.</span></span>

![Créer aspnet-ContosoUniversity](deploying-to-iis/_static/image9.png)

<span data-ttu-id="59d30-201">Suivez la même procédure pour créer une nouvelle base de données SQL Server Express School nommé `ContosoUniversity`.</span><span class="sxs-lookup"><span data-stu-id="59d30-201">Follow the same procedure to create a new SQL Server Express School database named `ContosoUniversity`.</span></span>

<span data-ttu-id="59d30-202">**Explorateur de serveurs** montre les deux nouvelles bases de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-202">**Server Explorer** shows the two new databases.</span></span>

![Nouvelles bases de données dans l’Explorateur de serveurs](deploying-to-iis/_static/image10.png)

## <a name="create-a-grant-script-for-the-new-databases"></a><span data-ttu-id="59d30-204">Créer un script d’octroi de nouvelles bases de données</span><span class="sxs-lookup"><span data-stu-id="59d30-204">Create a grant script for the new databases</span></span>

<span data-ttu-id="59d30-205">Lorsque l’application s’exécute dans IIS sur votre ordinateur de développement, l’application utilise les informations d’identification du pool d’applications par défaut pour accéder à la base de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-205">When the application runs in IIS on your development computer, the application uses the default application pool's credentials to access the database.</span></span> <span data-ttu-id="59d30-206">Toutefois, par défaut, le pool d’applications n’est pas autorisé à ouvrir les bases de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-206">However, by default, the application pool doesn't have permission to open the databases.</span></span> <span data-ttu-id="59d30-207">Cela signifie que vous avez besoin exécuter un script pour accorder cette autorisation.</span><span class="sxs-lookup"><span data-stu-id="59d30-207">This means you need to run a script to grant that permission.</span></span> <span data-ttu-id="59d30-208">Dans cette section, vous allez créer ce script et exécutez-le ultérieur pour vous assurer que l’application peut ouvrir les bases de données lorsqu’elle s’exécute dans IIS.</span><span class="sxs-lookup"><span data-stu-id="59d30-208">In this section, you'll create that script and run it later to make sure that the application can open the databases when it runs in IIS.</span></span>

<span data-ttu-id="59d30-209">Dans un éditeur de texte, copiez les commandes SQL suivantes dans un nouveau fichier et enregistrez-le en tant que *Grant.sql*.</span><span class="sxs-lookup"><span data-stu-id="59d30-209">In a text editor, copy the following SQL commands into a new file and save it as *Grant.sql*.</span></span> 

[!code-sql[Main](deploying-to-iis/samples/sample2.sql)]

<span data-ttu-id="59d30-210">Dans Visual Studio, ouvrez la solution Contoso University.</span><span class="sxs-lookup"><span data-stu-id="59d30-210">In Visual Studio, open the Contoso University solution.</span></span> <span data-ttu-id="59d30-211">Avec le bouton droit de la solution (pas un des projets), puis sélectionnez **ajouter**.</span><span class="sxs-lookup"><span data-stu-id="59d30-211">Right-click the solution (not one of the projects), and select **Add**.</span></span> <span data-ttu-id="59d30-212">Sélectionnez **élément existant**, accédez à *Grant.sql*et l’ouvrir.</span><span class="sxs-lookup"><span data-stu-id="59d30-212">Select **Existing Item**, browse to *Grant.sql*, and open it.</span></span>

> [!NOTE]
> <span data-ttu-id="59d30-213">Ce script est conçu pour fonctionnent avec SQL Server Express 2012 ou version ultérieure et avec les paramètres IIS dans Windows 10, Windows 8 ou Windows 7, comme ils sont spécifiés dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="59d30-213">This script is designed to work with SQL Server Express 2012 or later and with the IIS settings in Windows 10, Windows 8, or Windows 7 as they are specified in this tutorial.</span></span> <span data-ttu-id="59d30-214">Si vous utilisez une version différente de SQL Server ou Windows, ou si vous configurez IIS sur votre ordinateur différemment, les modifications apportées à ce script peuvent être nécessaire.</span><span class="sxs-lookup"><span data-stu-id="59d30-214">If you're using a different version of SQL Server or Windows, or if you set up IIS on your computer differently, changes to this script might be required.</span></span> <span data-ttu-id="59d30-215">Pour plus d’informations sur les scripts SQL Server, consultez [la documentation en ligne de SQL Server](https://go.microsoft.com/fwlink/?LinkId=132511).</span><span class="sxs-lookup"><span data-stu-id="59d30-215">For more information about SQL Server scripts, see [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span></span>

> [!NOTE] 
> <span data-ttu-id="59d30-216">**Note de sécurité** ce script donne `db_owner` autorisations à l’utilisateur qui accède à la base de données au moment de l’exécution, ce qui est ce que vous aurez dans l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="59d30-216">**Security Note** This script gives `db_owner` permissions to the user that accesses the database at run time, which is what you'll have in the production environment.</span></span> <span data-ttu-id="59d30-217">Dans certains scénarios, vous souhaiterez sans doute spécifier un utilisateur qui a le schéma de base de données complète mettre à jour des autorisations uniquement pour le déploiement et de spécifier pour le moment de l’exécution d’un autre utilisateur qui dispose des autorisations uniquement pour lire et écrire des données.</span><span class="sxs-lookup"><span data-stu-id="59d30-217">In some scenarios, you might want to specify a user that has full database schema update permissions only for deployment and specify for run time a different user that has permissions only to read and write data.</span></span> <span data-ttu-id="59d30-218">Pour plus d’informations, consultez [vérifié les modifications de Web.config automatique pour les Migrations Code First](#reviewingmigrations) plus loin dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="59d30-218">For more information, see [Reviewing the Automatic Web.config Changes for Code First Migrations](#reviewingmigrations) later in this tutorial.</span></span>

<a id="publish"></a>

## <a name="run-the-grant-script-in-the-application-database"></a><span data-ttu-id="59d30-219">Exécutez le script d’octroi dans la base de données d’application</span><span class="sxs-lookup"><span data-stu-id="59d30-219">Run the grant script in the application database</span></span>

<span data-ttu-id="59d30-220">Vous pouvez configurer le profil de publication pour exécuter le script d’octroi dans la base de données d’appartenance au cours du déploiement, car ce déploiement de base de données utilise le [dbDacFx](https://docs.microsoft.com/iis/publish/using-web-deploy/dbdacfx-provider-for-incremental-database-publishing) fournisseur.</span><span class="sxs-lookup"><span data-stu-id="59d30-220">You can configure the publish profile to run the grant script in the membership database during deployment because that database deployment uses the [dbDacFx](https://docs.microsoft.com/iis/publish/using-web-deploy/dbdacfx-provider-for-incremental-database-publishing) provider.</span></span> <span data-ttu-id="59d30-221">Vous ne pouvez pas exécuter des scripts pendant le déploiement de Migrations Code First, qui est la façon dont vous déployez la base de données d’application.</span><span class="sxs-lookup"><span data-stu-id="59d30-221">You can't run scripts during Code First Migrations deployment, which is how you're deploying the application database.</span></span> <span data-ttu-id="59d30-222">Cela signifie que vous devez exécuter manuellement le script avant le déploiement dans la base de données d’application.</span><span class="sxs-lookup"><span data-stu-id="59d30-222">This means you have to manually run the script before deployment in the application database.</span></span>

1. <span data-ttu-id="59d30-223">Dans Visual Studio, ouvrez le *Grant.sql* fichier que vous avez créé précédemment.</span><span class="sxs-lookup"><span data-stu-id="59d30-223">In Visual Studio, open the *Grant.sql* file that you created earlier.</span></span>

2. <span data-ttu-id="59d30-224">Sélectionnez **connecter**.</span><span class="sxs-lookup"><span data-stu-id="59d30-224">Select **Connect**.</span></span> 

    ![Bouton de connexion](deploying-to-iis/_static/image11.png)

3. <span data-ttu-id="59d30-226">Dans le **se connecter au serveur** boîte de dialogue, entrez *. \SQLExpress* en tant que le **nom du serveur**.</span><span class="sxs-lookup"><span data-stu-id="59d30-226">In the **Connect to Server** dialog box, enter *.\SQLExpress* as the **Server Name**.</span></span> <span data-ttu-id="59d30-227">Sélectionnez **connecter**.</span><span class="sxs-lookup"><span data-stu-id="59d30-227">Select **Connect**.</span></span>

4. <span data-ttu-id="59d30-228">Dans la liste déroulante de base de données Sélectionnez **ContosoUniversity**.</span><span class="sxs-lookup"><span data-stu-id="59d30-228">In the database drop-down list select **ContosoUniversity**.</span></span> <span data-ttu-id="59d30-229">Sélectionnez **exécuter**.</span><span class="sxs-lookup"><span data-stu-id="59d30-229">Select **Execute**.</span></span> 

   ![](deploying-to-iis/_static/image12.png)

<span data-ttu-id="59d30-230">Désormais, l’identité de pool d’applications par défaut dispose des autorisations suffisantes dans la base de données d’application pour les Migrations Code First créer les tables de base de données lors de l’application s’exécute.</span><span class="sxs-lookup"><span data-stu-id="59d30-230">The default application pool identity now has sufficient permissions in the application database for Code First Migrations to create the database tables when the application runs.</span></span>

## <a name="publish-to-iis"></a><span data-ttu-id="59d30-231">Publier sur IIS</span><span class="sxs-lookup"><span data-stu-id="59d30-231">Publish to IIS</span></span>

<span data-ttu-id="59d30-232">Il existe plusieurs façons, que vous pouvez déployer sur IIS à l’aide de Visual Studio et Web Deploy :</span><span class="sxs-lookup"><span data-stu-id="59d30-232">There are several ways you can deploy to IIS using Visual Studio and Web Deploy:</span></span>

* <span data-ttu-id="59d30-233">Utilisez Visual Studio publication en un clic.</span><span class="sxs-lookup"><span data-stu-id="59d30-233">Use Visual Studio one-click publish.</span></span>
* <span data-ttu-id="59d30-234">Publier à partir de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="59d30-234">Publish from the command line.</span></span>
* <span data-ttu-id="59d30-235">Créer un package de déploiement et l’installer à l’aide du Gestionnaire des services Internet.</span><span class="sxs-lookup"><span data-stu-id="59d30-235">Create a deployment package and install it using IIS Manager.</span></span> <span data-ttu-id="59d30-236">Le package a un fichier .zip avec tous les fichiers et les métadonnées requises pour installer un site dans IIS.</span><span class="sxs-lookup"><span data-stu-id="59d30-236">The package has a .zip file with all the files and metadata required to install a site in IIS.</span></span>
* <span data-ttu-id="59d30-237">Créer un package de déploiement et l’installer à l’aide de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="59d30-237">Create a deployment package and install it using the command line.</span></span>

<span data-ttu-id="59d30-238">Le processus que vous avez parcouru dans les didacticiels précédents pour configurer Visual Studio pour automatiser les tâches de déploiement s’applique à toutes ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="59d30-238">The process you went through in the previous tutorials to set up Visual Studio to automate deployment tasks applies to all of these methods.</span></span> <span data-ttu-id="59d30-239">Dans ces didacticiels, vous allez utiliser les deux premières méthodes.</span><span class="sxs-lookup"><span data-stu-id="59d30-239">In these tutorials, you'll use the first two methods.</span></span> <span data-ttu-id="59d30-240">Pour plus d’informations sur l’utilisation de packages de déploiement, consultez [déploiement d’une application web en créant et en installant un package de déploiement web](https://go.microsoft.com/fwlink/p/?LinkId=282413#package) dans le plan de contenu de déploiement Web pour Visual Studio et ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="59d30-240">For information about using deployment packages, see [Deploying a web application by creating and installing a web deployment package](https://go.microsoft.com/fwlink/p/?LinkId=282413#package) in the Web Deployment Content Map for Visual Studio and ASP.NET.</span></span>

<span data-ttu-id="59d30-241">Avant la publication, assurez-vous que vous exécutez Visual Studio en mode administrateur.</span><span class="sxs-lookup"><span data-stu-id="59d30-241">Before publishing, make sure that you're running Visual Studio in administrator mode.</span></span> <span data-ttu-id="59d30-242">Si vous ne voyez pas **(administrateur)** dans la barre de titre, fermez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="59d30-242">If you don't see **(Administrator)** in the title bar, close Visual Studio.</span></span> <span data-ttu-id="59d30-243">Dans le Windows 8 (ou version ultérieure) **Démarrer** page ou le Kit Windows 7 **Démarrer** menu, cliquez sur l’icône de Visual Studio et sélectionnez **exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="59d30-243">In the Windows 8 (or later) **Start** page or the Windows 7 **Start** menu, right-click the Visual Studio icon and select **Run as Administrator**.</span></span> <span data-ttu-id="59d30-244">Le mode administrateur est uniquement requis pour la publication lorsque vous publiez sur IIS sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="59d30-244">Administrator mode is only required for publishing when you're publishing to IIS on the local computer.</span></span>

### <a name="create-the-publish-profile"></a><span data-ttu-id="59d30-245">Créer le profil de publication</span><span class="sxs-lookup"><span data-stu-id="59d30-245">Create the publish profile</span></span>

1. <span data-ttu-id="59d30-246">Dans **l’Explorateur de solutions**, avec le bouton droit le **ContosoUniversity** projet (pas le **ContosoUniversity.DAL** projet).</span><span class="sxs-lookup"><span data-stu-id="59d30-246">In **Solution Explorer**, right-click the **ContosoUniversity** project (not the **ContosoUniversity.DAL** project).</span></span> <span data-ttu-id="59d30-247">Sélectionnez **Publier**.</span><span class="sxs-lookup"><span data-stu-id="59d30-247">Select **Publish**.</span></span> <span data-ttu-id="59d30-248">Le **publier** page s’affiche.</span><span class="sxs-lookup"><span data-stu-id="59d30-248">The **Publish** page appears.</span></span>

2. <span data-ttu-id="59d30-249">Sélectionnez **nouveau profil**.</span><span class="sxs-lookup"><span data-stu-id="59d30-249">Select **New Profile**.</span></span> <span data-ttu-id="59d30-250">Le **choisir une cible de publication** boîte de dialogue s’affiche.</span><span class="sxs-lookup"><span data-stu-id="59d30-250">The **Pick a publish target** dialog box appears.</span></span>

3. <span data-ttu-id="59d30-251">Sélectionnez **IIS, FTP, etc.**. Sélectionnez **Créer un profil**.</span><span class="sxs-lookup"><span data-stu-id="59d30-251">Select **IIS, FTP, etc**. Select **Create Profile**.</span></span> <span data-ttu-id="59d30-252">Le **publier** Assistant s’affiche.</span><span class="sxs-lookup"><span data-stu-id="59d30-252">The **Publish** wizard appears.</span></span>

   ![Publication : onglet Web Assistant profil](deploying-to-iis/_static/image26.png)

4. <span data-ttu-id="59d30-254">À partir de la **méthode de publication** menu déroulant, sélectionnez **Web Deploy**.</span><span class="sxs-lookup"><span data-stu-id="59d30-254">From the **Publish method** drop-down menu, select **Web Deploy**.</span></span>

5. <span data-ttu-id="59d30-255">Pour **Server**, entrez *localhost*.</span><span class="sxs-lookup"><span data-stu-id="59d30-255">For **Server**, enter *localhost*.</span></span>

6. <span data-ttu-id="59d30-256">Pour **nom du Site**, entrez *Default Web Site/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="59d30-256">For **Site name**, enter *Default Web Site/ContosoUniversity*.</span></span>

7. <span data-ttu-id="59d30-257">Pour **URL de Destination**, entrez *http://localhost/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="59d30-257">For **Destination URL**, enter *http://localhost/ContosoUniversity*.</span></span>

   <span data-ttu-id="59d30-258">Le **URL de Destination** paramètre n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="59d30-258">The **Destination URL** setting isn't required.</span></span> <span data-ttu-id="59d30-259">Visual Studio a terminé de déployer l’application, il s’ouvre automatiquement votre navigateur par défaut à cette URL.</span><span class="sxs-lookup"><span data-stu-id="59d30-259">When Visual Studio finishes deploying the application, it automatically opens your default browser to this URL.</span></span> <span data-ttu-id="59d30-260">Si vous ne souhaitez pas le navigateur s’ouvre automatiquement après le déploiement, laissez cette zone vide.</span><span class="sxs-lookup"><span data-stu-id="59d30-260">If you don't want the browser to open automatically after deployment, leave this box blank.</span></span>

8. <span data-ttu-id="59d30-261">Sélectionnez **valider la connexion** pour vérifier que les paramètres sont corrects et que vous pouvez vous connecter à IIS sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="59d30-261">Select **Validate Connection** to verify that the settings are correct and you can connect to IIS on the local computer.</span></span>

   <span data-ttu-id="59d30-262">Une coche verte vérifie que la connexion est établie.</span><span class="sxs-lookup"><span data-stu-id="59d30-262">A green check mark verifies that the connection is successful.</span></span>

   ![Publication : onglet Web Assistant connexion](deploying-to-iis/_static/image27.png)

9. <span data-ttu-id="59d30-264">Sélectionnez **suivant** pour accéder à la **paramètres** onglet.</span><span class="sxs-lookup"><span data-stu-id="59d30-264">Select **Next** to advance to the **Settings** tab.</span></span>

10. <span data-ttu-id="59d30-265">Le **Configuration** zone de liste déroulante spécifie la configuration de build à déployer.</span><span class="sxs-lookup"><span data-stu-id="59d30-265">The **Configuration** drop-down box specifies the build configuration to deploy.</span></span> <span data-ttu-id="59d30-266">Laissez la valeur par défaut de **version**.</span><span class="sxs-lookup"><span data-stu-id="59d30-266">Leave it set to the default value of **Release**.</span></span> <span data-ttu-id="59d30-267">Dans ce didacticiel, vous ne déployer les versions Debug.</span><span class="sxs-lookup"><span data-stu-id="59d30-267">You won't be deploying Debug builds in this tutorial.</span></span>

11. <span data-ttu-id="59d30-268">Développez **Options de publication des fichiers**.</span><span class="sxs-lookup"><span data-stu-id="59d30-268">Expand **File Publish Options**.</span></span> <span data-ttu-id="59d30-269">Sélectionnez **exclure des fichiers de l’application\_dossier de données**.</span><span class="sxs-lookup"><span data-stu-id="59d30-269">Select **Exclude files from the App\_Data folder**.</span></span>

    <span data-ttu-id="59d30-270">Dans l’environnement de test, l’application accède à des bases de données que vous avez créé dans le SQL Server Express instance locale, pas les fichiers .mdf dans le *application\_données* dossier.</span><span class="sxs-lookup"><span data-stu-id="59d30-270">In the test environment, the application accesses the databases that you created in the local SQL Server Express instance, not the .mdf files in the *App\_Data* folder.</span></span>

12. <span data-ttu-id="59d30-271">Laissez le **précompiler durant la publication** et **supprimer les fichiers supplémentaires à la destination** cases à cocher désactivées.</span><span class="sxs-lookup"><span data-stu-id="59d30-271">Leave the **Precompile during publishing** and **Remove additional files at destination** check boxes cleared.</span></span>

    ![Options de publication du fichier dans l’onglet Paramètres](deploying-to-iis/_static/image15a.png)

    <span data-ttu-id="59d30-273">La précompilation est une option qui est utile surtout pour les sites de grande taille.</span><span class="sxs-lookup"><span data-stu-id="59d30-273">Precompiling is an option that is useful mainly for large sites.</span></span> <span data-ttu-id="59d30-274">Elle peut réduire le temps de démarrage la première fois qu’une page est demandée une fois que le site est publié.</span><span class="sxs-lookup"><span data-stu-id="59d30-274">It can reduce startup time the first time a page is requested after the site is published.</span></span>

    <span data-ttu-id="59d30-275">Vous n’avez pas besoin de supprimer les fichiers supplémentaires dans la mesure où votre premier déploiement il n’est tous les fichiers dans le dossier de destination encore.</span><span class="sxs-lookup"><span data-stu-id="59d30-275">You don't need to remove additional files since this is your first deployment and there won't be any files in the destination folder yet.</span></span>

    > [!NOTE] 
    > <span data-ttu-id="59d30-276">Si vous sélectionnez **supprimer les fichiers supplémentaires à la destination** pour un déploiement suivant sur le même site, assurez-vous que vous utilisez la fonctionnalité d’aperçu que vous voyez à l’avance quels fichiers seront supprimés avant de déployer.</span><span class="sxs-lookup"><span data-stu-id="59d30-276">If you select **Remove additional files at destination** for a subsequent deployment to the same site, make sure that you use the preview feature so that you see in advance which files will be deleted before you deploy.</span></span> <span data-ttu-id="59d30-277">Le comportement attendu est que Web Deploy entraînera la suppression les fichiers sur le serveur de destination que vous avez supprimées dans votre projet.</span><span class="sxs-lookup"><span data-stu-id="59d30-277">The expected behavior is that Web Deploy will delete files on the destination server that you have deleted in your project.</span></span> <span data-ttu-id="59d30-278">Toutefois, la structure de la totalité du dossier sous les dossiers source et de destination est comparée ; et, dans certains scénarios, Web Deploy peut supprimer des fichiers que vous ne souhaitez pas supprimer.</span><span class="sxs-lookup"><span data-stu-id="59d30-278">However, the entire folder structure under the source and destination folders is compared; and in some scenarios, Web Deploy might delete files you don't want to delete.</span></span>
    > 
    > <span data-ttu-id="59d30-279">Par exemple si vous disposez d’une application web dans un sous-dossier sur le serveur lorsque vous déployez un projet dans le dossier racine, le sous-dossier sera supprimé.</span><span class="sxs-lookup"><span data-stu-id="59d30-279">For example if you have a web application in a subfolder on the server when you deploy a project to the root folder, the subfolder will be deleted.</span></span> <span data-ttu-id="59d30-280">Vous pouvez avoir un projet pour le site principal chez contoso.com et un autre projet pour un blog sur contoso.com/blog.</span><span class="sxs-lookup"><span data-stu-id="59d30-280">You might have one project for the main site at contoso.com and another project for a blog at contoso.com/blog.</span></span> <span data-ttu-id="59d30-281">L’application de blog est dans un sous-dossier.</span><span class="sxs-lookup"><span data-stu-id="59d30-281">The blog application is in a subfolder.</span></span> <span data-ttu-id="59d30-282">Si vous sélectionnez **supprimer les fichiers supplémentaires à la destination** lorsque vous déployez le site principal, l’application de blog est supprimée.</span><span class="sxs-lookup"><span data-stu-id="59d30-282">If you select **Remove additional files at destination** when you deploy the main site, the blog application will be deleted.</span></span>
    > 
    > <span data-ttu-id="59d30-283">Pour un autre exemple, votre application\_dossier de données peut-être être supprimé de manière inattendue.</span><span class="sxs-lookup"><span data-stu-id="59d30-283">For another example, your App\_Data folder might get deleted unexpectedly.</span></span> <span data-ttu-id="59d30-284">Certaines bases de données telles que SQL Server Compact stockent les fichiers de base de données dans l’application\_dossier de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-284">Certain databases such as SQL Server Compact store database files in the App\_Data folder.</span></span> <span data-ttu-id="59d30-285">Après le déploiement initial, vous ne souhaitez conserver copie des fichiers de base de données dans les déploiements suivants, afin de **application exclure\_données** sous l’onglet Package/Publication Web. Une fois que vous le faites qu’en cas avoir **supprimer les fichiers supplémentaires à la destination** sélectionné, vos fichiers de base de données et de l’application\_dossier de données lui-même sera supprimé la prochaine fois que vous publiez.</span><span class="sxs-lookup"><span data-stu-id="59d30-285">After the initial deployment, you don't want to keep copying the database files in subsequent deployments, so you select  **Exclude App\_Data** on the Package/Publish Web tab. After you do that if you have **Remove additional files at destination** selected, your database files and the App\_Data folder itself will be deleted the next time you publish.</span></span>

### <a name="configure-deployment-for-the-membership-database"></a><span data-ttu-id="59d30-286">Configurer le déploiement de la base de données d’appartenance</span><span class="sxs-lookup"><span data-stu-id="59d30-286">Configure deployment for the membership database</span></span>

<span data-ttu-id="59d30-287">Les étapes suivantes s’appliquent à la **DefaultConnection** base de données dans la boîte de dialogue **bases de données** section.</span><span class="sxs-lookup"><span data-stu-id="59d30-287">The following steps apply to the **DefaultConnection** database in the dialog box's **Databases** section.</span></span>

1. <span data-ttu-id="59d30-288">Dans le **chaîne de connexion à distance** , entrez la chaîne de connexion qui pointe vers la nouvelle base de l’appartenance de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="59d30-288">In the **Remote connection string** box, enter the following connection string that points to the new SQL Server Express membership database.</span></span>

   [!code-console[Main](deploying-to-iis/samples/sample3.cmd)]

   <span data-ttu-id="59d30-289">Le processus de déploiement place cette chaîne de connexion dans le fichier Web.config déployé, car **utiliser cette chaîne de connexion lors de l’exécution** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="59d30-289">The deployment process puts this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

    <span data-ttu-id="59d30-290">Vous pouvez également obtenir la chaîne de connexion **Explorateur de serveurs**.</span><span class="sxs-lookup"><span data-stu-id="59d30-290">You can also get the connection string from **Server Explorer**.</span></span> <span data-ttu-id="59d30-291">Dans **Explorateur de serveurs**, développez **des connexions de données** et sélectionnez le  **&lt;machinename&gt;\sqlexpress.aspnet-ContosoUniversity** base de données, puis à partir de la **propriétés** copie de la fenêtre la **chaîne de connexion** valeur.</span><span class="sxs-lookup"><span data-stu-id="59d30-291">In **Server Explorer**, expand **Data Connections** and select the **&lt;machinename&gt;\sqlexpress.aspnet-ContosoUniversity** database, then from the **Properties** window copy the **Connection String** value.</span></span> <span data-ttu-id="59d30-292">Qu’un seul paramètre supplémentaire que vous pouvez supprimer dans la chaîne de connexion : `Pooling=False`.</span><span class="sxs-lookup"><span data-stu-id="59d30-292">That connection string will have one additional setting that you can delete: `Pooling=False`.</span></span>

2. <span data-ttu-id="59d30-293">Sélectionnez **base de données de mise à jour**.</span><span class="sxs-lookup"><span data-stu-id="59d30-293">Select **Update database**.</span></span>

   <span data-ttu-id="59d30-294">Par conséquent, le schéma de base de données à créer dans la base de données de destination pendant le déploiement.</span><span class="sxs-lookup"><span data-stu-id="59d30-294">This causes the database schema to be created in the destination database during deployment.</span></span> <span data-ttu-id="59d30-295">Dans les étapes suivantes, vous spécifiez des scripts supplémentaires dont vous avez besoin pour exécuter : une pour accorder l’accès de base de données vers le pool d’applications par défaut et pour déployer des données.</span><span class="sxs-lookup"><span data-stu-id="59d30-295">In next steps, you specify the additional scripts that you need to run: one to grant database access to the default application pool and one to deploy data.</span></span>

3. <span data-ttu-id="59d30-296">Sélectionnez **configurer des mises à jour de la base de données**.</span><span class="sxs-lookup"><span data-stu-id="59d30-296">Select **Configure database updates**.</span></span>
 
4. <span data-ttu-id="59d30-297">Dans le **configurer les mises à jour de base de données** boîte de dialogue, sélectionnez **ajouter un Script SQL**.</span><span class="sxs-lookup"><span data-stu-id="59d30-297">In the **Configure Database Updates** dialog box, select **Add SQL Script**.</span></span> <span data-ttu-id="59d30-298">Accédez à la *Grant.sql* script que vous avez enregistré précédemment dans le dossier de solution.</span><span class="sxs-lookup"><span data-stu-id="59d30-298">Navigate to the *Grant.sql* script that you saved earlier in the solution folder.</span></span>

5. <span data-ttu-id="59d30-299">Répétez le processus pour ajouter le *aspnet-data-dev.sql* script.</span><span class="sxs-lookup"><span data-stu-id="59d30-299">Repeat the process to add the *aspnet-data-dev.sql* script.</span></span>

   ![Configurer les mises à jour de la base de données pour la base de données d’appartenance](deploying-to-iis/_static/image16.png)

6. <span data-ttu-id="59d30-301">Sélectionnez **Fermer**.</span><span class="sxs-lookup"><span data-stu-id="59d30-301">Select **Close**.</span></span>

### <a name="configure-deployment-for-the-application-database"></a><span data-ttu-id="59d30-302">Configurer le déploiement de la base de données d’application</span><span class="sxs-lookup"><span data-stu-id="59d30-302">Configure deployment for the application database</span></span>

<span data-ttu-id="59d30-303">Lorsque Visual Studio détecte un Entity Framework `DbContext` (classe), il crée une entrée dans le **bases de données** section a un **Execute Code First Migrations** au lieu de case à cocher une  **Mettre à jour de la base de données** case à cocher.</span><span class="sxs-lookup"><span data-stu-id="59d30-303">When Visual Studio detects an Entity Framework `DbContext` class, it creates an entry in the **Databases** section that has an **Execute Code First Migrations** check box instead of an **Update Database** check box.</span></span> <span data-ttu-id="59d30-304">Pour ce didacticiel, vous utiliserez cette case à cocher pour spécifier le déploiement de Migrations Code First.</span><span class="sxs-lookup"><span data-stu-id="59d30-304">For this tutorial, you'll use that check box to specify Code First Migrations deployment.</span></span>

<span data-ttu-id="59d30-305">Dans certains scénarios, vous utilisez peut-être un `DbContext` base de données mais que vous souhaitez utiliser le fournisseur dbDacFx au lieu de Migrations pour déployer la base de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-305">In some scenarios, you might be using a `DbContext` database but you want to use the dbDacFx provider instead of Migrations to deploy the database.</span></span> <span data-ttu-id="59d30-306">Dans ce cas, consultez [comment déployer une base de données Code First sans Migrations ?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) dans le Forum aux questions de déploiement Web ASP.NET sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="59d30-306">In that case, see [How do I deploy a Code First database without Migrations?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) in the ASP.NET Web Deployment FAQ on MSDN.</span></span>

<span data-ttu-id="59d30-307">Les étapes suivantes s’appliquent à la **SchoolContext** base de données dans la boîte de dialogue **bases de données** section.</span><span class="sxs-lookup"><span data-stu-id="59d30-307">The following steps apply to the **SchoolContext** database in the dialog box's **Databases** section.</span></span>

1. <span data-ttu-id="59d30-308">Dans le **chaîne de connexion à distance** , entrez la chaîne de connexion qui pointe vers la nouvelle base d’application SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="59d30-308">In the **Remote connection string** box, enter the following connection string that points to the new SQL Server Express application database.</span></span>

   [!code-console[Main](deploying-to-iis/samples/sample4.cmd)]

   <span data-ttu-id="59d30-309">Le processus de déploiement place cette chaîne de connexion dans le fichier Web.config déployé, car **utiliser cette chaîne de connexion lors de l’exécution** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="59d30-309">The deployment process puts this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

   <span data-ttu-id="59d30-310">Vous pouvez également obtenir la chaîne de connexion de base de données application **Explorateur de serveurs** de la même façon, vous avez obtenu la chaîne de connexion de base de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="59d30-310">You can also get the application database connection string from **Server Explorer** in the same way you got the membership database connection string.</span></span>

2. <span data-ttu-id="59d30-311">Sélectionnez **exécuter les Migrations Code First (s’exécute sur le démarrage de l’application)**.</span><span class="sxs-lookup"><span data-stu-id="59d30-311">Select **Execute Code First Migrations (runs on application start)**.</span></span>

   <span data-ttu-id="59d30-312">Cette option provoque le processus de déploiement configurer le fichier Web.config déployé pour spécifier le `MigrateDatabaseToLatestVersion` initialiseur.</span><span class="sxs-lookup"><span data-stu-id="59d30-312">This option causes the deployment process to configure the deployed Web.config file to specify the `MigrateDatabaseToLatestVersion` initializer.</span></span> <span data-ttu-id="59d30-313">Cet initialiseur met automatiquement à jour la base de données vers la dernière version lors de l’application accède à la base de données pour la première fois après le déploiement.</span><span class="sxs-lookup"><span data-stu-id="59d30-313">This initializer automatically updates the database to the latest version when the application accesses the database for the first time after deployment.</span></span>

### <a name="configure-publish-profile-transforms"></a><span data-ttu-id="59d30-314">Configurer des transformations de profil de publication</span><span class="sxs-lookup"><span data-stu-id="59d30-314">Configure publish profile transforms</span></span>

1. <span data-ttu-id="59d30-315">Sélectionnez **Fermer**.</span><span class="sxs-lookup"><span data-stu-id="59d30-315">Select **Close**.</span></span> <span data-ttu-id="59d30-316">Sélectionnez **Oui** lorsque le système vous demande si vous souhaitez enregistrer les modifications.</span><span class="sxs-lookup"><span data-stu-id="59d30-316">Select **Yes** when you are asked if you want to save changes.</span></span>

2. <span data-ttu-id="59d30-317">Dans **l’Explorateur de solutions**, développez **propriétés**, développez **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="59d30-317">In **Solution Explorer**, expand **Properties**, expand **PublishProfiles**.</span></span>

3. <span data-ttu-id="59d30-318">Avec le bouton droit *CustomProfile.pubxml* et renommez-le *Test.pubxml*.</span><span class="sxs-lookup"><span data-stu-id="59d30-318">Right-click *CustomProfile.pubxml* and rename it *Test.pubxml*.</span></span>

4. <span data-ttu-id="59d30-319">Avec le bouton droit *Test.pubxml*.</span><span class="sxs-lookup"><span data-stu-id="59d30-319">Right-click *Test.pubxml*.</span></span> <span data-ttu-id="59d30-320">Sélectionnez **ajouter une transformation de Config**.</span><span class="sxs-lookup"><span data-stu-id="59d30-320">Select **Add Config Transform**.</span></span>

   ![Ajouter un menu de transformation de configuration](deploying-to-iis/_static/image17.png)

   <span data-ttu-id="59d30-322">Visual Studio crée le *Web.Test.config* fichier de transformation et l’ouvre.</span><span class="sxs-lookup"><span data-stu-id="59d30-322">Visual Studio creates the *Web.Test.config* transform file and opens it.</span></span>

5. <span data-ttu-id="59d30-323">Dans le *Web.Test.config* de transformer le fichier, insérez le code suivant immédiatement après l’ouverture balise de configuration.</span><span class="sxs-lookup"><span data-stu-id="59d30-323">In the *Web.Test.config* transform file, insert the following code immediately after the opening configuration tag.</span></span>

   [!code-xml[Main](deploying-to-iis/samples/sample5.xml)]

    <span data-ttu-id="59d30-324">Lorsque vous utilisez le Test de profil de publication, cette transformation permet de définir l’indicateur d’environnement à « Test ».</span><span class="sxs-lookup"><span data-stu-id="59d30-324">When you use the Test publish profile, this transform sets the environment indicator to "Test".</span></span> <span data-ttu-id="59d30-325">Dans le site déployé, vous voyez « (Test) » après le titre H1 de « Contoso University ».</span><span class="sxs-lookup"><span data-stu-id="59d30-325">In the deployed site, you'll see "(Test)" after the "Contoso University" H1 heading.</span></span>

6. <span data-ttu-id="59d30-326">Enregistrez et fermez le fichier.</span><span class="sxs-lookup"><span data-stu-id="59d30-326">Save and close the file.</span></span>

7. <span data-ttu-id="59d30-327">Avec le bouton droit le *Web.Test.config* fichier et sélectionnez **aperçu transformer** pour vous assurer que la transformation que vous avez codée produit les modifications attendues.</span><span class="sxs-lookup"><span data-stu-id="59d30-327">Right-click the *Web.Test.config* file and select **Preview Transform** to make sure that the transform you coded produces the expected changes.</span></span>

    <span data-ttu-id="59d30-328">Le **Web.config aperçu** fenêtre affiche le résultat de l’appliquer à la fois le *Web.Release.config* transforme et *Web.Test.config* transforme.</span><span class="sxs-lookup"><span data-stu-id="59d30-328">The **Web.config Preview** window shows the result of applying both the *Web.Release.config* transforms and the *Web.Test.config* transforms.</span></span>

### <a name="preview-the-deployment-updates"></a><span data-ttu-id="59d30-329">Afficher un aperçu du déploiement de mises à jour</span><span class="sxs-lookup"><span data-stu-id="59d30-329">Preview the deployment updates</span></span>

1. <span data-ttu-id="59d30-330">Ouvrez le **publier le site Web** Assistant à nouveau (cliquez sur le projet ContosoUniversity, sélectionnez **publier**, puis **aperçu**).</span><span class="sxs-lookup"><span data-stu-id="59d30-330">Open the **Publish Web** wizard again (right-click the ContosoUniversity project, select **Publish**, then **Preview**).</span></span>

2. <span data-ttu-id="59d30-331">Dans le **aperçu** boîte de dialogue, sélectionnez **démarrer l’aperçu** pour afficher la liste des fichiers qui seront copiés.</span><span class="sxs-lookup"><span data-stu-id="59d30-331">In the **Preview** dialog box, select **Start Preview** to see a list of the files that will be copied.</span></span> 

   ![Aperçu de la publication](deploying-to-iis/_static/image29.png)

   <span data-ttu-id="59d30-333">Vous pouvez également sélectionner le **base de données de la version préliminaire** lien pour afficher les scripts qui seront exécute dans la base de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="59d30-333">You can also select the **Preview database** link to see the scripts that will run in the membership database.</span></span> <span data-ttu-id="59d30-334">(Aucune scripts ne sont exécutés pour le déploiement de Migrations Code First, donc rien pour afficher un aperçu de la base de données d’application.)</span><span class="sxs-lookup"><span data-stu-id="59d30-334">(No scripts are run for Code First Migrations deployment, so there's nothing to preview for the application database.)</span></span>

3. <span data-ttu-id="59d30-335">Sélectionnez **Publier**.</span><span class="sxs-lookup"><span data-stu-id="59d30-335">Select **Publish**.</span></span>

   <span data-ttu-id="59d30-336">Si Visual Studio n’est pas en mode administrateur, vous pouvez obtenir un message d’erreur des autorisations.</span><span class="sxs-lookup"><span data-stu-id="59d30-336">If Visual Studio is not in administrator mode, you might get a permissions error message.</span></span> <span data-ttu-id="59d30-337">Dans ce cas, fermez Visual Studio, ouvrez-le en mode administrateur et réessayez la publication.</span><span class="sxs-lookup"><span data-stu-id="59d30-337">In that case, close Visual Studio, open it in administrator mode, and try to publish again.</span></span>

   <span data-ttu-id="59d30-338">Si Visual Studio est en mode administrateur, le **sortie** rapports réussie de la fenêtre générer et publier.</span><span class="sxs-lookup"><span data-stu-id="59d30-338">If Visual Studio is in administrator mode, the **Output** window reports successful build and publish.</span></span>

   ![Output_window_publish_Test](deploying-to-iis/_static/image20.png)

   <span data-ttu-id="59d30-340">Si vous avez entré l’URL dans le **URL de Destination** boîte sur le profil de publication **connexion** onglet, le navigateur s’ouvre automatiquement à la page d’accueil de l’Université de Contoso s’exécutant dans IIS sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="59d30-340">If you entered the URL in the **Destination URL** box on the publish profile **Connection** tab, the browser automatically opens to the Contoso University Home page running in IIS on your computer.</span></span>

## <a name="test-in-the-test-environment"></a><span data-ttu-id="59d30-341">Tester dans l’environnement de test</span><span class="sxs-lookup"><span data-stu-id="59d30-341">Test in the test environment</span></span>

<span data-ttu-id="59d30-342">Notez que l’indicateur de l’environnement affiche « (Test) » au lieu de « (Dev) », qui montre que le *Web.config* transformation pour l’indicateur de l’environnement a réussi.</span><span class="sxs-lookup"><span data-stu-id="59d30-342">Notice that the environment indicator shows "(Test)" instead of "(Dev)," which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

<span data-ttu-id="59d30-343">Exécutez le **formateurs** page pour vérifier que le premier Code amorcée avec des données de l’instructeur.</span><span class="sxs-lookup"><span data-stu-id="59d30-343">Run the **Instructors** page to verify that Code First seeded the database with instructor data.</span></span> <span data-ttu-id="59d30-344">Lorsque vous sélectionnez cette page, il peut prendre quelques minutes à charger, car le Code First crée la base de données, puis exécute le `Seed` (méthode).</span><span class="sxs-lookup"><span data-stu-id="59d30-344">When you select this page, it may take a few minutes to load because Code First creates the database and then runs the `Seed` method.</span></span> <span data-ttu-id="59d30-345">(Il n’a pas le faire quand vous étiez sur la page d’accueil, car l’application n’a pas tenter d’accéder à la base de données encore.)</span><span class="sxs-lookup"><span data-stu-id="59d30-345">(It didn't do that when you were on the home page because the application didn't try to access the database yet.)</span></span>

<span data-ttu-id="59d30-346">Sélectionnez le **étudiants** onglet pour vérifier ne qu’aucun étudiant à la base de données déployée.</span><span class="sxs-lookup"><span data-stu-id="59d30-346">Select the **Students** tab to verify that the deployed database has no students.</span></span>

<span data-ttu-id="59d30-347">Sélectionnez **étudiants ajouter** à partir de la **étudiants** menu.</span><span class="sxs-lookup"><span data-stu-id="59d30-347">Select **Add Students** from the **Students** menu.</span></span> <span data-ttu-id="59d30-348">Ajouter un étudiant et afficher le nouvel étudiant dans la **étudiants** page.</span><span class="sxs-lookup"><span data-stu-id="59d30-348">Add a student, and then view the new student in the **Students** page.</span></span> <span data-ttu-id="59d30-349">Cela permet de vérifier que vous pouvez écrire avec succès à la base de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-349">This verifies that you can successfully write to the database.</span></span>

<span data-ttu-id="59d30-350">À partir de la **cours** menu, sélectionnez **crédits de la mise à jour**.</span><span class="sxs-lookup"><span data-stu-id="59d30-350">From the **Courses** menu, select **Update Credits**.</span></span> <span data-ttu-id="59d30-351">Le **crédits de la mise à jour** page requiert des autorisations d’administrateur, par conséquent, le **Log In** page s’affiche.</span><span class="sxs-lookup"><span data-stu-id="59d30-351">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="59d30-352">Entrez les informations d’identification du compte administrateur que vous avez créé plus haut (« admin » et « devpwd »).</span><span class="sxs-lookup"><span data-stu-id="59d30-352">Enter the administrator account credentials that you created earlier ("admin" and "devpwd").</span></span> <span data-ttu-id="59d30-353">Le **mise à jour crédits** page s’affiche.</span><span class="sxs-lookup"><span data-stu-id="59d30-353">The **Update Credits** page is displayed.</span></span> <span data-ttu-id="59d30-354">Cela vérifie que le compte d’administrateur que vous avez créé dans le didacticiel précédent a été correctement déployé sur l’environnement de test.</span><span class="sxs-lookup"><span data-stu-id="59d30-354">This verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="59d30-355">Vérifiez qu’un *ELMAH* dossier existe dans le *c:\inetpub\wwwroot\ContosoUniversity* dossier avec uniquement le fichier d’espace réservé qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="59d30-355">Verify that an *ELMAH* folder exists in the *c:\inetpub\wwwroot\ContosoUniversity* folder with only the placeholder file in it.</span></span>

<a id="reviewingmigrations"></a>

## <a name="review-the-automatic-webconfig-changes-for-code-first-migrations"></a><span data-ttu-id="59d30-356">Passez en revue les modifications de Web.config automatique pour les Migrations Code First</span><span class="sxs-lookup"><span data-stu-id="59d30-356">Review the automatic Web.config changes for Code First Migrations</span></span>

<span data-ttu-id="59d30-357">Ouvrez le *Web.config* fichier dans l’application déployée sur *C:\inetpub\wwwroot\ContosoUniversity* et vous pouvez voir où le processus de déploiement configuré Migrations Code First pour automatiquement mettre à jour la base de données vers la dernière version.</span><span class="sxs-lookup"><span data-stu-id="59d30-357">Open the *Web.config* file in the deployed application at *C:\inetpub\wwwroot\ContosoUniversity* and you can see where the deployment process configured Code First Migrations to automatically update the database to the latest version.</span></span>

![](deploying-to-iis/_static/image21.png)

<span data-ttu-id="59d30-358">Le processus de déploiement créé également une nouvelle chaîne de connexion pour les Migrations Code First à utiliser exclusivement pour la mise à jour le schéma de base de données :</span><span class="sxs-lookup"><span data-stu-id="59d30-358">The deployment process also created a new connection string for Code First Migrations to use exclusively for updating the database schema:</span></span>

![Chaîne de connexion Database_Publish](deploying-to-iis/_static/image22.png)

<span data-ttu-id="59d30-360">Cette chaîne de connexion supplémentaires vous permet de spécifier un compte d’utilisateur pour les mises à jour du schéma de base de données et un autre compte d’utilisateur pour l’accès de données d’application.</span><span class="sxs-lookup"><span data-stu-id="59d30-360">This additional connection string enables you to specify one user account for database schema updates and a different user account for application data access.</span></span> <span data-ttu-id="59d30-361">Par exemple, vous pouvez attribuer le **db\_propriétaire** rôle pour les Migrations Code First et **db\_datareader** avec **db\_datawriter**rôles à l’application.</span><span class="sxs-lookup"><span data-stu-id="59d30-361">For example, you could assign the **db\_owner** role to Code First Migrations and **db\_datareader** with **db\_datawriter** roles to the application.</span></span> <span data-ttu-id="59d30-362">Il s’agit d’un modèle courant dans défense qui empêche le code potentiellement malveillant dans l’application à partir de la modification du schéma de base de données.</span><span class="sxs-lookup"><span data-stu-id="59d30-362">This is a common defense-in-depth pattern that prevents potentially malicious code in the application from changing the database schema.</span></span> <span data-ttu-id="59d30-363">(Par exemple, cela peut se produire dans une attaque d’injection SQL.) Ces didacticiels n’utilisent pas ce modèle.</span><span class="sxs-lookup"><span data-stu-id="59d30-363">(For example, this might happen in a successful SQL injection attack.) These tutorials don't use this pattern.</span></span> <span data-ttu-id="59d30-364">Pour implémenter ce modèle dans votre scénario, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="59d30-364">To implement this pattern in your scenario, take these steps:</span></span>

1. <span data-ttu-id="59d30-365">Dans le **publier le site Web** Assistant sous les **paramètres** , entrez la chaîne de connexion qui spécifie un utilisateur avec les autorisations de mise à jour de schéma de base de données complète.</span><span class="sxs-lookup"><span data-stu-id="59d30-365">In the **Publish Web** wizard under the **Settings** tab, enter the connection string that specifies a user with full database schema update permissions.</span></span> <span data-ttu-id="59d30-366">Effacer la **utiliser cette chaîne de connexion lors de l’exécution** case à cocher.</span><span class="sxs-lookup"><span data-stu-id="59d30-366">Clear the **Use this connection string at runtime** check box.</span></span> <span data-ttu-id="59d30-367">Dans le fichier Web.config déployé, cela devient le `DatabasePublish` chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="59d30-367">In the deployed Web.config file, this becomes the `DatabasePublish` connection string.</span></span>

2. <span data-ttu-id="59d30-368">Créer une transformation du fichier Web.config pour la chaîne de connexion que vous souhaitez que l’application à utiliser au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="59d30-368">Create a Web.config file transformation for the connection string that you want the application to use at run time.</span></span>

## <a name="summary"></a><span data-ttu-id="59d30-369">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="59d30-369">Summary</span></span>

<span data-ttu-id="59d30-370">Vous avez maintenant déployé votre application à IIS sur votre ordinateur de développement et testée il.</span><span class="sxs-lookup"><span data-stu-id="59d30-370">You've now deployed your application to IIS on your development computer and tested it there.</span></span>

![Page d’accueil dans le Test](deploying-to-iis/_static/image23.png)

<span data-ttu-id="59d30-372">Cela vérifie que le processus de déploiement copié le contenu de l’application vers l’emplacement approprié (à l’exclusion de fichiers que vous ne voulez pas déployer) et également que Web Deploy IIS correctement configuré pendant le déploiement.</span><span class="sxs-lookup"><span data-stu-id="59d30-372">This verifies that the deployment process copied the application's content to the right location (excluding the files that you did not want to deploy) and also that Web Deploy configured IIS correctly during deployment.</span></span> <span data-ttu-id="59d30-373">Dans le didacticiel suivant, vous allez exécuter un test supplémentaire qui recherche une tâche de déploiement qui n’a pas encore été effectuée : définition des autorisations de dossier sur le *Elm ah* dossier.</span><span class="sxs-lookup"><span data-stu-id="59d30-373">In the next tutorial, you'll run one more test that finds a deployment task that has not yet been done: setting folder permissions on the *Elm ah* folder.</span></span>

## <a name="more-information"></a><span data-ttu-id="59d30-374">Complément d'information</span><span class="sxs-lookup"><span data-stu-id="59d30-374">More information</span></span>

<span data-ttu-id="59d30-375">Pour plus d’informations sur l’exécution d’IIS ou IIS Express dans Visual Studio, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="59d30-375">For information about running IIS or IIS Express in Visual Studio, see the following resources:</span></span>

- <span data-ttu-id="59d30-376">[Présentation d’IIS Express](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) sur le site IIS.net.</span><span class="sxs-lookup"><span data-stu-id="59d30-376">[IIS Express Overview](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) on the IIS.net site.</span></span>
- <span data-ttu-id="59d30-377">[Présentation d’IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) sur le blog Guthrie.</span><span class="sxs-lookup"><span data-stu-id="59d30-377">[Introducing IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) on Scott Guthrie's blog.</span></span>
- <span data-ttu-id="59d30-378">[Web des serveurs dans Visual Studio pour les projets Web ASP.NET](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span><span class="sxs-lookup"><span data-stu-id="59d30-378">[Web Servers in Visual Studio for ASP.NET Web Projects](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span></span>
- <span data-ttu-id="59d30-379">[Principales différences entre IIS et le serveur de développement ASP.NET](../../older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) sur le site ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="59d30-379">[Core Differences Between IIS and the ASP.NET Development Server](../../older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) on the ASP.NET site.</span></span>

<span data-ttu-id="59d30-380">Pour plus d’informations sur les problèmes pouvant survenir lorsque votre application s’exécute en mode de confiance moyenne, consultez [hébergeant les Applications ASP.NET en mode de confiance moyenne](http://www.4guysfromrolla.com/articles/100307-1.aspx) sur les quatre Guys Rolla site.</span><span class="sxs-lookup"><span data-stu-id="59d30-380">For information about what issues might arise when your application runs in medium trust, see [Hosting ASP.NET Applications in Medium Trust](http://www.4guysfromrolla.com/articles/100307-1.aspx) on the four Guys from Rolla site.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="59d30-381">[Précédent](project-properties.md)
> [Suivant](setting-folder-permissions.md)</span><span class="sxs-lookup"><span data-stu-id="59d30-381">[Previous](project-properties.md)
[Next](setting-folder-permissions.md)</span></span>
