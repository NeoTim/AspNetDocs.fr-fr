---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
title: Tri des données dans un contrôle DataList ou Repeater (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons examiner comment inclure la prise en charge du tri dans le contrôle DataList et Repeater, ainsi que comment construire un contrôle DataList ou Repeater dont les données peuvent...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: 97c13898-0741-45f9-b3fa-7540ab1679e6
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 81e07bec8569b9ee987dfaa84dec9eec95a2692f
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74638533"
---
# <a name="sorting-data-in-a-datalist-or-repeater-control-vb"></a><span data-ttu-id="dde5c-103">Tri des données dans un contrôle DataList ou Repeater (VB)</span><span class="sxs-lookup"><span data-stu-id="dde5c-103">Sorting Data in a DataList or Repeater Control (VB)</span></span>

<span data-ttu-id="dde5c-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="dde5c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="dde5c-105">[Télécharger l’exemple d’application](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) ou [Télécharger le PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="dde5c-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span></span>

> <span data-ttu-id="dde5c-106">Dans ce didacticiel, nous allons examiner comment inclure la prise en charge du tri dans le contrôle DataList et Repeater, ainsi que comment construire un contrôle DataList ou Repeater dont les données peuvent être paginées et triées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="introduction"></a><span data-ttu-id="dde5c-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="dde5c-107">Introduction</span></span>

<span data-ttu-id="dde5c-108">Dans le [didacticiel précédent](paging-report-data-in-a-datalist-or-repeater-control-vb.md) , nous avons examiné comment ajouter la prise en charge de la pagination à un contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="dde5c-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="dde5c-109">Nous avons créé une nouvelle méthode dans la classe `ProductsBLL` (`GetProductsAsPagedDataSource`) qui a retourné un objet `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="dde5c-110">Lorsqu’il est lié à un contrôle DataList ou Repeater, le contrôle DataList ou Repeater affiche uniquement la page de données demandée.</span><span class="sxs-lookup"><span data-stu-id="dde5c-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="dde5c-111">Cette technique est similaire à ce qui est utilisé en interne par les contrôles GridView, DetailsView et FormView pour fournir leurs fonctionnalités de pagination par défaut intégrées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="dde5c-112">Outre la prise en charge de la pagination, le GridView offre également une prise en charge de tri prête à l’emploi.</span><span class="sxs-lookup"><span data-stu-id="dde5c-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="dde5c-113">Ni DataList ni Repeater ne fournissent des fonctionnalités de tri intégrées. Toutefois, les fonctionnalités de tri peuvent être ajoutées à l’aide d’un peu de code.</span><span class="sxs-lookup"><span data-stu-id="dde5c-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="dde5c-114">Dans ce didacticiel, nous allons examiner comment inclure la prise en charge du tri dans le contrôle DataList et Repeater, ainsi que comment construire un contrôle DataList ou Repeater dont les données peuvent être paginées et triées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="dde5c-115">Révision du tri</span><span class="sxs-lookup"><span data-stu-id="dde5c-115">A Review of Sorting</span></span>

<span data-ttu-id="dde5c-116">Comme nous l’avons vu dans le didacticiel sur les [données de rapport de pagination et de tri](../paging-and-sorting/paging-and-sorting-report-data-vb.md) , le contrôle GridView fournit une prise en charge de tri prête à l’emploi.</span><span class="sxs-lookup"><span data-stu-id="dde5c-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="dde5c-117">Chaque champ GridView peut avoir un `SortExpression`associé, qui indique le champ de données selon lequel trier les données.</span><span class="sxs-lookup"><span data-stu-id="dde5c-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="dde5c-118">Lorsque la propriété GridView s `AllowSorting` a la valeur `true`, chaque champ GridView qui a une valeur de propriété `SortExpression` a son en-tête rendu en tant que LinkButton.</span><span class="sxs-lookup"><span data-stu-id="dde5c-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="dde5c-119">Lorsqu’un utilisateur clique sur un en-tête de champ GridView particulier, une publication (postback) se produit et les données sont triées en fonction du ou des champs `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="dde5c-120">Le contrôle GridView possède également une propriété `SortExpression`, qui stocke le `SortExpression` du champ GridView par lequel les données sont triées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="dde5c-121">En outre, une propriété de `SortDirection` indique si les données doivent être triées dans l’ordre croissant ou décroissant (si un utilisateur clique deux fois sur un lien de l’en-tête du champ GridView particulier, l’ordre de tri est basculé).</span><span class="sxs-lookup"><span data-stu-id="dde5c-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="dde5c-122">Lorsque le GridView est lié à son contrôle de source de données, il transmet ses propriétés `SortExpression` et `SortDirection` au contrôle de source de données.</span><span class="sxs-lookup"><span data-stu-id="dde5c-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="dde5c-123">Le contrôle de source de données récupère les données et les trie en fonction des propriétés `SortExpression` et `SortDirection` fournies.</span><span class="sxs-lookup"><span data-stu-id="dde5c-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="dde5c-124">Après le tri des données, le contrôle de source de données le retourne au GridView.</span><span class="sxs-lookup"><span data-stu-id="dde5c-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="dde5c-125">Pour répliquer cette fonctionnalité avec les contrôles DataList ou Repeater, nous devons :</span><span class="sxs-lookup"><span data-stu-id="dde5c-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="dde5c-126">Créer une interface de tri</span><span class="sxs-lookup"><span data-stu-id="dde5c-126">Create a sorting interface</span></span>
- <span data-ttu-id="dde5c-127">Mémoriser le champ de données à trier et s’il faut Trier par ordre croissant ou décroissant</span><span class="sxs-lookup"><span data-stu-id="dde5c-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="dde5c-128">Demander à ObjectDataSource de trier les données par un champ de données particulier</span><span class="sxs-lookup"><span data-stu-id="dde5c-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="dde5c-129">Nous allons aborder ces trois tâches dans les étapes 3 et 4.</span><span class="sxs-lookup"><span data-stu-id="dde5c-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="dde5c-130">Après cela, nous allons examiner comment inclure la prise en charge de la pagination et du tri dans un contrôle DataList ou Repeater.</span><span class="sxs-lookup"><span data-stu-id="dde5c-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="dde5c-131">Étape 2 : affichage des produits dans un répéteur</span><span class="sxs-lookup"><span data-stu-id="dde5c-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="dde5c-132">Avant de vous soucier de l’implémentation des fonctionnalités liées au tri, commençons par répertorier les produits dans un contrôle Repeater.</span><span class="sxs-lookup"><span data-stu-id="dde5c-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="dde5c-133">Commencez par ouvrir la page `Sorting.aspx` dans le dossier `PagingSortingDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="dde5c-134">Ajoutez un contrôle Repeater à la page Web, en affectant à sa propriété `ID` la valeur `SortableProducts`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="dde5c-135">À partir de la balise active de Repeater s, créez un nouvel ObjectDataSource nommé `ProductsDataSource` et configurez-le pour extraire les données de la méthode de `ProductsBLL` classe s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="dde5c-136">Sélectionnez l’option (aucune) dans les listes déroulantes des onglets insérer, mettre à jour et supprimer.</span><span class="sxs-lookup"><span data-stu-id="dde5c-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>

<span data-ttu-id="dde5c-137">[![créer un ObjectDataSource et le configurer pour utiliser la méthode GetProductsAsPagedDataSource ()](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="dde5c-138">**Figure 1**: créer un ObjectDataSource et le configurer pour qu’il utilise la méthode `GetProductsAsPagedDataSource()` ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span></span>

<span data-ttu-id="dde5c-139">[![définir les listes déroulantes dans les onglets mettre à jour, insérer et supprimer sur (aucun)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span></span>

<span data-ttu-id="dde5c-140">**Figure 2**: définir les listes déroulantes des onglets mettre à jour, insérer et supprimer sur (aucun) ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span></span>

<span data-ttu-id="dde5c-141">Contrairement à la DataList, Visual Studio ne crée pas automatiquement un `ItemTemplate` pour le contrôle Repeater après l’avoir lié à une source de données.</span><span class="sxs-lookup"><span data-stu-id="dde5c-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="dde5c-142">En outre, nous devons ajouter cette `ItemTemplate` de façon déclarative, car la balise active des contrôles Repeater ne dispose pas de l’option modifier les modèles figurant dans le contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="dde5c-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="dde5c-143">Nous utilisons les mêmes `ItemTemplate` que dans le didacticiel précédent, qui affichait le nom, le fournisseur et la catégorie du produit.</span><span class="sxs-lookup"><span data-stu-id="dde5c-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="dde5c-144">Après avoir ajouté le `ItemTemplate`, le balisage déclaratif Repeater et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="dde5c-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample1.aspx)]

<span data-ttu-id="dde5c-145">La figure 3 illustre cette page lorsque vous l’affichez dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-145">Figure 3 shows this page when viewed through a browser.</span></span>

<span data-ttu-id="dde5c-146">[![chaque nom, fournisseur et catégorie de produit est affiché](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="dde5c-147">**Figure 3**: chaque nom, fournisseur et catégorie de produit s’affiche ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span></span>

## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="dde5c-148">Étape 3 : demande au ObjectDataSource de trier les données</span><span class="sxs-lookup"><span data-stu-id="dde5c-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="dde5c-149">Pour trier les données affichées dans le Repeater, nous devons informer l’ObjectDataSource de l’expression de tri par laquelle les données doivent être triées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="dde5c-150">Avant que l’ObjectDataSource récupère ses données, il déclenche tout d’abord son [événement`Selecting`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), ce qui nous permet de spécifier une expression de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="dde5c-151">Le gestionnaire d’événements `Selecting` reçoit un objet de type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), qui a une propriété nommée [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) de type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span><span class="sxs-lookup"><span data-stu-id="dde5c-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="dde5c-152">La classe `DataSourceSelectArguments` est conçue pour passer des demandes liées aux données à partir d’un consommateur de données au contrôle de source de données, et comprend une [propriété`SortExpression`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span><span class="sxs-lookup"><span data-stu-id="dde5c-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="dde5c-153">Pour passer des informations de tri de la page ASP.NET à ObjectDataSource, créez un gestionnaire d’événements pour l’événement `Selecting` et utilisez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="dde5c-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample2.vb)]

<span data-ttu-id="dde5c-154">La valeur *SortExpression* doit être assignée au nom du champ de données pour trier les données (par exemple, ProductName).</span><span class="sxs-lookup"><span data-stu-id="dde5c-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="dde5c-155">Il n’existe pas de propriété relative au sens du tri. par conséquent, si vous souhaitez trier les données dans l’ordre décroissant, ajoutez la description de la chaîne à la valeur *SortExpression* (comme ProductName DESC).</span><span class="sxs-lookup"><span data-stu-id="dde5c-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="dde5c-156">Poursuivez et essayez des valeurs codées en dur différentes pour *SortExpression* et testez les résultats dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="dde5c-157">Comme le montre la figure 4, quand vous utilisez ProductName DESC comme *SortExpression*, les produits sont triés selon leur nom dans l’ordre alphabétique inversé.</span><span class="sxs-lookup"><span data-stu-id="dde5c-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="dde5c-158">[![les produits sont triés par leur nom dans l’ordre alphabétique inversé](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="dde5c-159">**Figure 4**: les produits sont triés selon leur nom dans l’ordre alphabétique inversé ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span></span>

## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="dde5c-160">Étape 4 : création de l’interface de tri et mémorisation de l’expression de tri et de la direction</span><span class="sxs-lookup"><span data-stu-id="dde5c-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="dde5c-161">L’activation de la prise en charge du tri dans le contrôle GridView convertit chaque texte d’en-tête des champs triable en un LinkButton qui, lorsque vous cliquez dessus, trie les données en conséquence.</span><span class="sxs-lookup"><span data-stu-id="dde5c-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="dde5c-162">Une telle interface de tri est logique pour le GridView, où ses données sont correctement présentées dans les colonnes.</span><span class="sxs-lookup"><span data-stu-id="dde5c-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="dde5c-163">Toutefois, pour les contrôles DataList et Repeater, une interface de tri différente est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="dde5c-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="dde5c-164">Une interface de tri courante pour une liste de données (par opposition à une grille de données) est une liste déroulante qui fournit les champs en fonction desquels les données peuvent être triées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="dde5c-165">Nous allons implémenter une telle interface pour ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="dde5c-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="dde5c-166">Ajoutez un contrôle Web DropDownList au-dessus du `SortableProducts` Repeater et affectez à sa propriété `ID` la valeur `SortBy`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="dde5c-167">Dans la Fenêtre Propriétés, cliquez sur les ellipses dans la propriété `Items` pour afficher l’éditeur de collections ListItem.</span><span class="sxs-lookup"><span data-stu-id="dde5c-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="dde5c-168">Ajoutez `ListItem` s pour trier les données à l’aide des champs `ProductName`, `CategoryName`et `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="dde5c-169">Ajoutez également un `ListItem` pour trier les produits par leur nom dans l’ordre alphabétique inversé.</span><span class="sxs-lookup"><span data-stu-id="dde5c-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="dde5c-170">Les propriétés `ListItem` `Text` peuvent être définies sur n’importe quelle valeur (par exemple, nom), mais les propriétés du `Value` doivent être définies sur le nom du champ de données (par exemple, ProductName).</span><span class="sxs-lookup"><span data-stu-id="dde5c-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="dde5c-171">Pour trier les résultats par ordre décroissant, ajoutez la description de la chaîne au nom du champ de données, comme ProductName DESC.</span><span class="sxs-lookup"><span data-stu-id="dde5c-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>

![Ajoutez un ListItem pour chacun des champs de données pouvant être triés](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)

<span data-ttu-id="dde5c-173">**Figure 5**: ajouter un `ListItem` pour chacun des champs de données pouvant être triés</span><span class="sxs-lookup"><span data-stu-id="dde5c-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>

<span data-ttu-id="dde5c-174">Enfin, ajoutez un contrôle Web Button à droite du contrôle DropDownList.</span><span class="sxs-lookup"><span data-stu-id="dde5c-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="dde5c-175">Définissez ses `ID` sur `RefreshRepeater` et sa propriété `Text` pour actualiser.</span><span class="sxs-lookup"><span data-stu-id="dde5c-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="dde5c-176">Après avoir créé le `ListItem` et ajouté le bouton actualiser, la syntaxe déclarative du bouton et de la DropDownList doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="dde5c-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample3.aspx)]

<span data-ttu-id="dde5c-177">Une fois le DropDownList de tri terminé, nous devons ensuite mettre à jour le gestionnaire d’événements ObjectDataSource s `Selecting` pour qu’il utilise la propriété `Value` `SortBy``ListItem` s sélectionnée par opposition à une expression de tri codée en dur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample4.vb)]

<span data-ttu-id="dde5c-178">À ce stade, lors de la première visite de la page, les produits sont triés initialement par le champ de données `ProductName`, car il s’agit de la `SortBy` `ListItem` sélectionnée par défaut (voir figure 6).</span><span class="sxs-lookup"><span data-stu-id="dde5c-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="dde5c-179">Si vous sélectionnez une option de tri différente, par exemple catégorie et que vous cliquez sur Actualiser, une publication (postback) est exécutée et les données sont à nouveau triées par nom de catégorie, comme illustré dans la figure 7.</span><span class="sxs-lookup"><span data-stu-id="dde5c-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>

<span data-ttu-id="dde5c-180">[![les produits sont triés initialement par leur nom](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span></span>

<span data-ttu-id="dde5c-181">**Figure 6**: les produits sont initialement triés par nom ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span></span>

<span data-ttu-id="dde5c-182">[![les produits sont désormais triés par catégorie](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span></span>

<span data-ttu-id="dde5c-183">**Figure 7**: les produits sont désormais triés par catégorie ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="dde5c-184">Si vous cliquez sur le bouton actualiser, les données sont automatiquement retriées, car l’état d’affichage de l’option Repeater s a été désactivé, ce qui amène le Repeater à effectuer une nouvelle liaison à sa source de données à chaque publication (postback).</span><span class="sxs-lookup"><span data-stu-id="dde5c-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="dde5c-185">Si vous laissez l’état d’affichage de Repeater s activé, la modification de la liste déroulante de tri n’a aucune incidence sur l’ordre de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won't have any affect on the sort order.</span></span> <span data-ttu-id="dde5c-186">Pour remédier à cela, créez un gestionnaire d’événements pour le bouton actualiser les `Click` événement et liez de nouveau le répéteur à sa source de données (en appelant la méthode Repeater s `DataBind()`).</span><span class="sxs-lookup"><span data-stu-id="dde5c-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>

## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="dde5c-187">Mémorisation de l’expression de tri et de la direction</span><span class="sxs-lookup"><span data-stu-id="dde5c-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="dde5c-188">Lors de la création d’un contrôle DataList ou Repeater pouvant être trié sur une page où des publications non liées à un tri peuvent se produire, il est impératif que l’expression de tri et la direction soient mémorisées entre les publications.</span><span class="sxs-lookup"><span data-stu-id="dde5c-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="dde5c-189">Par exemple, imaginez que nous avons mis à jour le Repeater dans ce didacticiel pour inclure un bouton supprimer avec chaque produit.</span><span class="sxs-lookup"><span data-stu-id="dde5c-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="dde5c-190">Quand l’utilisateur clique sur le bouton supprimer, nous allons exécuter du code pour supprimer le produit sélectionné, puis lier de nouveau les données au répéteur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="dde5c-191">Si les détails de tri ne sont pas rendus persistants sur la publication (postback), les données affichées à l’écran sont rétablies dans l’ordre de tri d’origine.</span><span class="sxs-lookup"><span data-stu-id="dde5c-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="dde5c-192">Pour ce didacticiel, le DropDownList enregistre implicitement l’expression de tri et le sens dans son état d’affichage pour nous.</span><span class="sxs-lookup"><span data-stu-id="dde5c-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="dde5c-193">Si nous avions utilisé une interface de tri différente avec, disons, LinkButtons qui fournissait les différentes options de tri, nous devons veiller à mémoriser l’ordre de tri entre les publications.</span><span class="sxs-lookup"><span data-stu-id="dde5c-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="dde5c-194">Cela peut être accompli en stockant les paramètres de tri dans l’état d’affichage de la page, en incluant le paramètre de tri dans la chaîne de chaîne ou via une autre technique de persistance de l’État.</span><span class="sxs-lookup"><span data-stu-id="dde5c-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="dde5c-195">Les exemples futurs de ce didacticiel explorent comment rendre les détails de tri persistants dans l’état d’affichage de la page.</span><span class="sxs-lookup"><span data-stu-id="dde5c-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="dde5c-196">Étape 5 : ajout de la prise en charge du tri à un contrôle DataList qui utilise la pagination par défaut</span><span class="sxs-lookup"><span data-stu-id="dde5c-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="dde5c-197">Dans le [didacticiel précédent](paging-report-data-in-a-datalist-or-repeater-control-vb.md) , nous avons examiné comment implémenter la pagination par défaut avec un contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="dde5c-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="dde5c-198">Nous allons étendre cet exemple précédent pour inclure la possibilité de trier les données paginées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="dde5c-199">Commencez par ouvrir les pages `SortingWithDefaultPaging.aspx` et `Paging.aspx` dans le dossier `PagingSortingDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="dde5c-200">Dans la page `Paging.aspx`, cliquez sur le bouton source pour afficher le balisage déclaratif de la page.</span><span class="sxs-lookup"><span data-stu-id="dde5c-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="dde5c-201">Copiez le texte sélectionné (voir figure 8) et collez-le dans le balisage déclaratif de `SortingWithDefaultPaging.aspx` entre les balises `<asp:Content>`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>

<span data-ttu-id="dde5c-202">[![répliquer le balisage déclaratif dans les balises &lt;asp : content&gt; de paging. aspx vers SortingWithDefaultPaging. aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span></span>

<span data-ttu-id="dde5c-203">**Figure 8**: répliquer la balise déclarative dans les balises `<asp:Content>` de `Paging.aspx` à `SortingWithDefaultPaging.aspx` ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span></span>

<span data-ttu-id="dde5c-204">Après avoir copié le balisage déclaratif, copiez les méthodes et les propriétés de la `Paging.aspx` classe code-behind de la page dans la classe code-behind pour `SortingWithDefaultPaging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="dde5c-205">Ensuite, prenez un moment pour afficher la page `SortingWithDefaultPaging.aspx` dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="dde5c-206">Elle doit présenter les mêmes fonctionnalités et apparences que `Paging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="dde5c-207">Amélioration de ProductsBLL pour inclure une méthode de tri et de pagination par défaut</span><span class="sxs-lookup"><span data-stu-id="dde5c-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="dde5c-208">Dans le didacticiel précédent, nous avons créé une méthode `GetProductsAsPagedDataSource(pageIndex, pageSize)` dans la classe `ProductsBLL` qui a retourné un objet `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="dde5c-209">Cet objet `PagedDataSource` a été rempli avec *tous* les produits (via la méthode BLL s `GetProducts()`), mais lorsqu’il est lié au contrôle DataList, seuls les enregistrements correspondant aux paramètres d’entrée *pageIndex* et *pageSize* spécifiés ont été affichés.</span><span class="sxs-lookup"><span data-stu-id="dde5c-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="dde5c-210">Plus haut dans ce didacticiel, nous avons ajouté la prise en charge du tri en spécifiant l’expression de tri du gestionnaire d’événements `Selecting` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="dde5c-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="dde5c-211">Cela fonctionne bien lorsque ObjectDataSource est retourné en tant qu’objet pouvant être trié, comme le `ProductsDataTable` retourné par la méthode `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="dde5c-212">Toutefois, l’objet `PagedDataSource` retourné par la méthode `GetProductsAsPagedDataSource` ne prend pas en charge le tri de sa source de données interne.</span><span class="sxs-lookup"><span data-stu-id="dde5c-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="dde5c-213">Au lieu de cela, nous devons trier les résultats retournés par la méthode `GetProducts()` *avant* de les placer dans le `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="dde5c-214">Pour ce faire, créez une nouvelle méthode dans la classe `ProductsBLL`, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="dde5c-215">Pour trier le `ProductsDataTable` retourné par la méthode `GetProducts()`, spécifiez la propriété `Sort` de son `DataTableView`par défaut :</span><span class="sxs-lookup"><span data-stu-id="dde5c-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample5.vb)]

<span data-ttu-id="dde5c-216">La méthode `GetProductsSortedAsPagedDataSource` diffère légèrement de la méthode `GetProductsAsPagedDataSource` créée dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="dde5c-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="dde5c-217">En particulier, `GetProductsSortedAsPagedDataSource` accepte un paramètre d’entrée supplémentaire `sortExpression` et attribue cette valeur à la propriété `Sort` de l' `DefaultView``ProductDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="dde5c-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="dde5c-218">Quelques lignes de code par la suite, le `DefaultView``ProductDataTable` s est affecté à la source de `PagedDataSource` objet s.</span><span class="sxs-lookup"><span data-stu-id="dde5c-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="dde5c-219">Appel de la méthode GetProductsSortedAsPagedDataSource et spécification de la valeur du paramètre d’entrée SortExpression</span><span class="sxs-lookup"><span data-stu-id="dde5c-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="dde5c-220">Une fois la méthode `GetProductsSortedAsPagedDataSource` terminée, l’étape suivante consiste à fournir la valeur de ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="dde5c-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="dde5c-221">L’ObjectDataSource dans `SortingWithDefaultPaging.aspx` est actuellement configuré pour appeler la méthode `GetProductsAsPagedDataSource` et passe les deux paramètres d’entrée par le biais de ses deux `QueryStringParameters`, qui sont spécifiés dans la collection `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="dde5c-222">Ces deux `QueryStringParameters` indiquent que la source des paramètres de la méthode `GetProductsAsPagedDataSource` s *pageIndex* et *pageSize* provient des champs QueryString `pageIndex` et `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="dde5c-223">Mettez à jour la propriété ObjectDataSource s `SelectMethod` pour qu’elle appelle la nouvelle méthode `GetProductsSortedAsPagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="dde5c-224">Ajoutez ensuite un nouveau `QueryStringParameter` pour que le paramètre d’entrée *SortExpression* soit accessible à partir du champ QueryString `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="dde5c-225">Définissez le `DefaultValue` de `QueryStringParameter` s sur ProductName.</span><span class="sxs-lookup"><span data-stu-id="dde5c-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="dde5c-226">Une fois ces modifications effectuées, le balisage déclaratif s doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="dde5c-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample6.aspx)]

<span data-ttu-id="dde5c-227">À ce stade, la page de `SortingWithDefaultPaging.aspx` trie les résultats par ordre alphabétique selon le nom du produit (voir figure 9).</span><span class="sxs-lookup"><span data-stu-id="dde5c-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="dde5c-228">Cela est dû au fait que, par défaut, la valeur ProductName est transmise en tant que `GetProductsSortedAsPagedDataSource` méthode s *SortExpression* .</span><span class="sxs-lookup"><span data-stu-id="dde5c-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>

<span data-ttu-id="dde5c-229">[![par défaut, les résultats sont triés par NomProduit](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span></span>

<span data-ttu-id="dde5c-230">**Figure 9**: par défaut, les résultats sont triés par `ProductName` ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span></span>

<span data-ttu-id="dde5c-231">Si vous ajoutez manuellement un champ de chaîne de requête `sortExpression` comme `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` les résultats seront triés par le `sortExpression`spécifié.</span><span class="sxs-lookup"><span data-stu-id="dde5c-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="dde5c-232">Toutefois, ce paramètre de `sortExpression` n’est pas inclus dans la chaîne de chaîne lors du déplacement vers une autre page de données.</span><span class="sxs-lookup"><span data-stu-id="dde5c-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="dde5c-233">En fait, un clic sur les boutons suivant ou précédent de la page nous ramène à `Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="dde5c-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="dde5c-234">En outre, il n’existe actuellement aucune interface de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="dde5c-235">La seule façon dont un utilisateur peut modifier l’ordre de tri des données paginées est de manipuler directement la chaîne de chaîne.</span><span class="sxs-lookup"><span data-stu-id="dde5c-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="dde5c-236">Création de l’interface de tri</span><span class="sxs-lookup"><span data-stu-id="dde5c-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="dde5c-237">Nous devons tout d’abord mettre à jour la méthode `RedirectUser` pour envoyer l’utilisateur à `SortingWithDefaultPaging.aspx` (au lieu de `Paging.aspx`) et inclure la valeur `sortExpression` dans la chaîne de recherche.</span><span class="sxs-lookup"><span data-stu-id="dde5c-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="dde5c-238">Nous devons également ajouter une propriété `SortExpression` nommée au niveau de la page, en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="dde5c-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="dde5c-239">Cette propriété, similaire aux propriétés `PageIndex` et `PageSize` créées dans le didacticiel précédent, retourne la valeur du champ `sortExpression` QueryString s’il existe, et la valeur par défaut (ProductName) dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="dde5c-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="dde5c-240">Actuellement, la méthode `RedirectUser` n’accepte qu’un seul paramètre d’entrée, l’index de la page à afficher.</span><span class="sxs-lookup"><span data-stu-id="dde5c-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="dde5c-241">Toutefois, il peut arriver que vous souhaitiez rediriger l’utilisateur vers une page de données particulière à l’aide d’une expression de tri autre que celle spécifiée dans la chaîne de chaîne.</span><span class="sxs-lookup"><span data-stu-id="dde5c-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="dde5c-242">Dans un moment, nous allons créer l’interface de tri pour cette page, qui inclura une série de contrôles Web Button pour trier les données selon une colonne spécifiée.</span><span class="sxs-lookup"><span data-stu-id="dde5c-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="dde5c-243">Quand l’utilisateur clique sur l’un de ces boutons, nous souhaitons rediriger l’utilisateur qui passe la valeur d’expression de tri appropriée.</span><span class="sxs-lookup"><span data-stu-id="dde5c-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="dde5c-244">Pour fournir cette fonctionnalité, créez deux versions de la méthode `RedirectUser`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="dde5c-245">Le premier doit accepter uniquement l’index de page à afficher, tandis que le second accepte l’index de page et l’expression de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample7.vb)]

<span data-ttu-id="dde5c-246">Dans le premier exemple de ce didacticiel, nous avons créé une interface de tri à l’aide d’un DropDownList.</span><span class="sxs-lookup"><span data-stu-id="dde5c-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="dde5c-247">Pour cet exemple, Let utilise trois contrôles Web Button placés au-dessus de DataList pour le tri par `ProductName`, un pour `CategoryName`et un pour `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="dde5c-248">Ajoutez les trois contrôles Web Button, en définissant leurs propriétés `ID` et `Text` de manière appropriée :</span><span class="sxs-lookup"><span data-stu-id="dde5c-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample8.aspx)]

<span data-ttu-id="dde5c-249">Ensuite, créez un gestionnaire d’événements `Click` pour chaque.</span><span class="sxs-lookup"><span data-stu-id="dde5c-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="dde5c-250">Les gestionnaires d’événements doivent appeler la méthode `RedirectUser`, en retournant l’utilisateur à la première page à l’aide de l’expression de tri appropriée.</span><span class="sxs-lookup"><span data-stu-id="dde5c-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample9.vb)]

<span data-ttu-id="dde5c-251">Lors de la première visite de la page, les données sont triées par nom de produit par ordre alphabétique (reportez-vous à la figure 9).</span><span class="sxs-lookup"><span data-stu-id="dde5c-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="dde5c-252">Cliquez sur le bouton suivant pour passer à la deuxième page de données, puis cliquez sur le bouton Trier par catégorie.</span><span class="sxs-lookup"><span data-stu-id="dde5c-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="dde5c-253">Cela nous renvoie à la première page de données, triée par nom de catégorie (voir figure 10).</span><span class="sxs-lookup"><span data-stu-id="dde5c-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="dde5c-254">De même, si vous cliquez sur le bouton Trier par fournisseur, les données par fournisseur sont triées à partir de la première page de données.</span><span class="sxs-lookup"><span data-stu-id="dde5c-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="dde5c-255">Le choix de tri est mémorisé lorsque les données sont paginées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="dde5c-256">La figure 11 illustre la page après le tri par catégorie et l’avancement jusqu’à la treizième page de données.</span><span class="sxs-lookup"><span data-stu-id="dde5c-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>

<span data-ttu-id="dde5c-257">[![les produits sont triés par catégorie](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span></span>

<span data-ttu-id="dde5c-258">**Figure 10**: les produits sont triés par catégorie ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span></span>

<span data-ttu-id="dde5c-259">[![l’expression de tri est mémorisée lors de la pagination des données](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span></span>

<span data-ttu-id="dde5c-260">**Figure 11**: l’expression de tri est mémorisée lors de la pagination des données ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span></span>

## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="dde5c-261">Étape 6 : pagination personnalisée des enregistrements dans un Repeater</span><span class="sxs-lookup"><span data-stu-id="dde5c-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="dde5c-262">L’exemple DataList examiné à l’étape 5 pagine ses données à l’aide de la technique de pagination par défaut inefficace.</span><span class="sxs-lookup"><span data-stu-id="dde5c-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="dde5c-263">Lors de la pagination de quantités de données suffisamment volumineuses, il est impératif d’utiliser la pagination personnalisée.</span><span class="sxs-lookup"><span data-stu-id="dde5c-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="dde5c-264">De retour dans la [pagination efficace de grandes quantités de données](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) et de tri des didacticiels de [données personnalisés](../paging-and-sorting/sorting-custom-paged-data-vb.md) , nous avons examiné les différences entre la pagination par défaut et la pagination personnalisée et les méthodes créées dans la couche BLL pour l’utilisation de la pagination personnalisée et le tri des données paginées personnalisées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-vb.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="dde5c-265">En particulier, dans ces deux didacticiels précédents, nous avons ajouté les trois méthodes suivantes à la classe `ProductsBLL` :</span><span class="sxs-lookup"><span data-stu-id="dde5c-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="dde5c-266">`GetProductsPaged(startRowIndex, maximumRows)` retourne un sous-ensemble particulier d’enregistrements à partir de *StartRowIndex* et ne dépassant pas *MaximumRows*.</span><span class="sxs-lookup"><span data-stu-id="dde5c-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="dde5c-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` retourne un sous-ensemble particulier d’enregistrements triés selon le paramètre d’entrée *SortExpression* spécifié.</span><span class="sxs-lookup"><span data-stu-id="dde5c-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="dde5c-268">`TotalNumberOfProducts()` fournit le nombre total d’enregistrements dans la table de base de données `Products`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="dde5c-269">Ces méthodes peuvent être utilisées pour mettre en page et trier efficacement des données à l’aide d’un contrôle DataList ou Repeater.</span><span class="sxs-lookup"><span data-stu-id="dde5c-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="dde5c-270">Pour illustrer cela, commençons par créer un contrôle Repeater avec prise en charge de la pagination personnalisée. Nous allons ensuite ajouter des fonctionnalités de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="dde5c-271">Ouvrez la page `SortingWithCustomPaging.aspx` dans le dossier `PagingSortingDataListRepeater` et ajoutez un répéteur à la page, en affectant à sa propriété `ID` la valeur `Products`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="dde5c-272">À partir de la balise active de Repeater s, créez un nouvel ObjectDataSource nommé `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="dde5c-273">Configurez-le pour qu’il sélectionne ses données à partir de la méthode `ProductsBLL` classe s `GetProductsPaged`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>

<span data-ttu-id="dde5c-274">[![configurer ObjectDataSource pour utiliser la méthode ProductsBLL de la classe s GetProductsPaged](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span></span>

<span data-ttu-id="dde5c-275">**Figure 12**: configurer ObjectDataSource pour utiliser la méthode `ProductsBLL` classe s `GetProductsPaged` ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span></span>

<span data-ttu-id="dde5c-276">Définissez les listes déroulantes dans les onglets mettre à jour, insérer et supprimer sur (aucun), puis cliquez sur le bouton suivant.</span><span class="sxs-lookup"><span data-stu-id="dde5c-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="dde5c-277">L’Assistant Configuration de la source de données vous invite à indiquer les sources des paramètres d’entrée *StartRowIndex* et *MaximumRows* de `GetProductsPaged` la méthode.</span><span class="sxs-lookup"><span data-stu-id="dde5c-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="dde5c-278">En réalité, ces paramètres d’entrée sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="dde5c-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="dde5c-279">Au lieu de cela, les valeurs *StartRowIndex* et *MaximumRows* sont transmises via la propriété `Arguments` dans le gestionnaire d’événements ObjectDataSource s `Selecting`, tout comme nous avons spécifié le *SortExpression* dans ce didacticiel, la première démo.</span><span class="sxs-lookup"><span data-stu-id="dde5c-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="dde5c-280">Par conséquent, laissez les listes déroulantes source de paramètres dans l’Assistant définies sur aucun.</span><span class="sxs-lookup"><span data-stu-id="dde5c-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>

<span data-ttu-id="dde5c-281">[![laissez les sources de paramètres définies sur aucun](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span></span>

<span data-ttu-id="dde5c-282">**Figure 13**: conserver les sources de paramètres définies sur aucun ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span></span>

> [!NOTE]
> <span data-ttu-id="dde5c-283">N’affectez *pas* la valeur `true`à la propriété ObjectDataSource s `EnablePaging`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="dde5c-284">En conséquence, ObjectDataSource inclut automatiquement ses propres paramètres *StartRowIndex* et *MaximumRows* dans la liste de paramètres existants du `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="dde5c-285">La propriété `EnablePaging` est utile lors de la liaison de données paginées personnalisées à un contrôle GridView, DetailsView ou FormView, car ces contrôles attendent certains comportements de l’ObjectDataSource qui est uniquement disponible lorsque `EnablePaging` propriété est `true`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="dde5c-286">Étant donné que nous devons ajouter manuellement la prise en charge de la pagination pour les contrôles DataList et Repeater, laissez cette propriété définie sur `false` (valeur par défaut), car nous intégrerons les fonctionnalités nécessaires directement dans notre page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="dde5c-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>

<span data-ttu-id="dde5c-287">Enfin, définissez le `ItemTemplate` Repeater afin que le nom, la catégorie et le fournisseur du produit soient affichés.</span><span class="sxs-lookup"><span data-stu-id="dde5c-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="dde5c-288">Après ces modifications, la syntaxe déclarative de Repeater et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="dde5c-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample10.aspx)]

<span data-ttu-id="dde5c-289">Prenez un moment pour accéder à la page via un navigateur et Notez qu’aucun enregistrement n’est retourné.</span><span class="sxs-lookup"><span data-stu-id="dde5c-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="dde5c-290">Cela est dû au fait que nous n’avons pas encore spécifié les valeurs des paramètres *StartRowIndex* et *MaximumRows* ; par conséquent, les valeurs 0 sont transmises pour les deux.</span><span class="sxs-lookup"><span data-stu-id="dde5c-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="dde5c-291">Pour spécifier ces valeurs, créez un gestionnaire d’événements pour l’événement ObjectDataSource s `Selecting` et définissez ces valeurs de paramètres par programmation sur les valeurs codées en dur de 0 et 5, respectivement :</span><span class="sxs-lookup"><span data-stu-id="dde5c-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample11.vb)]

<span data-ttu-id="dde5c-292">Avec cette modification, la page, affichée dans un navigateur, affiche les cinq premiers produits.</span><span class="sxs-lookup"><span data-stu-id="dde5c-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>

<span data-ttu-id="dde5c-293">[![les cinq premiers enregistrements sont affichés](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span></span>

<span data-ttu-id="dde5c-294">**Figure 14**: les cinq premiers enregistrements sont affichés ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span></span>

> [!NOTE]
> <span data-ttu-id="dde5c-295">Les produits listés dans la figure 14 sont triés par nom de produit, car la procédure stockée `GetProductsPaged` qui effectue la requête de pagination personnalisée efficace trie les résultats en `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>

<span data-ttu-id="dde5c-296">Pour permettre à l’utilisateur d’effectuer un pas à pas détaillé des pages, nous devons suivre l’index de début de ligne et le nombre maximal de lignes et mémoriser ces valeurs entre les publications.</span><span class="sxs-lookup"><span data-stu-id="dde5c-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="dde5c-297">Dans l’exemple de pagination par défaut, nous avons utilisé des champs QueryString pour conserver ces valeurs. pour cette démonstration, laissez ces informations persistantes dans l’état d’affichage de la page.</span><span class="sxs-lookup"><span data-stu-id="dde5c-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="dde5c-298">Créez les deux propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="dde5c-298">Create the following two properties:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample12.vb)]

<span data-ttu-id="dde5c-299">Ensuite, mettez à jour le code dans le gestionnaire d’événements de sélection afin qu’il utilise les propriétés `StartRowIndex` et `MaximumRows` à la place des valeurs codées en dur de 0 et 5 :</span><span class="sxs-lookup"><span data-stu-id="dde5c-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample13.vb)]

<span data-ttu-id="dde5c-300">À ce stade, notre page affiche toujours uniquement les cinq premiers enregistrements.</span><span class="sxs-lookup"><span data-stu-id="dde5c-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="dde5c-301">Toutefois, avec ces propriétés en place, nous sommes prêts à créer notre interface de pagination.</span><span class="sxs-lookup"><span data-stu-id="dde5c-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="dde5c-302">Ajout de l’interface de pagination</span><span class="sxs-lookup"><span data-stu-id="dde5c-302">Adding the Paging Interface</span></span>

<span data-ttu-id="dde5c-303">Ils utilisent la même interface de pagination, précédente, suivante et la dernière que celle utilisée dans l’exemple de pagination par défaut, y compris le contrôle Web Label qui affiche la page de données affichée et le nombre total de pages disponibles.</span><span class="sxs-lookup"><span data-stu-id="dde5c-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="dde5c-304">Ajoutez les contrôles Web et l’étiquette à quatre boutons sous le répéteur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-304">Add the four Button Web controls and Label below the Repeater.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample14.aspx)]

<span data-ttu-id="dde5c-305">Ensuite, créez `Click` gestionnaires d’événements pour les quatre boutons.</span><span class="sxs-lookup"><span data-stu-id="dde5c-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="dde5c-306">Lorsque vous cliquez sur l’un de ces boutons, nous devons mettre à jour les `StartRowIndex` et relier les données au répéteur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="dde5c-307">Le code pour les boutons premier, précédent et suivant est assez simple, mais pour le dernier bouton, comment déterminer l’index de la ligne de début pour la dernière page de données ?</span><span class="sxs-lookup"><span data-stu-id="dde5c-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="dde5c-308">Pour calculer cet index et être en mesure de déterminer si les boutons suivant et précédent doivent être activés, nous devons savoir combien d’enregistrements du total sont paginés.</span><span class="sxs-lookup"><span data-stu-id="dde5c-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="dde5c-309">Nous pouvons le déterminer en appelant la méthode `ProductsBLL` classe s `TotalNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="dde5c-310">Créons une propriété en lecture seule, au niveau de la page nommée `TotalRowCount` qui retourne les résultats de la méthode `TotalNumberOfProducts()` :</span><span class="sxs-lookup"><span data-stu-id="dde5c-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample15.vb)]

<span data-ttu-id="dde5c-311">Avec cette propriété, nous pouvons maintenant déterminer l’index de ligne de début de la dernière page.</span><span class="sxs-lookup"><span data-stu-id="dde5c-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="dde5c-312">Plus précisément, il s’agit du résultat de l’entier du `TotalRowCount` moins 1 divisé par `MaximumRows`, multiplié par `MaximumRows`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="dde5c-313">Nous pouvons maintenant écrire les gestionnaires d’événements `Click` pour les quatre boutons d’interface de pagination :</span><span class="sxs-lookup"><span data-stu-id="dde5c-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample16.vb)]

<span data-ttu-id="dde5c-314">Enfin, nous devons désactiver le premier et le précédent bouton dans l’interface de pagination lors de l’affichage de la première page de données, ainsi que des boutons suivant et précédent lors de l’affichage de la dernière page.</span><span class="sxs-lookup"><span data-stu-id="dde5c-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="dde5c-315">Pour ce faire, ajoutez le code suivant au gestionnaire d’événements `Selecting` ObjectDataSource s :</span><span class="sxs-lookup"><span data-stu-id="dde5c-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample17.vb)]

<span data-ttu-id="dde5c-316">Après avoir ajouté ces `Click` gestionnaires d’événements et le code pour activer ou désactiver les éléments de l’interface de pagination en fonction de l’index de la ligne de début en cours, testez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="dde5c-317">Comme illustré à la figure 15, lorsque vous accédez à la page pour la première fois, le premier bouton et le précédent sont désactivés.</span><span class="sxs-lookup"><span data-stu-id="dde5c-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="dde5c-318">Cliquez sur suivant pour afficher la deuxième page de données, tout en cliquant sur dernier pour afficher la dernière page (voir figures 16 et 17).</span><span class="sxs-lookup"><span data-stu-id="dde5c-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="dde5c-319">Lorsque vous affichez la dernière page de données, les boutons suivant et précédent sont désactivés.</span><span class="sxs-lookup"><span data-stu-id="dde5c-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>

<span data-ttu-id="dde5c-320">[![le précédent et le dernier bouton sont désactivés lors de l’affichage de la première page de produits](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span></span>

<span data-ttu-id="dde5c-321">**Figure 15**: les boutons précédent et précédent sont désactivés lors de l’affichage de la première page de produits ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span></span>

<span data-ttu-id="dde5c-322">[![la deuxième page de produits s’affiche](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-322">[![The Second Page of Products are Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span></span>

<span data-ttu-id="dde5c-323">**Figure 16**: la deuxième page de produits s’affiche ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-323">**Figure 16**: The Second Page of Products are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span></span>

<span data-ttu-id="dde5c-324">[![cliquant sur dernier affiche la dernière page de données](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span></span>

<span data-ttu-id="dde5c-325">**Figure 17**: cliquer sur dernier affiche la dernière page de données ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span></span>

## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="dde5c-326">Étape 7 : inclure la prise en charge du tri avec le répéteur paginé personnalisé</span><span class="sxs-lookup"><span data-stu-id="dde5c-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="dde5c-327">Maintenant que la pagination personnalisée a été implémentée, nous sommes prêts à inclure la prise en charge du tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="dde5c-328">La méthode `ProductsBLL` classe s `GetProductsPagedAndSorted` a les mêmes paramètres d’entrée *StartRowIndex* et *MaximumRows* que `GetProductsPaged`, mais autorise un paramètre d’entrée *SortExpression* supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="dde5c-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="dde5c-329">Pour utiliser la méthode `GetProductsPagedAndSorted` à partir de `SortingWithCustomPaging.aspx`, nous devons effectuer les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="dde5c-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="dde5c-330">Modifiez la propriété ObjectDataSource s `SelectMethod` de `GetProductsPaged` en `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="dde5c-331">Ajoutez un objet `Parameter` *SortExpression* à la collection d' `SelectParameters` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="dde5c-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="dde5c-332">Créez une propriété de `SortExpression` au niveau de la page privée qui rend sa valeur persistante sur les publications (postback) à l’état d’affichage de la page.</span><span class="sxs-lookup"><span data-stu-id="dde5c-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="dde5c-333">Mettez à jour le gestionnaire d’événements ObjectDataSource s `Selecting` pour attribuer au paramètre ObjectDataSource s *SortExpression* la valeur de la propriété `SortExpression` au niveau de la page.</span><span class="sxs-lookup"><span data-stu-id="dde5c-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="dde5c-334">Créez l’interface de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-334">Create the sorting interface.</span></span>

<span data-ttu-id="dde5c-335">Commencez par mettre à jour la propriété ObjectDataSource s `SelectMethod` et ajoutez un `Parameter`*SortExpression* .</span><span class="sxs-lookup"><span data-stu-id="dde5c-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="dde5c-336">Assurez-vous que la propriété *sortExpression* `Parameter` s `Type` est définie sur `String`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="dde5c-337">Une fois ces deux premières tâches terminées, le balisage déclaratif s doit se présenter comme suit :</span><span class="sxs-lookup"><span data-stu-id="dde5c-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample18.aspx)]

<span data-ttu-id="dde5c-338">Ensuite, nous avons besoin d’une propriété de `SortExpression` au niveau de la page dont la valeur est sérialisée à l’état d’affichage.</span><span class="sxs-lookup"><span data-stu-id="dde5c-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="dde5c-339">Si aucune valeur d’expression de tri n’a été définie, utilisez ProductName comme valeur par défaut :</span><span class="sxs-lookup"><span data-stu-id="dde5c-339">If no sort expression value has been set, use ProductName as the default:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample19.vb)]

<span data-ttu-id="dde5c-340">Avant que ObjectDataSource n’appelle la méthode `GetProductsPagedAndSorted`, nous devons définir la `Parameter` *SortExpression* sur la valeur de la propriété `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="dde5c-341">Dans le gestionnaire d’événements `Selecting`, ajoutez la ligne de code suivante :</span><span class="sxs-lookup"><span data-stu-id="dde5c-341">In the `Selecting` event handler, add the following line of code:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample20.vb)]

<span data-ttu-id="dde5c-342">Il ne reste plus qu’à implémenter l’interface de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="dde5c-343">Comme nous l’avons fait dans le dernier exemple, nous allons faire en sorte que l’interface de tri soit implémentée à l’aide de trois contrôles Web Button qui permettent à l’utilisateur de trier les résultats par nom de produit, catégorie ou fournisseur.</span><span class="sxs-lookup"><span data-stu-id="dde5c-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample21.aspx)]

<span data-ttu-id="dde5c-344">Créez `Click` gestionnaires d’événements pour ces trois contrôles Button.</span><span class="sxs-lookup"><span data-stu-id="dde5c-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="dde5c-345">Dans le gestionnaire d’événements, réinitialisez la `StartRowIndex` sur 0, affectez la valeur appropriée à la `SortExpression` et liez les données au répétiteur :</span><span class="sxs-lookup"><span data-stu-id="dde5c-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>

[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample22.vb)]

<span data-ttu-id="dde5c-346">C’est tout !</span><span class="sxs-lookup"><span data-stu-id="dde5c-346">That s all there is to it!</span></span> <span data-ttu-id="dde5c-347">Bien qu’il y ait un certain nombre d’étapes pour mettre en œuvre la pagination et le tri personnalisés, les étapes étaient très similaires à celles nécessaires pour la pagination par défaut.</span><span class="sxs-lookup"><span data-stu-id="dde5c-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="dde5c-348">La figure 18 montre les produits lors de l’affichage de la dernière page de données lorsqu’ils sont triés par catégorie.</span><span class="sxs-lookup"><span data-stu-id="dde5c-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>

<span data-ttu-id="dde5c-349">[![la dernière page de données, triée par catégorie, s’affiche](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="dde5c-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span></span>

<span data-ttu-id="dde5c-350">**Figure 18**: la dernière page de données, triée par catégorie, s’affiche ([cliquez pour afficher l’image en taille réelle](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="dde5c-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span></span>

> [!NOTE]
> <span data-ttu-id="dde5c-351">Dans les exemples précédents, lorsque le tri par fournisseur NomFournisseur était utilisé comme expression de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="dde5c-352">Toutefois, pour l’implémentation personnalisée de la pagination, nous devons utiliser CompanyName.</span><span class="sxs-lookup"><span data-stu-id="dde5c-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="dde5c-353">En effet, la procédure stockée responsable de l’implémentation de la pagination personnalisée `GetProductsPagedAndSorted` passe l’expression de tri dans le mot clé `ROW_NUMBER()`, le mot clé `ROW_NUMBER()` requiert le nom réel de la colonne plutôt qu’un alias.</span><span class="sxs-lookup"><span data-stu-id="dde5c-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="dde5c-354">Par conséquent, nous devons utiliser `CompanyName` (le nom de la colonne dans la table `Suppliers`) plutôt que l’alias utilisé dans la requête de `SELECT` (`SupplierName`) pour l’expression de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>

## <a name="summary"></a><span data-ttu-id="dde5c-355">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="dde5c-355">Summary</span></span>

<span data-ttu-id="dde5c-356">Ni DataList ni Repeater n’offrent une prise en charge de tri intégrée, mais avec un peu de code et une interface de tri personnalisée, de telles fonctionnalités peuvent être ajoutées.</span><span class="sxs-lookup"><span data-stu-id="dde5c-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="dde5c-357">Lors de l’implémentation du tri, mais pas de la pagination, l’expression de tri peut être spécifiée via l’objet `DataSourceSelectArguments` passé dans la méthode d' `Select` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="dde5c-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="dde5c-358">Cette propriété `DataSourceSelectArguments` objet s `SortExpression` peut être assignée dans le gestionnaire d’événements ObjectDataSource s `Selecting`.</span><span class="sxs-lookup"><span data-stu-id="dde5c-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="dde5c-359">Pour ajouter des fonctionnalités de tri à un contrôle DataList ou Repeater qui fournit déjà la prise en charge de la pagination, l’approche la plus simple consiste à personnaliser la couche de logique métier pour inclure une méthode qui accepte une expression de tri.</span><span class="sxs-lookup"><span data-stu-id="dde5c-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="dde5c-360">Ces informations peuvent ensuite être transmises par le biais d’un paramètre dans l' `SelectParameters`ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="dde5c-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="dde5c-361">Ce didacticiel termine notre examen de la pagination et du tri avec les contrôles DataList et Repeater.</span><span class="sxs-lookup"><span data-stu-id="dde5c-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="dde5c-362">Notre prochain et dernier didacticiel examinera comment ajouter des contrôles Web Button aux modèles DataList et Repeater, afin de fournir des fonctionnalités personnalisées, initiées par l’utilisateur, pour chaque élément.</span><span class="sxs-lookup"><span data-stu-id="dde5c-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="dde5c-363">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="dde5c-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="dde5c-364">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="dde5c-364">About the Author</span></span>

<span data-ttu-id="dde5c-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="dde5c-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="dde5c-366">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="dde5c-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="dde5c-367">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="dde5c-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="dde5c-368">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dde5c-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="dde5c-369">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="dde5c-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="dde5c-370">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="dde5c-370">Special Thanks To</span></span>

<span data-ttu-id="dde5c-371">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="dde5c-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="dde5c-372">Le réviseur de leads pour ce didacticiel était David SURU.</span><span class="sxs-lookup"><span data-stu-id="dde5c-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="dde5c-373">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="dde5c-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="dde5c-374">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dde5c-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="dde5c-375">Précédent</span><span class="sxs-lookup"><span data-stu-id="dde5c-375">Previous</span></span>](paging-report-data-in-a-datalist-or-repeater-control-vb.md)
