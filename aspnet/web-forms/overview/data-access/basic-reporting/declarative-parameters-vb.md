---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: Paramètres déclaratifs (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous illustrerons comment utiliser un paramètre défini sur une valeur codée en dur pour sélectionner les données à afficher dans un contrôle DetailsView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: 2830b6070320e27a8ea367db229bfa9fe411b34c
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65132433"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="f33df-103">Paramètres déclaratifs (VB)</span><span class="sxs-lookup"><span data-stu-id="f33df-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="f33df-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f33df-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f33df-105">[Télécharger l’exemple d’application](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) ou [télécharger le PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f33df-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="f33df-106">Dans ce didacticiel, nous illustrerons comment utiliser un paramètre défini sur une valeur codée en dur pour sélectionner les données à afficher dans un contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="f33df-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="f33df-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="f33df-107">Introduction</span></span>

<span data-ttu-id="f33df-108">Dans le [dernier didacticiel](displaying-data-with-the-objectdatasource-vb.md) nous avons vu l’affichage de données avec les contrôles GridView, DetailsView et FormView liés à un contrôle ObjectDataSource qui a appelé le `GetProducts()` méthode à partir de la `ProductsBLL` classe.</span><span class="sxs-lookup"><span data-stu-id="f33df-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="f33df-109">Le `GetProducts()` méthode retourne un DataTable fortement typé rempli avec tous les enregistrements de la base de données Northwind `Products` table.</span><span class="sxs-lookup"><span data-stu-id="f33df-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="f33df-110">Le `ProductsBLL` classe contient des méthodes supplémentaires pour des sous-ensembles de simples le retour des produits - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, et `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="f33df-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="f33df-111">Ces trois méthodes attendent un paramètre d’entrée indiquant comment filtrer les informations de produit retourné.</span><span class="sxs-lookup"><span data-stu-id="f33df-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="f33df-112">ObjectDataSource peut être utilisé pour appeler des méthodes qui attendent des paramètres d’entrée, mais pour cela, nous devons spécifier d'où proviennent les valeurs de ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="f33df-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="f33df-113">Les valeurs de paramètre peuvent être codées en dur ou peuvent provenir de diverses sources dynamiques, y compris : valeurs de chaîne de requête, variables de Session, la valeur de propriété d’un contrôle Web sur la page, ou d’autres.</span><span class="sxs-lookup"><span data-stu-id="f33df-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="f33df-114">Pour ce didacticiel, nous allons commencer par illustrant l’utilisation d’un paramètre défini sur une valeur codée en dur.</span><span class="sxs-lookup"><span data-stu-id="f33df-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="f33df-115">Plus précisément, nous examinerons l’ajout d’un contrôle DetailsView à la page qui affiche des informations sur un produit spécifique, à savoir du Chef Anton Gumbo Mix, ce qui a un `ProductID` de 5.</span><span class="sxs-lookup"><span data-stu-id="f33df-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="f33df-116">Ensuite, nous verrons comment définir la valeur du paramètre basée sur un contrôle Web.</span><span class="sxs-lookup"><span data-stu-id="f33df-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="f33df-117">En particulier, nous allons utiliser une zone de texte pour permettre à l’utilisateur de type dans un pays, après laquelle ils peuvent cliquer sur un bouton pour afficher la liste des fournisseurs qui se trouvent dans ce pays.</span><span class="sxs-lookup"><span data-stu-id="f33df-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="f33df-118">À l’aide d’une valeur de paramètre codées en dur</span><span class="sxs-lookup"><span data-stu-id="f33df-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="f33df-119">Pour le premier exemple, commencez par ajouter un contrôle DetailsView pour le `DeclarativeParams.aspx` page dans le `BasicReporting` dossier.</span><span class="sxs-lookup"><span data-stu-id="f33df-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="f33df-120">À partir de la balise active de DetailsView, sélectionnez &lt;nouvelle source de données&gt; à partir de la liste déroulante liste et choisissez d’ajouter un ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f33df-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="f33df-121">[![Ajouter un ObjectDataSource à la Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="f33df-122">**Figure 1**: Ajouter un ObjectDataSource à la Page ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="f33df-123">Ceci démarrera automatiquement Assistant de choisir la Source de données du contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f33df-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="f33df-124">Sélectionnez le `ProductsBLL` classe dans le premier écran de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="f33df-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="f33df-125">[![Sélectionnez la classe ProductsBLL](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="f33df-126">**Figure 2**: Sélectionnez le `ProductsBLL` classe ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="f33df-127">Étant donné que nous souhaitons afficher des informations sur un produit particulier que nous souhaitons utiliser la `GetProductByProductID(productID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="f33df-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="f33df-128">[![Choisissez la méthode GetProductByProductID(productID)](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="f33df-129">**Figure 3**: Choisissez le `GetProductByProductID(productID)` (méthode) ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="f33df-130">Étant donné que la méthode que nous avons sélectionné inclut un paramètre, il est un écran plus pour l’Assistant, où nous avons invités à définir la valeur à utiliser pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="f33df-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="f33df-131">La liste sur la gauche affiche tous les paramètres de la méthode sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="f33df-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="f33df-132">Pour `GetProductByProductID(productID)` seul `productID`.</span><span class="sxs-lookup"><span data-stu-id="f33df-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="f33df-133">Sur la droite, nous pouvons spécifier la valeur pour le paramètre sélectionné.</span><span class="sxs-lookup"><span data-stu-id="f33df-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="f33df-134">La liste de liste déroulante de paramètre source énumère les différentes sources possibles pour la valeur du paramètre.</span><span class="sxs-lookup"><span data-stu-id="f33df-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="f33df-135">Dans la mesure où nous voulons spécifier une valeur codée en dur de 5 pour le `productID` paramètre, laissez le paramètre source en tant que None et entrer 5 dans la zone de texte DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="f33df-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="f33df-136">[![Un Hard-Coded paramètre valeur de 5 sera utilisée pour le paramètre productID](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="f33df-137">**Figure 4**: Un Hard-Coded paramètre valeur de 5 sera utilisée pour le `productID` paramètre ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="f33df-138">À l’issue de l’Assistant Configurer la Source de données, le balisage déclaratif du contrôle ObjectDataSource inclut un `Parameter` de l’objet dans le `SelectParameters` collection pour chacun des paramètres d’entrée attendus par la méthode définie dans le `SelectMethod` propriété.</span><span class="sxs-lookup"><span data-stu-id="f33df-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="f33df-139">Étant donné que la méthode que nous utilisons dans cet exemple attend simplement un paramètre d’entrée unique, `parameterID`, il existe une seule entrée ici.</span><span class="sxs-lookup"><span data-stu-id="f33df-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="f33df-140">Le `SelectParameters` collection peut contenir n’importe quelle classe qui dérive de la `Parameter` classe dans le `System.Web.UI.WebControls` espace de noms.</span><span class="sxs-lookup"><span data-stu-id="f33df-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="f33df-141">Pour les valeurs de paramètre codées en dur, la base de `Parameter` classe est utilisée, mais pour l’autre paramètre source options une dérivée `Parameter` classe est utilisée ; vous pouvez également créer vos propres [types de paramètres personnalisés](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="f33df-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="f33df-142">Si vous programmez sur votre ordinateur le balisage déclaratif vous voyez à ce stade mai incluent des valeurs pour le `InsertMethod`, `UpdateMethod`, et `DeleteMethod` propriétés, ainsi que `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="f33df-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="f33df-143">Assistant de choisir la Source de données de l’ObjectDataSource spécifie automatiquement les méthodes à partir de la `ProductBLL` à utiliser pour l’insertion, de la mise à jour et de suppression, sauf si vous avez désactivé explicitement ces difficultés, ils amèneront inclus dans le balisage ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="f33df-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="f33df-144">Lorsque vous visitez cette page, les données de contrôle Web appellera l’ObjectDataSource `Select` (méthode), qui appellera le `ProductsBLL` la classe `GetProductByProductID(productID)` méthode à l’aide de la valeur codée en dur de 5 pour le `productID` paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="f33df-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="f33df-145">La méthode retourne un fortement typée `ProductDataTable` objet qui contient une seule ligne avec les informations à propos Gumbo Mix du Chef Anton (le produit avec `ProductID` 5).</span><span class="sxs-lookup"><span data-stu-id="f33df-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="f33df-146">[![Affiche des Gumbo Mix d’informations sur Chef Anton](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="f33df-147">**Figure 5**: Affiche des Gumbo Mix d’informations sur Chef Anton ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="f33df-148">Définition de la valeur de paramètre à la valeur de propriété d’un contrôle Web</span><span class="sxs-lookup"><span data-stu-id="f33df-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="f33df-149">Paramètre de l’ObjectDataSource valeurs peuvent également être définies selon la valeur d’un contrôle Web dans la page.</span><span class="sxs-lookup"><span data-stu-id="f33df-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="f33df-150">Pour illustrer cela, nous allons avoir un GridView qui répertorie tous les fournisseurs qui sont trouvent dans un pays spécifié par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f33df-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="f33df-151">Pour accomplir ce guide de démarrage en ajoutant une zone de texte à la page dans laquelle l’utilisateur peut entrer un nom de pays.</span><span class="sxs-lookup"><span data-stu-id="f33df-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="f33df-152">Définir ce contrôle de zone de texte `ID` propriété `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="f33df-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="f33df-153">Ajoutez également un contrôle bouton Web.</span><span class="sxs-lookup"><span data-stu-id="f33df-153">Also add a Button Web control.</span></span>

<span data-ttu-id="f33df-154">[![Ajouter une zone de texte à la Page avec l’ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="f33df-155">**Figure 6**: Ajouter une zone de texte à la Page avec `ID` `CountryName` ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="f33df-156">Ensuite, ajoutez un GridView à la page et, à partir de la balise active, choisissez Ajouter un nouveau ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f33df-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="f33df-157">Étant donné que nous souhaitons afficher sélectionner des informations de fournisseur la `SuppliersBLL` classe à partir du premier écran de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="f33df-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="f33df-158">Dans le deuxième écran, choisir le `GetSuppliersByCountry(country)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="f33df-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="f33df-159">[![Choisissez la méthode GetSuppliersByCountry(country)](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="f33df-160">**Figure 7**: Choisissez le `GetSuppliersByCountry(country)` (méthode) ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="f33df-161">Dans la mesure où le `GetSuppliersByCountry(country)` méthode a un paramètre d’entrée, l’Assistant inclut une fois encore un écran final pour le choix de la valeur du paramètre.</span><span class="sxs-lookup"><span data-stu-id="f33df-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="f33df-162">Cette fois, définissez la source de paramètre au contrôle.</span><span class="sxs-lookup"><span data-stu-id="f33df-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="f33df-163">Cela remplira la liste déroulante ControlID avec les noms des contrôles sur la page. Sélectionnez le `CountryName` contrôle dans la liste.</span><span class="sxs-lookup"><span data-stu-id="f33df-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="f33df-164">Lorsque la page est visitée en premier le `CountryName` zone de texte sera vide, aucun résultat n’est renvoyés et rien ne s’affiche.</span><span class="sxs-lookup"><span data-stu-id="f33df-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="f33df-165">Si vous souhaitez afficher des résultats par défaut, définissez la zone de texte DefaultValue en conséquence.</span><span class="sxs-lookup"><span data-stu-id="f33df-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="f33df-166">[![Définissez la valeur de paramètre à la valeur de contrôle de CountryName](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="f33df-167">**Figure 8**: Définissez la valeur de paramètre sur le `CountryName` valeur de contrôle ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="f33df-168">Balisage déclaratif de l’ObjectDataSource diffère légèrement de notre premier exemple, à l’aide un [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) au lieu de la norme `Parameter` objet.</span><span class="sxs-lookup"><span data-stu-id="f33df-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="f33df-169">Un `ControlParameter` possède des propriétés supplémentaires pour spécifier le `ID` du contrôle Web et la valeur de propriété à utiliser pour le paramètre (`PropertyName`).</span><span class="sxs-lookup"><span data-stu-id="f33df-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="f33df-170">L’Assistant Configurer la Source de données est suffisamment malin pour déterminer que, pour une zone de texte, nous allons probablement souhaitez utiliser le `Text` propriété pour la valeur du paramètre.</span><span class="sxs-lookup"><span data-stu-id="f33df-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="f33df-171">Si, toutefois, vous souhaitez utiliser une valeur de propriété différente à partir du contrôle Web, vous pouvez modifier le `PropertyName` valeur ici ou en cliquant sur le lien « Afficher les propriétés avancées » dans l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="f33df-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="f33df-172">Lorsque vous visitez la page pour la première fois le `CountryName` zone de texte est vide.</span><span class="sxs-lookup"><span data-stu-id="f33df-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="f33df-173">L’ObjectDataSource `Select` méthode est toujours appelée par le contrôle GridView, mais la valeur de `Nothing` est passé dans le `GetSuppliersByCountry(country)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="f33df-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="f33df-174">Le TableAdapter convertit le `Nothing` dans une base de données `NULL` valeur (`DBNull.Value`), mais la requête utilisée par le `GetSuppliersByCountry(country)` méthode est écrite telles qu’elle ne retourne pas les valeurs lorsque un `NULL` valeur est spécifiée pour le `@CategoryID`paramètre.</span><span class="sxs-lookup"><span data-stu-id="f33df-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="f33df-175">En bref, aucun fournisseur n’est retournés.</span><span class="sxs-lookup"><span data-stu-id="f33df-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="f33df-176">Une fois que le visiteur entre dans un pays, toutefois et qu’il clique sur le bouton Afficher les fournisseurs pour provoquer une publication (postback), ObjectDataSource `Select` méthode est à nouveau interrogée, en passant le contrôle de zone de texte `Text` valeur en tant que le `country` paramètre.</span><span class="sxs-lookup"><span data-stu-id="f33df-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="f33df-177">[![Ces fournisseurs du Canada sont affichés.](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="f33df-178">**Figure 9**: Ces fournisseurs du Canada sont affichés ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="f33df-179">Affichage de tous les fournisseurs par défaut</span><span class="sxs-lookup"><span data-stu-id="f33df-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="f33df-180">Plutôt qu’afficher aucun des fournisseurs lors de l’affichage de tout d’abord la page Nous souhaiterons peut-être afficher *tous les* fournisseurs dans un premier temps, permettant à l’utilisateur alléger la liste en entrant un nom de pays dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="f33df-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="f33df-181">Lorsque la zone de texte est vide, le `SuppliersBLL` la classe `GetSuppliersByCountry(country)` est passé dans la méthode `Nothing` pour son *`country`* paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="f33df-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="f33df-182">Cela `Nothing` valeur est alors transmise vers le bas dans la couche Data Access `GetSupplierByCountry(country)` méthode, où elle est convertie en une base de données `NULL` valeur pour le `@Country` paramètre dans la requête suivante :</span><span class="sxs-lookup"><span data-stu-id="f33df-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="f33df-183">L’expression `Country = NULL` retourne toujours False, même pour les enregistrements dont la propriété `Country` colonne a un `NULL` valeur ; par conséquent, aucun enregistrements ne sont renvoyés.</span><span class="sxs-lookup"><span data-stu-id="f33df-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="f33df-184">Pour retourner *tous les* fournisseurs lorsque le pays de zone de texte est vide, nous pouvons augmenter la `GetSuppliersByCountry(country)` méthode dans la couche BLL à appeler le `GetSuppliers()` méthode lors de son paramètre de pays est `Nothing` et d’appeler la couche Data Access `GetSuppliersByCountry(country)` méthode sinon.</span><span class="sxs-lookup"><span data-stu-id="f33df-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="f33df-185">Cela aura l’effet de retourner tous les fournisseurs lorsque aucun pays n’est spécifié et le sous-ensemble approprié de fournisseurs lorsque le paramètre de pays est inclus.</span><span class="sxs-lookup"><span data-stu-id="f33df-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="f33df-186">Modifier le `GetSuppliersByCountry(country)` méthode dans la `SuppliersBLL` classe à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="f33df-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="f33df-187">Avec cette modification le `DeclarativeParams.aspx` page affiche tous les fournisseurs lors de la première visite (ou chaque fois que le `CountryName` zone de texte est vide).</span><span class="sxs-lookup"><span data-stu-id="f33df-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="f33df-188">[![Tous les fournisseurs sont maintenant affichés par défaut](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f33df-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="f33df-189">**Figure 10**: Tous les fournisseurs sont maintenant affichés par défaut ([cliquez pour afficher l’image en taille réelle](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="f33df-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="f33df-190">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="f33df-190">Summary</span></span>

<span data-ttu-id="f33df-191">Pour utiliser des méthodes avec des paramètres d’entrée, nous devons spécifier les valeurs pour les paramètres de l’ObjectDataSource `SelectParameters` collection.</span><span class="sxs-lookup"><span data-stu-id="f33df-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="f33df-192">Autorisent les différents types de paramètres pour la valeur du paramètre doit être obtenu à partir de différentes sources.</span><span class="sxs-lookup"><span data-stu-id="f33df-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="f33df-193">Le type de paramètre par défaut utilise une valeur codée en dur, mais comme facilement (et sans une ligne de code) des valeurs de paramètre peuvent être obtenues à partir de la chaîne de requête, Session variables, les cookies et même entré par l’utilisateur les valeurs à partir de contrôles Web sur la page.</span><span class="sxs-lookup"><span data-stu-id="f33df-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="f33df-194">Les exemples que nous avons vu dans ce didacticiel illustre comment utiliser les valeurs de paramètre déclarative.</span><span class="sxs-lookup"><span data-stu-id="f33df-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="f33df-195">Toutefois, il peut arriver lorsque nous devons utiliser une source de paramètre qui n’est pas disponible, comme la date et heure actuelles, ou, si notre site a été à l’aide de l’appartenance, l’ID d’utilisateur du visiteur.</span><span class="sxs-lookup"><span data-stu-id="f33df-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="f33df-196">Pour de tels scénarios, nous pouvons définir les valeurs de paramètre par programme avant l’ObjectDataSource appel de méthode de son de l’objet sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="f33df-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="f33df-197">Nous verrons comment procéder dans le [didacticiel suivant](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span><span class="sxs-lookup"><span data-stu-id="f33df-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="f33df-198">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="f33df-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f33df-199">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="f33df-199">About the Author</span></span>

<span data-ttu-id="f33df-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="f33df-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f33df-201">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="f33df-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f33df-202">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f33df-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f33df-203">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f33df-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f33df-204">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f33df-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f33df-205">Remerciements</span><span class="sxs-lookup"><span data-stu-id="f33df-205">Special Thanks To</span></span>

<span data-ttu-id="f33df-206">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="f33df-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f33df-207">Entraîner un réviseur pour ce didacticiel a été Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="f33df-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="f33df-208">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="f33df-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f33df-209">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f33df-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f33df-210">[Précédent](displaying-data-with-the-objectdatasource-vb.md)
> [Suivant](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f33df-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
