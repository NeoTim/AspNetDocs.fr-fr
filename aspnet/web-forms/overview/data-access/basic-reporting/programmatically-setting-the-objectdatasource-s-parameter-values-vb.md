---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
title: Définition par programmation des valeurs de paramètre de l’ObjectDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons examiner l’ajout d’une méthode à notre DAL et la couche BLL qui accepte un seul paramètre d’entrée et retourne des données. L’exemple définit ce paramètre...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 0ecb03b6-52a0-4731-8c7a-436391d36838
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
msc.type: authoredcontent
ms.openlocfilehash: 0f5c5d4530092cced02834161ae91d840f42de1b
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59420729"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-vb"></a><span data-ttu-id="a9bf3-104">Définition par programmation des valeurs des paramètres d’ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-104">Programmatically Setting the ObjectDataSource's Parameter Values (VB)</span></span>

<span data-ttu-id="a9bf3-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a9bf3-106">[Télécharger l’exemple d’application](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) ou [télécharger le PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span></span>

> <span data-ttu-id="a9bf3-107">Dans ce didacticiel, nous allons examiner l’ajout d’une méthode à notre DAL et la couche BLL qui accepte un seul paramètre d’entrée et retourne des données.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="a9bf3-108">L’exemple définit ce paramètre par programmation.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-108">The example will set this parameter programmatically.</span></span>


## <a name="introduction"></a><span data-ttu-id="a9bf3-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="a9bf3-109">Introduction</span></span>

<span data-ttu-id="a9bf3-110">Comme nous l’avons vu dans la [didacticiel précédent](declarative-parameters-vb.md), plusieurs options sont disponibles pour le passage de façon déclarative les valeurs de paramètre aux méthodes de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-110">As we saw in the [previous tutorial](declarative-parameters-vb.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="a9bf3-111">Si la valeur du paramètre est codé en dur, provient d’un contrôle Web dans la page, ou dans toute autre source qui est lisible par une source de données n’est `Parameter` de l’objet, par exemple, que valeur peut être liée au paramètre d’entrée sans écrire une ligne de code.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="a9bf3-112">Il peut arriver, cependant, lorsque la valeur du paramètre provient de certains source pas déjà pris en compte par un de la source de données intégrés `Parameter` objets.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="a9bf3-113">Si notre site pris en charge les comptes d’utilisateur, nous voulons définir le paramètre selon l’actuellement connecté ID d’utilisateur. du visiteur</span><span class="sxs-lookup"><span data-stu-id="a9bf3-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="a9bf3-114">Ou bien, nous sommes amenés à personnaliser la valeur du paramètre avant de les envoyer le long de sous-jacent de l’ObjectDataSource méthode d’objet.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="a9bf3-115">Chaque fois que l’ObjectDataSource `Select` méthode est appelée ObjectDataSource déclenche tout d’abord sa [événement Selecting](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="a9bf3-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="a9bf3-116">Méthode de l’objet sous-jacent de l’ObjectDataSource est ensuite appelée.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="a9bf3-117">Une fois que la fin de l’opération de l’ObjectDataSource [sélectionnés événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) se déclenche (Figure 1 illustre cette séquence d’événements).</span><span class="sxs-lookup"><span data-stu-id="a9bf3-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="a9bf3-118">Les valeurs de paramètre passés dans la méthode de l’objet sous-jacent de l’ObjectDataSource peuvent être définies ou personnalisées dans un gestionnaire d’événements pour le `Selecting` événement.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>


<span data-ttu-id="a9bf3-119">[![L’ObjectDataSource sélectionnés et en sélectionnant le feu événements avant et d’après son objet sous-jacent la méthode est appelée.](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span></span>

<span data-ttu-id="a9bf3-120">**Figure 1**: L’ObjectDataSource `Selected` et `Selecting` événements incendie avant et d’après son objet sous-jacent la méthode est appelée ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span></span>


<span data-ttu-id="a9bf3-121">Dans ce didacticiel, nous examinerons l’ajout d’une méthode à notre DAL et la couche BLL qui accepte un seul paramètre d’entrée `Month`, de type `Integer` et retourne un `EmployeesDataTable` objet rempli avec les employés qui ont leur embauche anniversaire spécifié `Month`.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `Integer` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="a9bf3-122">Notre exemple définit ce paramètre par programmation selon le mois en cours, en affichant une liste de « Anniversaires ce mois-ci. »</span><span class="sxs-lookup"><span data-stu-id="a9bf3-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="a9bf3-123">C’est parti !</span><span class="sxs-lookup"><span data-stu-id="a9bf3-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="a9bf3-124">Étape 1 : Ajout d’une méthode pour`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="a9bf3-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="a9bf3-125">Pour notre premier exemple, nous devons ajouter un moyen de récupérer les employés dont `HireDate` s’est produite dans un mois spécifié.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="a9bf3-126">Pour offrir cette fonctionnalité conformément à notre architecture que nous devons tout d’abord créer une méthode dans `EmployeesTableAdapter` qui mappe à l’instruction SQL appropriée.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="a9bf3-127">Pour ce faire, commencez par ouvrir le DataSet typé de Northwind.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="a9bf3-128">Avec le bouton droit sur le `EmployeesTableAdapter` de l’étiquette et choisissez Ajouter une requête.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>


<span data-ttu-id="a9bf3-129">[![Ajouter une nouvelle requête à la EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span></span>

<span data-ttu-id="a9bf3-130">**Figure 2**: Ajouter une nouvelle requête pour le `EmployeesTableAdapter` ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span></span>


<span data-ttu-id="a9bf3-131">Choisir d’ajouter une instruction SQL qui retourne des lignes.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="a9bf3-132">Quand vous atteignez la spécifier un `SELECT` instruction écran la valeur par défaut `SELECT` instruction pour la `EmployeesTableAdapter` sera déjà chargé.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="a9bf3-133">Ajoutez simplement dans le `WHERE` clause : `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="a9bf3-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) est une fonction T-SQL qui retourne une partie de date particulière d’un `datetime` type ; dans ce cas, nous utilisons `DATEPART` pour retourner le mois de la `HireDate` colonne.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>


<span data-ttu-id="a9bf3-135">[![Retour uniquement les lignes où la HireDate colonne est inférieure ou égale à la @HiredBeforeDate paramètre](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span></span>

<span data-ttu-id="a9bf3-136">**Figure 3**: Retourner uniquement les lignes où la `HireDate` colonne est inférieure ou égale à la `@HiredBeforeDate` paramètre ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span></span>


<span data-ttu-id="a9bf3-137">Enfin, changez le `FillBy` et `GetDataBy` pour les noms de méthode `FillByHiredDateMonth` et `GetEmployeesByHiredDateMonth`, respectivement.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>


<span data-ttu-id="a9bf3-138">[![Choisissez des noms de méthode plus appropriées que FillBy et GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span></span>

<span data-ttu-id="a9bf3-139">**Figure 4**: Choisissez plus approprié méthode noms que `FillBy` et `GetDataBy` ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span></span>


<span data-ttu-id="a9bf3-140">Cliquez sur Terminer pour terminer l’Assistant et revenir à l’aire de conception du jeu de données.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="a9bf3-141">Le `EmployeesTableAdapter` doit inclure désormais un nouvel ensemble de méthodes pour accéder à des employés embauchés dans un mois spécifié.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>


<span data-ttu-id="a9bf3-142">[![Les nouvelles méthodes s’affichent dans l’aire de conception du jeu de données](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span></span>

<span data-ttu-id="a9bf3-143">**Figure 5**: Les nouvelles méthodes s’affichent dans l’aire de conception du jeu de données ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span></span>


## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="a9bf3-144">Étape 2 : Ajout de la`GetEmployeesByHiredDateMonth(month)`à la couche de logique métier (méthode)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="a9bf3-145">Étant donné que notre application architecture utilise distinct de couche pour la logique métier et les données d’accès logique, nous devons ajouter une méthode à notre BLL que les appels à la couche DAL pour récupérer les employés engagés avant une date spécifiée.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="a9bf3-146">Ouvrez le `EmployeesBLL.vb` fichier, puis ajoutez la méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="a9bf3-146">Open the `EmployeesBLL.vb` file and add the following method:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample1.vb)]

<span data-ttu-id="a9bf3-147">Comme avec nos autres méthodes dans cette classe, `GetEmployeesByHiredDateMonth(month)` appelle simplement vers le bas dans la couche DAL et retourne les résultats.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="a9bf3-148">Étape 3 : Affichage des employés dont embauche anniversaire est ce mois-ci</span><span class="sxs-lookup"><span data-stu-id="a9bf3-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="a9bf3-149">Notre dernière étape pour cet exemple consiste à afficher les employés dont embauche anniversaire est ce mois-ci.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="a9bf3-150">Commencez par ajouter un contrôle GridView à la `ProgrammaticParams.aspx` page dans le `BasicReporting` dossier et ajoutez un nouveau ObjectDataSource comme source de données.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="a9bf3-151">Configurer l’ObjectDataSource à utiliser le `EmployeesBLL` classe avec le `SelectMethod` défini sur `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>


<span data-ttu-id="a9bf3-152">[![Utilisez la classe EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span></span>

<span data-ttu-id="a9bf3-153">**Figure 6**: Utilisez le `EmployeesBLL` classe ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span></span>


<span data-ttu-id="a9bf3-154">[![Sélectionnez les GetEmployeesByHiredDateMonth(month) à partir de la méthode](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span></span>

<span data-ttu-id="a9bf3-155">**Figure 7**: Select From le `GetEmployeesByHiredDateMonth(month)` (méthode) ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span></span>


<span data-ttu-id="a9bf3-156">Le dernier écran nous demande de fournir le `month` source de la valeur du paramètre.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="a9bf3-157">Étant donné que nous allons définir cette valeur par programmation, laissez le paramètre source la valeur par défaut aucune option et cliquez sur Terminer.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>


<span data-ttu-id="a9bf3-158">[![Conservez le paramètre Source None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span></span>

<span data-ttu-id="a9bf3-159">**Figure 8**: Laissez le paramètre Source définie sur None ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span></span>


<span data-ttu-id="a9bf3-160">Cela créera un `Parameter` objet dans l’ObjectDataSource `SelectParameters` collection qui n’a pas une valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>


[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample2.aspx)]

<span data-ttu-id="a9bf3-161">Pour définir cette valeur par programmation, nous devons créer un gestionnaire d’événements pour l’ObjectDataSource `Selecting` événement.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="a9bf3-162">Pour ce faire, accédez à la vue conception, puis double-cliquez sur ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="a9bf3-163">Vous pouvez également sélectionnez ObjectDataSource, accédez à la fenêtre Propriétés, cliquez sur l’icône d’éclair.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="a9bf3-164">Ensuite, double-cliquez sur dans la zone de texte à côté du `Selecting` événement ou tapez le nom de gestionnaire d’événements que vous souhaitez utiliser.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span> <span data-ttu-id="a9bf3-165">Une troisième option, vous pouvez créer le Gestionnaire d’événements en sélectionnant ObjectDataSource et son `Selecting` événement dans les deux listes de liste déroulante en haut de la classe code-behind de la page.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-165">As a third option, you can create the event handler by selecting the ObjectDataSource and its `Selecting` event from the two drop-down lists at the top of the page's code-behind class.</span></span>


![Cliquez sur l’icône d’éclair dans la fenêtre Propriétés pour répertorier les événements d’un contrôle Web](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image25.png)

<span data-ttu-id="a9bf3-167">**Figure 9**: Cliquez sur l’icône d’éclair dans la fenêtre Propriétés pour répertorier les événements d’un contrôle Web</span><span class="sxs-lookup"><span data-stu-id="a9bf3-167">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>


<span data-ttu-id="a9bf3-168">Tous les trois approches ajouter un nouveau gestionnaire d’événements pour l’ObjectDataSource `Selecting` événement à la classe code-behind de la page.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-168">All three approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="a9bf3-169">Dans ce gestionnaire d’événements, nous pouvons lire et écrire dans les valeurs de paramètre à l’aide de `e.InputParameters(parameterName)`, où *`parameterName`* est la valeur de la `Name` d’attribut dans le `<asp:Parameter>` balise (le `InputParameters` collection peut également être indexée ordinale, comme dans `e.InputParameters(index)`).</span><span class="sxs-lookup"><span data-stu-id="a9bf3-169">In this event handler we can read and write to the parameter values using `e.InputParameters(parameterName)`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters(index)`).</span></span> <span data-ttu-id="a9bf3-170">Pour définir le `month` paramètre pour le mois en cours, ajoutez le code suivant à la `Selecting` Gestionnaire d’événements :</span><span class="sxs-lookup"><span data-stu-id="a9bf3-170">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample3.vb)]

<span data-ttu-id="a9bf3-171">Lorsque vous visitez cette page via un navigateur, nous pouvons voir que seul un employé a été embauché ce mois-ci (mars) Laura Callahan, qui travaille chez l’entreprise depuis 1994.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-171">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>


<span data-ttu-id="a9bf3-172">[![Les employés dont les anniversaires ce mois-ci sont affichés.](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-172">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span></span>

<span data-ttu-id="a9bf3-173">**Figure 10**: Ces employés dont anniversaires ce mois sont affichés ([cliquez pour afficher l’image en taille réelle](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="a9bf3-173">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span></span>


## <a name="summary"></a><span data-ttu-id="a9bf3-174">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="a9bf3-174">Summary</span></span>

<span data-ttu-id="a9bf3-175">Valeurs des paramètres de l’ObjectDataSource peuvent en général être définies de façon déclarative, sans nécessiter une ligne de code, il est facile de définir les valeurs de paramètre par programmation.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-175">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="a9bf3-176">Il nous suffit est de créer un gestionnaire d’événements pour l’ObjectDataSource `Selecting` événement qui se déclenche avant que la méthode de l’objet sous-jacent est appelée et définir manuellement les valeurs pour un ou plusieurs paramètres via le `InputParameters` collection.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-176">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="a9bf3-177">Ce didacticiel conclut la section rapports de base.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-177">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="a9bf3-178">Le [didacticiel suivant](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) lance la section de filtrage et les scénarios maître / détails, dans laquelle nous examinons les techniques permettant d’attribuer le visiteur pour filtrer les données et Explorer à partir d’un rapport principal dans un rapport détaillé.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-178">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="a9bf3-179">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="a9bf3-179">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a9bf3-180">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="a9bf3-180">About the Author</span></span>

<span data-ttu-id="a9bf3-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a9bf3-182">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-182">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a9bf3-183">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a9bf3-183">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a9bf3-184">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-184">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a9bf3-185">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a9bf3-185">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a9bf3-186">Remerciements</span><span class="sxs-lookup"><span data-stu-id="a9bf3-186">Special Thanks To</span></span>

<span data-ttu-id="a9bf3-187">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-187">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a9bf3-188">Entraîner un réviseur pour ce didacticiel a été Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="a9bf3-188">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="a9bf3-189">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="a9bf3-189">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a9bf3-190">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a9bf3-190">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="a9bf3-191">Précédent</span><span class="sxs-lookup"><span data-stu-id="a9bf3-191">Previous</span></span>](declarative-parameters-vb.md)
