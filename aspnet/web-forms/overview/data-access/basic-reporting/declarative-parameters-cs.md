---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-cs
title: Paramètres déclaratifs (C#) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons expliquer comment utiliser un paramètre défini sur une valeur codée en dur pour sélectionner les données à afficher dans un contrôle DetailsView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 603c9bd3-b895-4ec6-853b-0c81ff36d580
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-cs
msc.type: authoredcontent
ms.openlocfilehash: 87c8cfe064abc536e6015b0e553618981da9fefe
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78597271"
---
# <a name="declarative-parameters-c"></a><span data-ttu-id="c5ae8-103">Paramètres déclaratifs (C#)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-103">Declarative Parameters (C#)</span></span>

<span data-ttu-id="c5ae8-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c5ae8-105">[Télécharger l’exemple d’application](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_5_CS.exe) ou [Télécharger le PDF](declarative-parameters-cs/_static/datatutorial05cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-105">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_5_CS.exe) or [Download PDF](declarative-parameters-cs/_static/datatutorial05cs1.pdf)</span></span>

> <span data-ttu-id="c5ae8-106">Dans ce didacticiel, nous allons expliquer comment utiliser un paramètre défini sur une valeur codée en dur pour sélectionner les données à afficher dans un contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="c5ae8-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="c5ae8-107">Introduction</span></span>

<span data-ttu-id="c5ae8-108">Dans le [dernier didacticiel](displaying-data-with-the-objectdatasource-cs.md) , nous avons examiné l’affichage des données avec les contrôles GridView, DetailsView et FormView liés à un contrôle ObjectDataSource qui a appelé la méthode `GetProducts()` à partir de la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-108">In the [last tutorial](displaying-data-with-the-objectdatasource-cs.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="c5ae8-109">La méthode `GetProducts()` retourne un DataTable fortement typé rempli avec tous les enregistrements de la table `Products` de la base de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="c5ae8-110">La classe `ProductsBLL` contient des méthodes supplémentaires pour retourner uniquement des sous-ensembles des produits-`GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`et `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="c5ae8-111">Ces trois méthodes attendent un paramètre d’entrée indiquant comment filtrer les informations sur les produits retournés.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="c5ae8-112">ObjectDataSource peut être utilisé pour appeler des méthodes qui attendent des paramètres d’entrée, mais pour ce faire, nous devons spécifier l’origine des valeurs de ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="c5ae8-113">Les valeurs de paramètre peuvent être codées en dur ou provenir de diverses sources dynamiques, notamment les valeurs QueryString, les variables de session, la valeur de propriété d’un contrôle Web sur la page, ou d’autres.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="c5ae8-114">Pour ce didacticiel, commençons par illustrer l’utilisation d’un paramètre défini sur une valeur codée en dur.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="c5ae8-115">Plus précisément, nous examinerons l’ajout d’un DetailsView à la page qui affiche des informations sur un produit spécifique, à savoir chef Gumbo Mix, qui a une `ProductID` de 5.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="c5ae8-116">Ensuite, nous verrons comment définir la valeur de paramètre en fonction d’un contrôle Web.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="c5ae8-117">En particulier, nous allons utiliser une zone de texte pour permettre à l’utilisateur de taper un pays, après quoi il pourra cliquer sur un bouton pour afficher la liste des fournisseurs qui résident dans ce pays.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="c5ae8-118">Utilisation d’une valeur de paramètre codée en dur</span><span class="sxs-lookup"><span data-stu-id="c5ae8-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="c5ae8-119">Pour le premier exemple, commencez par ajouter un contrôle DetailsView à la page `DeclarativeParams.aspx` dans le dossier `BasicReporting`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="c5ae8-120">À partir de la balise active du contrôle DetailsView, sélectionnez &lt;nouvelle source de données&gt; dans la liste déroulante et choisissez d’ajouter un ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="c5ae8-121">[![ajouter un ObjectDataSource à la page](declarative-parameters-cs/_static/image2.png)](declarative-parameters-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-121">[![Add an ObjectDataSource to the Page](declarative-parameters-cs/_static/image2.png)](declarative-parameters-cs/_static/image1.png)</span></span>

<span data-ttu-id="c5ae8-122">**Figure 1**: ajouter un ObjectDataSource à la page ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-cs/_static/image3.png))</span></span>

<span data-ttu-id="c5ae8-123">L’assistant choisir la source de données s’affiche automatiquement.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="c5ae8-124">Sélectionnez la classe `ProductsBLL` dans le premier écran de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="c5ae8-125">[![sélectionnez la classe ProductsBLL](declarative-parameters-cs/_static/image5.png)](declarative-parameters-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-125">[![Select the ProductsBLL Class](declarative-parameters-cs/_static/image5.png)](declarative-parameters-cs/_static/image4.png)</span></span>

<span data-ttu-id="c5ae8-126">**Figure 2**: sélectionner la classe de `ProductsBLL` ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-cs/_static/image6.png))</span></span>

<span data-ttu-id="c5ae8-127">Étant donné que nous souhaitons afficher des informations sur un produit particulier, nous souhaitons utiliser la méthode `GetProductByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="c5ae8-128">[![choisir la méthode GetProductByProductID (productID)](declarative-parameters-cs/_static/image8.png)](declarative-parameters-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-cs/_static/image8.png)](declarative-parameters-cs/_static/image7.png)</span></span>

<span data-ttu-id="c5ae8-129">**Figure 3**: choisir la méthode `GetProductByProductID(productID)` ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-cs/_static/image9.png))</span></span>

<span data-ttu-id="c5ae8-130">Étant donné que la méthode que nous avons sélectionnée inclut un paramètre, il y a un autre écran pour l’Assistant, où nous sommes invités à définir la valeur à utiliser pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="c5ae8-131">La liste à gauche montre tous les paramètres de la méthode sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="c5ae8-132">Pour `GetProductByProductID(productID)` il n’existe qu’une seule `productID`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="c5ae8-133">À droite, nous pouvons spécifier la valeur du paramètre sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="c5ae8-134">La liste déroulante source de paramètres énumère les différentes sources possibles pour la valeur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="c5ae8-135">Étant donné que nous voulons spécifier une valeur codée en dur de 5 pour le paramètre `productID`, laissez la source de paramètre la valeur None et entrez 5 dans la zone de texte DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="c5ae8-136">[![une valeur de paramètre codée en dur de 5 sera utilisée pour le paramètre productID](declarative-parameters-cs/_static/image11.png)](declarative-parameters-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-cs/_static/image11.png)](declarative-parameters-cs/_static/image10.png)</span></span>

<span data-ttu-id="c5ae8-137">**Figure 4**: une valeur de paramètre codée en dur de 5 sera utilisée pour le paramètre `productID` ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-cs/_static/image12.png))</span></span>

<span data-ttu-id="c5ae8-138">À l’issue de l’exécution de l’Assistant Configuration de la source de données, le balisage déclaratif du contrôle ObjectDataSource comprend un objet `Parameter` dans la collection `SelectParameters` pour chacun des paramètres d’entrée attendus par la méthode définie dans la propriété `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="c5ae8-139">Étant donné que la méthode que nous utilisons dans cet exemple s’attend à un seul paramètre d’entrée, `parameterID`, il n’y a qu’une seule entrée ici.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="c5ae8-140">La collection `SelectParameters` peut contenir toute classe qui dérive de la classe `Parameter` de l’espace de noms `System.Web.UI.WebControls`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="c5ae8-141">Pour les valeurs de paramètre codées en dur, la classe de `Parameter` de base est utilisée, mais pour les autres options de source de paramètres, une classe de `Parameter` dérivée est utilisée ; vous pouvez également créer vos propres [types de paramètres personnalisés](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-cs/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="c5ae8-142">Si vous effectuez la procédure suivante sur votre ordinateur, le balisage déclaratif que vous voyez à ce stade peut inclure des valeurs pour les propriétés `InsertMethod`, `UpdateMethod`et `DeleteMethod`, ainsi que des `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="c5ae8-143">L’assistant choisir la source de données de ObjectDataSource spécifie automatiquement les méthodes de l' `ProductBLL` à utiliser pour l’insertion, la mise à jour et la suppression. par conséquent, à moins que vous n’ayez explicitement effacé ces méthodes, elles sont incluses dans le balisage ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="c5ae8-144">Quand vous visitez cette page, le contrôle Web de données appelle la méthode d’ObjectDataSource `Select`, qui appelle la méthode `GetProductByProductID(productID)` de la classe `ProductsBLL` à l’aide de la valeur codée en dur de 5 pour le paramètre d’entrée `productID`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="c5ae8-145">La méthode retourne un objet `ProductDataTable` fortement typé qui contient une seule ligne avec des informations sur la combinaison Gumbo de chef Anton (le produit avec `ProductID` 5).</span><span class="sxs-lookup"><span data-stu-id="c5ae8-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="c5ae8-146">[![plus d’informations sur la combinaison Gumbo de chef Anton sont affichées.](declarative-parameters-cs/_static/image14.png)](declarative-parameters-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-cs/_static/image14.png)](declarative-parameters-cs/_static/image13.png)</span></span>

<span data-ttu-id="c5ae8-147">**Figure 5**: affichage des informations sur la combinaison Gumbo de chef Anton ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-cs/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="c5ae8-148">Définition de la valeur de paramètre sur la valeur de propriété d’un contrôle Web</span><span class="sxs-lookup"><span data-stu-id="c5ae8-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="c5ae8-149">Les valeurs de paramètre de ObjectDataSource peuvent également être définies en fonction de la valeur d’un contrôle Web sur la page.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="c5ae8-150">Pour illustrer cela, nous allons avoir un GridView qui répertorie tous les fournisseurs situés dans un pays spécifié par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="c5ae8-151">Pour ce faire, commencez par ajouter une zone de texte à la page dans laquelle l’utilisateur peut entrer un nom de pays.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="c5ae8-152">Affectez à la propriété `ID` de ce contrôle TextBox la valeur `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="c5ae8-153">Ajoutez également un contrôle Web Button.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-153">Also add a Button Web control.</span></span>

<span data-ttu-id="c5ae8-154">[![ajouter une zone de texte à la page avec l’ID CountryName](declarative-parameters-cs/_static/image17.png)](declarative-parameters-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-cs/_static/image17.png)](declarative-parameters-cs/_static/image16.png)</span></span>

<span data-ttu-id="c5ae8-155">**Figure 6**: ajouter une zone de texte à la Page avec `ID` `CountryName` ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-cs/_static/image18.png))</span></span>

<span data-ttu-id="c5ae8-156">Ensuite, ajoutez un contrôle GridView à la page et, à partir de la balise active, choisissez d’ajouter un nouvel ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="c5ae8-157">Dans la mesure où nous souhaitons afficher des informations sur les fournisseurs, sélectionnez la classe `SuppliersBLL` dans le premier écran de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="c5ae8-158">Dans le deuxième écran, choisissez la méthode `GetSuppliersByCountry(country)`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="c5ae8-159">[![choisir la méthode GetSuppliersByCountry (Country)](declarative-parameters-cs/_static/image20.png)](declarative-parameters-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-cs/_static/image20.png)](declarative-parameters-cs/_static/image19.png)</span></span>

<span data-ttu-id="c5ae8-160">**Figure 7**: choisir la méthode de `GetSuppliersByCountry(country)` ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-cs/_static/image21.png))</span></span>

<span data-ttu-id="c5ae8-161">Étant donné que la méthode `GetSuppliersByCountry(country)` possède un paramètre d’entrée, l’Assistant inclut une nouvelle fois un écran final pour le choix de la valeur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="c5ae8-162">Cette fois-ci, définissez la source du paramètre sur Control.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="c5ae8-163">La liste déroulante ControlID est renseignée avec les noms des contrôles sur la page ; Sélectionnez le contrôle `CountryName` dans la liste.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="c5ae8-164">Lorsque la page est visitée pour la première fois, la zone de texte `CountryName` est vide, de sorte qu’aucun résultat n’est retourné et rien ne s’affiche.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="c5ae8-165">Si vous souhaitez afficher des résultats par défaut, définissez la zone de texte DefaultValue en conséquence.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="c5ae8-166">[![définir la valeur du paramètre sur la valeur du contrôle CountryName](declarative-parameters-cs/_static/image23.png)](declarative-parameters-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-cs/_static/image23.png)](declarative-parameters-cs/_static/image22.png)</span></span>

<span data-ttu-id="c5ae8-167">**Figure 8**: définir la valeur du paramètre sur la valeur de contrôle `CountryName` ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-cs/_static/image24.png))</span></span>

<span data-ttu-id="c5ae8-168">Le balisage déclaratif de ObjectDataSource diffère légèrement de notre premier exemple, à l’aide d’un [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) au lieu de l’objet `Parameter` standard.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="c5ae8-169">Un `ControlParameter` possède des propriétés supplémentaires pour spécifier la `ID` du contrôle Web et la valeur de propriété à utiliser pour le paramètre (`PropertyName`).</span><span class="sxs-lookup"><span data-stu-id="c5ae8-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="c5ae8-170">L’Assistant Configuration de la source de données était suffisamment intelligent pour déterminer que, pour une zone de texte, nous souhaitons probablement utiliser la propriété `Text` pour la valeur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="c5ae8-171">Toutefois, si vous souhaitez utiliser une valeur de propriété différente du contrôle Web, vous pouvez modifier la valeur de `PropertyName` ici ou en cliquant sur le lien « Afficher les propriétés avancées » dans l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-cs/samples/sample2.aspx)]

<span data-ttu-id="c5ae8-172">Lorsque vous visitez la page pour la première fois, la zone de texte `CountryName` est vide.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="c5ae8-173">La méthode de `Select` de l’ObjectDataSource est toujours appelée par le GridView, mais une valeur de `null` est passée à la méthode `GetSuppliersByCountry(country)`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `null` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="c5ae8-174">Le TableAdapter convertit le `null` en une valeur de `NULL` de base de données (`DBNull.Value`), mais la requête utilisée par la méthode `GetSuppliersByCountry(country)` est écrite de telle sorte qu’elle ne retourne aucune valeur quand une valeur `NULL` est spécifiée pour le paramètre `@CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-174">The TableAdapter converts the `null` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="c5ae8-175">En bref, aucun fournisseur n’est retourné.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="c5ae8-176">Toutefois, une fois que le visiteur entre dans un pays, et clique sur le bouton afficher les fournisseurs pour déclencher une publication, la méthode de `Select` ObjectDataSource est réinterrogée, passant la valeur `Text` du contrôle TextBox comme paramètre `country`.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="c5ae8-177">[![ces fournisseurs à partir du Canada sont affichés](declarative-parameters-cs/_static/image26.png)](declarative-parameters-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-177">[![Those Suppliers from Canada are Shown](declarative-parameters-cs/_static/image26.png)](declarative-parameters-cs/_static/image25.png)</span></span>

<span data-ttu-id="c5ae8-178">**Figure 9**: les fournisseurs du Canada sont affichés ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-cs/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="c5ae8-179">Montrer tous les fournisseurs par défaut</span><span class="sxs-lookup"><span data-stu-id="c5ae8-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="c5ae8-180">Au lieu d’afficher aucun des fournisseurs lorsque vous affichez la page pour la première fois, nous pouvons afficher *tous les* fournisseurs dans un premier temps, ce qui permet à l’utilisateur de faire défiler la liste en entrant un nom de pays dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="c5ae8-181">Lorsque la zone de texte est vide, la méthode `GetSuppliersByCountry(country)` de la classe `SuppliersBLL` est passée dans une valeur `null` pour son paramètre d’entrée *`country`* .</span><span class="sxs-lookup"><span data-stu-id="c5ae8-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in a `null` value for its *`country`* input parameter.</span></span> <span data-ttu-id="c5ae8-182">Cette valeur `null` est ensuite passée dans la méthode `GetSupplierByCountry(country)` de la couche DAL, où elle est traduite en valeur de `NULL` de base de données pour le paramètre `@Country` dans la requête suivante :</span><span class="sxs-lookup"><span data-stu-id="c5ae8-182">This `null` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-cs/samples/sample3.sql)]

<span data-ttu-id="c5ae8-183">L’expression `Country = NULL` retourne toujours false, même pour les enregistrements dont la colonne `Country` a une valeur `NULL` ; par conséquent, aucun enregistrement n’est retourné.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="c5ae8-184">Pour retourner *tous les* fournisseurs lorsque la zone de texte Country est vide, nous pouvons augmenter la méthode `GetSuppliersByCountry(country)` dans la couche BLL pour appeler la méthode `GetSuppliers()` quand son paramètre country est `null` et appeler la méthode `GetSuppliersByCountry(country)` de la couche DAL dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `null` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="c5ae8-185">Cela aura pour effet de retourner tous les fournisseurs quand aucun pays n’est spécifié et le sous-ensemble approprié de fournisseurs lorsque le paramètre Country est inclus.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="c5ae8-186">Remplacez la méthode `GetSuppliersByCountry(country)` de la classe `SuppliersBLL` par la méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="c5ae8-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-csharp[Main](declarative-parameters-cs/samples/sample4.cs)]

<span data-ttu-id="c5ae8-187">Avec cette modification, la page `DeclarativeParams.aspx` affiche tous les fournisseurs lors de la première visite (ou chaque fois que la zone de texte `CountryName` est vide).</span><span class="sxs-lookup"><span data-stu-id="c5ae8-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="c5ae8-188">[![tous les fournisseurs sont maintenant affichés par défaut](declarative-parameters-cs/_static/image29.png)](declarative-parameters-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-188">[![All Suppliers are Now Shown by Default](declarative-parameters-cs/_static/image29.png)](declarative-parameters-cs/_static/image28.png)</span></span>

<span data-ttu-id="c5ae8-189">**Figure 10**: tous les fournisseurs sont maintenant affichés par défaut ([cliquez pour afficher l’image en taille réelle](declarative-parameters-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="c5ae8-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-cs/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="c5ae8-190">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="c5ae8-190">Summary</span></span>

<span data-ttu-id="c5ae8-191">Pour pouvoir utiliser des méthodes avec des paramètres d’entrée, nous devons spécifier les valeurs des paramètres dans la collection de `SelectParameters` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="c5ae8-192">Les différents types de paramètres permettent d’obtenir la valeur de paramètre à partir de différentes sources.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="c5ae8-193">Le type de paramètre par défaut utilise une valeur codée en dur, mais tout aussi facilement (et sans ligne de code), des valeurs de paramètre peuvent être obtenues à partir de la QueryString, des variables de session, des cookies et même des valeurs entrées par l’utilisateur dans les contrôles Web de la page.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="c5ae8-194">Les exemples que nous avons examinés dans ce didacticiel illustrent l’utilisation de valeurs de paramètre déclaratives.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="c5ae8-195">Toutefois, il peut arriver que vous deviez utiliser une source de paramètre qui n’est pas disponible, telle que la date et l’heure actuelles ou, si notre site utilisait l’appartenance, l’ID d’utilisateur du visiteur.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="c5ae8-196">Dans de tels scénarios, nous pouvons définir les valeurs de paramètre par programmation avant l’ObjectDataSource qui appelle la méthode de l’objet sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="c5ae8-197">Nous verrons comment effectuer cette procédure dans le [prochain didacticiel](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md).</span><span class="sxs-lookup"><span data-stu-id="c5ae8-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md).</span></span>

<span data-ttu-id="c5ae8-198">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="c5ae8-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c5ae8-199">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="c5ae8-199">About the Author</span></span>

<span data-ttu-id="c5ae8-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c5ae8-201">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c5ae8-202">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c5ae8-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c5ae8-203">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c5ae8-204">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c5ae8-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c5ae8-205">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="c5ae8-205">Special Thanks To</span></span>

<span data-ttu-id="c5ae8-206">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c5ae8-207">Le réviseur de leads pour ce didacticiel était Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="c5ae8-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="c5ae8-208">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="c5ae8-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c5ae8-209">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c5ae8-210">[Précédent](displaying-data-with-the-objectdatasource-cs.md)
> [Suivant](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)</span><span class="sxs-lookup"><span data-stu-id="c5ae8-210">[Previous](displaying-data-with-the-objectdatasource-cs.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)</span></span>
