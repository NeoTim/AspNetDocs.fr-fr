---
uid: web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-cs
title: Contrôle l’affichage de données binaires dans le site Web de données (c#) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous examinons les options de présenter des données binaires sur une page Web, y compris l’affichage d’un fichier image et la fourniture d’un lien 'Télécharger' f...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: 5cbeb9f8-5f92-4ba8-87ae-0b4d460ae6d4
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-cs
msc.type: authoredcontent
ms.openlocfilehash: c6c41ba5b5414da689e63ef521f1cf22e0b55701
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59404284"
---
# <a name="displaying-binary-data-in-the-data-web-controls-c"></a><span data-ttu-id="d1eeb-103">Affichage de données binaires dans les contrôles web de données (C#)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-103">Displaying Binary Data in the Data Web Controls (C#)</span></span>

<span data-ttu-id="d1eeb-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d1eeb-105">[Télécharger l’exemple d’application](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_CS.exe) ou [télécharger le PDF](displaying-binary-data-in-the-data-web-controls-cs/_static/datatutorial55cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_CS.exe) or [Download PDF](displaying-binary-data-in-the-data-web-controls-cs/_static/datatutorial55cs1.pdf)</span></span>

> <span data-ttu-id="d1eeb-106">Dans ce didacticiel, nous examiner les options de présenter des données binaires sur une page Web, y compris l’affichage d’un fichier image et la fourniture d’un lien « Télécharger » pour un fichier PDF.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-106">In this tutorial we look at the options to present binary data on a Web page, including the display of an image file and the provision of a 'Download' link for a PDF file.</span></span>


## <a name="introduction"></a><span data-ttu-id="d1eeb-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="d1eeb-107">Introduction</span></span>

<span data-ttu-id="d1eeb-108">Dans le didacticiel précédent, nous exploré les deux techniques permettant d’associer des données binaires à un modèle de données sous-jacent application s et du contrôle FileUpload permet de charger des fichiers à partir d’un navigateur sur le système de fichiers web server s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-108">In the preceding tutorial we explored the two techniques for associating binary data with an application s underlying data model and used the FileUpload control to upload files from a browser to the web server s file system.</span></span> <span data-ttu-id="d1eeb-109">Nous ve encore pour voir comment associer les données binaires téléchargées avec le modèle de données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-109">We ve yet to see how to associate the uploaded binary data with the data model.</span></span> <span data-ttu-id="d1eeb-110">Autrement dit, une fois un fichier a été téléchargé et enregistré dans le système de fichiers, un chemin d’accès au fichier doit figurer dans l’enregistrement de base de données appropriée.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-110">That is, after a file has been uploaded and saved to the file system, a path to the file must be stored in the appropriate database record.</span></span> <span data-ttu-id="d1eeb-111">Si les données sont en cours stockées directement dans la base de données, les données binaires téléchargées ne doivent pas être enregistrées dans le système de fichiers, mais il doivent être injectées dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-111">If the data is being stored directly in the database, then the uploaded binary data need not be saved to the file system, but must be injected into the database.</span></span>

<span data-ttu-id="d1eeb-112">Avant d’examiner associant les données avec le modèle de données, cependant, permettent de s commencer par examiner comment fournir les données binaires à l’utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-112">Before we look at associating the data with the data model, though, let s first look at how to provide the binary data to the end user.</span></span> <span data-ttu-id="d1eeb-113">Présentation des données de texte est assez simple, mais comment les données binaires doivent être présentées ?</span><span class="sxs-lookup"><span data-stu-id="d1eeb-113">Presenting text data is simple enough, but how should binary data be presented?</span></span> <span data-ttu-id="d1eeb-114">Il dépend, bien sûr, le type de données binaires.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-114">It depends, of course, on the type of binary data.</span></span> <span data-ttu-id="d1eeb-115">Pour les images, nous souhaitons probablement afficher l’image ; pour les fichiers PDF, documents Microsoft Word, les fichiers ZIP et les autres types de données binaires, en fournissant un lien de téléchargement est probablement plus appropriés.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-115">For images, we likely want to display the image; for PDFs, Microsoft Word documents, ZIP files, and other types of binary data, providing a Download link is probably more appropriate.</span></span>

<span data-ttu-id="d1eeb-116">Dans ce didacticiel, que nous allons examiner comment présenter les données binaires en même temps que ses données de texte associée à l’aide de données de contrôles Web tels que GridView et DetailsView.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-116">In this tutorial we will look at how to present the binary data alongside its associated text data using data Web controls like the GridView and DetailsView.</span></span> <span data-ttu-id="d1eeb-117">Dans le didacticiel suivant, nous allons porter notre attention associer un fichier téléchargé à la base de données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-117">In the next tutorial we'll turn our attention to associating an uploaded file with the database.</span></span>

## <a name="step-1-providingbrochurepathvalues"></a><span data-ttu-id="d1eeb-118">Étape 1 : Fournissant`BrochurePath`valeurs</span><span class="sxs-lookup"><span data-stu-id="d1eeb-118">Step 1: Providing`BrochurePath`Values</span></span>

<span data-ttu-id="d1eeb-119">Le `Picture` colonne dans la `Categories` table contient déjà des données binaires pour les différentes images de catégorie.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-119">The `Picture` column in the `Categories` table already contains binary data for the various category images.</span></span> <span data-ttu-id="d1eeb-120">Plus précisément, le `Picture` colonne pour chaque enregistrement contient le contenu binaire d’une image bitmap granuleuse faible qualité, 16 couleurs.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-120">Specifically, the `Picture` column for each record holds the binary contents of a grainy, low-quality, 16-color bitmap image.</span></span> <span data-ttu-id="d1eeb-121">Chaque image de la catégorie est 172 pixels de larges et 120 pixels de hauteur et consomme environ 11 Ko.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-121">Each category image is 172 pixels wide and 120 pixels tall and consumes roughly 11 KB.</span></span> <span data-ttu-id="d1eeb-122">Nouveautés plus, le contenu binaire dans le `Picture` colonne inclut un octet de 78 [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) en-tête doit être supprimé avant d’afficher l’image.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-122">What s more, the binary content in the `Picture` column includes a 78-byte [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) header that must be stripped before displaying the image.</span></span> <span data-ttu-id="d1eeb-123">Ces informations d’en-tête sont présentes, car la base de données Northwind a ses racines dans Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-123">This header information is present because the Northwind database has its roots in Microsoft Access.</span></span> <span data-ttu-id="d1eeb-124">Dans Access, les données binaires sont stockées à l’aide du type de données OLE Object, qui s’attache à cet en-tête.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-124">In Access, binary data is stored using the OLE Object data type, which tacks on this header.</span></span> <span data-ttu-id="d1eeb-125">Pour l’instant, nous verrons comment supprimer les en-têtes à partir de ces images de basse qualité afin d’afficher l’image.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-125">For now, we'll see how to strip the headers from these low-quality images in order to display the picture.</span></span> <span data-ttu-id="d1eeb-126">Dans un futur didacticiel, nous allons créer une interface pour la mise à jour une catégorie s `Picture` colonne et remplacer ces images bitmap qui utilisent des en-têtes OLE avec des images JPG équivalents sans les en-têtes OLE inutiles.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-126">In a future tutorial we'll build an interface for updating a category s `Picture` column and replace these bitmap images that use OLE headers with equivalent JPG images without the unnecessary OLE headers.</span></span>

<span data-ttu-id="d1eeb-127">Dans le didacticiel précédent, nous avons vu comment utiliser le contrôle FileUpload.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-127">In the preceding tutorial we saw how to use the FileUpload control.</span></span> <span data-ttu-id="d1eeb-128">Par conséquent, vous pouvez poursuivre et ajouter des fichiers de la brochure au système de fichiers web server s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-128">Therefore, you can go ahead and add brochure files to the web server s file system.</span></span> <span data-ttu-id="d1eeb-129">Ce faisant, toutefois, ne pas mettre à jour le `BrochurePath` colonne dans la `Categories` table.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-129">Doing so, however, does not update the `BrochurePath` column in the `Categories` table.</span></span> <span data-ttu-id="d1eeb-130">Dans le didacticiel suivant, nous allons voir comment effectuer cette opération, mais pour l’instant, nous avons besoin fournir manuellement des valeurs pour cette colonne.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-130">In the next tutorial we'll see how to accomplish this, but for now we need to manually provide values for this column.</span></span>

<span data-ttu-id="d1eeb-131">Dans ce téléchargement didacticiel s, vous trouverez sept fichiers de brochure PDF dans le `~/Brochures` dossier, un pour chacune des catégories, à l’exception Seafood.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-131">In this tutorial s download you'll find seven PDF brochure files in the `~/Brochures` folder, one for each of the categories except Seafood.</span></span> <span data-ttu-id="d1eeb-132">J’ai omis volontairement l’ajout d’une brochure Seafood pour illustrer comment gérer les scénarios où pas tous les enregistrements ont données binaires associées données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-132">I purposefully omitted adding a Seafood brochure to illustrate how to handle scenarios where not all records have associated binary data.</span></span> <span data-ttu-id="d1eeb-133">Pour mettre à jour le `Categories` table avec ces valeurs, avec le bouton droit sur le `Categories` nœud à partir de l’Explorateur de serveurs et choisissez Afficher les données de Table.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-133">To update the `Categories` table with these values, right-click on the `Categories` node from Server Explorer and choose Show Table Data.</span></span> <span data-ttu-id="d1eeb-134">Ensuite, entrez les chemins d’accès virtuels pour les fichiers de la brochure pour chaque catégorie qui présente une brochure, comme montre la Figure 1.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-134">Then, enter the virtual paths to the brochure files for each category that has a brochure, as Figure 1 shows.</span></span> <span data-ttu-id="d1eeb-135">Dans la mesure où il n’existe aucun brochure pour la catégorie de produits de la mer, laissez son `BrochurePath` valeur de colonne s `NULL`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-135">Since there is no brochure for the Seafood category, leave its `BrochurePath` column s value as `NULL`.</span></span>


<span data-ttu-id="d1eeb-136">[![Entrez manuellement les valeurs pour la colonne BrochurePath catégories s](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-136">[![Manually Enter the Values for the Categories Table s BrochurePath Column](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.png)</span></span>

<span data-ttu-id="d1eeb-137">**Figure 1**: Entrez manuellement les valeurs pour le `Categories` Table s `BrochurePath` colonne ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-137">**Figure 1**: Manually Enter the Values for the `Categories` Table s `BrochurePath` Column ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.png))</span></span>


## <a name="step-2-providing-a-download-link-for-the-brochures-in-a-gridview"></a><span data-ttu-id="d1eeb-138">Étape 2 : En fournissant un lien de téléchargement pour les Brochures dans un GridView</span><span class="sxs-lookup"><span data-stu-id="d1eeb-138">Step 2: Providing a Download Link for the Brochures in a GridView</span></span>

<span data-ttu-id="d1eeb-139">Avec le `BrochurePath` valeurs fournies pour le `Categories` table, nous vous êtes prêt à créer un GridView qui répertorie chaque catégorie, ainsi qu’un lien pour télécharger la brochure catégorie s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-139">With the `BrochurePath` values provided for the `Categories` table, we re ready to create a GridView that lists each category along with a link to download the category s brochure.</span></span> <span data-ttu-id="d1eeb-140">À l’étape 4, nous allons étendre cette GridView pour afficher également l’image de catégorie s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-140">In Step 4 we'll extend this GridView to also display the category s image.</span></span>

<span data-ttu-id="d1eeb-141">Nous allons faire glisser un GridView à partir de la boîte à outils vers le Concepteur de la `DisplayOrDownloadData.aspx` page dans le `BinaryData` dossier.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-141">Start by dragging a GridView from the Toolbox onto the Designer of the `DisplayOrDownloadData.aspx` page in the `BinaryData` folder.</span></span> <span data-ttu-id="d1eeb-142">Définir les opérations de mappage GridView `ID` à `Categories` via la balise active de s GridView, choisissez de le lier à une source de données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-142">Set the GridView s `ID` to `Categories` and through the GridView s smart tag, choose to bind it to a new data source.</span></span> <span data-ttu-id="d1eeb-143">Plus précisément, liez-le à un ObjectDataSource nommé `CategoriesDataSource` qui Récupère des données à l’aide du `CategoriesBLL` objet s `GetCategories()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-143">Specifically, bind it to an ObjectDataSource named `CategoriesDataSource` that retrieves data using the `CategoriesBLL` object s `GetCategories()` method.</span></span>


<span data-ttu-id="d1eeb-144">[![Créer un nouveau ObjectDataSource nommé CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-144">[![Create a New ObjectDataSource Named CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.png)</span></span>

<span data-ttu-id="d1eeb-145">**Figure 2**: Créer une nouvelle nommée de ObjectDataSource `CategoriesDataSource` ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-145">**Figure 2**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.png))</span></span>


<span data-ttu-id="d1eeb-146">[![Configurer pour utiliser la classe CategoriesBLL ObjectDataSource](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-146">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.png)</span></span>

<span data-ttu-id="d1eeb-147">**Figure 3**: Configurer l’ObjectDataSource à utiliser le `CategoriesBLL` classe ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-147">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image6.png))</span></span>


<span data-ttu-id="d1eeb-148">[![Récupérer la liste des catégories à l’aide de la méthode GetCategories()](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-148">[![Retrieve the List of Categories Using the GetCategories() Method](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.png)</span></span>

<span data-ttu-id="d1eeb-149">**Figure 4**: Récupérer la liste de catégories en utilisant le `GetCategories()` (méthode) ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-149">**Figure 4**: Retrieve the List of Categories Using the `GetCategories()` Method ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.png))</span></span>


<span data-ttu-id="d1eeb-150">À l’issue de l’Assistant Configurer la Source de données, Visual Studio ajoute automatiquement un BoundField à la `Categories` GridView pour les `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, et `BrochurePath` `DataColumn` s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-150">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField to the `Categories` GridView for the `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath` `DataColumn` s.</span></span> <span data-ttu-id="d1eeb-151">Poursuivre et supprimer le `NumberOfProducts` BoundField depuis le `GetCategories()` requête de méthode s ne récupère pas de ces informations.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-151">Go ahead and remove the `NumberOfProducts` BoundField since the `GetCategories()` method s query does not retrieve this information.</span></span> <span data-ttu-id="d1eeb-152">Supprimer également le `CategoryID` BoundField et renommer le `CategoryName` et `BrochurePath` BoundFields `HeaderText` propriétés à la catégorie et de la Brochure, respectivement.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-152">Also remove the `CategoryID` BoundField and rename the `CategoryName` and `BrochurePath` BoundFields `HeaderText` properties to Category and Brochure, respectively.</span></span> <span data-ttu-id="d1eeb-153">Après avoir apporté ces modifications, votre balisage déclaratif s GridView et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="d1eeb-153">After making these changes, your GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample1.aspx)]

<span data-ttu-id="d1eeb-154">Afficher cette page via un navigateur (voir Figure 5).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-154">View this page through a browser (see Figure 5).</span></span> <span data-ttu-id="d1eeb-155">Chacune des huit catégories est répertorié.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-155">Each of the eight categories is listed.</span></span> <span data-ttu-id="d1eeb-156">Les sept catégories avec `BrochurePath` valeurs ont le `BrochurePath` valeur affichée dans le BoundField respectif.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-156">The seven categories with `BrochurePath` values have the `BrochurePath` value displayed in the respective BoundField.</span></span> <span data-ttu-id="d1eeb-157">Mer, ce qui a un `NULL` valeur pour son `BrochurePath`, affiche une cellule vide.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-157">Seafood, which has a `NULL` value for its `BrochurePath`, displays an empty cell.</span></span>


<span data-ttu-id="d1eeb-158">[![Chaque catégorie s nom, Description et une valeur de BrochurePath est répertorié.](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-158">[![Each Category s Name, Description, and BrochurePath Value is Listed](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image9.png)</span></span>

<span data-ttu-id="d1eeb-159">**Figure 5**: Chaque catégorie s nom, Description, et `BrochurePath` valeur est répertoriée ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-159">**Figure 5**: Each Category s Name, Description, and `BrochurePath` Value is Listed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.png))</span></span>


<span data-ttu-id="d1eeb-160">Au lieu d’afficher le texte de la `BrochurePath` colonne, nous voulons créer un lien vers la brochure.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-160">Rather than displaying the text of the `BrochurePath` column, we want to create a link to the brochure.</span></span> <span data-ttu-id="d1eeb-161">Pour ce faire, supprimez le `BrochurePath` BoundField et remplacez-le par un HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-161">To accomplish this, remove the `BrochurePath` BoundField and replace it with a HyperLinkField.</span></span> <span data-ttu-id="d1eeb-162">Définir la nouvelle s HyperLinkField `HeaderText` propriété Brochure, son `Text` propriété Brochure de vue et son `DataNavigateUrlFields` propriété `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-162">Set the new HyperLinkField s `HeaderText` property to Brochure, its `Text` property to View Brochure, and its `DataNavigateUrlFields` property to `BrochurePath`.</span></span>


![Ajouter un HyperLinkField pour BrochurePath](displaying-binary-data-in-the-data-web-controls-cs/_static/image6.gif)

<span data-ttu-id="d1eeb-164">**Figure 6**: Ajouter un HyperLinkField pour `BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="d1eeb-164">**Figure 6**: Add a HyperLinkField for `BrochurePath`</span></span>


<span data-ttu-id="d1eeb-165">Cette opération ajoute une colonne de liens au GridView, comme le montre la Figure 7.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-165">This will add a column of links to the GridView, as Figure 7 shows.</span></span> <span data-ttu-id="d1eeb-166">En cliquant sur un lien de vue Brochure sera afficher le fichier PDF directement dans le navigateur ou inviter l’utilisateur à télécharger le fichier, selon qu’un lecteur PDF est installé et les paramètres du navigateur s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-166">Clicking a View Brochure link will either display the PDF directly in the browser or prompt the user to download the file, depending on whether a PDF reader is installed and the browser s settings.</span></span>


<span data-ttu-id="d1eeb-167">[![Une catégorie s Brochure peut être affiché en cliquant sur le lien de la Brochure vue](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-167">[![A Category s Brochure Can Be Viewed by Clicking the View Brochure Link](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.png)</span></span>

<span data-ttu-id="d1eeb-168">**Figure 7**: Une catégorie s Brochure peuvent être affichés en cliquant sur le lien de la Brochure vue ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-168">**Figure 7**: A Category s Brochure Can Be Viewed by Clicking the View Brochure Link ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image12.png))</span></span>


<span data-ttu-id="d1eeb-169">[![La catégorie s Brochure PDF s’affiche.](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-169">[![The Category s Brochure PDF is Displayed](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.png)</span></span>

<span data-ttu-id="d1eeb-170">**Figure 8**: La catégorie s Brochure PDF est affichée ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-170">**Figure 8**: The Category s Brochure PDF is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image14.png))</span></span>


## <a name="hiding-the-view-brochure-text-for-categories-without-a-brochure"></a><span data-ttu-id="d1eeb-171">Masquer le texte de la Brochure vue pour les catégories sans une Brochure</span><span class="sxs-lookup"><span data-stu-id="d1eeb-171">Hiding the View Brochure Text for Categories Without a Brochure</span></span>

<span data-ttu-id="d1eeb-172">Comme le montre la Figure 7, le `BrochurePath` HyperLinkField affiche son `Text` la valeur de propriété (vue Brochure) pour tous les enregistrements, indépendamment de si là s non -`NULL` valeur pour `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-172">As Figure 7 shows, the `BrochurePath` HyperLinkField displays its `Text` property value ( View Brochure ) for all records, regardless of whether there s a non-`NULL` value for `BrochurePath`.</span></span> <span data-ttu-id="d1eeb-173">Bien sûr, si `BrochurePath` est `NULL`, puis le lien s’affiche sous forme de texte uniquement, comme c’est le cas avec la catégorie Seafood (voir la Figure 7).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-173">Of course, if `BrochurePath` is `NULL`, then the link is displayed as text only, as is the case with the Seafood category (refer back to Figure 7).</span></span> <span data-ttu-id="d1eeb-174">Au lieu d’afficher le texte Brochure de vue, il peut être intéressant d’avoir ces catégories sans un `BrochurePath` valeur afficher un texte de remplacement, comme non Brochure disponibles.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-174">Rather than displaying the text View Brochure, it might be nice to have those categories without a `BrochurePath` value display some alternate text, like No Brochure Available.</span></span>

<span data-ttu-id="d1eeb-175">Afin de fournir ce comportement, nous devons utiliser TemplateField dont le contenu est généré via un appel à une méthode de page qui émet la sortie appropriée selon la `BrochurePath` valeur.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-175">In order to provide this behavior, we need to use a TemplateField whose content is generated via a call to a page method that emits the appropriate output based on the `BrochurePath` value.</span></span> <span data-ttu-id="d1eeb-176">Nous avons tout d’abord examiné cette technique de mise en forme dans le [à l’aide de TemplateFields dans le contrôle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-176">We first explored this formatting technique back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial.</span></span>

<span data-ttu-id="d1eeb-177">Activer la HyperLinkField en TemplateField en sélectionnant le `BrochurePath` HyperLinkField et puis en cliquant sur la convertir ce champ en TemplateField lien dans la boîte de dialogue Modifier les colonnes.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-177">Turn the HyperLinkField into a TemplateField by selecting the `BrochurePath` HyperLinkField and then clicking on the Convert this field into a TemplateField link in the Edit Columns dialog box.</span></span>


![Convertir le HyperLinkField en TemplateField](displaying-binary-data-in-the-data-web-controls-cs/_static/image9.gif)

<span data-ttu-id="d1eeb-179">**Figure 9**: Convertir le HyperLinkField en TemplateField</span><span class="sxs-lookup"><span data-stu-id="d1eeb-179">**Figure 9**: Convert the HyperLinkField into a TemplateField</span></span>


<span data-ttu-id="d1eeb-180">Cela créera un TemplateField avec un `ItemTemplate` qui contient un site Web HyperLink contrôle dont `NavigateUrl` propriété est liée à la `BrochurePath` valeur.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-180">This will create a TemplateField with an `ItemTemplate` that contains a HyperLink Web control whose `NavigateUrl` property is bound to the `BrochurePath` value.</span></span> <span data-ttu-id="d1eeb-181">Remplacez cette balise par un appel à la méthode `GenerateBrochureLink`, en passant la valeur de `BrochurePath`:</span><span class="sxs-lookup"><span data-stu-id="d1eeb-181">Replace this markup with a call to the method `GenerateBrochureLink`, passing in the value of `BrochurePath`:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample2.aspx)]

<span data-ttu-id="d1eeb-182">Ensuite, créez un `protected` méthode dans l’ASP.NET page classe code-behind de s nommée `GenerateBrochureLink` qui retourne un `string` et accepte un `object` comme paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-182">Next, create a `protected` method in the ASP.NET page s code-behind class named `GenerateBrochureLink` that returns a `string` and accepts an `object` as an input parameter.</span></span>


[!code-csharp[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample3.cs)]

<span data-ttu-id="d1eeb-183">Cette méthode détermine si le passé dans `object` valeur est une base de données `NULL` et, dans ce cas, retourne un message indiquant que la catégorie ne dispose pas d’une brochure.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-183">This method determines if the passed-in `object` value is a database `NULL` and, if so, returns a message indicating that the category lacks a brochure.</span></span> <span data-ttu-id="d1eeb-184">Sinon, s’il existe un `BrochurePath` valeur, elle s’affiché dans un lien hypertexte.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-184">Otherwise, if there is a `BrochurePath` value, it s displayed in a hyperlink.</span></span> <span data-ttu-id="d1eeb-185">Notez que si le `BrochurePath` valeur est présente s passé dans le [ `ResolveUrl(url)` méthode](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-185">Note that if the `BrochurePath` value is present it s passed into the [`ResolveUrl(url)` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span></span> <span data-ttu-id="d1eeb-186">Cette méthode résout le passé dans *url*, en remplaçant le `~` caractère avec le chemin d’accès virtuel approprié.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-186">This method resolves the passed-in *url*, replacing the `~` character with the appropriate virtual path.</span></span> <span data-ttu-id="d1eeb-187">Par exemple, si l’application est enracinée au `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` retournera `/Tutorial55/Brochures/Meat.pdf`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-187">For example, if the application is rooted at `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` will return `/Tutorial55/Brochures/Meat.pdf`.</span></span>

<span data-ttu-id="d1eeb-188">Figure 10 montre la page une fois que ces modifications ont été appliquées.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-188">Figure 10 shows the page after these changes have been applied.</span></span> <span data-ttu-id="d1eeb-189">Notez que la catégorie Seafood s `BrochurePath` champ affiche maintenant le texte non Brochure disponibles.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-189">Note that the Seafood category s `BrochurePath` field now displays the text No Brochure Available .</span></span>


<span data-ttu-id="d1eeb-190">[![Texte non Brochure disponibles s’affiche pour les catégories sans une Brochure](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-190">[![The Text No Brochure Available is Displayed for Those Categories Without a Brochure](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image15.png)</span></span>

<span data-ttu-id="d1eeb-191">**Figure 10**: Texte non Brochure disponibles s’affiche pour les catégories sans une Brochure ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-191">**Figure 10**: The Text No Brochure Available is Displayed for Those Categories Without a Brochure ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image16.png))</span></span>


## <a name="step-3-adding-a-web-page-to-display-a-category-s-picture"></a><span data-ttu-id="d1eeb-192">Étape 3 : Ajout d’une Page Web pour afficher une image de s catégorie</span><span class="sxs-lookup"><span data-stu-id="d1eeb-192">Step 3: Adding a Web Page to Display a Category s Picture</span></span>

<span data-ttu-id="d1eeb-193">Lorsqu’un utilisateur visite une page ASP.NET, ils reçoivent la page s HTML ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-193">When a user visits an ASP.NET page, they receive the ASP.NET page s HTML.</span></span> <span data-ttu-id="d1eeb-194">Le HTML reçu est uniquement le texte et ne contient-elle pas toutes les données binaires.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-194">The received HTML is just text and does not contain any binary data.</span></span> <span data-ttu-id="d1eeb-195">Il existe des données binaires supplémentaires, telles que des images, fichiers audio, les applications de Macromedia Flash, embedded vidéos de Windows Media Player et ainsi de suite, comme des ressources distinctes sur le serveur web.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-195">Any additional binary data, such as images, sound files, Macromedia Flash applications, embedded Windows Media Player videos, and so forth, exist as separate resources on the web server.</span></span> <span data-ttu-id="d1eeb-196">Le code HTML contient des références à ces fichiers, mais n’inclut pas le contenu réel des fichiers.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-196">The HTML contains references to these files, but does not include the actual contents of the files.</span></span>

<span data-ttu-id="d1eeb-197">Par exemple, en HTML la `<img>` élément est utilisé pour référencer une image, avec la `src` attribut pointant vers le fichier d’image comme suit :</span><span class="sxs-lookup"><span data-stu-id="d1eeb-197">For example, in HTML the `<img>` element is used to reference a picture, with the `src` attribute pointing to the image file like so:</span></span>


[!code-html[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample4.html)]

<span data-ttu-id="d1eeb-198">Si un navigateur reçoit ce code HTML, il effectue une autre demande au serveur web pour récupérer le contenu binaire du fichier image, qu’il affiche ensuite dans le navigateur.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-198">When a browser receives this HTML, it makes another request to the web server to retrieve the binary contents of the image file, which it then displays in the browser.</span></span> <span data-ttu-id="d1eeb-199">Le même concept s’applique à toutes les données binaires.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-199">The same concept applies to any binary data.</span></span> <span data-ttu-id="d1eeb-200">À l’étape 2, la brochure n'a pas été envoyée vers le bas dans le navigateur en tant que partie du balisage HTML de s de page.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-200">In Step 2, the brochure was not sent down to the browser as part of the page s HTML markup.</span></span> <span data-ttu-id="d1eeb-201">Au lieu de cela, le code HTML restitué fourni des liens hypertexte qui, lorsque vous cliquez dessus, a provoqué le navigateur demander le document PDF directement.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-201">Rather, the rendered HTML provided hyperlinks that, when clicked, caused the browser to request the PDF document directly.</span></span>

<span data-ttu-id="d1eeb-202">Pour afficher ou permettre aux utilisateurs de télécharger des données binaires qui se trouvent dans la base de données, nous devons créer une page web distincte qui retourne les données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-202">To display or allow users to download binary data that resides within the database, we need to create a separate web page that returns the data.</span></span> <span data-ttu-id="d1eeb-203">Pour notre application, qu’un seul champ de données binaires là s stockée directement dans l’image de base de données s de la catégorie.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-203">For our application, there s only one binary data field stored directly in the database the category s picture.</span></span> <span data-ttu-id="d1eeb-204">Par conséquent, nous avons besoin d’une page qui, lorsqu’elle est appelée, retourne les données d’image pour une catégorie particulière.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-204">Therefore, we need a page that, when called, returns the image data for a particular category.</span></span>

<span data-ttu-id="d1eeb-205">Ajoutez une nouvelle page ASP.NET pour le `BinaryData` dossier nommé `DisplayCategoryPicture.aspx`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-205">Add a new ASP.NET page to the `BinaryData` folder named `DisplayCategoryPicture.aspx`.</span></span> <span data-ttu-id="d1eeb-206">Ce cas, laissez la case à cocher Sélectionner la page maître désactivée.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-206">When doing so, leave the Select master page checkbox unchecked.</span></span> <span data-ttu-id="d1eeb-207">Cette page attend un `CategoryID` valeur dans la chaîne de requête et retourne les données binaires de cette catégorie s `Picture` colonne.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-207">This page expects a `CategoryID` value in the querystring and returns the binary data of that category s `Picture` column.</span></span> <span data-ttu-id="d1eeb-208">Étant donné que cette page retourne des données binaires et rien d’autre, il n’a pas besoin tout balisage dans la section de code HTML.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-208">Since this page returns binary data and nothing else, it does not need any markup in the HTML section.</span></span> <span data-ttu-id="d1eeb-209">Par conséquent, cliquez sur l’onglet Source dans l’angle inférieur gauche et supprimer toutes les marques de la page s à l’exception de la `<%@ Page %>` directive.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-209">Therefore, click on the Source tab in the lower left corner and remove all of the page s markup except for the `<%@ Page %>` directive.</span></span> <span data-ttu-id="d1eeb-210">Autrement dit, `DisplayCategoryPicture.aspx` balisage déclaratif s doit être composé d’une seule ligne :</span><span class="sxs-lookup"><span data-stu-id="d1eeb-210">That is, `DisplayCategoryPicture.aspx` s declarative markup should consist of a single line:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample5.aspx)]

<span data-ttu-id="d1eeb-211">Si vous voyez le `MasterPageFile` d’attribut dans la `<%@ Page %>` directive, supprimez-le.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-211">If you see the `MasterPageFile` attribute in the `<%@ Page %>` directive, remove it.</span></span>

<span data-ttu-id="d1eeb-212">Dans la classe code-behind de la page s, ajoutez le code suivant à la `Page_Load` Gestionnaire d’événements :</span><span class="sxs-lookup"><span data-stu-id="d1eeb-212">In the page s code-behind class, add the following code to the `Page_Load` event handler:</span></span>


[!code-csharp[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample6.cs)]

<span data-ttu-id="d1eeb-213">Ce code commence en lisant le `CategoryID` valeur de chaîne de requête dans une variable nommée `categoryID`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-213">This code starts by reading in the `CategoryID` querystring value into a variable named `categoryID`.</span></span> <span data-ttu-id="d1eeb-214">Ensuite, les données d’image sont récupérées via un appel à la `CategoriesBLL` classe s `GetCategoryWithBinaryDataByCategoryID(categoryID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-214">Next, the picture data is retrieved via a call to the `CategoriesBLL` class s `GetCategoryWithBinaryDataByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="d1eeb-215">Ces données sont retournées au client à l’aide de la `Response.BinaryWrite(data)` (méthode), mais avant que cela soit appelée, le `Picture` en-tête de colonne valeur s OLE doit être supprimé.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-215">This data is returned to the client by using the `Response.BinaryWrite(data)` method, but before this is called, the `Picture` column value s OLE header must be removed.</span></span> <span data-ttu-id="d1eeb-216">Cela s’effectue en créant un `byte` tableau nommé `strippedImageData` qui contiendra précisément 78 caractères inférieur à ce qui est dans le `Picture` colonne.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-216">This is accomplished by creating a `byte` array named `strippedImageData` that will hold precisely 78 characters less than what is in the `Picture` column.</span></span> <span data-ttu-id="d1eeb-217">Le [ `Array.Copy` méthode](https://msdn.microsoft.com/library/z50k9bft.aspx) est utilisé pour copier les données à partir de `category.Picture` recommencer à la position 78 à `strippedImageData`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-217">The [`Array.Copy` method](https://msdn.microsoft.com/library/z50k9bft.aspx) is used to copy the data from `category.Picture` starting at position 78 over to `strippedImageData`.</span></span>

<span data-ttu-id="d1eeb-218">Le `Response.ContentType` propriété spécifie le [type MIME](http://en.wikipedia.org/wiki/MIME) du contenu qui est retourné afin que le navigateur sait comment rendre.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-218">The `Response.ContentType` property specifies the [MIME type](http://en.wikipedia.org/wiki/MIME) of the content being returned so that the browser knows how to render it.</span></span> <span data-ttu-id="d1eeb-219">Dans la mesure où le `Categories` table s `Picture` colonne est une image bitmap, la type MIME de la bitmap est utilisée ici (image/bmp).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-219">Since the `Categories` table s `Picture` column is a bitmap image, the bitmap MIME type is used here (image/bmp).</span></span> <span data-ttu-id="d1eeb-220">Si vous omettez le type MIME, la plupart des navigateurs s’affichera toujours l’image correctement, car il peuvent déduire le type en fonction du contenu des données binaires de s de fichier image.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-220">If you omit the MIME type, most browsers will still display the image correctly because they can infer the type based on the contents of the image file s binary data.</span></span> <span data-ttu-id="d1eeb-221">Toutefois, il s prudente inclure le MIME tapez lorsque cela est possible.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-221">However, it s prudent to include the MIME type when possible.</span></span> <span data-ttu-id="d1eeb-222">Consultez le [du site Web Internet Assigned Numbers Authority](http://www.iana.org/) pour une liste complète des [types de média MIME](http://www.iana.org/assignments/media-types/).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-222">See the [Internet Assigned Numbers Authority s website](http://www.iana.org/) for a complete listing of [MIME media types](http://www.iana.org/assignments/media-types/).</span></span>

<span data-ttu-id="d1eeb-223">Avec cette page est créée, une image de la catégorie particulière s sont consultables en vous rendant sur `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-223">With this page created, a particular category s picture can be viewed by visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="d1eeb-224">La figure 11 illustre l’image de catégorie s boissons, qui peut être affiché à partir de `DisplayCategoryPicture.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-224">Figure 11 shows the Beverages category s picture, which can be viewed from `DisplayCategoryPicture.aspx?CategoryID=1`.</span></span>


<span data-ttu-id="d1eeb-225">[![Les opérations de mappage catégorie boissons Qu'image s’affiche.](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-225">[![The Beverages Category s Picture is Displayed](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image17.png)</span></span>

<span data-ttu-id="d1eeb-226">**Figure 11**: Les opérations de mappage catégorie boissons image est affichée ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-226">**Figure 11**: The Beverages Category s Picture is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image18.png))</span></span>


<span data-ttu-id="d1eeb-227">Si, lors de la visite de `DisplayCategoryPicture.aspx?CategoryID=categoryID`, vous obtenez une exception qui se lit impossible à convertit un objet de type « System.DBNull » en type 'System.Byte []', il existe deux choses qui peuvent en être la cause.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-227">If, when visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`, you get an exception that reads Unable to cast object of type 'System.DBNull' to type 'System.Byte[]', there are two things that may be causing this.</span></span> <span data-ttu-id="d1eeb-228">Tout d’abord, le `Categories` table s `Picture` colonne autorise `NULL` valeurs.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-228">First, the `Categories` table s `Picture` column does allow `NULL` values.</span></span> <span data-ttu-id="d1eeb-229">Le `DisplayCategoryPicture.aspx` page, suppose toutefois, il est non -`NULL` valeur présente.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-229">The `DisplayCategoryPicture.aspx` page, however, assumes there is a non-`NULL` value present.</span></span> <span data-ttu-id="d1eeb-230">Le `Picture` propriété de la `CategoriesDataTable` ne sont pas accessibles directement si elle a un `NULL` valeur.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-230">The `Picture` property of the `CategoriesDataTable` cannot be directly accessed if it has a `NULL` value.</span></span> <span data-ttu-id="d1eeb-231">Si vous ne souhaitez pas autoriser `NULL` valeurs pour la `Picture` colonne, d Voulez-vous inclure la condition suivante :</span><span class="sxs-lookup"><span data-stu-id="d1eeb-231">If you do want to allow `NULL` values for the `Picture` column, you d want to include the following condition:</span></span>


[!code-csharp[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample7.cs)]

<span data-ttu-id="d1eeb-232">Le code ci-dessus suppose il s certains image fichier nommé `NoPictureAvailable.gif` dans le `Images` dossier que vous souhaitez afficher des catégories sans une image.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-232">The above code assumes that there s some image file named `NoPictureAvailable.gif` in the `Images` folder that you want to display for those categories without a picture.</span></span>

<span data-ttu-id="d1eeb-233">Cette exception peut également se produire si le `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` méthode s `SELECT` instruction a restauré vers la liste de colonnes de la requête principale s, ce qui peut se produire si vous utilisez des instructions SQL ad hoc et ve vous réexécutez l’Assistant TableAdapter s requête principale.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-233">This exception could also be caused if the `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement has reverted back to the main query s column list, which can happen if you are using ad-hoc SQL statements and you ve re-run the wizard for the TableAdapter s main query.</span></span> <span data-ttu-id="d1eeb-234">Vérifiez que `GetCategoryWithBinaryDataByCategoryID` méthode s `SELECT` instruction inclut toujours le `Picture` colonne.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-234">Check to ensure that `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement still includes the `Picture` column.</span></span>

> [!NOTE]
> <span data-ttu-id="d1eeb-235">Chaque fois que le `DisplayCategoryPicture.aspx` est visitée, la base de données est accessible et que les données d’image de la catégorie spécifiée s sont retournées.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-235">Every time the `DisplayCategoryPicture.aspx` is visited, the database is accessed and the specified category s picture data is returned.</span></span> <span data-ttu-id="d1eeb-236">Si l’image de s catégorie n’a pas changé depuis la dernière visite, c’est un effort inutile.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-236">If the category s picture hasn't changed since the user has last viewed it, though, this is wasted effort.</span></span> <span data-ttu-id="d1eeb-237">Heureusement, HTTP permet *obtient conditionnel*.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-237">Fortunately, HTTP allows for *conditional GETs*.</span></span> <span data-ttu-id="d1eeb-238">Avec une opération GET conditionnelle, le client qui effectue la requête HTTP envoie le long d’un [ `If-Modified-Since` en-tête HTTP](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) qui fournit la date et heure de la dernière récupération par le client cette ressource à partir du serveur web.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-238">With a conditional GET, the client making the HTTP request sends along an [`If-Modified-Since` HTTP header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that provides the date and time the client last retrieved this resource from the web server.</span></span> <span data-ttu-id="d1eeb-239">Si le contenu n’a pas changé dans la mesure où cela spécifié date, le serveur web peut répondre avec un [code d’état non modifié (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) et renoncer à renvoyer le contenu de la ressource demandée s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-239">If the content has not changed since this specified date, the web server may respond with a [Not Modified status code (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) and forgo sending back the requested resource s content.</span></span> <span data-ttu-id="d1eeb-240">En bref, cette technique évite d’avoir à envoyer de nouveau contenu pour une ressource s’il n’a pas été modifié depuis le client dernier accès le serveur web.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-240">In short, this technique relieves the web server from having to send back content for a resource if it has not been modified since the client last accessed it.</span></span>


<span data-ttu-id="d1eeb-241">Pour implémenter ce comportement, toutefois, vous devez ajouter les un `PictureLastModified` colonne à la `Categories` table pour capturer lorsque le `Picture` colonne a été mises à jour, ainsi que le code de vérification de la `If-Modified-Since` en-tête.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-241">To implement this behavior, however, requires that you add a `PictureLastModified` column to the `Categories` table to capture when the `Picture` column was last updated as well as code to check for the `If-Modified-Since` header.</span></span> <span data-ttu-id="d1eeb-242">Pour plus d’informations sur la `If-Modified-Since` en-tête et le workflow GET conditionnel, consultez [HTTP GET conditionnel pour les pirates RSS](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) et [A plus approfondie examiner effectuant des requêtes HTTP dans une Page ASP.NET](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-242">For more information on the `If-Modified-Since` header and the conditional GET workflow, see [HTTP Conditional GET for RSS Hackers](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) and [A Deeper Look at Performing HTTP Requests in an ASP.NET Page](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span></span>

## <a name="step-4-displaying-the-category-pictures-in-a-gridview"></a><span data-ttu-id="d1eeb-243">Étape 4 : Afficher les images de catégorie dans un GridView</span><span class="sxs-lookup"><span data-stu-id="d1eeb-243">Step 4: Displaying the Category Pictures in a GridView</span></span>

<span data-ttu-id="d1eeb-244">Maintenant que nous avons une page web pour afficher une image de la catégorie particulière s, nous pouvons afficher à l’aide de la [contrôle Image Web](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) ou HTML `<img>` élément pointant vers `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-244">Now that we have a web page to display a particular category s picture, we can display it using the [Image Web control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) or an HTML `<img>` element pointing to `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="d1eeb-245">Les images dont l’URL est déterminée par les données de base de données peuvent être affichées dans le GridView ou DetailsView, à l’aide de l’ImageField.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-245">Images whose URL is determined by database data can be displayed in the GridView or DetailsView using the ImageField.</span></span> <span data-ttu-id="d1eeb-246">Contient l’ImageField `DataImageUrlField` et `DataImageUrlFormatString` propriétés qui fonctionnent comme les opérations de mappage HyperLinkField `DataNavigateUrlFields` et `DataNavigateUrlFormatString` propriétés.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-246">The ImageField contains `DataImageUrlField` and `DataImageUrlFormatString` properties that work like the HyperLinkField s `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties.</span></span>

<span data-ttu-id="d1eeb-247">S permettent d’augmenter la `Categories` GridView dans `DisplayOrDownloadData.aspx` en ajoutant un ImageField pour afficher chaque image de catégorie s.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-247">Let s augment the `Categories` GridView in `DisplayOrDownloadData.aspx` by adding an ImageField to show each category s picture.</span></span> <span data-ttu-id="d1eeb-248">Simplement ajouter l’ImageField et définissez son `DataImageUrlField` et `DataImageUrlFormatString` propriétés à `CategoryID` et `DisplayCategoryPicture.aspx?CategoryID={0}`, respectivement.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-248">Simply add the ImageField and set its `DataImageUrlField` and `DataImageUrlFormatString` properties to `CategoryID` and `DisplayCategoryPicture.aspx?CategoryID={0}`, respectively.</span></span> <span data-ttu-id="d1eeb-249">Cela crée une colonne GridView qui restitue une `<img>` élément dont `src` les références d’attribut `DisplayCategoryPicture.aspx?CategoryID={0}`, où {0} est remplacée par la ligne GridView s `CategoryID` valeur.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-249">This will create a GridView column that renders an `<img>` element whose `src` attribute references `DisplayCategoryPicture.aspx?CategoryID={0}`, where {0} is replaced with the GridView row s `CategoryID` value.</span></span>


![Ajouter un ImageField au GridView](displaying-binary-data-in-the-data-web-controls-cs/_static/image12.gif)

<span data-ttu-id="d1eeb-251">**Figure 12**: Ajouter un ImageField au GridView</span><span class="sxs-lookup"><span data-stu-id="d1eeb-251">**Figure 12**: Add an ImageField to the GridView</span></span>


<span data-ttu-id="d1eeb-252">Après avoir ajouté l’ImageField, votre syntaxe déclarative des s GridView doit se présenter comme soothe suivantes :</span><span class="sxs-lookup"><span data-stu-id="d1eeb-252">After adding the ImageField, your GridView s declarative syntax should look like soothe following:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample8.aspx)]

<span data-ttu-id="d1eeb-253">Prenez un moment pour afficher cette page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-253">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="d1eeb-254">Notez la façon dont chaque enregistrement inclut désormais une image pour la catégorie.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-254">Note how each record now includes a picture for the category.</span></span>


<span data-ttu-id="d1eeb-255">[![La catégorie s image est affichée pour chaque ligne](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-255">[![The Category s Picture is Displayed for Each Row](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image19.png)</span></span>

<span data-ttu-id="d1eeb-256">**Figure 13**: La catégorie s image est affichée pour chaque ligne ([cliquez pour afficher l’image en taille réelle](displaying-binary-data-in-the-data-web-controls-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="d1eeb-256">**Figure 13**: The Category s Picture is Displayed for Each Row ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image20.png))</span></span>


## <a name="summary"></a><span data-ttu-id="d1eeb-257">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="d1eeb-257">Summary</span></span>

<span data-ttu-id="d1eeb-258">Dans ce didacticiel, nous avons examiné comment présenter des données binaires.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-258">In this tutorial we examined how to present binary data.</span></span> <span data-ttu-id="d1eeb-259">Comment les données sont présentées varie selon le type de données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-259">How the data is presented depends on the type of data.</span></span> <span data-ttu-id="d1eeb-260">Pour les fichiers de la brochure PDF, nous vous avons proposé à l’utilisateur une Brochure vue lien qui, lorsque vous cliquez dessus, a pris de l’utilisateur directement dans le fichier PDF.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-260">For the PDF brochure files, we offered the user a View Brochure link that, when clicked, took the user directly to the PDF file.</span></span> <span data-ttu-id="d1eeb-261">Pour l’image de s catégorie, nous avons tout d’abord créé une page pour récupérer et retourner les données binaires à partir de la base de données et ensuite utilisé cette page pour afficher chaque image de s catégorie dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-261">For the category s picture, we first created a page to retrieve and return the binary data from the database and then used that page to display each category s picture in a GridView.</span></span>

<span data-ttu-id="d1eeb-262">Maintenant que nous avons ve étudié la façon d’afficher les données binaires, nous vous êtes prêt à examiner comment effectuer l’insertion, de mises à jour et suppressions sur la base de données avec les données binaires.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-262">Now that we ve looked at how to display binary data, we re ready to examine how to perform insert, updates, and deletes against the database with the binary data.</span></span> <span data-ttu-id="d1eeb-263">Dans le didacticiel suivant, nous allons examiner comment associer un fichier téléchargé à l’enregistrement correspondant de la base de données.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-263">In the next tutorial we'll look at how to associate an uploaded file with its corresponding database record.</span></span> <span data-ttu-id="d1eeb-264">Dans le didacticiel après cela, nous allons voir comment mettre à jour des données binaires existantes, ainsi que comment supprimer les données binaires lors de son enregistrement associé est supprimé.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-264">In the tutorial after that, we'll see how to update existing binary data as well as how to delete the binary data when its associated record is removed.</span></span>

<span data-ttu-id="d1eeb-265">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="d1eeb-265">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d1eeb-266">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="d1eeb-266">About the Author</span></span>

<span data-ttu-id="d1eeb-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d1eeb-268">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-268">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d1eeb-269">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-269">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d1eeb-270">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-270">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d1eeb-271">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d1eeb-271">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d1eeb-272">Remerciements</span><span class="sxs-lookup"><span data-stu-id="d1eeb-272">Special Thanks To</span></span>

<span data-ttu-id="d1eeb-273">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-273">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d1eeb-274">Les réviseurs tête pour ce didacticiel ont été Teresa Murphy et Dave Gardner.</span><span class="sxs-lookup"><span data-stu-id="d1eeb-274">Lead reviewers for this tutorial were Teresa Murphy and Dave Gardner.</span></span> <span data-ttu-id="d1eeb-275">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="d1eeb-275">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d1eeb-276">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-276">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d1eeb-277">[Précédent](uploading-files-cs.md)
> [Suivant](including-a-file-upload-option-when-adding-a-new-record-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d1eeb-277">[Previous](uploading-files-cs.md)
[Next](including-a-file-upload-option-when-adding-a-new-record-cs.md)</span></span>
