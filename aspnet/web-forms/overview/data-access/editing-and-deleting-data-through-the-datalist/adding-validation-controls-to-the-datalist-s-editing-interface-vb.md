---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
title: Ajout de contrôles de validation à l’interface de modification du contrôle DataList (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons découvrir combien il est facile d’ajouter des contrôles de validation au contrôle EditItemTemplate de DataList afin de fournir un utilisateur de modification plus rapide...
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 6b073fc6-524d-453d-be7c-0c30986de391
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: f952a7bb95e956a2ad935f8bdef5c3efa7437ecb
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74621947"
---
# <a name="adding-validation-controls-to-the-datalists-editing-interface-vb"></a><span data-ttu-id="defac-103">Ajout de contrôles Validation aux interfaces de modification du contrôle DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="defac-103">Adding Validation Controls to the DataList's Editing Interface (VB)</span></span>

<span data-ttu-id="defac-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="defac-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="defac-105">[Télécharger l’exemple d’application](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) ou [Télécharger le PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="defac-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span></span>

> <span data-ttu-id="defac-106">Dans ce didacticiel, nous allons découvrir combien il est facile d’ajouter des contrôles de validation au contrôle EditItemTemplate de DataList afin de fournir une interface utilisateur de modification plus simple.</span><span class="sxs-lookup"><span data-stu-id="defac-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="defac-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="defac-107">Introduction</span></span>

<span data-ttu-id="defac-108">Dans les didacticiels de modification de DataList jusqu’à présent, les interfaces de modification DataLists n’ont pas inclus de validation d’entrée utilisateur proactive, même si une entrée utilisateur non valide, telle qu’un nom de produit manquant ou un prix négatif, entraîne une exception.</span><span class="sxs-lookup"><span data-stu-id="defac-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="defac-109">Dans le [didacticiel précédent](handling-bll-and-dal-level-exceptions-vb.md) , nous avons examiné comment ajouter du code de gestion des exceptions au gestionnaire d’événements `UpdateCommand` DataList afin d’intercepter et d’afficher en douceur des informations sur les exceptions qui ont été levées.</span><span class="sxs-lookup"><span data-stu-id="defac-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-vb.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="defac-110">Dans l’idéal, toutefois, l’interface de modification inclut des contrôles de validation pour empêcher un utilisateur d’entrer de telles données non valides en premier lieu.</span><span class="sxs-lookup"><span data-stu-id="defac-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="defac-111">Dans ce didacticiel, nous allons voir combien il est facile d’ajouter des contrôles de validation aux `EditItemTemplate` DataList afin de fournir une interface utilisateur de modification plus simple.</span><span class="sxs-lookup"><span data-stu-id="defac-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="defac-112">Plus précisément, ce didacticiel prend l’exemple créé dans le didacticiel précédent et augmente l’interface de modification pour inclure la validation appropriée.</span><span class="sxs-lookup"><span data-stu-id="defac-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptionshandling-bll-and-dal-level-exceptions-vbmd"></a><span data-ttu-id="defac-113">Étape 1 : réplication de l’exemple à partir de la[gestion des exceptions de niveau BLL et dal](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="defac-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

<span data-ttu-id="defac-114">Dans le didacticiel [gestion des exceptions de niveau BLL et dal](handling-bll-and-dal-level-exceptions-vb.md) , nous avons créé une page qui répertorie les noms et les prix des produits dans une DataList modifiable à deux colonnes.</span><span class="sxs-lookup"><span data-stu-id="defac-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="defac-115">L’objectif de ce didacticiel est d’augmenter l’interface de modification de DataList pour inclure des contrôles de validation.</span><span class="sxs-lookup"><span data-stu-id="defac-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="defac-116">En particulier, notre logique de validation :</span><span class="sxs-lookup"><span data-stu-id="defac-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="defac-117">Exiger que le nom du produit soit fourni</span><span class="sxs-lookup"><span data-stu-id="defac-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="defac-118">Vérifiez que la valeur entrée pour le prix est un format monétaire valide</span><span class="sxs-lookup"><span data-stu-id="defac-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="defac-119">Vérifiez que la valeur entrée pour le prix est supérieure ou égale à zéro, car une valeur de `UnitPrice` négative n’est pas conforme</span><span class="sxs-lookup"><span data-stu-id="defac-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="defac-120">Avant de pouvoir examiner l’exemple précédent pour inclure la validation, nous devons d’abord répliquer l’exemple de la page `ErrorHandling.aspx` dans le dossier `EditDeleteDataList` vers la page de ce didacticiel, `UIValidation.aspx`.</span><span class="sxs-lookup"><span data-stu-id="defac-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="defac-121">Pour ce faire, nous devons copier à la fois le balisage déclaratif de la page `ErrorHandling.aspx` et son code source.</span><span class="sxs-lookup"><span data-stu-id="defac-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="defac-122">Tout d’abord, copiez le balisage déclaratif en effectuant les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="defac-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="defac-123">Ouvrir la page `ErrorHandling.aspx` dans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="defac-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="defac-124">Accédez à la balise déclarative page s (cliquez sur le bouton source en bas de la page)</span><span class="sxs-lookup"><span data-stu-id="defac-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="defac-125">Copiez le texte dans les balises `<asp:Content>` et `</asp:Content>` (lignes 3 à 32), comme illustré à la figure 1.</span><span class="sxs-lookup"><span data-stu-id="defac-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>

<span data-ttu-id="defac-126">[![copier le texte dans le contrôle &lt;asp : content&gt;](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="defac-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="defac-127">**Figure 2**: copier le texte dans le contrôle de `<asp:Content>` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="defac-127">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>

1. <span data-ttu-id="defac-128">Ouvrir la page `UIValidation.aspx`</span><span class="sxs-lookup"><span data-stu-id="defac-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="defac-129">Atteindre le balisage déclaratif de la page</span><span class="sxs-lookup"><span data-stu-id="defac-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="defac-130">Collez le texte dans le contrôle `<asp:Content>`.</span><span class="sxs-lookup"><span data-stu-id="defac-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="defac-131">Pour copier le code source, ouvrez la page `ErrorHandling.aspx.vb` et copiez simplement le texte *dans* la classe `EditDeleteDataList_ErrorHandling`.</span><span class="sxs-lookup"><span data-stu-id="defac-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="defac-132">Copiez les trois gestionnaires d’événements (`Products_EditCommand`, `Products_CancelCommand`et `Products_UpdateCommand`) avec la méthode `DisplayExceptionDetails`, mais ne copiez **pas** la déclaration de classe ou les instructions `using`.</span><span class="sxs-lookup"><span data-stu-id="defac-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="defac-133">Collez le texte copié *dans* la classe `EditDeleteDataList_UIValidation` dans `UIValidation.aspx.vb`.</span><span class="sxs-lookup"><span data-stu-id="defac-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="defac-134">Après avoir déplacé le contenu et le code de `ErrorHandling.aspx` vers `UIValidation.aspx`, prenez un moment pour tester les pages dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="defac-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="defac-135">Vous devez voir la même sortie et expérimenter les mêmes fonctionnalités dans chacune de ces deux pages (voir figure 2).</span><span class="sxs-lookup"><span data-stu-id="defac-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>

<span data-ttu-id="defac-136">[![la page UIValidation. aspx imite les fonctionnalités de ErrorHandling. aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="defac-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="defac-137">**Figure 2**: la Page de `UIValidation.aspx` imite les fonctionnalités de `ErrorHandling.aspx` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="defac-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>

## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="defac-138">Étape 2 : ajout des contrôles de validation à DataList s EditItemTemplate</span><span class="sxs-lookup"><span data-stu-id="defac-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="defac-139">Lors de la construction de formulaires de saisie de données, il est important que les utilisateurs entrent les champs obligatoires et que toutes les entrées fournies soient des valeurs valides et correctement mises en forme.</span><span class="sxs-lookup"><span data-stu-id="defac-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="defac-140">Pour garantir la validité des entrées utilisateur, ASP.NET fournit cinq contrôles de validation intégrés qui sont conçus pour valider la valeur d’un contrôle Web d’entrée unique :</span><span class="sxs-lookup"><span data-stu-id="defac-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="defac-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) garantit qu’une valeur a été fournie</span><span class="sxs-lookup"><span data-stu-id="defac-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="defac-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) valide une valeur par rapport à une autre valeur de contrôle Web ou une valeur constante, ou garantit que le format de la valeur s est conforme pour un type de données spécifié</span><span class="sxs-lookup"><span data-stu-id="defac-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="defac-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) garantit qu’une valeur est comprise dans une plage de valeurs</span><span class="sxs-lookup"><span data-stu-id="defac-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="defac-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) valide une valeur par rapport à une [expression régulière](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="defac-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="defac-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) valide une valeur par rapport à une méthode personnalisée définie par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="defac-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="defac-146">Pour plus d’informations sur ces cinq contrôles, reportez-vous au didacticiel [Ajout de contrôles de validation au didacticiel de modification et d’insertion d’interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) ou consultez la [section contrôles de validation](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) des [didacticiels de démarrage rapide ASP.net](https://quickstarts.asp.net).</span><span class="sxs-lookup"><span data-stu-id="defac-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="defac-147">Pour notre didacticiel, nous allons utiliser un RequiredFieldValidator pour garantir qu’une valeur a été fournie pour le nom de produit et un CompareValidator pour garantir que le prix entré a une valeur supérieure ou égale à 0 et qu’il est présenté dans un format monétaire valide.</span><span class="sxs-lookup"><span data-stu-id="defac-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="defac-148">Alors que ASP.NET 1. x contenait ces cinq mêmes contrôles de validation, ASP.NET 2,0 a ajouté un certain nombre d’améliorations, les deux principaux étant la prise en charge des scripts côté client pour les navigateurs, en plus d’Internet Explorer et la possibilité de partitionner des contrôles de validation sur une page dans groupes de validation.</span><span class="sxs-lookup"><span data-stu-id="defac-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="defac-149">Pour plus d’informations sur les nouvelles fonctionnalités de contrôle de validation dans 2,0, consultez [la section discroisant les contrôles de validation dans ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="defac-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>

<span data-ttu-id="defac-150">Commençons par ajouter les contrôles de validation nécessaires à la `EditItemTemplate`de la DataList.</span><span class="sxs-lookup"><span data-stu-id="defac-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="defac-151">Cette tâche peut être effectuée par le biais du concepteur en cliquant sur le lien modifier les modèles de la balise active de DataList s ou à l’aide de la syntaxe déclarative.</span><span class="sxs-lookup"><span data-stu-id="defac-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="defac-152">Passons au processus à l’aide de l’option modifier les modèles de la Mode Création.</span><span class="sxs-lookup"><span data-stu-id="defac-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="defac-153">Après avoir choisi de modifier le `EditItemTemplate`DataList, ajoutez un RequiredFieldValidator en le faisant glisser de la boîte à outils vers l’interface de modification de modèle, en le plaçant après la zone de texte `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="defac-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>

<span data-ttu-id="defac-154">[![ajouter un RequiredFieldValidator à EditItemTemplate après la zone de texte ProductName](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="defac-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="defac-155">**Figure 3**: ajouter un RequiredFieldValidator au `EditItemTemplate After` la zone de texte `ProductName` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="defac-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>

<span data-ttu-id="defac-156">Tous les contrôles de validation fonctionnent en validant l’entrée d’un seul contrôle Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="defac-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="defac-157">Par conséquent, nous devons indiquer que le contrôle RequiredFieldValidator que nous venons d’ajouter doit effectuer une validation par rapport à la zone de texte `ProductName`. pour ce faire, affectez à la propriété contrôle de validation s [`ControlToValidate`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) la `ID` du contrôle Web approprié (`ProductName`, dans cette instance).</span><span class="sxs-lookup"><span data-stu-id="defac-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="defac-158">Ensuite, affectez à la [propriété`ErrorMessage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) la valeur vous devez fournir le nom du produit et la [propriété`Text`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) pour \*.</span><span class="sxs-lookup"><span data-stu-id="defac-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="defac-159">La valeur de la propriété `Text`, si elle est fournie, est le texte affiché par le contrôle de validation si la validation échoue.</span><span class="sxs-lookup"><span data-stu-id="defac-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="defac-160">La valeur de la propriété `ErrorMessage`, qui est obligatoire, est utilisée par le contrôle ValidationSummary ; Si la valeur de la propriété `Text` est omise, la valeur de la propriété `ErrorMessage` est affichée par le contrôle de validation sur une entrée non valide.</span><span class="sxs-lookup"><span data-stu-id="defac-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="defac-161">Après avoir défini ces trois propriétés de RequiredFieldValidator, votre écran doit ressembler à la figure 4.</span><span class="sxs-lookup"><span data-stu-id="defac-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>

<span data-ttu-id="defac-162">[![définir les propriétés RequiredFieldValidator, ErrorMessage et Text de RequiredFieldValidator](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="defac-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="defac-163">**Figure 4**: définir les propriétés de l' `ControlToValidate`, `ErrorMessage`et `Text` de RequiredFieldValidator ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="defac-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>

<span data-ttu-id="defac-164">Une fois le contrôle RequiredFieldValidator ajouté au `EditItemTemplate`, il vous reste à ajouter la validation nécessaire pour la zone de texte Price s.</span><span class="sxs-lookup"><span data-stu-id="defac-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="defac-165">Étant donné que le `UnitPrice` est facultatif lors de la modification d’un enregistrement, nous n’avons pas besoin d’ajouter un RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="defac-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="defac-166">Toutefois, nous devons ajouter un CompareValidator pour vous assurer que le `UnitPrice`, s’il est fourni, est correctement mis en forme en tant que devise et supérieur ou égal à 0.</span><span class="sxs-lookup"><span data-stu-id="defac-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="defac-167">Ajoutez CompareValidator à la `EditItemTemplate` et affectez à sa propriété `ControlToValidate` la valeur `UnitPrice`, sa propriété `ErrorMessage` au prix doit être supérieure ou égale à zéro et ne peut pas inclure le symbole monétaire, et sa propriété `Text` à \*.</span><span class="sxs-lookup"><span data-stu-id="defac-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="defac-168">Pour indiquer que la valeur de `UnitPrice` doit être supérieure ou égale à 0, affectez à la [propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) CompareValidator s`Operator` la valeur `GreaterThanEqual`, à sa [propriété`ValueToCompare`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) la valeur 0 et à la [propriété`Type`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) la valeur `Currency`.</span><span class="sxs-lookup"><span data-stu-id="defac-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="defac-169">Après avoir ajouté ces deux contrôles de validation, la syntaxe déclarative des `EditItemTemplate` s de DataList doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="defac-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="defac-170">Après avoir apporté ces modifications, ouvrez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="defac-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="defac-171">Si vous tentez d’omettre le nom ou d’entrer une valeur de prix non valide lors de la modification d’un produit, un astérisque apparaît en regard de la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="defac-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="defac-172">Comme le montre la figure 5, une valeur de prix qui comprend le symbole monétaire, tel que $19,95, est considérée comme non valide.</span><span class="sxs-lookup"><span data-stu-id="defac-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="defac-173">L' `Currency` CompareValidator s `Type` autorise des séparateurs numériques (tels que des virgules ou des points, selon les paramètres de culture) et un signe plus ou moins de début, mais n’autorise *pas* de symbole monétaire.</span><span class="sxs-lookup"><span data-stu-id="defac-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="defac-174">Ce comportement peut déguiser les utilisateurs, car l’interface de modification restitue actuellement le `UnitPrice` à l’aide du format monétaire.</span><span class="sxs-lookup"><span data-stu-id="defac-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

<span data-ttu-id="defac-175">[![un astérisque apparaît en regard des zones de texte avec une entrée non valide](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="defac-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="defac-176">**Figure 5**: un astérisque apparaît en regard des zones de texte avec une entrée non valide ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="defac-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>

<span data-ttu-id="defac-177">Tandis que la validation fonctionne telle quelle, l’utilisateur doit supprimer manuellement le symbole monétaire lors de la modification d’un enregistrement, ce qui n’est pas acceptable.</span><span class="sxs-lookup"><span data-stu-id="defac-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="defac-178">De plus, s’il y a des entrées non valides dans l’interface de modification, ni les boutons Update ni Cancel, lorsque vous cliquez dessus, appellent une publication (postback).</span><span class="sxs-lookup"><span data-stu-id="defac-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="defac-179">Dans l’idéal, le bouton Annuler retourne le contrôle DataList à son état antérieur à la modification, quelle que soit la validité des entrées de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="defac-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="defac-180">En outre, nous devons nous assurer que les données de la page sont valides avant de mettre à jour les informations sur le produit dans le gestionnaire d’événements de la DataList `UpdateCommand`, car la validation de la logique côté client peut être ignorée par les utilisateurs dont les navigateurs ne prennent pas en charge JavaScript ou dont la prise en charge est désactivée.</span><span class="sxs-lookup"><span data-stu-id="defac-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="defac-181">Suppression du symbole monétaire de la zone de texte PrixUnitaire s UnitPrice</span><span class="sxs-lookup"><span data-stu-id="defac-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="defac-182">Lorsque vous utilisez CompareValidator s `Currency``Type`, l’entrée en cours de validation ne doit pas inclure de symboles monétaires.</span><span class="sxs-lookup"><span data-stu-id="defac-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="defac-183">La présence de tels symboles fait que CompareValidator marque l’entrée comme non valide.</span><span class="sxs-lookup"><span data-stu-id="defac-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="defac-184">Toutefois, notre interface de modification comprend actuellement un symbole monétaire dans la zone de texte `UnitPrice`, ce qui signifie que l’utilisateur doit supprimer explicitement le symbole monétaire avant d’enregistrer les modifications.</span><span class="sxs-lookup"><span data-stu-id="defac-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="defac-185">Pour y remédier, trois options s’offrent à vous :</span><span class="sxs-lookup"><span data-stu-id="defac-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="defac-186">Configurez la `EditItemTemplate` afin que la valeur de la zone de texte `UnitPrice` ne soit pas mise en forme en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="defac-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="defac-187">Autorisez l’utilisateur à entrer un symbole monétaire en supprimant CompareValidator et en le remplaçant par un RegularExpressionValidator qui vérifie si une valeur monétaire est correctement mise en forme.</span><span class="sxs-lookup"><span data-stu-id="defac-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="defac-188">Le défi ici est que l’expression régulière pour valider une valeur monétaire n’est pas aussi simple que CompareValidator et nécessiterait l’écriture de code si nous voulions incorporer des paramètres de culture.</span><span class="sxs-lookup"><span data-stu-id="defac-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="defac-189">Supprimez complètement le contrôle de validation et reposez-vous sur la logique de validation côté serveur personnalisée dans le gestionnaire d’événements `RowUpdating` GridView s.</span><span class="sxs-lookup"><span data-stu-id="defac-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="defac-190">Passons à l’option 1 pour ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="defac-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="defac-191">Actuellement, le `UnitPrice` est mis en forme en tant que valeur monétaire en raison de l’expression de liaison de données pour la zone de texte dans le `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span><span class="sxs-lookup"><span data-stu-id="defac-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="defac-192">Remplacez l’instruction `Eval` par `Eval("UnitPrice", "{0:n2}")`, qui met en forme le résultat sous la forme d’un nombre avec deux chiffres de précision.</span><span class="sxs-lookup"><span data-stu-id="defac-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="defac-193">Vous pouvez effectuer cette opération directement par le biais de la syntaxe déclarative ou en cliquant sur le lien modifier les DataBindings dans la zone de texte `UnitPrice` de la `EditItemTemplate`DataList.</span><span class="sxs-lookup"><span data-stu-id="defac-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="defac-194">Avec cette modification, le prix mis en forme dans l’interface de modification comprend des virgules comme séparateur de groupes et un point comme séparateur décimal, mais ne quitte pas le symbole monétaire.</span><span class="sxs-lookup"><span data-stu-id="defac-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="defac-195">Lors de la suppression du format monétaire de l’interface modifiable, je trouve qu’il est utile de placer le symbole monétaire sous forme de texte en dehors de la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="defac-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="defac-196">Cela permet d’indiquer à l’utilisateur qu’il n’est pas nécessaire de fournir le symbole monétaire.</span><span class="sxs-lookup"><span data-stu-id="defac-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>

## <a name="fixing-the-cancel-button"></a><span data-ttu-id="defac-197">Correction du bouton Annuler</span><span class="sxs-lookup"><span data-stu-id="defac-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="defac-198">Par défaut, les contrôles Web de validation émettent du code JavaScript pour effectuer la validation côté client.</span><span class="sxs-lookup"><span data-stu-id="defac-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="defac-199">Lorsqu’un utilisateur clique sur un bouton, LinkButton ou ImageButton, les contrôles de validation sur la page sont vérifiés côté client avant que la publication (postback) ne se produise.</span><span class="sxs-lookup"><span data-stu-id="defac-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="defac-200">Si des données ne sont pas valides, la publication est annulée.</span><span class="sxs-lookup"><span data-stu-id="defac-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="defac-201">Pour certains boutons, toutefois, la validité des données peut être imprécise ; dans ce cas, l’annulation de la publication en raison de données non valides est une gêne.</span><span class="sxs-lookup"><span data-stu-id="defac-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="defac-202">Le bouton Annuler est un exemple de ce type.</span><span class="sxs-lookup"><span data-stu-id="defac-202">The Cancel button is such an example.</span></span> <span data-ttu-id="defac-203">Imaginez qu’un utilisateur entre des données non valides, par exemple en omettant le nom du produit, puis décide qu’il ne souhaite pas enregistrer le produit après tout et clique sur le bouton Annuler.</span><span class="sxs-lookup"><span data-stu-id="defac-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="defac-204">Actuellement, le bouton Annuler déclenche les contrôles de validation sur la page, ce qui indique que le nom du produit est manquant et empêche la publication (postback).</span><span class="sxs-lookup"><span data-stu-id="defac-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="defac-205">Notre utilisateur doit taper du texte dans la zone de texte `ProductName` pour annuler le processus de modification.</span><span class="sxs-lookup"><span data-stu-id="defac-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="defac-206">Heureusement, le bouton, LinkButton et ImageButton ont une [propriété`CausesValidation`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) qui peut indiquer si un clic sur le bouton doit initialiser la logique de validation (la valeur par défaut est `True`).</span><span class="sxs-lookup"><span data-stu-id="defac-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="defac-207">Définissez le bouton Annuler `CausesValidation` propriété sur `False`.</span><span class="sxs-lookup"><span data-stu-id="defac-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="defac-208">S’assurer que les entrées sont valides dans le gestionnaire d’événements UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="defac-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="defac-209">En raison du script côté client émis par les contrôles de validation, si un utilisateur entre une entrée non valide, les contrôles de validation annulent toutes les publications initiées par les contrôles Button, LinkButton ou ImageButton dont les propriétés `CausesValidation` sont `True` (valeur par défaut).</span><span class="sxs-lookup"><span data-stu-id="defac-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="defac-210">Toutefois, si un utilisateur visite avec un navigateur archaïque ou un navigateur dont la prise en charge de JavaScript a été désactivée, les contrôles de validation côté client ne s’exécutent pas.</span><span class="sxs-lookup"><span data-stu-id="defac-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="defac-211">Tous les contrôles de validation ASP.NET répètent immédiatement leur logique de validation lors de la publication (postback) et signalent la validité globale des entrées de la page via la [propriété`Page.IsValid`](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span><span class="sxs-lookup"><span data-stu-id="defac-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="defac-212">Toutefois, le workflow de page n’est pas interrompu ou arrêté en fonction de la valeur de `Page.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="defac-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="defac-213">En tant que développeurs, il est de notre responsabilité de s’assurer que la propriété `Page.IsValid` a une valeur de `True` avant de procéder au code qui suppose des données d’entrée valides.</span><span class="sxs-lookup"><span data-stu-id="defac-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="defac-214">Si JavaScript est désactivé pour un utilisateur, consulte notre page, modifie un produit, entre une valeur de prix trop coûteuse, puis clique sur le bouton mettre à jour, la validation côté client est ignorée et une publication est effectuée.</span><span class="sxs-lookup"><span data-stu-id="defac-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="defac-215">Lors de la publication (postback), le gestionnaire d’événements ASP.NET pages s `UpdateCommand` s’exécute et une exception est levée lors d’une tentative d’analyse trop coûteuse pour un `Decimal`.</span><span class="sxs-lookup"><span data-stu-id="defac-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="defac-216">Étant donné que nous disposons d’une gestion des exceptions, une telle exception sera gérée correctement, mais nous pourrions empêcher le glissement des données non valides en premier lieu en poursuivant uniquement avec le gestionnaire d’événements `UpdateCommand` si `Page.IsValid` a la valeur `True`.</span><span class="sxs-lookup"><span data-stu-id="defac-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="defac-217">Ajoutez le code suivant au début du gestionnaire d’événements `UpdateCommand`, juste avant le bloc `Try` :</span><span class="sxs-lookup"><span data-stu-id="defac-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>

[!code-vb[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample2.vb)]

<span data-ttu-id="defac-218">Avec cet ajout, le produit tentera d’être mis à jour uniquement si les données envoyées sont valides.</span><span class="sxs-lookup"><span data-stu-id="defac-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="defac-219">La plupart des utilisateurs ne sont pas en mesure de publier des données non valides en raison des contrôles de validation des scripts côté client, mais les utilisateurs dont les navigateurs ne prennent pas en charge JavaScript ou qui ont la prise en charge de JavaScript sont désactivés, peuvent contourner les vérifications côté client et envoyer des données non valides.</span><span class="sxs-lookup"><span data-stu-id="defac-219">Most users won't be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="defac-220">Le lecteur astucieux rappelle que lors de la mise à jour des données avec le GridView, nous n’avons pas besoin de vérifier explicitement la propriété `Page.IsValid` dans notre classe code-behind de la page.</span><span class="sxs-lookup"><span data-stu-id="defac-220">The astute reader will recall that when updating data with the GridView, we didn't need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="defac-221">Cela est dû au fait que le contrôle GridView consulte la propriété `Page.IsValid` pour nous et ne procède à la mise à jour que si elle retourne une valeur de `True`.</span><span class="sxs-lookup"><span data-stu-id="defac-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>

## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="defac-222">Étape 3 : synthèse des problèmes d’entrée de données</span><span class="sxs-lookup"><span data-stu-id="defac-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="defac-223">Outre les cinq contrôles de validation, ASP.NET comprend le [contrôle ValidationSummary](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), qui affiche le `ErrorMessage` s de ces contrôles de validation qui ont détecté des données non valides.</span><span class="sxs-lookup"><span data-stu-id="defac-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="defac-224">Ces données de synthèse peuvent être affichées sous forme de texte sur la page Web ou par le biais d’une MessageBox modale côté client.</span><span class="sxs-lookup"><span data-stu-id="defac-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="defac-225">Nous allons améliorer ce didacticiel pour inclure une MessageBox côté client résumant tous les problèmes de validation.</span><span class="sxs-lookup"><span data-stu-id="defac-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="defac-226">Pour ce faire, faites glisser un contrôle ValidationSummary de la boîte à outils vers le concepteur.</span><span class="sxs-lookup"><span data-stu-id="defac-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="defac-227">L’emplacement du contrôle ValidationSummary n’a pas vraiment d’importance, car nous allons le configurer pour afficher uniquement le résumé en tant que MessageBox.</span><span class="sxs-lookup"><span data-stu-id="defac-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="defac-228">Après avoir ajouté le contrôle, définissez sa [propriété`ShowSummary`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) sur `False` et sa [propriété`ShowMessageBox`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) sur `True`.</span><span class="sxs-lookup"><span data-stu-id="defac-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="defac-229">Dans ce cas, toutes les erreurs de validation sont résumées dans une MessageBox côté client (voir figure 6).</span><span class="sxs-lookup"><span data-stu-id="defac-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>

<span data-ttu-id="defac-230">[![les erreurs de validation sont résumées dans la MessageBox côté client](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="defac-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="defac-231">**Figure 6**: les erreurs de validation sont résumées dans la MessageBox côté client ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="defac-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>

## <a name="summary"></a><span data-ttu-id="defac-232">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="defac-232">Summary</span></span>

<span data-ttu-id="defac-233">Dans ce didacticiel, nous avons vu comment réduire la probabilité d’exceptions en utilisant des contrôles de validation pour garantir de manière proactive que les entrées de nos utilisateurs sont valides avant de tenter de les utiliser dans le flux de travail de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="defac-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="defac-234">ASP.NET fournit cinq contrôles Web de validation qui sont conçus pour inspecter une entrée de contrôle Web particulière et un rapport sur la validité des e/s.</span><span class="sxs-lookup"><span data-stu-id="defac-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="defac-235">Dans ce didacticiel, nous avons utilisé deux de ces cinq contrôles RequiredFieldValidator et CompareValidator pour garantir que le nom du produit a été fourni et que le prix avait un format monétaire avec une valeur supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="defac-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="defac-236">Pour ajouter des contrôles de validation à l’interface de modification de DataList, il suffit de les faire glisser sur le `EditItemTemplate` à partir de la boîte à outils et de définir une poignée de propriétés.</span><span class="sxs-lookup"><span data-stu-id="defac-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="defac-237">Par défaut, les contrôles de validation émettent automatiquement un script de validation côté client. ils fournissent également la validation côté serveur lors de la publication (postback), en stockant le résultat cumulé dans la propriété `Page.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="defac-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="defac-238">Pour contourner la validation côté client en cas de clic sur un bouton, LinkButton ou ImageButton, définissez la propriété Button s `CausesValidation` sur `False`.</span><span class="sxs-lookup"><span data-stu-id="defac-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="defac-239">En outre, avant d’effectuer des tâches avec les données soumises lors de la publication (postback), assurez-vous que la propriété `Page.IsValid` retourne `True`.</span><span class="sxs-lookup"><span data-stu-id="defac-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="defac-240">Tous les didacticiels de modification de DataList que nous avons examinés jusqu’à présent ont eu des interfaces de modification très simples, une zone de texte pour le nom du produit et une autre pour le prix.</span><span class="sxs-lookup"><span data-stu-id="defac-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="defac-241">Toutefois, l’interface de modification peut contenir un mélange de différents contrôles Web, tels que DropDownList, des calendriers, des cases d’option, des cases à cocher, etc.</span><span class="sxs-lookup"><span data-stu-id="defac-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="defac-242">Dans notre prochain didacticiel, nous examinerons la création d’une interface qui utilise une variété de contrôles Web.</span><span class="sxs-lookup"><span data-stu-id="defac-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="defac-243">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="defac-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="defac-244">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="defac-244">About the Author</span></span>

<span data-ttu-id="defac-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="defac-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="defac-246">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="defac-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="defac-247">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="defac-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="defac-248">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="defac-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="defac-249">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="defac-249">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="defac-250">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="defac-250">Special Thanks To</span></span>

<span data-ttu-id="defac-251">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="defac-251">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="defac-252">Les réviseurs de leads pour ce didacticiel étaient Denis Patterson, Ken Pespisa et Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="defac-252">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="defac-253">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="defac-253">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="defac-254">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="defac-254">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="defac-255">[Précédent](handling-bll-and-dal-level-exceptions-vb.md)
> [Suivant](customizing-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="defac-255">[Previous](handling-bll-and-dal-level-exceptions-vb.md)
[Next](customizing-the-datalist-s-editing-interface-vb.md)</span></span>
