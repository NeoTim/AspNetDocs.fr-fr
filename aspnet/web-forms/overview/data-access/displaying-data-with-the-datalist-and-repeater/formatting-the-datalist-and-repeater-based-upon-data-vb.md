---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
title: Mise en forme des contrôles DataList et Repeater en fonction des données (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons parcourir les exemples de la façon dont nous mettons en forme l’apparence des contrôles DataList et Repeater, soit en utilisant des fonctions de mise en forme avec...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: e2f401ae-37bb-4b19-aa97-d6b385d40f88
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
msc.type: authoredcontent
ms.openlocfilehash: c9b60e4dacd992962942034e84c01cb82e039c81
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74636692"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-vb"></a><span data-ttu-id="2e7e2-103">Mise en forme des contrôles DataList et Repeater en fonction des données (VB)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-103">Formatting the DataList and Repeater Based Upon Data (VB)</span></span>

<span data-ttu-id="2e7e2-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2e7e2-105">[Télécharger l’exemple d’application](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) ou [Télécharger le PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span></span>

> <span data-ttu-id="2e7e2-106">Dans ce didacticiel, nous allons parcourir des exemples de la façon dont nous mettons en forme l’apparence des contrôles DataList et Repeater, soit en utilisant des fonctions de mise en forme dans les modèles, soit en gérant l’événement DataBound.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>

## <a name="introduction"></a><span data-ttu-id="2e7e2-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="2e7e2-107">Introduction</span></span>

<span data-ttu-id="2e7e2-108">Comme nous l’avons vu dans le didacticiel précédent, le contrôle DataList propose un certain nombre de propriétés liées au style qui affectent son apparence.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="2e7e2-109">En particulier, nous avons vu comment attribuer des classes CSS par défaut aux propriétés `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`et `SelectedItemStyle` de DataList.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="2e7e2-110">En plus de ces quatre propriétés, le contrôle DataList comprend un certain nombre d’autres propriétés liées au style, telles que `Font`, `ForeColor`, `BackColor`et `BorderWidth`, pour n’en nommer que quelques-uns.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="2e7e2-111">Le contrôle Repeater ne contient pas de propriétés liées au style.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="2e7e2-112">Tous les paramètres de style de ce type doivent être définis directement dans le balisage des modèles Repeater s.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="2e7e2-113">Toutefois, bien souvent, la façon dont les données doivent être mises en forme dépend des données elles-mêmes.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="2e7e2-114">Par exemple, lorsque vous répertoriez des produits, nous pouvons souhaiter afficher les informations sur le produit dans une couleur de police gris clair si elle n’est plus disponible, ou vous pouvez mettre en surbrillance la valeur `UnitsInStock` si elle est égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="2e7e2-115">Comme nous l’avons vu dans les didacticiels précédents, GridView, DetailsView et FormView offrent deux méthodes distinctes pour mettre en forme leur apparence en fonction de leurs données :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="2e7e2-116">**L’événement `DataBound`** crée un gestionnaire d’événements pour l’événement `DataBound` approprié, qui se déclenche après la liaison des données à chaque élément (pour le GridView, il s’agissait de l’événement `RowDataBound` ; pour le contrôle DataList et Repeater, il s’agit de l’événement `ItemDataBound`).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="2e7e2-117">Dans ce gestionnaire d’événements, les données qui viennent d’être liées peuvent être examinées et les décisions de mise en forme prises.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="2e7e2-118">Nous avons examiné cette technique dans le didacticiel de [mise en forme personnalisée basé sur les données](../custom-formatting/custom-formatting-based-upon-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="2e7e2-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>
- <span data-ttu-id="2e7e2-119">**Mise en forme des fonctions dans les modèles** quand vous utilisez TemplateFields dans les contrôles DetailsView ou GridView, ou un modèle dans le contrôle FormView, nous pouvons ajouter une fonction de mise en forme à la classe code-behind de la page ASP.net s, à la couche de logique métier ou à toute autre bibliothèque de classes accessible à partir de l’application Web.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="2e7e2-120">Cette fonction de mise en forme peut accepter un nombre arbitraire de paramètres d’entrée, mais elle doit retourner le code HTML à afficher dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="2e7e2-121">Les fonctions de mise en forme ont d’abord été examinées dans le didacticiel [utilisation de TemplateFields dans le contrôle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="2e7e2-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="2e7e2-122">Ces deux techniques de mise en forme sont disponibles avec les contrôles DataList et Repeater.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="2e7e2-123">Dans ce didacticiel, nous allons parcourir les exemples qui utilisent les deux techniques pour les deux contrôles.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="2e7e2-124">Utilisation du gestionnaire d’événements`ItemDataBound`</span><span class="sxs-lookup"><span data-stu-id="2e7e2-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="2e7e2-125">Lorsque les données sont liées à un contrôle DataList, soit à partir d’un contrôle de source de données, soit en affectant par programmation les données à la propriété Control s `DataSource` et en appelant sa méthode `DataBind()`, l’événement DataList s `DataBinding` est déclenché, la source de données est énumérée et chaque enregistrement de données est lié au contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="2e7e2-126">Pour chaque enregistrement de la source de données, DataList crée un objet [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) qui est ensuite lié à l’enregistrement actif.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="2e7e2-127">Au cours de ce processus, le contrôle DataList déclenche deux événements :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="2e7e2-128">**`ItemCreated`** se déclenche après la création du `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="2e7e2-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="2e7e2-129">**`ItemDataBound`** se déclenche après la liaison de l’enregistrement actif au `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="2e7e2-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="2e7e2-130">Les étapes suivantes décrivent le processus de liaison de données pour le contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="2e7e2-131">L’événement DataList s [`DataBinding`](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) se déclenche</span><span class="sxs-lookup"><span data-stu-id="2e7e2-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="2e7e2-132">Les données sont liées au contrôle DataList</span><span class="sxs-lookup"><span data-stu-id="2e7e2-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="2e7e2-133">Pour chaque enregistrement dans la source de données</span><span class="sxs-lookup"><span data-stu-id="2e7e2-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="2e7e2-134">Créer un objet `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="2e7e2-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="2e7e2-135">Déclencher l' [événement`ItemCreated`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="2e7e2-136">Lier l’enregistrement au `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="2e7e2-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="2e7e2-137">Déclencher l' [événement`ItemDataBound`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="2e7e2-138">Ajouter le `DataListItem` à la collection de `Items`</span><span class="sxs-lookup"><span data-stu-id="2e7e2-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="2e7e2-139">Lors de la liaison de données au contrôle Repeater, il progresse dans la même séquence d’étapes.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="2e7e2-140">La seule différence est qu’au lieu de créer des instances de `DataListItem`, le Repeater utilise [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="2e7e2-141">Le lecteur astucieux a peut-être remarqué une légère anomalie entre la séquence d’étapes qui s’écoulent lorsque le contrôle DataList et le Repeater sont liés aux données et lorsque le contrôle GridView est lié aux données.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="2e7e2-142">À la fin du processus de liaison de données, le GridView déclenche l’événement `DataBound` ; Toutefois, ni le contrôle DataList ni le contrôle Repeater n’ont un tel événement.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="2e7e2-143">Cela est dû au fait que les contrôles DataList et Repeater ont été recréés dans le délai de ASP.NET 1. x, avant que le modèle de gestionnaire d’événements pré-et postérieur au niveau de l’événement devienne courant.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>

<span data-ttu-id="2e7e2-144">Comme avec le GridView, une option de mise en forme basée sur les données consiste à créer un gestionnaire d’événements pour l’événement `ItemDataBound`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="2e7e2-145">Ce gestionnaire d’événements inspecte les données qui viennent d’être liées au `DataListItem` ou `RepeaterItem` et affecte la mise en forme du contrôle en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="2e7e2-146">Pour le contrôle DataList, les modifications de mise en forme pour l’élément entier peuvent être implémentées à l’aide des propriétés de style `DataListItem` s, qui incluent le `Font`standard, `ForeColor`, `BackColor`, `CssClass`, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="2e7e2-147">Pour affecter la mise en forme de contrôles Web particuliers dans le modèle DataList, nous devons accéder par programmation et modifier le style de ces contrôles Web.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="2e7e2-148">Nous avons vu comment y parvenir à nouveau dans la *mise en forme personnalisée basée* sur le didacticiel sur les données.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="2e7e2-149">À l’instar du contrôle Repeater, la classe `RepeaterItem` n’a pas de propriétés liées au style ; par conséquent, toutes les modifications liées au style apportées à un `RepeaterItem` dans le gestionnaire d’événements `ItemDataBound` doivent être effectuées par le biais d’un programme qui accède aux contrôles Web et les met à jour dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="2e7e2-150">Étant donné que la technique de mise en forme de `ItemDataBound` pour les contrôles DataList et Repeater est pratiquement identique, notre exemple se concentre sur l’utilisation de la DataList.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="2e7e2-151">Étape 1 : affichage des informations sur le produit dans le contrôle DataList</span><span class="sxs-lookup"><span data-stu-id="2e7e2-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="2e7e2-152">Avant de vous soucier de la mise en forme, commençons par créer une page qui utilise un contrôle DataList pour afficher les informations sur le produit.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="2e7e2-153">Dans le [didacticiel précédent](displaying-data-with-the-datalist-and-repeater-controls-vb.md) , nous avons créé un contrôle DataList dont les `ItemTemplate` affichent chaque nom, catégorie, fournisseur, quantité par unité et tarif du produit.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-vb.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="2e7e2-154">Commençons cette fonctionnalité ici dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="2e7e2-155">Pour ce faire, vous pouvez recréer la DataList et son ObjectDataSource à partir de zéro, ou vous pouvez copier ces contrôles à partir de la page créée dans le didacticiel précédent (`Basics.aspx`) et les coller dans la page de ce didacticiel (`Formatting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="2e7e2-156">Une fois que vous avez répliqué les fonctionnalités de DataList et ObjectDataSource de `Basics.aspx` dans `Formatting.aspx`, prenez un moment pour modifier la propriété DataList s `ID` de `DataList1` à un `ItemDataBoundFormattingExample`plus descriptif.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="2e7e2-157">Ensuite, affichez le contrôle DataList dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="2e7e2-158">Comme le montre la figure 1, la seule différence de mise en forme entre chaque produit est que la couleur d’arrière-plan alterne.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>

<span data-ttu-id="2e7e2-159">[![les produits sont répertoriés dans le contrôle DataList](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="2e7e2-160">**Figure 1**: les produits sont répertoriés dans le contrôle DataList ([cliquez pour afficher l’image en taille réelle](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2e7e2-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="2e7e2-161">Pour ce didacticiel, nous allons mettre en forme le contrôle DataList de sorte que tous les produits dont le prix est inférieur à $20,00 auront à la fois le nom et le prix unitaire mis en surbrillance en jaune.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="2e7e2-162">Étape 2 : détermination par programmation de la valeur des données dans le gestionnaire d’événements ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="2e7e2-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="2e7e2-163">Étant donné que seuls les produits dont le prix est inférieur à $20,00 auront la mise en forme personnalisée appliquée, nous devons être en mesure de déterminer le prix de chaque produit.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="2e7e2-164">Lors de la liaison de données à un contrôle DataList, DataList énumère les enregistrements dans sa source de données et, pour chaque enregistrement, crée une instance `DataListItem`, en liant l’enregistrement de la source de données au `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="2e7e2-165">Une fois que les données d’enregistrement particulières ont été liées à l’objet de `DataListItem` actif, l’événement de `ItemDataBound` DataList s est déclenché.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="2e7e2-166">Nous pouvons créer un gestionnaire d’événements pour cet événement afin d’inspecter les valeurs des données pour le `DataListItem` actuel et, en fonction de ces valeurs, apporter les modifications nécessaires à la mise en forme.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="2e7e2-167">Créez un événement `ItemDataBound` pour le contrôle DataList et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample1.vb)]

<span data-ttu-id="2e7e2-168">Tandis que le concept et la sémantique du gestionnaire d’événements de la DataList `ItemDataBound` sont les mêmes que ceux utilisés par le gestionnaire d’événements `RowDataBound` GridView dans la *mise en forme personnalisée basée sur les données* , la syntaxe diffère légèrement.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="2e7e2-169">Lorsque l’événement `ItemDataBound` se déclenche, le `DataListItem` juste lié aux données est passé dans le gestionnaire d’événements correspondant via `e.Item` (au lieu de `e.Row`, comme avec le gestionnaire d’événements `RowDataBound` GridView s).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="2e7e2-170">Le gestionnaire d’événements DataList s `ItemDataBound` se déclenche pour *chaque* ligne ajoutée au contrôle DataList, y compris les lignes d’en-tête, les lignes de pied de page et les lignes de séparateur.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="2e7e2-171">Toutefois, les informations sur le produit sont uniquement liées aux lignes de données.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="2e7e2-172">Par conséquent, lors de l’utilisation de l’événement `ItemDataBound` pour inspecter les données liées au contrôle DataList, nous devons tout d’abord nous assurer que nous travaillons à nouveau avec un élément de données.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="2e7e2-173">Pour ce faire, vous pouvez vérifier la propriété `DataListItem` s [`ItemType`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), qui peut avoir l’une des [huit valeurs suivantes](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span><span class="sxs-lookup"><span data-stu-id="2e7e2-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="2e7e2-174">`Item` et `AlternatingItem``DataListItem` compensent les éléments de données DataList s.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="2e7e2-175">En supposant que nous travaillons avec un `Item` ou `AlternatingItem`, nous avons accès à l’instance de `ProductsRow` réelle qui était liée à la `DataListItem`actuelle.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="2e7e2-176">La propriété `DataListItem` s [`DataItem`](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contient une référence à l’objet `DataRowView`, dont la propriété `Row` fournit une référence à l’objet `ProductsRow` réel.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="2e7e2-177">Ensuite, nous vérifions la propriété `ProductsRow` `UnitPrice` des instances.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="2e7e2-178">Étant donné que le champ Products table s `UnitPrice` autorise `NULL` valeurs, avant d’essayer d’accéder à la propriété `UnitPrice`, nous devons d’abord vérifier si elle a une valeur `NULL` à l’aide de la méthode `IsUnitPriceNull()`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="2e7e2-179">Si la valeur `UnitPrice` n’est pas `NULL`, nous vérifions si elle est inférieure à $20,00.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="2e7e2-180">Si elle est effectivement inférieure à $20,00, nous devons ensuite appliquer la mise en forme personnalisée.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="2e7e2-181">Étape 3 : mise en surbrillance du nom et du prix du produit</span><span class="sxs-lookup"><span data-stu-id="2e7e2-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="2e7e2-182">Une fois que nous savons que le prix d’un produit est inférieur à $20,00, il ne reste plus qu’à mettre en évidence son nom et son prix.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="2e7e2-183">Pour ce faire, nous devons d’abord référencer par programmation les contrôles Label dans le `ItemTemplate` qui affichent le nom et le prix du produit.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="2e7e2-184">Ensuite, nous devons faire en sorte qu’ils affichent un arrière-plan jaune.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="2e7e2-185">Ces informations de mise en forme peuvent être appliquées en modifiant directement les étiquettes `BackColor` les propriétés (`LabelID.BackColor = Color.Yellow`); dans l’idéal, toutefois, toutes les questions relatives à l’affichage doivent être exprimées par le biais de feuilles de style en cascade.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="2e7e2-186">En fait, nous disposons déjà d’une feuille de style qui fournit la mise en forme souhaitée définie dans `Styles.css` - `AffordablePriceEmphasis`, qui a été créée et discutée dans le didacticiel de *mise en forme personnalisée basée sur les données* .</span><span class="sxs-lookup"><span data-stu-id="2e7e2-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="2e7e2-187">Pour appliquer la mise en forme, définissez simplement les deux contrôles Web label `CssClass` propriétés sur `AffordablePriceEmphasis`, comme illustré dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample2.vb)]

<span data-ttu-id="2e7e2-188">Une fois le gestionnaire d’événements `ItemDataBound` terminé, revisitez la page `Formatting.aspx` dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="2e7e2-189">Comme le montre la figure 2, les produits dont le prix est inférieur à $20,00 ont à la fois leur nom et leur prix mis en surbrillance.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>

<span data-ttu-id="2e7e2-190">[![les produits inférieurs à $20,00 sont mis en surbrillance](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span></span>

<span data-ttu-id="2e7e2-191">**Figure 2**: les produits inférieurs à $20,00 sont mis en surbrillance ([cliquez pour afficher l’image en taille réelle](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2e7e2-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="2e7e2-192">Étant donné que la DataList est rendue sous la forme d’un `<table>`HTML, ses instances de `DataListItem` ont des propriétés liées au style qui peuvent être définies pour appliquer un style spécifique à l’élément entier.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="2e7e2-193">Par exemple, si nous voulons mettre en surbrillance la *totalité* de l’élément jaune lorsque son prix était inférieur à $20,00, nous pourrions avoir remplacé le code qui faisait référence aux étiquettes et définir leurs propriétés de `CssClass` avec la ligne de code suivante : `e.Item.CssClass = "AffordablePriceEmphasis"` (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>

<span data-ttu-id="2e7e2-194">Les `RepeaterItem` qui composent le contrôle Repeater, mais don t offrent de telles propriétés au niveau du style.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="2e7e2-195">Par conséquent, l’application de la mise en forme personnalisée au Repeater requiert l’application de propriétés de style aux contrôles Web dans les modèles Repeater, comme nous l’avons fait dans la figure 2.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>

<span data-ttu-id="2e7e2-196">[![l’ensemble de l’article de produit est mis en surbrillance pour les produits sous $20,00](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span></span>

<span data-ttu-id="2e7e2-197">**Figure 3**: la totalité de l’élément de produit est mise en surbrillance pour les produits sous $20,00 ([cliquez pour afficher l’image en taille réelle](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2e7e2-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span></span>

## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="2e7e2-198">Utilisation des fonctions de mise en forme à partir du modèle</span><span class="sxs-lookup"><span data-stu-id="2e7e2-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="2e7e2-199">Dans le didacticiel sur l' *utilisation de TemplateFields dans le contrôle GridView* , nous avons vu comment utiliser une fonction de mise en forme dans un contrôle de contenu GridView pour appliquer une mise en forme personnalisée basée sur les données liées aux lignes de GridView.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="2e7e2-200">Une fonction de mise en forme est une méthode qui peut être appelée à partir d’un modèle et retourne le code HTML à émettre à la place.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="2e7e2-201">Les fonctions de mise en forme peuvent résider dans la classe code-behind de la page ASP.NET ou peuvent être centralisées en fichiers de classe dans le dossier `App_Code` ou dans un projet de bibliothèque de classes distinct.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="2e7e2-202">Le déplacement de la fonction de mise en forme en dehors de la classe code-behind de la page ASP.NET est idéal si vous prévoyez d’utiliser la même fonction de mise en forme dans plusieurs pages ASP.NET ou dans d’autres applications Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="2e7e2-203">Pour illustrer les fonctions de mise en forme, les informations sur le produit sont les suivantes : texte [abandonné] en regard du nom du produit s’il n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="2e7e2-204">En outre, les prix sont mis en surbrillance en jaune s’ils sont inférieurs à $20,00 (comme nous l’avons fait dans le `ItemDataBound` exemple de gestionnaire d’événements); Si le prix est de $20,00 ou supérieur, ne pas afficher le prix réel, mais à la place le texte, veuillez appeler pour obtenir un devis.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="2e7e2-205">La figure 4 montre une capture d’écran de la liste des produits avec ces règles de mise en forme appliquées.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>

<span data-ttu-id="2e7e2-206">[![pour les produits onéreux, le prix est remplacé par le texte, veuillez appeler pour obtenir un devis](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span></span>

<span data-ttu-id="2e7e2-207">**Figure 4**: pour les produits onéreux, le prix est remplacé par le texte, veuillez appeler pour obtenir un devis ([cliquez pour afficher l’image en plein écran](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2e7e2-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span></span>

## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="2e7e2-208">Étape 1 : créer les fonctions de mise en forme</span><span class="sxs-lookup"><span data-stu-id="2e7e2-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="2e7e2-209">Pour cet exemple, nous avons besoin de deux fonctions de mise en forme, une qui affiche le nom du produit ainsi que le texte [abandonné], si nécessaire, et un autre qui affiche soit un prix mis en surbrillance s’il est inférieur à $20,00, soit un devis pour un tarif dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="2e7e2-210">Créons ces fonctions dans la classe code-behind de la page ASP.NET et nommez-les `DisplayProductNameAndDiscontinuedStatus` et `DisplayPrice`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="2e7e2-211">Les deux méthodes doivent retourner le HTML à restituer sous forme de chaîne et doivent être marquées `Protected` (ou `Public`) pour pouvoir être appelées à partir de la partie de la syntaxe déclarative de la page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="2e7e2-212">Voici le code de ces deux méthodes :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-212">The code for these two methods follows:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample3.vb)]

<span data-ttu-id="2e7e2-213">Notez que la méthode `DisplayProductNameAndDiscontinuedStatus` accepte les valeurs des champs de données `productName` et `discontinued` en tant que valeurs scalaires, tandis que la méthode `DisplayPrice` accepte une instance `ProductsRow` (plutôt qu’une valeur scalaire `unitPrice`).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="2e7e2-214">L’une ou l’autre approche fonctionnera. Toutefois, si la fonction de mise en forme fonctionne avec des valeurs scalaires qui peuvent contenir des valeurs de `NULL` de base de données (telles que `UnitPrice`. ni `ProductName` ni `Discontinued` n’autorisent les valeurs `NULL`), il convient de veiller à gérer ces entrées scalaires.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="2e7e2-215">En particulier, le paramètre d’entrée doit être de type `Object`, car la valeur entrante peut être une `DBNull` instance au lieu du type de données attendu.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="2e7e2-216">En outre, un contrôle doit être effectué pour déterminer si la valeur entrante est une valeur de `NULL` de base de données.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="2e7e2-217">Autrement dit, si nous souhaitons que la méthode `DisplayPrice` accepte le prix en tant que valeur scalaire, nous devons utiliser le code suivant :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample4.vb)]

<span data-ttu-id="2e7e2-218">Notez que le paramètre d’entrée `unitPrice` est de type `Object` et que l’instruction conditionnelle a été modifiée pour s’assurer que `unitPrice` est `DBNull` ou non.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="2e7e2-219">En outre, étant donné que le paramètre d’entrée `unitPrice` est passé en tant que `Object`, il doit être converti en valeur décimale.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="2e7e2-220">Étape 2 : appel de la fonction de mise en forme à partir du ItemTemplate de DataList</span><span class="sxs-lookup"><span data-stu-id="2e7e2-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="2e7e2-221">Avec les fonctions de mise en forme ajoutées à la classe code-behind de la page ASP.NET, il ne reste plus qu’à appeler ces fonctions de mise en forme à partir de la `ItemTemplate`de DataList.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="2e7e2-222">Pour appeler une fonction de mise en forme à partir d’un modèle, placez l’appel de fonction dans la syntaxe DataBinding :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample5.aspx)]

<span data-ttu-id="2e7e2-223">Dans DataList s `ItemTemplate` le contrôle Web `ProductNameLabel` label affiche actuellement le nom du produit en affectant à sa propriété `Text` le résultat de `<%# Eval("ProductName") %>`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="2e7e2-224">Pour qu’elle affiche le nom plus le texte [Discontinued], si nécessaire, mettez à jour la syntaxe déclarative afin qu’elle affecte plutôt la propriété `Text` la valeur de la méthode `DisplayProductNameAndDiscontinuedStatus`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="2e7e2-225">Dans ce cas, nous devons transmettre le nom du produit et les valeurs supprimées à l’aide de la syntaxe `Eval("columnName")`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="2e7e2-226">`Eval` retourne une valeur de type `Object`, mais la méthode `DisplayProductNameAndDiscontinuedStatus` attend des paramètres d’entrée de type `String` et `Boolean`; par conséquent, nous devons effectuer un cast des valeurs retournées par la méthode `Eval` vers les types de paramètres d’entrée attendus, comme suit :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample6.aspx)]

<span data-ttu-id="2e7e2-227">Pour afficher le prix, nous pouvons simplement définir la propriété `UnitPriceLabel` label s `Text` sur la valeur retournée par la méthode `DisplayPrice`, comme nous l’avons fait pour afficher le nom du produit et le texte [abandonné].</span><span class="sxs-lookup"><span data-stu-id="2e7e2-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="2e7e2-228">Toutefois, au lieu de passer le `UnitPrice` en tant que paramètre d’entrée scalaire, nous transmettons la totalité de l’instance de `ProductsRow` :</span><span class="sxs-lookup"><span data-stu-id="2e7e2-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample7.aspx)]

<span data-ttu-id="2e7e2-229">Avec les appels aux fonctions de mise en forme en place, prenez un moment pour voir notre progression dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="2e7e2-230">Votre écran doit ressembler à la figure 5, avec les produits abandonnés, y compris le texte [abandonné] et les produits dont le coût est supérieur à $20,00, dont le prix est remplacé par le texte veuillez appeler pour obtenir un devis.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>

<span data-ttu-id="2e7e2-231">[![pour les produits onéreux, le prix est remplacé par le texte, veuillez appeler pour obtenir un devis](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span></span>

<span data-ttu-id="2e7e2-232">**Figure 5**: pour les produits onéreux, le prix est remplacé par le texte, veuillez appeler pour obtenir un devis ([cliquez pour afficher l’image en plein écran](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2e7e2-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span></span>

## <a name="summary"></a><span data-ttu-id="2e7e2-233">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="2e7e2-233">Summary</span></span>

<span data-ttu-id="2e7e2-234">La mise en forme du contenu d’un contrôle DataList ou Repeater basé sur les données peut être accomplie à l’aide de deux techniques.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="2e7e2-235">La première technique consiste à créer un gestionnaire d’événements pour l’événement `ItemDataBound`, qui se déclenche lorsque chaque enregistrement de la source de données est lié à un nouveau `DataListItem` ou `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="2e7e2-236">Dans le gestionnaire d’événements `ItemDataBound`, les données de l’élément actuel peuvent être examinées, puis la mise en forme peut être appliquée au contenu du modèle ou, pour `DataListItem` s, à l’élément entier lui-même.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="2e7e2-237">Une mise en forme personnalisée peut également être réalisée par le biais de fonctions de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="2e7e2-238">Une fonction de mise en forme est une méthode qui peut être appelée à partir des modèles DataList ou Repeater, qui retourne le code HTML à émettre à la place.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="2e7e2-239">Souvent, le code HTML retourné par une fonction de mise en forme est déterminé par les valeurs qui sont liées à l’élément actuel.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="2e7e2-240">Ces valeurs peuvent être passées à la fonction de mise en forme en tant que valeurs scalaires ou en passant la totalité de l’objet lié à l’élément (par exemple, l’instance `ProductsRow`).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="2e7e2-241">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="2e7e2-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2e7e2-242">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="2e7e2-242">About the Author</span></span>

<span data-ttu-id="2e7e2-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2e7e2-244">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2e7e2-245">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2e7e2-246">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2e7e2-247">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2e7e2-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2e7e2-248">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="2e7e2-248">Special Thanks To</span></span>

<span data-ttu-id="2e7e2-249">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2e7e2-250">Les réviseurs de leads pour ce didacticiel étaient Yaakov Ellis, Randy Schmidt et Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="2e7e2-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="2e7e2-251">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="2e7e2-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2e7e2-252">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2e7e2-253">[Précédent](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
> [Suivant](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2e7e2-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span></span>
