---
uid: web-forms/overview/data-access/custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb
title: Affichage des informations récapitulatives dans le pied de page du GridView (VB) | Microsoft Docs
author: rick-anderson
description: Les informations de résumé sont souvent affichées en bas du rapport dans une ligne de synthèse. Le contrôle GridView peut inclure une ligne de pied de page dans dont les cellules peuvent être pr...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 41c818b7-603a-402b-8847-890a63547b6f
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: c208b4a756f5700be46eec924d8cf8f49b9d2507
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74616507"
---
# <a name="displaying-summary-information-in-the-gridviews-footer-vb"></a><span data-ttu-id="e107f-104">Affichage des informations récapitulatives dans le pied de page du GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="e107f-104">Displaying Summary Information in the GridView's Footer (VB)</span></span>

<span data-ttu-id="e107f-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e107f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e107f-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_15_VB.exe) ou [Télécharger le PDF](displaying-summary-information-in-the-gridview-s-footer-vb/_static/datatutorial15vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e107f-106">[Download Sample App](https://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_15_VB.exe) or [Download PDF](displaying-summary-information-in-the-gridview-s-footer-vb/_static/datatutorial15vb1.pdf)</span></span>

> <span data-ttu-id="e107f-107">Les informations de résumé sont souvent affichées en bas du rapport dans une ligne de synthèse.</span><span class="sxs-lookup"><span data-stu-id="e107f-107">Summary information is often displayed at the bottom of the report in a summary row.</span></span> <span data-ttu-id="e107f-108">Le contrôle GridView peut inclure une ligne de pied de page dans dont les cellules peuvent injecter des données agrégées par programmation.</span><span class="sxs-lookup"><span data-stu-id="e107f-108">The GridView control can include a footer row into whose cells we can programmatically inject aggregate data.</span></span> <span data-ttu-id="e107f-109">Dans ce didacticiel, nous allons voir comment afficher des données agrégées dans cette ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="e107f-109">In this tutorial we'll see how to display aggregate data in this footer row.</span></span>

## <a name="introduction"></a><span data-ttu-id="e107f-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="e107f-110">Introduction</span></span>

<span data-ttu-id="e107f-111">En plus de voir les prix des produits, les unités en stock, les unités commandées et les niveaux de réorganisation, un utilisateur peut également être intéressé par des informations agrégées, telles que le prix moyen, le nombre total d’unités en stock, etc.</span><span class="sxs-lookup"><span data-stu-id="e107f-111">In addition to seeing each of the products' prices, units in stock, units on order, and reorder levels, a user might also be interested in aggregate information, such as the average price, the total number of units in stock, and so on.</span></span> <span data-ttu-id="e107f-112">Ces informations récapitulatives sont souvent affichées en bas du rapport dans une ligne de synthèse.</span><span class="sxs-lookup"><span data-stu-id="e107f-112">Such summary information is often displayed at the bottom of the report in a summary row.</span></span> <span data-ttu-id="e107f-113">Le contrôle GridView peut inclure une ligne de pied de page dans dont les cellules peuvent injecter des données agrégées par programmation.</span><span class="sxs-lookup"><span data-stu-id="e107f-113">The GridView control can include a footer row into whose cells we can programmatically inject aggregate data.</span></span>

<span data-ttu-id="e107f-114">Cette tâche présente trois défis :</span><span class="sxs-lookup"><span data-stu-id="e107f-114">This task presents us with three challenges:</span></span>

1. <span data-ttu-id="e107f-115">Configuration du contrôle GridView pour afficher sa ligne de pied de page</span><span class="sxs-lookup"><span data-stu-id="e107f-115">Configuring the GridView to display its footer row</span></span>
2. <span data-ttu-id="e107f-116">Détermination des données de synthèse ; autrement dit, comment calculer le prix moyen ou le total des unités en stock ?</span><span class="sxs-lookup"><span data-stu-id="e107f-116">Determining the summary data; that is, how do we compute the average price or the total of the units in stock?</span></span>
3. <span data-ttu-id="e107f-117">Injection des données de synthèse dans les cellules appropriées de la ligne de pied de page</span><span class="sxs-lookup"><span data-stu-id="e107f-117">Injecting the summary data into the appropriate cells of the footer row</span></span>

<span data-ttu-id="e107f-118">Dans ce didacticiel, nous allons voir comment surmonter ces défis.</span><span class="sxs-lookup"><span data-stu-id="e107f-118">In this tutorial we'll see how to overcome these challenges.</span></span> <span data-ttu-id="e107f-119">Plus précisément, nous allons créer une page qui répertorie les catégories dans une liste déroulante avec les produits de la catégorie sélectionnée affichés dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="e107f-119">Specifically, we'll create a page that lists the categories in a drop-down list with the selected category's products displayed in a GridView.</span></span> <span data-ttu-id="e107f-120">Le GridView inclut une ligne de pied de page qui indique le prix moyen et le nombre total d’unités en stock et sur la commande pour les produits de cette catégorie.</span><span class="sxs-lookup"><span data-stu-id="e107f-120">The GridView will include a footer row that shows the average price and total number of units in stock and on order for products in that category.</span></span>

<span data-ttu-id="e107f-121">[![informations récapitulatives sont affichées dans la ligne de pied de page du GridView](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image2.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-121">[![Summary Information is Displayed in the GridView's Footer Row](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image2.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="e107f-122">**Figure 1**: les informations de résumé sont affichées dans la ligne de pied de page du GridView ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-122">**Figure 1**: Summary Information is Displayed in the GridView's Footer Row ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image3.png))</span></span>

<span data-ttu-id="e107f-123">Ce didacticiel, avec sa catégorie d’interface maître/détail de produits, s’appuie sur les concepts abordés dans le précédent [filtrage maître/détail avec un didacticiel DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="e107f-123">This tutorial, with its category to products master/detail interface, builds upon the concepts covered in the earlier [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial.</span></span> <span data-ttu-id="e107f-124">Si vous n’avez pas encore travaillé dans le didacticiel précédent, veuillez le faire avant de continuer avec celui-ci.</span><span class="sxs-lookup"><span data-stu-id="e107f-124">If you've not yet worked through the earlier tutorial, please do so before continuing on with this one.</span></span>

## <a name="step-1-adding-the-categories-dropdownlist-and-products-gridview"></a><span data-ttu-id="e107f-125">Étape 1 : ajout des catégories DropDownList et Products GridView</span><span class="sxs-lookup"><span data-stu-id="e107f-125">Step 1: Adding the Categories DropDownList and Products GridView</span></span>

<span data-ttu-id="e107f-126">Avant d’ajouter des informations de synthèse au pied de page du GridView, nous allons tout d’abord créer simplement le rapport maître/détail.</span><span class="sxs-lookup"><span data-stu-id="e107f-126">Before concerning ourselves with adding summary information to the GridView's footer, let's first simply build the master/detail report.</span></span> <span data-ttu-id="e107f-127">Une fois cette première étape terminée, nous verrons comment inclure des données de synthèse.</span><span class="sxs-lookup"><span data-stu-id="e107f-127">Once we've completed this first step, we'll look at how to include summary data.</span></span>

<span data-ttu-id="e107f-128">Commencez par ouvrir la page `SummaryDataInFooter.aspx` dans le dossier `CustomFormatting`.</span><span class="sxs-lookup"><span data-stu-id="e107f-128">Start by opening the `SummaryDataInFooter.aspx` page in the `CustomFormatting` folder.</span></span> <span data-ttu-id="e107f-129">Ajoutez un contrôle DropDownList et affectez à son `ID` la valeur `Categories`.</span><span class="sxs-lookup"><span data-stu-id="e107f-129">Add a DropDownList control and set its `ID` to `Categories`.</span></span> <span data-ttu-id="e107f-130">Ensuite, cliquez sur le lien choisir la source de données à partir de la balise active de DropDownList et choisissez d’ajouter un nouvel ObjectDataSource nommé `CategoriesDataSource` qui appelle la méthode de `GetCategories()` de la classe `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="e107f-130">Next, click on the Choose Data Source link from the DropDownList's smart tag and opt to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>

<span data-ttu-id="e107f-131">[![ajouter un nouvel ObjectDataSource nommé CategoriesDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image5.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-131">[![Add a New ObjectDataSource Named CategoriesDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image5.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image4.png)</span></span>

<span data-ttu-id="e107f-132">**Figure 2**: ajouter un nouvel ObjectDataSource nommé `CategoriesDataSource` ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-132">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="e107f-133">[![que ObjectDataSource appelle la méthode GetCategories () de la classe CategoriesBLL](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image8.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-133">[![Have the ObjectDataSource Invoke the CategoriesBLL Class's GetCategories() Method](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image8.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="e107f-134">**Figure 3**: demander à ObjectDataSource d’appeler la méthode `GetCategories()` de la classe `CategoriesBLL` ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-134">**Figure 3**: Have the ObjectDataSource Invoke the `CategoriesBLL` Class's `GetCategories()` Method ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image9.png))</span></span>

<span data-ttu-id="e107f-135">Après la configuration de l’ObjectDataSource, l’Assistant vous renvoie à l’Assistant Configuration de source de données DropDownList à partir duquel nous devons spécifier la valeur du champ de données à afficher et celle qui doit correspondre à la valeur de la `ListItem` s du DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e107f-135">After configuring the ObjectDataSource, the wizard returns us to the DropDownList's Data Source Configuration wizard from which we need to specify what data field value should be displayed and which one should correspond to the value of the DropDownList's `ListItem` s.</span></span> <span data-ttu-id="e107f-136">Affichez le champ `CategoryName` et utilisez le `CategoryID` comme valeur.</span><span class="sxs-lookup"><span data-stu-id="e107f-136">Have the `CategoryName` field displayed and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="e107f-137">[![utiliser les champs CategoryName et CategoryID comme texte et valeur pour les ListItems, respectivement](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image11.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-137">[![Use the CategoryName and CategoryID Fields as the Text and Value for the ListItems, Respectively](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image11.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image10.png)</span></span>

<span data-ttu-id="e107f-138">**Figure 4**: utiliser les champs `CategoryName` et `CategoryID` comme `Text` et `Value` pour la `ListItem` s, respectivement ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-138">**Figure 4**: Use the `CategoryName` and `CategoryID` Fields as the `Text` and `Value` for the `ListItem` s, Respectively ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="e107f-139">À ce stade, nous disposons d’un DropDownList (`Categories`) qui répertorie les catégories dans le système.</span><span class="sxs-lookup"><span data-stu-id="e107f-139">At this point we have a DropDownList (`Categories`) that lists the categories in the system.</span></span> <span data-ttu-id="e107f-140">Nous devons maintenant ajouter un GridView qui répertorie les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e107f-140">We now need to add a GridView that lists those products that belong to the selected category.</span></span> <span data-ttu-id="e107f-141">Avant cela, cependant, prenez un moment pour vérifier la case à cocher Activer AutoPostBack dans la balise active de DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e107f-141">Before we do, though, take a moment to check the Enable AutoPostBack checkbox in the DropDownList's smart tag.</span></span> <span data-ttu-id="e107f-142">Comme indiqué dans le didacticiel *maître/détail de filtrage avec DropDownList* , en affectant à la propriété `AutoPostBack` de DropDownList la valeur `True` la page est publiée chaque fois que la valeur DropDownList est modifiée.</span><span class="sxs-lookup"><span data-stu-id="e107f-142">As discussed in the *Master/Detail Filtering With a DropDownList* tutorial, by setting the DropDownList's `AutoPostBack` property to `True` the page will be posted back each time the DropDownList value is changed.</span></span> <span data-ttu-id="e107f-143">Cela entraînera l’actualisation du contrôle GridView, en présentant les produits de la catégorie nouvellement sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e107f-143">This will cause the GridView to be refreshed, showing those products for the newly selected category.</span></span> <span data-ttu-id="e107f-144">Si la propriété `AutoPostBack` est définie sur `False` (valeur par défaut), la modification de la catégorie n’entraîne pas de publication et par conséquent ne met pas à jour les produits listés.</span><span class="sxs-lookup"><span data-stu-id="e107f-144">If the `AutoPostBack` property is set to `False` (the default), changing the category won't cause a postback and therefore won't update the listed products.</span></span>

<span data-ttu-id="e107f-145">[![activez la case à cocher Activer AutoPostBack dans la balise active de DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image14.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-145">[![Check the Enable AutoPostBack Checkbox in the DropDownList's Smart Tag](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image14.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="e107f-146">**Figure 5**: activer la case à cocher Activer AutoPostBack dans la balise active de DropDownList ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-146">**Figure 5**: Check the Enable AutoPostBack Checkbox in the DropDownList's Smart Tag ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image15.png))</span></span>

<span data-ttu-id="e107f-147">Ajoutez un contrôle GridView à la page afin d’afficher les produits pour la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e107f-147">Add a GridView control to the page in order to display the products for the selected category.</span></span> <span data-ttu-id="e107f-148">Définissez le `ID` du GridView sur `ProductsInCategory` et liez-le à un nouvel ObjectDataSource nommé `ProductsInCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e107f-148">Set the GridView's `ID` to `ProductsInCategory` and bind it to a new ObjectDataSource named `ProductsInCategoryDataSource`.</span></span>

<span data-ttu-id="e107f-149">[![ajouter un nouvel ObjectDataSource nommé ProductsInCategoryDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image17.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-149">[![Add a New ObjectDataSource Named ProductsInCategoryDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image17.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image16.png)</span></span>

<span data-ttu-id="e107f-150">**Figure 6**: ajouter un nouvel ObjectDataSource nommé `ProductsInCategoryDataSource` ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-150">**Figure 6**: Add a New ObjectDataSource Named `ProductsInCategoryDataSource` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image18.png))</span></span>

<span data-ttu-id="e107f-151">Configurez l’ObjectDataSource afin qu’il appelle la méthode `GetProductsByCategoryID(categoryID)` de la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="e107f-151">Configure the ObjectDataSource so that it invokes the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="e107f-152">[![que ObjectDataSource appelle la méthode GetProductsByCategoryID (categoryID)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image20.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-152">[![Have the ObjectDataSource Invoke the GetProductsByCategoryID(categoryID) Method](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image20.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="e107f-153">**Figure 7**: demander à ObjectDataSource d’appeler la méthode `GetProductsByCategoryID(categoryID)` ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-153">**Figure 7**: Have the ObjectDataSource Invoke the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image21.png))</span></span>

<span data-ttu-id="e107f-154">Étant donné que la méthode `GetProductsByCategoryID(categoryID)` prend un paramètre d’entrée, à l’étape finale de l’Assistant, nous pouvons spécifier la source de la valeur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="e107f-154">Since the `GetProductsByCategoryID(categoryID)` method takes in an input parameter, in the final step of the wizard we can specify the source of the parameter value.</span></span> <span data-ttu-id="e107f-155">Pour afficher ces produits à partir de la catégorie sélectionnée, le paramètre doit être extrait de la `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e107f-155">In order to display those products from the selected category, have the parameter pulled from the `Categories` DropDownList.</span></span>

<span data-ttu-id="e107f-156">[![d’accéder à la valeur du paramètre categoryID à partir du DropDownList des catégories sélectionnées](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image23.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-156">[![Get the categoryID Parameter Value from the Selected Categories DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image23.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image22.png)</span></span>

<span data-ttu-id="e107f-157">**Figure 8**: obtenir la valeur du paramètre *`categoryID`* à partir du DropDownList des catégories sélectionnées ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-157">**Figure 8**: Get the *`categoryID`* Parameter Value from the Selected Categories DropDownList ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image24.png))</span></span>

<span data-ttu-id="e107f-158">Une fois l’Assistant terminé, le contrôle GridView aura un BoundField pour chacune des propriétés de produit.</span><span class="sxs-lookup"><span data-stu-id="e107f-158">After completing the wizard the GridView will have a BoundField for each of the product properties.</span></span> <span data-ttu-id="e107f-159">Nous allons nettoyer ces BoundFields afin que seuls les `ProductName`, `UnitPrice`, `UnitsInStock`et `UnitsOnOrder` BoundFields soient affichés.</span><span class="sxs-lookup"><span data-stu-id="e107f-159">Let's clean up these BoundFields so that only the `ProductName`, `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` BoundFields are displayed.</span></span> <span data-ttu-id="e107f-160">N’hésitez pas à ajouter des paramètres au niveau du champ aux BoundFields restants (comme la mise en forme de la `UnitPrice` comme une devise).</span><span class="sxs-lookup"><span data-stu-id="e107f-160">Feel free to add any field-level settings to the remaining BoundFields (such as formatting the `UnitPrice` as a currency).</span></span> <span data-ttu-id="e107f-161">Après avoir apporté ces modifications, le balisage déclaratif de GridView doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="e107f-161">After making these changes, the GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="e107f-162">À ce stade, nous disposons d’un rapport maître/détail entièrement fonctionnel qui indique le nom, le prix unitaire, les unités en stock et les unités pour les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e107f-162">At this point we have a fully functioning master/detail report that shows the name, unit price, units in stock, and units on order for those products that belong to the selected category.</span></span>

<span data-ttu-id="e107f-163">[![d’accéder à la valeur du paramètre categoryID à partir du DropDownList des catégories sélectionnées](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image26.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-163">[![Get the categoryID Parameter Value from the Selected Categories DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image26.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image25.png)</span></span>

<span data-ttu-id="e107f-164">**Figure 9**: obtenir la valeur du paramètre *`categoryID`* à partir du DropDownList des catégories sélectionnées ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-164">**Figure 9**: Get the *`categoryID`* Parameter Value from the Selected Categories DropDownList ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image27.png))</span></span>

## <a name="step-2-displaying-a-footer-in-the-gridview"></a><span data-ttu-id="e107f-165">Étape 2 : affichage d’un pied de page dans le GridView</span><span class="sxs-lookup"><span data-stu-id="e107f-165">Step 2: Displaying a Footer in the GridView</span></span>

<span data-ttu-id="e107f-166">Le contrôle GridView peut afficher à la fois une ligne d’en-tête et de pied de page.</span><span class="sxs-lookup"><span data-stu-id="e107f-166">The GridView control can display both a header and footer row.</span></span> <span data-ttu-id="e107f-167">Ces lignes sont affichées en fonction des valeurs des propriétés `ShowHeader` et `ShowFooter`, respectivement, avec `ShowHeader` par défaut `True` et `ShowFooter` à `False`.</span><span class="sxs-lookup"><span data-stu-id="e107f-167">These rows are displayed depending on the values of the `ShowHeader` and `ShowFooter` properties, respectively, with `ShowHeader` defaulting to `True` and `ShowFooter` to `False`.</span></span> <span data-ttu-id="e107f-168">Pour inclure un pied de page dans le GridView, définissez simplement sa propriété `ShowFooter` sur `True`.</span><span class="sxs-lookup"><span data-stu-id="e107f-168">To include a footer in the GridView simply set its `ShowFooter` property to `True`.</span></span>

<span data-ttu-id="e107f-169">[![affectez la valeur true à la propriété ShowFooter de GridView.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image29.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-169">[![Set the GridView's ShowFooter Property to True](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image29.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image28.png)</span></span>

<span data-ttu-id="e107f-170">**Figure 10**: définir la propriété `ShowFooter` de GridView sur `True` ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-170">**Figure 10**: Set the GridView's `ShowFooter` Property to `True` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image30.png))</span></span>

<span data-ttu-id="e107f-171">La ligne de pied de page contient une cellule pour chacun des champs définis dans le GridView ; Toutefois, ces cellules sont vides par défaut.</span><span class="sxs-lookup"><span data-stu-id="e107f-171">The footer row has a cell for each of the fields defined in the GridView; however, these cells are empty by default.</span></span> <span data-ttu-id="e107f-172">Prenez un moment pour voir notre progression dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="e107f-172">Take a moment to view our progress in a browser.</span></span> <span data-ttu-id="e107f-173">Avec la propriété `ShowFooter` maintenant définie sur `True`, le contrôle GridView contient une ligne de pied de page vide.</span><span class="sxs-lookup"><span data-stu-id="e107f-173">With the `ShowFooter` property now set to `True`, the GridView includes an empty footer row.</span></span>

<span data-ttu-id="e107f-174">[![le contrôle GridView contient désormais une ligne de pied de page](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image32.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-174">[![The GridView Now Includes a Footer Row](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image32.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image31.png)</span></span>

<span data-ttu-id="e107f-175">**Figure 11**: le contrôle GridView comprend désormais une ligne de pied de page ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-175">**Figure 11**: The GridView Now Includes a Footer Row ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image33.png))</span></span>

<span data-ttu-id="e107f-176">La ligne de pied de page de la figure 11 ne se distingue pas, car elle a un arrière-plan blanc.</span><span class="sxs-lookup"><span data-stu-id="e107f-176">The footer row in Figure 11 doesn't stand out, as it has a white background.</span></span> <span data-ttu-id="e107f-177">Créons une classe CSS `FooterStyle` dans `Styles.css` qui spécifie un arrière-plan rouge foncé, puis configurez le fichier d’apparence `GridView.skin` dans le thème `DataWebControls` pour assigner cette classe CSS à la propriété `FooterStyle`de l' `CssClass` du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="e107f-177">Let's create a `FooterStyle` CSS class in `Styles.css` that specifies a dark red background and then configure the `GridView.skin` Skin file in the `DataWebControls` Theme to assign this CSS class to the GridView's `FooterStyle`'s `CssClass` property.</span></span> <span data-ttu-id="e107f-178">Si vous avez besoin d’effectuer une mise en forme sur des apparences et des thèmes, reportez-vous au didacticiel [affichage des données avec ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="e107f-178">If you need to brush up on Skins and Themes, refer back to the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial.</span></span>

<span data-ttu-id="e107f-179">Commencez par ajouter la classe CSS suivante à `Styles.css`:</span><span class="sxs-lookup"><span data-stu-id="e107f-179">Start by adding the following CSS class to `Styles.css`:</span></span>

[!code-css[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample2.css)]

<span data-ttu-id="e107f-180">La classe CSS `FooterStyle` est semblable à celle de la classe `HeaderStyle`, bien que la couleur d’arrière-plan du `HeaderStyle`soit plus foncée et que son texte s’affiche dans une police en gras.</span><span class="sxs-lookup"><span data-stu-id="e107f-180">The `FooterStyle` CSS class is similar in style to the `HeaderStyle` class, although the `HeaderStyle`'s background color is subtlety darker and its text is displayed in a bold font.</span></span> <span data-ttu-id="e107f-181">En outre, le texte du pied de page est aligné à droite, tandis que le texte de l’en-tête est centré.</span><span class="sxs-lookup"><span data-stu-id="e107f-181">Furthermore, the text in the footer is right-aligned whereas the header's text is centered.</span></span>

<span data-ttu-id="e107f-182">Ensuite, pour associer cette classe CSS à chaque pied de page de GridView, ouvrez le fichier `GridView.skin` dans le thème `DataWebControls` et définissez la propriété `CssClass` de `FooterStyle`.</span><span class="sxs-lookup"><span data-stu-id="e107f-182">Next, to associate this CSS class with every GridView's footer, open the `GridView.skin` file in the `DataWebControls` Theme and set the `FooterStyle`'s `CssClass` property.</span></span> <span data-ttu-id="e107f-183">Après cet ajout, le balisage du fichier doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="e107f-183">After this addition the file's markup should look like:</span></span>

[!code-aspx[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="e107f-184">Comme le montre la capture d’écran ci-dessous, cette modification rend le pied de page plus clairement.</span><span class="sxs-lookup"><span data-stu-id="e107f-184">As the screen shot below shows, this change makes the footer stand out more clearly.</span></span>

<span data-ttu-id="e107f-185">[![la ligne de pied de page du GridView a maintenant une couleur d’arrière-plan rougeâtre](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image35.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-185">[![The GridView's Footer Row Now Has a Reddish Background Color](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image35.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image34.png)</span></span>

<span data-ttu-id="e107f-186">**Figure 12**: la ligne de pied de page du GridView a maintenant une couleur d’arrière-plan rougeâtre ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-186">**Figure 12**: The GridView's Footer Row Now Has a Reddish Background Color ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image36.png))</span></span>

## <a name="step-3-computing-the-summary-data"></a><span data-ttu-id="e107f-187">Étape 3 : calcul des données de synthèse</span><span class="sxs-lookup"><span data-stu-id="e107f-187">Step 3: Computing the Summary Data</span></span>

<span data-ttu-id="e107f-188">Le pied de page du GridView étant affiché, le défi suivant est de savoir comment calculer les données de synthèse.</span><span class="sxs-lookup"><span data-stu-id="e107f-188">With the GridView's footer displayed, the next challenge facing us is how to compute the summary data.</span></span> <span data-ttu-id="e107f-189">Il existe deux façons de calculer ces informations d’agrégation :</span><span class="sxs-lookup"><span data-stu-id="e107f-189">There are two ways to compute this aggregate information:</span></span>

1. <span data-ttu-id="e107f-190">À l’aide d’une requête SQL, nous pourrions émettre une requête supplémentaire à la base de données pour calculer les données de synthèse d’une catégorie particulière.</span><span class="sxs-lookup"><span data-stu-id="e107f-190">Through a SQL query we could issue an additional query to the database to compute the summary data for a particular category.</span></span> <span data-ttu-id="e107f-191">SQL comprend un certain nombre de fonctions d’agrégation, ainsi qu’une clause `GROUP BY` pour spécifier les données sur lesquelles les données doivent être résumées.</span><span class="sxs-lookup"><span data-stu-id="e107f-191">SQL includes a number of aggregate functions along with a `GROUP BY` clause to specify the data over which the data should be summarized.</span></span> <span data-ttu-id="e107f-192">La requête SQL suivante permet de rétablir les informations nécessaires :</span><span class="sxs-lookup"><span data-stu-id="e107f-192">The following SQL query would bring back the needed information:</span></span>  

    [!code-sql[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample4.sql)]

    <span data-ttu-id="e107f-193">Bien entendu, vous ne souhaitez pas émettre cette requête directement à partir de la page `SummaryDataInFooter.aspx`, mais plutôt en créant une méthode dans le `ProductsTableAdapter` et le `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="e107f-193">Of course you wouldn't want to issue this query directly from the `SummaryDataInFooter.aspx` page, but rather by creating a method in the `ProductsTableAdapter` and the `ProductsBLL`.</span></span>
2. <span data-ttu-id="e107f-194">Calculez ces informations au fur et à mesure qu’elles sont ajoutées au contrôle GridView, comme indiqué dans la [page mise en forme personnalisée basée](custom-formatting-based-upon-data-cs.md) sur les données, le gestionnaire d’événements `RowDataBound` du GridView se déclenche une fois pour chaque ligne ajoutée au contrôle GridView après avoir été lié aux données.</span><span class="sxs-lookup"><span data-stu-id="e107f-194">Compute this information as it's being added to the GridView as discussed in [Custom Formatting Based Upon Data](custom-formatting-based-upon-data-cs.md) tutorial, the GridView's `RowDataBound` event handler fires once for each row being added to the GridView after its been databound.</span></span> <span data-ttu-id="e107f-195">En créant un gestionnaire d’événements pour cet événement, nous pouvons conserver un total cumulé des valeurs que vous souhaitez agréger.</span><span class="sxs-lookup"><span data-stu-id="e107f-195">By creating an event handler for this event we can keep a running total of the values we want to aggregate.</span></span> <span data-ttu-id="e107f-196">Une fois que la dernière ligne de données a été liée au GridView, nous avons les totaux et les informations nécessaires pour calculer la moyenne.</span><span class="sxs-lookup"><span data-stu-id="e107f-196">After the last data row has been bound to the GridView we have the totals and the information needed to compute the average.</span></span>

<span data-ttu-id="e107f-197">J’utilise généralement la deuxième approche, car elle enregistre un voyage dans la base de données et l’effort nécessaire pour implémenter la fonctionnalité de résumé dans la couche d’accès aux données et la couche de logique métier, mais l’une ou l’autre approche suffirait.</span><span class="sxs-lookup"><span data-stu-id="e107f-197">I typically employ the second approach as it saves a trip to the database and the effort needed to implement the summary functionality in the Data Access Layer and Business Logic Layer, but either approach would suffice.</span></span> <span data-ttu-id="e107f-198">Pour ce didacticiel, nous allons utiliser la deuxième option et effectuer le suivi du total cumulé à l’aide du gestionnaire d’événements `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="e107f-198">For this tutorial let's use the second option and keep track of the running total using the `RowDataBound` event handler.</span></span>

<span data-ttu-id="e107f-199">Créez un gestionnaire d’événements `RowDataBound` pour le contrôle GridView en sélectionnant le contrôle GridView dans le concepteur, en cliquant sur l’icône représentant un éclair dans le Fenêtre Propriétés et en double-cliquant sur l’événement `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="e107f-199">Create a `RowDataBound` event handler for the GridView by selecting the GridView in the Designer, clicking the lightning bolt icon from the Properties window, and double-clicking the `RowDataBound` event.</span></span> <span data-ttu-id="e107f-200">Vous pouvez également sélectionner le contrôle GridView et son événement RowDataBound dans les listes déroulantes situées en haut du fichier de classe code-behind ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e107f-200">Alternatively, you can select the GridView and its RowDataBound event from the drop-down lists at the top of the ASP.NET code-behind class file.</span></span> <span data-ttu-id="e107f-201">Cela permet de créer un nouveau gestionnaire d’événements nommé `ProductsInCategory_RowDataBound` dans la classe code-behind de la page `SummaryDataInFooter.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e107f-201">This will create a new event handler named `ProductsInCategory_RowDataBound` in the `SummaryDataInFooter.aspx` page's code-behind class.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample5.vb)]

<span data-ttu-id="e107f-202">Pour maintenir un total cumulé, nous devons définir des variables en dehors de l’étendue du gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e107f-202">In order to maintain a running total we need to define variables outside of the scope of the event handler.</span></span> <span data-ttu-id="e107f-203">Créez les quatre variables suivantes au niveau de la page :</span><span class="sxs-lookup"><span data-stu-id="e107f-203">Create the following four page-level variables:</span></span>

- <span data-ttu-id="e107f-204">`_totalUnitPrice`, de type `Decimal`</span><span class="sxs-lookup"><span data-stu-id="e107f-204">`_totalUnitPrice`, of type `Decimal`</span></span>
- <span data-ttu-id="e107f-205">`_totalNonNullUnitPriceCount`, de type `Integer`</span><span class="sxs-lookup"><span data-stu-id="e107f-205">`_totalNonNullUnitPriceCount`, of type `Integer`</span></span>
- <span data-ttu-id="e107f-206">`_totalUnitsInStock`, de type `Integer`</span><span class="sxs-lookup"><span data-stu-id="e107f-206">`_totalUnitsInStock`, of type `Integer`</span></span>
- <span data-ttu-id="e107f-207">`_totalUnitsOnOrder`, de type `Integer`</span><span class="sxs-lookup"><span data-stu-id="e107f-207">`_totalUnitsOnOrder`, of type `Integer`</span></span>

<span data-ttu-id="e107f-208">Ensuite, écrivez le code pour incrémenter ces trois variables pour chaque ligne de données rencontrée dans le gestionnaire d’événements `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="e107f-208">Next, write the code to increment these three variables for each data row encountered in the `RowDataBound` event handler.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample6.vb)]

<span data-ttu-id="e107f-209">Le gestionnaire d’événements `RowDataBound` démarre en vous assurant que nous traitons un DataRow.</span><span class="sxs-lookup"><span data-stu-id="e107f-209">The `RowDataBound` event handler starts by ensuring that we're dealing with a DataRow.</span></span> <span data-ttu-id="e107f-210">Une fois cette opération établie, l' `Northwind.ProductsRow` instance qui vient d’être liée à l’objet `GridViewRow` dans `e.Row` est stockée dans la variable `product`.</span><span class="sxs-lookup"><span data-stu-id="e107f-210">Once that's been established, the `Northwind.ProductsRow` instance that was just bound to the `GridViewRow` object in `e.Row` is stored in the variable `product`.</span></span> <span data-ttu-id="e107f-211">Ensuite, l’exécution des variables totales est incrémentée par les valeurs correspondantes du produit en cours (en supposant qu’elles ne contiennent pas de base de données `NULL` valeur).</span><span class="sxs-lookup"><span data-stu-id="e107f-211">Next, running total variables are incremented by the current product's corresponding values (assuming that they don't contain a database `NULL` value).</span></span> <span data-ttu-id="e107f-212">Nous effectuons le suivi du total des `UnitPrice` en cours d’exécution et du nombre d’enregistrements non`NULL` `UnitPrice`, car le prix moyen est le quotient de ces deux nombres.</span><span class="sxs-lookup"><span data-stu-id="e107f-212">We keep track of both the running `UnitPrice` total and the number of non-`NULL` `UnitPrice` records because the average price is the quotient of these two numbers.</span></span>

## <a name="step-4-displaying-the-summary-data-in-the-footer"></a><span data-ttu-id="e107f-213">Étape 4 : affichage des données de synthèse dans le pied de page</span><span class="sxs-lookup"><span data-stu-id="e107f-213">Step 4: Displaying the Summary Data in the Footer</span></span>

<span data-ttu-id="e107f-214">Avec les données de synthèse totalisées, la dernière étape consiste à les afficher dans la ligne de pied de page du GridView.</span><span class="sxs-lookup"><span data-stu-id="e107f-214">With the summary data totaled, the last step is to display it in the GridView's footer row.</span></span> <span data-ttu-id="e107f-215">Cette tâche peut également être accomplie par programme par le biais du gestionnaire d’événements `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="e107f-215">This task, too, can be accomplished programmatically through the `RowDataBound` event handler.</span></span> <span data-ttu-id="e107f-216">Rappelez-vous que le gestionnaire d’événements `RowDataBound` se déclenche pour *chaque* ligne liée au GridView, y compris la ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="e107f-216">Recall that the `RowDataBound` event handler fires for *every* row that's bound to the GridView, including the footer row.</span></span> <span data-ttu-id="e107f-217">Par conséquent, nous pouvons augmenter notre gestionnaire d’événements pour afficher les données dans la ligne de pied de page à l’aide du code suivant :</span><span class="sxs-lookup"><span data-stu-id="e107f-217">Therefore, we can augment our event handler to display the data in the footer row using the following code:</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="e107f-218">Étant donné que la ligne de pied de page est ajoutée au contrôle GridView après l’ajout de toutes les lignes de données, nous pouvons être sûrs que, lorsque nous sommes prêts à afficher les données de synthèse dans le pied de page, le nombre total d’exécutions est terminé.</span><span class="sxs-lookup"><span data-stu-id="e107f-218">Since the footer row is added to the GridView after all of the data rows have been added, we can be confident that by the time we're ready to display the summary data in the footer the running total calculations will have completed.</span></span> <span data-ttu-id="e107f-219">La dernière étape consiste à définir ces valeurs dans les cellules du pied de page.</span><span class="sxs-lookup"><span data-stu-id="e107f-219">The last step, then, is to set these values in the footer's cells.</span></span>

<span data-ttu-id="e107f-220">Pour afficher du texte dans une cellule de pied de page particulière, utilisez `e.Row.Cells(index).Text = value`, où l’indexation `Cells` commence à 0.</span><span class="sxs-lookup"><span data-stu-id="e107f-220">To display text in a particular footer cell, use `e.Row.Cells(index).Text = value`, where the `Cells` indexing starts at 0.</span></span> <span data-ttu-id="e107f-221">Le code suivant calcule le prix moyen (le prix total divisé par le nombre de produits) et l’affiche, ainsi que le nombre total d’unités en stock et en unités sur la commande dans les cellules de pied de page appropriées du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="e107f-221">The following code computes the average price (the total price divided by the number of products) and displays it along with the total number of units in stock and units on order in the appropriate footer cells of the GridView.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="e107f-222">La figure 13 illustre le rapport une fois que ce code a été ajouté.</span><span class="sxs-lookup"><span data-stu-id="e107f-222">Figure 13 shows the report after this code has been added.</span></span> <span data-ttu-id="e107f-223">Notez la manière dont le `ToString("c")` entraîne une mise en forme des informations de synthèse des prix moyens comme une devise.</span><span class="sxs-lookup"><span data-stu-id="e107f-223">Note how the `ToString("c")` causes the average price summary information to be formatted like a currency.</span></span>

<span data-ttu-id="e107f-224">[![la ligne de pied de page du GridView a maintenant une couleur d’arrière-plan rougeâtre](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image38.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="e107f-224">[![The GridView's Footer Row Now Has a Reddish Background Color](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image38.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image37.png)</span></span>

<span data-ttu-id="e107f-225">**Figure 13**: la ligne de pied de page du GridView a maintenant une couleur d’arrière-plan rougeâtre ([cliquez pour afficher l’image en taille réelle](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="e107f-225">**Figure 13**: The GridView's Footer Row Now Has a Reddish Background Color ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image39.png))</span></span>

## <a name="summary"></a><span data-ttu-id="e107f-226">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="e107f-226">Summary</span></span>

<span data-ttu-id="e107f-227">L’affichage des données de synthèse est une exigence courante pour les rapports et le contrôle GridView facilite l’inclusion de telles informations dans sa ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="e107f-227">Displaying summary data is a common report requirement, and the GridView control makes it easy to include such information in its footer row.</span></span> <span data-ttu-id="e107f-228">La ligne de pied de page s’affiche lorsque la propriété `ShowFooter` du GridView est définie sur `True` et que le texte de ses cellules peut être défini par programme via le gestionnaire d’événements `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="e107f-228">The footer row is displayed when the GridView's `ShowFooter` property is set to `True` and can have the text in its cells set programmatically through the `RowDataBound` event handler.</span></span> <span data-ttu-id="e107f-229">Le calcul des données de synthèse peut être effectué en interrogeant à nouveau la base de données ou en utilisant le code de la classe code-behind de la page ASP.NET pour calculer par programmation les données de synthèse.</span><span class="sxs-lookup"><span data-stu-id="e107f-229">Computing the summary data can either be done by re-querying the database or by using code in the ASP.NET page's code-behind class to programmatically compute the summary data.</span></span>

<span data-ttu-id="e107f-230">Ce didacticiel conclut notre examen de la mise en forme personnalisée avec les contrôles GridView, DetailsView et FormView.</span><span class="sxs-lookup"><span data-stu-id="e107f-230">This tutorial concludes our examination of custom formatting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="e107f-231">Notre prochain didacticiel lance l’exploration de l’insertion, de la mise à jour et de la suppression de données à l’aide de ces mêmes contrôles.</span><span class="sxs-lookup"><span data-stu-id="e107f-231">Our next tutorial kicks off our exploration of inserting, updating, and deleting data using these same controls.</span></span>

<span data-ttu-id="e107f-232">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="e107f-232">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e107f-233">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="e107f-233">About the Author</span></span>

<span data-ttu-id="e107f-234">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="e107f-234">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e107f-235">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="e107f-235">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e107f-236">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e107f-236">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e107f-237">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e107f-237">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e107f-238">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e107f-238">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="e107f-239">Précédent</span><span class="sxs-lookup"><span data-stu-id="e107f-239">Previous</span></span>](using-the-formview-s-templates-vb.md)
