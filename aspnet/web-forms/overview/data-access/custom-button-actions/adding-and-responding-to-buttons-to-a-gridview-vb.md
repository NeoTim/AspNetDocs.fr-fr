---
uid: web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
title: Ajout et réponse à des boutons sur un GridView (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons examiner comment ajouter des boutons personnalisés, à la fois à un modèle et aux champs d’un contrôle GridView ou DetailsView. En particulier, nous allons le...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: 06c6bbd2-4bdc-435b-87a3-df2c868f4baa
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
msc.type: authoredcontent
ms.openlocfilehash: 8727d8faead02340d223c75845bf29f63d1a0834
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78549475"
---
# <a name="adding-and-responding-to-buttons-to-a-gridview-vb"></a><span data-ttu-id="0df8f-104">Ajout et réponse à des boutons sur un GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="0df8f-104">Adding and Responding to Buttons to a GridView (VB)</span></span>

<span data-ttu-id="0df8f-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0df8f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0df8f-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) ou [Télécharger le PDF](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0df8f-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) or [Download PDF](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span></span>

> <span data-ttu-id="0df8f-107">Dans ce didacticiel, nous allons examiner comment ajouter des boutons personnalisés, à la fois à un modèle et aux champs d’un contrôle GridView ou DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-107">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="0df8f-108">En particulier, nous allons créer une interface avec un contrôle FormView qui permet à l’utilisateur de parcourir les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="0df8f-108">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span>

## <a name="introduction"></a><span data-ttu-id="0df8f-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="0df8f-109">Introduction</span></span>

<span data-ttu-id="0df8f-110">Si de nombreux scénarios de création de rapports impliquent un accès en lecture seule aux données du rapport, il n’est pas rare que les rapports incluent la possibilité d’effectuer des actions basées sur les données affichées.</span><span class="sxs-lookup"><span data-stu-id="0df8f-110">While many reporting scenarios involve read-only access to the report data, it s not uncommon for reports to include the ability to perform actions based upon the data displayed.</span></span> <span data-ttu-id="0df8f-111">En général, cela impliquait l’ajout d’un contrôle Web Button, LinkButton ou ImageButton avec chaque enregistrement affiché dans le rapport qui, lorsque vous cliquez dessus, provoque une publication (postback) et appelle du code côté serveur.</span><span class="sxs-lookup"><span data-stu-id="0df8f-111">Typically this involved adding a Button, LinkButton, or ImageButton Web control with each record displayed in the report that, when clicked, causes a postback and invokes some server-side code.</span></span> <span data-ttu-id="0df8f-112">La modification et la suppression des données au moyen d’un enregistrement par enregistrement est l’exemple le plus courant.</span><span class="sxs-lookup"><span data-stu-id="0df8f-112">Editing and deleting the data on a record-by-record basis is the most common example.</span></span> <span data-ttu-id="0df8f-113">En fait, comme nous l’avons vu depuis la [Présentation de l’insertion, de la mise à jour et de la suppression du](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) didacticiel sur les données, la modification et la suppression sont si fréquentes que les contrôles GridView, DetailsView et FormView peuvent prendre en charge ces fonctionnalités sans avoir à écrire une seule ligne de code.</span><span class="sxs-lookup"><span data-stu-id="0df8f-113">In fact, as we saw starting with the [Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, editing and deleting is so common that the GridView, DetailsView, and FormView controls can support such functionality without the need for writing a single line of code.</span></span>

<span data-ttu-id="0df8f-114">Outre les boutons modifier et supprimer, les contrôles GridView, DetailsView et FormView peuvent également inclure des boutons, LinkButtons ou ImageButtons qui, lorsque vous cliquez dessus, exécutent une logique personnalisée côté serveur.</span><span class="sxs-lookup"><span data-stu-id="0df8f-114">In addition to Edit and Delete buttons, the GridView, DetailsView, and FormView controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="0df8f-115">Dans ce didacticiel, nous allons examiner comment ajouter des boutons personnalisés, à la fois à un modèle et aux champs d’un contrôle GridView ou DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-115">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="0df8f-116">En particulier, nous allons créer une interface avec un contrôle FormView qui permet à l’utilisateur de parcourir les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="0df8f-116">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span> <span data-ttu-id="0df8f-117">Pour un fournisseur donné, le contrôle FormView affiche des informations sur le fournisseur avec un contrôle Web Button qui, si vous cliquez dessus, marque tous les produits associés comme abandonnés.</span><span class="sxs-lookup"><span data-stu-id="0df8f-117">For a given supplier, the FormView will show information about the supplier along with a Button Web control that, if clicked, will mark all of their associated products as discontinued.</span></span> <span data-ttu-id="0df8f-118">En outre, un GridView répertorie les produits fournis par le fournisseur sélectionné, avec chaque ligne contenant les boutons augmenter le prix et prix de remise qui, si vous cliquez dessus, élèvent ou réduisent les `UnitPrice` du produit de 10% (voir figure 1).</span><span class="sxs-lookup"><span data-stu-id="0df8f-118">Additionally, a GridView lists those products provided by the selected supplier, with each row containing Increase Price and Discount Price Buttons that, if clicked, raise or reduce the product s `UnitPrice` by 10% (see Figure 1).</span></span>

<span data-ttu-id="0df8f-119">[![les contrôles FormView et GridView contiennent des boutons qui effectuent des actions personnalisées](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-119">[![Both the FormView and GridView Contain Buttons That Perform Custom Actions](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span></span>

<span data-ttu-id="0df8f-120">**Figure 1**: FormView et GridView contiennent des boutons qui effectuent des actions personnalisées ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-120">**Figure 1**: Both the FormView and GridView Contain Buttons That Perform Custom Actions ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span></span>

## <a name="step-1-adding-the-button-tutorial-web-pages"></a><span data-ttu-id="0df8f-121">Étape 1 : ajout des pages Web du didacticiel du bouton</span><span class="sxs-lookup"><span data-stu-id="0df8f-121">Step 1: Adding the Button Tutorial Web Pages</span></span>

<span data-ttu-id="0df8f-122">Avant d’examiner comment ajouter des boutons personnalisés, commençons par prendre un moment pour créer les pages ASP.NET dans notre projet de site Web dont nous aurons besoin pour ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="0df8f-122">Before we look at how to add a custom buttons, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="0df8f-123">Commencez par ajouter un nouveau dossier nommé `CustomButtons`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-123">Start by adding a new folder named `CustomButtons`.</span></span> <span data-ttu-id="0df8f-124">Ensuite, ajoutez les deux pages ASP.NET suivantes à ce dossier, en veillant à associer chaque page à la page maître `Site.master` :</span><span class="sxs-lookup"><span data-stu-id="0df8f-124">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`

![Ajouter les pages ASP.NET pour les didacticiels associés aux boutons personnalisés](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image4.png)

<span data-ttu-id="0df8f-126">**Figure 2**: ajouter les pages ASP.net pour les didacticiels associés aux boutons personnalisés</span><span class="sxs-lookup"><span data-stu-id="0df8f-126">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>

<span data-ttu-id="0df8f-127">Comme dans les autres dossiers, `Default.aspx` dans le dossier `CustomButtons` répertorie les didacticiels de la section.</span><span class="sxs-lookup"><span data-stu-id="0df8f-127">Like in the other folders, `Default.aspx` in the `CustomButtons` folder will list the tutorials in its section.</span></span> <span data-ttu-id="0df8f-128">N’oubliez pas que le contrôle utilisateur `SectionLevelTutorialListing.ascx` fournit cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="0df8f-128">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="0df8f-129">Par conséquent, ajoutez ce contrôle utilisateur à `Default.aspx` en le faisant glisser de l’Explorateur de solutions sur la page s Mode Création.</span><span class="sxs-lookup"><span data-stu-id="0df8f-129">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="0df8f-130">[![ajouter le contrôle utilisateur SectionLevelTutorialListing. ascx à default. aspx](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-130">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span></span>

<span data-ttu-id="0df8f-131">**Figure 3**: ajouter le contrôle utilisateur `SectionLevelTutorialListing.ascx` à `Default.aspx` ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-131">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span></span>

<span data-ttu-id="0df8f-132">Enfin, ajoutez les pages en tant qu’entrées au fichier `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-132">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="0df8f-133">Plus précisément, ajoutez le balisage suivant après la pagination et le tri `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="0df8f-133">Specifically, add the following markup after the Paging and Sorting `<siteMapNode>`:</span></span>

[!code-xml[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample1.xml)]

<span data-ttu-id="0df8f-134">Après avoir mis à jour `Web.sitemap`, prenez un moment pour afficher le site Web des didacticiels via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="0df8f-134">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="0df8f-135">Le menu à gauche contient maintenant des éléments pour les didacticiels de modification, d’insertion et de suppression.</span><span class="sxs-lookup"><span data-stu-id="0df8f-135">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![Le plan de site comprend désormais l’entrée du didacticiel sur les boutons personnalisés](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image8.png)

<span data-ttu-id="0df8f-137">**Figure 4**: le plan de site comprend désormais l’entrée du didacticiel sur les boutons personnalisés</span><span class="sxs-lookup"><span data-stu-id="0df8f-137">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>

## <a name="step-2-adding-a-formview-that-lists-the-suppliers"></a><span data-ttu-id="0df8f-138">Étape 2 : ajout d’un FormView qui répertorie les fournisseurs</span><span class="sxs-lookup"><span data-stu-id="0df8f-138">Step 2: Adding a FormView that Lists the Suppliers</span></span>

<span data-ttu-id="0df8f-139">Commençons par ce didacticiel en ajoutant le FormView qui répertorie les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="0df8f-139">Let s get started with this tutorial by adding the FormView that lists the suppliers.</span></span> <span data-ttu-id="0df8f-140">Comme nous l’avons vu dans l’introduction, ce FormView permettra à l’utilisateur de parcourir les fournisseurs, en présentant les produits fournis par le fournisseur dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-140">As discussed in the Introduction, this FormView will allow the user to page through the suppliers, showing the products provided by the supplier in a GridView.</span></span> <span data-ttu-id="0df8f-141">En outre, ce FormView inclut un bouton qui, lorsque vous cliquez dessus, marque tous les produits du fournisseur comme abandonnés.</span><span class="sxs-lookup"><span data-stu-id="0df8f-141">Additionally, this FormView will include a Button that, when clicked, will mark all of the supplier s products as discontinued.</span></span> <span data-ttu-id="0df8f-142">Avant de nous soucier de l’ajout du bouton personnalisé au FormView, n’hésitez pas à créer le FormView pour qu’il affiche les informations du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="0df8f-142">Before we concern ourselves with adding the custom button to the FormView, let s first just create the FormView so that it displays the supplier information.</span></span>

<span data-ttu-id="0df8f-143">Commencez par ouvrir la page `CustomButtons.aspx` dans le dossier `CustomButtons`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-143">Start by opening the `CustomButtons.aspx` page in the `CustomButtons` folder.</span></span> <span data-ttu-id="0df8f-144">Ajoutez un contrôle FormView à la page en le faisant glisser de la boîte à outils vers le concepteur et définissez sa propriété `ID` sur `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-144">Add a FormView to the page by dragging it from the Toolbox onto the Designer and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="0df8f-145">À partir de la balise active FormView s, choisissez de créer une nouvelle ObjectDataSource nommée `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-145">From the FormView s smart tag, opt to create a new ObjectDataSource named `SuppliersDataSource`.</span></span>

<span data-ttu-id="0df8f-146">[![créer un ObjectDataSource nommé SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-146">[![Create a New ObjectDataSource Named SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span></span>

<span data-ttu-id="0df8f-147">**Figure 5**: créer un ObjectDataSource nommé `SuppliersDataSource` ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-147">**Figure 5**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span></span>

<span data-ttu-id="0df8f-148">Configurez ce nouvel ObjectDataSource de manière à ce qu’il interroge à partir de la méthode de `GetSuppliers()` `SuppliersBLL` classe s (voir figure 6).</span><span class="sxs-lookup"><span data-stu-id="0df8f-148">Configure this new ObjectDataSource such that it queries from the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 6).</span></span> <span data-ttu-id="0df8f-149">Étant donné que ce FormView ne fournit pas d’interface pour la mise à jour des informations sur les fournisseurs, sélectionnez l’option (aucune) dans la liste déroulante de l’onglet mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="0df8f-149">Since this FormView does not provide an interface for updating the supplier information, select the (None) option from the drop-down list in the UPDATE tab.</span></span>

<span data-ttu-id="0df8f-150">[![configurer la source de données pour utiliser la méthode SuppliersBLL de la classe s GetSuppliers ()](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-150">[![Configure the Data Source to use the SuppliersBLL Class s GetSuppliers() Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span></span>

<span data-ttu-id="0df8f-151">**Figure 6**: configurer la source de données pour utiliser la méthode de `GetSuppliers()` de la classe `SuppliersBLL` ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-151">**Figure 6**: Configure the Data Source to use the `SuppliersBLL` Class s `GetSuppliers()` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span></span>

<span data-ttu-id="0df8f-152">Après la configuration de l’ObjectDataSource, Visual Studio génère un `InsertItemTemplate`, `EditItemTemplate`et `ItemTemplate` pour le FormView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-152">After configuring the ObjectDataSource, Visual Studio will generate an `InsertItemTemplate`, `EditItemTemplate`, and `ItemTemplate` for the FormView.</span></span> <span data-ttu-id="0df8f-153">Supprimez le `InsertItemTemplate` et `EditItemTemplate` et modifiez le `ItemTemplate` afin qu’il affiche uniquement le nom de la société et le numéro de téléphone du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="0df8f-153">Remove the `InsertItemTemplate` and `EditItemTemplate` and modify the `ItemTemplate` so that it displays just the supplier s company name and phone number.</span></span> <span data-ttu-id="0df8f-154">Enfin, activez la prise en charge de la pagination pour le contrôle FormView en activant la case à cocher Activer la pagination dans sa balise active (ou en affectant à sa propriété `AllowPaging` la valeur `True`).</span><span class="sxs-lookup"><span data-stu-id="0df8f-154">Finally, turn on paging support for the FormView by checking the Enable Paging checkbox from its smart tag (or by setting its `AllowPaging` property to `True`).</span></span> <span data-ttu-id="0df8f-155">Après ces modifications, le balisage déclaratif de votre page doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0df8f-155">After these changes your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample2.aspx)]

<span data-ttu-id="0df8f-156">La figure 7 illustre la page CustomButtons. aspx lorsque vous l’affichez dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="0df8f-156">Figure 7 shows the CustomButtons.aspx page when viewed through a browser.</span></span>

<span data-ttu-id="0df8f-157">[![le FormView répertorie les champs CompanyName et Phone du fournisseur actuellement sélectionné](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-157">[![The FormView Lists the CompanyName and Phone Fields from the Currently Selected Supplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span></span>

<span data-ttu-id="0df8f-158">**Figure 7**: le FormView répertorie les champs `CompanyName` et `Phone` du fournisseur actuellement sélectionné ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-158">**Figure 7**: The FormView Lists the `CompanyName` and `Phone` Fields from the Currently Selected Supplier ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span></span>

## <a name="step-3-adding-a-gridview-that-lists-the-selected-supplier-s-products"></a><span data-ttu-id="0df8f-159">Étape 3 : ajout d’un GridView qui répertorie les produits du fournisseur sélectionnés</span><span class="sxs-lookup"><span data-stu-id="0df8f-159">Step 3: Adding a GridView that Lists the Selected Supplier s Products</span></span>

<span data-ttu-id="0df8f-160">Avant d’ajouter le bouton arrêter tous les produits au modèle FormView, nous allons d’abord ajouter un contrôle GridView sous le contrôle FormView qui répertorie les produits fournis par le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="0df8f-160">Before we add the Discontinue All Products Button to the FormView s template, let s first add a GridView beneath the FormView that lists the products provided by the selected supplier.</span></span> <span data-ttu-id="0df8f-161">Pour ce faire, ajoutez un GridView à la page, affectez à sa propriété `ID` la valeur `SuppliersProducts`et ajoutez un nouvel ObjectDataSource nommé `SuppliersProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-161">To accomplish this, add a GridView to the page, set its `ID` property to `SuppliersProducts`, and add a new ObjectDataSource named `SuppliersProductsDataSource`.</span></span>

<span data-ttu-id="0df8f-162">[![créer un ObjectDataSource nommé SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-162">[![Create a New ObjectDataSource Named SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span></span>

<span data-ttu-id="0df8f-163">**Figure 8**: créer un ObjectDataSource nommé `SuppliersProductsDataSource` ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-163">**Figure 8**: Create a New ObjectDataSource Named `SuppliersProductsDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span></span>

<span data-ttu-id="0df8f-164">Configurez cet ObjectDataSource pour utiliser la méthode `GetProductsBySupplierID(supplierID)` de la classe ProductsBLL (voir figure 9).</span><span class="sxs-lookup"><span data-stu-id="0df8f-164">Configure this ObjectDataSource to use the ProductsBLL class s `GetProductsBySupplierID(supplierID)` method (see Figure 9).</span></span> <span data-ttu-id="0df8f-165">Bien que ce GridView autorise l’ajustement du prix d’un produit, il n’utilise pas les fonctionnalités intégrées de modification ou de suppression du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-165">While this GridView will allow for a product s price to be adjusted, it won't be using the built-in editing or deleting features from the GridView.</span></span> <span data-ttu-id="0df8f-166">Par conséquent, nous pouvons définir la liste déroulante sur (aucune) pour les onglets mettre à jour, insérer et supprimer ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="0df8f-166">Therefore, we can set the drop-down list to (None) for the ObjectDataSource s UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="0df8f-167">[![configurer la source de données pour utiliser la méthode ProductsBLL de la classe s GetProductsBySupplierID (RéfFournisseur)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-167">[![Configure the Data Source to use the ProductsBLL Class s GetProductsBySupplierID(supplierID) Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span></span>

<span data-ttu-id="0df8f-168">**Figure 9**: configurer la source de données pour utiliser la méthode de `GetProductsBySupplierID(supplierID)` de la classe `ProductsBLL` ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-168">**Figure 9**: Configure the Data Source to use the `ProductsBLL` Class s `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span></span>

<span data-ttu-id="0df8f-169">Étant donné que la méthode `GetProductsBySupplierID(supplierID)` accepte un paramètre d’entrée, l’Assistant ObjectDataSource nous invite à entrer la source de cette valeur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="0df8f-169">Since the `GetProductsBySupplierID(supplierID)` method accepts an input parameter, the ObjectDataSource wizard prompts us for the source of this parameter value.</span></span> <span data-ttu-id="0df8f-170">Pour transmettre la valeur `SupplierID` à partir du FormView, définissez la liste déroulante source du paramètre sur Control et la liste déroulante ControlID sur `Suppliers` (ID du FormView créé à l’étape 2).</span><span class="sxs-lookup"><span data-stu-id="0df8f-170">To pass in the `SupplierID` value from the FormView, set the Parameter source drop-down list to Control and the ControlID drop-down list to `Suppliers` (the ID of the FormView created in Step 2).</span></span>

<span data-ttu-id="0df8f-171">[![indiquer que le paramètre RéfFournisseur doit provenir du contrôle FormView Suppliers](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-171">[![Indicate that the supplierID Parameter Should Come from the Suppliers FormView Control](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span></span>

<span data-ttu-id="0df8f-172">**Figure 10**: indiquer que le paramètre *`supplierID`* doit provenir du contrôle FormView `Suppliers` ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-172">**Figure 10**: Indicate that the *`supplierID`* Parameter Should Come from the `Suppliers` FormView Control ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png))</span></span>

<span data-ttu-id="0df8f-173">Une fois l’exécution de l’Assistant ObjectDataSource terminée, le contrôle GridView contient un BoundField ou un CheckBoxField pour chacun des champs de données du produit.</span><span class="sxs-lookup"><span data-stu-id="0df8f-173">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product s data fields.</span></span> <span data-ttu-id="0df8f-174">N’hésitez pas à les découper pour afficher uniquement les `ProductName` et `UnitPrice` BoundFields, ainsi que le `Discontinued` CheckBoxField ; en outre, nous allons mettre en forme le `UnitPrice` BoundField de telle sorte que son texte est mis en forme en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="0df8f-174">Let s trim this down to show just the `ProductName` and `UnitPrice` BoundFields along with the `Discontinued` CheckBoxField; furthermore, let s format the `UnitPrice` BoundField such that its text is formatted as a currency.</span></span> <span data-ttu-id="0df8f-175">Vos balises déclaratives GridView et `SuppliersProductsDataSource` ObjectDataSource s doivent ressembler à la balise suivante :</span><span class="sxs-lookup"><span data-stu-id="0df8f-175">Your GridView and `SuppliersProductsDataSource` ObjectDataSource s declarative markup should look similar to the following markup:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample3.aspx)]

<span data-ttu-id="0df8f-176">À ce stade, notre didacticiel affiche un rapport maître/détails qui permet à l’utilisateur de choisir un fournisseur à partir du contrôle FormView en haut et d’afficher les produits fournis par ce fournisseur par le biais du contrôle GridView situé en bas.</span><span class="sxs-lookup"><span data-stu-id="0df8f-176">At this point our tutorial displays a master/details report, allowing the user to pick a supplier from the FormView at the top and to view the products provided by that supplier through the GridView at the bottom.</span></span> <span data-ttu-id="0df8f-177">La figure 11 illustre une capture d’écran de cette page lors de la sélection du fournisseur Tokyo traders à partir du FormView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-177">Figure 11 shows a screen shot of this page when selecting the Tokyo Traders supplier from the FormView.</span></span>

<span data-ttu-id="0df8f-178">[![les produits des fournisseurs sélectionnés s’affichent dans le contrôle GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-178">[![The Selected Supplier s Products are Displayed in the GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span></span>

<span data-ttu-id="0df8f-179">**Figure 11**: les produits du fournisseur sélectionné s’affichent dans le GridView ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-179">**Figure 11**: The Selected Supplier s Products are Displayed in the GridView ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span></span>

## <a name="step-4-creating-dal-and-bll-methods-to-discontinue-all-products-for-a-supplier"></a><span data-ttu-id="0df8f-180">Étape 4 : création de méthodes DAL et BLL pour interrompre tous les produits d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="0df8f-180">Step 4: Creating DAL and BLL Methods to Discontinue All Products for a Supplier</span></span>

<span data-ttu-id="0df8f-181">Avant de pouvoir ajouter un bouton au FormView qui, lorsque vous cliquez dessus, interrompt tous les produits du fournisseur, nous devons d’abord ajouter une méthode à la couche DAL et à la couche BLL qui effectue cette action.</span><span class="sxs-lookup"><span data-stu-id="0df8f-181">Before we can add a Button to the FormView that, when clicked, discontinues all of the supplier s products, we first need to add a method to both the DAL and BLL that performs this action.</span></span> <span data-ttu-id="0df8f-182">En particulier, cette méthode sera nommée `DiscontinueAllProductsForSupplier(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-182">In particular, this method will be named `DiscontinueAllProductsForSupplier(supplierID)`.</span></span> <span data-ttu-id="0df8f-183">Quand l’utilisateur clique sur le bouton FormView s, nous appellerons cette méthode dans la couche de logique métier, en transmettant le `SupplierID`du fournisseur sélectionné ; la couche BLL appellera ensuite la méthode de la couche d’accès aux données correspondante, qui émettra une instruction `UPDATE` à la base de données qui interrompt les produits du fournisseur spécifiés.</span><span class="sxs-lookup"><span data-stu-id="0df8f-183">When the FormView s Button is clicked, we'll invoke this method in the Business Logic Layer, passing in the selected supplier s `SupplierID`; the BLL will then call down to the corresponding Data Access Layer method, which will issue an `UPDATE` statement to the database that discontinues the specified supplier s products.</span></span>

<span data-ttu-id="0df8f-184">Comme nous l’avons fait dans nos didacticiels précédents, nous allons utiliser une approche ascendante, en commençant par créer la méthode DAL, puis la méthode BLL et enfin en implémentant les fonctionnalités dans la page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0df8f-184">As we have done in our previous tutorials, we'll use a bottom-up approach, starting with creating the DAL method, then the BLL method, and finally implementing the functionality in the ASP.NET page.</span></span> <span data-ttu-id="0df8f-185">Ouvrez le `Northwind.xsd` DataSet typé dans le dossier `App_Code/DAL` et ajoutez une nouvelle méthode au `ProductsTableAdapter` (cliquez avec le bouton droit sur le `ProductsTableAdapter`, puis choisissez Ajouter une requête).</span><span class="sxs-lookup"><span data-stu-id="0df8f-185">Open the `Northwind.xsd` Typed DataSet in the `App_Code/DAL` folder and add a new method to the `ProductsTableAdapter` (right-click on the `ProductsTableAdapter` and choose Add Query).</span></span> <span data-ttu-id="0df8f-186">Cela entraînera l’ajout de l’Assistant Configuration de requêtes TableAdapter, qui nous guide tout au long du processus d’ajout de la nouvelle méthode.</span><span class="sxs-lookup"><span data-stu-id="0df8f-186">Doing so will bring up the TableAdapter Query Configuration wizard, which walks us through the process of adding the new method.</span></span> <span data-ttu-id="0df8f-187">Commencez par indiquer que notre méthode DAL utilisera une instruction SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="0df8f-187">Start by indicating that our DAL method will use an ad-hoc SQL statement.</span></span>

<span data-ttu-id="0df8f-188">[![créer la méthode DAL à l’aide d’une instruction SQL ad hoc](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-188">[![Create the DAL Method Using an Ad-Hoc SQL Statement](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span></span>

<span data-ttu-id="0df8f-189">**Figure 12**: créer la méthode dal à l’aide d’une instruction SQL ad hoc ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-189">**Figure 12**: Create the DAL Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span></span>

<span data-ttu-id="0df8f-190">Ensuite, l’Assistant nous invite à spécifier le type de requête à créer.</span><span class="sxs-lookup"><span data-stu-id="0df8f-190">Next, the wizard prompts us as to what type of query to create.</span></span> <span data-ttu-id="0df8f-191">Dans la mesure où la méthode `DiscontinueAllProductsForSupplier(supplierID)` doit mettre à jour la table de base de données `Products`, en affectant la valeur 1 au champ `Discontinued` pour tous les produits fournis par le *`supplierID`* spécifié, nous devons créer une requête qui met à jour les données.</span><span class="sxs-lookup"><span data-stu-id="0df8f-191">Since the `DiscontinueAllProductsForSupplier(supplierID)` method will need to update the `Products` database table, setting the `Discontinued` field to 1 for all products provided by the specified *`supplierID`*, we need to create a query that updates data.</span></span>

<span data-ttu-id="0df8f-192">[![choisir le type de requête de mise à jour](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-192">[![Choose the UPDATE Query Type](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span></span>

<span data-ttu-id="0df8f-193">**Figure 13**: choisir le type de requête de mise à jour ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-193">**Figure 13**: Choose the UPDATE Query Type ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span></span>

<span data-ttu-id="0df8f-194">L’écran suivant de l’Assistant fournit l’instruction `UPDATE` du TableAdapter existante, qui met à jour chacun des champs définis dans le DataTable `Products`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-194">The next wizard screen provides the TableAdapter s existing `UPDATE` statement, which updates each of the fields defined in the `Products` DataTable.</span></span> <span data-ttu-id="0df8f-195">Remplacez le texte de cette requête par l’instruction suivante :</span><span class="sxs-lookup"><span data-stu-id="0df8f-195">Replace this query text with the following statement:</span></span>

[!code-sql[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample4.sql)]

<span data-ttu-id="0df8f-196">Après avoir entré cette requête et cliqué sur suivant, le dernier écran de l’Assistant vous demande le nom de la nouvelle méthode use `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-196">After entering this query and clicking Next, the last wizard screen asks for the new method s name use `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="0df8f-197">Terminez l’Assistant en cliquant sur le bouton Terminer.</span><span class="sxs-lookup"><span data-stu-id="0df8f-197">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="0df8f-198">Lors du retour au concepteur de DataSet, vous devez voir une nouvelle méthode dans la `ProductsTableAdapter` nommée `DiscontinueAllProductsForSupplier(@SupplierID)`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-198">Upon returning to the DataSet Designer you should see a new method in the `ProductsTableAdapter` named `DiscontinueAllProductsForSupplier(@SupplierID)`.</span></span>

<span data-ttu-id="0df8f-199">[![nommez la nouvelle méthode DAL DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-199">[![Name the New DAL Method DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span></span>

<span data-ttu-id="0df8f-200">**Figure 14**: nommer la nouvelle méthode dal `DiscontinueAllProductsForSupplier` ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-200">**Figure 14**: Name the New DAL Method `DiscontinueAllProductsForSupplier` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span></span>

<span data-ttu-id="0df8f-201">Avec la méthode `DiscontinueAllProductsForSupplier(supplierID)` créée dans la couche d’accès aux données, la tâche suivante consiste à créer la méthode `DiscontinueAllProductsForSupplier(supplierID)` dans la couche de logique métier.</span><span class="sxs-lookup"><span data-stu-id="0df8f-201">With the `DiscontinueAllProductsForSupplier(supplierID)` method created in the Data Access Layer, our next task is to create the `DiscontinueAllProductsForSupplier(supplierID)` method in the Business Logic Layer.</span></span> <span data-ttu-id="0df8f-202">Pour ce faire, ouvrez le fichier de classe `ProductsBLL` et ajoutez ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0df8f-202">To accomplish this, open the `ProductsBLL` class file and add the following:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample5.vb)]

<span data-ttu-id="0df8f-203">Cette méthode appelle simplement la méthode `DiscontinueAllProductsForSupplier(supplierID)` dans la couche DAL, en passant la valeur de paramètre *`supplierID`* fournie.</span><span class="sxs-lookup"><span data-stu-id="0df8f-203">This method simply calls down to the `DiscontinueAllProductsForSupplier(supplierID)` method in the DAL, passing along the provided *`supplierID`* parameter value.</span></span> <span data-ttu-id="0df8f-204">S’il existe des règles d’entreprise qui permettaient uniquement la fin de la mise en œuvre des produits d’un fournisseur dans certaines circonstances, ces règles doivent être implémentées ici, dans la couche BLL.</span><span class="sxs-lookup"><span data-stu-id="0df8f-204">If there were any business rules that only allowed a supplier s products to be discontinued under certain circumstances, those rules should be implemented here, in the BLL.</span></span>

> [!NOTE]
> <span data-ttu-id="0df8f-205">Contrairement à la `UpdateProduct` surcharges de la classe `ProductsBLL`, la signature de la méthode `DiscontinueAllProductsForSupplier(supplierID)` n’inclut pas l’attribut `DataObjectMethodAttribute` (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span><span class="sxs-lookup"><span data-stu-id="0df8f-205">Unlike the `UpdateProduct` overloads in the `ProductsBLL` class, the `DiscontinueAllProductsForSupplier(supplierID)` method signature does not include the `DataObjectMethodAttribute` attribute (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span></span> <span data-ttu-id="0df8f-206">Cela exclut la méthode `DiscontinueAllProductsForSupplier(supplierID)` de la liste déroulante de l’Assistant de configuration de la source de données ObjectDataSource s dans l’onglet mettre à jour. J’ai omis cet attribut, car nous appellerons directement la méthode `DiscontinueAllProductsForSupplier(supplierID)` à partir d’un gestionnaire d’événements dans notre page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0df8f-206">This precludes the `DiscontinueAllProductsForSupplier(supplierID)` method from the ObjectDataSource s Configure Data Source wizard s drop-down list in the UPDATE tab. I ve omitted this attribute because we'll be calling the `DiscontinueAllProductsForSupplier(supplierID)` method directly from an event handler in our ASP.NET page.</span></span>

## <a name="step-5-adding-a-discontinue-all-products-button-to-the-formview"></a><span data-ttu-id="0df8f-207">Étape 5 : ajout d’un bouton arrêter tous les produits au FormView</span><span class="sxs-lookup"><span data-stu-id="0df8f-207">Step 5: Adding a Discontinue All Products Button to the FormView</span></span>

<span data-ttu-id="0df8f-208">Une fois la méthode `DiscontinueAllProductsForSupplier(supplierID)` dans la couche BLL et la couche DAL terminées, la dernière étape pour ajouter la possibilité d’interrompre tous les produits pour le fournisseur sélectionné consiste à ajouter un contrôle Web Button à la `ItemTemplate`FormView s.</span><span class="sxs-lookup"><span data-stu-id="0df8f-208">With the `DiscontinueAllProductsForSupplier(supplierID)` method in the BLL and DAL complete, the final step for adding the ability to discontinue all products for the selected supplier is to add a Button Web control to the FormView s `ItemTemplate`.</span></span> <span data-ttu-id="0df8f-209">Ajoutez un bouton de ce type sous le numéro de téléphone du fournisseur avec le texte du bouton, discontinue tous les produits et une valeur de propriété de `ID` de `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-209">Let s add such a Button below the supplier s phone number with the button text, Discontinue All Products and an `ID` property value of `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="0df8f-210">Vous pouvez ajouter ce contrôle Web de bouton par le biais du concepteur en cliquant sur le lien modifier les modèles dans la balise active FormView s (voir figure 15) ou directement à l’aide de la syntaxe déclarative.</span><span class="sxs-lookup"><span data-stu-id="0df8f-210">You can add this Button Web control through the Designer by clicking on the Edit Templates link in the FormView s smart tag (see Figure 15), or directly through the declarative syntax.</span></span>

<span data-ttu-id="0df8f-211">[![ajouter un bouton arrêter tous les produits sur le contrôle Web de la vue ItemTemplate s](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-211">[![Add a Discontinue All Products Button Web Control to the FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span></span>

<span data-ttu-id="0df8f-212">**Figure 15**: ajouter un bouton de commande arrêter tous les produits à la `ItemTemplate` de la vue FormView ([cliquez pour afficher l’image en plein écran](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-212">**Figure 15**: Add a Discontinue All Products Button Web Control to the FormView s `ItemTemplate` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span></span>

<span data-ttu-id="0df8f-213">Lorsque vous cliquez sur le bouton d’un utilisateur visitant la page, une publication est déclenchée et l' [événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) FormView s`ItemCommand` se déclenche.</span><span class="sxs-lookup"><span data-stu-id="0df8f-213">When the Button is clicked by a user visiting the page, a postback ensues and the FormView s [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) fires.</span></span> <span data-ttu-id="0df8f-214">Pour exécuter du code personnalisé en réponse à un clic sur ce bouton, nous pouvons créer un gestionnaire d’événements pour cet événement.</span><span class="sxs-lookup"><span data-stu-id="0df8f-214">To execute custom code in response to this Button being clicked, we can create an event handler for this event.</span></span> <span data-ttu-id="0df8f-215">Sachez cependant que l’événement `ItemCommand` se déclenche chaque fois que vous cliquez sur un bouton, un LinkButton ou *un* contrôle Web ImageButton dans le FormView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-215">Understand, though, that the `ItemCommand` event fires whenever *any* Button, LinkButton, or ImageButton Web control is clicked within the FormView.</span></span> <span data-ttu-id="0df8f-216">Cela signifie que lorsque l’utilisateur passe d’une page à une autre dans le FormView, l’événement `ItemCommand` se déclenche ; même chose quand l’utilisateur clique sur nouveau, modifier ou supprimer dans un FormView qui prend en charge l’insertion, la mise à jour ou la suppression.</span><span class="sxs-lookup"><span data-stu-id="0df8f-216">That means that when the user moves from one page to another in the FormView, the `ItemCommand` event fires; same thing when the user clicks New, Edit, or Delete in a FormView that supports inserting, updating, or deleting.</span></span>

<span data-ttu-id="0df8f-217">Étant donné que le `ItemCommand` se déclenche indépendamment du bouton sur lequel l’utilisateur clique, dans le gestionnaire d’événements, nous avons besoin d’un moyen de déterminer si l’utilisateur a cliqué sur le bouton arrêter tous les produits ou s’il s’agit d’un autre bouton.</span><span class="sxs-lookup"><span data-stu-id="0df8f-217">Since the `ItemCommand` fires regardless of what button is clicked, in the event handler we need a way to determine if the Discontinue All Products Button was clicked or if it was some other button.</span></span> <span data-ttu-id="0df8f-218">Pour ce faire, nous pouvons définir la propriété Button Web Control s `CommandName` sur une valeur d’identification.</span><span class="sxs-lookup"><span data-stu-id="0df8f-218">To accomplish this, we can set the Button Web control s `CommandName` property to some identifying value.</span></span> <span data-ttu-id="0df8f-219">Lorsque l’utilisateur clique sur le bouton, cette `CommandName` valeur est transmise dans le gestionnaire d’événements `ItemCommand`, ce qui nous permet de déterminer si l’utilisateur a cliqué sur le bouton arrêter tous les produits.</span><span class="sxs-lookup"><span data-stu-id="0df8f-219">When the Button is clicked, this `CommandName` value is passed into the `ItemCommand` event handler, enabling us to determine whether the Discontinue All Products Button was the button clicked.</span></span> <span data-ttu-id="0df8f-220">Définissez le bouton discontinue All Products s `CommandName` la propriété sur DiscontinueProducts.</span><span class="sxs-lookup"><span data-stu-id="0df8f-220">Set the Discontinue All Products Button s `CommandName` property to DiscontinueProducts .</span></span>

<span data-ttu-id="0df8f-221">Enfin, utilisez une boîte de dialogue de confirmation côté client pour vous assurer que l’utilisateur souhaite vraiment arrêter les produits du fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="0df8f-221">Finally, let s use a client-side confirm dialog box to ensure that the user really wants to discontinue the selected supplier s products.</span></span> <span data-ttu-id="0df8f-222">Comme nous l’avons vu dans la confirmation de l' [Ajout côté client lors](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) de la suppression du didacticiel, cela peut être accompli avec un peu de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="0df8f-222">As we saw in the [Adding Client-Side Confirmation When Deleting](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) tutorial, this can be accomplished with a bit of JavaScript.</span></span> <span data-ttu-id="0df8f-223">En particulier, affectez à la propriété Button Web Control s OnClientClick la valeur `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span><span class="sxs-lookup"><span data-stu-id="0df8f-223">In particular, set the Button Web control s OnClientClick property to `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span></span>

<span data-ttu-id="0df8f-224">Une fois ces modifications apportées, la syntaxe déclarative de FormView s doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0df8f-224">After making these changes, the FormView s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample6.aspx)]

<span data-ttu-id="0df8f-225">Ensuite, créez un gestionnaire d’événements pour l’événement FormView s `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-225">Next, create an event handler for the FormView s `ItemCommand` event.</span></span> <span data-ttu-id="0df8f-226">Dans ce gestionnaire d’événements, nous devons d’abord déterminer si l’utilisateur a cliqué sur le bouton discontinue All Products.</span><span class="sxs-lookup"><span data-stu-id="0df8f-226">In this event handler we need to first determine whether the Discontinue All Products Button was clicked.</span></span> <span data-ttu-id="0df8f-227">Si c’est le cas, nous souhaitons créer une instance de la classe `ProductsBLL` et appeler sa méthode `DiscontinueAllProductsForSupplier(supplierID)`, en passant la `SupplierID` du FormView sélectionné :</span><span class="sxs-lookup"><span data-stu-id="0df8f-227">If so, we want to create an instance of the `ProductsBLL` class and invoke its `DiscontinueAllProductsForSupplier(supplierID)` method, passing in the `SupplierID` of the selected FormView:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample7.vb)]

<span data-ttu-id="0df8f-228">Notez que le `SupplierID` du fournisseur actuellement sélectionné dans le FormView est accessible à l’aide de la propriété FormView s [`SelectedValue`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span><span class="sxs-lookup"><span data-stu-id="0df8f-228">Note that the `SupplierID` of the current selected supplier in the FormView can be accessed using the FormView s [`SelectedValue` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span></span> <span data-ttu-id="0df8f-229">La propriété `SelectedValue` retourne la première valeur de clé de données pour l’enregistrement affiché dans le FormView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-229">The `SelectedValue` property returns the first data key value for the record being displayed in the FormView.</span></span> <span data-ttu-id="0df8f-230">La propriété FormView s [`DataKeyNames`](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), qui indique les champs de données à partir desquels les valeurs de clés de données sont extraites, a été automatiquement définie sur `SupplierID` par Visual Studio lors de la liaison de ObjectDataSource au FormView à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="0df8f-230">The FormView s [`DataKeyNames` property](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), which indicates the data fields from which the data key values are pulled from, was automatically set to `SupplierID` by Visual Studio when binding the ObjectDataSource to the FormView back in Step 2.</span></span>

<span data-ttu-id="0df8f-231">Une fois le gestionnaire d’événements `ItemCommand` créé, prenez un moment pour tester la page.</span><span class="sxs-lookup"><span data-stu-id="0df8f-231">With the `ItemCommand` event handler created, take a moment to test out the page.</span></span> <span data-ttu-id="0df8f-232">Accédez au fournisseur Cooperativa de quesos « las Cabras » (il s’agit du cinquième fournisseur du FormView pour moi).</span><span class="sxs-lookup"><span data-stu-id="0df8f-232">Browse to the Cooperativa de Quesos 'Las Cabras' supplier (it s the fifth supplier in the FormView for me).</span></span> <span data-ttu-id="0df8f-233">Ce fournisseur fournit deux produits, Queso Cabrales et queso Manchego la Pastora, qui ne sont *pas* encore abandonnés.</span><span class="sxs-lookup"><span data-stu-id="0df8f-233">This supplier provides two products, Queso Cabrales and Queso Manchego La Pastora, both of which are *not* discontinued.</span></span>

<span data-ttu-id="0df8f-234">Imaginez que Cooperativa de quesos « las Cabras » n’est plus opérationnel et, par conséquent, ses produits ne seront plus disponibles.</span><span class="sxs-lookup"><span data-stu-id="0df8f-234">Imagine that Cooperativa de Quesos 'Las Cabras' has gone out of business and therefore its products are to be discontinued.</span></span> <span data-ttu-id="0df8f-235">Cliquez sur le bouton arrêter tous les produits.</span><span class="sxs-lookup"><span data-stu-id="0df8f-235">Click the Discontinue All Products Button.</span></span> <span data-ttu-id="0df8f-236">La boîte de dialogue confirmer côté client s’affiche (voir figure 16).</span><span class="sxs-lookup"><span data-stu-id="0df8f-236">This will display the client-side confirm dialog box (see Figure 16).</span></span>

<span data-ttu-id="0df8f-237">[![Cooperativa de quesos las Cabras fournit deux produits actifs](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-237">[![Cooperativa de Quesos Las Cabras Supplies Two Active Products](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span></span>

<span data-ttu-id="0df8f-238">**Figure 16**: Cooperativa de quesos las Cabras fournit deux produits actifs ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-238">**Figure 16**: Cooperativa de Quesos Las Cabras Supplies Two Active Products ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span></span>

<span data-ttu-id="0df8f-239">Si vous cliquez sur OK dans la boîte de dialogue confirmer côté client, l’envoi du formulaire se poursuit, provoquant une publication dans laquelle l’événement FormView s `ItemCommand` se déclenchera.</span><span class="sxs-lookup"><span data-stu-id="0df8f-239">If you click OK in the client-side confirm dialog box, the form submission will proceed, causing a postback in which the FormView s `ItemCommand` event will fire.</span></span> <span data-ttu-id="0df8f-240">Le gestionnaire d’événements que nous avons créé exécute ensuite, en appelant la méthode `DiscontinueAllProductsForSupplier(supplierID)` et en arrêtant à la fois les produits Queso Cabrales et queso Manchego la Pastora.</span><span class="sxs-lookup"><span data-stu-id="0df8f-240">The event handler we created will then execute, invoking the `DiscontinueAllProductsForSupplier(supplierID)` method and discontinuing both the Queso Cabrales and Queso Manchego La Pastora products.</span></span>

<span data-ttu-id="0df8f-241">Si vous avez désactivé l’état d’affichage de GridView s, le GridView est relié à la Banque de données sous-jacente à chaque publication (postback) et, par conséquent, est immédiatement mis à jour pour refléter le fait que ces deux produits sont désormais abandonnés (voir figure 17).</span><span class="sxs-lookup"><span data-stu-id="0df8f-241">If you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect that these two products are now discontinued (see Figure 17).</span></span> <span data-ttu-id="0df8f-242">Toutefois, si vous n’avez pas désactivé l’état d’affichage dans le GridView, vous devrez lier manuellement les données au GridView après avoir apporté cette modification.</span><span class="sxs-lookup"><span data-stu-id="0df8f-242">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="0df8f-243">Pour ce faire, effectuez simplement un appel à la méthode GridView s `DataBind()` immédiatement après l’appel de la méthode `DiscontinueAllProductsForSupplier(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-243">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `DiscontinueAllProductsForSupplier(supplierID)` method.</span></span>

<span data-ttu-id="0df8f-244">[![après avoir cliqué sur le bouton arrêter tous les produits, les produits du fournisseur sont mis à jour en conséquence.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-244">[![After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span></span>

<span data-ttu-id="0df8f-245">**Figure 17**: après avoir cliqué sur le bouton arrêter tous les produits, les produits du fournisseur sont mis à jour en conséquence ([cliquez pour afficher l’image en plein écran](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-245">**Figure 17**: After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span></span>

## <a name="step-6-creating-an-updateproduct-overload-in-the-business-logic-layer-for-adjusting-a-product-s-price"></a><span data-ttu-id="0df8f-246">Étape 6 : création d’une surcharge UpdateProduct dans la couche de logique métier pour ajuster le prix d’un produit</span><span class="sxs-lookup"><span data-stu-id="0df8f-246">Step 6: Creating an UpdateProduct Overload in the Business Logic Layer for Adjusting a Product s Price</span></span>

<span data-ttu-id="0df8f-247">Comme avec le bouton arrêter tous les produits dans le contrôle FormView, afin d’ajouter des boutons permettant d’augmenter et de réduire le prix d’un produit dans le contrôle GridView, nous devons d’abord ajouter la couche d’accès aux données et les méthodes de couche logique métier appropriées.</span><span class="sxs-lookup"><span data-stu-id="0df8f-247">Like with the Discontinue All Products Button in the FormView, in order to add buttons for increasing and decreasing the price for a product in the GridView we need to first add the appropriate Data Access Layer and Business Logic Layer methods.</span></span> <span data-ttu-id="0df8f-248">Étant donné que nous avons déjà une méthode qui met à jour une ligne de produit unique dans la couche DAL, nous pouvons fournir une telle fonctionnalité en créant une nouvelle surcharge pour la méthode `UpdateProduct` dans la couche BLL.</span><span class="sxs-lookup"><span data-stu-id="0df8f-248">Since we already have a method that updates a single product row in the DAL, we can provide such functionality by creating a new overload for the `UpdateProduct` method in the BLL.</span></span>

<span data-ttu-id="0df8f-249">Les surcharges précédentes de `UpdateProduct` ont été prises dans une combinaison de champs de produit comme valeurs d’entrée scalaires et ont ensuite mis à jour uniquement ces champs pour le produit spécifié.</span><span class="sxs-lookup"><span data-stu-id="0df8f-249">Our past `UpdateProduct` overloads have taken in some combination of product fields as scalar input values and have then updated just those fields for the specified product.</span></span> <span data-ttu-id="0df8f-250">Pour cette surcharge, nous allons varier légèrement de cette norme et transmettre à la place le `ProductID` du produit et le pourcentage d’ajustement de la `UnitPrice` (par opposition au passage du nouveau `UnitPrice`, ajusté).</span><span class="sxs-lookup"><span data-stu-id="0df8f-250">For this overload we'll vary slightly from this standard and instead pass in the product s `ProductID` and the percentage by which to adjust the `UnitPrice` (as opposed to passing in the new, adjusted `UnitPrice` itself).</span></span> <span data-ttu-id="0df8f-251">Cette approche simplifie le code dont nous avons besoin pour écrire dans la classe code-behind de la page ASP.NET, car nous n’avons pas à vous soucier de la détermination du `UnitPrice`du produit actuel.</span><span class="sxs-lookup"><span data-stu-id="0df8f-251">This approach will simplify the code we need to write in the ASP.NET page code-behind class, since we don t have to bother with determining the current product s `UnitPrice`.</span></span>

<span data-ttu-id="0df8f-252">La surcharge `UpdateProduct` pour ce didacticiel est illustrée ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="0df8f-252">The `UpdateProduct` overload for this tutorial is shown below:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample8.vb)]

<span data-ttu-id="0df8f-253">Cette surcharge récupère des informations sur le produit spécifié par le biais de la méthode de `GetProductByProductID(productID)` DAL s.</span><span class="sxs-lookup"><span data-stu-id="0df8f-253">This overload retrieves information about the specified product through the DAL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="0df8f-254">Il vérifie ensuite si une valeur de `NULL` de base de données est affectée au `UnitPrice` du produit.</span><span class="sxs-lookup"><span data-stu-id="0df8f-254">It then checks to see whether the product s `UnitPrice` is assigned a database `NULL` value.</span></span> <span data-ttu-id="0df8f-255">Si c’est le cas, le prix reste inchangé.</span><span class="sxs-lookup"><span data-stu-id="0df8f-255">If it is, the price is left unaltered.</span></span> <span data-ttu-id="0df8f-256">Toutefois, si la valeur de `UnitPrice` n’est pas`NULL`, la méthode met à jour le `UnitPrice` du produit par le pourcentage spécifié (`unitPriceAdjustmentPercent`).</span><span class="sxs-lookup"><span data-stu-id="0df8f-256">If, however, there is a non-`NULL` `UnitPrice` value, the method updates the product s `UnitPrice` by the specified percent (`unitPriceAdjustmentPercent`).</span></span>

## <a name="step-7-adding-the-increase-and-decrease-buttons-to-the-gridview"></a><span data-ttu-id="0df8f-257">Étape 7 : ajout des boutons d’augmentation et de réduction au contrôle GridView</span><span class="sxs-lookup"><span data-stu-id="0df8f-257">Step 7: Adding the Increase and Decrease Buttons to the GridView</span></span>

<span data-ttu-id="0df8f-258">Le contrôle GridView (et DetailsView) est constitué d’une collection de champs.</span><span class="sxs-lookup"><span data-stu-id="0df8f-258">The GridView (and DetailsView) are both made up of a collection of fields.</span></span> <span data-ttu-id="0df8f-259">En plus de BoundFields, CheckBoxFields et TemplateFields, ASP.NET comprend le ButtonField, qui, comme son nom l’indique, est rendu sous la forme d’une colonne avec un bouton, LinkButton ou ImageButton pour chaque ligne.</span><span class="sxs-lookup"><span data-stu-id="0df8f-259">In addition to BoundFields, CheckBoxFields, and TemplateFields, ASP.NET includes the ButtonField, which, as its name implies, renders as a column with a Button, LinkButton, or ImageButton for each row.</span></span> <span data-ttu-id="0df8f-260">Semblable au FormView, le fait de cliquer sur *un* bouton dans les boutons de pagination de GridView, les boutons modifier ou supprimer, les boutons de tri, etc. entraîne une publication et déclenche l' [événement`RowCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)GridView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-260">Similar to the FormView, clicking *any* button within the GridView paging buttons, Edit or Delete buttons, sorting buttons, and so on causes a postback and raises the GridView s [`RowCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span></span>

<span data-ttu-id="0df8f-261">ButtonField a une propriété `CommandName` qui affecte la valeur spécifiée à chacun de ses boutons `CommandName` propriétés.</span><span class="sxs-lookup"><span data-stu-id="0df8f-261">The ButtonField has a `CommandName` property that assigns the specified value to each of its Buttons `CommandName` properties.</span></span> <span data-ttu-id="0df8f-262">Comme avec le FormView, la valeur `CommandName` est utilisée par le gestionnaire d’événements `RowCommand` pour déterminer le bouton sur lequel l’utilisateur a cliqué.</span><span class="sxs-lookup"><span data-stu-id="0df8f-262">Like with the FormView, the `CommandName` value is used by the `RowCommand` event handler to determine which button was clicked.</span></span>

<span data-ttu-id="0df8f-263">Ajoutez deux nouveaux ButtonFields au contrôle GridView, l’un avec un prix texte de bouton + 10% et l’autre avec le texte Price-10%.</span><span class="sxs-lookup"><span data-stu-id="0df8f-263">Let s add two new ButtonFields to the GridView, one with a button text Price +10% and the other with the text Price -10%.</span></span> <span data-ttu-id="0df8f-264">Pour ajouter ces ButtonFields, cliquez sur le lien modifier les colonnes dans la balise active GridView s, sélectionnez le type de champ ButtonField dans la liste en haut à gauche, puis cliquez sur le bouton Ajouter.</span><span class="sxs-lookup"><span data-stu-id="0df8f-264">To add these ButtonFields, click on the Edit Columns link from the GridView s smart tag, select the ButtonField field type from the list in the upper left and click the Add button.</span></span>

![Ajouter deux ButtonFields au GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image48.png)

<span data-ttu-id="0df8f-266">**Figure 18**: ajouter deux ButtonFields au GridView</span><span class="sxs-lookup"><span data-stu-id="0df8f-266">**Figure 18**: Add Two ButtonFields to the GridView</span></span>

<span data-ttu-id="0df8f-267">Déplacez les deux ButtonFields afin qu’ils apparaissent comme les deux premiers champs GridView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-267">Move the two ButtonFields so that they appear as the first two GridView fields.</span></span> <span data-ttu-id="0df8f-268">Ensuite, définissez les propriétés de `Text` de ces deux ButtonFields sur Price + 10% et Price-10% et les propriétés `CommandName` sur IncreasePrice et DecreasePrice, respectivement.</span><span class="sxs-lookup"><span data-stu-id="0df8f-268">Next, set the `Text` properties of these two ButtonFields to Price +10% and Price -10% and the `CommandName` properties to IncreasePrice and DecreasePrice, respectively.</span></span> <span data-ttu-id="0df8f-269">Par défaut, un ButtonField affiche sa colonne de boutons en tant que LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="0df8f-269">By default, a ButtonField renders its column of buttons as LinkButtons.</span></span> <span data-ttu-id="0df8f-270">Cela peut toutefois être modifié par le biais de la propriété ButtonField s [`ButtonType`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span><span class="sxs-lookup"><span data-stu-id="0df8f-270">This can be changed, however, through the ButtonField s [`ButtonType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span></span> <span data-ttu-id="0df8f-271">Faites en sorte que ces deux ButtonFields soient rendues comme des boutons de commande standard ; par conséquent, affectez à la propriété `ButtonType` la valeur `Button`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-271">Let s have these two ButtonFields rendered as regular push buttons; therefore, set the `ButtonType` property to `Button`.</span></span> <span data-ttu-id="0df8f-272">La figure 19 affiche la boîte de dialogue champs après que ces modifications ont été apportées. Voici le balisage déclaratif s de GridView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-272">Figure 19 shows the Fields dialog box after these changes have been made; following that is the GridView s declarative markup.</span></span>

![Configurer les propriétés Text, CommandName et ButtonType de ButtonFields](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image49.png)

<span data-ttu-id="0df8f-274">**Figure 19**: configurer les propriétés ButtonFields `Text`, `CommandName`et `ButtonType`</span><span class="sxs-lookup"><span data-stu-id="0df8f-274">**Figure 19**: Configure the ButtonFields `Text`, `CommandName`, and `ButtonType` Properties</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample9.aspx)]

<span data-ttu-id="0df8f-275">Une fois ces ButtonFields créés, la dernière étape consiste à créer un gestionnaire d’événements pour l’événement `RowCommand` GridView s.</span><span class="sxs-lookup"><span data-stu-id="0df8f-275">With these ButtonFields created, the final step is to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="0df8f-276">Ce gestionnaire d’événements, s’il est déclenché parce que les boutons Price + 10% ou Price-10% ont fait l’objet d’un clic, doit déterminer la `ProductID` de la ligne dont le bouton a été cliqué, puis appeler la méthode `ProductsBLL` classe s `UpdateProduct`, en passant l’ajustement de pourcentage de `UnitPrice` approprié avec la `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-276">This event handler, if fired because either the Price +10% or Price -10% buttons were clicked, needs to determine the `ProductID` for the row whose button was clicked and then invoke the `ProductsBLL` class s `UpdateProduct` method, passing in the appropriate `UnitPrice` percentage adjustment along with the `ProductID`.</span></span> <span data-ttu-id="0df8f-277">Le code suivant effectue ces tâches :</span><span class="sxs-lookup"><span data-stu-id="0df8f-277">The following code performs these tasks:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample10.vb)]

<span data-ttu-id="0df8f-278">Pour déterminer la `ProductID` pour la ligne sur laquelle l’utilisateur a cliqué sur le prix + 10% ou le bouton Price-10%, nous devons consulter la collection de `DataKeys` GridView s.</span><span class="sxs-lookup"><span data-stu-id="0df8f-278">In order to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we need to consult the GridView s `DataKeys` collection.</span></span> <span data-ttu-id="0df8f-279">Cette collection contient les valeurs des champs spécifiés dans la propriété `DataKeyNames` pour chaque ligne GridView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-279">This collection holds the values of the fields specified in the `DataKeyNames` property for each GridView row.</span></span> <span data-ttu-id="0df8f-280">Dans la mesure où la propriété GridView s `DataKeyNames` a été définie sur ProductID par Visual Studio lors de la liaison de ObjectDataSource au GridView, `DataKeys(rowIndex).Value` fournit le `ProductID` pour le *rowIndex*spécifié.</span><span class="sxs-lookup"><span data-stu-id="0df8f-280">Since the GridView s `DataKeyNames` property was set to ProductID by Visual Studio when binding the ObjectDataSource to the GridView, `DataKeys(rowIndex).Value` provides the `ProductID` for the specified *rowIndex*.</span></span>

<span data-ttu-id="0df8f-281">Le ButtonField transmet automatiquement le *rowIndex* de la ligne dont le bouton a été cliqué via le paramètre `e.CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-281">The ButtonField automatically passes in the *rowIndex* of the row whose button was clicked through the `e.CommandArgument` parameter.</span></span> <span data-ttu-id="0df8f-282">Par conséquent, pour déterminer la `ProductID` pour la ligne dont le bouton Price + 10% ou Price-10% a été cliqué, nous utilisons : `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-282">Therefore, to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we use: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span></span>

<span data-ttu-id="0df8f-283">Comme avec le bouton arrêter tous les produits, si vous avez désactivé l’état d’affichage GridView s, le GridView est relié à la Banque de données sous-jacente à chaque publication (postback) et, par conséquent, est immédiatement mis à jour pour refléter un changement de prix qui se produit en cliquant sur l’un ou l’autre des boutons.</span><span class="sxs-lookup"><span data-stu-id="0df8f-283">As with the Discontinue All Products button, if you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect a price change that occurs from clicking either of the buttons.</span></span> <span data-ttu-id="0df8f-284">Toutefois, si vous n’avez pas désactivé l’état d’affichage dans le GridView, vous devrez lier manuellement les données au GridView après avoir apporté cette modification.</span><span class="sxs-lookup"><span data-stu-id="0df8f-284">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="0df8f-285">Pour ce faire, effectuez simplement un appel à la méthode GridView s `DataBind()` immédiatement après l’appel de la méthode `UpdateProduct`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-285">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `UpdateProduct` method.</span></span>

<span data-ttu-id="0df8f-286">La figure 20 illustre la page lors de l’affichage des produits fournis par Homestead de grand-mère.</span><span class="sxs-lookup"><span data-stu-id="0df8f-286">Figure 20 shows the page when viewing the products provided by Grandma Kelly's Homestead.</span></span> <span data-ttu-id="0df8f-287">La figure 21 illustre les résultats une fois que vous avez cliqué deux fois sur le bouton Price + 10% pour la propagation Boysenberry de grand-mère et le bouton Price-10% une fois pour Northwood Cranberry sauce.</span><span class="sxs-lookup"><span data-stu-id="0df8f-287">Figure 21 shows the results after the Price +10% button has been clicked twice for Grandma's Boysenberry Spread and the Price -10% button once for Northwoods Cranberry Sauce.</span></span>

<span data-ttu-id="0df8f-288">[![le contrôle GridView contient les boutons Price + 10% et Price-10%](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-288">[![The GridView Includes Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span></span>

<span data-ttu-id="0df8f-289">**Figure 20**: le contrôle GridView contient les boutons Price + 10% et Price-10% ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-289">**Figure 20**: The GridView Includes Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span></span>

<span data-ttu-id="0df8f-290">[![les prix pour le premier et le troisième produit ont été mis à jour à l’aide des boutons Price + 10% et Price-10%](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="0df8f-290">[![The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span></span>

<span data-ttu-id="0df8f-291">**Figure 21**: les prix pour le premier et le troisième produit ont été mis à jour à l’aide des boutons Price + 10% et Price-10% ([cliquez pour afficher l’image en taille réelle](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="0df8f-291">**Figure 21**: The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png))</span></span>

> [!NOTE]
> <span data-ttu-id="0df8f-292">Les contrôles GridView (et DetailsView) peuvent également avoir des boutons, des LinkButtons ou des ImageButtons ajoutés à leur TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="0df8f-292">The GridView (and DetailsView) can also have Buttons, LinkButtons, or ImageButtons added to their TemplateFields.</span></span> <span data-ttu-id="0df8f-293">Comme avec BoundField, ces boutons, quand vous cliquez dessus, provoquent une publication (postback), déclenchant l’événement `RowCommand` GridView s.</span><span class="sxs-lookup"><span data-stu-id="0df8f-293">As with the BoundField, these Buttons, when clicked, will induce a postback, raising the GridView s `RowCommand` event.</span></span> <span data-ttu-id="0df8f-294">Toutefois, lors de l’ajout de boutons dans un TemplateField, le bouton s `CommandArgument` n’est pas automatiquement défini sur l’index de la ligne comme c’est le cas lors de l’utilisation de ButtonFields.</span><span class="sxs-lookup"><span data-stu-id="0df8f-294">When adding buttons in a TemplateField, however, the Button s `CommandArgument` is not automatically set to the index of the row as it is when using ButtonFields.</span></span> <span data-ttu-id="0df8f-295">Si vous avez besoin de déterminer l’index de ligne du bouton sur lequel l’utilisateur a cliqué dans le gestionnaire d’événements `RowCommand`, vous devez définir manuellement la propriété Button s `CommandArgument` dans sa syntaxe déclarative au sein du TemplateField, à l’aide d’un code tel que :</span><span class="sxs-lookup"><span data-stu-id="0df8f-295">If you need to determine the row index of the button that was clicked within the `RowCommand` event handler, you'll need to manually set the Button s `CommandArgument` property in its declarative syntax within the TemplateField, using code like:</span></span>  
> <span data-ttu-id="0df8f-296">`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-296">`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`.</span></span>

## <a name="summary"></a><span data-ttu-id="0df8f-297">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="0df8f-297">Summary</span></span>

<span data-ttu-id="0df8f-298">Les contrôles GridView, DetailsView et FormView peuvent tous inclure des boutons, LinkButtons ou ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="0df8f-298">The GridView, DetailsView, and FormView controls all can include Buttons, LinkButtons, or ImageButtons.</span></span> <span data-ttu-id="0df8f-299">De tels boutons, quand vous cliquez dessus, provoquent une publication (postback) et déclenchent l’événement `ItemCommand` dans les contrôles FormView et DetailsView et l’événement `RowCommand` dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="0df8f-299">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event in the FormView and DetailsView controls and the `RowCommand` event in the GridView.</span></span> <span data-ttu-id="0df8f-300">Ces contrôles Web de données ont des fonctionnalités intégrées permettant de gérer des actions courantes liées aux commandes, telles que la suppression ou la modification d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="0df8f-300">These data Web controls have built-in functionality to handle common command-related actions, such as deleting or editing records.</span></span> <span data-ttu-id="0df8f-301">Toutefois, nous pouvons également utiliser des boutons qui, lorsque vous cliquez dessus, répondent à l’exécution de notre propre code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="0df8f-301">However, we can also use buttons that, when clicked, respond with executing our own custom code.</span></span>

<span data-ttu-id="0df8f-302">Pour ce faire, nous devons créer un gestionnaire d’événements pour l’événement `ItemCommand` ou `RowCommand`.</span><span class="sxs-lookup"><span data-stu-id="0df8f-302">To accomplish this, we need to create an event handler for the `ItemCommand` or `RowCommand` event.</span></span> <span data-ttu-id="0df8f-303">Dans ce gestionnaire d’événements, nous vérifions tout d’abord la valeur de `CommandName` entrant pour déterminer le bouton sur lequel l’utilisateur a cliqué, puis j’ai effectué l’action personnalisée appropriée.</span><span class="sxs-lookup"><span data-stu-id="0df8f-303">In this event handler we first check the incoming `CommandName` value to determine which button was clicked and then take appropriate custom action.</span></span> <span data-ttu-id="0df8f-304">Dans ce didacticiel, nous avons vu comment utiliser des boutons et des ButtonFields pour interrompre tous les produits pour un fournisseur spécifique ou pour augmenter ou réduire le prix d’un produit particulier de 10%.</span><span class="sxs-lookup"><span data-stu-id="0df8f-304">In this tutorial we saw how to use buttons and ButtonFields to discontinue all products for a specified supplier or to increase or decrease the price of a particular product by 10%.</span></span>

<span data-ttu-id="0df8f-305">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="0df8f-305">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0df8f-306">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="0df8f-306">About the Author</span></span>

<span data-ttu-id="0df8f-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="0df8f-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0df8f-308">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="0df8f-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0df8f-309">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0df8f-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0df8f-310">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0df8f-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0df8f-311">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0df8f-311">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0df8f-312">Précédent</span><span class="sxs-lookup"><span data-stu-id="0df8f-312">Previous</span></span>](adding-and-responding-to-buttons-to-a-gridview-cs.md)
