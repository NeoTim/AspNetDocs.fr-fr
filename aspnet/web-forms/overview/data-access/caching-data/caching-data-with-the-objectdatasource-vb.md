---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: Mise en cache de données avec ObjectDataSource (VB) | Microsoft Docs
author: rick-anderson
description: La mise en cache peut être la différence entre une application Web lente et rapide. Ce didacticiel est le premier d’une analyse détaillée de la mise en cache dans ASP.NET...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 16f20d9a0f4f677073174d680418b278dba40b07
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78550490"
---
# <a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="d9cd4-104">Mise en cache de données avec ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-104">Caching Data with the ObjectDataSource (VB)</span></span>

<span data-ttu-id="d9cd4-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d9cd4-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) ou [Télécharger le PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="d9cd4-107">La mise en cache peut être la différence entre une application Web lente et rapide.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="d9cd4-108">Ce didacticiel est le premier d’une analyse détaillée de la mise en cache dans ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="d9cd4-109">Découvrez les concepts clés de la mise en cache et comment appliquer la mise en cache à la couche de présentation via le contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="d9cd4-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="d9cd4-110">Introduction</span></span>

<span data-ttu-id="d9cd4-111">En informatique, la *mise en cache* est le processus qui consiste à mettre des données ou des informations coûteuses à obtenir et à en stocker une copie dans un emplacement qui est plus rapide à accéder.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="d9cd4-112">Pour les applications pilotées par les données, les requêtes volumineuses et complexes consomment généralement la majorité du temps d’exécution de l’application.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="d9cd4-113">Les performances d’une telle application peuvent souvent être améliorées en stockant les résultats des requêtes de base de données coûteuses dans la mémoire de l’application.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="d9cd4-114">ASP.NET 2,0 offre une variété d’options de mise en cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="d9cd4-115">Une page Web entière ou un contrôle utilisateur rendu du balisage peut être mis en cache via *la mise en cache de sortie*.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="d9cd4-116">Les contrôles ObjectDataSource et SqlDataSource offrent également des fonctionnalités de mise en cache, ce qui permet aux données d’être mises en cache au niveau du contrôle.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="d9cd4-117">Et le *cache de données* de ASP.NET fournit une API de mise en cache riche qui permet aux développeurs de pages de mettre en cache les objets par programmation.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="d9cd4-118">Dans ce didacticiel et les trois suivants, nous allons examiner l’utilisation des fonctionnalités de mise en cache de ObjectDataSource, ainsi que du cache de données.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="d9cd4-119">Nous allons également découvrir comment mettre en cache des données à l’ensemble de l’application au démarrage et comment conserver les données mises en cache à l’aide de dépendances de cache SQL.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="d9cd4-120">Ces didacticiels n’explorent pas la mise en cache de sortie.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="d9cd4-121">Pour plus d’informations sur la mise en cache de sortie, consultez [mise en cache de sortie dans ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="d9cd4-122">La mise en cache peut être appliquée à n’importe quel emplacement de l’architecture, de la couche d’accès aux données jusqu’à la couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="d9cd4-123">Dans ce didacticiel, nous allons examiner l’application de la mise en cache à la couche de présentation via le contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="d9cd4-124">Dans le didacticiel suivant, nous examinerons la mise en cache des données au niveau de la couche de logique métier.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="d9cd4-125">Principaux concepts de Caching</span><span class="sxs-lookup"><span data-stu-id="d9cd4-125">Key Caching Concepts</span></span>

<span data-ttu-id="d9cd4-126">La mise en cache peut améliorer sensiblement les performances globales et l’évolutivité d’une application en prenant des données qui sont coûteuses à générer et à stocker une copie de celle-ci dans un emplacement qui peut être plus efficace.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="d9cd4-127">Étant donné que le cache contient uniquement une copie des données réelles sous-jacentes, il peut devenir obsolète, ou *périmé*, si les données sous-jacentes sont modifiées.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="d9cd4-128">Pour combattre cela, un développeur de pages peut indiquer des critères par lesquels l’élément du cache sera *expulsé* du cache, à l’aide de l’une des deux opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="d9cd4-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="d9cd4-129">**Critères basés sur le temps** un élément peut être ajouté au cache pour une durée absolue ou glissante.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="d9cd4-130">Par exemple, un développeur de pages peut indiquer une durée de, par exemple, 60 secondes.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="d9cd4-131">Avec une durée absolue, l’élément mis en cache est expulsé de 60 secondes après son ajout au cache, quelle que soit la fréquence à laquelle il a fait l’objet d’un accès.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="d9cd4-132">Avec une durée glissante, l’élément mis en cache est supprimé 60 secondes après le dernier accès.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="d9cd4-133">**Critères basés sur la dépendance** une dépendance peut être associée à un élément lorsqu’il est ajouté au cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="d9cd4-134">En cas de modification de la dépendance de l’élément, il est expulsé du cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="d9cd4-135">La dépendance peut être un fichier, un autre élément de cache ou une combinaison des deux.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="d9cd4-136">ASP.NET 2,0 autorise également les dépendances de cache SQL, qui permettent aux développeurs d’ajouter un élément au cache et de le supprimer lorsque les données de la base de données sous-jacente sont modifiées.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="d9cd4-137">Nous examinerons les dépendances de cache SQL dans le didacticiel [à venir à l’aide des dépendances de cache SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="d9cd4-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="d9cd4-138">Quels que soient les critères d’éviction spécifiés, un élément du cache peut être *nettoyé* avant que les critères basés sur le temps ou sur les dépendances soient atteints.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="d9cd4-139">Si le cache a atteint sa capacité maximale, les éléments existants doivent être supprimés avant de pouvoir ajouter de nouveaux éléments.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="d9cd4-140">Par conséquent, lorsque vous utilisez par programmation des données mises en cache, il est vital que vous partiez toujours du principe que les données mises en cache ne sont peut-être pas présentes.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="d9cd4-141">Nous allons examiner le modèle à utiliser pour accéder aux données à partir du cache par programmation dans le didacticiel suivant, *mise en cache des données dans l’architecture*.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="d9cd4-142">La mise en cache offre un moyen économique d’augmenter les performances d’une application.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="d9cd4-143">À mesure que [Steven Smith](http://aspadvice.com/blogs/ssmith/) en est articulé dans son article [ASP.net Caching : techniques et meilleures pratiques](https://msdn.microsoft.com/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="d9cd4-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="d9cd4-144">La mise en cache peut être un bon moyen d’obtenir de bonnes performances sans nécessiter beaucoup de temps et d’analyses.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="d9cd4-145">La mémoire est peu coûteuse. par conséquent, si vous pouvez obtenir les performances dont vous avez besoin en mettant en cache la sortie pendant 30 secondes au lieu de passer un jour ou une semaine à essayer d’optimiser votre code ou votre base de données, effectuez la solution de mise en cache (en supposant que les données anciennes de 30 secondes sont correctes) et passez à la suite.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="d9cd4-146">Par la suite, une conception médiocre va probablement vous tenir à vous, et bien évidemment, vous devez essayer de concevoir correctement vos applications.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="d9cd4-147">Mais si vous avez simplement besoin d’obtenir de bonnes performances aujourd’hui, la mise en cache peut être une excellente [approche], vous permettant de refactoriser votre application à une date ultérieure lorsque vous avez le temps de le faire.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="d9cd4-148">Bien que la mise en cache puisse apporter des améliorations significatives en matière de performances, elle ne s’applique pas dans toutes les situations, par exemple avec les applications qui utilisent des données en temps réel, les mises à jour fréquentes, ou où même les données obsolètes à durée de vie courte sont inacceptables.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="d9cd4-149">Mais pour la plupart des applications, la mise en cache doit être utilisée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="d9cd4-150">Pour plus d’informations sur la mise en cache dans ASP.NET 2,0, reportez-vous à la section [Caching for performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) des [didacticiels de démarrage rapide ASP.NET 2,0](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="d9cd4-151">Étape 1 : création des pages Web de mise en cache</span><span class="sxs-lookup"><span data-stu-id="d9cd4-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="d9cd4-152">Avant de commencer l’exploration des fonctionnalités de mise en cache de ObjectDataSource, commençons par un moment pour créer les pages ASP.NET dans notre projet de site Web dont nous aurons besoin pour ce didacticiel et les trois prochaines.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="d9cd4-153">Commencez par ajouter un nouveau dossier nommé `Caching`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="d9cd4-154">Ajoutez ensuite les pages ASP.NET suivantes à ce dossier, en veillant à associer chaque page à la page maître `Site.master` :</span><span class="sxs-lookup"><span data-stu-id="d9cd4-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![Ajouter les pages ASP.NET pour les didacticiels liés à la mise en cache](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="d9cd4-156">**Figure 1**: ajouter les pages ASP.net pour les didacticiels liés à la mise en cache</span><span class="sxs-lookup"><span data-stu-id="d9cd4-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="d9cd4-157">Comme dans les autres dossiers, `Default.aspx` dans le dossier `Caching` répertorie les didacticiels de la section.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="d9cd4-158">N’oubliez pas que le contrôle utilisateur `SectionLevelTutorialListing.ascx` fournit cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="d9cd4-159">Par conséquent, ajoutez ce contrôle utilisateur à `Default.aspx` en le faisant glisser de l’Explorateur de solutions sur la page s Mode Création.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="d9cd4-160">[![figure 2 : ajouter le contrôle utilisateur SectionLevelTutorialListing. ascx à default. aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="d9cd4-161">**Figure 2**: figure 2 : ajouter le contrôle utilisateur `SectionLevelTutorialListing.ascx` à `Default.aspx` ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="d9cd4-162">Enfin, ajoutez ces pages en tant qu’entrées au fichier `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="d9cd4-163">Plus précisément, ajoutez le balisage suivant après l’utilisation de l' `<siteMapNode>`de données binaires :</span><span class="sxs-lookup"><span data-stu-id="d9cd4-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="d9cd4-164">Après avoir mis à jour `Web.sitemap`, prenez un moment pour afficher le site Web des didacticiels via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="d9cd4-165">Le menu à gauche contient maintenant des éléments pour les didacticiels de mise en cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-165">The menu on the left now includes items for the caching tutorials.</span></span>

![Le plan de site contient maintenant des entrées pour les didacticiels de mise en cache](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="d9cd4-167">**Figure 3**: le plan de site contient maintenant des entrées pour les didacticiels de mise en cache</span><span class="sxs-lookup"><span data-stu-id="d9cd4-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="d9cd4-168">Étape 2 : affichage d’une liste de produits dans une page Web</span><span class="sxs-lookup"><span data-stu-id="d9cd4-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="d9cd4-169">Ce didacticiel explore l’utilisation des fonctionnalités de mise en cache intégrées du contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="d9cd4-170">Avant de pouvoir examiner ces fonctionnalités, nous avons tout d’abord besoin d’une page à partir de laquelle travailler.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="d9cd4-171">Nous allons créer une page Web qui utilise un GridView pour répertorier les informations sur les produits récupérées par un ObjectDataSource à partir de la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="d9cd4-172">Commencez par ouvrir la page `ObjectDataSource.aspx` dans le dossier `Caching`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="d9cd4-173">Faites glisser un contrôle GridView de la boîte à outils vers le concepteur, affectez à sa propriété `ID` la valeur `Products`et, à partir de sa balise active, choisissez de le lier à un nouveau contrôle ObjectDataSource nommé `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="d9cd4-174">Configurez l’ObjectDataSource pour qu’il fonctionne avec la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="d9cd4-175">[![configurer ObjectDataSource pour utiliser la classe ProductsBLL](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="d9cd4-176">**Figure 4**: configurer ObjectDataSource pour utiliser la classe `ProductsBLL` ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="d9cd4-177">Pour cette page, créons un GridView modifiable afin que nous puissions examiner ce qui se passe lorsque les données mises en cache dans ObjectDataSource sont modifiées par le biais de l’interface de GridView s.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="d9cd4-178">Laissez la liste déroulante de l’onglet sélectionner définie sur sa valeur par défaut, `GetProducts()`, mais remplacez l’élément sélectionné dans l’onglet mettre à jour par la surcharge `UpdateProduct` qui accepte `productName`, `unitPrice`et `productID` comme paramètres d’entrée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="d9cd4-179">[![définir la liste déroulante des onglets de mise à jour sur la surcharge UpdateProduct appropriée](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="d9cd4-180">**Figure 5**: définir la liste déroulante des onglets de mise à jour sur la surcharge de `UpdateProduct` appropriée ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>

<span data-ttu-id="d9cd4-181">Enfin, définissez les listes déroulantes des onglets insérer et supprimer sur (aucun), puis cliquez sur Terminer.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="d9cd4-182">À la fin de l’Assistant Configuration de la source de données, Visual Studio définit la propriété ObjectDataSource s `OldValuesParameterFormatString` sur `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="d9cd4-183">Comme nous l’avons vu dans le didacticiel sur l' [insertion, la mise à jour et la suppression des données](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) , cette propriété doit être supprimée de la syntaxe déclarative ou redéfinie sur sa valeur par défaut, `{0}`, pour que notre flux de travail de mise à jour puisse s’exécuter sans erreur.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="d9cd4-184">En outre, à la fin de l’Assistant, Visual Studio ajoute un champ au GridView pour chacun des champs de données de produit.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="d9cd4-185">Supprimez tout sauf les `ProductName`, `CategoryName`et `UnitPrice` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="d9cd4-186">Ensuite, mettez à jour les propriétés de `HeaderText` de chacun de ces BoundFields de façon à ce qu’elles soient respectivement produit, Category et Price.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="d9cd4-187">Étant donné que le champ `ProductName` est obligatoire, convertissez le BoundField en TemplateField et ajoutez un RequiredFieldValidator à la `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="d9cd4-188">De même, convertissez le `UnitPrice` BoundField en TemplateField et ajoutez un CompareValidator pour vous assurer que la valeur entrée par l’utilisateur est une valeur monétaire valide qui est supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="d9cd4-189">En plus de ces modifications, n’hésitez pas à effectuer des modifications esthétiques, telles que l’alignement à droite de la valeur `UnitPrice`, ou la spécification de la mise en forme du texte `UnitPrice` dans ses interfaces en lecture seule et en modification.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="d9cd4-190">Rendez le GridView modifiable en activant la case à cocher Activer la modification dans la balise active GridView s.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="d9cd4-191">Activez également les cases à cocher Activer la pagination et activer le tri.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="d9cd4-192">Vous avez besoin d’un avis sur la personnalisation de l’interface de modification de GridView s ?</span><span class="sxs-lookup"><span data-stu-id="d9cd4-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="d9cd4-193">Si c’est le cas, reportez-vous au didacticiel [Personnalisation de l’interface de modification des données](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="d9cd4-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>

<span data-ttu-id="d9cd4-194">[![activer la prise en charge de GridView pour la modification, le tri et la pagination](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="d9cd4-195">**Figure 6**: activer la prise en charge de GridView pour la modification, le tri et la pagination ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>

<span data-ttu-id="d9cd4-196">Après avoir apporté ces modifications GridView, les balises déclaratives GridView et ObjectDataSource doivent ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="d9cd4-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="d9cd4-197">Comme le montre la figure 7, le contrôle GridView modifiable répertorie le nom, la catégorie et le prix de chacun des produits de la base de données.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="d9cd4-198">Prenez un moment pour tester la fonctionnalité des pages trier les résultats, les parcourir et modifier un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="d9cd4-199">[![chaque nom, catégorie et prix du produit est listé dans un GridView pouvant être trié, paginable et modifiable](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="d9cd4-200">**Figure 7**: le nom, la catégorie et le prix de chaque produit sont listés dans un GridView pouvant être trié, paginable et modifiable ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="d9cd4-201">Étape 3 : examen du moment où ObjectDataSource demande des données</span><span class="sxs-lookup"><span data-stu-id="d9cd4-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="d9cd4-202">Le `Products` GridView récupère ses données à afficher en appelant la méthode `Select` de l’ObjectDataSource `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="d9cd4-203">Cet ObjectDataSource crée une instance de la couche de logique métier `ProductsBLL` classe et appelle sa méthode `GetProducts()`, qui à son tour appelle la méthode de la couche d’accès aux données `ProductsTableAdapter` s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="d9cd4-204">La méthode DAL se connecte à la base de données Northwind et émet la requête `SELECT` configurée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="d9cd4-205">Ces données sont ensuite retournées à la couche DAL, qui les empaquette dans un `NorthwindDataTable`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="d9cd4-206">L’objet DataTable est retourné à la couche BLL, qui le retourne à l’ObjectDataSource, qui le retourne au GridView.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="d9cd4-207">Le GridView crée ensuite un objet `GridViewRow` pour chaque `DataRow` dans le DataTable, et chaque `GridViewRow` est finalement rendue dans le code HTML renvoyé au client et affiché sur le navigateur du visiteur.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="d9cd4-208">Cette séquence d’événements se produit chaque fois que le GridView doit effectuer une liaison à ses données sous-jacentes.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="d9cd4-209">Cela se produit lorsque la page est visitée pour la première fois, lorsque vous passez d’une page de données à une autre, lorsque vous triez le contrôle GridView ou lorsque vous modifiez les données de GridView par le biais de ses interfaces intégrées de modification ou de suppression.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="d9cd4-210">Si l’état d’affichage GridView s est désactivé, le GridView est relié à chaque publication (postback) et à chaque publication (postback).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="d9cd4-211">Le contrôle GridView peut également être explicitement relié à ses données en appelant sa méthode `DataBind()`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="d9cd4-212">Pour apprécier pleinement la fréquence à laquelle les données sont récupérées de la base de données, vous pouvez afficher un message indiquant le moment où les données sont récupérées à nouveau.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="d9cd4-213">Ajoutez un contrôle Web Label au-dessus du contrôle GridView nommé `ODSEvents`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="d9cd4-214">Effacez sa propriété `Text` et affectez à sa propriété `EnableViewState` la valeur `False`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="d9cd4-215">Sous l’étiquette, ajoutez un contrôle Web Button et affectez à sa propriété `Text` la valeur postback.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="d9cd4-216">[![ajouter une étiquette et un bouton à la page au-dessus du contrôle GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="d9cd4-217">**Figure 8**: ajouter une étiquette et un bouton à la page au-dessus du contrôle GridView ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>

<span data-ttu-id="d9cd4-218">Pendant le flux de travail d’accès aux données, l’événement ObjectDataSource s `Selecting` se déclenche avant la création de l’objet sous-jacent et la méthode de configuration appelée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="d9cd4-219">Créez un gestionnaire d’événements pour cet événement et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="d9cd4-219">Create an event handler for this event and add the following code:</span></span>

[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="d9cd4-220">Chaque fois que l’ObjectDataSource envoie une requête à l’architecture pour les données, l’étiquette affiche l’événement de sélection de texte déclenché.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="d9cd4-221">Visitez cette page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-221">Visit this page in a browser.</span></span> <span data-ttu-id="d9cd4-222">Lorsque la page est visitée pour la première fois, l’événement de sélection de texte déclenché est affiché.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="d9cd4-223">Cliquez sur le bouton publication (postback) et notez que le texte disparaît (en supposant que la propriété GridView s `EnableViewState` est définie sur `True`, la valeur par défaut).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="d9cd4-224">Cela est dû au fait que, lors de la publication (postback), le GridView est reconstruit à partir de son état d’affichage et, par conséquent, il n’est pas converti en ObjectDataSource pour ses données.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="d9cd4-225">Toutefois, le tri, la pagination ou la modification des données entraîne la reliaison du GridView à sa source de données, et par conséquent, le texte événement de sélection réapparaît.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="d9cd4-226">[![chaque fois que le GridView est relié à sa source de données, la sélection de l’événement déclenché s’affiche.](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="d9cd4-227">**Figure 9**: chaque fois que le GridView est relié à sa source de données, la sélection de l’événement déclenché s’affiche ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>

<span data-ttu-id="d9cd4-228">[![lorsque vous cliquez sur le bouton publication, le contrôle GridView est reconstruit à partir de son état d’affichage](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="d9cd4-229">**Figure 10**: lorsque vous cliquez sur le bouton de publication, le contrôle GridView est reconstruit à partir de son état d’affichage ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>

<span data-ttu-id="d9cd4-230">La récupération des données de la base de données peut paraître gaspiller chaque fois que les données sont paginées ou triées.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="d9cd4-231">Après tout, puisque nous utilisons à nouveau la pagination par défaut, ObjectDataSource a récupéré tous les enregistrements lors de l’affichage de la première page.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="d9cd4-232">Même si le GridView ne fournit pas de prise en charge du tri et de la pagination, les données doivent être récupérées de la base de données chaque fois que la page est visitée pour la première fois par n’importe quel utilisateur (et à chaque publication, si l’état d’affichage est désactivé).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="d9cd4-233">Toutefois, si le GridView présente les mêmes données à tous les utilisateurs, ces demandes de base de données supplémentaires sont superflues.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="d9cd4-234">Pourquoi ne pas mettre en cache les résultats retournés par la méthode `GetProducts()` et lier le contrôle GridView à ces résultats mis en cache ?</span><span class="sxs-lookup"><span data-stu-id="d9cd4-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="d9cd4-235">Étape 4 : mise en cache des données à l’aide de ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="d9cd4-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="d9cd4-236">En définissant simplement quelques propriétés, ObjectDataSource peut être configuré pour mettre automatiquement en cache ses données récupérées dans le cache de données ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="d9cd4-237">La liste suivante récapitule les propriétés liées au cache de l’ObjectDataSource :</span><span class="sxs-lookup"><span data-stu-id="d9cd4-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="d9cd4-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) doit avoir la valeur `True` pour activer la mise en cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="d9cd4-239">La valeur par défaut est `False`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-239">The default is `False`.</span></span>
- <span data-ttu-id="d9cd4-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) durée, en secondes, pendant laquelle les données sont mises en cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="d9cd4-241">La valeur par défaut est 0.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-241">The default is 0.</span></span> <span data-ttu-id="d9cd4-242">ObjectDataSource met uniquement en cache les données si `EnableCaching` est `True` et `CacheDuration` est définie sur une valeur supérieure à zéro.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="d9cd4-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) peut avoir la valeur `Absolute` ou `Sliding`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="d9cd4-244">Si `Absolute`, ObjectDataSource met en cache ses données extraites pendant `CacheDuration` secondes ; Si `Sliding`, les données expirent uniquement après qu’elles n’ont pas été consultées pendant `CacheDuration` secondes.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="d9cd4-245">La valeur par défaut est `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="d9cd4-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) Utilisez cette propriété pour associer les entrées du cache ObjectDataSource s à une dépendance de cache existante.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="d9cd4-247">Les entrées de données ObjectDataSource s peuvent être supprimées prématurément du cache en faisant expirer le `CacheKeyDependency`associé.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="d9cd4-248">Cette propriété est généralement utilisée pour associer une dépendance de cache SQL au cache de l’ObjectDataSource s, une rubrique que nous explorerons ultérieurement à l’aide du didacticiel sur les [dépendances de cache SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="d9cd4-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="d9cd4-249">Configurez le `ProductsDataSource` ObjectDataSource pour mettre ses données en cache pendant 30 secondes sur une échelle absolue.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="d9cd4-250">Définissez la propriété ObjectDataSource s `EnableCaching` sur `True` et sa propriété `CacheDuration` sur 30.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="d9cd4-251">Laissez la propriété `CacheExpirationPolicy` définie sur sa valeur par défaut, `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="d9cd4-252">[![configurer ObjectDataSource pour mettre en cache ses données pendant 30 secondes](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="d9cd4-253">**Figure 11**: configurer ObjectDataSource pour mettre en cache ses données pendant 30 secondes ([cliquez pour afficher l’image en taille réelle](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="d9cd4-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>

<span data-ttu-id="d9cd4-254">Enregistrez vos modifications et réexaminez cette page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="d9cd4-255">Le texte de sélection de l’événement s’affiche lorsque vous accédez pour la première fois à la page, car les données ne se trouvent pas dans le cache initialement.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="d9cd4-256">Toutefois, les publications (postbacks) suivantes déclenchées par un clic sur le bouton de publication (postback), le tri, la pagination ou le clic sur les boutons modifier ou annuler ne réaffichent *pas* le texte de sélection de l’événement déclenché.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="d9cd4-257">Cela est dû au fait que l’événement `Selecting` se déclenche uniquement lorsque ObjectDataSource obtient ses données à partir de son objet sous-jacent ; l’événement `Selecting` ne se déclenche pas si les données sont extraites du cache de données.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="d9cd4-258">Au bout de 30 secondes, les données sont supprimées du cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="d9cd4-259">Les données seront également supprimées du cache si les méthodes d' `Insert`ObjectDataSource, `Update`ou `Delete` sont appelées.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="d9cd4-260">Par conséquent, au bout de 30 secondes ou lorsque vous avez cliqué sur le bouton mettre à jour, le tri, la pagination ou le clic sur les boutons modifier ou annuler entraîne l’affichage de ses données par ObjectDataSource pour l’objet sous-jacent, ce qui affiche le texte de sélection déclenché lorsque l’événement `Selecting` se déclenche.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="d9cd4-261">Ces résultats retournés sont remis dans le cache de données.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="d9cd4-262">Si vous voyez fréquemment le texte de sélection de l’événement déclenché, même si vous vous attendez à ce que ObjectDataSource utilise les données mises en cache, cela peut être dû à des contraintes de mémoire.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="d9cd4-263">Si la mémoire disponible est insuffisante, les données ajoutées au cache par ObjectDataSource peuvent avoir été nettoyées.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="d9cd4-264">Si le ObjectDataSource ne semble pas mettre en cache correctement les données ou met en cache les données de manière sporadique, fermez certaines applications pour libérer de la mémoire, puis réessayez.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="d9cd4-265">La figure 12 illustre le flux de travail de mise en cache de ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="d9cd4-266">Lorsque le texte de sélection de l’événement déclenché s’affiche sur votre écran, c’est parce que les données n’étaient pas dans le cache et devaient être récupérées à partir de l’objet sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="d9cd4-267">Toutefois, lorsque ce texte est manquant, il s’agit du fait que les données étaient disponibles à partir du cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="d9cd4-268">Lorsque les données sont retournées à partir du cache, il n’y a aucun appel à l’objet sous-jacent et, par conséquent, aucune requête de base de données n’est exécutée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![ObjectDataSource stocke et récupère ses données à partir du cache de données](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="d9cd4-270">**Figure 12**: l’ObjectDataSource stocke et récupère ses données à partir du cache de données</span><span class="sxs-lookup"><span data-stu-id="d9cd4-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="d9cd4-271">Chaque application ASP.NET a sa propre instance de cache de données qui est partagée entre toutes les pages et les visiteurs.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="d9cd4-272">Cela signifie que les données stockées dans le cache de données par l’ObjectDataSource sont également partagées entre tous les utilisateurs qui visitent la page.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="d9cd4-273">Pour vérifier cela, ouvrez la page `ObjectDataSource.aspx` dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="d9cd4-274">Lors de la première visite de la page, le texte de sélection de l’événement sélectionné s’affiche (en supposant que les données ajoutées au cache par les tests précédents ont été supprimées, par la suite).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="d9cd4-275">Ouvrez une deuxième instance du navigateur et copiez et collez l’URL de la première instance du navigateur à la seconde.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="d9cd4-276">Dans la deuxième instance du navigateur, le texte de sélection de l’événement qui est déclenché n’est pas affiché parce qu’il utilise les mêmes données mises en cache que la première.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="d9cd4-277">Lors de l’insertion de ses données récupérées dans le cache, ObjectDataSource utilise une valeur de clé de cache qui comprend : les valeurs de propriété `CacheDuration` et `CacheExpirationPolicy` ; type de l’objet métier sous-jacent utilisé par l’ObjectDataSource, qui est spécifié via la [propriété`TypeName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, dans cet exemple); la valeur de la propriété `SelectMethod` et le nom et les valeurs des paramètres dans la collection `SelectParameters` ; et les valeurs de ses propriétés `StartRowIndex` et `MaximumRows`, qui sont utilisées lors de l’implémentation de la [pagination personnalisée](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="d9cd4-278">L’élaboration de la valeur de clé de cache en tant que combinaison de ces propriétés garantit une entrée de cache unique à mesure que ces valeurs changent.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="d9cd4-279">Par exemple, dans les didacticiels précédents, nous avons examiné à l’aide de la classe `ProductsBLL` s `GetProductsByCategoryID(categoryID)`, qui retourne tous les produits pour une catégorie spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="d9cd4-280">Un utilisateur peut accéder à la page et afficher les boissons, qui a une `CategoryID` de 1.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="d9cd4-281">Si le ObjectDataSource a mis en cache ses résultats sans tenir compte des valeurs de `SelectParameters`, lorsqu’un autre utilisateur a accédé à la page pour afficher les condiments alors que les produits de boissons se trouvaient dans le cache, ils voient les produits de boisson mis en cache plutôt que les condiments.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="d9cd4-282">En faisant varier la clé de cache par ces propriétés, qui incluent les valeurs du `SelectParameters`, ObjectDataSource conserve une entrée de cache distincte pour les boissons et les condiments.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="d9cd4-283">Problèmes liés aux données périmées</span><span class="sxs-lookup"><span data-stu-id="d9cd4-283">Stale Data Concerns</span></span>

<span data-ttu-id="d9cd4-284">ObjectDataSource supprime automatiquement ses éléments du cache lorsque l’une de ses méthodes `Insert`, `Update`ou `Delete` est appelée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="d9cd4-285">Cela permet de se protéger contre les données périmées en effaçant les entrées du cache lorsque les données sont modifiées via la page.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="d9cd4-286">Toutefois, il est possible pour un ObjectDataSource qui utilise la mise en cache de toujours afficher des données obsolètes.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="d9cd4-287">Dans le cas le plus simple, cela peut être dû à la modification directe des données dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="d9cd4-288">Peut-être qu’un administrateur de base de données a exécuté un script qui modifie certains des enregistrements de la base de données.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="d9cd4-289">Ce scénario peut également être dérouler de façon plus subtile.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="d9cd4-290">Alors que ObjectDataSource supprime ses éléments du cache quand l’une de ses méthodes de modification de données est appelée, les éléments mis en cache supprimés concernent la combinaison de valeurs de propriété de l’ObjectDataSource s (`CacheDuration`, `TypeName`, `SelectMethod`, etc.).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="d9cd4-291">Si vous avez deux ObjectDataSources qui utilisent des `SelectMethods` ou des `SelectParameters`différents, mais que vous pouvez toujours mettre à jour les mêmes données, un ObjectDataSource peut mettre à jour une ligne et invalider ses propres entrées de cache, mais la ligne correspondante pour la deuxième ObjectDataSource sera toujours traitée à partir du cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="d9cd4-292">Je vous encourage à créer des pages pour présenter cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="d9cd4-293">Créez une page qui affiche un GridView modifiable qui extrait ses données d’un ObjectDataSource qui utilise la mise en cache et qui est configurée pour obtenir des données de la méthode de `GetProducts()` de la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="d9cd4-294">Ajoutez un autre GridView modifiable et ObjectDataSource à cette page (ou un autre), mais pour ce deuxième ObjectDataSource, utilisez la méthode `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="d9cd4-295">Étant donné que les deux propriétés de `SelectMethod` ObjectDataSources diffèrent, elles ont chacune leurs propres valeurs mises en cache.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="d9cd4-296">Si vous modifiez un produit dans une grille, la prochaine fois que vous lierez à nouveau les données à l’autre grille (par pagination, tri, etc.), il servira toujours les anciennes données mises en cache et ne reflétera pas la modification apportée à partir de l’autre grille.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="d9cd4-297">En bref, utilisez uniquement des expirations basées sur le temps si vous souhaitez avoir le potentiel des données périmées et utiliser des expirations plus courtes pour les scénarios où l’actualisation des données est importante.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="d9cd4-298">Si les données périmées ne sont pas acceptables, renoncez à la mise en cache ou utilisez des dépendances de cache SQL (en supposant que les données de base de données que vous mettez à nouveau en cache</span><span class="sxs-lookup"><span data-stu-id="d9cd4-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="d9cd4-299">Nous allons explorer les dépendances de cache SQL dans un prochain didacticiel.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="d9cd4-300">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="d9cd4-300">Summary</span></span>

<span data-ttu-id="d9cd4-301">Dans ce didacticiel, nous avons examiné les fonctionnalités de mise en cache intégrées à ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="d9cd4-302">En définissant simplement quelques propriétés, nous pouvons demander à ObjectDataSource de mettre en cache les résultats retournés par le `SelectMethod` spécifié dans le cache de données ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="d9cd4-303">Les propriétés `CacheDuration` et `CacheExpirationPolicy` indiquent la durée de mise en cache de l’élément et s’il s’agit d’une expiration absolue ou décalée.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="d9cd4-304">La propriété `CacheKeyDependency` associe toutes les entrées de cache ObjectDataSource dans une dépendance de cache existante.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="d9cd4-305">Cela peut être utilisé pour supprimer les entrées ObjectDataSource du cache avant que l’expiration basée sur la durée soit atteinte, et est généralement utilisé avec les dépendances de cache SQL.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="d9cd4-306">Dans la mesure où ObjectDataSource met simplement en cache ses valeurs dans le cache de données, nous pourrions répliquer les fonctionnalités ObjectDataSource s intégrées par programmation.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="d9cd4-307">Il n’a pas de sens pour effectuer cette opération au niveau de la couche de présentation, puisque l’ObjectDataSource offre cette fonctionnalité dès le moment, mais nous pouvons implémenter des fonctionnalités de mise en cache dans une couche distincte de l’architecture.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="d9cd4-308">Pour ce faire, nous devons répéter la même logique que celle utilisée par ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="d9cd4-309">Nous allons découvrir comment travailler par programmation avec le cache de données dans l’architecture de notre prochain didacticiel.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="d9cd4-310">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="d9cd4-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="d9cd4-311">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="d9cd4-311">Further Reading</span></span>

<span data-ttu-id="d9cd4-312">Pour plus d’informations sur les sujets abordés dans ce didacticiel, reportez-vous aux ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="d9cd4-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d9cd4-313">Mise en cache ASP.NET : techniques et meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="d9cd4-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="d9cd4-314">Guide d’architecture de mise en cache pour les applications .NET Framework</span><span class="sxs-lookup"><span data-stu-id="d9cd4-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="d9cd4-315">Mise en cache de sortie dans ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="d9cd4-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="d9cd4-316">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="d9cd4-316">About the Author</span></span>

<span data-ttu-id="d9cd4-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d9cd4-318">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d9cd4-319">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d9cd4-320">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d9cd4-321">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d9cd4-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d9cd4-322">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="d9cd4-322">Special Thanks To</span></span>

<span data-ttu-id="d9cd4-323">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d9cd4-324">Le réviseur de leads pour ce didacticiel était Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="d9cd4-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="d9cd4-325">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="d9cd4-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d9cd4-326">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d9cd4-327">[Précédent](using-sql-cache-dependencies-cs.md)
> [Suivant](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d9cd4-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
