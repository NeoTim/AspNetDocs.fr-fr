---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-cs
title: Insertion d’un nouvel enregistrement à partir du pied de pageC#du GridView () | Microsoft Docs
author: rick-anderson
description: Bien que le contrôle GridView ne fournisse pas de prise en charge intégrée pour l’insertion d’un nouvel enregistrement de données, ce didacticiel montre comment augmenter le GridView pour inclure un...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 49545652-98af-46ba-9dbc-9ab529805d9b
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-cs
msc.type: authoredcontent
ms.openlocfilehash: 6b337fe395a0ed54b03767111e73ea6d6c0ba23a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74591898"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-c"></a><span data-ttu-id="54430-103">Insertion d’un nouvel enregistrement à partir du pied de page d’un contrôle GridView (C#)</span><span class="sxs-lookup"><span data-stu-id="54430-103">Inserting a New Record from the GridView's Footer (C#)</span></span>

<span data-ttu-id="54430-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="54430-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="54430-105">[Télécharger l’exemple d’application](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_CS.exe) ou [Télécharger le PDF](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/datatutorial53cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="54430-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_CS.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/datatutorial53cs1.pdf)</span></span>

> <span data-ttu-id="54430-106">Bien que le contrôle GridView ne fournisse pas de prise en charge intégrée pour l’insertion d’un nouvel enregistrement de données, ce didacticiel montre comment augmenter le GridView pour inclure une interface d’insertion.</span><span class="sxs-lookup"><span data-stu-id="54430-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="54430-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="54430-107">Introduction</span></span>

<span data-ttu-id="54430-108">Comme indiqué dans le didacticiel [vue d’ensemble de l’insertion, de la mise à jour et de la suppression des données](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) , les contrôles Web GridView, DetailsView et FormView incluent chacun des fonctionnalités de modification de données intégrées.</span><span class="sxs-lookup"><span data-stu-id="54430-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="54430-109">Lorsqu’ils sont utilisés avec des contrôles de source de données déclaratifs, ces trois contrôles Web peuvent être rapidement et facilement configurés pour modifier les données et dans les scénarios sans avoir à écrire une seule ligne de code.</span><span class="sxs-lookup"><span data-stu-id="54430-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="54430-110">Malheureusement, seuls les contrôles DetailsView et FormView offrent des fonctionnalités intégrées d’insertion, de modification et de suppression.</span><span class="sxs-lookup"><span data-stu-id="54430-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="54430-111">Le GridView offre uniquement la prise en charge de la modification et de la suppression.</span><span class="sxs-lookup"><span data-stu-id="54430-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="54430-112">Toutefois, avec un petit coude de graisse, nous pouvons augmenter le GridView pour inclure une interface d’insertion.</span><span class="sxs-lookup"><span data-stu-id="54430-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="54430-113">Lors de l’ajout de fonctionnalités d’insertion au GridView, nous sommes chargés de déterminer comment les nouveaux enregistrements seront ajoutés, de créer l’interface d’insertion et d’écrire le code permettant d’insérer le nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="54430-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="54430-114">Dans ce didacticiel, nous allons ajouter l’interface d’insertion à la ligne de pied de page de GridView s (voir figure 1).</span><span class="sxs-lookup"><span data-stu-id="54430-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="54430-115">La cellule de pied de page de chaque colonne comprend l’élément d’interface utilisateur de la collection de données approprié (une zone de texte pour le nom du produit s, un contrôle DropDownList pour le fournisseur, etc.).</span><span class="sxs-lookup"><span data-stu-id="54430-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="54430-116">Nous avons également besoin d’une colonne pour un bouton Ajouter qui, lorsque vous cliquez dessus, entraîne une publication (postback) et insère un nouvel enregistrement dans la table `Products` à l’aide des valeurs fournies dans la ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="54430-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="54430-117">[![la ligne de pied de page fournit une interface pour l’ajout de nouveaux produits](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="54430-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image1.png)</span></span>

<span data-ttu-id="54430-118">**Figure 1**: la ligne de pied de page fournit une interface pour l’ajout de nouveaux produits ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="54430-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="54430-119">Étape 1 : affichage des informations sur le produit dans un GridView</span><span class="sxs-lookup"><span data-stu-id="54430-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="54430-120">Avant de nous soucier de la création de l’interface d’insertion dans le pied de page de GridView s, commençons par se concentrer sur l’ajout d’un GridView à la page qui répertorie les produits de la base de données.</span><span class="sxs-lookup"><span data-stu-id="54430-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="54430-121">Commencez par ouvrir la page `InsertThroughFooter.aspx` dans le dossier `EnhancedGridView` et faites glisser un contrôle GridView de la boîte à outils vers le concepteur, en affectant à la propriété GridView s `ID` la valeur `Products`.</span><span class="sxs-lookup"><span data-stu-id="54430-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="54430-122">Ensuite, utilisez la balise active GridView s pour la lier à un nouvel ObjectDataSource nommé `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="54430-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="54430-123">[![créer un ObjectDataSource nommé ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="54430-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.png)</span></span>

<span data-ttu-id="54430-124">**Figure 2**: créer un ObjectDataSource nommé `ProductsDataSource` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="54430-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.png))</span></span>

<span data-ttu-id="54430-125">Configurez le ObjectDataSource pour utiliser la méthode de `GetProducts()` de la classe `ProductsBLL` pour récupérer les informations sur le produit.</span><span class="sxs-lookup"><span data-stu-id="54430-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="54430-126">Pour ce didacticiel, nous allons vous concentrer strictement sur l’ajout de fonctionnalités d’insertion et ne vous inquiétez pas de la modification et de la suppression.</span><span class="sxs-lookup"><span data-stu-id="54430-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="54430-127">Par conséquent, assurez-vous que la liste déroulante de l’onglet Insertion est définie sur `AddProduct()` et que les listes déroulantes des onglets mettre à jour et supprimer ont la valeur (aucune).</span><span class="sxs-lookup"><span data-stu-id="54430-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="54430-128">[![mapper la méthode AddProduct à la méthode d’insertion () de ObjectDataSource](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="54430-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.png)</span></span>

<span data-ttu-id="54430-129">**Figure 3**: mapper la méthode `AddProduct` à la méthode d' `Insert()` ObjectDataSource s ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="54430-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.png))</span></span>

<span data-ttu-id="54430-130">[![définir les listes déroulantes mettre à jour et supprimer les onglets sur (aucune)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="54430-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.png)</span></span>

<span data-ttu-id="54430-131">**Figure 4**: définir les listes déroulantes mettre à jour et supprimer les onglets sur (aucun) ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="54430-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image8.png))</span></span>

<span data-ttu-id="54430-132">À la fin de l’Assistant Configuration de la source de données ObjectDataSource s, Visual Studio ajoute automatiquement des champs au GridView pour chacun des champs de données correspondants.</span><span class="sxs-lookup"><span data-stu-id="54430-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="54430-133">Pour le moment, laissez tous les champs ajoutés par Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="54430-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="54430-134">Plus loin dans ce didacticiel, nous allons revenir et supprimer certains champs dont les valeurs ne doivent pas être spécifiées lors de l’ajout d’un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="54430-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="54430-135">Étant donné qu’il y a près de 80 produits dans la base de données, un utilisateur devra faire défiler jusqu’au bas de la page Web pour ajouter un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="54430-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="54430-136">Par conséquent, activez la pagination pour rendre l’interface d’insertion plus visible et accessible.</span><span class="sxs-lookup"><span data-stu-id="54430-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="54430-137">Pour activer la pagination, activez simplement la case à cocher Activer la pagination dans la balise active GridView s.</span><span class="sxs-lookup"><span data-stu-id="54430-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="54430-138">À ce stade, les balises déclaratives GridView et ObjectDataSource doivent ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="54430-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample1.aspx)]

<span data-ttu-id="54430-139">[![tous les champs de données de produit sont affichés dans un contrôle GridView paginé](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="54430-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.png)</span></span>

<span data-ttu-id="54430-140">**Figure 5**: tous les champs de données de produit s’affichent dans un contrôle GridView paginé ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="54430-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="54430-141">Étape 2 : ajout d’une ligne de pied de page</span><span class="sxs-lookup"><span data-stu-id="54430-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="54430-142">Avec ses lignes d’en-tête et de données, le contrôle GridView comprend une ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="54430-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="54430-143">Les lignes d’en-tête et de pied de page s’affichent en fonction des valeurs des propriétés GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) et [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) .</span><span class="sxs-lookup"><span data-stu-id="54430-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="54430-144">Pour afficher la ligne de pied de page, il vous suffit de définir la propriété `ShowFooter` sur `true`.</span><span class="sxs-lookup"><span data-stu-id="54430-144">To show the footer row, simply set the `ShowFooter` property to `true`.</span></span> <span data-ttu-id="54430-145">Comme illustré à la figure 6, la définition de la propriété `ShowFooter` sur `true` ajoute une ligne de pied de page à la grille.</span><span class="sxs-lookup"><span data-stu-id="54430-145">As Figure 6 illustrates, setting the `ShowFooter` property to `true` adds a footer row to the grid.</span></span>

<span data-ttu-id="54430-146">[![pour afficher la ligne de pied de page, affectez la valeur true à ShowFooter](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="54430-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.png)</span></span>

<span data-ttu-id="54430-147">**Figure 6**: pour afficher la ligne de pied de page, définissez `ShowFooter` sur `True` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="54430-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.png))</span></span>

<span data-ttu-id="54430-148">Notez que la ligne de pied de page a une couleur d’arrière-plan rouge foncé.</span><span class="sxs-lookup"><span data-stu-id="54430-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="54430-149">Cela est dû au thème DataWebControls que nous avons créé et appliqué à toutes les pages dans le didacticiel [affichage des données avec ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="54430-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial.</span></span> <span data-ttu-id="54430-150">Plus précisément, le fichier `GridView.skin` configure la propriété `FooterStyle` de manière à ce que utilise la classe CSS `FooterStyle`.</span><span class="sxs-lookup"><span data-stu-id="54430-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="54430-151">La classe `FooterStyle` est définie dans `Styles.css` comme suit :</span><span class="sxs-lookup"><span data-stu-id="54430-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="54430-152">Nous avons exploré à l’aide de la ligne de pied de page de GridView s dans les didacticiels précédents.</span><span class="sxs-lookup"><span data-stu-id="54430-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="54430-153">Si nécessaire, reportez-vous à la page [affichage des informations récapitulatives dans le didacticiel de pied de page du GridView](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-cs.md) pour un actualisateur.</span><span class="sxs-lookup"><span data-stu-id="54430-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-cs.md) tutorial for a refresher.</span></span>

<span data-ttu-id="54430-154">Après avoir défini la propriété `ShowFooter` sur `true`, prenez un moment pour afficher la sortie dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="54430-154">After setting the `ShowFooter` property to `true`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="54430-155">Actuellement, la ligne de pied de page ne contient pas de texte ou de contrôles Web.</span><span class="sxs-lookup"><span data-stu-id="54430-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="54430-156">À l’étape 3, nous allons modifier le pied de page pour chaque champ GridView afin qu’il comprenne l’interface d’insertion appropriée.</span><span class="sxs-lookup"><span data-stu-id="54430-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="54430-157">[![la ligne de pied de page vide est affichée au-dessus des contrôles d’interface de pagination](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="54430-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image13.png)</span></span>

<span data-ttu-id="54430-158">**Figure 7**: la ligne de pied de page vide est affichée au-dessus des contrôles de l’interface de pagination ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="54430-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="54430-159">Étape 3 : personnalisation de la ligne de pied de page</span><span class="sxs-lookup"><span data-stu-id="54430-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="54430-160">De retour dans le didacticiel [à l’aide de TemplateFields dans le contrôle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) , nous avons vu comment personnaliser de manière radicale l’affichage d’une colonne GridView particulière à l’aide de TemplateFields (par opposition à BoundFields ou CheckBoxFields). dans [Personnalisation de l’interface de modification des données](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) , nous avons examiné l’utilisation de TemplateFields pour personnaliser l’interface de modification dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="54430-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="54430-161">Rappelez-vous qu’un TemplateField est composé d’un certain nombre de modèles qui définissent la combinaison des balises, des contrôles Web et de la syntaxe de liaison de liaison utilisés pour certains types de lignes.</span><span class="sxs-lookup"><span data-stu-id="54430-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="54430-162">Le `ItemTemplate`, par exemple, spécifie le modèle utilisé pour les lignes en lecture seule, tandis que l' `EditItemTemplate` définit le modèle pour la ligne modifiable.</span><span class="sxs-lookup"><span data-stu-id="54430-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="54430-163">Avec les `ItemTemplate` et `EditItemTemplate`, TemplateField comprend également un `FooterTemplate` qui spécifie le contenu de la ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="54430-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="54430-164">Par conséquent, nous pouvons ajouter les contrôles Web requis pour chaque champ, en insérant l’interface dans le `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="54430-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="54430-165">Pour démarrer, convertissez tous les champs du contrôle GridView en TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="54430-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="54430-166">Pour ce faire, cliquez sur le lien modifier les colonnes dans la balise active GridView s, sélectionnez chaque champ dans le coin inférieur gauche, puis cliquez sur le lien convertir ce champ en TemplateField.</span><span class="sxs-lookup"><span data-stu-id="54430-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![Convertir chaque champ en TemplateField](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image8.gif)

<span data-ttu-id="54430-168">**Figure 8**: convertir chaque champ en TemplateField</span><span class="sxs-lookup"><span data-stu-id="54430-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="54430-169">Si vous cliquez sur le bouton convertir ce champ en TemplateField, le type de champ actuel devient un TemplateField équivalent.</span><span class="sxs-lookup"><span data-stu-id="54430-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="54430-170">Par exemple, chaque BoundField est remplacé par un TemplateField avec un `ItemTemplate` qui contient une étiquette qui affiche le champ de données correspondant et un `EditItemTemplate` qui affiche le champ de données dans une zone de texte.</span><span class="sxs-lookup"><span data-stu-id="54430-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="54430-171">La `ProductName` BoundField a été convertie dans le balisage TemplateField suivant :</span><span class="sxs-lookup"><span data-stu-id="54430-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample3.aspx)]

<span data-ttu-id="54430-172">De même, le `Discontinued` CheckBoxField a été converti en TemplateField dont `ItemTemplate` et `EditItemTemplate` contiennent un contrôle Web CheckBox (avec la case à cocher `ItemTemplate` s désactivée).</span><span class="sxs-lookup"><span data-stu-id="54430-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="54430-173">Le `ProductID` BoundField en lecture seule a été converti en TemplateField avec un contrôle Label dans les `ItemTemplate` et `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="54430-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="54430-174">En résumé, la conversion d’un champ GridView existant en TemplateField est un moyen simple et rapide de basculer vers le TemplateField plus personnalisable, sans perdre aucune des fonctionnalités existantes des champs.</span><span class="sxs-lookup"><span data-stu-id="54430-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="54430-175">Étant donné que le GridView avec lequel nous travaillons avec ne prend pas en charge la modification, n’hésitez pas à supprimer le `EditItemTemplate` de chaque TemplateField, en laissant juste le `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="54430-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="54430-176">Après cela, votre balisage déclaratif s doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="54430-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample4.aspx)]

<span data-ttu-id="54430-177">Maintenant que chaque champ GridView a été converti en TemplateField, nous pouvons entrer l’interface d’insertion appropriée dans chaque champ s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="54430-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="54430-178">Certains champs ne disposent pas d’une interface d’insertion (`ProductID`, par exemple); d’autres peuvent varier dans les contrôles Web utilisés pour collecter les informations relatives aux nouveaux produits.</span><span class="sxs-lookup"><span data-stu-id="54430-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="54430-179">Pour créer l’interface d’édition, choisissez le lien modifier les modèles dans la balise active de GridView s.</span><span class="sxs-lookup"><span data-stu-id="54430-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="54430-180">Ensuite, dans la liste déroulante, sélectionnez les `FooterTemplate` champs appropriés, puis faites glisser le contrôle approprié de la boîte à outils vers le concepteur.</span><span class="sxs-lookup"><span data-stu-id="54430-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="54430-181">[![ajouter l’interface d’insertion appropriée à chaque FooterTemplate Field](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="54430-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image15.png)</span></span>

<span data-ttu-id="54430-182">**Figure 9**: ajouter l’interface d’insertion appropriée à chaque champ s `FooterTemplate` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="54430-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image16.png))</span></span>

<span data-ttu-id="54430-183">La liste à puces suivante énumère les champs GridView, en spécifiant l’interface d’insertion à ajouter :</span><span class="sxs-lookup"><span data-stu-id="54430-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="54430-184">`ProductID` aucun.</span><span class="sxs-lookup"><span data-stu-id="54430-184">`ProductID` none.</span></span>
- <span data-ttu-id="54430-185">`ProductName` ajouter une zone de texte et définir ses `ID` sur `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="54430-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="54430-186">Ajoutez également un contrôle RequiredFieldValidator pour vous assurer que l’utilisateur entre une valeur pour le nouveau nom du produit.</span><span class="sxs-lookup"><span data-stu-id="54430-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="54430-187">`SupplierID` aucun.</span><span class="sxs-lookup"><span data-stu-id="54430-187">`SupplierID` none.</span></span>
- <span data-ttu-id="54430-188">`CategoryID` aucun.</span><span class="sxs-lookup"><span data-stu-id="54430-188">`CategoryID` none.</span></span>
- <span data-ttu-id="54430-189">`QuantityPerUnit` ajouter une zone de texte, en affectant à son `ID` la valeur `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="54430-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="54430-190">`UnitPrice` ajouter une zone de texte nommée `NewUnitPrice` et un CompareValidator qui garantit que la valeur entrée est une valeur monétaire supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="54430-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="54430-191">`UnitsInStock` utiliser une zone de texte dont `ID` a la valeur `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="54430-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="54430-192">Incluez un CompareValidator qui garantit que la valeur entrée est une valeur entière supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="54430-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="54430-193">`UnitsOnOrder` utiliser une zone de texte dont `ID` a la valeur `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="54430-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="54430-194">Incluez un CompareValidator qui garantit que la valeur entrée est une valeur entière supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="54430-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="54430-195">`ReorderLevel` utiliser une zone de texte dont `ID` a la valeur `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="54430-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="54430-196">Incluez un CompareValidator qui garantit que la valeur entrée est une valeur entière supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="54430-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="54430-197">`Discontinued` ajoutez une case à cocher, en affectant à sa `ID` la valeur `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="54430-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="54430-198">`CategoryName` ajouter un DropDownList et définir ses `ID` sur `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="54430-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="54430-199">Liez-le à un nouvel ObjectDataSource nommé `CategoriesDataSource` et configurez-le pour qu’il utilise la méthode de `CategoriesBLL` classe s `GetCategories()`.</span><span class="sxs-lookup"><span data-stu-id="54430-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="54430-200">Que les `ListItem` DropDownList affichent le champ de données `CategoryName`, en utilisant le champ de données `CategoryID` comme valeurs.</span><span class="sxs-lookup"><span data-stu-id="54430-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="54430-201">`SupplierName` ajouter un DropDownList et définir ses `ID` sur `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="54430-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="54430-202">Liez-le à un nouvel ObjectDataSource nommé `SuppliersDataSource` et configurez-le pour qu’il utilise la méthode de `SuppliersBLL` classe s `GetSuppliers()`.</span><span class="sxs-lookup"><span data-stu-id="54430-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="54430-203">Que les `ListItem` DropDownList affichent le champ de données `CompanyName`, en utilisant le champ de données `SupplierID` comme valeurs.</span><span class="sxs-lookup"><span data-stu-id="54430-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="54430-204">Pour chacun des contrôles de validation, supprimez la propriété `ForeColor` afin que la couleur d’arrière-plan de la `FooterStyle` classe CSS White s soit utilisée à la place du rouge par défaut.</span><span class="sxs-lookup"><span data-stu-id="54430-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="54430-205">Utilisez également la propriété `ErrorMessage` pour obtenir une description détaillée, mais affectez à la propriété `Text` la valeur un astérisque.</span><span class="sxs-lookup"><span data-stu-id="54430-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="54430-206">Pour éviter que le texte du contrôle de validation ne provoque l’encapsulation de l’interface d’insertion sur deux lignes, affectez la valeur false à la propriété `FooterStyle` s `Wrap` pour chaque `FooterTemplate` s qui utilise un contrôle de validation.</span><span class="sxs-lookup"><span data-stu-id="54430-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="54430-207">Enfin, ajoutez un contrôle ValidationSummary sous le GridView et définissez sa propriété `ShowMessageBox` sur `true` et sa propriété `ShowSummary` sur `false`.</span><span class="sxs-lookup"><span data-stu-id="54430-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span>

<span data-ttu-id="54430-208">Lorsque vous ajoutez un nouveau produit, nous devons fournir les `CategoryID` et les `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="54430-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="54430-209">Ces informations sont capturées via le DropDownList dans les cellules de pied de page pour les champs `CategoryName` et `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="54430-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="54430-210">J’ai choisi d’utiliser ces champs plutôt que les `CategoryID` et `SupplierID` TemplateFields, car dans les lignes de données de la grille, l’utilisateur est susceptible de voir les noms des catégories et des fournisseurs plutôt que leurs valeurs d’ID.</span><span class="sxs-lookup"><span data-stu-id="54430-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="54430-211">Étant donné que les valeurs `CategoryID` et `SupplierID` sont maintenant capturées dans les interfaces d’insertion de `CategoryName` et de `SupplierName` Fields, nous pouvons supprimer les `CategoryID` et `SupplierID` TemplateFields du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="54430-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="54430-212">De même, le `ProductID` n’est pas utilisé lors de l’ajout d’un nouveau produit, donc le `ProductID` TemplateField peut également être supprimé.</span><span class="sxs-lookup"><span data-stu-id="54430-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="54430-213">Toutefois, laissez le champ `ProductID` dans la grille.</span><span class="sxs-lookup"><span data-stu-id="54430-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="54430-214">Outre les contrôles TextBox, les DropDownList, les cases à cocher et les contrôles de validation qui composent l’interface d’insertion, nous aurons également besoin d’un bouton Ajouter qui, lorsque vous cliquez dessus, exécute la logique pour ajouter le nouveau produit à la base de données.</span><span class="sxs-lookup"><span data-stu-id="54430-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="54430-215">À l’étape 4, nous allons inclure un bouton Ajouter dans l’interface d’insertion de la `FooterTemplate``ProductID` TemplateField s.</span><span class="sxs-lookup"><span data-stu-id="54430-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="54430-216">N’hésitez pas à améliorer l’apparence des différents champs GridView.</span><span class="sxs-lookup"><span data-stu-id="54430-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="54430-217">Par exemple, vous pouvez mettre en forme les valeurs de `UnitPrice` comme une devise, aligner à droite les champs `UnitsInStock`, `UnitsOnOrder`et `ReorderLevel`, puis mettre à jour les valeurs de `HeaderText` pour TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="54430-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="54430-218">Après avoir créé l’interface d’insertion des interfaces dans le `FooterTemplate` s, en supprimant les `SupplierID`et `CategoryID` TemplateFields et en améliorant l’esthétique de la grille par le biais de la mise en forme et de l’alignement du TemplateFields, votre balisage déclaratif s doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="54430-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample5.aspx)]

<span data-ttu-id="54430-219">En cas d’affichage dans un navigateur, la ligne de pied de page de GridView s comprend désormais l’interface d’insertion terminée (voir figure 10).</span><span class="sxs-lookup"><span data-stu-id="54430-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="54430-220">À ce stade, l’interface d’insertion n’inclut pas de moyen permettant à l’utilisateur d’indiquer qu’il a entré les données pour le nouveau produit et souhaite insérer un nouvel enregistrement dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="54430-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="54430-221">En outre, nous avons encore pu traiter la manière dont les données entrées dans le pied de page seront traduites en un nouvel enregistrement dans la base de données `Products`.</span><span class="sxs-lookup"><span data-stu-id="54430-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="54430-222">À l’étape 4, nous verrons comment inclure un bouton Ajouter à l’interface d’insertion et comment exécuter du code sur la publication (postback) quand l’utilisateur clique dessus.</span><span class="sxs-lookup"><span data-stu-id="54430-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="54430-223">L’étape 5 montre comment insérer un nouvel enregistrement à l’aide des données du pied de page.</span><span class="sxs-lookup"><span data-stu-id="54430-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="54430-224">[![le pied de page GridView fournit une interface pour l’ajout d’un nouvel enregistrement](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="54430-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image17.png)</span></span>

<span data-ttu-id="54430-225">**Figure 10**: le pied de page GridView fournit une interface permettant d’ajouter un nouvel enregistrement ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="54430-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="54430-226">Étape 4 : inclure un bouton Ajouter dans l’interface d’insertion</span><span class="sxs-lookup"><span data-stu-id="54430-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="54430-227">Nous devons inclure un bouton ajouter quelque part dans l’interface d’insertion, car la ligne de pied de page qui insère l’interface ne dispose pas actuellement des moyens permettant à l’utilisateur d’indiquer qu’il a terminé d’entrer les nouvelles informations du produit.</span><span class="sxs-lookup"><span data-stu-id="54430-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="54430-228">Cela peut être placé dans l’un des `FooterTemplate` existants ou nous pouvons ajouter une nouvelle colonne à cette grille à cet effet.</span><span class="sxs-lookup"><span data-stu-id="54430-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="54430-229">Pour ce didacticiel, nous allons placer le bouton Ajouter dans le `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="54430-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="54430-230">Dans le concepteur, cliquez sur le lien modifier les modèles dans la balise active GridView s, puis sélectionnez les `ProductID` champ s `FooterTemplate` dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="54430-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="54430-231">Ajoutez un contrôle Web Button (ou LinkButton ou ImageButton, si vous préférez) au modèle, en définissant son ID sur `AddProduct`, son `CommandName` à insérer et sa propriété `Text` à ajouter, comme illustré à la figure 11.</span><span class="sxs-lookup"><span data-stu-id="54430-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="54430-232">[![Placez le bouton Ajouter dans ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="54430-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image19.png)</span></span>

<span data-ttu-id="54430-233">**Figure 11**: placer le bouton Ajouter dans le `ProductID` TemplateField s `FooterTemplate` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="54430-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image20.png))</span></span>

<span data-ttu-id="54430-234">Une fois que vous avez inclus le bouton Ajouter, testez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="54430-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="54430-235">Notez que lorsque vous cliquez sur le bouton Ajouter avec des données non valides dans l’interface d’insertion, la publication est court-circuitée et le contrôle ValidationSummary indique les données non valides (voir figure 12).</span><span class="sxs-lookup"><span data-stu-id="54430-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="54430-236">Lorsque les données appropriées sont entrées, le fait de cliquer sur le bouton Ajouter entraîne une publication (postback).</span><span class="sxs-lookup"><span data-stu-id="54430-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="54430-237">Aucun enregistrement n’est toutefois ajouté à la base de données.</span><span class="sxs-lookup"><span data-stu-id="54430-237">No record is added to the database, however.</span></span> <span data-ttu-id="54430-238">Nous devons écrire un peu de code pour exécuter réellement l’insertion.</span><span class="sxs-lookup"><span data-stu-id="54430-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="54430-239">[![le bouton ajouter de la publication (postback) est court-circuit Si des données ne sont pas valides dans l’interface d’insertion](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="54430-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image21.png)</span></span>

<span data-ttu-id="54430-240">**Figure 12**: le bouton Ajouter une publication (postback) est court-circuit Si des données ne sont pas valides dans l’interface d’insertion ([cliquez pour afficher l’image en plein écran](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="54430-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-cs/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="54430-241">Les contrôles de validation de l’interface d’insertion n’ont pas été assignés à un groupe de validation.</span><span class="sxs-lookup"><span data-stu-id="54430-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="54430-242">Cela fonctionne très bien tant que l’interface d’insertion est le seul ensemble de contrôles de validation sur la page.</span><span class="sxs-lookup"><span data-stu-id="54430-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="54430-243">Si, toutefois, il existe d’autres contrôles de validation sur la page (tels que les contrôles de validation dans l’interface de modification de la grille), les contrôles de validation dans les propriétés d’insertion d’interface et d’ajout de bouton `ValidationGroup` doivent être affectés de la même valeur afin d’associer ces contrôles à un groupe de validation particulier.</span><span class="sxs-lookup"><span data-stu-id="54430-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="54430-244">Pour plus d’informations sur le partitionnement des contrôles de validation et des boutons d’une page dans des groupes de validation, consultez [discroiser les contrôles de validation dans ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) .</span><span class="sxs-lookup"><span data-stu-id="54430-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="54430-245">Étape 5 : insertion d’un nouvel enregistrement dans la table`Products`</span><span class="sxs-lookup"><span data-stu-id="54430-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="54430-246">Lors de l’utilisation des fonctionnalités d’édition intégrées du GridView, le GridView gère automatiquement tout le travail nécessaire pour effectuer la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="54430-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="54430-247">En particulier, lorsque l’utilisateur clique sur le bouton mettre à jour, il copie les valeurs entrées à partir de l’interface de modification vers les paramètres de la collection ObjectDataSource s `UpdateParameters` et lance la mise à jour en appelant la méthode ObjectDataSource s `Update()`.</span><span class="sxs-lookup"><span data-stu-id="54430-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="54430-248">Étant donné que le contrôle GridView ne fournit pas ces fonctionnalités intégrées pour l’insertion, nous devons implémenter le code qui appelle la méthode ObjectDataSource s `Insert()` et copie les valeurs de l’interface d’insertion dans la collection de `InsertParameters` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="54430-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="54430-249">Cette logique d’insertion doit être exécutée une fois que vous avez cliqué sur le bouton Ajouter.</span><span class="sxs-lookup"><span data-stu-id="54430-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="54430-250">Comme indiqué dans les [boutons ajouter et répondre à dans un didacticiel GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs.md) , chaque fois qu’un utilisateur clique sur un bouton, LinkButton ou ImageButton dans un GridView, l’événement gridview s `RowCommand` se déclenche lors de la publication (postback).</span><span class="sxs-lookup"><span data-stu-id="54430-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="54430-251">Cet événement se déclenche si le bouton, LinkButton ou ImageButton a été ajouté explicitement, tel que le bouton Ajouter dans la ligne de pied de page ou s’il a été ajouté automatiquement par le GridView (tel que le LinkButtons en haut de chaque colonne lorsque l’option Activer le tri est sélectionnée ou la valeur LinkButtons dans l’interface de pagination lorsque l’option Activer la pagination est sélectionnée).</span><span class="sxs-lookup"><span data-stu-id="54430-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="54430-252">Par conséquent, pour répondre à l’utilisateur qui clique sur le bouton Ajouter, nous devons créer un gestionnaire d’événements pour l’événement `RowCommand` GridView s.</span><span class="sxs-lookup"><span data-stu-id="54430-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="54430-253">Étant donné que cet événement est déclenché chaque fois que l’utilisateur clique sur *un* bouton, LinkButton ou ImageButton dans le GridView, il est vital que nous procédions uniquement à la logique d’insertion si la propriété `CommandName` transmise dans le gestionnaire d’événements est mappée à la valeur `CommandName` du bouton Ajouter (insérer).</span><span class="sxs-lookup"><span data-stu-id="54430-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="54430-254">En outre, nous devons également continuer uniquement si les contrôles de validation signalent des données valides.</span><span class="sxs-lookup"><span data-stu-id="54430-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="54430-255">Pour ce faire, créez un gestionnaire d’événements pour l’événement `RowCommand` à l’aide du code suivant :</span><span class="sxs-lookup"><span data-stu-id="54430-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="54430-256">Vous vous demandez peut-être pourquoi le gestionnaire d’événements vérifie la propriété `Page.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="54430-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="54430-257">Après tout, la publication ne sera-t-elle pas supprimée si des données non valides sont fournies dans l’interface d’insertion ?</span><span class="sxs-lookup"><span data-stu-id="54430-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="54430-258">Cette hypothèse est correcte tant que l’utilisateur n’a pas désactivé JavaScript ou a pris les mesures nécessaires pour contourner la logique de validation côté client.</span><span class="sxs-lookup"><span data-stu-id="54430-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="54430-259">En bref, l’un ne doit jamais reposer strictement sur la validation côté client ; une vérification de validité côté serveur doit toujours être effectuée avant l’utilisation des données.</span><span class="sxs-lookup"><span data-stu-id="54430-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="54430-260">À l’étape 1, nous avons créé le `ProductsDataSource` ObjectDataSource de telle sorte que sa méthode `Insert()` soit mappée à la méthode de `AddProduct` de la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="54430-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="54430-261">Pour insérer le nouvel enregistrement dans la table `Products`, nous pouvons simplement invoquer la méthode d' `Insert()` ObjectDataSource s :</span><span class="sxs-lookup"><span data-stu-id="54430-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample7.cs)]

<span data-ttu-id="54430-262">Maintenant que la méthode `Insert()` a été appelée, il ne reste plus qu’à copier les valeurs de l’interface d’insertion vers les paramètres passés à la méthode `AddProduct` de la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="54430-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="54430-263">Comme nous l’avons vu dans le didacticiel [examen des événements associés à l’insertion, à la mise à jour et](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) à la suppression, vous pouvez le faire via l’événement ObjectDataSource s `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="54430-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="54430-264">Dans le `Inserting` événement, nous devons référencer par programmation les contrôles à partir de la ligne de pied de page de `Products` GridView et affecter leurs valeurs à la collection de `e.InputParameters`.</span><span class="sxs-lookup"><span data-stu-id="54430-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="54430-265">Si l’utilisateur omet une valeur telle que en laissant la `ReorderLevel` zone de texte vide, nous devons spécifier que la valeur insérée dans la base de données doit être `NULL`.</span><span class="sxs-lookup"><span data-stu-id="54430-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="54430-266">Étant donné que la méthode `AddProducts` accepte les types Nullable pour les champs de base de données Nullable, utilisez simplement un type Nullable et affectez-lui la valeur `null` dans le cas où l’entrée utilisateur est omise.</span><span class="sxs-lookup"><span data-stu-id="54430-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `null` in the case where user input is omitted.</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample8.cs)]

<span data-ttu-id="54430-267">Une fois le gestionnaire d’événements `Inserting` terminé, de nouveaux enregistrements peuvent être ajoutés à la table de base de données `Products` par le biais de la ligne de pied de page GridView s.</span><span class="sxs-lookup"><span data-stu-id="54430-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="54430-268">Essayez d’ajouter plusieurs nouveaux produits.</span><span class="sxs-lookup"><span data-stu-id="54430-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="54430-269">Amélioration et personnalisation de l’opération d’ajout</span><span class="sxs-lookup"><span data-stu-id="54430-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="54430-270">Actuellement, le fait de cliquer sur le bouton Ajouter ajoute un nouvel enregistrement à la table de base de données, mais ne fournit aucune sorte de retour visuel indiquant que l’enregistrement a été ajouté avec succès.</span><span class="sxs-lookup"><span data-stu-id="54430-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="54430-271">Dans l’idéal, un contrôle Web label ou une zone d’alerte côté client informera l’utilisateur que son insertion s’est terminée avec succès.</span><span class="sxs-lookup"><span data-stu-id="54430-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="54430-272">Je laisse cela en tant qu’exercice pour le lecteur.</span><span class="sxs-lookup"><span data-stu-id="54430-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="54430-273">Le contrôle GridView utilisé dans ce didacticiel n’applique aucun ordre de tri aux produits listés et ne permet pas non plus à l’utilisateur final de trier les données.</span><span class="sxs-lookup"><span data-stu-id="54430-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="54430-274">Par conséquent, les enregistrements sont triés tels qu’ils figurent dans la base de données par leur champ de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="54430-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="54430-275">Étant donné que chaque nouvel enregistrement a une valeur de `ProductID` supérieure à la dernière, chaque fois qu’un nouveau produit est ajouté, il est ajouté à la fin de la grille.</span><span class="sxs-lookup"><span data-stu-id="54430-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="54430-276">Par conséquent, vous souhaiterez peut-être envoyer automatiquement l’utilisateur à la dernière page du contrôle GridView après l’ajout d’un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="54430-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="54430-277">Pour ce faire, vous pouvez ajouter la ligne de code suivante après l’appel à `ProductsDataSource.Insert()` dans le gestionnaire d’événements `RowCommand` pour indiquer que l’utilisateur doit être envoyé à la dernière page après avoir lié les données au GridView :</span><span class="sxs-lookup"><span data-stu-id="54430-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample9.cs)]

<span data-ttu-id="54430-278">`SendUserToLastPage` est une variable booléenne au niveau de la page à laquelle une valeur de `false`est assignée initialement.</span><span class="sxs-lookup"><span data-stu-id="54430-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `false`.</span></span> <span data-ttu-id="54430-279">Dans le gestionnaire d’événements `DataBound` GridView s, si `SendUserToLastPage` a la valeur false, la propriété `PageIndex` est mise à jour pour envoyer l’utilisateur à la dernière page.</span><span class="sxs-lookup"><span data-stu-id="54430-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-csharp[Main](inserting-a-new-record-from-the-gridview-s-footer-cs/samples/sample10.cs)]

<span data-ttu-id="54430-280">La raison pour laquelle la propriété `PageIndex` est définie dans le gestionnaire d’événements `DataBound` (par opposition au gestionnaire d’événements `RowCommand`) est que, lorsque le gestionnaire d’événements `RowCommand` se déclenche, nous avons encore ajouté le nouvel enregistrement à la table de base de données `Products`.</span><span class="sxs-lookup"><span data-stu-id="54430-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="54430-281">Par conséquent, dans le gestionnaire d’événements `RowCommand` le dernier index de page (`PageCount - 1`) représente le dernier index de page *avant* l’ajout du nouveau produit.</span><span class="sxs-lookup"><span data-stu-id="54430-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="54430-282">Pour la majorité des produits ajoutés, le dernier index de page est le même après l’ajout du nouveau produit.</span><span class="sxs-lookup"><span data-stu-id="54430-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="54430-283">Toutefois, lorsque le produit ajouté entraîne la création d’un nouvel index de dernière page, si nous mettons à jour de manière incorrecte le `PageIndex` dans le gestionnaire d’événements `RowCommand`, nous allons passer à la dernière page (l’index de la dernière page avant l’ajout du nouveau produit), par opposition au nouvel index de la dernière page.</span><span class="sxs-lookup"><span data-stu-id="54430-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="54430-284">Étant donné que le gestionnaire d’événements `DataBound` se déclenche une fois que le nouveau produit a été ajouté et que les données sont reliées à la grille, en définissant la propriété `PageIndex`, nous savons que nous obtenons à nouveau l’index de dernière page correct.</span><span class="sxs-lookup"><span data-stu-id="54430-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="54430-285">Enfin, le GridView utilisé dans ce didacticiel est assez vaste en raison du nombre de champs qui doivent être collectés pour l’ajout d’un nouveau produit.</span><span class="sxs-lookup"><span data-stu-id="54430-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="54430-286">En raison de cette largeur, une disposition verticale de DetailsView s peut être préférée.</span><span class="sxs-lookup"><span data-stu-id="54430-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="54430-287">La largeur globale de GridView s peut être réduite en collectant moins d’entrées.</span><span class="sxs-lookup"><span data-stu-id="54430-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="54430-288">Peut-être n’avez-vous pas besoin de collecter les champs `UnitsOnOrder`, `UnitsInStock`et `ReorderLevel` lors de l’ajout d’un nouveau produit, auquel cas ces champs peuvent être supprimés du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="54430-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="54430-289">Pour ajuster les données collectées, nous pouvons utiliser l’une des deux approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="54430-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="54430-290">Continuez à utiliser la méthode `AddProduct` qui attend des valeurs pour les champs `UnitsOnOrder`, `UnitsInStock`et `ReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="54430-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="54430-291">Dans le gestionnaire d’événements `Inserting`, fournissez des valeurs par défaut codées en dur à utiliser pour ces entrées qui ont été supprimées de l’interface d’insertion.</span><span class="sxs-lookup"><span data-stu-id="54430-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="54430-292">Créez une nouvelle surcharge de la méthode `AddProduct` dans la classe `ProductsBLL` qui n’accepte pas les entrées pour les champs `UnitsOnOrder`, `UnitsInStock`et `ReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="54430-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="54430-293">Ensuite, dans la page ASP.NET, configurez le ObjectDataSource pour utiliser cette nouvelle surcharge.</span><span class="sxs-lookup"><span data-stu-id="54430-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="54430-294">Les deux options fonctionnent également aussi bien.</span><span class="sxs-lookup"><span data-stu-id="54430-294">Either option will work equally as well.</span></span> <span data-ttu-id="54430-295">Dans les didacticiels précédents, nous avons utilisé cette dernière option, en créant plusieurs surcharges pour la méthode `ProductsBLL` Class s `UpdateProduct`.</span><span class="sxs-lookup"><span data-stu-id="54430-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="54430-296">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="54430-296">Summary</span></span>

<span data-ttu-id="54430-297">Le GridView ne dispose pas des fonctionnalités d’insertion intégrées de DetailsView et FormView, mais avec un peu d’effort, une interface d’insertion peut être ajoutée à la ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="54430-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="54430-298">Pour afficher la ligne de pied de page dans un GridView, il suffit de définir sa propriété `ShowFooter` sur `true`.</span><span class="sxs-lookup"><span data-stu-id="54430-298">To display the footer row in a GridView simply set its `ShowFooter` property to `true`.</span></span> <span data-ttu-id="54430-299">Le contenu de la ligne de pied de page peut être personnalisé pour chaque champ en convertissant le champ en TemplateField et en ajoutant l’interface d’insertion au `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="54430-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="54430-300">Comme nous l’avons vu dans ce didacticiel, les `FooterTemplate` peuvent contenir des boutons, des zones de texte, des DropDownList, des cases à cocher, des contrôles de source de données pour remplir des contrôles Web pilotés par les données (tels que DropDownList) et des contrôles de validation.</span><span class="sxs-lookup"><span data-stu-id="54430-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="54430-301">Outre les contrôles pour la collecte de l’entrée de l’utilisateur, un bouton Ajouter, LinkButton ou ImageButton est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="54430-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="54430-302">Quand l’utilisateur clique sur le bouton Ajouter, la méthode ObjectDataSource s `Insert()` est appelée pour démarrer le flux de travail d’insertion.</span><span class="sxs-lookup"><span data-stu-id="54430-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="54430-303">ObjectDataSource appellera ensuite la méthode d’insertion configurée (la méthode `ProductsBLL` classe s `AddProduct`, dans ce didacticiel).</span><span class="sxs-lookup"><span data-stu-id="54430-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="54430-304">Nous devons copier les valeurs de l’interface de l’insertion de GridView s vers la collection d’objets ObjectDataSource `InsertParameters` avant d’appeler la méthode Insert.</span><span class="sxs-lookup"><span data-stu-id="54430-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="54430-305">Pour ce faire, vous pouvez référencer par programmation les contrôles Web d’insertion d’interface dans le gestionnaire d’événements `Inserting` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="54430-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="54430-306">Ce didacticiel termine notre examen des techniques pour améliorer l’apparence de GridView s.</span><span class="sxs-lookup"><span data-stu-id="54430-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="54430-307">L’ensemble suivant de didacticiels vous apprendra à utiliser des données binaires telles que des images, des fichiers PDF, des documents Word, etc., ainsi que les contrôles Web de données.</span><span class="sxs-lookup"><span data-stu-id="54430-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="54430-308">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="54430-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="54430-309">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="54430-309">About the Author</span></span>

<span data-ttu-id="54430-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="54430-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="54430-311">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="54430-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="54430-312">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="54430-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="54430-313">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="54430-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="54430-314">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="54430-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="54430-315">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="54430-315">Special Thanks To</span></span>

<span data-ttu-id="54430-316">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="54430-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="54430-317">Le réviseur de leads pour ce didacticiel était Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="54430-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="54430-318">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="54430-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="54430-319">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="54430-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="54430-320">[Précédent](adding-a-gridview-column-of-checkboxes-cs.md)
> [Suivant](adding-a-gridview-column-of-radio-buttons-vb.md)</span><span class="sxs-lookup"><span data-stu-id="54430-320">[Previous](adding-a-gridview-column-of-checkboxes-cs.md)
[Next](adding-a-gridview-column-of-radio-buttons-vb.md)</span></span>
