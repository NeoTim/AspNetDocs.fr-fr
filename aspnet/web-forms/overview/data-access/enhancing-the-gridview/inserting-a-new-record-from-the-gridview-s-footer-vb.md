---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: Insertion d’un nouvel enregistrement à partir du pied de page du GridView (VB) | Microsoft Docs
author: rick-anderson
description: Tandis que le contrôle GridView ne fournit pas de prise en charge intégrée pour l’insertion d’un nouvel enregistrement de données, ce didacticiel montre comment augmenter le contrôle GridView à inclure un...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 962d1ff53b87577dd8f232f1bcb8fd01198a5a6d
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108638"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="48913-103">Insertion d’un nouvel enregistrement à partir du pied de page d’un contrôle GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="48913-103">Inserting a New Record from the GridView's Footer (VB)</span></span>

<span data-ttu-id="48913-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="48913-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="48913-105">[Télécharger l’exemple d’application](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) ou [télécharger le PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="48913-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="48913-106">Tandis que le contrôle GridView ne fournit pas de prise en charge intégrée pour l’insertion d’un nouvel enregistrement de données, ce didacticiel montre comment augmenter le contrôle GridView pour inclure une interface d’insertion.</span><span class="sxs-lookup"><span data-stu-id="48913-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="48913-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="48913-107">Introduction</span></span>

<span data-ttu-id="48913-108">Comme indiqué dans le [une vue d’ensemble d’insertion, mise à jour et suppression des données](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) didacticiel, les contrôles GridView, DetailsView et FormView Web incluent des fonctionnalités de modification de données intégrés.</span><span class="sxs-lookup"><span data-stu-id="48913-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="48913-109">Lorsqu’il est utilisé avec les contrôles de source de données déclarative, ces trois contrôles Web rapidement et facilement configurables pour modifier des données - et dans les scénarios sans avoir à écrire une seule ligne de code.</span><span class="sxs-lookup"><span data-stu-id="48913-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="48913-110">Malheureusement, uniquement les contrôles DetailsView et FormView fournissent intégré l’insertion, la modification et la suppression de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="48913-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="48913-111">Le contrôle GridView offre uniquement la modification et suppression de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="48913-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="48913-112">Toutefois, avec un peu graisse de coude, nous pouvons augmenter le contrôle GridView pour inclure une interface d’insertion.</span><span class="sxs-lookup"><span data-stu-id="48913-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="48913-113">Lors de l’ajout de fonctionnalités d’insertion pour le contrôle GridView, nous sommes doit décider sur comment les nouveaux enregistrements sera ajoutée, création de l’interface d’insertion et écrire le code pour insérer le nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="48913-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="48913-114">Dans ce didacticiel, que nous examinerons d’ajout de l’interface d’insertion pour le pied de page s GridView de lignes (voir Figure 1).</span><span class="sxs-lookup"><span data-stu-id="48913-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="48913-115">La cellule de pied de page pour chaque colonne inclut les données appropriées collection élément d’interface utilisateur (une zone de texte pour le nom du produit s, un DropDownList pour le fournisseur et ainsi de suite).</span><span class="sxs-lookup"><span data-stu-id="48913-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="48913-116">Nous avons également besoin d’une colonne pour un ajout bouton qui, d’un clic, entraîne une publication (postback) et insérer un nouvel enregistrement dans le `Products` table en utilisant les valeurs fournies dans la ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="48913-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="48913-117">[![La ligne de pied de page fournit une Interface pour l’ajout de nouveaux produits](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="48913-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="48913-118">**Figure 1**: La ligne de pied de page fournit une Interface pour l’ajout de nouveaux produits ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="48913-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="48913-119">Étape 1 : Affichage des informations sur les produits dans un GridView</span><span class="sxs-lookup"><span data-stu-id="48913-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="48913-120">Avant de nous nous-mêmes concernent à la création de l’interface d’insertion dans le pied de page s GridView, permettent de concentrer tout d’abord de s sur l’ajout d’un GridView à la page qui répertorie les produits dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="48913-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="48913-121">Commencez par ouvrir le `InsertThroughFooter.aspx` page dans le `EnhancedGridView` dossier et faites glisser un GridView à partir de la boîte à outils vers le concepteur, en définissant le s GridView `ID` propriété `Products`.</span><span class="sxs-lookup"><span data-stu-id="48913-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="48913-122">Ensuite, utilisez la balise active de s GridView pour lier à un nouveau ObjectDataSource nommé `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="48913-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="48913-123">[![Créer un nouveau ObjectDataSource nommé ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="48913-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="48913-124">**Figure 2**: Créer une nouvelle nommée de ObjectDataSource `ProductsDataSource` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="48913-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>

<span data-ttu-id="48913-125">Configurer l’ObjectDataSource à utiliser le `ProductsBLL` classe s `GetProducts()` méthode pour récupérer des informations de produit.</span><span class="sxs-lookup"><span data-stu-id="48913-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="48913-126">Pour ce didacticiel, vous permettre s strictement sur l’ajout de fonctionnalités de l’insertion et ne vous inquiétez pas sur la modification et suppression.</span><span class="sxs-lookup"><span data-stu-id="48913-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="48913-127">Par conséquent, assurez-vous que la liste déroulante dans l’onglet Insertion a la valeur `AddProduct()` et que les listes déroulantes dans les onglets UPDATE et DELETE sont définis sur (aucun).</span><span class="sxs-lookup"><span data-stu-id="48913-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="48913-128">[![Mapper la méthode AddProduct à la méthode de Insert() s ObjectDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="48913-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="48913-129">**Figure 3**: Carte le `AddProduct` méthode au s ObjectDataSource `Insert()` (méthode) ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="48913-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="48913-130">[![Définir les listes déroulantes de mise à jour et supprimer les tabulations à (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="48913-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="48913-131">**Figure 4**: La valeur est la mise à jour et supprimer des onglets liste déroulante répertorie (aucun) ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="48913-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>

<span data-ttu-id="48913-132">À l’issue de l’Assistant Configurer la Source de données de s ObjectDataSource, Visual Studio ajoute automatiquement les champs pour le contrôle GridView pour chacun des champs de données correspondante.</span><span class="sxs-lookup"><span data-stu-id="48913-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="48913-133">Pour l’instant, laissez tous les champs ajoutés par Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="48913-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="48913-134">Plus loin dans ce didacticiel, nous allons revenir et supprimer certains des champs dont les valeurs n t doivent être spécifiés lors de l’ajout d’un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="48913-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="48913-135">Dans la mesure où il existe près de 80 produits dans la base de données, un utilisateur sera peut-être faire défiler jusqu’au bas de la page web afin d’ajouter un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="48913-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="48913-136">Par conséquent, vous permettent à s pour activer la pagination rendre l’interface insertion plus visible et accessible.</span><span class="sxs-lookup"><span data-stu-id="48913-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="48913-137">Pour activer la pagination, simplement cocher la case à cocher Activer la pagination de la balise active de s GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="48913-138">À ce stade, le balisage déclaratif s GridView et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="48913-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="48913-139">[![Tous les champs de données de produit sont affichés dans un GridView de réserve paginée](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="48913-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="48913-140">**Figure 5**: Tous les champs de données de produit sont affichés dans un GridView paginée ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="48913-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="48913-141">Étape 2 : Ajout d’une ligne de pied de page</span><span class="sxs-lookup"><span data-stu-id="48913-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="48913-142">Ainsi que son en-tête et les lignes de données, le contrôle GridView inclut une ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="48913-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="48913-143">Les lignes d’en-tête et pied de page sont affichées en fonction des valeurs de la s GridView [ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) et [ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) propriétés.</span><span class="sxs-lookup"><span data-stu-id="48913-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="48913-144">Pour afficher la ligne de pied de page, il suffit de définir la `ShowFooter` propriété `True`.</span><span class="sxs-lookup"><span data-stu-id="48913-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="48913-145">Comme le montre la Figure 6, définissant le `ShowFooter` propriété `True` ajoute une ligne de pied de page à la grille.</span><span class="sxs-lookup"><span data-stu-id="48913-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>

<span data-ttu-id="48913-146">[![Pour afficher la ligne de pied de page, la valeur ShowFooter True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="48913-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="48913-147">**Figure 6**: Pour afficher la ligne de pied de page, définissez `ShowFooter` à `True` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="48913-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="48913-148">Notez que la ligne de pied de page a une couleur d’arrière-plan rouge foncé.</span><span class="sxs-lookup"><span data-stu-id="48913-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="48913-149">Cela est dû le DataWebControls thème, nous avons créé et appliqué à toutes les pages dans le [affichant les données avec ObjectDataSource the](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="48913-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="48913-150">Plus précisément, le `GridView.skin` fichier configure le `FooterStyle` propriété telle qu’elle utilise le `FooterStyle` classe CSS.</span><span class="sxs-lookup"><span data-stu-id="48913-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="48913-151">Le `FooterStyle` classe est définie dans `Styles.css` comme suit :</span><span class="sxs-lookup"><span data-stu-id="48913-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="48913-152">Nous ve exploré à l’aide de la ligne de pied de page du GridView s dans les didacticiels précédents.</span><span class="sxs-lookup"><span data-stu-id="48913-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="48913-153">Si nécessaire, vous référer à la [affichant des informations de résumé dans le pied de page du GridView](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) didacticiel pour un petit rappel.</span><span class="sxs-lookup"><span data-stu-id="48913-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>

<span data-ttu-id="48913-154">Après avoir défini le `ShowFooter` propriété `True`, prenez un moment pour afficher la sortie dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="48913-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="48913-155">Actuellement, t n de ligne de pied de page contiennent tout texte ou les contrôles Web.</span><span class="sxs-lookup"><span data-stu-id="48913-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="48913-156">À l’étape 3, nous allons modifier le pied de page pour chaque champ GridView pour qu’elle inclue l’interface d’insertion appropriée.</span><span class="sxs-lookup"><span data-stu-id="48913-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="48913-157">[![La ligne de pied de page vide est affichée au-dessus de la pagination contrôles d’Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="48913-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="48913-158">**Figure 7**: La ligne de pied de page vide est affichée au-dessus de la pagination contrôles d’Interface ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="48913-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="48913-159">Étape 3 : Personnalisation de la ligne de pied de page</span><span class="sxs-lookup"><span data-stu-id="48913-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="48913-160">Dans le [à l’aide de TemplateFields dans le contrôle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) didacticiel, nous avons vu comment considérablement personnaliser l’affichage d’une colonne GridView utilisation de TemplateField (par opposition à BoundFields ou CheckBoxFields) ; dans [ Personnalisation de l’Interface de Modification de données](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) nous avons étudié l’utilisation de TemplateField pour personnaliser l’interface de modification dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="48913-161">Rappel que TemplateField est composé d’un nombre de modèles qui définit la combinaison de balisage, les contrôles Web et la syntaxe de liaison de données utilisé pour certains types de lignes.</span><span class="sxs-lookup"><span data-stu-id="48913-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="48913-162">Le `ItemTemplate`, par exemple, spécifie le modèle utilisé pour les lignes en lecture seule, tandis que le `EditItemTemplate` définit le modèle pour la ligne modifiable.</span><span class="sxs-lookup"><span data-stu-id="48913-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="48913-163">Avec le `ItemTemplate` et `EditItemTemplate`, le TemplateField contenu inclut également un `FooterTemplate` qui spécifie le contenu de la ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="48913-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="48913-164">Par conséquent, nous pouvons ajouter les contrôles Web nécessaires pour chaque champ s insertion d’interface dans le `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="48913-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="48913-165">Pour démarrer, de convertir tous les champs dans le contrôle GridView TemplateField.</span><span class="sxs-lookup"><span data-stu-id="48913-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="48913-166">Cela est possible cliquant sur le lien Modifier les colonnes dans le GridView s balise active, en sélectionnant chaque champ dans l’angle inférieur gauche et en cliquant sur la convertir ce champ en TemplateField lien.</span><span class="sxs-lookup"><span data-stu-id="48913-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![Convertir chaque champ en TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="48913-168">**Figure 8**: Convertir chaque champ en TemplateField</span><span class="sxs-lookup"><span data-stu-id="48913-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="48913-169">En sélectionnant le convertir ce champ en TemplateField transforme le type de champ actuel dans un TemplateField équivalente.</span><span class="sxs-lookup"><span data-stu-id="48913-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="48913-170">Par exemple, chaque BoundField est remplacé par un TemplateField avec un `ItemTemplate` qui contient une étiquette qui affiche le champ de données correspondant et une `EditItemTemplate` qui affiche le champ de données dans une zone de texte.</span><span class="sxs-lookup"><span data-stu-id="48913-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="48913-171">Le `ProductName` BoundField a été converti dans le balisage de TemplateField suivant :</span><span class="sxs-lookup"><span data-stu-id="48913-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="48913-172">De même, le `Discontinued` CheckBoxField a été converti en TemplateField dont `ItemTemplate` et `EditItemTemplate` contiennent un contrôle de case à cocher Web (avec le `ItemTemplate` s case à cocher désactivée).</span><span class="sxs-lookup"><span data-stu-id="48913-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="48913-173">En lecture seule `ProductID` BoundField a été converti en TemplateField avec un contrôle étiquette à la fois dans le `ItemTemplate` et `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="48913-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="48913-174">En bref, champ en TemplateField conversion d’un GridView existant est un moyen simple et rapide pour basculer vers le TemplateField contenu plus personnalisable sans perdre la fonctionnalité de champ s existante.</span><span class="sxs-lookup"><span data-stu-id="48913-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="48913-175">Depuis le contrôle GridView nous re fonctionne avec n t prise en charge la modification, vous pouvez supprimer le `EditItemTemplate` à partir de chaque TemplateField, en laissant seulement le `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="48913-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="48913-176">Après cette opération, votre balisage déclaratif de GridView s doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="48913-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="48913-177">Maintenant que chaque champ GridView a été converti en un TemplateField, nous pouvons saisir l’interface insertion appropriée dans chaque champ s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="48913-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="48913-178">Certains champs n’aura pas d’une interface d’insertion (`ProductID`, par exemple) ; d’autres peuvent varier dans les contrôles Web permet de collecter les nouvelles informations de produit s.</span><span class="sxs-lookup"><span data-stu-id="48913-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="48913-179">Pour créer l’interface de modification, cliquez sur le lien Modifier les modèles à partir de la balise active de s GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="48913-180">Ensuite, dans la liste déroulante, sélectionnez le champ approprié s `FooterTemplate` et faites glisser le contrôle approprié à partir de la boîte à outils vers le concepteur.</span><span class="sxs-lookup"><span data-stu-id="48913-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="48913-181">[![Ajouter l’Interface insertion appropriée à chaque FooterTemplate s de champ](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="48913-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="48913-182">**Figure 9**: Ajouter l’Interface appropriée d’insertion pour chaque champ s `FooterTemplate` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="48913-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>

<span data-ttu-id="48913-183">La liste à puces suivante énumère les champs de GridView, en spécifiant l’interface insertion à ajouter :</span><span class="sxs-lookup"><span data-stu-id="48913-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="48913-184">`ProductID` Aucun.</span><span class="sxs-lookup"><span data-stu-id="48913-184">`ProductID` none.</span></span>
- <span data-ttu-id="48913-185">`ProductName` Ajoutez une zone de texte et définissez son `ID` à `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="48913-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="48913-186">Ajoutez un contrôle RequiredFieldValidator pour vous assurer que l’utilisateur entre une valeur pour le nouveau nom de produit s.</span><span class="sxs-lookup"><span data-stu-id="48913-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="48913-187">`SupplierID` Aucun.</span><span class="sxs-lookup"><span data-stu-id="48913-187">`SupplierID` none.</span></span>
- <span data-ttu-id="48913-188">`CategoryID` Aucun.</span><span class="sxs-lookup"><span data-stu-id="48913-188">`CategoryID` none.</span></span>
- <span data-ttu-id="48913-189">`QuantityPerUnit` Ajouter une zone de texte, en définissant son `ID` à `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="48913-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="48913-190">`UnitPrice` Ajouter une zone de texte nommé `NewUnitPrice` et un CompareValidator qui garantit que la valeur entrée est une valeur monétaire supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="48913-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="48913-191">`UnitsInStock` utiliser une zone de texte dont `ID` est défini sur `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="48913-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="48913-192">Inclure un CompareValidator qui garantit que la valeur entrée est une valeur entière supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="48913-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="48913-193">`UnitsOnOrder` utiliser une zone de texte dont `ID` est défini sur `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="48913-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="48913-194">Inclure un CompareValidator qui garantit que la valeur entrée est une valeur entière supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="48913-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="48913-195">`ReorderLevel` utiliser une zone de texte dont `ID` est défini sur `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="48913-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="48913-196">Inclure un CompareValidator qui garantit que la valeur entrée est une valeur entière supérieure ou égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="48913-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="48913-197">`Discontinued` Ajouter une case à cocher, en définissant son `ID` à `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="48913-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="48913-198">`CategoryName` Ajoutez un contrôle DropDownList et définissez son `ID` à `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="48913-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="48913-199">Lier à un nouveau ObjectDataSource nommé `CategoriesDataSource` et configurez-le pour utiliser le `CategoriesBLL` classe s `GetCategories()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="48913-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="48913-200">Avoir le s DropDownList `ListItem` affichage de s la `CategoryName` données champ, à l’aide de la `CategoryID` champ de données en tant que leurs valeurs.</span><span class="sxs-lookup"><span data-stu-id="48913-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="48913-201">`SupplierName` Ajoutez un contrôle DropDownList et définissez son `ID` à `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="48913-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="48913-202">Lier à un nouveau ObjectDataSource nommé `SuppliersDataSource` et configurez-le pour utiliser le `SuppliersBLL` classe s `GetSuppliers()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="48913-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="48913-203">Avoir le s DropDownList `ListItem` affichage de s la `CompanyName` données champ, à l’aide de la `SupplierID` champ de données en tant que leurs valeurs.</span><span class="sxs-lookup"><span data-stu-id="48913-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="48913-204">Pour chacun des contrôles de validation, effacer le `ForeColor` propriété afin que le `FooterStyle` couleur de premier plan blanc CSS classe s sera utilisé à la place de la valeur par défaut est rouge.</span><span class="sxs-lookup"><span data-stu-id="48913-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="48913-205">Utiliser également le `ErrorMessage` propriété pour une description détaillée, la valeur, mais le `Text` propriété sur un astérisque.</span><span class="sxs-lookup"><span data-stu-id="48913-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="48913-206">Pour éviter que le texte du contrôle s validation à l’origine de l’interface d’insertion à la ligne sur deux lignes, définissez la `FooterStyle` s `Wrap` propriété sur false pour chacun de la `FooterTemplate` qui utilisent un contrôle de validation.</span><span class="sxs-lookup"><span data-stu-id="48913-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="48913-207">Enfin, ajoutez un contrôle ValidationSummary sous les contrôles GridView et ensemble son `ShowMessageBox` propriété `True` et son `ShowSummary` propriété `False`.</span><span class="sxs-lookup"><span data-stu-id="48913-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="48913-208">Lorsque vous ajoutez un nouveau produit, nous devons fournir le `CategoryID` et `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="48913-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="48913-209">Ces informations sont capturées par le biais du DropDownList dans les cellules de pied de page pour le `CategoryName` et `SupplierName` champs.</span><span class="sxs-lookup"><span data-stu-id="48913-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="48913-210">J’ai choisi d’utiliser ces champs, par opposition à la `CategoryID` et `SupplierID` TemplateField, car les lignes de l’utilisateur dans la grille s données est probablement plus intéressé par voir les noms de catégorie et le fournisseur plutôt que leurs valeurs d’identificateur.</span><span class="sxs-lookup"><span data-stu-id="48913-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="48913-211">Dans la mesure où le `CategoryID` et `SupplierID` valeurs sont maintenant capturées dans le `CategoryName` et `SupplierName` interfaces insertion de champ s, nous pouvons supprimer le `CategoryID` et `SupplierID` TemplateFields dans le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="48913-212">De même, le `ProductID` n’est pas utilisé lors de l’ajout d’un nouveau produit, par conséquent, le `ProductID` TemplateField peut être également supprimé.</span><span class="sxs-lookup"><span data-stu-id="48913-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="48913-213">Toutefois, laisser s laisser le `ProductID` champ dans la grille.</span><span class="sxs-lookup"><span data-stu-id="48913-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="48913-214">Outre les zones de texte, DropDownList, les cases à cocher et les contrôles de validation qui composent l’interface d’insertion, nous aurons également besoin d’un ajout bouton qui, lorsque vous cliquez dessus, exécute la logique pour ajouter le nouveau produit à la base de données.</span><span class="sxs-lookup"><span data-stu-id="48913-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="48913-215">À l’étape 4, nous allons inclure un bouton Add dans l’interface d’insertion dans le `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="48913-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="48913-216">N’hésitez pas à améliorer l’apparence des différents champs GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="48913-217">Par exemple, vous souhaiterez peut-être mettre en forme le `UnitPrice` Aligner à droite les valeurs sous forme de devise, la `UnitsInStock`, `UnitsOnOrder`, et `ReorderLevel` champs et mise à jour le `HeaderText` valeurs pour le TemplateField.</span><span class="sxs-lookup"><span data-stu-id="48913-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="48913-218">Après avoir créé la multitude de l’insertion des interfaces dans les `FooterTemplate` s, suppression de la `SupplierID`, et `CategoryID` TemplateField et améliorer l’esthétique de la grille par le biais de mise en forme et l’alignement le TemplateField, votre s GridView déclarative balisage doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="48913-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="48913-219">Lorsqu’ils sont affichés via un navigateur, la ligne de pied de page du GridView s inclut désormais la fin de l’interface insertion (voir Figure 10).</span><span class="sxs-lookup"><span data-stu-id="48913-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="48913-220">À ce stade, l’insertion interface n’inclure un moyen de l’utilisateur indiquer que s she entré les données pour le nouveau produit et qu’il souhaite insérer un nouvel enregistrement dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="48913-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="48913-221">En outre, nous ve encore pour traiter la façon dont les données entrées dans le pied de page seront traduit dans un nouvel enregistrement dans le `Products` base de données.</span><span class="sxs-lookup"><span data-stu-id="48913-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="48913-222">À l’étape 4, nous allons étudier comment inclure un bouton d’ajout à l’interface d’insertion et comment exécuter du code sur publication (postback) quand il s cliqué.</span><span class="sxs-lookup"><span data-stu-id="48913-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="48913-223">Étape 5 montre comment insérer un nouvel enregistrement en utilisant les données dans le pied de page.</span><span class="sxs-lookup"><span data-stu-id="48913-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="48913-224">[![Le pied de page du GridView fournit une Interface pour ajouter un nouvel enregistrement](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="48913-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="48913-225">**Figure 10**: Le pied de page du GridView fournit une Interface pour ajouter un nouvel enregistrement ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="48913-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="48913-226">Étape 4 : Y compris un bouton Ajouter dans l’Interface d’insertion</span><span class="sxs-lookup"><span data-stu-id="48913-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="48913-227">Nous devons inclure un bouton Ajouter quelque part dans l’interface d’insertion dans la mesure où les s de ligne de pied de page insertion interface actuellement ne possède pas les moyens de l’utilisateur indiquer qu’ils ont terminé d’entrer les nouvelles informations de produit s.</span><span class="sxs-lookup"><span data-stu-id="48913-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="48913-228">Cela peut être placée dans un des existant `FooterTemplate` s ou nous pouvons ajouter une nouvelle colonne à la grille à cet effet.</span><span class="sxs-lookup"><span data-stu-id="48913-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="48913-229">Pour ce didacticiel, s permettent de placer le bouton Ajouter dans le `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="48913-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="48913-230">À partir du concepteur, cliquez sur le lien Modifier les modèles dans la balise active de s GridView, puis choisissez le `ProductID` champ s `FooterTemplate` dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="48913-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="48913-231">Ajouter un contrôle bouton Web (ou un LinkButton ou ImageButton, si vous préférez) pour le paramètre de modèle, son ID `AddProduct`, ses `CommandName` INSERT et son `Text` propriété à ajouter comme indiqué dans la Figure 11.</span><span class="sxs-lookup"><span data-stu-id="48913-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="48913-232">[![Placez le bouton Ajouter dans FooterTemplate s ProductID TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="48913-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="48913-233">**Figure 11**: Placez le bouton Ajouter dans le `ProductID` TemplateField s `FooterTemplate` ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="48913-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>

<span data-ttu-id="48913-234">Une fois que vous avez déjà inclus le bouton Ajouter, testez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="48913-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="48913-235">Notez que lorsque vous cliquez sur le bouton Ajouter avec des données non valides dans l’interface d’insertion, la publication (postback) est court-circuitée bref et le contrôle ValidationSummary indique les données non valides (voir Figure 12).</span><span class="sxs-lookup"><span data-stu-id="48913-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="48913-236">Avec les données entrées appropriés, en cliquant sur le bouton Ajouter provoque une publication (postback).</span><span class="sxs-lookup"><span data-stu-id="48913-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="48913-237">Aucun enregistrement n’est ajouté à la base de données, toutefois.</span><span class="sxs-lookup"><span data-stu-id="48913-237">No record is added to the database, however.</span></span> <span data-ttu-id="48913-238">Nous devrons écrire un peu de code pour effectuer l’insertion.</span><span class="sxs-lookup"><span data-stu-id="48913-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="48913-239">[![Le bouton Ajouter publication (postback) est court-circuitée courte s’il existe des données non valides dans l’Interface d’insertion](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="48913-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="48913-240">**Figure 12**: Le bouton Ajouter publication (postback) est court-circuitée courte s’il existe des données non valides dans l’Interface d’insertion ([cliquez pour afficher l’image en taille réelle](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="48913-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="48913-241">Les contrôles de validation dans l’interface d’insertion non affectés à un groupe de validation.</span><span class="sxs-lookup"><span data-stu-id="48913-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="48913-242">Cela fonctionne bien tant que l’interface d’insertion est le jeu uniquement des contrôles de validation sur la page.</span><span class="sxs-lookup"><span data-stu-id="48913-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="48913-243">Si, toutefois, il existe d’autres contrôles de validation sur la page (tels que les contrôles de validation dans l’interface de modification de grille s), les contrôles de validation de l’insertion de l’interface et ajouter le bouton s `ValidationGroup` propriétés doivent être attribuées à la même valeur de manière à associer ces contrôles à un groupe de validation particulier.</span><span class="sxs-lookup"><span data-stu-id="48913-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="48913-244">Consultez [dissection les contrôles de Validation dans ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) pour plus d’informations sur les contrôles de validation et les boutons sur une page de partitionnement des groupes de validation.</span><span class="sxs-lookup"><span data-stu-id="48913-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="48913-245">Étape 5 : Insertion d’un nouvel enregistrement dans le`Products`Table</span><span class="sxs-lookup"><span data-stu-id="48913-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="48913-246">Lorsque vous utilisez les fonctionnalités d’édition intégrées du contrôle GridView, le contrôle GridView gère automatiquement tout le travail nécessaire pour effectuer la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="48913-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="48913-247">En particulier, lorsque le bouton de mise à jour, il copie les valeurs entrées à partir de l’interface de modification aux paramètres dans le s ObjectDataSource `UpdateParameters` collection et intervienne désactiver la mise à jour en appelant le s ObjectDataSource `Update()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="48913-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="48913-248">Dans la mesure où le contrôle GridView ne fournit pas ces fonctionnalités intégrées pour l’insertion, nous devons implémenter le code qui appelle les opérations de mappage ObjectDataSource `Insert()` (méthode) et copie les valeurs à partir de l’insertion de l’interface pour les opérations de mappage ObjectDataSource `InsertParameters` collection .</span><span class="sxs-lookup"><span data-stu-id="48913-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="48913-249">Cette logique d’insertion doit être exécutée une fois que le bouton Ajouter a été cliqué.</span><span class="sxs-lookup"><span data-stu-id="48913-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="48913-250">Comme indiqué dans le [Ajout et réponse à des boutons dans une GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) (didacticiel), chaque fois qu’un bouton, LinkButton ou ImageButton dans une GridView est sélectionné, les opérations de mappage GridView `RowCommand` événement se déclenche lors de la publication.</span><span class="sxs-lookup"><span data-stu-id="48913-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="48913-251">Cet événement se déclenche si le bouton, LinkButton ou ImageButton a été ajouté explicitement telles que le bouton Ajouter dans la ligne de pied de page ou si elle a été automatiquement ajoutée par le contrôle GridView (telles que le type LinkButton en haut de chaque colonne quand activer le tri est sélectionné, ou le Type LinkButton dans l’interface de pagination lorsque vous activez la pagination est activée).</span><span class="sxs-lookup"><span data-stu-id="48913-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="48913-252">Par conséquent, pour répondre à l’utilisateur clique sur le bouton Ajouter, nous devons créer un gestionnaire d’événements pour les opérations de mappage GridView `RowCommand` événement.</span><span class="sxs-lookup"><span data-stu-id="48913-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="48913-253">Dans la mesure où cet événement se déclenche chaque fois que *n’importe quel* bouton, LinkButton ou ImageButton dans le contrôle GridView est activé, il s vital que nous progressons uniquement avec la logique d’insertion si le `CommandName` propriété passé dans les mappages de gestionnaire d’événements pour le `CommandName` valeur du bouton Ajouter (insertion).</span><span class="sxs-lookup"><span data-stu-id="48913-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="48913-254">En outre, nous devons également de continuer seulement si les contrôles de validation signalent des données valides.</span><span class="sxs-lookup"><span data-stu-id="48913-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="48913-255">Pour ce faire, créez un gestionnaire d’événements pour le `RowCommand` événement avec le code suivant :</span><span class="sxs-lookup"><span data-stu-id="48913-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="48913-256">Vous vous demandez peut-être pourquoi le Gestionnaire d’événements dérange vérifiant la `Page.IsValid` propriété.</span><span class="sxs-lookup"><span data-stu-id="48913-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="48913-257">Après tout, la publication (postback) ne sont pas être supprimée si les données non valides sont fournies dans l’interface insertion ?</span><span class="sxs-lookup"><span data-stu-id="48913-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="48913-258">Cette hypothèse est correcte en tant que l’utilisateur n’a pas désactivé JavaScript ou a pris des mesures pour contourner la logique de validation côté client.</span><span class="sxs-lookup"><span data-stu-id="48913-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="48913-259">En bref, un ne doit jamais dépendre strictement validation côté client ; une vérification côté serveur pour la validité doit toujours être effectuée avant de travailler avec les données.</span><span class="sxs-lookup"><span data-stu-id="48913-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="48913-260">À l’étape 1, nous avons créé le `ProductsDataSource` ObjectDataSource telles que son `Insert()` méthode est mappée à la `ProductsBLL` classe s `AddProduct` (méthode).</span><span class="sxs-lookup"><span data-stu-id="48913-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="48913-261">Pour insérer le nouvel enregistrement dans le `Products` table, nous pouvons simplement appeler les opérations de mappage ObjectDataSource `Insert()` méthode :</span><span class="sxs-lookup"><span data-stu-id="48913-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="48913-262">Maintenant que le `Insert()` méthode a été appelée, tout ce qui reste consiste à copier les valeurs à partir de l’interface d’insertion pour les paramètres passés à la `ProductsBLL` classe s `AddProduct` (méthode).</span><span class="sxs-lookup"><span data-stu-id="48913-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="48913-263">Comme nous l’avons vu dans la [examinant les événements associés insertion, mise à jour et suppression](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) didacticiel, cela peut être accompli via le s ObjectDataSource `Inserting` événement.</span><span class="sxs-lookup"><span data-stu-id="48913-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="48913-264">Dans le `Inserting` événement que nous devons référencer par programme les contrôles à partir de la `Products` pied de page s GridView de lignes et d’affecter leurs valeurs à le `e.InputParameters` collection.</span><span class="sxs-lookup"><span data-stu-id="48913-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="48913-265">Si l’utilisateur n’indique pas une valeur telle que de laisser le `ReorderLevel` vide de zone de texte nous devons spécifier que la valeur insérée dans la base de données doit être `NULL`.</span><span class="sxs-lookup"><span data-stu-id="48913-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="48913-266">Dans la mesure où le `AddProducts` méthode accepte les types nullable pour les champs de base de données nullable, simplement utiliser un type nullable et définissez sa valeur sur `Nothing` dans le cas où l’entrée d’utilisateur est omise.</span><span class="sxs-lookup"><span data-stu-id="48913-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="48913-267">Avec le `Inserting` Gestionnaire d’événements terminée, les nouveaux enregistrements peuvent être ajoutés à la `Products` table de base de données par le biais de la ligne de pied de page s GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="48913-268">Continuons et essayez d’ajouter plusieurs nouveaux produits.</span><span class="sxs-lookup"><span data-stu-id="48913-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="48913-269">Amélioration et la personnalisation de l’opération d’ajout</span><span class="sxs-lookup"><span data-stu-id="48913-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="48913-270">Actuellement, en cliquant sur le bouton Ajouter ajoute un nouvel enregistrement à la table de base de données mais ne fournit pas une forme quelconque de rétroaction visuelle que l’enregistrement a été ajoutée.</span><span class="sxs-lookup"><span data-stu-id="48913-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="48913-271">Dans l’idéal, une zone d’alerte Web Label contrôle ou côté client signalerait l’utilisateur qui leur insertion est terminée avec succès.</span><span class="sxs-lookup"><span data-stu-id="48913-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="48913-272">Je laisse cela en guise d’exercice pour le lecteur.</span><span class="sxs-lookup"><span data-stu-id="48913-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="48913-273">Le contrôle GridView utilisé dans ce didacticiel ne s’applique pas n’importe quel ordre de tri pour les produits listés, ni de l’utilisateur final trier les données.</span><span class="sxs-lookup"><span data-stu-id="48913-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="48913-274">Par conséquent, les enregistrements sont classés comme elles se trouvent dans la base de données par leur champ de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="48913-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="48913-275">Étant donné que chaque nouvel enregistrement a un `ProductID` valeur supérieure à la dernière, chaque fois qu’un nouveau produit est ajouté, il a été ajouté à la fin de la grille.</span><span class="sxs-lookup"><span data-stu-id="48913-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="48913-276">Par conséquent, vous souhaiterez envoyer automatiquement l’utilisateur vers la dernière page du contrôle GridView après avoir ajouté un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="48913-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="48913-277">Cela est possible en ajoutant la ligne de code suivante après l’appel à `ProductsDataSource.Insert()` dans le `RowCommand` Gestionnaire d’événements pour indiquer que l’utilisateur doit être envoyés à la dernière page après la liaison des données au GridView :</span><span class="sxs-lookup"><span data-stu-id="48913-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="48913-278">`SendUserToLastPage` est une variable booléenne au niveau des pages qui est initialement affectée à un `False`.</span><span class="sxs-lookup"><span data-stu-id="48913-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="48913-279">Dans le s GridView `DataBound` Gestionnaire d’événements, si `SendUserToLastPage` a la valeur false, le `PageIndex` propriété est mise à jour pour envoyer l’utilisateur vers la dernière page.</span><span class="sxs-lookup"><span data-stu-id="48913-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="48913-280">La raison pour laquelle le `PageIndex` propriété est définie dans le `DataBound` Gestionnaire d’événements (par opposition à la `RowCommand` Gestionnaire d’événements) est, car lorsque la `RowCommand` Gestionnaire d’événements se déclenche nous ve encore pour ajouter le nouvel enregistrement à la `Products` table de base de données.</span><span class="sxs-lookup"><span data-stu-id="48913-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="48913-281">Par conséquent, dans le `RowCommand` Gestionnaire d’événements au dernier index de page (`PageCount - 1`) représente le dernier index de page *avant* le nouveau produit a été ajouté.</span><span class="sxs-lookup"><span data-stu-id="48913-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="48913-282">Pour la majorité des produits en cours d’ajout, le dernier index de page est le même après avoir ajouté le nouveau produit.</span><span class="sxs-lookup"><span data-stu-id="48913-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="48913-283">Mais lorsque le produit ajouté un nouvel index dernière page, si nous mettre à jour correctement la `PageIndex` dans le `RowCommand` Gestionnaire d’événements est alors être dirigés vers le deuxième à la dernière page (le dernier index de page avant d’ajouter le nouveau produit) par opposition à la dernière page nouvelle i ndex.</span><span class="sxs-lookup"><span data-stu-id="48913-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="48913-284">Dans la mesure où le `DataBound` Gestionnaire d’événements est déclenché une fois que le nouveau produit a été ajouté et les données reliées à la grille, en définissant le `PageIndex` propriété il nous savons que nous re bien le dernier index de page corrects.</span><span class="sxs-lookup"><span data-stu-id="48913-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="48913-285">Enfin, le contrôle GridView utilisé dans ce didacticiel est assez long en raison du nombre de champs qui doivent être collectées pour l’ajout d’un nouveau produit.</span><span class="sxs-lookup"><span data-stu-id="48913-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="48913-286">En raison de cette largeur, une disposition verticale de DetailsView s peut être préférée.</span><span class="sxs-lookup"><span data-stu-id="48913-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="48913-287">Les opérations de mappage GridView largeur globale pourrait être réduite en collectant les entrées moins.</span><span class="sxs-lookup"><span data-stu-id="48913-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="48913-288">Peut-être nous n t devoir collecter le `UnitsOnOrder`, `UnitsInStock`, et `ReorderLevel` champs lors de l’ajout d’un nouveau produit, auquel cas ces champs pu être supprimés de la GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="48913-289">Pour ajuster les données collectées, nous pouvons utiliser une des deux approches :</span><span class="sxs-lookup"><span data-stu-id="48913-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="48913-290">Continuer à utiliser le `AddProduct` méthode qui attend des valeurs pour le `UnitsOnOrder`, `UnitsInStock`, et `ReorderLevel` champs.</span><span class="sxs-lookup"><span data-stu-id="48913-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="48913-291">Dans le `Inserting` Gestionnaire d’événements, fournir codées en dur, par défaut des valeurs à utiliser pour ces entrées qui ont été supprimées de l’interface d’insertion.</span><span class="sxs-lookup"><span data-stu-id="48913-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="48913-292">Créer une nouvelle surcharge de la `AddProduct` méthode dans le `ProductsBLL` classe qui n’accepte pas les entrées pour le `UnitsOnOrder`, `UnitsInStock`, et `ReorderLevel` champs.</span><span class="sxs-lookup"><span data-stu-id="48913-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="48913-293">Ensuite, dans la page ASP.NET, configurez l’ObjectDataSource pour utiliser cette nouvelle surcharge.</span><span class="sxs-lookup"><span data-stu-id="48913-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="48913-294">Soit l’option fonctionnera tout aussi également.</span><span class="sxs-lookup"><span data-stu-id="48913-294">Either option will work equally as well.</span></span> <span data-ttu-id="48913-295">Dans au-delà de didacticiels nous avons utilisé cette dernière option, la création de plusieurs surcharges pour les `ProductsBLL` classe s `UpdateProduct` (méthode).</span><span class="sxs-lookup"><span data-stu-id="48913-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="48913-296">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="48913-296">Summary</span></span>

<span data-ttu-id="48913-297">Le contrôle GridView ne dispose pas de fonctionnalités intégrées d’insertion trouvées dans le contrôle DetailsView et FormView, mais avec un peu d’effort, une interface d’insertion peut être ajoutée à la ligne de pied de page.</span><span class="sxs-lookup"><span data-stu-id="48913-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="48913-298">Pour afficher la ligne de pied de page dans un GridView simplement définie son `ShowFooter` propriété `True`.</span><span class="sxs-lookup"><span data-stu-id="48913-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="48913-299">Le contenu de ligne de pied de page peut être personnalisé pour chaque champ en convertissant le champ en TemplateField et ajout de l’insertion de l’interface pour le `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="48913-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="48913-300">Comme nous l’avons vu dans ce didacticiel, le `FooterTemplate` peut contenir des boutons, zones de texte, DropDownList, les cases à cocher, les contrôles de source de données pour le remplissage de piloté par les données des contrôles Web (par exemple, DropDownList) et les contrôles de validation.</span><span class="sxs-lookup"><span data-stu-id="48913-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="48913-301">En même temps que les contrôles pour la collecte de l’entrée utilisateur s, un bouton Ajouter, LinkButton ou ImageButton est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="48913-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="48913-302">Lorsque vous cliquez sur le bouton Ajouter, les opérations de mappage ObjectDataSource `Insert()` méthode est appelée pour démarrer le workflow d’insertion.</span><span class="sxs-lookup"><span data-stu-id="48913-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="48913-303">ObjectDataSource appelle ensuite la méthode d’insertion configuré (le `ProductsBLL` classe s `AddProduct` (méthode), dans ce didacticiel).</span><span class="sxs-lookup"><span data-stu-id="48913-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="48913-304">Nous devons également copier les valeurs à partir de la s GridView insertion d’interface pour les opérations de mappage ObjectDataSource `InsertParameters` collection avant la méthode d’insertion invoquée.</span><span class="sxs-lookup"><span data-stu-id="48913-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="48913-305">Cela est possible en référençant par programmation les contrôles de Web interface insertion dans le s ObjectDataSource `Inserting` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="48913-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="48913-306">Ce didacticiel terminé notre examen des techniques permettant d’améliorer l’apparence de s GridView.</span><span class="sxs-lookup"><span data-stu-id="48913-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="48913-307">L’ensemble suivant de didacticiels examine comment travailler avec des données binaires telles que des images, fichiers PDF, des documents Word et ainsi de suite et les contrôles Web de données.</span><span class="sxs-lookup"><span data-stu-id="48913-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="48913-308">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="48913-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="48913-309">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="48913-309">About the Author</span></span>

<span data-ttu-id="48913-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="48913-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="48913-311">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="48913-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="48913-312">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="48913-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="48913-313">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="48913-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="48913-314">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="48913-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="48913-315">Remerciements</span><span class="sxs-lookup"><span data-stu-id="48913-315">Special Thanks To</span></span>

<span data-ttu-id="48913-316">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="48913-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="48913-317">Entraîner un réviseur pour ce didacticiel a été Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="48913-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="48913-318">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="48913-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="48913-319">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="48913-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="48913-320">Précédent</span><span class="sxs-lookup"><span data-stu-id="48913-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
