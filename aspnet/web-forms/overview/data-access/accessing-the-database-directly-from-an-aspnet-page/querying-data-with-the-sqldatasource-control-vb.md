---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
title: Interrogation des données avec le contrôle SqlDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Dans les didacticiels précédents, nous avons utilisé le contrôle ObjectDataSource pour séparer entièrement la couche de présentation de la couche d’accès aux données. À partir de ce...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: b12f752d-3502-40a4-b695-fc7b7d08cfd3
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 199ddb46e877c3a0937672d33241a240660684da
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74606048"
---
# <a name="querying-data-with-the-sqldatasource-control-vb"></a><span data-ttu-id="dedc6-104">Interrogation des données avec le contrôle SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="dedc6-104">Querying Data with the SqlDataSource Control (VB)</span></span>

<span data-ttu-id="dedc6-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="dedc6-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="dedc6-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) ou [Télécharger le PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="dedc6-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span></span>

> <span data-ttu-id="dedc6-107">Dans les didacticiels précédents, nous avons utilisé le contrôle ObjectDataSource pour séparer entièrement la couche de présentation de la couche d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="dedc6-108">À partir de ce didacticiel, nous allons découvrir comment le contrôle SqlDataSource peut être utilisé pour les applications simples qui ne nécessitent pas une telle séparation stricte de la présentation et de l’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>

## <a name="introduction"></a><span data-ttu-id="dedc6-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="dedc6-109">Introduction</span></span>

<span data-ttu-id="dedc6-110">Tous les didacticiels que nous avons examinés jusqu’à présent ont utilisé une architecture à plusieurs niveaux composée de couches de présentation, de logique métier et d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="dedc6-111">La couche DAL (Data Access Layer) a été créée dans le premier didacticiel ([création d’une couche d’accès aux données](../introduction/creating-a-data-access-layer-vb.md)) et la couche de logique métier dans la seconde ([création d’une couche de logique métier](../introduction/creating-a-business-logic-layer-vb.md)).</span><span class="sxs-lookup"><span data-stu-id="dedc6-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md)).</span></span> <span data-ttu-id="dedc6-112">À partir du didacticiel sur l' [affichage des données avec ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) , nous avons vu comment utiliser le nouveau contrôle objectdatasource d’ASP.NET 2,0 s pour interagir de manière déclarative avec l’architecture de la couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="dedc6-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="dedc6-113">Bien que tous les didacticiels jusqu’à présent aient utilisé l’architecture pour travailler avec les données, il est également possible d’accéder, d’insérer, de mettre à jour et de supprimer des données de base de données directement à partir d’une page ASP.NET, en ignorant l’architecture.</span><span class="sxs-lookup"><span data-stu-id="dedc6-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="dedc6-114">Cela place les requêtes de base de données et la logique métier spécifiques directement dans la page Web.</span><span class="sxs-lookup"><span data-stu-id="dedc6-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="dedc6-115">Pour les applications suffisamment volumineuses ou complexes, la conception, l’implémentation et l’utilisation d’une architecture à plusieurs niveaux sont vitales pour la réussite, la mise à jour et la maintenabilité de l’application.</span><span class="sxs-lookup"><span data-stu-id="dedc6-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="dedc6-116">Toutefois, le développement d’une architecture robuste peut ne pas être nécessaire lors de la création d’applications uniques et extrêmement simples.</span><span class="sxs-lookup"><span data-stu-id="dedc6-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="dedc6-117">ASP.NET 2,0 fournit cinq contrôles de source de données intégrés : [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx)et [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="dedc6-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="dedc6-118">Le SqlDataSource peut être utilisé pour accéder et modifier des données directement à partir d’une base de données relationnelle, y compris Microsoft SQL Server, Microsoft Access, Oracle, MySQL, etc.</span><span class="sxs-lookup"><span data-stu-id="dedc6-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="dedc6-119">Dans ce didacticiel et les trois suivants, nous allons examiner comment utiliser le contrôle SqlDataSource, comment interroger et filtrer les données de la base de données, ainsi que comment utiliser le SqlDataSource pour insérer, mettre à jour et supprimer des données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>

![ASP.NET 2,0 comprend cinq contrôles de source de données intégrés.](querying-data-with-the-sqldatasource-control-vb/_static/image1.gif)

<span data-ttu-id="dedc6-121">**Figure 1**: ASP.NET 2,0 comprend cinq contrôles de source de données intégrés</span><span class="sxs-lookup"><span data-stu-id="dedc6-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="dedc6-122">Comparaison des ObjectDataSource et SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="dedc6-123">Conceptuellement, les contrôles ObjectDataSource et SqlDataSource sont simplement des proxies de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="dedc6-124">Comme indiqué dans le didacticiel [affichage des données avec ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) , l’ObjectDataSource possède des propriétés qui indiquent le type d’objet qui fournit les données et les méthodes à appeler pour sélectionner, insérer, mettre à jour et supprimer des données du type d’objet sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="dedc6-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="dedc6-125">Une fois que les propriétés ObjectDataSource s ont été configurées, un contrôle Web de données tel qu’un contrôle GridView, DetailsView ou DataList peut être lié au contrôle à l’aide de la `Select()`ObjectDataSource s, `Insert()`, `Delete()`et `Update()` méthodes pour interagir avec l’architecture sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="dedc6-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="dedc6-126">Le SqlDataSource offre les mêmes fonctionnalités, mais fonctionne sur une base de données relationnelle plutôt que sur une bibliothèque d’objets.</span><span class="sxs-lookup"><span data-stu-id="dedc6-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="dedc6-127">Avec le SqlDataSource, nous devons spécifier la chaîne de connexion de la base de données et les requêtes SQL ou les procédures stockées ad hoc à exécuter pour insérer, mettre à jour, supprimer et récupérer des données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="dedc6-128">Les méthodes SqlDataSource s `Select()`, `Insert()`, `Update()`et `Delete()`, lorsqu’elles sont appelées, se connectent à la base de données spécifiée et émettent la requête SQL appropriée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="dedc6-129">Comme le montre le diagramme suivant, ces méthodes effectuent le travail grunt pour se connecter à une base de données, émettre une requête et retourner les résultats.</span><span class="sxs-lookup"><span data-stu-id="dedc6-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>

![Le SqlDataSource sert de proxy à la base de données](querying-data-with-the-sqldatasource-control-vb/_static/image2.gif)

<span data-ttu-id="dedc6-131">**Figure 2**: le SqlDataSource sert de proxy à la base de données</span><span class="sxs-lookup"><span data-stu-id="dedc6-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>

> [!NOTE]
> <span data-ttu-id="dedc6-132">Dans ce didacticiel, nous allons nous concentrer sur la récupération des données de la base de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="dedc6-133">Dans le didacticiel sur l' [insertion, la mise à jour et la suppression de données avec le contrôle SqlDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) , nous verrons comment configurer le SqlDataSource pour prendre en charge l’insertion, la mise à jour et la suppression.</span><span class="sxs-lookup"><span data-stu-id="dedc6-133">In the [Inserting, Updating, and Deleting Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>

## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="dedc6-134">Contrôles SqlDataSource et AccessDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="dedc6-135">En plus du contrôle SqlDataSource, ASP.NET 2,0 comprend également un contrôle AccessDataSource.</span><span class="sxs-lookup"><span data-stu-id="dedc6-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="dedc6-136">Ces deux contrôles différents conduisent de nombreux développeurs à ASP.NET 2,0 à soupçonner que le contrôle AccessDataSource est conçu pour fonctionner exclusivement avec Microsoft Access avec le contrôle SqlDataSource conçu pour fonctionner exclusivement avec Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="dedc6-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="dedc6-137">Si le contrôle AccessDataSource est conçu pour fonctionner spécifiquement avec Microsoft Access, le contrôle SqlDataSource fonctionne avec *n’importe quelle* base de données relationnelle accessible via .net.</span><span class="sxs-lookup"><span data-stu-id="dedc6-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="dedc6-138">Cela comprend tous les magasins de données compatibles OleDb ou ODBC, tels que Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL et PostgreSQL, entre autres.</span><span class="sxs-lookup"><span data-stu-id="dedc6-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="dedc6-139">La seule différence entre les contrôles AccessDataSource et SqlDataSource est la façon dont les informations de connexion à la base de données sont spécifiées.</span><span class="sxs-lookup"><span data-stu-id="dedc6-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="dedc6-140">Le contrôle AccessDataSource a uniquement besoin du chemin d’accès au fichier de base de données Access.</span><span class="sxs-lookup"><span data-stu-id="dedc6-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="dedc6-141">En revanche, le SqlDataSource requiert une chaîne de connexion complète.</span><span class="sxs-lookup"><span data-stu-id="dedc6-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="dedc6-142">Étape 1 : création des pages Web SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="dedc6-143">Avant de commencer à explorer la manière de travailler directement avec les données de base de données à l’aide du contrôle SqlDataSource, commençons par prendre un moment pour créer les pages ASP.NET dans notre projet de site Web dont nous aurons besoin pour ce didacticiel et les trois prochaines.</span><span class="sxs-lookup"><span data-stu-id="dedc6-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="dedc6-144">Commencez par ajouter un nouveau dossier nommé `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="dedc6-145">Ajoutez ensuite les pages ASP.NET suivantes à ce dossier, en veillant à associer chaque page à la page maître `Site.master` :</span><span class="sxs-lookup"><span data-stu-id="dedc6-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`

![Ajouter les pages ASP.NET pour les didacticiels liés à SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image3.gif)

<span data-ttu-id="dedc6-147">**Figure 3**: ajouter les pages ASP.net pour les didacticiels relatifs à SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>

<span data-ttu-id="dedc6-148">Comme dans les autres dossiers, `Default.aspx` dans le dossier `SqlDataSource` répertorie les didacticiels de la section.</span><span class="sxs-lookup"><span data-stu-id="dedc6-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="dedc6-149">N’oubliez pas que le contrôle utilisateur `SectionLevelTutorialListing.ascx` fournit cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="dedc6-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="dedc6-150">Par conséquent, ajoutez ce contrôle utilisateur à `Default.aspx` en le faisant glisser de l’Explorateur de solutions sur la page s Mode Création.</span><span class="sxs-lookup"><span data-stu-id="dedc6-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="dedc6-151">[![ajouter le contrôle utilisateur SectionLevelTutorialListing. ascx à default. aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="dedc6-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span></span>

<span data-ttu-id="dedc6-152">**Figure 4**: ajouter le contrôle utilisateur `SectionLevelTutorialListing.ascx` à `Default.aspx` ([cliquez pour afficher l’image en taille réelle](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="dedc6-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span></span>

<span data-ttu-id="dedc6-153">Enfin, ajoutez ces quatre pages en tant qu’entrées au fichier `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="dedc6-154">Plus précisément, ajoutez le balisage suivant après avoir ajouté les boutons personnalisés aux `<siteMapNode>`de contrôle DataList et Repeater :</span><span class="sxs-lookup"><span data-stu-id="dedc6-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample1.sql)]

<span data-ttu-id="dedc6-155">Après avoir mis à jour `Web.sitemap`, prenez un moment pour afficher le site Web des didacticiels via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="dedc6-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="dedc6-156">Le menu à gauche contient maintenant des éléments pour les didacticiels de modification, d’insertion et de suppression.</span><span class="sxs-lookup"><span data-stu-id="dedc6-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![Le plan de site comprend désormais des entrées pour les didacticiels de SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image7.gif)

<span data-ttu-id="dedc6-158">**Figure 5**: le plan de site contient maintenant des entrées pour les didacticiels SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="dedc6-159">Étape 2 : ajout et configuration du contrôle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="dedc6-160">Commencez par ouvrir la page `Querying.aspx` dans le dossier `SqlDataSource` et basculez vers Mode Création.</span><span class="sxs-lookup"><span data-stu-id="dedc6-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="dedc6-161">Faites glisser un contrôle SqlDataSource de la boîte à outils vers le concepteur et affectez à son `ID` la valeur `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="dedc6-162">Comme avec ObjectDataSource, le SqlDataSource ne produit pas de sortie rendue et apparaît donc sous la forme d’une zone grise sur l’aire de conception.</span><span class="sxs-lookup"><span data-stu-id="dedc6-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="dedc6-163">Pour configurer le SqlDataSource, cliquez sur le lien configurer la source de données dans la balise active SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="dedc6-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>

![Cliquez sur le lien configurer la source de données dans la balise active SqlDataSource s.](querying-data-with-the-sqldatasource-control-vb/_static/image8.gif)

<span data-ttu-id="dedc6-165">**Figure 6**: cliquer sur le lien configurer la source de données dans la balise active SqlDataSource s</span><span class="sxs-lookup"><span data-stu-id="dedc6-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>

<span data-ttu-id="dedc6-166">L’Assistant contrôle de la source de données s’affiche.</span><span class="sxs-lookup"><span data-stu-id="dedc6-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="dedc6-167">Bien que les étapes de l’Assistant diffèrent des contrôles ObjectDataSource, l’objectif final est le même pour fournir des détails sur la récupération, l’insertion, la mise à jour et la suppression de données via la source de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="dedc6-168">Pour le SqlDataSource, cela implique de spécifier la base de données sous-jacente à utiliser et de fournir les instructions SQL ou les procédures stockées ad hoc.</span><span class="sxs-lookup"><span data-stu-id="dedc6-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="dedc6-169">La première étape de l’Assistant nous invite à entrer la base de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="dedc6-170">La liste déroulante comprend les bases de données qui se trouvent dans le dossier application Web s `App_Data` et celles qui ont été ajoutées au nœud Connexions de données dans la Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="dedc6-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="dedc6-171">Étant donné que nous avons déjà ajouté une chaîne de connexion pour la base de données `NORTHWIND.MDF` dans le dossier `App_Data` à notre fichier de `Web.config` de projet, la liste déroulante contient une référence à cette chaîne de connexion, `NORTHWINDConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="dedc6-172">Choisissez cet élément dans la liste déroulante, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="dedc6-172">Choose this item from the drop-down list and click Next.</span></span>

![Choisissez le NORTHWINDConnectionString dans la liste déroulante](querying-data-with-the-sqldatasource-control-vb/_static/image9.gif)

<span data-ttu-id="dedc6-174">**Figure 7**: choisir la `NORTHWINDConnectionString` dans la liste déroulante</span><span class="sxs-lookup"><span data-stu-id="dedc6-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>

<span data-ttu-id="dedc6-175">Après avoir choisi la base de données, l’Assistant vous demande de renvoyer les données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="dedc6-176">Nous pouvons soit spécifier les colonnes d’une table ou d’une vue à renvoyer, soit entrer une instruction SQL personnalisée ou spécifier une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="dedc6-177">Vous pouvez basculer entre ce choix à l’aide des cases d’option spécifier une instruction SQL personnalisée ou une procédure stockée et spécifier des colonnes à partir d’une table ou d’une vue.</span><span class="sxs-lookup"><span data-stu-id="dedc6-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="dedc6-178">Pour le premier exemple, utilisez l’option spécifier les colonnes à partir d’une table ou d’une vue.</span><span class="sxs-lookup"><span data-stu-id="dedc6-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="dedc6-179">Nous reviendrons à l’Assistant plus loin dans ce didacticiel et explorons l’option spécifier une instruction SQL personnalisée ou une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>

<span data-ttu-id="dedc6-180">La figure 8 montre l’écran configurer l’instruction SELECT lorsque la case d’option spécifier les colonnes d’une table ou d’une vue est cochée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="dedc6-181">La liste déroulante contient l’ensemble des tables et des vues de la base de données Northwind, avec les colonnes de la table ou de la vue sélectionnée répertoriées dans la liste de cases à cocher ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="dedc6-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="dedc6-182">Pour cet exemple, nous allons retourner les colonnes `ProductID`, `ProductName`et `UnitPrice` de la table `Products`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="dedc6-183">Comme le montre la figure 8, après avoir effectué ces sélections, l’Assistant affiche l’instruction SQL qui en résulte `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>

![Retourner des données de la table Products](querying-data-with-the-sqldatasource-control-vb/_static/image10.gif)

<span data-ttu-id="dedc6-185">**Figure 8**: retourner des données à partir de la table `Products`</span><span class="sxs-lookup"><span data-stu-id="dedc6-185">**Figure 8**: Return Data from the `Products` Table</span></span>

<span data-ttu-id="dedc6-186">Une fois que vous avez configuré l’Assistant pour retourner les colonnes `ProductID`, `ProductName`et `UnitPrice` de la table `Products`, cliquez sur le bouton suivant.</span><span class="sxs-lookup"><span data-stu-id="dedc6-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="dedc6-187">Cet écran final donne la possibilité d’examiner les résultats de la requête configurée à partir de l’étape précédente.</span><span class="sxs-lookup"><span data-stu-id="dedc6-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="dedc6-188">En cliquant sur le bouton tester la requête, vous exécutez l’instruction `SELECT` configurée et affiche les résultats dans une grille.</span><span class="sxs-lookup"><span data-stu-id="dedc6-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>

![Cliquez sur le bouton tester la requête pour passer en revue votre requête SELECT](querying-data-with-the-sqldatasource-control-vb/_static/image11.gif)

<span data-ttu-id="dedc6-190">**Figure 9**: cliquer sur le bouton tester la requête pour passer en revue votre requête `SELECT`</span><span class="sxs-lookup"><span data-stu-id="dedc6-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>

<span data-ttu-id="dedc6-191">Pour mettre fin à l'Assistant, cliquez sur Terminer.</span><span class="sxs-lookup"><span data-stu-id="dedc6-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="dedc6-192">Comme avec ObjectDataSource, l’Assistant SqlDataSource s affecte simplement des valeurs aux propriétés du contrôle, à savoir les propriétés [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) et [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) .</span><span class="sxs-lookup"><span data-stu-id="dedc6-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="dedc6-193">Une fois l’exécution de l’Assistant terminée, le balisage déclaratif de votre contrôle SqlDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="dedc6-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample2.aspx)]

<span data-ttu-id="dedc6-194">La propriété `ConnectionString` fournit des informations sur la façon de se connecter à la base de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="dedc6-195">Cette propriété peut être assignée à une valeur de chaîne de connexion complète, codée en dur ou peut pointer vers une chaîne de connexion dans `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="dedc6-196">Pour référencer une valeur de chaîne de connexion dans Web. config, utilisez la syntaxe `<%$ expressionPrefix:expressionValue %>`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="dedc6-197">En général, *expressionPrefix* est connectionStrings et *expressionValue* est le nom de la chaîne de connexion dans la [section `Web.config``<connectionStrings>`](https://msdn.microsoft.com/library/bf7sd233.aspx).</span><span class="sxs-lookup"><span data-stu-id="dedc6-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="dedc6-198">Toutefois, la syntaxe peut être utilisée pour référencer des éléments de `<appSettings>` ou du contenu à partir de fichiers de ressources.</span><span class="sxs-lookup"><span data-stu-id="dedc6-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="dedc6-199">Pour plus d’informations sur cette syntaxe, consultez [vue d’ensemble des Expressions ASP.net](https://msdn.microsoft.com/library/d5bd1tad.aspx) .</span><span class="sxs-lookup"><span data-stu-id="dedc6-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="dedc6-200">La propriété `SelectCommand` spécifie l’instruction SQL ou la procédure stockée ad hoc à exécuter pour retourner les données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="dedc6-201">Étape 3 : ajout d’un contrôle Web de données et liaison de celui-ci au SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="dedc6-202">Une fois que le SqlDataSource a été configuré, il peut être lié à un contrôle Web de données, tel qu’un GridView ou DetailsView.</span><span class="sxs-lookup"><span data-stu-id="dedc6-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="dedc6-203">Pour ce didacticiel, vous allez afficher les données dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="dedc6-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="dedc6-204">À partir de la boîte à outils, faites glisser un contrôle GridView sur la page et liez-le au `ProductsDataSource` SqlDataSource en choisissant la source de données dans la liste déroulante de la balise active GridView s.</span><span class="sxs-lookup"><span data-stu-id="dedc6-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>

<span data-ttu-id="dedc6-205">[![ajouter un GridView et le lier au contrôle SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="dedc6-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span></span>

<span data-ttu-id="dedc6-206">**Figure 10**: ajouter un GridView et le lier au contrôle SqlDataSource ([cliquez pour afficher l’image en taille réelle](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="dedc6-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span></span>

<span data-ttu-id="dedc6-207">Une fois que vous avez sélectionné le contrôle SqlDataSource dans la liste déroulante de la balise active GridView s, Visual Studio ajoute automatiquement un BoundField ou un CheckBoxField au GridView pour chacune des colonnes retournées par le contrôle de source de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="dedc6-208">Étant donné que le SqlDataSource retourne trois colonnes de base de données `ProductID`, `ProductName`et `UnitPrice` il y a trois champs dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="dedc6-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="dedc6-209">Prenez un moment pour configurer le contrôle GridView s trois BoundFields.</span><span class="sxs-lookup"><span data-stu-id="dedc6-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="dedc6-210">Remplacez la valeur de la propriété `ProductName` champ s `HeaderText` par le nom du produit et le champ `UnitPrice` s par Price.</span><span class="sxs-lookup"><span data-stu-id="dedc6-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="dedc6-211">Mettez également en forme le champ `UnitPrice` en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="dedc6-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="dedc6-212">Une fois ces modifications apportées, votre balisage déclaratif s doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="dedc6-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample3.aspx)]

<span data-ttu-id="dedc6-213">Visitez cette page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="dedc6-213">Visit this page through a browser.</span></span> <span data-ttu-id="dedc6-214">Comme le montre la figure 11, le contrôle GridView répertorie chaque produit `ProductID`, `ProductName`et `UnitPrice` valeurs.</span><span class="sxs-lookup"><span data-stu-id="dedc6-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>

<span data-ttu-id="dedc6-215">[![le contrôle GridView affiche les valeurs ProductID, ProductName et UnitPrice de chaque produit](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="dedc6-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span></span>

<span data-ttu-id="dedc6-216">**Figure 11**: le contrôle GridView affiche les valeurs de `ProductID`, `ProductName`et `UnitPrice` du produit ([cliquez pour afficher l’image en taille réelle](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="dedc6-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span></span>

<span data-ttu-id="dedc6-217">Quand la page est visitée, le contrôle GridView appelle sa méthode `Select()` de contrôle de source de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="dedc6-218">Lors de l’utilisation du contrôle ObjectDataSource, il s’agit de la méthode `ProductsBLL` classe s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="dedc6-219">Toutefois, avec le SqlDataSource, la méthode `Select()` établit une connexion à la base de données spécifiée et émet le `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, dans cet exemple).</span><span class="sxs-lookup"><span data-stu-id="dedc6-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="dedc6-220">Le SqlDataSource retourne ses résultats que le GridView énumère ensuite, en créant une ligne dans le GridView pour chaque enregistrement de base de données retourné.</span><span class="sxs-lookup"><span data-stu-id="dedc6-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="dedc6-221">Fonctionnalités de contrôle Web de données intégrées et le contrôle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="dedc6-222">En général, les fonctionnalités inhérentes aux contrôles Web de données de pagination, de tri, de modification, de suppression, d’insertion, etc. sont spécifiques au contrôle Web de données et ne dépendent pas du contrôle de source de données utilisé.</span><span class="sxs-lookup"><span data-stu-id="dedc6-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="dedc6-223">Autrement dit, le GridView peut utiliser ses fonctionnalités intégrées de pagination, de tri, de modification et de suppression s’il est lié à un ObjectDataSource ou un SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="dedc6-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="dedc6-224">Toutefois, certaines fonctionnalités de contrôle Web de données sont sensibles au contrôle de source de données utilisé ou à la configuration du contrôle de source de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="dedc6-225">Par exemple, dans le didacticiel [pagination efficace de grandes quantités de données](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) , nous avons abordé la manière dont, par défaut, la logique de pagination pour les contrôles Web de données naïvement retourne *tous les* enregistrements de la source de données sous-jacente, puis affiche uniquement le sous-ensemble approprié des enregistrements en fonction de l’index de page actuel et le nombre d’enregistrements à afficher par page.</span><span class="sxs-lookup"><span data-stu-id="dedc6-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="dedc6-226">Ce modèle est très inefficace lors de la pagination de jeux de résultats suffisamment volumineux.</span><span class="sxs-lookup"><span data-stu-id="dedc6-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="dedc6-227">Heureusement, l’ObjectDataSource peut être configuré pour prendre en charge la pagination personnalisée, qui retourne uniquement le sous-ensemble précis des enregistrements à afficher.</span><span class="sxs-lookup"><span data-stu-id="dedc6-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="dedc6-228">Toutefois, le contrôle SqlDataSource ne dispose pas des propriétés permettant d’implémenter une pagination personnalisée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="dedc6-229">Une autre subtilité avec la pagination et le tri survient avec le SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="dedc6-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="dedc6-230">Par défaut, les données retournées par un SqlDataSource peuvent être paginées ou triées via le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="dedc6-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="dedc6-231">Pour illustrer cela, activez les options activer la pagination et activer le tri dans la balise active GridView s dans `Querying.aspx` et vérifier que cela fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="dedc6-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="dedc6-232">Le tri et la pagination fonctionnent car le SqlDataSource récupère les données de la base de données dans un DataSet faiblement typé.</span><span class="sxs-lookup"><span data-stu-id="dedc6-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="dedc6-233">Le nombre total d’enregistrements renvoyés par la requête est un aspect essentiel de la mise en œuvre de la pagination à partir du jeu de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="dedc6-234">En outre, les résultats du jeu de données peuvent être triés par l’intermédiaire d’un DataView.</span><span class="sxs-lookup"><span data-stu-id="dedc6-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="dedc6-235">Ces fonctionnalités sont utilisées automatiquement par le SqlDataSource lorsque le GridView demande des données paginées ou triées.</span><span class="sxs-lookup"><span data-stu-id="dedc6-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="dedc6-236">Le SqlDataSource peut être configuré pour retourner un DataReader au lieu d’un jeu de données en remplaçant sa [propriété`DataSourceMode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) `DataSet` (valeur par défaut) par `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="dedc6-237">L’utilisation d’un DataReader peut être préférable dans les cas où vous passez les résultats du SqlDataSource à un code existant qui attend un DataReader.</span><span class="sxs-lookup"><span data-stu-id="dedc6-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="dedc6-238">En outre, étant donné que les DataReaders sont des objets beaucoup plus simples que les jeux de données, ils offrent de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="dedc6-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="dedc6-239">Toutefois, si vous apportez cette modification, le contrôle Web de données ne peut pas effectuer de tri ou de page, car le SqlDataSource ne peut pas déterminer le nombre d’enregistrements retournés par la requête et le DataReader n’offre aucune technique pour trier les données renvoyées.</span><span class="sxs-lookup"><span data-stu-id="dedc6-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="dedc6-240">Étape 4 : utilisation d’une instruction SQL personnalisée ou d’une procédure stockée</span><span class="sxs-lookup"><span data-stu-id="dedc6-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="dedc6-241">Lors de la configuration du contrôle SqlDataSource, la requête utilisée pour retourner des données peut être spécifiée dans l’une des deux approches comme une instruction SQL personnalisée ou une procédure stockée, ou sous forme de colonnes d’une table ou d’une vue existante.</span><span class="sxs-lookup"><span data-stu-id="dedc6-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="dedc6-242">À l’étape 2, nous avons examiné la sélection des colonnes dans la table `Products`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="dedc6-243">Observons l’utilisation d’une instruction SQL personnalisée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="dedc6-244">Ajoutez un autre contrôle GridView à la page `Querying.aspx` et choisissez de créer une nouvelle source de données dans la liste déroulante de la balise active.</span><span class="sxs-lookup"><span data-stu-id="dedc6-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="dedc6-245">Ensuite, indiquez que les données seront extraites d’une base de données. cette opération créera un nouveau contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="dedc6-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="dedc6-246">Nommez le contrôle `ProductsWithCategoryInfoDataSource`.</span><span class="sxs-lookup"><span data-stu-id="dedc6-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>

![Créer un nouveau contrôle SqlDataSource nommé ProductsWithCategoryInfoDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image18.gif)

<span data-ttu-id="dedc6-248">**Figure 12**: créer un contrôle SqlDataSource nommé `ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="dedc6-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>

<span data-ttu-id="dedc6-249">L’écran suivant nous demande de spécifier la base de données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="dedc6-250">Comme nous l’avons fait à la figure 7, sélectionnez la `NORTHWINDConnectionString` dans la liste déroulante, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="dedc6-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="dedc6-251">Dans l’écran configurer l’instruction SELECT, sélectionnez la case d’option spécifier une instruction SQL personnalisée ou une procédure stockée, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="dedc6-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="dedc6-252">Cela entraîne l’affichage de l’écran définir des instructions personnalisées ou des procédures stockées, qui propose des onglets intitulés sélectionner, mettre à jour, insérer et supprimer.</span><span class="sxs-lookup"><span data-stu-id="dedc6-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="dedc6-253">Dans chaque onglet, vous pouvez entrer une instruction SQL personnalisée dans la zone de texte ou choisir une procédure stockée dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="dedc6-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="dedc6-254">Dans ce didacticiel, nous allons examiner la saisie d’une instruction SQL personnalisée. le didacticiel suivant contient un exemple qui utilise une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>

![Entrer une instruction SQL personnalisée ou choisir une procédure stockée](querying-data-with-the-sqldatasource-control-vb/_static/image19.gif)

<span data-ttu-id="dedc6-256">**Figure 13**: entrer une instruction SQL personnalisée ou choisir une procédure stockée</span><span class="sxs-lookup"><span data-stu-id="dedc6-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>

<span data-ttu-id="dedc6-257">L’instruction SQL personnalisée peut être entrée manuellement dans la zone de texte ou peut être construite graphiquement en cliquant sur le bouton Générateur de requêtes.</span><span class="sxs-lookup"><span data-stu-id="dedc6-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="dedc6-258">À partir de la Générateur de requêtes ou de la zone de texte, utilisez la requête suivante pour retourner les champs `ProductID` et `ProductName` de la table `Products` à l’aide d’un `JOIN` pour récupérer le `CategoryName` du produit à partir de la table `Categories` :</span><span class="sxs-lookup"><span data-stu-id="dedc6-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample4.sql)]

![Vous pouvez construire la requête sous forme graphique à l’aide de l’Générateur de requêtes](querying-data-with-the-sqldatasource-control-vb/_static/image20.gif)

<span data-ttu-id="dedc6-260">**Figure 14**: vous pouvez créer graphiquement la requête à l’aide de l’générateur de requêtes</span><span class="sxs-lookup"><span data-stu-id="dedc6-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>

<span data-ttu-id="dedc6-261">Après avoir spécifié la requête, cliquez sur suivant pour passer à l’écran tester la requête.</span><span class="sxs-lookup"><span data-stu-id="dedc6-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="dedc6-262">Cliquez sur Terminer pour terminer l’Assistant SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="dedc6-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="dedc6-263">Une fois l’exécution de l’Assistant terminée, le GridView aura trois BoundFields ajoutées à celui-ci, qui affiche les colonnes `ProductID`, `ProductName`et `CategoryName` retournées par la requête et qui génèrent le balisage déclaratif suivant :</span><span class="sxs-lookup"><span data-stu-id="dedc6-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample5.aspx)]

<span data-ttu-id="dedc6-264">[![le GridView affiche l’ID, le nom et le nom de la catégorie associée du produit](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="dedc6-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span></span>

<span data-ttu-id="dedc6-265">**Figure 15**: le GridView affiche l’ID, le nom et le nom de la catégorie associée du produit ([cliquez pour afficher l’image en taille réelle](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="dedc6-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span></span>

## <a name="summary"></a><span data-ttu-id="dedc6-266">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="dedc6-266">Summary</span></span>

<span data-ttu-id="dedc6-267">Dans ce didacticiel, nous avons vu comment interroger et afficher les données à l’aide du contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="dedc6-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="dedc6-268">À l’instar de l’ObjectDataSource, le SqlDataSource fait office de proxy, fournissant une approche déclarative de l’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="dedc6-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="dedc6-269">Ses propriétés spécifient la base de données à laquelle se connecter et la requête de `SELECT` SQL à exécuter. ils peuvent être spécifiés par le biais de l’Fenêtre Propriétés ou à l’aide de l’Assistant Configurer la source de donnée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="dedc6-270">Les exemples de requêtes `SELECT` que nous avons examinés dans ce didacticiel ont renvoyé tous les enregistrements de la requête spécifiée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="dedc6-271">Toutefois, le contrôle SqlDataSource peut inclure une clause `WHERE` avec des paramètres dont les valeurs sont assignées par programme ou qui sont automatiquement extraites d’une source spécifiée.</span><span class="sxs-lookup"><span data-stu-id="dedc6-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="dedc6-272">Nous allons examiner comment créer et utiliser des requêtes paramétrables dans le didacticiel suivant.</span><span class="sxs-lookup"><span data-stu-id="dedc6-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="dedc6-273">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="dedc6-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="dedc6-274">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="dedc6-274">Further Reading</span></span>

<span data-ttu-id="dedc6-275">Pour plus d’informations sur les sujets abordés dans ce didacticiel, reportez-vous aux ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="dedc6-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="dedc6-276">Accès aux données de la base de données relationnelle</span><span class="sxs-lookup"><span data-stu-id="dedc6-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="dedc6-277">Vue d’ensemble du contrôle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="dedc6-278">Didacticiels de démarrage rapide ASP.NET : contrôle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="dedc6-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="dedc6-279">Élément `<connectionStrings>` Web. config</span><span class="sxs-lookup"><span data-stu-id="dedc6-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="dedc6-280">Référence de chaîne de connexion de base de données</span><span class="sxs-lookup"><span data-stu-id="dedc6-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="dedc6-281">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="dedc6-281">About the Author</span></span>

<span data-ttu-id="dedc6-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="dedc6-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="dedc6-283">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="dedc6-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="dedc6-284">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="dedc6-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="dedc6-285">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dedc6-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="dedc6-286">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="dedc6-286">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="dedc6-287">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="dedc6-287">Special Thanks To</span></span>

<span data-ttu-id="dedc6-288">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="dedc6-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="dedc6-289">Les réviseurs de leads pour ce didacticiel étaient Suzanne Connery, Bernadette Leigh et David SURU.</span><span class="sxs-lookup"><span data-stu-id="dedc6-289">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="dedc6-290">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="dedc6-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="dedc6-291">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dedc6-291">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="dedc6-292">[Précédent](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
> [Suivant](using-parameterized-queries-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="dedc6-292">[Previous](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
[Next](using-parameterized-queries-with-the-sqldatasource-vb.md)</span></span>
