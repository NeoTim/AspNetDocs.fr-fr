---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
title: Insertion, mise à jour et suppression de données avec le SqlDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Dans les didacticiels précédents, nous avons appris comment le contrôle ObjectDataSource permettait d’insérer, de mettre à jour et de supprimer des données. Le contrôle SqlDataSource prend en charge t...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 9673bef3-892c-45ba-a7d8-0da3d6f48ec5
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 4f7b282b09769272df8ff3a32aa4c509c8917481
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74597112"
---
# <a name="inserting-updating-and-deleting-data-with-the-sqldatasource-vb"></a><span data-ttu-id="334d9-104">Insertion, mise à jour et suppression de données avec SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="334d9-104">Inserting, Updating, and Deleting Data with the SqlDataSource (VB)</span></span>

<span data-ttu-id="334d9-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="334d9-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="334d9-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) ou [Télécharger le PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="334d9-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span></span>

> <span data-ttu-id="334d9-107">Dans les didacticiels précédents, nous avons appris comment le contrôle ObjectDataSource permettait d’insérer, de mettre à jour et de supprimer des données.</span><span class="sxs-lookup"><span data-stu-id="334d9-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="334d9-108">Le contrôle SqlDataSource prend en charge les mêmes opérations, mais l’approche est différente, et ce didacticiel montre comment configurer le SqlDataSource pour insérer, mettre à jour et supprimer des données.</span><span class="sxs-lookup"><span data-stu-id="334d9-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>

## <a name="introduction"></a><span data-ttu-id="334d9-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="334d9-109">Introduction</span></span>

<span data-ttu-id="334d9-110">Comme nous l’avons vu dans [une vue d’ensemble de l’insertion, de la mise à jour et](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)de la suppression, le contrôle GridView fournit des fonctionnalités intégrées de mise à jour et de suppression, tandis que les contrôles DetailsView et FormView incluent la prise en charge de l’insertion avec la fonctionnalité de modification et de suppression.</span><span class="sxs-lookup"><span data-stu-id="334d9-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="334d9-111">Ces fonctionnalités de modification des données peuvent être directement connectées à un contrôle de source de données sans qu’une ligne de code doive être écrite.</span><span class="sxs-lookup"><span data-stu-id="334d9-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="334d9-112">[Vue d’ensemble de l’insertion, de la mise à jour et de la suppression](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examinée à l’aide de ObjectDataSource pour faciliter l’insertion, la mise à jour et la suppression avec les contrôles GridView, DetailsView et FormView.</span><span class="sxs-lookup"><span data-stu-id="334d9-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="334d9-113">Le SqlDataSource peut également être utilisé à la place de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="334d9-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="334d9-114">N’oubliez pas que pour prendre en charge l’insertion, la mise à jour et la suppression, avec l’ObjectDataSource, nous avions besoin de spécifier les méthodes de la couche objet à appeler pour exécuter l’action d’insertion, de mise à jour ou de suppression.</span><span class="sxs-lookup"><span data-stu-id="334d9-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="334d9-115">Avec le SqlDataSource, nous devons fournir des instructions SQL de `INSERT`, `UPDATE`et `DELETE` (ou procédures stockées) à exécuter.</span><span class="sxs-lookup"><span data-stu-id="334d9-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="334d9-116">Comme nous le verrons dans ce didacticiel, ces instructions peuvent être créées manuellement ou générées automatiquement par l’Assistant Configurer la source de données.</span><span class="sxs-lookup"><span data-stu-id="334d9-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="334d9-117">Étant donné que nous avons déjà abordé les fonctionnalités d’insertion, de modification et de suppression des contrôles GridView, DetailsView et FormView, ce didacticiel se concentre sur la configuration du contrôle SqlDataSource pour prendre en charge ces opérations.</span><span class="sxs-lookup"><span data-stu-id="334d9-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="334d9-118">Si vous avez besoin de mettre en œuvre ces fonctionnalités dans les didacticiels GridView, DetailsView et FormView, revenez aux didacticiels de modification, d’insertion et de suppression de données, en commençant par [une vue d’ensemble de l’insertion, de la mise à jour et de la suppression](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="334d9-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span></span>

## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="334d9-119">Étape 1 : spécification des instructions`INSERT`,`UPDATE`et`DELETE`</span><span class="sxs-lookup"><span data-stu-id="334d9-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="334d9-120">Comme nous l’avons vu dans les deux derniers didacticiels, pour récupérer des données à partir d’un contrôle SqlDataSource, nous devons définir deux propriétés :</span><span class="sxs-lookup"><span data-stu-id="334d9-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="334d9-121">`ConnectionString`, qui spécifie la base de données à laquelle envoyer la requête, et</span><span class="sxs-lookup"><span data-stu-id="334d9-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="334d9-122">`SelectCommand`, qui spécifie l’instruction SQL ad hoc ou le nom de la procédure stockée à exécuter pour retourner les résultats.</span><span class="sxs-lookup"><span data-stu-id="334d9-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="334d9-123">Pour les valeurs de `SelectCommand` avec des paramètres, les valeurs de paramètre sont spécifiées via la collection de SqlDataSource s `SelectParameters` et peuvent inclure des valeurs codées en dur, des valeurs de source de paramètre communes (champs QueryString, variables de session, valeurs de contrôle Web, etc.) ou peuvent être assignées par programmation.</span><span class="sxs-lookup"><span data-stu-id="334d9-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="334d9-124">Lorsque la méthode du contrôle SqlDataSource s `Select()` est appelée par programme ou automatiquement à partir d’un contrôle Web de données, une connexion à la base de données est établie, les valeurs des paramètres sont affectées à la requête et la commande est transversée vers la base de données.</span><span class="sxs-lookup"><span data-stu-id="334d9-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="334d9-125">Les résultats sont ensuite renvoyés sous la forme d’un DataSet ou d’un DataReader, en fonction de la valeur de la propriété Control s `DataSourceMode`.</span><span class="sxs-lookup"><span data-stu-id="334d9-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="334d9-126">En plus de sélectionner des données, le contrôle SqlDataSource peut être utilisé pour insérer, mettre à jour et supprimer des données en fournissant `INSERT`, `UPDATE`et `DELETE` instructions SQL de la même façon.</span><span class="sxs-lookup"><span data-stu-id="334d9-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="334d9-127">Affectez simplement les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand` les instructions SQL `INSERT`, `UPDATE`et `DELETE` à exécuter.</span><span class="sxs-lookup"><span data-stu-id="334d9-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="334d9-128">Si les instructions ont des paramètres (comme elles le sont le plus souvent), incluez-les dans les collections `InsertParameters`, `UpdateParameters`et `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="334d9-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="334d9-129">Une fois qu’une valeur `InsertCommand`, `UpdateCommand`ou `DeleteCommand` a été spécifiée, l’option Activer l’insertion, activer la modification ou activer la suppression dans la balise active des contrôles Web de données correspondants devient disponible.</span><span class="sxs-lookup"><span data-stu-id="334d9-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="334d9-130">Pour illustrer cela, prenons un exemple de la page de `Querying.aspx` que nous avons créée dans le didacticiel sur l' [interrogation des données avec le contrôle de SqlDataSource](querying-data-with-the-sqldatasource-control-vb.md) et augmentez-la pour inclure les fonctionnalités de suppression.</span><span class="sxs-lookup"><span data-stu-id="334d9-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="334d9-131">Commencez par ouvrir les pages `InsertUpdateDelete.aspx` et `Querying.aspx` à partir du dossier `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="334d9-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="334d9-132">Dans le concepteur de la page `Querying.aspx`, sélectionnez le contrôle SqlDataSource et GridView dans le premier exemple (les contrôles `ProductsDataSource` et `GridView1`).</span><span class="sxs-lookup"><span data-stu-id="334d9-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="334d9-133">Après avoir sélectionné les deux contrôles, accédez au menu Edition, puis choisissez copier (ou appuyez simplement sur Ctrl + C).</span><span class="sxs-lookup"><span data-stu-id="334d9-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="334d9-134">Ensuite, accédez au concepteur de `InsertUpdateDelete.aspx` et collez les contrôles.</span><span class="sxs-lookup"><span data-stu-id="334d9-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="334d9-135">Une fois que vous avez déplacé les deux contrôles vers `InsertUpdateDelete.aspx`, testez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="334d9-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="334d9-136">Vous devez voir les valeurs des colonnes `ProductID`, `ProductName`et `UnitPrice` pour tous les enregistrements de la table de base de données `Products`.</span><span class="sxs-lookup"><span data-stu-id="334d9-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>

<span data-ttu-id="334d9-137">[![tous les produits sont répertoriés, classés par ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="334d9-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span></span>

<span data-ttu-id="334d9-138">**Figure 1**: tous les produits sont répertoriés, classés par `ProductID` ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="334d9-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span></span>

## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="334d9-139">Ajout des propriétés`DeleteCommand`et`DeleteParameters`du SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="334d9-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="334d9-140">À ce stade, nous disposons d’un SqlDataSource qui retourne simplement tous les enregistrements de la table `Products` et un GridView qui restitue ces données.</span><span class="sxs-lookup"><span data-stu-id="334d9-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="334d9-141">Notre objectif est d’étendre cet exemple pour permettre à l’utilisateur de supprimer des produits via le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="334d9-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="334d9-142">Pour ce faire, nous devons spécifier des valeurs pour les propriétés du contrôle SqlDataSource s `DeleteCommand` et `DeleteParameters`, puis configurer le contrôle GridView pour prendre en charge la suppression.</span><span class="sxs-lookup"><span data-stu-id="334d9-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="334d9-143">Les propriétés `DeleteCommand` et `DeleteParameters` peuvent être spécifiées de plusieurs façons :</span><span class="sxs-lookup"><span data-stu-id="334d9-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="334d9-144">À l’aide de la syntaxe déclarative</span><span class="sxs-lookup"><span data-stu-id="334d9-144">Through the declarative syntax</span></span>
- <span data-ttu-id="334d9-145">À partir de la Fenêtre Propriétés dans le concepteur</span><span class="sxs-lookup"><span data-stu-id="334d9-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="334d9-146">À partir de l’écran spécifier une instruction SQL personnalisée ou une procédure stockée, dans l’Assistant Configuration de la source de données</span><span class="sxs-lookup"><span data-stu-id="334d9-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="334d9-147">Via le bouton avancé dans l’écran spécifier les colonnes d’une table de vue dans l’Assistant Configurer la source de données, qui génère en fait automatiquement l' `DELETE` instruction SQL et la collection de paramètres utilisés dans les propriétés `DeleteCommand` et `DeleteParameters`</span><span class="sxs-lookup"><span data-stu-id="334d9-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="334d9-148">Nous allons examiner comment créer automatiquement l’instruction `DELETE` créée à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="334d9-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="334d9-149">Pour le moment, nous utilisons les Fenêtre Propriétés dans le concepteur, bien que l’Assistant Configurer la source de données ou l’option de syntaxe déclarative fonctionne également.</span><span class="sxs-lookup"><span data-stu-id="334d9-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="334d9-150">Dans le concepteur de `InsertUpdateDelete.aspx`, cliquez sur le `ProductsDataSource` SqlDataSource, puis affichez le Fenêtre Propriétés (dans le menu Affichage, choisissez Fenêtre Propriétés ou appuyez simplement sur F4).</span><span class="sxs-lookup"><span data-stu-id="334d9-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="334d9-151">Sélectionnez la propriété DeleteQuery, qui affichera un ensemble de ellipses.</span><span class="sxs-lookup"><span data-stu-id="334d9-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>

![Sélectionnez la propriété DeleteQuery dans la fenêtre Propriétés.](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.gif)

<span data-ttu-id="334d9-153">**Figure 2**: sélectionner la propriété DeleteQuery dans la fenêtre Propriétés</span><span class="sxs-lookup"><span data-stu-id="334d9-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>

> [!NOTE]
> <span data-ttu-id="334d9-154">Le SqlDataSource ne dispose pas d’une propriété DeleteQuery.</span><span class="sxs-lookup"><span data-stu-id="334d9-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="334d9-155">Au lieu de cela, DeleteQuery est une combinaison des propriétés `DeleteCommand` et `DeleteParameters` et est uniquement listé dans le Fenêtre Propriétés lors de l’affichage de la fenêtre par le biais du concepteur.</span><span class="sxs-lookup"><span data-stu-id="334d9-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="334d9-156">Si vous examinez les Fenêtre Propriétés dans la vue source, vous trouverez la propriété `DeleteCommand` à la place.</span><span class="sxs-lookup"><span data-stu-id="334d9-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>

<span data-ttu-id="334d9-157">Cliquez sur les points de suspension dans la propriété DeleteQuery pour afficher la boîte de dialogue Éditeur de commandes et de paramètres (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="334d9-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="334d9-158">À partir de cette boîte de dialogue, vous pouvez spécifier l’instruction SQL `DELETE` et spécifier les paramètres.</span><span class="sxs-lookup"><span data-stu-id="334d9-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="334d9-159">Entrez la requête suivante dans la zone de texte commande `DELETE` (manuellement ou à l’aide de la Générateur de requêtes, si vous le souhaitez) :</span><span class="sxs-lookup"><span data-stu-id="334d9-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample1.sql)]

<span data-ttu-id="334d9-160">Ensuite, cliquez sur le bouton actualiser les paramètres pour ajouter le paramètre `@ProductID` à la liste de paramètres ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="334d9-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>

<span data-ttu-id="334d9-161">[![sélectionnez la propriété DeleteQuery dans la fenêtre Propriétés.](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="334d9-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span></span>

<span data-ttu-id="334d9-162">**Figure 3**: sélectionner la propriété DeleteQuery dans la fenêtre Propriétés ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="334d9-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="334d9-163">Ne fournissez *pas* de valeur pour ce paramètre (laissez la source du paramètre sur None).</span><span class="sxs-lookup"><span data-stu-id="334d9-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="334d9-164">Une fois que nous avons ajouté la prise en charge de la suppression au GridView, le GridView fournit automatiquement cette valeur de paramètre à l’aide de la valeur de sa collection `DataKeys` pour la ligne sur laquelle l’utilisateur a cliqué sur le bouton supprimer.</span><span class="sxs-lookup"><span data-stu-id="334d9-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="334d9-165">Le nom du paramètre utilisé dans la requête de `DELETE` *doit* être le même que le nom de la valeur `DataKeyNames` dans GridView, DetailsView ou FormView.</span><span class="sxs-lookup"><span data-stu-id="334d9-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="334d9-166">Autrement dit, le paramètre dans l’instruction `DELETE` est nommé intentionnellement `@ProductID` (au lieu de, disons, `@ID`), car le nom de colonne de clé primaire dans la table Products (et par conséquent la valeur DataKeyNames dans le GridView) est `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="334d9-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>

<span data-ttu-id="334d9-167">Si le nom du paramètre et la valeur de `DataKeyNames` ne correspondent pas, le GridView ne peut pas attribuer automatiquement au paramètre la valeur de la collection de `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="334d9-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="334d9-168">Après avoir entré les informations relatives à la suppression dans la boîte de dialogue Éditeur de commandes et de paramètres, cliquez sur OK et accédez à la vue source pour examiner le balisage déclaratif obtenu :</span><span class="sxs-lookup"><span data-stu-id="334d9-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="334d9-169">Notez l’ajout de la propriété `DeleteCommand`, ainsi que la section `<DeleteParameters>` et l’objet de paramètre nommé `productID`.</span><span class="sxs-lookup"><span data-stu-id="334d9-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="334d9-170">Configuration du contrôle GridView pour la suppression</span><span class="sxs-lookup"><span data-stu-id="334d9-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="334d9-171">Une fois la propriété `DeleteCommand` ajoutée, la balise active de GridView s contient désormais l’option Activer la suppression.</span><span class="sxs-lookup"><span data-stu-id="334d9-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="334d9-172">Continuez et cochez cette case.</span><span class="sxs-lookup"><span data-stu-id="334d9-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="334d9-173">Comme nous l’avons vu dans [une vue d’ensemble de l’insertion, de la mise à jour et](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)de la suppression, le contrôle GridView ajoute un CommandField avec sa propriété `ShowDeleteButton` définie sur `True`.</span><span class="sxs-lookup"><span data-stu-id="334d9-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `True`.</span></span> <span data-ttu-id="334d9-174">Comme le montre la figure 4, lorsque la page est visitée via un navigateur, un bouton supprimer est inclus.</span><span class="sxs-lookup"><span data-stu-id="334d9-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="334d9-175">Testez cette page en supprimant certains produits.</span><span class="sxs-lookup"><span data-stu-id="334d9-175">Test this page out by deleting some products.</span></span>

<span data-ttu-id="334d9-176">[![chaque ligne GridView contient maintenant un bouton supprimer](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="334d9-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="334d9-177">**Figure 4**: chaque ligne GridView contient maintenant un bouton supprimer ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="334d9-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span></span>

<span data-ttu-id="334d9-178">Lorsque vous cliquez sur un bouton supprimer, une publication (postback) se produit, le GridView affecte au paramètre `ProductID` la valeur de la valeur de la collection `DataKeys` pour la ligne dont l’utilisateur a cliqué sur le bouton supprimer et appelle la méthode SqlDataSource s `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="334d9-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="334d9-179">Le contrôle SqlDataSource se connecte ensuite à la base de données et exécute l’instruction `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="334d9-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="334d9-180">Le GridView est ensuite relié au SqlDataSource, en obtenant et en affichant l’ensemble actuel de produits (qui n’incluent plus l’enregistrement juste-à-temps).</span><span class="sxs-lookup"><span data-stu-id="334d9-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="334d9-181">Étant donné que le contrôle GridView utilise sa collection `DataKeys` pour remplir les paramètres SqlDataSource, il est vital que la propriété GridView s `DataKeyNames` soit définie sur la ou les colonnes qui constituent la clé primaire et que le SqlDataSource s `SelectCommand` retourne ces colonnes.</span><span class="sxs-lookup"><span data-stu-id="334d9-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="334d9-182">En outre, il est important que le nom du paramètre dans le `DeleteCommand` SqlDataSource soit défini sur `@ProductID`.</span><span class="sxs-lookup"><span data-stu-id="334d9-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="334d9-183">Si la propriété `DataKeyNames` n’est pas définie ou si le paramètre n’est pas nommé `@ProductsID`, le fait de cliquer sur le bouton supprimer entraîne une publication, mais ne supprime pas réellement un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="334d9-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won't actually delete any record.</span></span>

<span data-ttu-id="334d9-184">La figure 5 illustre cette interaction graphiquement.</span><span class="sxs-lookup"><span data-stu-id="334d9-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="334d9-185">Reportez-vous au didacticiel [examen des événements associés à l’insertion, à la mise à jour et](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) à la suppression pour obtenir une discussion plus détaillée sur la chaîne d’événements associée à l’insertion, la mise à jour et la suppression d’un contrôle Web de données.</span><span class="sxs-lookup"><span data-stu-id="334d9-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>

![En cliquant sur le bouton supprimer dans le contrôle GridView, vous appelez la méthode SqlDataSource s Delete ().](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.gif)

<span data-ttu-id="334d9-187">**Figure 5**: Si vous cliquez sur le bouton supprimer dans le contrôle GridView, la méthode `Delete()` SqlDataSource s est appelée</span><span class="sxs-lookup"><span data-stu-id="334d9-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>

## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="334d9-188">Étape 2 : génération automatique des instructions`INSERT`,`UPDATE`et`DELETE`</span><span class="sxs-lookup"><span data-stu-id="334d9-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="334d9-189">À l’étape 1, les instructions SQL `INSERT`, `UPDATE`et `DELETE` peuvent être spécifiées via le Fenêtre Propriétés ou la syntaxe déclarative du contrôle.</span><span class="sxs-lookup"><span data-stu-id="334d9-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="334d9-190">Toutefois, cette approche nécessite que nous écrivions manuellement les instructions SQL à la main, ce qui peut être monotone et sujet aux erreurs.</span><span class="sxs-lookup"><span data-stu-id="334d9-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="334d9-191">Heureusement, l’Assistant Configuration de la source de données offre la possibilité de générer automatiquement les instructions `INSERT`, `UPDATE`et `DELETE` lors de l’utilisation de l’écran spécifier les colonnes d’une table de vue.</span><span class="sxs-lookup"><span data-stu-id="334d9-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="334d9-192">Nous allons explorer cette option de génération automatique.</span><span class="sxs-lookup"><span data-stu-id="334d9-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="334d9-193">Ajoutez un DetailsView au concepteur dans `InsertUpdateDelete.aspx` et affectez à sa propriété `ID` la valeur `ManageProducts`.</span><span class="sxs-lookup"><span data-stu-id="334d9-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="334d9-194">Ensuite, dans la balise active DetailsView s, choisissez de créer une nouvelle source de données et de créer un SqlDataSource nommé `ManageProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="334d9-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>

<span data-ttu-id="334d9-195">[![créer un nouveau SqlDataSource nommé ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="334d9-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span></span>

<span data-ttu-id="334d9-196">**Figure 6**: créer un nouveau SqlDataSource nommé `ManageProductsDataSource` ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="334d9-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="334d9-197">Dans l’Assistant Configurer la source de données, choisissez d’utiliser la chaîne de connexion `NORTHWINDConnectionString`, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="334d9-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="334d9-198">Dans l’écran configurer l’instruction SELECT, laissez la case d’option spécifier les colonnes d’une table ou d’une vue sélectionnée, puis sélectionnez la table `Products` dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="334d9-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="334d9-199">Sélectionnez les colonnes `ProductID`, `ProductName`, `UnitPrice`et `Discontinued` dans la liste de cases à cocher.</span><span class="sxs-lookup"><span data-stu-id="334d9-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>

<span data-ttu-id="334d9-200">[![à l’aide de la table Products, retournez les colonnes ProductID, ProductName, UnitPrice et Discontinued](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="334d9-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="334d9-201">**Figure 7**: utilisation de la table `Products`, retourner les colonnes `ProductID`, `ProductName`, `UnitPrice`et `Discontinued` ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="334d9-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span></span>

<span data-ttu-id="334d9-202">Pour générer automatiquement des instructions `INSERT`, `UPDATE`et `DELETE` en fonction de la table et des colonnes sélectionnées, cliquez sur le bouton Avancé et cochez la case générer des `INSERT`, des `UPDATE`et des instructions `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="334d9-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>

![Cochez la case générer des instructions INSERT, UPDATE et DELETE](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.gif)

<span data-ttu-id="334d9-204">**Figure 8**: cochez la case générer des instructions `INSERT`, `UPDATE`et `DELETE`</span><span class="sxs-lookup"><span data-stu-id="334d9-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>

<span data-ttu-id="334d9-205">La case à cocher générer des instructions `INSERT`, `UPDATE`et `DELETE` ne peut être vérifiée que si la table sélectionnée a une clé primaire et que la ou les colonnes de clé primaire sont incluses dans la liste des colonnes retournées.</span><span class="sxs-lookup"><span data-stu-id="334d9-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="334d9-206">La case à cocher utiliser l’accès concurrentiel optimiste, qui devient sélectionnable Lorsque la case à cocher générer `INSERT`, `UPDATE`et `DELETE` instructions a été activée, augmente les clauses `WHERE` dans les instructions `UPDATE` et `DELETE` résultantes pour fournir un contrôle d’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="334d9-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="334d9-207">Pour le moment, laissez cette case désactivée. Nous allons examiner l’accès concurrentiel optimiste avec le contrôle SqlDataSource dans le prochain didacticiel.</span><span class="sxs-lookup"><span data-stu-id="334d9-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="334d9-208">Après avoir activé la case à cocher générer `INSERT`, `UPDATE`et `DELETE` des instructions, cliquez sur OK pour revenir à l’écran configurer l’instruction SELECT, puis cliquez sur suivant et enfin sur Terminer pour terminer l’Assistant Configuration de la source de données.</span><span class="sxs-lookup"><span data-stu-id="334d9-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="334d9-209">À la fin de l’Assistant, Visual Studio ajoute BoundFields au DetailsView pour les colonnes `ProductID`, `ProductName`et `UnitPrice` et un CheckBoxField pour la colonne `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="334d9-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="334d9-210">À partir de la balise active de DetailsView s, activez l’option Activer la pagination afin que l’utilisateur visitant cette page puisse parcourir les produits.</span><span class="sxs-lookup"><span data-stu-id="334d9-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="334d9-211">Désactivez également les propriétés du contrôle DetailsView s `Width` et `Height`.</span><span class="sxs-lookup"><span data-stu-id="334d9-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="334d9-212">Notez que les options activer l’insertion, activer la modification et activer la suppression sont disponibles pour la balise active.</span><span class="sxs-lookup"><span data-stu-id="334d9-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="334d9-213">Cela est dû au fait que le SqlDataSource contient des valeurs pour son `InsertCommand`, `UpdateCommand`et `DeleteCommand`, comme le montre la syntaxe déclarative suivante :</span><span class="sxs-lookup"><span data-stu-id="334d9-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="334d9-214">Notez que les valeurs du contrôle SqlDataSource ont été automatiquement définies pour ses propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="334d9-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="334d9-215">L’ensemble de colonnes référencé dans les propriétés `InsertCommand` et `UpdateCommand` est basé sur ceux de l’instruction `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="334d9-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="334d9-216">Autrement dit, au lieu d’avoir *chaque* colonne Products dans le `InsertCommand` et `UpdateCommand`, seules les colonnes spécifiées dans le `SelectCommand` (moins `ProductID`, ce qui est omis parce qu’il s’agit d’une [colonne`IDENTITY`](http://www.sqlteam.com/item.asp?ItemID=102), dont la valeur ne peut pas être modifiée lors de la modification et qui est affectée automatiquement lors de l’insertion de).</span><span class="sxs-lookup"><span data-stu-id="334d9-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="334d9-217">En outre, pour chaque paramètre dans les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand`, les paramètres correspondants dans les collections `InsertParameters`, `UpdateParameters`et `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="334d9-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="334d9-218">Pour activer les fonctionnalités de modification des données du contrôle DetailsView, cochez les options activer l’insertion, activer la modification et activer la suppression dans sa balise active.</span><span class="sxs-lookup"><span data-stu-id="334d9-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="334d9-219">Cela ajoute une CommandField avec ses propriétés `ShowInsertButton`, `ShowEditButton`et `ShowDeleteButton` définies sur `True`.</span><span class="sxs-lookup"><span data-stu-id="334d9-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `True`.</span></span>

<span data-ttu-id="334d9-220">Accédez à la page dans un navigateur et notez les boutons modifier, supprimer et nouveau inclus dans le DetailsView.</span><span class="sxs-lookup"><span data-stu-id="334d9-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="334d9-221">Le fait de cliquer sur le bouton Modifier permet de transformer le DetailsView en mode édition, qui affiche chaque BoundField dont la propriété `ReadOnly` a la valeur `False` (valeur par défaut) en tant que zone de texte, et CheckBoxField en tant que case à cocher.</span><span class="sxs-lookup"><span data-stu-id="334d9-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `False` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>

<span data-ttu-id="334d9-222">[![l’interface d’édition par défaut de DetailsView s](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="334d9-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="334d9-223">**Figure 9**: interface de modification par défaut de DetailsView s ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="334d9-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span></span>

<span data-ttu-id="334d9-224">De même, vous pouvez supprimer le produit actuellement sélectionné ou ajouter un nouveau produit au système.</span><span class="sxs-lookup"><span data-stu-id="334d9-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="334d9-225">Étant donné que l’instruction `InsertCommand` fonctionne uniquement avec les colonnes `ProductName`, `UnitPrice`et `Discontinued`, les autres colonnes ont soit `NULL`, soit leur valeur par défaut affectée par la base de données lors de l’insertion.</span><span class="sxs-lookup"><span data-stu-id="334d9-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="334d9-226">À l’instar de l’ObjectDataSource, si la `InsertCommand` n’a pas de colonnes de table de base de données qui n’autorisent pas `NULL` s et que Don t a une valeur par défaut, une erreur SQL se produit lors de la tentative d’exécution de l’instruction `INSERT`.</span><span class="sxs-lookup"><span data-stu-id="334d9-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="334d9-227">Les interfaces d’insertion et de modification du contrôle DetailsView n’ont pas de personnalisation ou de validation.</span><span class="sxs-lookup"><span data-stu-id="334d9-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="334d9-228">Pour ajouter des contrôles de validation ou pour personnaliser les interfaces, vous devez convertir le BoundFields en TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="334d9-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="334d9-229">Pour plus d’informations, consultez [Ajout de contrôles de validation aux interfaces de modification et d’insertion](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) et personnalisation des didacticiels sur [l’interface de modification des données](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="334d9-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorials for more information.</span></span>

<span data-ttu-id="334d9-230">En outre, gardez à l’esprit que pour la mise à jour et la suppression, le contrôle DetailsView utilise la valeur de `DataKey` du produit actuel, qui est présente uniquement si la propriété `DataKeyNames` est configurée.</span><span class="sxs-lookup"><span data-stu-id="334d9-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="334d9-231">Si la modification ou la suppression semble n’avoir aucun effet, vérifiez que la propriété `DataKeyNames` est définie.</span><span class="sxs-lookup"><span data-stu-id="334d9-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="334d9-232">Limitations de la génération automatique d’instructions SQL</span><span class="sxs-lookup"><span data-stu-id="334d9-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="334d9-233">Étant donné que l’option Generate `INSERT`, `UPDATE`et `DELETE`s est disponible uniquement lors du prélèvement de colonnes dans une table, pour les requêtes plus complexes, vous devrez écrire vos propres instructions `INSERT`, `UPDATE`et `DELETE` comme nous l’avons fait à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="334d9-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="334d9-234">En règle générale, les instructions SQL `SELECT` utilisent des `JOIN` s pour ramener les données d’une ou de plusieurs tables de recherche à des fins d’affichage (par exemple, la remise du champ `Categories` table s `CategoryName` lors de l’affichage des informations sur le produit).</span><span class="sxs-lookup"><span data-stu-id="334d9-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="334d9-235">En même temps, nous pouvons autoriser l’utilisateur à modifier, mettre à jour ou insérer des données dans la table principale (`Products`, dans le cas présent).</span><span class="sxs-lookup"><span data-stu-id="334d9-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="334d9-236">Alors que les instructions `INSERT`, `UPDATE`et `DELETE` peuvent être entrées manuellement, prenez en compte le Conseil qui économise le temps suivant.</span><span class="sxs-lookup"><span data-stu-id="334d9-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="334d9-237">Configurez initialement le SqlDataSource afin qu’il récupère les données uniquement à partir de la table `Products`.</span><span class="sxs-lookup"><span data-stu-id="334d9-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="334d9-238">Utilisez l’Assistant Configurer la source de données pour spécifier les colonnes d’une table ou d’un écran d’affichage afin de pouvoir générer automatiquement les instructions `INSERT`, `UPDATE`et `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="334d9-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="334d9-239">Ensuite, après avoir terminé l’Assistant, choisissez de configurer le SelectQuery à partir de la Fenêtre Propriétés (ou bien, revenez à l’Assistant Configuration de la source de données, mais utilisez l’option spécifier une instruction SQL personnalisée ou une procédure stockée).</span><span class="sxs-lookup"><span data-stu-id="334d9-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="334d9-240">Ensuite, mettez à jour l’instruction `SELECT` pour inclure la syntaxe `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="334d9-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="334d9-241">Cette technique offre les avantages de gagner du temps pour les instructions SQL générées automatiquement et permet d’obtenir une instruction `SELECT` plus personnalisée.</span><span class="sxs-lookup"><span data-stu-id="334d9-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="334d9-242">Une autre limitation de la génération automatique des instructions `INSERT`, `UPDATE`et `DELETE` est que les colonnes des instructions `INSERT` et `UPDATE` sont basées sur les colonnes retournées par l’instruction `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="334d9-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="334d9-243">Toutefois, nous pouvons être amenés à mettre à jour ou à insérer plus ou moins de champs.</span><span class="sxs-lookup"><span data-stu-id="334d9-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="334d9-244">Par exemple, dans l’exemple de l’étape 2, peut-être souhaitez-vous que le `UnitPrice` BoundField soit en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="334d9-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="334d9-245">Dans ce cas, il ne doit pas apparaître dans la `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="334d9-245">In that case, it shouldn't appear in the `UpdateCommand`.</span></span> <span data-ttu-id="334d9-246">Ou bien, vous pouvez définir la valeur d’un champ de table qui n’apparaît pas dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="334d9-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="334d9-247">Par exemple, lors de l’ajout d’un nouvel enregistrement, nous pouvons souhaiter que la valeur `QuantityPerUnit` soit définie sur TODO.</span><span class="sxs-lookup"><span data-stu-id="334d9-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="334d9-248">Si de telles personnalisations sont requises, vous devez les effectuer manuellement, à l’aide de la Fenêtre Propriétés, de l’option spécifier une instruction SQL personnalisée ou une procédure stockée dans l’Assistant, ou via la syntaxe déclarative.</span><span class="sxs-lookup"><span data-stu-id="334d9-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="334d9-249">Lorsque vous ajoutez des paramètres qui n’ont pas de champs correspondants dans le contrôle Web de données, n’oubliez pas que ces valeurs de paramètres doivent être affectées à des valeurs de quelque manière que ce soit.</span><span class="sxs-lookup"><span data-stu-id="334d9-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="334d9-250">Ces valeurs peuvent être : codées en dur directement dans le `InsertCommand` ou `UpdateCommand`; peut provenir d’une source prédéfinie (queryString, état de session, contrôles Web sur la page, etc.); ou peuvent être affectés par programme, comme nous l’avons vu dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="334d9-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="334d9-251">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="334d9-251">Summary</span></span>

<span data-ttu-id="334d9-252">Pour que les contrôles Web de données utilisent leurs fonctionnalités intégrées d’insertion, de modification et de suppression, le contrôle de source de données auquel elles sont liées doit offrir une telle fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="334d9-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="334d9-253">Pour le SqlDataSource, cela signifie que les instructions SQL `INSERT`, `UPDATE`et `DELETE` doivent être assignées aux propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="334d9-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="334d9-254">Ces propriétés, ainsi que les collections de paramètres correspondantes, peuvent être ajoutées manuellement ou générées automatiquement via l’Assistant Configuration de la source de données.</span><span class="sxs-lookup"><span data-stu-id="334d9-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="334d9-255">Dans ce didacticiel, nous avons examiné les deux techniques.</span><span class="sxs-lookup"><span data-stu-id="334d9-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="334d9-256">Nous avons examiné l’utilisation de l’accès concurrentiel optimiste avec ObjectDataSource dans le didacticiel sur l’implémentation de l' [accès concurrentiel optimiste](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="334d9-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) tutorial.</span></span> <span data-ttu-id="334d9-257">Le contrôle SqlDataSource fournit également la prise en charge de l’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="334d9-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="334d9-258">Comme indiqué à l’étape 2, lors de la génération automatique des instructions `INSERT`, `UPDATE`et `DELETE`, l’Assistant propose une option d’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="334d9-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="334d9-259">Comme nous le verrons dans le didacticiel suivant, l’utilisation de l’accès concurrentiel optimiste avec le SqlDataSource modifie les clauses `WHERE` dans les instructions `UPDATE` et `DELETE` pour s’assurer que les valeurs des autres colonnes n’ont pas changé depuis la dernière fois que les données ont été affichées sur la page.</span><span class="sxs-lookup"><span data-stu-id="334d9-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven't changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="334d9-260">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="334d9-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="334d9-261">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="334d9-261">About the Author</span></span>

<span data-ttu-id="334d9-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="334d9-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="334d9-263">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="334d9-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="334d9-264">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="334d9-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="334d9-265">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="334d9-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="334d9-266">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="334d9-266">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="334d9-267">[Précédent](using-parameterized-queries-with-the-sqldatasource-vb.md)
> [Suivant](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="334d9-267">[Previous](using-parameterized-queries-with-the-sqldatasource-vb.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span></span>
