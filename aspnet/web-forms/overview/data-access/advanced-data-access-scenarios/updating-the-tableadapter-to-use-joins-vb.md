---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Mise à jour le TableAdapter à l’utilisation de jointures (VB) | Microsoft Docs
author: rick-anderson
description: Lorsque vous travaillez avec une base de données, il est courant pour demander des données qui sont réparties sur plusieurs tables. Pour récupérer des données à partir de deux tables différentes, nous pouvons utiliser soit...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 943b8a67e77e4ed449e0b2c887b3cae7cc10f305
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59383432"
---
# <a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="8c017-104">Mise à jour du TableAdapter pour l’utilisation de jointures (VB)</span><span class="sxs-lookup"><span data-stu-id="8c017-104">Updating the TableAdapter to Use JOINs (VB)</span></span>

<span data-ttu-id="8c017-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8c017-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8c017-106">[Télécharger le Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) ou [télécharger le PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8c017-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="8c017-107">Lorsque vous travaillez avec une base de données, il est courant pour demander des données qui sont réparties sur plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="8c017-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="8c017-108">Pour récupérer des données à partir de deux tables différentes, nous pouvons utiliser une sous-requête corrélée ou sur une opération de jointure.</span><span class="sxs-lookup"><span data-stu-id="8c017-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="8c017-109">Dans ce didacticiel, nous comparons les sous-requêtes en corrélation et la syntaxe de jointure avant de regarder comment créer un TableAdapter qui inclut une jointure dans sa requête principale.</span><span class="sxs-lookup"><span data-stu-id="8c017-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="8c017-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="8c017-110">Introduction</span></span>

<span data-ttu-id="8c017-111">Avec les bases de données relationnelles les données, nous nous intéressons dans l’utilisation sont souvent réparties sur plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="8c017-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="8c017-112">Par exemple, lors de l’affichage des informations sur les produits nous souhaitons probablement répertorier chaque catégorie de produit s correspondante et les noms des fournisseurs s.</span><span class="sxs-lookup"><span data-stu-id="8c017-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="8c017-113">Le `Products` table a `CategoryID` et `SupplierID` valeurs, mais les noms de catégorie et le fournisseur réels sont dans le `Categories` et `Suppliers` des tables, respectivement.</span><span class="sxs-lookup"><span data-stu-id="8c017-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="8c017-114">Pour récupérer des informations à partir d’une autre table liée, nous pouvons utiliser *sous-requêtes corrélées* ou `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="8c017-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="8c017-115">Une sous-requête corrélée est imbriquée `SELECT` requête qui fait référence aux colonnes dans la requête externe.</span><span class="sxs-lookup"><span data-stu-id="8c017-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="8c017-116">Par exemple, dans le [création d’une couche d’accès aux données](../introduction/creating-a-data-access-layer-vb.md) didacticiel, nous avons utilisé deux sous-requêtes corrélées dans le `ProductsTableAdapter` requête principale de s pour retourner les noms de catégorie et le fournisseur pour chaque produit.</span><span class="sxs-lookup"><span data-stu-id="8c017-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="8c017-117">Un `JOIN` est une construction SQL qui fusionne des lignes connexes à partir de deux tables différentes.</span><span class="sxs-lookup"><span data-stu-id="8c017-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="8c017-118">Nous avons utilisé un `JOIN` dans le [interrogation des données avec le contrôle SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) didacticiel pour afficher des informations de catégorie en même temps que chaque produit.</span><span class="sxs-lookup"><span data-stu-id="8c017-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="8c017-119">La raison pour laquelle nous avons abstained de l’utilisation de `JOIN` s avec les TableAdapters est en raison des limitations dans l’Assistant TableAdapter s pour générer automatiquement des correspondant `INSERT`, `UPDATE`, et `DELETE` instructions.</span><span class="sxs-lookup"><span data-stu-id="8c017-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="8c017-120">Plus précisément, si la requête principale de TableAdapter s contient une `JOIN` s, le TableAdapter ne peut pas créer automatiquement les instructions SQL ad hoc ou les procédures stockées pour son `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés.</span><span class="sxs-lookup"><span data-stu-id="8c017-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="8c017-121">Dans ce didacticiel, nous allons comparer brièvement et le contraste des sous-requêtes corrélées et `JOIN` s avant d’Explorer la création d’un TableAdapter qui inclut `JOIN` s dans sa requête principale.</span><span class="sxs-lookup"><span data-stu-id="8c017-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="8c017-122">En comparant et différenciant les sous-requêtes en corrélation et`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="8c017-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="8c017-123">N’oubliez pas que le `ProductsTableAdapter` créé dans le premier didacticiel de la `Northwind` jeu de données utilise des sous-requêtes corrélées pour ramener chaque nom catégorie et le fournisseur correspondant produit s.</span><span class="sxs-lookup"><span data-stu-id="8c017-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="8c017-124">Le `ProductsTableAdapter` requête principale s est indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="8c017-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="8c017-125">Les deux en corrélation sous-requêtes - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` et `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -sont `SELECT` requêtes qui retournent une valeur unique par produit comme une colonne supplémentaire dans la liste externe `SELECT` liste des colonnes de l’instruction s.</span><span class="sxs-lookup"><span data-stu-id="8c017-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="8c017-126">Vous pouvez également un `JOIN` peut être utilisée pour retourner chaque nom de fournisseur et la catégorie de produit s.</span><span class="sxs-lookup"><span data-stu-id="8c017-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="8c017-127">La requête suivante retourne le même résultat que celui ci-dessus, mais utilise `JOIN` s à la place des sous-requêtes :</span><span class="sxs-lookup"><span data-stu-id="8c017-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="8c017-128">Un `JOIN` fusionne les enregistrements d’une table avec des enregistrements à partir d’une autre table en fonction de certains critères.</span><span class="sxs-lookup"><span data-stu-id="8c017-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="8c017-129">Dans la requête ci-dessus, par exemple, le `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` demande à SQL Server pour la fusion de chaque enregistrement de produit avec la catégorie enregistrement dont la propriété `CategoryID` valeur correspond au produit s `CategoryID` valeur.</span><span class="sxs-lookup"><span data-stu-id="8c017-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="8c017-130">Le résultat fusionné nous permet de travailler avec les champs de catégorie correspondant pour chaque produit (tel que `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="8c017-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="8c017-131">`JOIN` s sont couramment utilisés lors de l’interrogation des données à partir de bases de données relationnelles.</span><span class="sxs-lookup"><span data-stu-id="8c017-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="8c017-132">Si vous ne connaissez pas le `JOIN` syntaxe ou devoir d’agrémenter un peu sur son utilisation, je d recommande le [didacticiel SQL Join](http://www.w3schools.com/sql/sql_join.asp) à [W3 Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="8c017-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="8c017-133">Également important de lecture sont le [ `JOIN` notions de base](https://msdn.microsoft.com/library/ms191517.aspx) et [principes de base](https://msdn.microsoft.com/library/ms189575.aspx) sections de la [la documentation en ligne de SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="8c017-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="8c017-134">Dans la mesure où `JOIN` s et des sous-requêtes corrélées peuvent être utilisés pour récupérer les données associées provenant d’autres tables, de nombreux développeurs sont laissés leurs têtes infructueuses et vous vous demandez de l’approche à utiliser.</span><span class="sxs-lookup"><span data-stu-id="8c017-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="8c017-135">Tous les gourous SQL je ve ont rapporté à peu près la même chose, qu’il ne peu performante que SQL Server génère des plans d’exécution à peu près identique.</span><span class="sxs-lookup"><span data-stu-id="8c017-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="8c017-136">Leur avis, il faut utiliser la technique que vous et votre équipe sont convient le mieux.</span><span class="sxs-lookup"><span data-stu-id="8c017-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="8c017-137">Il mérite de noter que, après particulier ce Conseil ces experts expriment immédiatement leurs préférences de `JOIN` s sur les sous-requêtes corrélées.</span><span class="sxs-lookup"><span data-stu-id="8c017-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="8c017-138">Lors de la création d’une couche d’accès aux données à l’aide de jeux de données typé, les outils fonctionnent mieux lors de l’utilisation de sous-requêtes.</span><span class="sxs-lookup"><span data-stu-id="8c017-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="8c017-139">En particulier, l’Assistant TableAdapter s pas génère automatiquement correspondant `INSERT`, `UPDATE`, et `DELETE` instructions si la requête principale contient une `JOIN` s, mais génère automatiquement ces instructions lorsque corrélées sous-requêtes sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="8c017-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="8c017-140">Pour Explorer cet inconvénient, créez un DataSet typé temporaire dans le `~/App_Code/DAL` dossier.</span><span class="sxs-lookup"><span data-stu-id="8c017-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="8c017-141">Au cours de l’Assistant Configuration de TableAdapter, choisir d’utiliser des instructions SQL ad hoc et entrez les informations suivantes `SELECT` requête (voir Figure 1) :</span><span class="sxs-lookup"><span data-stu-id="8c017-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]


<span data-ttu-id="8c017-142">[![Entrez une requête principale qui contient des jointures](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="8c017-143">**Figure 1**: Entrez une requête principale qui contient `JOIN` s ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>


<span data-ttu-id="8c017-144">Par défaut, le TableAdapter créera automatiquement `INSERT`, `UPDATE`, et `DELETE` instructions en fonction de la requête principale.</span><span class="sxs-lookup"><span data-stu-id="8c017-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="8c017-145">Si vous cliquez sur le bouton Avancé, vous pouvez voir que cette fonctionnalité est activée.</span><span class="sxs-lookup"><span data-stu-id="8c017-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="8c017-146">En dépit de ce paramètre, le TableAdapter sera pas en mesure de créer le `INSERT`, `UPDATE`, et `DELETE` instructions, car la requête principale contient un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8c017-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Entrez une requête principale qui contient des jointures](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="8c017-148">**Figure 2**: Entrez une requête principale contenant `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="8c017-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="8c017-149">Cliquez sur Terminer pour terminer l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="8c017-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="8c017-150">À ce stade, votre Concepteur de DataSet s inclut un seul TableAdapter avec un DataTable avec des colonnes pour chacun des champs retournés dans le `SELECT` liste des colonnes de requête s.</span><span class="sxs-lookup"><span data-stu-id="8c017-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="8c017-151">Cela inclut la `CategoryName` et `SupplierName`, comme le montre la Figure 3.</span><span class="sxs-lookup"><span data-stu-id="8c017-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![La table de données inclut une colonne pour chaque champ renvoyé dans la liste des colonnes](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="8c017-153">**Figure 3**: La table de données inclut une colonne pour chaque champ renvoyé dans la liste des colonnes</span><span class="sxs-lookup"><span data-stu-id="8c017-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="8c017-154">Alors que la table de données a les colonnes appropriées, le TableAdapter ne dispose pas des valeurs pour ses `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés.</span><span class="sxs-lookup"><span data-stu-id="8c017-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="8c017-155">Pour vérifier cela, cliquez sur le TableAdapter dans le concepteur et passez à la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="8c017-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="8c017-156">Il vous verrez que le `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés sont définies à (None).</span><span class="sxs-lookup"><span data-stu-id="8c017-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="8c017-157">[![La propriété InsertCommand, UpdateCommand et DeleteCommand propriétés sont définies à (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="8c017-158">**Figure 4**: Le `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés sont définies à (None) ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>


<span data-ttu-id="8c017-159">Pour contourner cet inconvénient, nous pouvons fournir manuellement les instructions SQL et les paramètres pour le `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés via la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="8c017-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="8c017-160">Ou bien, nous pouvons commencer en configurant la requête principale de s TableAdapter à *pas* inclure tous `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="8c017-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="8c017-161">Cela permettra le `INSERT`, `UPDATE`, et `DELETE` à des instructions pour être généré automatiquement pour nous.</span><span class="sxs-lookup"><span data-stu-id="8c017-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="8c017-162">À l’issue de l’Assistant, nous pourrions ensuite mettre à jour manuellement le TableAdapter s `SelectCommand` à partir de la fenêtre Propriétés afin qu’il inclue le `JOIN` syntaxe.</span><span class="sxs-lookup"><span data-stu-id="8c017-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="8c017-163">Bien que cette approche fonctionne, il est très fragile lorsqu’à l’aide de requêtes SQL ad hoc, car chaque fois que la requête principale de s TableAdapter est reconfiguré via l’Assistant, générée automatiquement `INSERT`, `UPDATE`, et `DELETE` instructions sont recréées.</span><span class="sxs-lookup"><span data-stu-id="8c017-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="8c017-164">Cela signifie que toutes les personnalisations plus tard, nous avons apporté seraient perdues si nous avez cliqué sur le TableAdapter a choisi de configurer dans le menu contextuel et terminé l’Assistant à nouveau.</span><span class="sxs-lookup"><span data-stu-id="8c017-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="8c017-165">La fragilité de la s TableAdapter générées automatiquement `INSERT`, `UPDATE`, et `DELETE` instructions est, fort heureusement, limité aux instructions SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="8c017-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="8c017-166">Si votre TableAdapter utilise des procédures stockées, vous pouvez personnaliser le `SelectCommand`, `InsertCommand`, `UpdateCommand`, ou `DeleteCommand` des procédures stockées et réexécutez l’Assistant Configuration de TableAdapter sans avoir à craindre que les procédures stockées seront modifié.</span><span class="sxs-lookup"><span data-stu-id="8c017-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="8c017-167">Le prochain plusieurs étapes, nous allons créer un TableAdapter qui, au départ, utilise une requête principale, qui omet les `JOIN` s afin que le correspondantes insérer, mettre à jour et procédures stockées de suppression sera généré automatiquement.</span><span class="sxs-lookup"><span data-stu-id="8c017-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="8c017-168">Nous met ensuite à jour le `SelectCommand` donc qui utilise un `JOIN` qui retourne des colonnes supplémentaires à partir de tables associées.</span><span class="sxs-lookup"><span data-stu-id="8c017-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="8c017-169">Enfin, nous créer une classe correspondante de la couche de logique métier et expliquent comment utiliser le TableAdapter dans une page web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8c017-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="8c017-170">Étape 1 : Création du TableAdapter à l’aide d’une requête principale simplifiée</span><span class="sxs-lookup"><span data-stu-id="8c017-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="8c017-171">Pour ce didacticiel, nous allons ajouter un TableAdapter et la table de données fortement typées pour la `Employees` table dans le `NorthwindWithSprocs` jeu de données.</span><span class="sxs-lookup"><span data-stu-id="8c017-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="8c017-172">Le `Employees` table contient un `ReportsTo` champ qui spécifié le `EmployeeID` de l’employé s responsable.</span><span class="sxs-lookup"><span data-stu-id="8c017-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="8c017-173">Par exemple, les employés Anne Dodsworth a un `ReportTo` valeur 5, qui est le `EmployeeID` de Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="8c017-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="8c017-174">Par conséquent, Anne signale à Steven, son responsable.</span><span class="sxs-lookup"><span data-stu-id="8c017-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="8c017-175">En même temps que la création de rapports chaque employé s `ReportsTo` valeur, nous souhaitions également récupérer le nom de son responsable.</span><span class="sxs-lookup"><span data-stu-id="8c017-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="8c017-176">Cela peut être accompli à l’aide un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8c017-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="8c017-177">Mais l’utilisation un `JOIN` lors de la création du TableAdapter empêche l’Assistant à partir de la génération automatique de l’insertion correspondante, mettre à jour et supprimer des fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="8c017-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="8c017-178">Par conséquent, nous allons commencer par la création d’un TableAdapter dont requête principale ne contienne aucun `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="8c017-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="8c017-179">Ensuite, à l’étape 2, nous mettrons à jour la procédure stockée de requête principale pour récupérer le nom de gestionnaire s via un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8c017-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="8c017-180">Commencez par ouvrir le `NorthwindWithSprocs` jeu de données dans le `~/App_Code/DAL` dossier.</span><span class="sxs-lookup"><span data-stu-id="8c017-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="8c017-181">Avec le bouton droit sur le concepteur, sélectionnez l’option Ajouter dans le menu contextuel et choisissez l’élément de menu du TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8c017-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="8c017-182">Cette action lance l’Assistant Configuration de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8c017-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="8c017-183">Comme la Figure 5 illustre, laisser l’Assistant créer des procédures stockées et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="8c017-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="8c017-184">Pour un rappel sur la création de nouvelles procédures stockées à partir l’Assistant TableAdapter s, consultez le [création de nouvelles procédures stockées pour s DataSet typée TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="8c017-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>


<span data-ttu-id="8c017-185">[![Sélectionnez les créer nouvelles procédures stockées Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="8c017-186">**Figure 5**: Sélectionnez la créer nouveau des procédures stockées Option ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>


<span data-ttu-id="8c017-187">Utilisez la commande suivante `SELECT` instruction pour la requête principale de TableAdapter s :</span><span class="sxs-lookup"><span data-stu-id="8c017-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="8c017-188">Étant donné que cette requête ne contienne pas `JOIN` s, l’Assistant TableAdapter crée automatiquement des procédures stockées avec correspondant `INSERT`, `UPDATE`, et `DELETE` instructions, ainsi que d’une procédure stockée pour l’exécution de la main requête.</span><span class="sxs-lookup"><span data-stu-id="8c017-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="8c017-189">L’étape suivante nous permet de nommer les procédures stockées de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8c017-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="8c017-190">Utilisez les noms `Employees_Select`, `Employees_Insert`, `Employees_Update`, et `Employees_Delete`, comme illustré dans la Figure 6.</span><span class="sxs-lookup"><span data-stu-id="8c017-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="8c017-191">[![Nommez les procédures stockées de TableAdapter](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="8c017-192">**Figure 6**: Nommez les procédures stockées de TableAdapter s ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>


<span data-ttu-id="8c017-193">L’étape finale nous invite à nommer les méthodes de s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8c017-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="8c017-194">Utilisez `Fill` et `GetEmployees` en tant que les noms de méthode.</span><span class="sxs-lookup"><span data-stu-id="8c017-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="8c017-195">Veillez également à laisser les créer des méthodes pour envoyer des mises à jour directement à la case à cocher de la base de données (GenerateDBDirectMethods) activée.</span><span class="sxs-lookup"><span data-stu-id="8c017-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="8c017-196">[![Nom du remplissage de méthodes TableAdapter s et GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="8c017-197">**Figure 7**: Nommez les méthodes du TableAdapter s `Fill` et `GetEmployees` ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>


<span data-ttu-id="8c017-198">À l’issue de l’Assistant, prenez un moment pour examiner les procédures stockées dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="8c017-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="8c017-199">Vous devez voir quatre nouveaux : `Employees_Select`, `Employees_Insert`, `Employees_Update`, et `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="8c017-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="8c017-200">Ensuite, inspecter la `EmployeesDataTable` et `EmployeesTableAdapter` venez de créer.</span><span class="sxs-lookup"><span data-stu-id="8c017-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="8c017-201">La table de données contient une colonne pour chaque champ renvoyé par la requête principale.</span><span class="sxs-lookup"><span data-stu-id="8c017-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="8c017-202">Cliquez sur le TableAdapter et passez à la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="8c017-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="8c017-203">Il vous verrez que le `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés sont correctement configurées pour appeler les procédures stockées correspondantes.</span><span class="sxs-lookup"><span data-stu-id="8c017-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="8c017-204">[![Le TableAdapter inclut Insert, Update et supprimer des fonctionnalités](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="8c017-205">**Figure 8**: Le TableAdapter inclut insérer mise à jour et supprimer des fonctionnalités ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>


<span data-ttu-id="8c017-206">Lors de l’insertion, mise à jour et supprimer des procédures stockées créées automatiquement et le `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés configurées correctement, nous sommes prêts à personnaliser le `SelectCommand` s procédure stockée pour retourner supplémentaires informations sur chaque employé s responsable.</span><span class="sxs-lookup"><span data-stu-id="8c017-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="8c017-207">Plus précisément, nous devons mettre à jour le `Employees_Select` une procédure stockée à utiliser un `JOIN` et retourner le Gestionnaire de s `FirstName` et `LastName` valeurs.</span><span class="sxs-lookup"><span data-stu-id="8c017-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="8c017-208">Une fois la procédure stockée a été mis à jour, nous devrons mettre à jour la table de données pour qu’elle inclue ces colonnes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="8c017-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="8c017-209">Nous les aborderons ces deux tâches dans les étapes 2 et 3.</span><span class="sxs-lookup"><span data-stu-id="8c017-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="8c017-210">Étape 2 : Personnalisation de la procédure stockée pour inclure un`JOIN`</span><span class="sxs-lookup"><span data-stu-id="8c017-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="8c017-211">Commencez par passer à l’Explorateur de serveurs, la descente dans le dossier de procédures stockées de base de données Northwind et l’ouverture du `Employees_Select` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="8c017-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="8c017-212">Si vous ne voyez pas cette procédure stockée, avec le bouton droit sur le dossier Stored Procedures, cliquez sur Actualiser.</span><span class="sxs-lookup"><span data-stu-id="8c017-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="8c017-213">Mettre à jour de la procédure stockée afin qu’il utilise un `LEFT JOIN` pour retourner le Gestionnaire de s tout d’abord et du nom :</span><span class="sxs-lookup"><span data-stu-id="8c017-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="8c017-214">Après la mise à jour le `SELECT` instruction, enregistrez les modifications apportées en accédant au menu fichier et en choisissant Enregistrer `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="8c017-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="8c017-215">Vous pouvez également, cliquez sur l’icône Enregistrer dans la barre d’outils ou appuyez sur Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="8c017-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="8c017-216">Après avoir enregistré vos modifications, cliquez sur le `Employees_Select` procédure stockée dans l’Explorateur de serveurs et cliquez sur Exécuter.</span><span class="sxs-lookup"><span data-stu-id="8c017-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="8c017-217">Cela sera exécuter la procédure stockée et afficher ses résultats dans la fenêtre de sortie (voir la Figure 9).</span><span class="sxs-lookup"><span data-stu-id="8c017-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="8c017-218">[![Les résultats de procédures stockées sont affichés dans la fenêtre Sortie](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="8c017-219">**Figure 9**: Les résultats de procédures stockées sont affichés dans la fenêtre Sortie ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="8c017-220">Étape 3 : La mise à jour les colonnes de s DataTable</span><span class="sxs-lookup"><span data-stu-id="8c017-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="8c017-221">À ce stade, le `Employees_Select` procédure stockée renvoie `ManagerFirstName` et `ManagerLastName` valeurs, mais le `EmployeesDataTable` manque de ces colonnes.</span><span class="sxs-lookup"><span data-stu-id="8c017-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="8c017-222">Ces colonnes manquantes peuvent être ajoutées à la table de données de deux manières :</span><span class="sxs-lookup"><span data-stu-id="8c017-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="8c017-223">**Manuellement** - avec le bouton droit sur la table de données dans le Concepteur de DataSet et, dans le menu Ajouter, choisissez la colonne.</span><span class="sxs-lookup"><span data-stu-id="8c017-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="8c017-224">Vous pouvez nommer la colonne, puis définissez ses propriétés en conséquence.</span><span class="sxs-lookup"><span data-stu-id="8c017-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="8c017-225">**Automatiquement** -l’Assistant Configuration de TableAdapter met à jour les colonnes de s DataTable pour refléter les champs retournés par la `SelectCommand` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="8c017-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="8c017-226">Lorsque vous utilisez des instructions SQL ad hoc, l’Assistant va également supprimer la `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés depuis le `SelectCommand` contient maintenant un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8c017-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="8c017-227">Mais lorsque vous utilisez des procédures stockées, ces propriétés d’une commande restent intactes.</span><span class="sxs-lookup"><span data-stu-id="8c017-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="8c017-228">Nous avons déjà exploré manuellement ajouter des colonnes de table de données dans les didacticiels précédents, y compris [maître/détail à l’aide d’une liste à puces des enregistrements maîtres avec une DataList des détails](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) et [télécharger des fichiers](../working-with-binary-files/uploading-files-vb.md), et nous allons Examinez à nouveau ce processus plus en détail dans notre didacticiel suivant.</span><span class="sxs-lookup"><span data-stu-id="8c017-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="8c017-229">Pour ce didacticiel, toutefois, laisser s utiliser l’approche automatique via l’Assistant Configuration de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8c017-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="8c017-230">Démarrer en cliquant sur le `EmployeesTableAdapter` et en sélectionnant configurer dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="8c017-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="8c017-231">Ceci fait apparaître l’Assistant Configuration de TableAdapter, qui répertorie les procédures stockées utilisées pour la sélection, insertion, mise à jour et suppression, ainsi que leurs valeurs de retour et les paramètres (le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="8c017-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="8c017-232">La figure 10 illustre cet Assistant.</span><span class="sxs-lookup"><span data-stu-id="8c017-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="8c017-233">Ici, nous pouvons voir que le `Employees_Select` procédure stockée maintenant renvoie le `ManagerFirstName` et `ManagerLastName` champs.</span><span class="sxs-lookup"><span data-stu-id="8c017-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="8c017-234">[![Le montre l’Assistant la liste des colonnes mises à jour pour le Employees_Select de procédure stockée](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="8c017-235">**Figure 10**: L’Assistant affiche la liste des colonnes mises à jour pour le `Employees_Select` la procédure stockée ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>


<span data-ttu-id="8c017-236">Terminez l’Assistant en cliquant sur Terminer.</span><span class="sxs-lookup"><span data-stu-id="8c017-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="8c017-237">Une fois de retour vers le Concepteur de DataSet, la `EmployeesDataTable` inclut deux colonnes supplémentaires : `ManagerFirstName` et `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="8c017-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="8c017-238">[![Le EmployeesDataTable contient deux nouvelles colonnes](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="8c017-239">**Figure 11**: Le `EmployeesDataTable` contient deux nouvelles colonnes ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>


<span data-ttu-id="8c017-240">Pour montrer que la mise à jour `Employees_Select` procédure stockée est en vigueur et que l’instruction insert, update et delete des fonctionnalités du TableAdapter sont toujours fonctionnels, s permettent de créer une page web qui permet aux utilisateurs d’afficher et supprimer des employés.</span><span class="sxs-lookup"><span data-stu-id="8c017-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="8c017-241">Avant de créer une telle page, toutefois, nous devons tout d’abord créer une nouvelle classe dans la couche de logique métier pour travailler avec les employés de la `NorthwindWithSprocs` jeu de données.</span><span class="sxs-lookup"><span data-stu-id="8c017-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="8c017-242">À l’étape 4, nous allons créer un `EmployeesBLLWithSprocs` classe.</span><span class="sxs-lookup"><span data-stu-id="8c017-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="8c017-243">À l’étape 5, nous allons utiliser cette classe à partir d’une page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8c017-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="8c017-244">Étape 4 : Implémentation de la couche de logique métier</span><span class="sxs-lookup"><span data-stu-id="8c017-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="8c017-245">Créer un nouveau fichier de classe dans le `~/App_Code/BLL` dossier nommé `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="8c017-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="8c017-246">Cette classe imite la sémantique existants `EmployeesBLL` (classe), uniquement cette nouvelle une fournit des méthodes moins et utilise le `NorthwindWithSprocs` jeu de données (au lieu du `Northwind` jeu de données).</span><span class="sxs-lookup"><span data-stu-id="8c017-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="8c017-247">Ajoutez le code suivant à la classe `EmployeesBLLWithSprocs` .</span><span class="sxs-lookup"><span data-stu-id="8c017-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="8c017-248">Le `EmployeesBLLWithSprocs` classe s `Adapter` propriété retourne une instance de la `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="8c017-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="8c017-249">Cela est utilisé par la classe s `GetEmployees` et `DeleteEmployee` méthodes.</span><span class="sxs-lookup"><span data-stu-id="8c017-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="8c017-250">Le `GetEmployees` les appels de méthode le `EmployeesTableAdapter` s correspondant `GetEmployees` (méthode), qui appelle le `Employees_Select` procédure stockée et remplit ses résultats dans un `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c017-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="8c017-251">Le `DeleteEmployee` méthode même appelle le `EmployeesTableAdapter` s `Delete` (méthode), qui appelle le `Employees_Delete` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="8c017-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="8c017-252">Étape 5 : Utilisation des données dans la couche de présentation</span><span class="sxs-lookup"><span data-stu-id="8c017-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="8c017-253">Avec la `EmployeesBLLWithSprocs` classe terminée, nous vous êtes prêt à travailler avec des données sur les employés via une page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8c017-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="8c017-254">Ouvrir le `JOINs.aspx` page dans le `AdvancedDAL` dossier et faites glisser un GridView à partir de la boîte à outils vers le concepteur, en définissant son `ID` propriété `Employees`.</span><span class="sxs-lookup"><span data-stu-id="8c017-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="8c017-255">Ensuite, à partir de la balise active de s GridView, lier la grille pour un nouveau contrôle ObjectDataSource nommé `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8c017-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="8c017-256">Configurer l’ObjectDataSource à utiliser le `EmployeesBLLWithSprocs` classe et, dans les onglets SELECT et DELETE, vérifiez que le `GetEmployees` et `DeleteEmployee` méthodes sont sélectionnés dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="8c017-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="8c017-257">Cliquez sur Terminer pour terminer la configuration de s ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8c017-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="8c017-258">[![Configurer pour utiliser la classe EmployeesBLLWithSprocs ObjectDataSource](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="8c017-259">**Figure 12**: Configurer l’ObjectDataSource à utiliser le `EmployeesBLLWithSprocs` classe ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>


<span data-ttu-id="8c017-260">[![Avoir l’utilisation de l’ObjectDataSource les GetEmployees et les méthodes de DeleteEmployee](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="8c017-261">**Figure 13**: Avoir l’utilisation de l’ObjectDataSource le `GetEmployees` et `DeleteEmployee` méthodes ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>


<span data-ttu-id="8c017-262">Visual Studio ajoutera un BoundField au GridView pour chacun de la `EmployeesDataTable` des colonnes de s.</span><span class="sxs-lookup"><span data-stu-id="8c017-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="8c017-263">Supprimez tous ces BoundFields à l’exception de `Title`, `LastName`, `FirstName`, `ManagerFirstName`, et `ManagerLastName` et renommer le `HeaderText` propriétés pour les quatre derniers BoundFields pour nom, prénom, prénom Manager s, et Gestionnaire de s nom, respectivement.</span><span class="sxs-lookup"><span data-stu-id="8c017-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="8c017-264">Pour permettre aux utilisateurs de supprimer des employés à partir de cette page, nous devons faire deux choses.</span><span class="sxs-lookup"><span data-stu-id="8c017-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="8c017-265">Tout d’abord, demandez à GridView pour fournir des capacités de suppression en sélectionnant l’option Activer la suppression à partir de sa balise active.</span><span class="sxs-lookup"><span data-stu-id="8c017-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="8c017-266">Ensuite, modifiez le s ObjectDataSource `OldValuesParameterFormatString` propriété à partir de la valeur définie par l’Assistant ObjectDataSource (`original_{0}`) à sa valeur par défaut (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="8c017-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="8c017-267">Après avoir apporté ces modifications, votre balisage déclaratif s GridView et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="8c017-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="8c017-268">Tester la page en accédant à via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="8c017-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="8c017-269">Comme le montre la Figure 14, la page répertorie chaque employé et son gestionnaire s nom (en supposant qu’il en a une).</span><span class="sxs-lookup"><span data-stu-id="8c017-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="8c017-270">[![La jointure dans la Employees_Select procédure stockée renvoie le nom de s Manager](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="8c017-271">**Figure 14**: Le `JOIN` dans le `Employees_Select` procédure stockée retourne le nom de gestionnaire ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>


<span data-ttu-id="8c017-272">En cliquant sur le bouton Supprimer démarre le workflow de suppression, ce qui se termine par l’exécution de la `Employees_Delete` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="8c017-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="8c017-273">Toutefois, la tentative `DELETE` instruction dans la procédure stockée échoue en raison d’une violation de contrainte de clé étrangère (voir Figure 15).</span><span class="sxs-lookup"><span data-stu-id="8c017-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="8c017-274">Plus précisément, chaque employé possède un ou plusieurs enregistrements la `Orders` table, à l’origine de la suppression échoue.</span><span class="sxs-lookup"><span data-stu-id="8c017-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="8c017-275">[![Suppression d’un employé qui a des résultats de commandes correspondantes dans une Violation de contrainte de clé étrangère](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="8c017-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="8c017-276">**Figure 15**: Suppression d’un employé qui a des résultats de commandes correspondantes dans une Violation de contrainte de clé étrangère ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="8c017-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>


<span data-ttu-id="8c017-277">Pour autoriser un employé à être supprimé vous pouvez :</span><span class="sxs-lookup"><span data-stu-id="8c017-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="8c017-278">Mettre à jour de la contrainte de clé étrangère pour enchaîner des suppressions,</span><span class="sxs-lookup"><span data-stu-id="8c017-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="8c017-279">Supprimez manuellement les enregistrements à partir de la `Orders` table des employés que vous souhaitez supprimer, ou</span><span class="sxs-lookup"><span data-stu-id="8c017-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="8c017-280">Mise à jour le `Employees_Delete` procédure stockée pour tout d’abord supprimer les enregistrements associés à partir de la `Orders` table avant de supprimer le `Employees` enregistrement.</span><span class="sxs-lookup"><span data-stu-id="8c017-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="8c017-281">Nous avons abordé cette technique dans le [à l’aide des procédures stockées existantes pour s DataSet typée TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="8c017-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="8c017-282">Je laisse cela en guise d’exercice pour le lecteur.</span><span class="sxs-lookup"><span data-stu-id="8c017-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="8c017-283">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="8c017-283">Summary</span></span>

<span data-ttu-id="8c017-284">Lorsque vous travaillez avec des bases de données relationnelle, il est courant pour les requêtes extraire leurs données à partir de plusieurs des tables associées.</span><span class="sxs-lookup"><span data-stu-id="8c017-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="8c017-285">Sous-requêtes en corrélation et `JOIN` fournissent deux techniques différentes pour accéder aux données à partir de tables associées dans une requête.</span><span class="sxs-lookup"><span data-stu-id="8c017-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="8c017-286">Dans des didacticiels précédents, nous avons apporté plus fréquemment utilisent des sous-requêtes corrélées, car le TableAdapter ne peut pas générer automatiquement `INSERT`, `UPDATE`, et `DELETE` instructions pour les requêtes impliquant `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="8c017-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="8c017-287">Bien que ces valeurs peuvent être fournies manuellement, lors de l’utilisation d’instructions SQL ad hoc toutes les personnalisations sont remplacées lorsque l’Assistant Configuration de TableAdapter est terminé.</span><span class="sxs-lookup"><span data-stu-id="8c017-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="8c017-288">Heureusement, les TableAdapters créés à l’aide de procédures stockées ne sont pas confrontés à partir de la fragilité de même que ceux créés à l’aide d’instructions SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="8c017-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="8c017-289">Par conséquent, il est possible de créer un TableAdapter dont requête principale utilise un `JOIN` lors de l’utilisation de procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="8c017-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="8c017-290">Dans ce didacticiel, nous avons vu comment créer un TableAdapter de ce type.</span><span class="sxs-lookup"><span data-stu-id="8c017-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="8c017-291">Nous avons commencé à l’aide un `JOIN`-moins `SELECT` de requête pour la requête principale de TableAdapter s afin que le correspondante insert, update et les procédures de suppression stockée soient créées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="8c017-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="8c017-292">Le TableAdapter s initial configuration terminée, nous avons augmenté la `SelectCommand` une procédure stockée à utiliser un `JOIN` et ré-exécuté l’Assistant Configuration de TableAdapter pour mettre à jour le `EmployeesDataTable` des colonnes de s.</span><span class="sxs-lookup"><span data-stu-id="8c017-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="8c017-293">Exécuter à nouveau l’Assistant Configuration de TableAdapter automatiquement mis à jour le `EmployeesDataTable` colonnes afin de refléter les champs de données retournés par la `Employees_Select` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="8c017-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="8c017-294">Vous pouvez également nous aurions pu ajouter ces colonnes manuellement au DataTable.</span><span class="sxs-lookup"><span data-stu-id="8c017-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="8c017-295">Nous allons explorer les ajouter manuellement des colonnes au DataTable dans le didacticiel suivant.</span><span class="sxs-lookup"><span data-stu-id="8c017-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="8c017-296">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="8c017-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8c017-297">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="8c017-297">About the Author</span></span>

<span data-ttu-id="8c017-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="8c017-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8c017-299">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="8c017-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8c017-300">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8c017-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8c017-301">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8c017-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8c017-302">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8c017-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8c017-303">Remerciements</span><span class="sxs-lookup"><span data-stu-id="8c017-303">Special Thanks To</span></span>

<span data-ttu-id="8c017-304">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="8c017-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8c017-305">Les réviseurs tête pour ce didacticiel ont été Hilton Geisenow, David Suru et Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="8c017-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="8c017-306">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="8c017-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8c017-307">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8c017-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8c017-308">[Précédent](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Suivant](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8c017-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
