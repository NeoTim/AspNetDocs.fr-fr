---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: Mise à jour du TableAdapter pour utiliser des JOINTUREs (C#) | Microsoft Docs
author: rick-anderson
description: Lors de l’utilisation d’une base de données, il est courant de demander des données réparties sur plusieurs tables. Pour récupérer des données de deux tables différentes, nous pouvons les utiliser...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: 24ff3645783dabfcdef5ac313a2d4833e4998efc
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78532556"
---
# <a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="54c0b-104">Mise à jour du TableAdapter pour l’utilisation de jointures (C#)</span><span class="sxs-lookup"><span data-stu-id="54c0b-104">Updating the TableAdapter to Use JOINs (C#)</span></span>

<span data-ttu-id="54c0b-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="54c0b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="54c0b-106">[Télécharger le code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) ou [Télécharger le PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="54c0b-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="54c0b-107">Lors de l’utilisation d’une base de données, il est courant de demander des données réparties sur plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="54c0b-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="54c0b-108">Pour extraire des données de deux tables différentes, vous pouvez utiliser une sous-requête corrélée ou une opération de jointure.</span><span class="sxs-lookup"><span data-stu-id="54c0b-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="54c0b-109">Dans ce didacticiel, nous comparons les sous-requêtes corrélées et la syntaxe de jointure avant d’examiner comment créer un TableAdapter qui comprend une jointure dans sa requête principale.</span><span class="sxs-lookup"><span data-stu-id="54c0b-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="54c0b-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="54c0b-110">Introduction</span></span>

<span data-ttu-id="54c0b-111">Avec les bases de données relationnelles, les données qui nous intéressent sont souvent réparties sur plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="54c0b-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="54c0b-112">Par exemple, lors de l’affichage des informations sur les produits, nous souhaitons probablement répertorier les noms des catégories et des fournisseurs correspondants pour chaque produit.</span><span class="sxs-lookup"><span data-stu-id="54c0b-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="54c0b-113">La table `Products` a des valeurs `CategoryID` et `SupplierID`, mais les noms des catégories et des fournisseurs réels sont respectivement dans les tables `Categories` et `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="54c0b-114">Pour récupérer des informations à partir d’une autre table associée, nous pouvons soit utiliser des sous- *requêtes corrélées* , soit `JOIN`*s*.</span><span class="sxs-lookup"><span data-stu-id="54c0b-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="54c0b-115">Une sous-requête corrélée est une requête de `SELECT` imbriquée qui fait référence à des colonnes dans la requête externe.</span><span class="sxs-lookup"><span data-stu-id="54c0b-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="54c0b-116">Par exemple, dans le didacticiel [création d’une couche d’accès aux données](../introduction/creating-a-data-access-layer-cs.md) , nous avons utilisé deux sous-requêtes corrélées dans la requête principale de `ProductsTableAdapter` s pour retourner les noms des catégories et des fournisseurs pour chaque produit.</span><span class="sxs-lookup"><span data-stu-id="54c0b-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="54c0b-117">Une `JOIN` est une construction SQL qui fusionne les lignes associées de deux tables différentes.</span><span class="sxs-lookup"><span data-stu-id="54c0b-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="54c0b-118">Nous avons utilisé une `JOIN` dans le didacticiel sur l' [interrogation des données avec le contrôle SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) pour afficher les informations de catégorie à côté de chaque produit.</span><span class="sxs-lookup"><span data-stu-id="54c0b-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="54c0b-119">La raison de l’utilisation de `JOIN` s avec les TableAdapters est due aux limitations de l’Assistant TableAdapter s pour générer automatiquement les instructions `INSERT`, `UPDATE`et `DELETE` correspondantes.</span><span class="sxs-lookup"><span data-stu-id="54c0b-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="54c0b-120">Plus précisément, si la requête principale du TableAdapter contient des `JOIN` s, le TableAdapter ne peut pas créer automatiquement les instructions SQL ou les procédures stockées ad hoc pour ses propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="54c0b-121">Dans ce didacticiel, nous allons brièvement comparer et opposer les sous-requêtes corrélées et les `JOIN` s avant d’explorer la création d’un TableAdapter qui comprend `JOIN` s dans sa requête principale.</span><span class="sxs-lookup"><span data-stu-id="54c0b-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="54c0b-122">Comparaison et différences entre les sous-requêtes corrélées et les`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="54c0b-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="54c0b-123">Rappelez-vous que le `ProductsTableAdapter` créé dans le premier didacticiel du jeu de données `Northwind` utilise des sous-requêtes corrélées pour rétablir chaque nom de catégorie et de fournisseur correspondant au produit.</span><span class="sxs-lookup"><span data-stu-id="54c0b-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="54c0b-124">La requête principale `ProductsTableAdapter` s est indiquée ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="54c0b-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="54c0b-125">Les deux sous-requêtes corrélées-`(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` et `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` sont des requêtes `SELECT` qui renvoient une valeur unique par produit sous la forme d’une colonne supplémentaire dans la liste des colonnes de l’instruction de `SELECT` externe.</span><span class="sxs-lookup"><span data-stu-id="54c0b-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="54c0b-126">Une `JOIN` peut également être utilisée pour retourner chaque fournisseur et nom de catégorie du produit.</span><span class="sxs-lookup"><span data-stu-id="54c0b-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="54c0b-127">La requête suivante retourne la même sortie que la sortie ci-dessus, mais utilise `JOIN` s à la place des sous-requêtes :</span><span class="sxs-lookup"><span data-stu-id="54c0b-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="54c0b-128">Un `JOIN` fusionne les enregistrements d’une table avec les enregistrements d’une autre table en fonction de certains critères.</span><span class="sxs-lookup"><span data-stu-id="54c0b-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="54c0b-129">Dans la requête ci-dessus, par exemple, le `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` indique à SQL Server de fusionner chaque enregistrement de produit avec l’enregistrement de catégorie dont la valeur `CategoryID` correspond à la valeur `CategoryID` du produit.</span><span class="sxs-lookup"><span data-stu-id="54c0b-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="54c0b-130">Le résultat fusionné nous permet de travailler avec les champs de catégorie correspondants pour chaque produit (par exemple, `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="54c0b-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="54c0b-131">les `JOIN` s sont couramment utilisés lors de l’interrogation de données à partir de bases de données relationnelles.</span><span class="sxs-lookup"><span data-stu-id="54c0b-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="54c0b-132">Si vous ne connaissez pas la syntaxe de la `JOIN` ou si vous avez besoin de monter un peu sur son utilisation, j’ai recommandé le didacticiel sur la [jointure SQL](http://www.w3schools.com/sql/sql_join.asp) dans [W3 Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="54c0b-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="54c0b-133">Il est également utile de lire les sections notions de base des [`JOIN`](https://msdn.microsoft.com/library/ms191517.aspx) et [sous-requêtes](https://msdn.microsoft.com/library/ms189575.aspx) de la [documentation en ligne de SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="54c0b-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="54c0b-134">Étant donné que les `JOIN` s et les sous-requêtes corrélées peuvent être utilisées pour récupérer des données associées à partir d’autres tables, de nombreux développeurs n’ont pas oublié leurs têtes et se demandent quelle approche utiliser.</span><span class="sxs-lookup"><span data-stu-id="54c0b-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="54c0b-135">Tous les gourous SQL que j’ai parlés ont dit à peu près la même chose, qu’il n’a pas vraiment d’importance pour les performances, car SQL Server produira approximativement des plans d’exécution identiques.</span><span class="sxs-lookup"><span data-stu-id="54c0b-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="54c0b-136">Leur avis est ensuite d’utiliser la technique avec laquelle vous et votre équipe êtes le plus à l’aise.</span><span class="sxs-lookup"><span data-stu-id="54c0b-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="54c0b-137">Il est de plus en plus à noter qu’après avoir fait part de ces conseils, ces experts expriment immédiatement leur préférence de `JOIN` s par rapport à des sous-requêtes corrélées.</span><span class="sxs-lookup"><span data-stu-id="54c0b-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="54c0b-138">Lorsque vous créez une couche d’accès aux données à l’aide de DataSets typés, les outils fonctionnent mieux lorsque vous utilisez des sous-requêtes.</span><span class="sxs-lookup"><span data-stu-id="54c0b-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="54c0b-139">En particulier, l’Assistant TableAdapter s ne génère pas automatiquement les instructions `INSERT`, `UPDATE`et `DELETE` correspondantes si la requête principale contient des `JOIN` s, mais génère automatiquement ces instructions lorsque des sous-requêtes corrélées sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="54c0b-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="54c0b-140">Pour explorer cette lacune, créez un jeu de données temporaire typé dans le dossier `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="54c0b-141">Pendant l’Assistant Configuration de TableAdapter, choisissez d’utiliser des instructions SQL ad hoc et entrez la requête `SELECT` suivante (voir la figure 1) :</span><span class="sxs-lookup"><span data-stu-id="54c0b-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]

<span data-ttu-id="54c0b-142">[![entrez une requête principale qui contient des JOINTUREs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="54c0b-143">**Figure 1**: entrer une requête principale contenant `JOIN` s ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>

<span data-ttu-id="54c0b-144">Par défaut, le TableAdapter crée automatiquement les instructions `INSERT`, `UPDATE`et `DELETE` en fonction de la requête principale.</span><span class="sxs-lookup"><span data-stu-id="54c0b-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="54c0b-145">Si vous cliquez sur le bouton avancé, vous pouvez voir que cette fonctionnalité est activée.</span><span class="sxs-lookup"><span data-stu-id="54c0b-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="54c0b-146">Malgré ce paramètre, le TableAdapter ne peut pas créer les instructions `INSERT`, `UPDATE`et `DELETE`, car la requête principale contient un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Entrer une requête principale qui contient des JOINTUREs](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="54c0b-148">**Figure 2**: entrer une requête principale contenant `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="54c0b-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="54c0b-149">Cliquez sur Terminer pour terminer l'Assistant.</span><span class="sxs-lookup"><span data-stu-id="54c0b-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="54c0b-150">À ce stade, le concepteur de votre jeu de données inclut un TableAdapter unique avec un DataTable avec des colonnes pour chacun des champs retournés dans la liste de colonnes `SELECT` requête s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="54c0b-151">Cela comprend les `CategoryName` et les `SupplierName`, comme illustré dans la figure 3.</span><span class="sxs-lookup"><span data-stu-id="54c0b-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![Le DataTable contient une colonne pour chaque champ retourné dans la liste des colonnes](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="54c0b-153">**Figure 3**: le DataTable contient une colonne pour chaque champ retourné dans la liste des colonnes</span><span class="sxs-lookup"><span data-stu-id="54c0b-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="54c0b-154">Tandis que le DataTable contient les colonnes appropriées, le TableAdapter n’a pas de valeurs pour ses propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="54c0b-155">Pour confirmer cela, cliquez sur le TableAdapter dans le concepteur, puis accédez au Fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="54c0b-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="54c0b-156">Vous verrez que les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand` sont définies sur (aucune).</span><span class="sxs-lookup"><span data-stu-id="54c0b-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="54c0b-157">[![les propriétés InsertCommand, UpdateCommand et DeleteCommand ont la valeur (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="54c0b-158">**Figure 4**: les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand` sont définies sur (aucune) ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>

<span data-ttu-id="54c0b-159">Pour contourner ce manque, nous pouvons fournir manuellement les instructions et les paramètres SQL pour les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand` via le Fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="54c0b-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="54c0b-160">Vous pouvez également commencer par configurer la requête principale du TableAdapter pour qu’il *n'* inclut aucun `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="54c0b-161">Cela permet aux instructions `INSERT`, `UPDATE`et `DELETE` d’être générées automatiquement pour nous.</span><span class="sxs-lookup"><span data-stu-id="54c0b-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="54c0b-162">À la fin de l’Assistant, nous pourrions ensuite mettre à jour manuellement les `SelectCommand` du TableAdapter à partir de la Fenêtre Propriétés afin qu’il inclue la syntaxe de `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="54c0b-163">Bien que cette approche fonctionne, elle est très fragile quand vous utilisez des requêtes SQL ad hoc, car chaque fois que la requête principale du TableAdapter est reconfigurée par le biais de l’Assistant, les instructions générées automatiquement `INSERT`, `UPDATE`et `DELETE` sont recréées.</span><span class="sxs-lookup"><span data-stu-id="54c0b-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="54c0b-164">Cela signifie que toutes les personnalisations que nous avons effectuées par la suite seraient perdues si vous cliquez avec le bouton droit sur le TableAdapter, que vous avez choisi configurer dans le menu contextuel et que vous avez reterminé l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="54c0b-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="54c0b-165">La fragilité des instructions générées automatiquement `INSERT`, `UPDATE`et `DELETE` du TableAdapter est, heureusement, limitée aux instructions SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="54c0b-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="54c0b-166">Si votre TableAdapter utilise des procédures stockées, vous pouvez personnaliser les procédures stockées `SelectCommand`, `InsertCommand`, `UpdateCommand`ou `DeleteCommand`, puis réexécuter l’Assistant Configuration de TableAdapter sans craindre que les procédures stockées soient modifiées.</span><span class="sxs-lookup"><span data-stu-id="54c0b-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="54c0b-167">Au cours des différentes étapes suivantes, nous allons créer un TableAdapter qui, à l’origine, utilise une requête principale qui omet tout `JOIN` s afin que les procédures stockées d’insertion, de mise à jour et de suppression correspondantes soient générées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="54c0b-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="54c0b-168">Nous allons ensuite mettre à jour le `SelectCommand` afin que utilise un `JOIN` qui retourne des colonnes supplémentaires à partir de tables associées.</span><span class="sxs-lookup"><span data-stu-id="54c0b-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="54c0b-169">Enfin, nous allons créer une classe de couche de logique métier correspondante et illustrer l’utilisation du TableAdapter dans une page Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="54c0b-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="54c0b-170">Étape 1 : création du TableAdapter à l’aide d’une requête principale simplifiée</span><span class="sxs-lookup"><span data-stu-id="54c0b-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="54c0b-171">Pour ce didacticiel, nous allons ajouter un TableAdapter et un DataTable fortement typés pour la table `Employees` dans le jeu de données `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="54c0b-172">La table `Employees` contient un champ `ReportsTo` qui spécifie la `EmployeeID` du gestionnaire des employés.</span><span class="sxs-lookup"><span data-stu-id="54c0b-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="54c0b-173">Par exemple, l’employé Anne Dodsworth a une valeur `ReportTo` de 5, qui est la `EmployeeID` de Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="54c0b-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="54c0b-174">Par conséquent, Anne signale à Steven, son responsable.</span><span class="sxs-lookup"><span data-stu-id="54c0b-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="54c0b-175">En plus de signaler chaque valeur de `ReportsTo` d’employé, nous pouvons également récupérer le nom de son responsable.</span><span class="sxs-lookup"><span data-stu-id="54c0b-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="54c0b-176">Cela peut être accompli à l’aide d’un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="54c0b-177">Toutefois, l’utilisation d’un `JOIN` lors de la création initiale du TableAdapter empêche l’Assistant de générer automatiquement les fonctionnalités d’insertion, de mise à jour et de suppression correspondantes.</span><span class="sxs-lookup"><span data-stu-id="54c0b-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="54c0b-178">Par conséquent, nous allons commencer par créer un TableAdapter dont la requête principale ne contient aucun `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="54c0b-179">Ensuite, à l’étape 2, nous allons mettre à jour la procédure stockée principale de la requête pour récupérer le nom du responsable via un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="54c0b-180">Commencez par ouvrir le jeu de données `NorthwindWithSprocs` dans le dossier `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="54c0b-181">Cliquez avec le bouton droit sur le concepteur, sélectionnez l’option Ajouter dans le menu contextuel, puis choisissez l’élément de menu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="54c0b-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="54c0b-182">L’Assistant Configuration de TableAdapter est lancé.</span><span class="sxs-lookup"><span data-stu-id="54c0b-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="54c0b-183">Comme illustré à la figure 5, utilisez l’Assistant pour créer de nouvelles procédures stockées, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="54c0b-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="54c0b-184">Pour obtenir un actualisateur sur la création de nouvelles procédures stockées à partir de l’Assistant TableAdapter, consultez le didacticiel [création de nouvelles procédures stockées pour les TableAdapters de DataSet typé](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="54c0b-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="54c0b-185">[![sélectionnez l’option créer de nouvelles procédures stockées](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="54c0b-186">**Figure 5**: sélectionnez l’option créer de nouvelles procédures stockées ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>

<span data-ttu-id="54c0b-187">Utilisez l’instruction `SELECT` suivante pour la requête principale du TableAdapter :</span><span class="sxs-lookup"><span data-stu-id="54c0b-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="54c0b-188">Étant donné que cette requête n’inclut aucun `JOIN`, l’Assistant TableAdapter crée automatiquement des procédures stockées avec les instructions `INSERT`, `UPDATE`et `DELETE` correspondantes, ainsi qu’une procédure stockée pour l’exécution de la requête principale.</span><span class="sxs-lookup"><span data-stu-id="54c0b-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="54c0b-189">L’étape suivante nous permet de nommer les procédures stockées du TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="54c0b-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="54c0b-190">Utilisez les noms `Employees_Select`, `Employees_Insert`, `Employees_Update`et `Employees_Delete`, comme illustré à la figure 6.</span><span class="sxs-lookup"><span data-stu-id="54c0b-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="54c0b-191">[![nom des procédures stockées du TableAdapter](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="54c0b-192">**Figure 6**: nommer les procédures stockées du TableAdapter ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>

<span data-ttu-id="54c0b-193">L’étape finale nous invite à nommer les méthodes de TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="54c0b-194">Utilisez `Fill` et `GetEmployees` comme noms de méthode.</span><span class="sxs-lookup"><span data-stu-id="54c0b-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="54c0b-195">Veillez également à activer la case à cocher créer des méthodes pour envoyer directement des mises à jour à la base de données (GenerateDBDirectMethods).</span><span class="sxs-lookup"><span data-stu-id="54c0b-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="54c0b-196">[Nom de l' ![les méthodes Fill et GetEmployees du TableAdapter](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="54c0b-197">**Figure 7**: nommer les méthodes de TableAdapter s `Fill` et `GetEmployees` ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>

<span data-ttu-id="54c0b-198">Après avoir terminé l’Assistant, prenez un moment pour examiner les procédures stockées dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="54c0b-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="54c0b-199">Vous devez en voir quatre nouvelles : `Employees_Select`, `Employees_Insert`, `Employees_Update`et `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="54c0b-200">Ensuite, examinez le `EmployeesDataTable` et `EmployeesTableAdapter` venez de créer.</span><span class="sxs-lookup"><span data-stu-id="54c0b-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="54c0b-201">Le DataTable contient une colonne pour chaque champ retourné par la requête principale.</span><span class="sxs-lookup"><span data-stu-id="54c0b-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="54c0b-202">Cliquez sur le TableAdapter, puis accédez au Fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="54c0b-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="54c0b-203">Vous verrez que les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand` sont correctement configurées pour appeler les procédures stockées correspondantes.</span><span class="sxs-lookup"><span data-stu-id="54c0b-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="54c0b-204">[![le TableAdapter comprend des fonctionnalités d’insertion, de mise à jour et de suppression](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="54c0b-205">**Figure 8**: le TableAdapter comprend des fonctionnalités d’insertion, de mise à jour et de suppression ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>

<span data-ttu-id="54c0b-206">Une fois les procédures stockées INSERT, Update et Delete créées automatiquement et les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand` correctement configurées, nous sommes prêts à personnaliser la procédure stockée `SelectCommand` s pour qu’elle renvoie des informations supplémentaires sur chaque gestionnaire des employés.</span><span class="sxs-lookup"><span data-stu-id="54c0b-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="54c0b-207">En particulier, nous devons mettre à jour la procédure stockée `Employees_Select` pour utiliser une `JOIN` et retourner les valeurs `FirstName` et `LastName` du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="54c0b-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="54c0b-208">Après la mise à jour de la procédure stockée, nous devons mettre à jour le DataTable afin qu’il inclue ces colonnes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="54c0b-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="54c0b-209">Nous allons aborder ces deux tâches aux étapes 2 et 3.</span><span class="sxs-lookup"><span data-stu-id="54c0b-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="54c0b-210">Étape 2 : personnalisation de la procédure stockée pour inclure une`JOIN`</span><span class="sxs-lookup"><span data-stu-id="54c0b-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="54c0b-211">Commencez par accéder à la Explorateur de serveurs, en explorant le dossier des procédures stockées de la base de données Northwind et en ouvrant la procédure stockée `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="54c0b-212">Si vous ne voyez pas cette procédure stockée, cliquez avec le bouton droit sur le dossier procédures stockées, puis choisissez actualiser.</span><span class="sxs-lookup"><span data-stu-id="54c0b-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="54c0b-213">Mettez à jour la procédure stockée pour qu’elle utilise une `LEFT JOIN` pour retourner le nom et le prénom du gestionnaire :</span><span class="sxs-lookup"><span data-stu-id="54c0b-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="54c0b-214">Après avoir mis à jour l’instruction `SELECT`, enregistrez les modifications en accédant au menu fichier, puis en choisissant enregistrer `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="54c0b-215">Vous pouvez également cliquer sur l’icône Enregistrer dans la barre d’outils ou appuyer sur CTRL + S.</span><span class="sxs-lookup"><span data-stu-id="54c0b-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="54c0b-216">Après avoir enregistré vos modifications, cliquez avec le bouton droit sur la procédure stockée `Employees_Select` dans le Explorateur de serveurs puis sélectionnez Exécuter.</span><span class="sxs-lookup"><span data-stu-id="54c0b-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="54c0b-217">Cette opération exécute la procédure stockée et affiche ses résultats dans la fenêtre sortie (voir figure 9).</span><span class="sxs-lookup"><span data-stu-id="54c0b-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="54c0b-218">[![les résultats des procédures stockées s’affichent dans la Fenêtre Sortie](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="54c0b-219">**Figure 9**: les résultats des procédures stockées s’affichent dans la fenêtre sortie ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="54c0b-220">Étape 3 : mise à jour des colonnes du DataTable s</span><span class="sxs-lookup"><span data-stu-id="54c0b-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="54c0b-221">À ce stade, la procédure stockée `Employees_Select` retourne `ManagerFirstName` et `ManagerLastName` valeurs, mais ces colonnes ne sont pas présentes dans le `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="54c0b-222">Ces colonnes manquantes peuvent être ajoutées à l’objet DataTable de l’une des deux manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="54c0b-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="54c0b-223">**Manuellement** , cliquez avec le bouton droit sur le DataTable dans le concepteur de DataSet et, dans le menu Ajouter, choisissez colonne.</span><span class="sxs-lookup"><span data-stu-id="54c0b-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="54c0b-224">Vous pouvez ensuite nommer la colonne et définir ses propriétés en conséquence.</span><span class="sxs-lookup"><span data-stu-id="54c0b-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="54c0b-225">**Automatiquement** : l’Assistant Configuration de TableAdapter met à jour les colonnes DataTable s pour refléter les champs retournés par la procédure stockée `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="54c0b-226">Lorsque vous utilisez des instructions SQL ad hoc, l’Assistant supprime également les propriétés `InsertCommand`, `UpdateCommand`et `DeleteCommand`, puisque le `SelectCommand` contient maintenant une `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="54c0b-227">Toutefois, lorsque vous utilisez des procédures stockées, ces propriétés de commande restent intactes.</span><span class="sxs-lookup"><span data-stu-id="54c0b-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="54c0b-228">Nous avons exploré manuellement l’ajout de colonnes de DataTable dans les didacticiels précédents, notamment le [maître/détail à l’aide d’une liste à puces d’enregistrements principaux avec les détails DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) et le [chargement de fichiers](../working-with-binary-files/uploading-files-cs.md), et nous examinerons à nouveau ce processus plus en détail dans le didacticiel suivant.</span><span class="sxs-lookup"><span data-stu-id="54c0b-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="54c0b-229">Pour ce didacticiel, toutefois, nous allons utiliser l’approche automatique via l’Assistant Configuration de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="54c0b-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="54c0b-230">Commencez par cliquer avec le bouton droit sur le `EmployeesTableAdapter` et sélectionnez configurer dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="54c0b-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="54c0b-231">L’Assistant Configuration de TableAdapter s’affiche, qui répertorie les procédures stockées utilisées pour la sélection, l’insertion, la mise à jour et la suppression, ainsi que les valeurs de retour et les paramètres (le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="54c0b-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="54c0b-232">La figure 10 illustre cet Assistant.</span><span class="sxs-lookup"><span data-stu-id="54c0b-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="54c0b-233">Ici, nous pouvons voir que la procédure stockée `Employees_Select` retourne désormais les champs `ManagerFirstName` et `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="54c0b-234">[![l’Assistant affiche la liste des colonnes mises à jour pour la procédure stockée Employees_Select](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="54c0b-235">**Figure 10**: l’Assistant affiche la liste des colonnes mises à jour pour la procédure stockée `Employees_Select` ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>

<span data-ttu-id="54c0b-236">Terminez l’Assistant en cliquant sur Terminer.</span><span class="sxs-lookup"><span data-stu-id="54c0b-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="54c0b-237">Lors du retour au concepteur de DataSet, le `EmployeesDataTable` comprend deux colonnes supplémentaires : `ManagerFirstName` et `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="54c0b-238">[![EmployeesDataTable contient deux nouvelles colonnes](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="54c0b-239">**Figure 11**: le `EmployeesDataTable` contient deux nouvelles colonnes ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>

<span data-ttu-id="54c0b-240">Pour illustrer que la procédure stockée `Employees_Select` mise à jour est en vigueur et que les fonctionnalités d’insertion, de mise à jour et de suppression du TableAdapter sont toujours fonctionnelles, créez une page Web qui permet aux utilisateurs d’afficher et de supprimer des employés.</span><span class="sxs-lookup"><span data-stu-id="54c0b-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="54c0b-241">Avant de créer une telle page, toutefois, nous devons d’abord créer une nouvelle classe dans la couche de logique métier pour travailler avec des employés à partir du jeu de données `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="54c0b-242">À l’étape 4, nous allons créer une classe `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="54c0b-243">À l’étape 5, nous utiliserons cette classe à partir d’une page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="54c0b-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="54c0b-244">Étape 4 : implémentation de la couche de logique métier</span><span class="sxs-lookup"><span data-stu-id="54c0b-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="54c0b-245">Créez un nouveau fichier de classe dans le dossier `~/App_Code/BLL` nommé `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="54c0b-246">Cette classe imite la sémantique de la classe de `EmployeesBLL` existante, seul celle-ci fournit moins de méthodes et utilise le jeu de données `NorthwindWithSprocs` (au lieu du DataSet `Northwind`).</span><span class="sxs-lookup"><span data-stu-id="54c0b-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="54c0b-247">Ajoutez le code suivant à la classe `EmployeesBLLWithSprocs` .</span><span class="sxs-lookup"><span data-stu-id="54c0b-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="54c0b-248">La propriété de la classe `EmployeesBLLWithSprocs` s `Adapter` retourne une instance du `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="54c0b-249">Cela est utilisé par les méthodes `GetEmployees` et `DeleteEmployee`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="54c0b-250">La méthode `GetEmployees` appelle la méthode `GetEmployees` correspondante `EmployeesTableAdapter`, qui appelle la procédure stockée `Employees_Select` et remplit ses résultats dans un `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="54c0b-251">La méthode `DeleteEmployee` appelle de la même manière la méthode `EmployeesTableAdapter` s `Delete`, qui appelle la procédure stockée `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="54c0b-252">Étape 5 : utilisation des données dans la couche de présentation</span><span class="sxs-lookup"><span data-stu-id="54c0b-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="54c0b-253">Une fois la classe `EmployeesBLLWithSprocs` terminée, nous sommes prêts à travailler avec les données des employés via une page ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="54c0b-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="54c0b-254">Ouvrez la page `JOINs.aspx` dans le dossier `AdvancedDAL` et faites glisser un contrôle GridView de la boîte à outils vers le concepteur, en affectant à sa propriété `ID` la valeur `Employees`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="54c0b-255">Ensuite, à partir de la balise active GridView s, liez la grille à un nouveau contrôle ObjectDataSource nommé `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="54c0b-256">Configurez l’ObjectDataSource pour utiliser la classe `EmployeesBLLWithSprocs` et, à partir des onglets sélectionner et supprimer, assurez-vous que les méthodes `GetEmployees` et `DeleteEmployee` sont sélectionnées dans les listes déroulantes.</span><span class="sxs-lookup"><span data-stu-id="54c0b-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="54c0b-257">Cliquez sur Terminer pour terminer la configuration de ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="54c0b-258">[![configurer ObjectDataSource pour utiliser la classe EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="54c0b-259">**Figure 12**: configurer ObjectDataSource pour utiliser la classe `EmployeesBLLWithSprocs` ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>

<span data-ttu-id="54c0b-260">[![que ObjectDataSource utilise les méthodes GetEmployees et DeleteEmployee](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="54c0b-261">**Figure 13**: avoir l’ObjectDataSource utiliser les méthodes `GetEmployees` et `DeleteEmployee` ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>

<span data-ttu-id="54c0b-262">Visual Studio ajoute un BoundField au GridView pour chaque colonne `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="54c0b-263">Supprimez tous ces BoundFields, à l’exception de `Title`, `LastName`, `FirstName`, `ManagerFirstName`et `ManagerLastName` et renommez les propriétés `HeaderText` des quatre derniers BoundFields, respectivement, Last Name, First Name, Manager s First Name et Manager Names Name, respectivement.</span><span class="sxs-lookup"><span data-stu-id="54c0b-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="54c0b-264">Pour permettre aux utilisateurs de supprimer des employés de cette page, vous devez effectuer deux opérations.</span><span class="sxs-lookup"><span data-stu-id="54c0b-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="54c0b-265">Tout d’abord, demandez au GridView de fournir des fonctionnalités de suppression en activant l’option Activer la suppression de sa balise active.</span><span class="sxs-lookup"><span data-stu-id="54c0b-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="54c0b-266">Ensuite, modifiez la propriété ObjectDataSource s `OldValuesParameterFormatString` à partir de la valeur définie par l’Assistant ObjectDataSource (`original_{0}`) sur sa valeur par défaut (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="54c0b-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="54c0b-267">Une fois ces modifications effectuées, vos balises déclaratives GridView et ObjectDataSource doivent ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="54c0b-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="54c0b-268">Testez la page en la visitant via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="54c0b-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="54c0b-269">Comme le montre la figure 14, la page répertorie chaque employé et son nom de responsable (en supposant qu’il en possède un).</span><span class="sxs-lookup"><span data-stu-id="54c0b-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="54c0b-270">[![la jointure dans la procédure stockée Employees_Select renvoie le nom du responsable](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="54c0b-271">**Figure 14**: la `JOIN` dans la procédure stockée `Employees_Select` renvoie le nom du responsable ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>

<span data-ttu-id="54c0b-272">Le fait de cliquer sur le bouton supprimer démarre le workflow de suppression, qui termine l’exécution de la procédure stockée `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="54c0b-273">Toutefois, l’instruction tentée `DELETE` dans la procédure stockée échoue en raison d’une violation de contrainte de clé étrangère (voir figure 15).</span><span class="sxs-lookup"><span data-stu-id="54c0b-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="54c0b-274">Plus précisément, chaque employé possède un ou plusieurs enregistrements dans la table `Orders`, ce qui entraîne l’échec de la suppression.</span><span class="sxs-lookup"><span data-stu-id="54c0b-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="54c0b-275">[![la suppression d’un employé qui a des commandes correspondantes entraîne une violation de contrainte de clé étrangère](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="54c0b-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="54c0b-276">**Figure 15**: la suppression d’un employé qui a des commandes correspondantes entraîne une violation de contrainte de clé étrangère ([cliquez pour afficher l’image en taille réelle](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="54c0b-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>

<span data-ttu-id="54c0b-277">Pour autoriser la suppression d’un employé, vous pouvez :</span><span class="sxs-lookup"><span data-stu-id="54c0b-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="54c0b-278">Mettre à jour la contrainte de clé étrangère vers les suppressions en cascade,</span><span class="sxs-lookup"><span data-stu-id="54c0b-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="54c0b-279">Supprimez manuellement les enregistrements de la table `Orders` pour les employés que vous souhaitez supprimer, ou</span><span class="sxs-lookup"><span data-stu-id="54c0b-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="54c0b-280">Mettez à jour la procédure stockée `Employees_Delete` pour supprimer d’abord les enregistrements associés de la table `Orders` avant de supprimer l’enregistrement `Employees`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="54c0b-281">Nous avons abordé cette technique dans le didacticiel [utilisation de procédures stockées existantes pour les TableAdapters de DataSet typé](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="54c0b-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="54c0b-282">Je laisse cela en tant qu’exercice pour le lecteur.</span><span class="sxs-lookup"><span data-stu-id="54c0b-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="54c0b-283">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="54c0b-283">Summary</span></span>

<span data-ttu-id="54c0b-284">Lorsque vous utilisez des bases de données relationnelles, il est courant que les requêtes extraient leurs données à partir de plusieurs tables associées.</span><span class="sxs-lookup"><span data-stu-id="54c0b-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="54c0b-285">Les sous-requêtes corrélées et les `JOIN` s fournissent deux techniques différentes pour accéder aux données à partir de tables associées dans une requête.</span><span class="sxs-lookup"><span data-stu-id="54c0b-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="54c0b-286">Dans les didacticiels précédents, nous utilisons le plus souvent des sous-requêtes corrélées car le TableAdapter ne peut pas générer automatiquement les instructions `INSERT`, `UPDATE`et `DELETE` pour les requêtes impliquant `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="54c0b-287">Si ces valeurs peuvent être fournies manuellement, lorsque vous utilisez des instructions SQL ad hoc, toutes les personnalisations sont remplacées à la fin de l’Assistant Configuration de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="54c0b-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="54c0b-288">Heureusement, les TableAdapters créés à l’aide de procédures stockées ne souffrent pas de la même fragilité que celles créées à l’aide d’instructions SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="54c0b-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="54c0b-289">Par conséquent, il est possible de créer un TableAdapter dont la requête principale utilise un `JOIN` lors de l’utilisation de procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="54c0b-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="54c0b-290">Dans ce didacticiel, nous avons vu comment créer un TableAdapter de ce type.</span><span class="sxs-lookup"><span data-stu-id="54c0b-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="54c0b-291">Nous avons commencé par utiliser une requête `JOIN``SELECT` pour la requête principale du TableAdapter afin que les procédures stockées d’insertion, de mise à jour et de suppression correspondantes soient créées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="54c0b-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="54c0b-292">Une fois la configuration initiale du TableAdapter terminée, nous avons augmenté la `SelectCommand` procédure stockée pour utiliser une `JOIN` et réexécuté l’Assistant Configuration de TableAdapter pour mettre à jour les colonnes `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="54c0b-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="54c0b-293">La nouvelle exécution de l’Assistant Configuration de TableAdapter a mis à jour automatiquement les colonnes de `EmployeesDataTable` pour refléter les champs de données retournés par la procédure stockée `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="54c0b-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="54c0b-294">Vous pouvez également ajouter ces colonnes manuellement au DataTable.</span><span class="sxs-lookup"><span data-stu-id="54c0b-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="54c0b-295">Nous allons explorer l’ajout manuel de colonnes au DataTable dans le prochain didacticiel.</span><span class="sxs-lookup"><span data-stu-id="54c0b-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="54c0b-296">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="54c0b-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="54c0b-297">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="54c0b-297">About the Author</span></span>

<span data-ttu-id="54c0b-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="54c0b-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="54c0b-299">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="54c0b-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="54c0b-300">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="54c0b-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="54c0b-301">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="54c0b-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="54c0b-302">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="54c0b-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="54c0b-303">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="54c0b-303">Special Thanks To</span></span>

<span data-ttu-id="54c0b-304">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="54c0b-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="54c0b-305">Les réviseurs de leads pour ce didacticiel étaient Hilton Geisenow, David SURU et Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="54c0b-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="54c0b-306">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="54c0b-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="54c0b-307">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="54c0b-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="54c0b-308">[Précédent](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [Suivant](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="54c0b-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>
