---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Utilisation des colonnes calculées (VB) | Microsoft Docs
author: rick-anderson
description: Lors de la création d’une table de base de données, Microsoft SQL Server vous permet de définir une colonne calculée dont la valeur est calculée à partir d’une expression qui fait généralement référence à...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: e425d7363c2cdea6efb0ba51f3fc2b6a5330bf2a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78524485"
---
# <a name="working-with-computed-columns-vb"></a><span data-ttu-id="79db2-103">Utilisation de colonnes calculées (VB)</span><span class="sxs-lookup"><span data-stu-id="79db2-103">Working with Computed Columns (VB)</span></span>

<span data-ttu-id="79db2-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="79db2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="79db2-105">[Télécharger le code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) ou [Télécharger le PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="79db2-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="79db2-106">Lors de la création d’une table de base de données, Microsoft SQL Server vous permet de définir une colonne calculée dont la valeur est calculée à partir d’une expression qui fait généralement référence à d’autres valeurs dans le même enregistrement de base de données.</span><span class="sxs-lookup"><span data-stu-id="79db2-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="79db2-107">Ces valeurs sont en lecture seule dans la base de données, ce qui nécessite des considérations particulières lors de l’utilisation de TableAdapters.</span><span class="sxs-lookup"><span data-stu-id="79db2-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="79db2-108">Dans ce didacticiel, nous allons apprendre à répondre aux défis posés par les colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="79db2-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="79db2-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="79db2-109">Introduction</span></span>

<span data-ttu-id="79db2-110">Microsoft SQL Server permet les *[colonnes calculées](https://msdn.microsoft.com/library/ms191250.aspx)* , qui sont des colonnes dont les valeurs sont calculées à partir d’une expression qui fait généralement référence aux valeurs d’autres colonnes de la même table.</span><span class="sxs-lookup"><span data-stu-id="79db2-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="79db2-111">Par exemple, un modèle de données de suivi temporel peut avoir une table nommée `ServiceLog` avec des colonnes incluant `ServicePerformed`, `EmployeeID`, `Rate`et `Duration`, entre autres.</span><span class="sxs-lookup"><span data-stu-id="79db2-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="79db2-112">Bien que le montant dû par article de service (soit le taux multiplié par la durée) puisse être calculé par le biais d’une page Web ou d’une autre interface de programmation, il peut être pratique d’inclure une colonne dans la table `ServiceLog` nommée `AmountDue` qui a signalé ces informations.</span><span class="sxs-lookup"><span data-stu-id="79db2-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="79db2-113">Cette colonne peut être créée en tant que colonne normale, mais elle doit être mise à jour chaque fois que la `Rate` ou `Duration` valeurs de colonne modifiées.</span><span class="sxs-lookup"><span data-stu-id="79db2-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="79db2-114">Une meilleure approche consisterait à transformer la colonne `AmountDue` en colonne calculée à l’aide de l’expression `Rate * Duration`.</span><span class="sxs-lookup"><span data-stu-id="79db2-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="79db2-115">En procédant ainsi, SQL Server calcule automatiquement la valeur de colonne `AmountDue` chaque fois qu’elle a été référencée dans une requête.</span><span class="sxs-lookup"><span data-stu-id="79db2-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="79db2-116">Dans la mesure où une valeur s de colonne calculée est déterminée par une expression, ces colonnes sont en lecture seule et ne peuvent donc pas avoir de valeurs qui leur sont affectées dans les instructions `INSERT` ou `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="79db2-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="79db2-117">Toutefois, lorsque des colonnes calculées font partie de la requête principale pour un TableAdapter qui utilise des instructions SQL ad hoc, elles sont automatiquement incluses dans les instructions `INSERT` et `UPDATE` générées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="79db2-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="79db2-118">Par conséquent, les `INSERT` TableAdapter s et `UPDATE` et les propriétés `InsertCommand` et `UpdateCommand` doivent être mises à jour pour supprimer les références aux colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="79db2-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="79db2-119">L’un des défis liés à l’utilisation de colonnes calculées avec un TableAdapter qui utilise des instructions SQL ad hoc est que les requêtes TableAdapter `INSERT` et `UPDATE` sont automatiquement régénérées à chaque fois que l’Assistant Configuration de TableAdapter est terminé.</span><span class="sxs-lookup"><span data-stu-id="79db2-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="79db2-120">Par conséquent, les colonnes calculées manuellement retirées du `INSERT` et `UPDATE` requêtes s’affichent à nouveau si l’Assistant est réexécuté.</span><span class="sxs-lookup"><span data-stu-id="79db2-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="79db2-121">Bien que les TableAdapters qui utilisent des procédures stockées ne souffrent pas de cette fragilité, ils ont leurs propres excentriques que nous traiterons à l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="79db2-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="79db2-122">Dans ce didacticiel, nous allons ajouter une colonne calculée à la table `Suppliers` de la base de données Northwind, puis créer un TableAdapter correspondant pour travailler avec cette table et sa colonne calculée.</span><span class="sxs-lookup"><span data-stu-id="79db2-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="79db2-123">Notre TableAdapter utilise des procédures stockées plutôt que des instructions SQL ad hoc afin que nos personnalisations ne soient pas perdues lors de l’utilisation de l’Assistant Configuration de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="79db2-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="79db2-124">Commençons !</span><span class="sxs-lookup"><span data-stu-id="79db2-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="79db2-125">Étape 1 : ajout d’une colonne calculée à la table`Suppliers`</span><span class="sxs-lookup"><span data-stu-id="79db2-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="79db2-126">La base de données Northwind n’a pas de colonnes calculées. nous devons donc en ajouter une.</span><span class="sxs-lookup"><span data-stu-id="79db2-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="79db2-127">Pour ce didacticiel, ajoutez une colonne calculée à la table `Suppliers` appelée `FullContactName` qui renvoie le nom du contact, le titre et la société pour laquelle il travaille dans le format suivant : `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="79db2-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="79db2-128">Cette colonne calculée peut être utilisée dans les rapports lors de l’affichage d’informations sur les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="79db2-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="79db2-129">Commencez par ouvrir la définition de la table `Suppliers` en cliquant avec le bouton droit sur la table `Suppliers` dans la Explorateur de serveurs et en choisissant ouvrir la définition de table dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="79db2-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="79db2-130">Cette opération affiche les colonnes de la table et leurs propriétés, telles que leur type de données, si elles autorisent `NULL`, etc.</span><span class="sxs-lookup"><span data-stu-id="79db2-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="79db2-131">Pour ajouter une colonne calculée, commencez par taper le nom de la colonne dans la définition de la table.</span><span class="sxs-lookup"><span data-stu-id="79db2-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="79db2-132">Ensuite, entrez l’expression dans la zone de texte (formule) sous la section Spécification de la colonne calculée de la colonne Fenêtre Propriétés (voir figure 1).</span><span class="sxs-lookup"><span data-stu-id="79db2-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="79db2-133">Nommez la colonne calculée `FullContactName` et utilisez l’expression suivante :</span><span class="sxs-lookup"><span data-stu-id="79db2-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="79db2-134">Notez que les chaînes peuvent être concaténées en SQL à l’aide de l’opérateur `+`.</span><span class="sxs-lookup"><span data-stu-id="79db2-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="79db2-135">L’instruction `CASE` peut être utilisée comme une condition conditionnelle dans un langage de programmation traditionnel.</span><span class="sxs-lookup"><span data-stu-id="79db2-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="79db2-136">Dans l’expression ci-dessus, l’instruction `CASE` peut être lue comme suit : si `ContactTitle` n’est pas `NULL` puis qu’elle génère la valeur `ContactTitle` concaténée avec une virgule, sinon, n’émette rien.</span><span class="sxs-lookup"><span data-stu-id="79db2-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="79db2-137">Pour plus d’informations sur l’utilité de l’instruction `CASE`, consultez les instructions relatives à la [puissance des instructions SQL `CASE`](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="79db2-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="79db2-138">Au lieu d’utiliser une instruction `CASE` ici, nous pourrions également utiliser `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="79db2-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="79db2-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) retourne *checkExpression* si la valeur n’est pas NULL ; sinon, elle retourne *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="79db2-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="79db2-140">Bien que `ISNULL` ou `CASE` fonctionneront dans cette instance, il existe des scénarios plus complexes dans lesquels la flexibilité de l’instruction `CASE` ne peut pas être mise en correspondance par `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="79db2-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="79db2-141">Après avoir ajouté cette colonne calculée, votre écran doit ressembler à la capture d’écran de la figure 1.</span><span class="sxs-lookup"><span data-stu-id="79db2-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="79db2-142">[![ajouter une colonne calculée nommée FullContactName à la table Suppliers](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="79db2-143">**Figure 1**: ajouter une colonne calculée nommée `FullContactName` à la table `Suppliers` ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="79db2-144">Après avoir nommé la colonne calculée et entré son expression, enregistrez les modifications apportées à la table en cliquant sur l’icône Enregistrer dans la barre d’outils, en appuyant sur CTRL + S, ou en accédant au menu fichier et en choisissant enregistrer `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="79db2-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="79db2-145">L’enregistrement de la table doit actualiser la Explorateur de serveurs, y compris la colonne qui vient d’être ajoutée dans la liste des colonnes de `Suppliers` table s.</span><span class="sxs-lookup"><span data-stu-id="79db2-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="79db2-146">En outre, l’expression entrée dans la zone de texte (formule) s’ajuste automatiquement à une expression équivalente qui supprime les espaces superflus, entoure les noms de colonnes de crochets (`[]`) et comprend des parenthèses pour afficher plus explicitement l’ordre des opérations :</span><span class="sxs-lookup"><span data-stu-id="79db2-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="79db2-147">Pour plus d’informations sur les colonnes calculées dans Microsoft SQL Server, reportez-vous à la [documentation technique](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="79db2-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="79db2-148">Découvrez également [Comment : spécifier des colonnes calculées](https://msdn.microsoft.com/library/ms188300.aspx) pour une procédure pas à pas de création de colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="79db2-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="79db2-149">Par défaut, les colonnes calculées ne sont pas physiquement stockées dans la table, mais elles sont recalculées à chaque fois qu’elles sont référencées dans une requête.</span><span class="sxs-lookup"><span data-stu-id="79db2-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="79db2-150">En cochant la case est persistante, vous pouvez demander à SQL Server de stocker physiquement la colonne calculée dans la table.</span><span class="sxs-lookup"><span data-stu-id="79db2-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="79db2-151">Cela permet de créer un index sur la colonne calculée, ce qui peut améliorer les performances des requêtes qui utilisent la valeur de colonne calculée dans leurs clauses de `WHERE`.</span><span class="sxs-lookup"><span data-stu-id="79db2-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="79db2-152">Pour plus d’informations, consultez [création d’index sur des colonnes calculées](https://msdn.microsoft.com/library/ms189292.aspx) .</span><span class="sxs-lookup"><span data-stu-id="79db2-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="79db2-153">Étape 2 : affichage des valeurs des colonnes calculées</span><span class="sxs-lookup"><span data-stu-id="79db2-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="79db2-154">Avant de commencer à travailler sur la couche d’accès aux données, attendez quelques minutes pour voir les valeurs de `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="79db2-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="79db2-155">Dans le Explorateur de serveurs, cliquez avec le bouton droit sur le nom de la table `Suppliers` et choisissez nouvelle requête dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="79db2-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="79db2-156">Une fenêtre de requête s’affiche pour vous inviter à choisir les tables à inclure dans la requête.</span><span class="sxs-lookup"><span data-stu-id="79db2-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="79db2-157">Ajoutez la table `Suppliers`, puis cliquez sur Fermer.</span><span class="sxs-lookup"><span data-stu-id="79db2-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="79db2-158">Ensuite, vérifiez les colonnes `CompanyName`, `ContactName`, `ContactTitle`et `FullContactName` de la table Suppliers.</span><span class="sxs-lookup"><span data-stu-id="79db2-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="79db2-159">Enfin, cliquez sur l’icône de point d’exclamation rouge dans la barre d’outils pour exécuter la requête et afficher les résultats.</span><span class="sxs-lookup"><span data-stu-id="79db2-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="79db2-160">Comme le montre la figure 2, les résultats incluent `FullContactName`, qui répertorie les colonnes `CompanyName`, `ContactName`et `ContactTitle` à l’aide du format `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="79db2-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="79db2-161">[![FullContactName utilise le format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="79db2-162">**Figure 2**: le `FullContactName` utilise le format `ContactName` (`ContactTitle`, `CompanyName`) ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="79db2-163">Étape 3 : ajout de la`SuppliersTableAdapter`à la couche d’accès aux données</span><span class="sxs-lookup"><span data-stu-id="79db2-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="79db2-164">Pour pouvoir utiliser les informations sur les fournisseurs dans notre application, nous devons d’abord créer un TableAdapter et un DataTable dans notre couche DAL.</span><span class="sxs-lookup"><span data-stu-id="79db2-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="79db2-165">Dans l’idéal, cette opération est accomplie à l’aide des mêmes étapes simples que celles étudiées dans les didacticiels précédents.</span><span class="sxs-lookup"><span data-stu-id="79db2-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="79db2-166">Toutefois, l’utilisation de colonnes calculées présente quelques plis qui méritent une discussion.</span><span class="sxs-lookup"><span data-stu-id="79db2-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="79db2-167">Si vous utilisez un TableAdapter qui utilise des instructions SQL ad hoc, vous pouvez simplement inclure la colonne calculée dans la requête principale du TableAdapter à l’aide de l’Assistant Configuration de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="79db2-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="79db2-168">Toutefois, il génère automatiquement les instructions `INSERT` et `UPDATE` qui incluent la colonne calculée.</span><span class="sxs-lookup"><span data-stu-id="79db2-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="79db2-169">Si vous essayez d’exécuter l’une de ces méthodes, une `SqlException` avec le message la colonne *ColumnName* ne peut pas être modifiée, car il s’agit d’une colonne calculée ou le résultat d’un opérateur Union est levé.</span><span class="sxs-lookup"><span data-stu-id="79db2-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="79db2-170">Tandis que l’instruction `INSERT` et `UPDATE` peuvent être ajustées manuellement par le biais des propriétés `InsertCommand` et `UpdateCommand` du TableAdapter, ces personnalisations sont perdues à chaque réexécution de l’Assistant Configuration de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="79db2-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="79db2-171">En raison de la fragilité des TableAdapters qui utilisent des instructions SQL ad hoc, nous vous recommandons d’utiliser des procédures stockées lors de l’utilisation de colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="79db2-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="79db2-172">Si vous utilisez des procédures stockées existantes, il vous suffit de configurer le TableAdapter comme indiqué dans le didacticiel [utilisation de procédures stockées existantes pour les TableAdapters de DataSet typé](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="79db2-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="79db2-173">Toutefois, si l’Assistant TableAdapter crée les procédures stockées pour vous, il est important d’omettre initialement les colonnes calculées de la requête principale.</span><span class="sxs-lookup"><span data-stu-id="79db2-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="79db2-174">Si vous incluez une colonne calculée dans la requête principale, l’Assistant Configuration de TableAdapter vous informe, à l’achèvement, qu’il ne peut pas créer les procédures stockées correspondantes.</span><span class="sxs-lookup"><span data-stu-id="79db2-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="79db2-175">En résumé, nous devons tout d’abord configurer le TableAdapter à l’aide d’une requête principale sans colonne calculée, puis mettre à jour manuellement la procédure stockée correspondante et les `SelectCommand` TableAdapter pour inclure la colonne calculée.</span><span class="sxs-lookup"><span data-stu-id="79db2-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="79db2-176">Cette approche est similaire à celle utilisée dans le didacticiel [mise à jour du TableAdapter pour utiliser](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* .</span><span class="sxs-lookup"><span data-stu-id="79db2-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="79db2-177">Pour ce didacticiel, nous allons ajouter un nouveau TableAdapter et le faire créer automatiquement les procédures stockées pour nous.</span><span class="sxs-lookup"><span data-stu-id="79db2-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="79db2-178">Par conséquent, nous devons initialement omettre la `FullContactName` colonne calculée de la requête principale.</span><span class="sxs-lookup"><span data-stu-id="79db2-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="79db2-179">Commencez par ouvrir le jeu de données `NorthwindWithSprocs` dans le dossier `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="79db2-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="79db2-180">Cliquez avec le bouton droit dans le concepteur et, dans le menu contextuel, choisissez d’ajouter un nouveau TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="79db2-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="79db2-181">L’Assistant Configuration de TableAdapter est lancé.</span><span class="sxs-lookup"><span data-stu-id="79db2-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="79db2-182">Spécifiez la base de données à partir de laquelle interroger les données (`NORTHWNDConnectionString` `Web.config`), puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="79db2-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="79db2-183">Étant donné que nous n’avons pas encore créé de procédures stockées pour interroger ou modifier la table `Suppliers`, sélectionnez l’option créer de nouvelles procédures stockées afin que l’Assistant les crée pour nous et clique sur suivant.</span><span class="sxs-lookup"><span data-stu-id="79db2-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="79db2-184">[![choisissez l’option créer de nouvelles procédures stockées](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="79db2-185">**Figure 3**: choisissez l’option créer de nouvelles procédures stockées ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="79db2-186">L’étape suivante nous invite à entrer la requête principale.</span><span class="sxs-lookup"><span data-stu-id="79db2-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="79db2-187">Entrez la requête suivante, qui renvoie les colonnes `SupplierID`, `CompanyName`, `ContactName`et `ContactTitle` pour chaque fournisseur.</span><span class="sxs-lookup"><span data-stu-id="79db2-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="79db2-188">Notez que cette requête omet intentionnellement la colonne calculée (`FullContactName`); Nous allons mettre à jour la procédure stockée correspondante pour inclure cette colonne à l’étape 4.</span><span class="sxs-lookup"><span data-stu-id="79db2-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="79db2-189">Après avoir entré la requête principale et cliqué sur suivant, l’Assistant nous permet de nommer les quatre procédures stockées qu’il va générer.</span><span class="sxs-lookup"><span data-stu-id="79db2-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="79db2-190">Nommez ces procédures stockées `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`et `Suppliers_Delete`, comme illustré dans la figure 4.</span><span class="sxs-lookup"><span data-stu-id="79db2-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="79db2-191">[![personnaliser les noms des procédures stockées générées automatiquement](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="79db2-192">**Figure 4**: personnaliser les noms des procédures stockées générées automatiquement ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="79db2-193">L’étape suivante de l’Assistant nous permet de nommer les méthodes TableAdapter s et de spécifier les modèles utilisés pour accéder aux données et les mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="79db2-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="79db2-194">Laissez les trois cases à cocher activées, mais renommez la méthode `GetData` pour `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="79db2-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="79db2-195">Cliquez sur Terminer pour terminer l'Assistant.</span><span class="sxs-lookup"><span data-stu-id="79db2-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="79db2-196">[![renommez la méthode GetData en GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="79db2-197">**Figure 5**: renommer la méthode `GetData` en `GetSuppliers` ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="79db2-198">Quand vous cliquez sur terminer, l’Assistant crée les quatre procédures stockées et ajoute le TableAdapter et le DataTable correspondant au DataSet typé.</span><span class="sxs-lookup"><span data-stu-id="79db2-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="79db2-199">Étape 4 : inclusion de la colonne calculée dans la requête principale du TableAdapter</span><span class="sxs-lookup"><span data-stu-id="79db2-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="79db2-200">Nous devons maintenant mettre à jour le TableAdapter et le DataTable créés à l’étape 3 pour inclure le `FullContactName` colonne calculée.</span><span class="sxs-lookup"><span data-stu-id="79db2-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="79db2-201">Cela implique deux étapes :</span><span class="sxs-lookup"><span data-stu-id="79db2-201">This involves two steps:</span></span>

1. <span data-ttu-id="79db2-202">Mise à jour de la procédure stockée `Suppliers_Select` pour retourner le `FullContactName` colonne calculée, et</span><span class="sxs-lookup"><span data-stu-id="79db2-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="79db2-203">Mise à jour du DataTable pour inclure une colonne `FullContactName` correspondante.</span><span class="sxs-lookup"><span data-stu-id="79db2-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="79db2-204">Commencez par naviguer jusqu’au Explorateur de serveurs et en explorant le dossier procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="79db2-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="79db2-205">Ouvrez la procédure stockée `Suppliers_Select` et mettez à jour la requête `SELECT` pour inclure la `FullContactName` colonne calculée :</span><span class="sxs-lookup"><span data-stu-id="79db2-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="79db2-206">Enregistrez les modifications apportées à la procédure stockée en cliquant sur l’icône Enregistrer dans la barre d’outils, en appuyant sur CTRL + S ou en choisissant l’option Enregistrer `Suppliers_Select` dans le menu fichier.</span><span class="sxs-lookup"><span data-stu-id="79db2-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="79db2-207">Ensuite, revenez au concepteur de DataSet, cliquez avec le bouton droit sur le `SuppliersTableAdapter`, puis choisissez configurer dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="79db2-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="79db2-208">Notez que la colonne `Suppliers_Select` comprend maintenant la colonne `FullContactName` dans sa collection de colonnes de données.</span><span class="sxs-lookup"><span data-stu-id="79db2-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="79db2-209">[![exécuter l’Assistant Configuration de TableAdapter pour mettre à jour les colonnes du DataTable s](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="79db2-210">**Figure 6**: exécuter l’Assistant Configuration de TableAdapter pour mettre à jour les colonnes de DataTable s ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="79db2-211">Cliquez sur Terminer pour terminer l'Assistant.</span><span class="sxs-lookup"><span data-stu-id="79db2-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="79db2-212">Cette opération ajoute automatiquement une colonne correspondante au `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="79db2-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="79db2-213">L’Assistant TableAdapter est suffisamment intelligent pour détecter que la colonne `FullContactName` est une colonne calculée et donc en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="79db2-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="79db2-214">Par conséquent, il définit la propriété de la colonne s `ReadOnly` sur `true`.</span><span class="sxs-lookup"><span data-stu-id="79db2-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="79db2-215">Pour vérifier cela, sélectionnez la colonne dans la `SuppliersDataTable` puis accédez à la Fenêtre Propriétés (voir figure 7).</span><span class="sxs-lookup"><span data-stu-id="79db2-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="79db2-216">Notez que les propriétés `FullContactName` Column s `DataType` et `MaxLength` sont également définies en conséquence.</span><span class="sxs-lookup"><span data-stu-id="79db2-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="79db2-217">[![la colonne FullContactName est marquée en lecture seule](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="79db2-218">**Figure 7**: la colonne `FullContactName` est marquée en lecture seule ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="79db2-219">Étape 5 : ajout d’une méthode`GetSupplierBySupplierID`au TableAdapter</span><span class="sxs-lookup"><span data-stu-id="79db2-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="79db2-220">Pour ce didacticiel, nous allons créer une page ASP.NET qui affiche les fournisseurs dans une grille modifiable.</span><span class="sxs-lookup"><span data-stu-id="79db2-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="79db2-221">Dans les didacticiels précédents, nous avons mis à jour un enregistrement unique à partir de la couche de logique métier en extrayant cet enregistrement spécifique de la couche DAL en tant que DataTable fortement typé, en mettant à jour ses propriétés, puis en renvoyant le DataTable mis à jour à la couche DAL pour propager les modifications à base de données.</span><span class="sxs-lookup"><span data-stu-id="79db2-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="79db2-222">Pour effectuer cette première étape, récupérez l’enregistrement en cours de mise à jour à partir de la couche DAL. nous devons d’abord ajouter une méthode de `GetSupplierBySupplierID(supplierID)` à la couche DAL.</span><span class="sxs-lookup"><span data-stu-id="79db2-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="79db2-223">Cliquez avec le bouton droit sur la `SuppliersTableAdapter` dans la conception du jeu de données et choisissez l’option Ajouter une requête dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="79db2-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="79db2-224">Comme nous l’avons fait à l’étape 3, laissez l’Assistant générer une nouvelle procédure stockée pour nous en sélectionnant l’option créer une nouvelle procédure stockée (reportez-vous à la figure 3 pour obtenir une capture d’écran de cette étape de l’Assistant).</span><span class="sxs-lookup"><span data-stu-id="79db2-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="79db2-225">Étant donné que cette méthode retourne un enregistrement avec plusieurs colonnes, indiquez que nous souhaitons utiliser une requête SQL qui est une SELECT qui retourne des lignes, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="79db2-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="79db2-226">[![choisissez l’option Sélectionner les lignes à retourner](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="79db2-227">**Figure 8**: choisissez l’option Sélectionner les lignes à retourner ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>

<span data-ttu-id="79db2-228">L’étape suivante nous invite à entrer la requête à utiliser pour cette méthode.</span><span class="sxs-lookup"><span data-stu-id="79db2-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="79db2-229">Entrez la commande suivante, qui retourne les mêmes champs de données que la requête principale, mais pour un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="79db2-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="79db2-230">L’écran suivant nous demande de nommer la procédure stockée qui sera générée automatiquement.</span><span class="sxs-lookup"><span data-stu-id="79db2-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="79db2-231">Nommez cette procédure stockée `Suppliers_SelectBySupplierID`, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="79db2-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="79db2-232">[![nom de la procédure stockée Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="79db2-233">**Figure 9**: nommer la procédure stockée `Suppliers_SelectBySupplierID` ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>

<span data-ttu-id="79db2-234">Enfin, l’Assistant nous invite à entrer les modèles d’accès aux données et les noms de méthode à utiliser pour le TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="79db2-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="79db2-235">Laissez les cases à cocher activées, mais renommez les méthodes `FillBy` et `GetDataBy` en `FillBySupplierID` et `GetSupplierBySupplierID`, respectivement.</span><span class="sxs-lookup"><span data-stu-id="79db2-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="79db2-236">[![nommez les méthodes TableAdapter FillBySupplierID et GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="79db2-237">**Figure 10**: nommer les méthodes TableAdapter `FillBySupplierID` et `GetSupplierBySupplierID` ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>

<span data-ttu-id="79db2-238">Cliquez sur Terminer pour terminer l'Assistant.</span><span class="sxs-lookup"><span data-stu-id="79db2-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="79db2-239">Étape 6 : création de la couche de logique métier</span><span class="sxs-lookup"><span data-stu-id="79db2-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="79db2-240">Avant de créer une page ASP.NET qui utilise la colonne calculée créée à l’étape 1, nous devons d’abord ajouter les méthodes correspondantes dans la couche BLL.</span><span class="sxs-lookup"><span data-stu-id="79db2-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="79db2-241">Notre page ASP.NET, que nous allons créer à l’étape 7, permettra aux utilisateurs d’afficher et de modifier des fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="79db2-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="79db2-242">Par conséquent, nous avons besoin de notre BLL pour fournir, au minimum, une méthode pour obtenir tous les fournisseurs et un autre pour mettre à jour un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="79db2-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="79db2-243">Créez un nouveau fichier de classe nommé `SuppliersBLLWithSprocs` dans le dossier `~/App_Code/BLL` et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="79db2-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="79db2-244">À l’instar des autres classes BLL, `SuppliersBLLWithSprocs` a une propriété `Protected` `Adapter` qui retourne une instance de la classe `SuppliersTableAdapter`, ainsi que deux méthodes `Public` : `GetSuppliers` et `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="79db2-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="79db2-245">La méthode `GetSuppliers` appelle et retourne le `SuppliersDataTable` retourné par la méthode `GetSupplier` correspondante dans la couche d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="79db2-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="79db2-246">La méthode `UpdateSupplier` récupère des informations sur le fournisseur particulier qui est mis à jour via un appel à la méthode de `GetSupplierBySupplierID(supplierID)` DAL s.</span><span class="sxs-lookup"><span data-stu-id="79db2-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="79db2-247">Il met ensuite à jour les propriétés `CategoryName`, `ContactName`et `ContactTitle` et valide ces modifications dans la base de données en appelant la méthode `Update` de la couche d’accès aux données, en passant l’objet `SuppliersRow` modifié.</span><span class="sxs-lookup"><span data-stu-id="79db2-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="79db2-248">À l’exception de `SupplierID` et `CompanyName`, toutes les colonnes de la table Suppliers autorisent les valeurs `NULL`.</span><span class="sxs-lookup"><span data-stu-id="79db2-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="79db2-249">Par conséquent, si les paramètres `contactName` ou `contactTitle` transmis sont `Nothing` il est nécessaire de définir les propriétés `ContactName` et `ContactTitle` correspondantes sur une valeur de base de données `NULL` à l’aide des méthodes `SetContactNameNull` et `SetContactTitleNull`, respectivement.</span><span class="sxs-lookup"><span data-stu-id="79db2-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="79db2-250">Étape 7 : utilisation de la colonne calculée de la couche de présentation</span><span class="sxs-lookup"><span data-stu-id="79db2-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="79db2-251">Avec la colonne calculée ajoutée à la table `Suppliers` et la couche DAL et la couche BLL mises à jour en conséquence, nous sommes prêts à créer une page ASP.NET qui fonctionne avec la colonne calculée `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="79db2-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="79db2-252">Commencez par ouvrir la page `ComputedColumns.aspx` dans le dossier `AdvancedDAL` et faites glisser un contrôle GridView de la boîte à outils vers le concepteur.</span><span class="sxs-lookup"><span data-stu-id="79db2-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="79db2-253">Définissez la propriété GridView s `ID` sur `Suppliers` et, à partir de sa balise active, liez-la à un nouvel ObjectDataSource nommé `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="79db2-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="79db2-254">Configurez le ObjectDataSource pour utiliser la classe `SuppliersBLLWithSprocs` que nous avons rajoutée à l’étape 6, puis cliquez sur suivant.</span><span class="sxs-lookup"><span data-stu-id="79db2-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="79db2-255">[![configurer ObjectDataSource pour utiliser la classe SuppliersBLLWithSprocs](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="79db2-256">**Figure 11**: configurer ObjectDataSource pour utiliser la classe `SuppliersBLLWithSprocs` ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>

<span data-ttu-id="79db2-257">Il n’existe que deux méthodes définies dans la classe `SuppliersBLLWithSprocs` : `GetSuppliers` et `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="79db2-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="79db2-258">Assurez-vous que ces deux méthodes sont spécifiées respectivement dans les onglets sélectionner et mettre à jour, puis cliquez sur Terminer pour terminer la configuration de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="79db2-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="79db2-259">À la fin de l’Assistant Configuration de source de données, Visual Studio ajoute un BoundField pour chacun des champs de données retournés.</span><span class="sxs-lookup"><span data-stu-id="79db2-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="79db2-260">Supprimez le `SupplierID` BoundField et modifiez les propriétés de `HeaderText` des `CompanyName`, `ContactName`, `ContactTitle`et `FullContactName` BoundFields en société, nom de contact, titre et nom de contact complet, respectivement.</span><span class="sxs-lookup"><span data-stu-id="79db2-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="79db2-261">À partir de la balise active, activez la case à cocher Activer la modification pour activer les fonctionnalités d’édition intégrées de GridView.</span><span class="sxs-lookup"><span data-stu-id="79db2-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="79db2-262">Outre l’ajout de BoundFields à GridView, l’exécution de l’Assistant source de données permet également à Visual Studio de définir la propriété ObjectDataSource s `OldValuesParameterFormatString` sur la valeur d’origine\_{0}.</span><span class="sxs-lookup"><span data-stu-id="79db2-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="79db2-263">Rétablissez la valeur par défaut de ce paramètre, {0}.</span><span class="sxs-lookup"><span data-stu-id="79db2-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="79db2-264">Une fois ces modifications apportées aux contrôles GridView et ObjectDataSource, leur balisage déclaratif doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="79db2-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="79db2-265">Ensuite, accédez à cette page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="79db2-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="79db2-266">Comme le montre la figure 12, chaque fournisseur est listé dans une grille qui comprend la colonne `FullContactName`, dont la valeur est simplement la concaténation des trois autres colonnes mises en forme en tant que `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="79db2-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="79db2-267">[![chaque fournisseur est listé dans la grille](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="79db2-268">**Figure 12**: chaque fournisseur est listé dans la grille ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>

<span data-ttu-id="79db2-269">Le fait de cliquer sur le bouton modifier pour un fournisseur particulier entraîne une publication et affiche cette ligne dans son interface de modification (voir figure 13).</span><span class="sxs-lookup"><span data-stu-id="79db2-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="79db2-270">Les trois premières colonnes s’affichent dans leur interface de modification par défaut, un contrôle TextBox dont la propriété `Text` est définie sur la valeur du champ de données.</span><span class="sxs-lookup"><span data-stu-id="79db2-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="79db2-271">Toutefois, la colonne `FullContactName` reste sous forme de texte.</span><span class="sxs-lookup"><span data-stu-id="79db2-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="79db2-272">Lorsque les BoundFields ont été ajoutés au contrôle GridView à la fin de l’Assistant Configuration de source de données, la propriété `FullContactName` BoundField s `ReadOnly` a été définie sur `True`, car la propriété `SuppliersDataTable` de la colonne `FullContactName` correspondante de la `ReadOnly` est définie sur `True`.</span><span class="sxs-lookup"><span data-stu-id="79db2-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="79db2-273">Comme indiqué à l’étape 4, la propriété `FullContactName` s `ReadOnly` a été définie sur `True` car le TableAdapter a détecté que la colonne était une colonne calculée.</span><span class="sxs-lookup"><span data-stu-id="79db2-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="79db2-274">[![la colonne FullContactName n’est pas modifiable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="79db2-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="79db2-275">**Figure 13**: la colonne `FullContactName` n’est pas modifiable ([cliquez pour afficher l’image en taille réelle](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="79db2-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>

<span data-ttu-id="79db2-276">Continuez et mettez à jour la valeur d’une ou plusieurs des colonnes modifiables, puis cliquez sur mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="79db2-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="79db2-277">Notez comment la valeur de `FullContactName` s est automatiquement mise à jour pour refléter la modification.</span><span class="sxs-lookup"><span data-stu-id="79db2-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="79db2-278">Le GridView utilise actuellement BoundFields pour les champs modifiables, ce qui se traduit par l’interface de modification par défaut.</span><span class="sxs-lookup"><span data-stu-id="79db2-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="79db2-279">Étant donné que le champ `CompanyName` est obligatoire, il doit être converti en TemplateField qui comprend un RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="79db2-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="79db2-280">Je laisse cela en tant qu’exercice pour le lecteur intéressé.</span><span class="sxs-lookup"><span data-stu-id="79db2-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="79db2-281">Pour obtenir des instructions pas à pas sur la conversion d’un BoundField en TemplateField et l’ajout de contrôles de validation, consultez le didacticiel [Ajout de contrôles de validation au didacticiel sur les interfaces de modification et d’insertion](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="79db2-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="79db2-282">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="79db2-282">Summary</span></span>

<span data-ttu-id="79db2-283">Lors de la définition du schéma d’une table, Microsoft SQL Server permet l’inclusion de colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="79db2-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="79db2-284">Il s’agit de colonnes dont les valeurs sont calculées à partir d’une expression qui fait généralement référence aux valeurs d’autres colonnes dans le même enregistrement.</span><span class="sxs-lookup"><span data-stu-id="79db2-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="79db2-285">Étant donné que les valeurs des colonnes calculées sont basées sur une expression, elles sont en lecture seule et ne peuvent pas être assignées à une valeur dans une instruction `INSERT` ou `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="79db2-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="79db2-286">Cela présente des difficultés lors de l’utilisation d’une colonne calculée dans la requête principale d’un TableAdapter qui tente de générer automatiquement les instructions `INSERT`, `UPDATE`et `DELETE` correspondantes.</span><span class="sxs-lookup"><span data-stu-id="79db2-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="79db2-287">Dans ce didacticiel, nous avons abordé les techniques permettant de contourner les problèmes posés par les colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="79db2-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="79db2-288">En particulier, nous avons utilisé des procédures stockées dans notre TableAdapter pour surmonter la fragilité inhérente aux TableAdapters qui utilisent des instructions SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="79db2-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="79db2-289">Lorsque l’Assistant TableAdapter crée de nouvelles procédures stockées, il est important que la requête principale omette au départ toutes les colonnes calculées, car leur présence empêche la génération des procédures stockées de modification de données.</span><span class="sxs-lookup"><span data-stu-id="79db2-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="79db2-290">Une fois que le TableAdapter a été initialement configuré, sa procédure stockée `SelectCommand` peut être redéfinie pour inclure toutes les colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="79db2-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="79db2-291">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="79db2-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="79db2-292">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="79db2-292">About the Author</span></span>

<span data-ttu-id="79db2-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="79db2-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="79db2-294">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="79db2-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="79db2-295">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="79db2-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="79db2-296">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="79db2-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="79db2-297">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="79db2-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="79db2-298">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="79db2-298">Special Thanks To</span></span>

<span data-ttu-id="79db2-299">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="79db2-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="79db2-300">Les réviseurs de leads pour ce didacticiel étaient Hilton Geisenow et Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="79db2-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="79db2-301">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="79db2-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="79db2-302">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="79db2-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="79db2-303">[Précédent](adding-additional-datatable-columns-vb.md)
> [Suivant](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="79db2-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>
