---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
title: Ajout de colonnes de DataTable supplémentaires (VB) | Microsoft Docs
author: rick-anderson
description: Lorsque vous utilisez l’Assistant TableAdapter pour créer un DataSet typé, le DataTable contient les colonnes retournées par la requête de base de données principale. Mais là...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 1e8e65f9-fe3e-4250-810b-c90227786bed
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: 969dd42295530396eca4195a8897a5ee93a61bf2
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65133424"
---
# <a name="adding-additional-datatable-columns-vb"></a><span data-ttu-id="58280-104">Ajout de colonnes de DataTable supplémentaires (VB)</span><span class="sxs-lookup"><span data-stu-id="58280-104">Adding Additional DataTable Columns (VB)</span></span>

<span data-ttu-id="58280-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="58280-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="58280-106">[Télécharger le Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) ou [télécharger le PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="58280-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) or [Download PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span></span>

> <span data-ttu-id="58280-107">Lorsque vous utilisez l’Assistant TableAdapter pour créer un DataSet typé, le DataTable contient les colonnes retournées par la requête de base de données principale.</span><span class="sxs-lookup"><span data-stu-id="58280-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="58280-108">Mais il arrive parfois lorsque la table de données doit inclure des colonnes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="58280-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="58280-109">Dans ce didacticiel, nous Découvrez pourquoi les procédures stockées sont recommandées lorsque nous avons besoin des colonnes de DataTable supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="58280-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="58280-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="58280-110">Introduction</span></span>

<span data-ttu-id="58280-111">Lorsque vous ajoutez un TableAdapter à un DataSet typé, le schéma s DataTable correspondant est déterminé par la requête principale de TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="58280-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="58280-112">Par exemple, si la requête principale renvoie les champs de données *A*, *B*, et *C*, la table de données aura trois colonnes correspondantes nommées *A*, *B*, et *C*. Outre sa requête principale, un TableAdapter peut inclure des requêtes supplémentaires qui retournent, par exemple, un sous-ensemble des données en fonction de certains paramètres.</span><span class="sxs-lookup"><span data-stu-id="58280-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="58280-113">Par exemple, en plus de la `ProductsTableAdapter` requête principale s, qui retourne des informations sur tous les produits, elle contient également des méthodes comme `GetProductsByCategoryID(categoryID)` et `GetProductByProductID(productID)`, qui renvoient des informations de produit spécifique en fonction d’un paramètre fourni.</span><span class="sxs-lookup"><span data-stu-id="58280-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="58280-114">Le modèle d’avoir le schéma s DataTable reflètent la requête principale de TableAdapter s fonctionne bien si toutes les méthodes TableAdapter s retournent les mêmes ou moins de champs de données que celles spécifiées dans la requête principale.</span><span class="sxs-lookup"><span data-stu-id="58280-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="58280-115">Si une méthode du TableAdapter doit retourner les champs de données supplémentaires, nous devons développer le schéma s DataTable en conséquence.</span><span class="sxs-lookup"><span data-stu-id="58280-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="58280-116">Dans le [maître/détail à l’aide d’une liste à puces des enregistrements maîtres avec une DataList des détails](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) didacticiel, nous avons ajouté une méthode à la `CategoriesTableAdapter` qui a retourné le `CategoryID`, `CategoryName`, et `Description` définies dans les champs de données la requête principale plue `NumberOfProducts`, un champ de données supplémentaires qui a signalé le nombre de produits associées à chaque catégorie.</span><span class="sxs-lookup"><span data-stu-id="58280-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="58280-117">Nous avons ajouté manuellement une nouvelle colonne à la `CategoriesDataTable` afin de capturer le `NumberOfProducts` valeur à partir de cette nouvelle méthode de champ de données.</span><span class="sxs-lookup"><span data-stu-id="58280-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="58280-118">Comme indiqué dans le [télécharger des fichiers](../working-with-binary-files/uploading-files-vb.md) didacticiel, vous devez veiller avec les TableAdapters qui utilisent des instructions SQL ad hoc et ont des méthodes dont les champs de données ne correspondent pas précisément la requête principale.</span><span class="sxs-lookup"><span data-stu-id="58280-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-vb.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="58280-119">Si l’Assistant Configuration de TableAdapter est relancée, elle sera mise à jour toutes les méthodes TableAdapter s afin que leur liste de champs de données correspond à la requête principale.</span><span class="sxs-lookup"><span data-stu-id="58280-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="58280-120">Par conséquent, toutes les méthodes avec des listes de colonne personnalisé seront revenir à la liste de colonnes de la requête principale s et ne retourne pas les données attendues.</span><span class="sxs-lookup"><span data-stu-id="58280-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="58280-121">Ce problème ne se pose pas lors de l’utilisation de procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="58280-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="58280-122">Dans ce didacticiel, nous allons examiner comment étendre un schéma de s DataTable pour inclure des colonnes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="58280-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="58280-123">En raison de la fragilité du TableAdapter lors de l’utilisation d’instructions SQL ad hoc, dans ce didacticiel, nous allons utiliser des procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="58280-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="58280-124">Reportez-vous à la [création de nouvelles procédures stockées pour s DataSet typée TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) et [à l’aide des procédures stockées existantes pour s DataSet typée TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) didacticiels pour plus d’informations sur configuration d’un TableAdapter pour utiliser des procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="58280-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="58280-125">Étape 1 : Ajout d’un`PriceQuartile`colonne à la`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="58280-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="58280-126">Dans le *création de nouvelles procédures stockées pour s DataSet typée TableAdapters* didacticiel, nous avons créé un DataSet typé nommé `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="58280-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="58280-127">Ce jeu de données contient actuellement des deux DataTables : `ProductsDataTable` et `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="58280-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="58280-128">Le `ProductsTableAdapter` a trois méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="58280-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="58280-129">`GetProducts` -la requête principale, qui retourne tous les enregistrements à partir de la `Products` table</span><span class="sxs-lookup"><span data-stu-id="58280-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="58280-130">`GetProductsByCategoryID(categoryID)` -Retourne tous les produits avec la valeur *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="58280-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="58280-131">`GetProductByProductID(productID)` -Retourne le produit avec la valeur *productID*.</span><span class="sxs-lookup"><span data-stu-id="58280-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="58280-132">La requête principale et toutes les deux méthodes supplémentaires retournent le même ensemble de champs de données, à savoir toutes les colonnes à partir de la `Products` table.</span><span class="sxs-lookup"><span data-stu-id="58280-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="58280-133">Il n’y a aucune sous-requêtes corrélées ou `JOIN` s extraction de données connexes à partir de la `Categories` ou `Suppliers` tables.</span><span class="sxs-lookup"><span data-stu-id="58280-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="58280-134">Par conséquent, le `ProductsDataTable` a une colonne correspondante pour chaque champ dans le `Products` table.</span><span class="sxs-lookup"><span data-stu-id="58280-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="58280-135">Pour ce didacticiel, s permettent d’ajouter une méthode à la `ProductsTableAdapter` nommé `GetProductsWithPriceQuartile` qui retourne tous les produits.</span><span class="sxs-lookup"><span data-stu-id="58280-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="58280-136">En plus des champs de données de produit standard, `GetProductsWithPriceQuartile` inclut également un `PriceQuartile` champ de données qui indique dans quel quartile se situe le prix du produit s.</span><span class="sxs-lookup"><span data-stu-id="58280-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="58280-137">Par exemple, les produits dont les prix sont dans les 25 % plus coûteuses aura un `PriceQuartile` la valeur 1, tandis que ceux dont les prix se situent dans la partie inférieure de 25 % aura une valeur de 4.</span><span class="sxs-lookup"><span data-stu-id="58280-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="58280-138">Avant de nous soucier de la création de la procédure stockée pour retourner ces informations, toutefois, nous devons d’abord mettre à jour le `ProductsDataTable` pour inclure une colonne contenant le `PriceQuartile` résultats lorsque la `GetProductsWithPriceQuartile` méthode est utilisée.</span><span class="sxs-lookup"><span data-stu-id="58280-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="58280-139">Ouvrez le `NorthwindWithSprocs` jeu de données et avec le bouton droit sur le `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="58280-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="58280-140">Cliquez sur Ajouter dans le menu contextuel, puis choisissez colonne.</span><span class="sxs-lookup"><span data-stu-id="58280-140">Choose Add from the context-menu and then pick Column.</span></span>

<span data-ttu-id="58280-141">[![Ajouter une nouvelle colonne à la ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="58280-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="58280-142">**Figure 1**: Ajouter une nouvelle colonne à la `ProductsDataTable` ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="58280-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="58280-143">Cela ajoutera une nouvelle colonne au DataTable nommé Column1 de type `System.String`.</span><span class="sxs-lookup"><span data-stu-id="58280-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="58280-144">Nous devons mettre à jour de ce nom de colonne s à PriceQuartile et son type `System.Int32` , car il sera utilisé pour contenir un nombre compris entre 1 et 4.</span><span class="sxs-lookup"><span data-stu-id="58280-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="58280-145">Sélectionnez la colonne nouvellement ajouté dans le `ProductsDataTable` et, à partir de la fenêtre Propriétés, définissez la `Name` propriété PriceQuartile et le `DataType` propriété `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="58280-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>

<span data-ttu-id="58280-146">[![Définir les propriétés de type de données et le nouveau nom de colonne s](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="58280-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="58280-147">**Figure 2**: Définir la nouvelle colonne s `Name` et `DataType` propriétés ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="58280-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image6.png))</span></span>

<span data-ttu-id="58280-148">Comme le montre la Figure 2, il existe des propriétés supplémentaires qui peuvent être définies, telles que si les valeurs dans la colonne doivent être uniques, si la colonne est une colonne à incrémentation automatique, la base de données ou non `NULL` valeurs sont autorisées et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="58280-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="58280-149">Laissez ces valeurs définies à leurs valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="58280-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="58280-150">Étape 2 : Création de la`GetProductsWithPriceQuartile`(méthode)</span><span class="sxs-lookup"><span data-stu-id="58280-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="58280-151">Maintenant que le `ProductsDataTable` a été mis à jour pour inclure le `PriceQuartile` colonne, nous sommes prêts à créer la `GetProductsWithPriceQuartile` (méthode).</span><span class="sxs-lookup"><span data-stu-id="58280-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="58280-152">Démarrer en cliquant sur le TableAdapter et en choisissant Ajouter une requête dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="58280-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="58280-153">Ceci fait apparaître l’Assistant Configuration de requêtes TableAdapter, qui demande tout d’abord nous si nous souhaitons utiliser les instructions SQL ad hoc ou une procédure stockée nouveau ou existante.</span><span class="sxs-lookup"><span data-stu-id="58280-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="58280-154">Étant donné que nous ne pas mais une procédure stockée qui retourne les données de quartile prix, permettent de s autoriser le TableAdapter créer cette procédure stockée pour nous.</span><span class="sxs-lookup"><span data-stu-id="58280-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="58280-155">Sélectionnez l’option de procédure stockée nouveau de créer et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="58280-155">Select the Create new stored procedure option and click Next.</span></span>

<span data-ttu-id="58280-156">[![Demander à l’Assistant TableAdapter pour créer la procédure stockée pour nous](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="58280-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="58280-157">**Figure 3**: Demander à l’Assistant TableAdapter pour créer le stockées procédure pour nous ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="58280-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="58280-158">Dans l’écran suivant, illustré Figure 4, l’Assistant nous demande quel type de requête à ajouter.</span><span class="sxs-lookup"><span data-stu-id="58280-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="58280-159">Dans la mesure où le `GetProductsWithPriceQuartile` méthode retournera toutes les colonnes et les enregistrements à partir de la `Products` de table, sélectionnez l’instruction SELECT qui retourne des lignes, cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="58280-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>

<span data-ttu-id="58280-160">[![Notre requête sera une instruction SELECT qui retourne plusieurs lignes](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="58280-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="58280-161">**Figure 4**: Notre requête sera un `SELECT` instruction qui retourne plusieurs lignes ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="58280-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="58280-162">Ensuite, nous sommes invités pour le `SELECT` requête.</span><span class="sxs-lookup"><span data-stu-id="58280-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="58280-163">Dans l’Assistant, entrez la requête suivante :</span><span class="sxs-lookup"><span data-stu-id="58280-163">Enter the following query into the wizard:</span></span>

[!code-sql[Main](adding-additional-datatable-columns-vb/samples/sample1.sql)]

<span data-ttu-id="58280-164">La requête ci-dessus utilise SQL Server 2005 s nouveau [ `NTILE` fonction](https://msdn.microsoft.com/library/ms175126.aspx) pour diviser les résultats en quatre groupes où les groupes sont déterminées par la `UnitPrice` valeurs triées dans l’ordre décroissant.</span><span class="sxs-lookup"><span data-stu-id="58280-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="58280-165">Malheureusement, le Générateur de requêtes ne sait pas comment analyser le `OVER` mot clé et affichera une erreur lors de l’analyse de la requête ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="58280-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="58280-166">Par conséquent, entrez la requête ci-dessus directement dans la zone de texte dans l’Assistant sans utiliser le Générateur de requêtes.</span><span class="sxs-lookup"><span data-stu-id="58280-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="58280-167">Pour plus d’informations sur les s NTILE et SQL Server 2005 autres fonctions de classement, consultez [retour de résultats classés avec Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) et [section fonctions de classement](https://msdn.microsoft.com/library/ms189798.aspx) à partir de la [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="58280-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>

<span data-ttu-id="58280-168">Après avoir entré la `SELECT` requête et en cliquant sur Suivant, l’Assistant nous invite à fournir un nom pour la procédure stockée est créé.</span><span class="sxs-lookup"><span data-stu-id="58280-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="58280-169">Nommez la nouvelle procédure stockée `Products_SelectWithPriceQuartile` et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="58280-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>

<span data-ttu-id="58280-170">[![Nom de la procédure stockée Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="58280-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="58280-171">**Figure 5**: Nom de la procédure stockée `Products_SelectWithPriceQuartile` ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="58280-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="58280-172">Enfin, nous allons vous y êtes invités à nommer les méthodes TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="58280-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="58280-173">Laissez les deux le remplissage un DataTable et retourner un DataTable les cases cochées et les méthodes `FillWithPriceQuartile` et `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="58280-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>

<span data-ttu-id="58280-174">[![Nom du TableAdapter s méthodes et cliquez sur Terminer](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="58280-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="58280-175">**Figure 6**: Nommer le TableAdapter s méthodes et cliquez sur Terminer ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="58280-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="58280-176">Avec le `SELECT` requête spécifiée et la procédure stockée et les méthodes TableAdapter nommés, cliquez sur Terminer pour terminer l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="58280-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="58280-177">À ce stade que vous receviez un message d’avertissement ou deux à partir de l’Assistant, indiquant que le `OVER` construction SQL ou une instruction n’est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="58280-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="58280-178">Vous pouvez ignorer ces avertissements.</span><span class="sxs-lookup"><span data-stu-id="58280-178">These warnings can be ignored.</span></span>

<span data-ttu-id="58280-179">À l’issue de l’Assistant, le TableAdapter doit inclure le `FillWithPriceQuartile` et `GetProductsWithPriceQuartile` méthodes et la base de données doivent inclure une procédure stockée nommée `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="58280-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="58280-180">Prenez un moment pour vérifier que le TableAdapter ne contient en effet de cette nouvelle méthode et que la procédure stockée a été correctement ajoutée à la base de données.</span><span class="sxs-lookup"><span data-stu-id="58280-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="58280-181">Lors de la vérification de la base de données, si vous ne voyez pas la procédure stockée try effectuant un clic droit sur le dossier de procédures stockées et en choisissant d’actualisation.</span><span class="sxs-lookup"><span data-stu-id="58280-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>

![Vérifiez qu’une nouvelle méthode a été ajoutée au TableAdapter](adding-additional-datatable-columns-vb/_static/image19.png)

<span data-ttu-id="58280-183">**Figure 7**: Vérifiez qu’une nouvelle méthode a été ajoutée au TableAdapter</span><span class="sxs-lookup"><span data-stu-id="58280-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>

<span data-ttu-id="58280-184">[![Assurez-vous que la base de données contienne le Products_SelectWithPriceQuartile procédure stockée](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="58280-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span></span>

<span data-ttu-id="58280-185">**Figure 8**: Vérifiez que la base de données contient le `Products_SelectWithPriceQuartile` la procédure stockée ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="58280-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="58280-186">Un des avantages de l’utilisation de procédures stockées au lieu d’instructions SQL ad hoc est que réexécuter l’Assistant Configuration de TableAdapter ne modifiera pas les listes de colonnes de procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="58280-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="58280-187">Vérifier cela en effectuant un clic droit sur le TableAdapter, en choisissant l’option de configuration dans le menu contextuel pour démarrer l’Assistant et puis en cliquant sur Terminer pour terminer.</span><span class="sxs-lookup"><span data-stu-id="58280-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="58280-188">Ensuite, accédez à la base de données et la vue la `Products_SelectWithPriceQuartile` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="58280-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="58280-189">Notez que sa liste de colonnes n’a pas été modifiée.</span><span class="sxs-lookup"><span data-stu-id="58280-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="58280-190">Avions nous avons été à l’aide des instructions SQL ad hoc, exécuter à nouveau l’Assistant Configuration de TableAdapter aurait été rétablies cette liste de colonnes de requête s pour correspondre à la liste des colonnes requête principale, en supprimant l’instruction NTILE à partir de la requête utilisée par le `GetProductsWithPriceQuartile` (méthode).</span><span class="sxs-lookup"><span data-stu-id="58280-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>

<span data-ttu-id="58280-191">Lors de la couche d’accès aux données s `GetProductsWithPriceQuartile` méthode est appelée, le TableAdapter exécute le `Products_SelectWithPriceQuartile` procédure stockée et ajoute une ligne à la `ProductsDataTable` pour chaque enregistrement retourné.</span><span class="sxs-lookup"><span data-stu-id="58280-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="58280-192">Les champs de données retournés par la procédure stockée sont mappées à la `ProductsDataTable` des colonnes de s.</span><span class="sxs-lookup"><span data-stu-id="58280-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="58280-193">Dans la mesure où il existe un `PriceQuartile` champ de données retourné à partir de la procédure stockée, sa valeur est assignée à la `ProductsDataTable` s `PriceQuartile` colonne.</span><span class="sxs-lookup"><span data-stu-id="58280-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="58280-194">Pour les méthodes TableAdapter dont les requêtes ne retournent pas un `PriceQuartile` champ de données, le `PriceQuartile` valeur de colonne s est la valeur spécifiée par son `DefaultValue` propriété.</span><span class="sxs-lookup"><span data-stu-id="58280-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="58280-195">Comme le montre la Figure 2, cette valeur est définie sur `DBNull`, la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="58280-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="58280-196">Si vous préférez une valeur par défaut différente, il suffit de définir le `DefaultValue` propriété en conséquence.</span><span class="sxs-lookup"><span data-stu-id="58280-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="58280-197">Assurez-vous simplement que le `DefaultValue` valeur n’est valide selon la colonne s `DataType` (par exemple, `System.Int32` pour la `PriceQuartile` colonne).</span><span class="sxs-lookup"><span data-stu-id="58280-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="58280-198">À ce stade, nous avons effectué les étapes nécessaires pour l’ajout d’une colonne supplémentaire à un DataTable.</span><span class="sxs-lookup"><span data-stu-id="58280-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="58280-199">Pour vérifier que cette colonne supplémentaire fonctionne comme prévu, permettent de créer une page ASP.NET qui affiche chaque produit s nom, prix et quartile de prix s.</span><span class="sxs-lookup"><span data-stu-id="58280-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="58280-200">Avant cela, cependant, nous devons d’abord mettre à jour de la couche de logique métier pour inclure une méthode qui appelle vers le bas de la couche DAL s `GetProductsWithPriceQuartile` (méthode).</span><span class="sxs-lookup"><span data-stu-id="58280-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="58280-201">Nous mettre à jour de la couche BLL ensuite, à l’étape 3 et ensuite créer la page ASP.NET à l’étape 4.</span><span class="sxs-lookup"><span data-stu-id="58280-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="58280-202">Étape 3 : Augmentation de la couche de logique métier</span><span class="sxs-lookup"><span data-stu-id="58280-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="58280-203">Avant de pouvoir utiliser le nouveau `GetProductsWithPriceQuartile` méthode à partir de la couche de présentation, nous devons tout d’abord ajouter une méthode correspondante à la couche BLL.</span><span class="sxs-lookup"><span data-stu-id="58280-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="58280-204">Ouvrez le `ProductsBLLWithSprocs` fichier de classe et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="58280-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>

[!code-vb[Main](adding-additional-datatable-columns-vb/samples/sample2.vb)]

<span data-ttu-id="58280-205">Comme les autres méthodes de récupération de données dans `ProductsBLLWithSprocs`, le `GetProductsWithPriceQuartile` méthode appelle simplement la couche DAL s correspondant `GetProductsWithPriceQuartile` méthode et retourne ses résultats.</span><span class="sxs-lookup"><span data-stu-id="58280-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="58280-206">Étape 4 : Afficher les informations de Quartile prix dans une Page Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="58280-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="58280-207">Avec l’ajout de la couche BLL terminer nous re prêt à créer une page ASP.NET qui affiche le quartile prix pour chaque produit.</span><span class="sxs-lookup"><span data-stu-id="58280-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="58280-208">Ouvrir le `AddingColumns.aspx` page dans le `AdvancedDAL` dossier et faites glisser un GridView à partir de la boîte à outils vers le concepteur, en définissant son `ID` propriété `Products`.</span><span class="sxs-lookup"><span data-stu-id="58280-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="58280-209">À partir de la balise active de s GridView, liez-le à une nouvelle ObjectDataSource nommé `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="58280-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="58280-210">Configurer l’ObjectDataSource à utiliser le `ProductsBLLWithSprocs` classe s `GetProductsWithPriceQuartile` (méthode).</span><span class="sxs-lookup"><span data-stu-id="58280-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="58280-211">Dans la mesure où il s’agit d’une grille en lecture seule, définissez les listes déroulantes dans la mise à jour, insertion et supprimer des onglets à (None).</span><span class="sxs-lookup"><span data-stu-id="58280-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="58280-212">[![Configurer pour utiliser la classe ProductsBLLWithSprocs ObjectDataSource](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="58280-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span></span>

<span data-ttu-id="58280-213">**Figure 9**: Configurer l’ObjectDataSource à utiliser le `ProductsBLLWithSprocs` classe ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="58280-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image25.png))</span></span>

<span data-ttu-id="58280-214">[![Récupérer des informations sur les produits à partir de la méthode GetProductsWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="58280-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span></span>

<span data-ttu-id="58280-215">**Figure 10**: Récupérer des informations de produit à partir de la `GetProductsWithPriceQuartile` (méthode) ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="58280-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image28.png))</span></span>

<span data-ttu-id="58280-216">À l’issue de l’Assistant Configurer la Source de données, Visual Studio ajoute automatiquement un BoundField ou du CheckBoxField au GridView pour chacun des champs de données retournés par la méthode.</span><span class="sxs-lookup"><span data-stu-id="58280-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="58280-217">Un de ces champs de données est `PriceQuartile`, qui est la colonne que nous avons ajouté à la `ProductsDataTable` à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="58280-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="58280-218">Modifier les champs de s GridView, supprimant tout sauf la `ProductName`, `UnitPrice`, et `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="58280-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="58280-219">Configurer le `UnitPrice` BoundField à mettre en forme sa valeur comme une devise et ont le `UnitPrice` et `PriceQuartile` BoundFields et centre alignée à droite, respectivement.</span><span class="sxs-lookup"><span data-stu-id="58280-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="58280-220">Enfin, mettez à jour de la BoundFields restantes `HeaderText` propriétés produit, les prix et les prix Quartile, respectivement.</span><span class="sxs-lookup"><span data-stu-id="58280-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="58280-221">En outre, cochez la case à cocher Activer le tri à partir de la balise active de GridView s.</span><span class="sxs-lookup"><span data-stu-id="58280-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="58280-222">Après ces modifications, le balisage déclaratif s GridView et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="58280-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-additional-datatable-columns-vb/samples/sample3.aspx)]

<span data-ttu-id="58280-223">Figure 11 illustre cette page quand consultées via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="58280-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="58280-224">Notez que, tout d’abord, les produits sont classés par leur prix dans l’ordre décroissant avec chaque produit est attribué approprié `PriceQuartile` valeur.</span><span class="sxs-lookup"><span data-stu-id="58280-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="58280-225">Bien entendu ces données peuvent être triées par d’autres critères, avec la valeur de colonne de prix Quartile toujours refléter le classement de produit s en ce qui concerne les prix (voir Figure 12).</span><span class="sxs-lookup"><span data-stu-id="58280-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>

<span data-ttu-id="58280-226">[![Les produits sont triés par leurs prix](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="58280-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span></span>

<span data-ttu-id="58280-227">**Figure 11**: Les produits sont triés par leurs prix ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="58280-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image31.png))</span></span>

<span data-ttu-id="58280-228">[![Les produits sont classés par nom](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="58280-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span></span>

<span data-ttu-id="58280-229">**Figure 12**: Les produits sont triés par leur nom ([cliquez pour afficher l’image en taille réelle](adding-additional-datatable-columns-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="58280-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image34.png))</span></span>

> [!NOTE]
> <span data-ttu-id="58280-230">Avec quelques lignes de code nous aurions pu augmenter le contrôle GridView afin qu’il les lignes de produit en fonction de la couleur leurs `PriceQuartile` valeur.</span><span class="sxs-lookup"><span data-stu-id="58280-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="58280-231">Nous pourrions couleur ces produits dans le premier quartile vert clair, celles figurant dans le deuxième quartile un jaune clair et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="58280-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="58280-232">Je vous encourage à prendre un moment pour ajouter cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="58280-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="58280-233">Si vous avez besoin d’un rappel de mise en forme d’un GridView, consultez le [mise en forme en fonction lors de données personnalisées](../custom-formatting/custom-formatting-based-upon-data-vb.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="58280-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>

## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="58280-234">Une autre approche - création d’un autre TableAdapter</span><span class="sxs-lookup"><span data-stu-id="58280-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="58280-235">Comme nous l’avons vu dans ce didacticiel, lors de l’ajout d’une méthode à un TableAdapter qui renvoie les champs de données autres que ceux décrits par la requête principale, nous pouvons ajouter des colonnes correspondantes à la table de données.</span><span class="sxs-lookup"><span data-stu-id="58280-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="58280-236">Une telle approche, cependant, fonctionne bien uniquement s’il existe un petit nombre de méthodes dans le TableAdapter qui retournent des différents champs de données et si ces champs de données de remplacement ne varient pas trop à partir de la requête principale.</span><span class="sxs-lookup"><span data-stu-id="58280-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="58280-237">Au lieu d’ajouter des colonnes à la table de données, vous pouvez ajouter un autre TableAdapter au jeu de données qui contient les méthodes à partir de la première TableAdapter qui retournent des différents champs de données.</span><span class="sxs-lookup"><span data-stu-id="58280-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="58280-238">Pour ce didacticiel, plutôt que d’ajouter le `PriceQuartile` colonne à la `ProductsDataTable` (où il est utilisé uniquement par le `GetProductsWithPriceQuartile` (méthode)), nous aurions pu ajouter un TableAdapter supplémentaire au jeu de données nommé `ProductsWithPriceQuartileTableAdapter` servant le `Products_SelectWithPriceQuartile` stockées procédure en tant que sa requête principale.</span><span class="sxs-lookup"><span data-stu-id="58280-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="58280-239">Les pages ASP.NET qui nécessaires pour obtenir des informations de produit avec le quartile prix utiliserait le `ProductsWithPriceQuartileTableAdapter`, tandis que ceux qui n’a pas pu continuer à utiliser le `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="58280-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="58280-240">En ajoutant un nouveau TableAdapter, les tables de données restent untarnished et leurs colonnes reflètent précisément les champs de données retournés par leurs méthodes de s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="58280-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="58280-241">Toutefois, les TableAdapters supplémentaires peut introduire des fonctionnalités et les tâches répétitives.</span><span class="sxs-lookup"><span data-stu-id="58280-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="58280-242">Par exemple, si ces des pages ASP.NET qui affiche le `PriceQuartile` colonne également nécessaire pour fournir insert, update et delete prise en charge, le `ProductsWithPriceQuartileTableAdapter` doit avoir son `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés correctement configuré.</span><span class="sxs-lookup"><span data-stu-id="58280-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="58280-243">Bien que ces propriétés mettrait en miroir le `ProductsTableAdapter` s, cette configuration présente une étape supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="58280-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="58280-244">En outre, il existe maintenant deux façons de mettre à jour, supprimer ou ajouter un produit à la base de données - via la `ProductsTableAdapter` et `ProductsWithPriceQuartileTableAdapter` classes.</span><span class="sxs-lookup"><span data-stu-id="58280-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="58280-245">Le téléchargement de ce didacticiel inclut une `ProductsWithPriceQuartileTableAdapter` classe dans le `NorthwindWithSprocs` jeu de données qui illustre cette approche alternative.</span><span class="sxs-lookup"><span data-stu-id="58280-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="58280-246">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="58280-246">Summary</span></span>

<span data-ttu-id="58280-247">Dans la plupart des scénarios, toutes les méthodes dans un TableAdapter retournera le même ensemble de champs de données, mais parfois, quand une méthode particulière ou deux devra peut-être retourner un champ supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="58280-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="58280-248">Par exemple, dans le [maître/détail à l’aide d’une liste à puces des enregistrements maîtres avec une DataList des détails](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) didacticiel, nous avons ajouté une méthode à la `CategoriesTableAdapter` qui, en plus des champs de données de la requête principale s, retournés un `NumberOfProducts` champ qui a signalé le nombre de produits associées à chaque catégorie.</span><span class="sxs-lookup"><span data-stu-id="58280-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="58280-249">Dans ce didacticiel nous avons vu de l’ajout d’une méthode dans le `ProductsTableAdapter` qui a retourné un `PriceQuartile` champ en plus des champs de données de la requête principale s.</span><span class="sxs-lookup"><span data-stu-id="58280-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="58280-250">Pour capturer des données supplémentaires champs retournés par les méthodes de s TableAdapter que nous devons ajouter des colonnes correspondantes dans le DataTable.</span><span class="sxs-lookup"><span data-stu-id="58280-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="58280-251">Si vous envisagez sur l’ajout manuel des colonnes à la table de données, il est recommandé que le TableAdapter utiliser des procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="58280-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="58280-252">Si le TableAdapter utilise des instructions SQL ad hoc, n’importe quel moment de l’Assistant Configuration de TableAdapter est exécuté toutes les méthodes rétablir des listes de champs de données pour les champs de données retournés par la requête principale.</span><span class="sxs-lookup"><span data-stu-id="58280-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="58280-253">Ce problème ne s’étend pas aux procédures stockées, c’est pourquoi ils sont recommandés et ont été utilisés dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="58280-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="58280-254">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="58280-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="58280-255">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="58280-255">About the Author</span></span>

<span data-ttu-id="58280-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="58280-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="58280-257">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="58280-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="58280-258">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="58280-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="58280-259">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="58280-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="58280-260">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="58280-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="58280-261">Remerciements</span><span class="sxs-lookup"><span data-stu-id="58280-261">Special Thanks To</span></span>

<span data-ttu-id="58280-262">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="58280-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="58280-263">Les réviseurs tête pour ce didacticiel ont été Randy Schmidt, Goor Jacky, Bernadette Leigh et Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="58280-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="58280-264">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="58280-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="58280-265">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="58280-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="58280-266">[Précédent](updating-the-tableadapter-to-use-joins-vb.md)
> [Suivant](working-with-computed-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="58280-266">[Previous](updating-the-tableadapter-to-use-joins-vb.md)
[Next](working-with-computed-columns-vb.md)</span></span>
