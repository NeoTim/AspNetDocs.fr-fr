---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-cs
title: Débogage des procédures stockées (C#) | Microsoft Docs
author: rick-anderson
description: Les éditions Visual Studio Professional et Team System vous permettent de définir des points d’arrêt et un pas à pas détaillé des procédures stockées dans SQL Server, ce qui rend le débogage stocké...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: c655c324-2ffa-4c21-8265-a254d79a693d
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-cs
msc.type: authoredcontent
ms.openlocfilehash: 12a8500b107345b9cc9ab457016fdef09ca1bb9d
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74604864"
---
# <a name="debugging-stored-procedures-c"></a><span data-ttu-id="e3c31-103">Débogage des procédures stockées (C#)</span><span class="sxs-lookup"><span data-stu-id="e3c31-103">Debugging Stored Procedures (C#)</span></span>

<span data-ttu-id="e3c31-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e3c31-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e3c31-105">[Télécharger le code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_CS.zip) ou [Télécharger le PDF](debugging-stored-procedures-cs/_static/datatutorial74cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e3c31-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_CS.zip) or [Download PDF](debugging-stored-procedures-cs/_static/datatutorial74cs1.pdf)</span></span>

> <span data-ttu-id="e3c31-106">Les éditions Visual Studio Professional et Team System vous permettent de définir des points d’arrêt et un pas à pas détaillé des procédures stockées dans SQL Server, ce qui rend le débogage des procédures stockées aussi simple que le débogage du code de l’application.</span><span class="sxs-lookup"><span data-stu-id="e3c31-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="e3c31-107">Ce didacticiel illustre le débogage de base de données directe et le débogage d’applications des procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="e3c31-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>

## <a name="introduction"></a><span data-ttu-id="e3c31-108">Introduction</span><span class="sxs-lookup"><span data-stu-id="e3c31-108">Introduction</span></span>

<span data-ttu-id="e3c31-109">Visual Studio offre une expérience de débogage enrichie.</span><span class="sxs-lookup"><span data-stu-id="e3c31-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="e3c31-110">Avec quelques séquences de touches ou clics de souris, il est possible d’utiliser des points d’arrêt pour arrêter l’exécution d’un programme et examiner son état et son fluide de contrôle.</span><span class="sxs-lookup"><span data-stu-id="e3c31-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="e3c31-111">Outre le débogage du code d’application, Visual Studio offre une prise en charge du débogage des procédures stockées à partir de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3c31-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="e3c31-112">Tout comme les points d’arrêt peuvent être définis dans le code d’une classe code-behind ASP.NET ou d’une classe de couche de logique métier, il est également possible de les placer dans des procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="e3c31-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="e3c31-113">Dans ce didacticiel, nous allons examiner pas à pas les procédures stockées du Explorateur de serveurs dans Visual Studio, ainsi que la façon de définir des points d’arrêt qui sont atteints lorsque la procédure stockée est appelée à partir de l’application ASP.NET en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e3c31-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="e3c31-114">Malheureusement, les procédures stockées ne peuvent être exécutées pas à pas et déboguées par le biais des versions Professional et Team Systems de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e3c31-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="e3c31-115">Si vous utilisez Visual Web Developer ou la version standard de Visual Studio, vous êtes invité à lire les étapes à suivre pour déboguer les procédures stockées, mais vous ne pourrez pas répliquer ces étapes sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e3c31-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>

## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="e3c31-116">Concepts de débogage SQL Server</span><span class="sxs-lookup"><span data-stu-id="e3c31-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="e3c31-117">Microsoft SQL Server 2005 a été conçu pour permettre l’intégration au [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), qui est le runtime utilisé par tous les assemblys .net.</span><span class="sxs-lookup"><span data-stu-id="e3c31-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="e3c31-118">Par conséquent, SQL Server 2005 prend en charge les objets de base de données managés.</span><span class="sxs-lookup"><span data-stu-id="e3c31-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="e3c31-119">Autrement dit, vous pouvez créer des objets de base de données tels que des procédures stockées et des fonctions définies par l' C# utilisateur (UDF) en tant que méthodes dans une classe.</span><span class="sxs-lookup"><span data-stu-id="e3c31-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a C# class.</span></span> <span data-ttu-id="e3c31-120">Cela permet à ces procédures stockées et fonctions définies par l’utilisateur d’utiliser les fonctionnalités de la .NET Framework et de vos propres classes personnalisées.</span><span class="sxs-lookup"><span data-stu-id="e3c31-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="e3c31-121">Bien entendu, SQL Server 2005 fournit également la prise en charge des objets de base de données T-SQL.</span><span class="sxs-lookup"><span data-stu-id="e3c31-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="e3c31-122">SQL Server 2005 offre une prise en charge du débogage pour les objets T-SQL et les objets de base de données managés.</span><span class="sxs-lookup"><span data-stu-id="e3c31-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="e3c31-123">Toutefois, ces objets peuvent être débogués uniquement par le biais des éditions Visual Studio 2005 Professional et Team Systems.</span><span class="sxs-lookup"><span data-stu-id="e3c31-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="e3c31-124">Dans ce didacticiel, nous allons examiner le débogage des objets de base de données T-SQL.</span><span class="sxs-lookup"><span data-stu-id="e3c31-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="e3c31-125">Le didacticiel suivant examine le débogage des objets de base de données managés.</span><span class="sxs-lookup"><span data-stu-id="e3c31-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="e3c31-126">La [vue d’ensemble du débogage T-SQL et CLR dans SQL Server](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) entrée de blog 2005 de l' [équipe d’intégration de SQL Server 2005 CLR](https://blogs.msdn.com/sqlclr/default.aspx) met en évidence les trois façons de déboguer SQL Server 2005 objets à partir de Visual Studio :</span><span class="sxs-lookup"><span data-stu-id="e3c31-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="e3c31-127">**Débogage de base de données direct (DDD)** -à partir de Explorateur de serveurs nous pouvons parcourir n’importe quel objet de base de données T-SQL, comme les procédures stockées et les fonctions définies par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e3c31-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="e3c31-128">Nous allons examiner DDD à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="e3c31-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="e3c31-129">**Débogage d’application** : nous pouvons définir des points d’arrêt dans un objet de base de données, puis exécuter notre application ASP.net.</span><span class="sxs-lookup"><span data-stu-id="e3c31-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="e3c31-130">Lorsque l’objet de base de données est exécuté, le point d’arrêt est atteint et le contrôle est réactivé sur le débogueur.</span><span class="sxs-lookup"><span data-stu-id="e3c31-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="e3c31-131">Notez que le débogage d’application ne peut pas effectuer de pas à pas détaillé dans un objet de base de données à partir du code d’application.</span><span class="sxs-lookup"><span data-stu-id="e3c31-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="e3c31-132">Nous devons définir explicitement des points d’arrêt dans les procédures stockées ou les fonctions définies par l’utilisateur où nous voulons que le débogueur s’arrête.</span><span class="sxs-lookup"><span data-stu-id="e3c31-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="e3c31-133">Le débogage de l’application est examiné à partir de l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="e3c31-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="e3c31-134">Le **débogage à partir d’un projet SQL Server** Visual Studio Professional et les éditions de Team Systems incluent un type de projet SQL Server qui est couramment utilisé pour créer des objets de base de données managés.</span><span class="sxs-lookup"><span data-stu-id="e3c31-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="e3c31-135">Nous allons examiner l’utilisation des projets SQL Server et le débogage de leur contenu dans le didacticiel suivant.</span><span class="sxs-lookup"><span data-stu-id="e3c31-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="e3c31-136">Visual Studio peut déboguer des procédures stockées sur des instances locales et distantes de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3c31-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="e3c31-137">Une instance de SQL Server locale est une instance installée sur le même ordinateur que Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e3c31-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="e3c31-138">Si la base de données SQL Server que vous utilisez ne se trouve pas sur votre ordinateur de développement, elle est considérée comme une instance distante.</span><span class="sxs-lookup"><span data-stu-id="e3c31-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="e3c31-139">Pour ces didacticiels, nous utilisons des instances de SQL Server locales.</span><span class="sxs-lookup"><span data-stu-id="e3c31-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="e3c31-140">Le débogage de procédures stockées sur une instance SQL Server distante requiert davantage d’étapes de configuration que lors du débogage de procédures stockées sur une instance locale.</span><span class="sxs-lookup"><span data-stu-id="e3c31-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="e3c31-141">Si vous utilisez une instance de SQL Server locale, vous pouvez commencer par l’étape 1 et suivre ce didacticiel jusqu’à la fin.</span><span class="sxs-lookup"><span data-stu-id="e3c31-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="e3c31-142">Toutefois, si vous utilisez une instance de SQL Server distante, vous devez d’abord vous assurer que lors du débogage, vous êtes connecté à votre ordinateur de développement à l’aide d’un compte d’utilisateur Windows disposant d’une connexion SQL Server sur l’instance distante.</span><span class="sxs-lookup"><span data-stu-id="e3c31-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="e3c31-143">En outre, la connexion à la base de données et la connexion de base de données utilisée pour se connecter à la base de données à partir de l’application ASP.NET en cours d’exécution doivent être membres du rôle `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-143">Moreover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="e3c31-144">Pour plus d’informations sur la configuration de Visual Studio et SQL Server pour déboguer une instance distante, consultez la section débogage d’objets T-SQL Database sur des instances distantes à la fin de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="e3c31-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="e3c31-145">Enfin, sachez que la prise en charge du débogage pour les objets de base de données T-SQL n’est pas aussi riche que la prise en charge du débogage pour les applications .NET.</span><span class="sxs-lookup"><span data-stu-id="e3c31-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="e3c31-146">Par exemple, les conditions de point d’arrêt et les filtres ne sont pas pris en charge, seul un sous-ensemble des fenêtres de débogage sont disponibles, vous ne pouvez pas utiliser modifier & continuer, la fenêtre exécution est rendue inutilisable, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="e3c31-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="e3c31-147">Pour plus d’informations, consultez [limitations sur les commandes et les fonctionnalités du débogueur](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="e3c31-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="e3c31-148">Étape 1 : effectuer un pas à pas détaillé dans une procédure stockée</span><span class="sxs-lookup"><span data-stu-id="e3c31-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="e3c31-149">Visual Studio simplifie le débogage direct d’un objet de base de données.</span><span class="sxs-lookup"><span data-stu-id="e3c31-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="e3c31-150">Voyons comment utiliser la fonctionnalité de débogage de base de données directe (DDD) pour effectuer un pas à pas détaillé dans la procédure stockée `Products_SelectByCategoryID` dans la base de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="e3c31-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="e3c31-151">Comme son nom l’indique, `Products_SelectByCategoryID` retourne des informations sur les produits pour une catégorie particulière ; Il a été créé dans le didacticiel [utilisation de procédures stockées existantes pour les TableAdapters de DataSet typé](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="e3c31-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="e3c31-152">Commencez par accéder au Explorateur de serveurs et développez le nœud de la base de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="e3c31-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="e3c31-153">Explorez ensuite le dossier procédures stockées, cliquez avec le bouton droit sur la procédure stockée `Products_SelectByCategoryID`, puis choisissez l’option pas à pas détaillé dans la procédure stockée dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="e3c31-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="e3c31-154">Le débogueur est alors démarré.</span><span class="sxs-lookup"><span data-stu-id="e3c31-154">This will start the debugger.</span></span>

<span data-ttu-id="e3c31-155">Étant donné que la procédure stockée `Products_SelectByCategoryID` attend un paramètre d’entrée `@CategoryID`, nous sommes invités à fournir cette valeur.</span><span class="sxs-lookup"><span data-stu-id="e3c31-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="e3c31-156">Entrez 1, qui renverra des informations sur les boissons.</span><span class="sxs-lookup"><span data-stu-id="e3c31-156">Enter 1, which will return information about the beverages.</span></span>

![Utilisez la valeur 1 pour le paramètre @CategoryID](debugging-stored-procedures-cs/_static/image1.png)

<span data-ttu-id="e3c31-158">**Figure 1**: utiliser la valeur 1 pour le paramètre `@CategoryID`</span><span class="sxs-lookup"><span data-stu-id="e3c31-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>

<span data-ttu-id="e3c31-159">Une fois que vous avez fourni la valeur pour le paramètre `@CategoryID`, la procédure stockée est exécutée.</span><span class="sxs-lookup"><span data-stu-id="e3c31-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="e3c31-160">Au lieu d’exécuter jusqu’à la fin, toutefois, le débogueur arrête l’exécution sur la première instruction.</span><span class="sxs-lookup"><span data-stu-id="e3c31-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="e3c31-161">Notez la flèche jaune dans la marge, indiquant l’emplacement actuel dans la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="e3c31-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="e3c31-162">Vous pouvez afficher et modifier les valeurs des paramètres par le biais de la Fenêtre Espion ou en plaçant le curseur sur le nom du paramètre dans la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="e3c31-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>

<span data-ttu-id="e3c31-163">[![le débogueur s’est arrêté sur la première instruction de la procédure stockée](debugging-stored-procedures-cs/_static/image3.png)](debugging-stored-procedures-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="e3c31-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-cs/_static/image3.png)](debugging-stored-procedures-cs/_static/image2.png)</span></span>

<span data-ttu-id="e3c31-164">**Figure 2**: le débogueur s’est arrêté sur la première instruction de la procédure stockée ([cliquez pour afficher l’image en taille réelle](debugging-stored-procedures-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="e3c31-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-cs/_static/image4.png))</span></span>

<span data-ttu-id="e3c31-165">Pour exécuter pas à pas la procédure stockée une instruction à la fois, cliquez sur le bouton pas à pas principal dans la barre d’outils ou appuyez sur la touche F10.</span><span class="sxs-lookup"><span data-stu-id="e3c31-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="e3c31-166">La procédure stockée `Products_SelectByCategoryID` contient une seule instruction `SELECT`. en appuyant sur F10, vous allez effectuer un pas à pas principal dans l’instruction unique et terminer l’exécution de la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="e3c31-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will Step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="e3c31-167">Une fois la procédure stockée terminée, sa sortie s’affiche dans la fenêtre sortie et le débogueur se termine.</span><span class="sxs-lookup"><span data-stu-id="e3c31-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="e3c31-168">Le débogage T-SQL se produit au niveau de l’instruction ; vous ne pouvez pas effectuer un pas à pas détaillé dans une instruction `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-168">T-SQL debugging occurs at the statement level; you cannot Step into a `SELECT` statement.</span></span>

## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="e3c31-169">Étape 2 : configuration du site Web pour le débogage des applications</span><span class="sxs-lookup"><span data-stu-id="e3c31-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="e3c31-170">Bien que le débogage d’une procédure stockée directement à partir de l’Explorateur de serveurs soit pratique, dans de nombreux scénarios, nous sommes plus intéressés à déboguer la procédure stockée lorsqu’elle est appelée à partir de notre application ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e3c31-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="e3c31-171">Nous pouvons ajouter des points d’arrêt à une procédure stockée à partir de Visual Studio, puis démarrer le débogage de l’application ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e3c31-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="e3c31-172">Lorsqu’une procédure stockée avec des points d’arrêt est appelée à partir de l’application, l’exécution s’arrête au point d’arrêt et vous pouvez afficher et modifier les valeurs des paramètres de la procédure stockée et parcourir ses instructions, comme nous l’avons fait à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="e3c31-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="e3c31-173">Avant de pouvoir démarrer le débogage des procédures stockées appelées à partir de l’application, nous devons demander à l’application Web ASP.NET de s’intégrer au débogueur SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3c31-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="e3c31-174">Commencez par cliquer avec le bouton droit sur le nom du site Web dans le Explorateur de solutions (`ASPNET_Data_Tutorial_74_CS`).</span><span class="sxs-lookup"><span data-stu-id="e3c31-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_CS`).</span></span> <span data-ttu-id="e3c31-175">Choisissez l’option pages de propriétés dans le menu contextuel, sélectionnez l’élément options de démarrage à gauche, puis activez la case à cocher SQL Server dans la section débogueurs (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="e3c31-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>

<span data-ttu-id="e3c31-176">[![cochez la case SQL Server dans les pages de propriétés de l’application](debugging-stored-procedures-cs/_static/image6.png)](debugging-stored-procedures-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e3c31-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-cs/_static/image6.png)](debugging-stored-procedures-cs/_static/image5.png)</span></span>

<span data-ttu-id="e3c31-177">**Figure 3**: activer la case à cocher SQL Server dans les pages de propriétés de l’application ([cliquez pour afficher l’image en taille réelle](debugging-stored-procedures-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="e3c31-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-cs/_static/image7.png))</span></span>

<span data-ttu-id="e3c31-178">En outre, nous devons mettre à jour la chaîne de connexion de base de données utilisée par l’application afin que le regroupement de connexions soit désactivé.</span><span class="sxs-lookup"><span data-stu-id="e3c31-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="e3c31-179">Lorsqu’une connexion à une base de données est fermée, l’objet `SqlConnection` correspondant est placé dans un pool de connexions disponibles.</span><span class="sxs-lookup"><span data-stu-id="e3c31-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="e3c31-180">Lors de l’établissement d’une connexion à une base de données, un objet de connexion disponible peut être récupéré à partir de ce pool au lieu d’avoir à créer et à établir une nouvelle connexion.</span><span class="sxs-lookup"><span data-stu-id="e3c31-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="e3c31-181">Ce regroupement d’objets de connexion est une amélioration des performances et est activé par défaut.</span><span class="sxs-lookup"><span data-stu-id="e3c31-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="e3c31-182">Toutefois, lors du débogage, nous voulons désactiver le regroupement de connexions, car l’infrastructure de débogage n’est pas correctement rétablie lors de l’utilisation d’une connexion qui a été effectuée à partir du pool.</span><span class="sxs-lookup"><span data-stu-id="e3c31-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="e3c31-183">Pour désactiver le regroupement de connexions, mettez à jour le `NORTHWNDConnectionString` dans `Web.config` afin qu’il comprenne le paramètre `Pooling=false`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>

[!code-xml[Main](debugging-stored-procedures-cs/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="e3c31-184">Une fois que vous avez terminé le débogage SQL Server par le biais de l’application ASP.NET, veillez à rétablir le regroupement de connexions en supprimant le paramètre `Pooling` de la chaîne de connexion (ou en lui affectant la valeur `Pooling=true`).</span><span class="sxs-lookup"><span data-stu-id="e3c31-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>

<span data-ttu-id="e3c31-185">À ce stade, l’application ASP.NET a été configurée pour permettre à Visual Studio de déboguer SQL Server objets de base de données lorsqu’elle est appelée par le biais de l’application Web.</span><span class="sxs-lookup"><span data-stu-id="e3c31-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="e3c31-186">Tout ce qui reste à présent, c’est d’ajouter un point d’arrêt à une procédure stockée et de démarrer le débogage !</span><span class="sxs-lookup"><span data-stu-id="e3c31-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="e3c31-187">Étape 3 : ajout d’un point d’arrêt et débogage</span><span class="sxs-lookup"><span data-stu-id="e3c31-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="e3c31-188">Ouvrez la procédure stockée `Products_SelectByCategoryID` et définissez un point d’arrêt au début de l’instruction `SELECT` en cliquant dans la marge à l’emplacement approprié ou en plaçant votre curseur au début de l’instruction `SELECT` et en appuyant sur F9.</span><span class="sxs-lookup"><span data-stu-id="e3c31-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="e3c31-189">Comme illustré à la figure 4, le point d’arrêt apparaît sous la forme d’un cercle rouge dans la marge.</span><span class="sxs-lookup"><span data-stu-id="e3c31-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>

<span data-ttu-id="e3c31-190">[![définir un point d’arrêt dans la procédure stockée Products_SelectByCategoryID](debugging-stored-procedures-cs/_static/image9.png)](debugging-stored-procedures-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="e3c31-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-cs/_static/image9.png)](debugging-stored-procedures-cs/_static/image8.png)</span></span>

<span data-ttu-id="e3c31-191">**Figure 4**: définir un point d’arrêt dans la procédure stockée `Products_SelectByCategoryID` ([cliquez pour afficher l’image en taille réelle](debugging-stored-procedures-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="e3c31-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-cs/_static/image10.png))</span></span>

<span data-ttu-id="e3c31-192">Pour qu’un objet SQL Database soit débogué par le biais d’une application cliente, il est impératif que la base de données soit configurée pour prendre en charge le débogage d’application.</span><span class="sxs-lookup"><span data-stu-id="e3c31-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="e3c31-193">Lorsque vous définissez un point d’arrêt pour la première fois, ce paramètre doit être automatiquement activé, mais il est prudent de procéder à une double vérification.</span><span class="sxs-lookup"><span data-stu-id="e3c31-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="e3c31-194">Cliquez avec le bouton droit sur le nœud `NORTHWND.MDF` dans le Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="e3c31-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="e3c31-195">Le menu contextuel doit inclure un élément de menu coché nommé débogage de l’application.</span><span class="sxs-lookup"><span data-stu-id="e3c31-195">The context menu should include a checked menu item named Application Debugging .</span></span>

![Vérifier que l’option de débogage de l’application est activée](debugging-stored-procedures-cs/_static/image11.png)

<span data-ttu-id="e3c31-197">**Figure 5**: vérifier que l’option débogage de l’application est activée</span><span class="sxs-lookup"><span data-stu-id="e3c31-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>

<span data-ttu-id="e3c31-198">Lorsque le point d’arrêt est défini et que l’option débogage de l’application est activée, nous sommes prêts à déboguer la procédure stockée quand elle est appelée à partir de l’application ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e3c31-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="e3c31-199">Démarrez le débogueur en accédant au menu Déboguer et en choisissant Démarrer le débogage, en appuyant sur F5 ou en cliquant sur l’icône de lecture verte dans la barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="e3c31-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="e3c31-200">Cette opération démarre le débogueur et lance le site Web.</span><span class="sxs-lookup"><span data-stu-id="e3c31-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="e3c31-201">La procédure stockée `Products_SelectByCategoryID` a été créée dans le didacticiel [utilisation de procédures stockées existantes pour les TableAdapters de DataSet typé](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="e3c31-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="e3c31-202">Sa page Web correspondante (`~/AdvancedDAL/ExistingSprocs.aspx`) contient un GridView qui affiche les résultats retournés par cette procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="e3c31-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="e3c31-203">Visitez cette page via le navigateur.</span><span class="sxs-lookup"><span data-stu-id="e3c31-203">Visit this page through the browser.</span></span> <span data-ttu-id="e3c31-204">Quand vous atteignez la page, le point d’arrêt dans la procédure stockée `Products_SelectByCategoryID` est atteint et le contrôle est retourné à Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e3c31-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="e3c31-205">Comme dans l’étape 1, vous pouvez parcourir les instructions des procédures stockées et afficher et modifier les valeurs des paramètres.</span><span class="sxs-lookup"><span data-stu-id="e3c31-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>

<span data-ttu-id="e3c31-206">[![la page ExistingSprocs. aspx affiche initialement les boissons](debugging-stored-procedures-cs/_static/image13.png)](debugging-stored-procedures-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="e3c31-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-cs/_static/image13.png)](debugging-stored-procedures-cs/_static/image12.png)</span></span>

<span data-ttu-id="e3c31-207">**Figure 6**: la page `ExistingSprocs.aspx` affiche initialement les boissons ([cliquez pour afficher l’image en plein écran](debugging-stored-procedures-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="e3c31-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-cs/_static/image14.png))</span></span>

<span data-ttu-id="e3c31-208">[![le point d’arrêt des procédures stockées a été atteint](debugging-stored-procedures-cs/_static/image16.png)](debugging-stored-procedures-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e3c31-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-cs/_static/image16.png)](debugging-stored-procedures-cs/_static/image15.png)</span></span>

<span data-ttu-id="e3c31-209">**Figure 7**: le point d’arrêt de la procédure stockée a été atteint ([cliquez pour afficher l’image en taille réelle](debugging-stored-procedures-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="e3c31-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-cs/_static/image17.png))</span></span>

<span data-ttu-id="e3c31-210">Comme le montre la Fenêtre Espion de la figure 7, la valeur du paramètre `@CategoryID` est 1.</span><span class="sxs-lookup"><span data-stu-id="e3c31-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="e3c31-211">Cela est dû au fait que la page `ExistingSprocs.aspx` affiche initialement les produits de la catégorie boissons, qui ont une valeur `CategoryID` de 1.</span><span class="sxs-lookup"><span data-stu-id="e3c31-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="e3c31-212">Choisissez une autre catégorie dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="e3c31-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="e3c31-213">Cela provoque une publication (postback) et réexécute la procédure stockée `Products_SelectByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="e3c31-214">Le point d’arrêt est de nouveau atteint, mais cette fois, la valeur du paramètre `@CategoryID` correspond à la `CategoryID`des éléments de liste déroulante sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="e3c31-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>

<span data-ttu-id="e3c31-215">[![choisir une autre catégorie dans la liste déroulante](debugging-stored-procedures-cs/_static/image19.png)](debugging-stored-procedures-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="e3c31-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-cs/_static/image19.png)](debugging-stored-procedures-cs/_static/image18.png)</span></span>

<span data-ttu-id="e3c31-216">**Figure 8**: choisir une autre catégorie dans la liste déroulante ([cliquez pour afficher l’image en taille réelle](debugging-stored-procedures-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="e3c31-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-cs/_static/image20.png))</span></span>

<span data-ttu-id="e3c31-217">[![le paramètre @CategoryID reflète la catégorie sélectionnée à partir de la page Web](debugging-stored-procedures-cs/_static/image22.png)](debugging-stored-procedures-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e3c31-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-cs/_static/image22.png)](debugging-stored-procedures-cs/_static/image21.png)</span></span>

<span data-ttu-id="e3c31-218">**Figure 9**: le paramètre `@CategoryID` reflète la catégorie sélectionnée à partir de la page Web ([cliquez pour afficher l’image en taille réelle](debugging-stored-procedures-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="e3c31-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-cs/_static/image23.png))</span></span>

> [!NOTE]
> <span data-ttu-id="e3c31-219">Si le point d’arrêt de la procédure stockée `Products_SelectByCategoryID` n’est pas atteint lors de la visite de la page de `ExistingSprocs.aspx`, assurez-vous que la case à cocher SQL Server a été activée dans la section débogueurs de la page de propriétés de l’application ASP.NET, que le regroupement de connexions a été désactivé et que l’option de débogage de l’application base de données est activée.</span><span class="sxs-lookup"><span data-stu-id="e3c31-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="e3c31-220">Si vous rencontrez encore des problèmes, redémarrez Visual Studio et réessayez.</span><span class="sxs-lookup"><span data-stu-id="e3c31-220">If you re still having problems, restart Visual Studio and try again.</span></span>

## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="e3c31-221">Débogage d’objets T-SQL Database sur des instances distantes</span><span class="sxs-lookup"><span data-stu-id="e3c31-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="e3c31-222">Le débogage des objets de base de données par le biais de Visual Studio est relativement simple lorsque l’instance de base de données SQL Server se trouve sur le même ordinateur que Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e3c31-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="e3c31-223">Toutefois, si SQL Server et Visual Studio résident sur des ordinateurs différents, une configuration minutieuse est nécessaire pour que tout fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="e3c31-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="e3c31-224">Nous avons rencontré deux tâches principales :</span><span class="sxs-lookup"><span data-stu-id="e3c31-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="e3c31-225">Assurez-vous que la connexion utilisée pour se connecter à la base de données via ADO.NET appartient au rôle `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="e3c31-226">Assurez-vous que le compte d’utilisateur Windows utilisé par Visual Studio sur l’ordinateur de développement est un compte de connexion SQL Server valide qui appartient au rôle `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="e3c31-227">La première étape est relativement simple.</span><span class="sxs-lookup"><span data-stu-id="e3c31-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="e3c31-228">Tout d’abord, identifiez le compte d’utilisateur utilisé pour se connecter à la base de données à partir de l’application ASP.NET, puis, dans SQL Server Management Studio, ajoutez ce compte de connexion au rôle `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="e3c31-229">La deuxième tâche nécessite que le compte d’utilisateur Windows que vous utilisez pour déboguer l’application soit une connexion valide sur la base de données distante.</span><span class="sxs-lookup"><span data-stu-id="e3c31-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="e3c31-230">Toutefois, il est probable que le compte Windows avec lequel vous vous êtes connecté à votre station de travail n’est pas une connexion valide sur SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3c31-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="e3c31-231">Au lieu d’ajouter votre compte de connexion particulier à SQL Server, il est préférable de désigner un compte d’utilisateur Windows comme compte de débogage SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3c31-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="e3c31-232">Ensuite, pour déboguer les objets de base de données d’une instance de SQL Server distante, vous devez exécuter Visual Studio en utilisant les informations d’identification de ce compte de connexion Windows.</span><span class="sxs-lookup"><span data-stu-id="e3c31-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="e3c31-233">Un exemple doit vous aider à clarifier les choses.</span><span class="sxs-lookup"><span data-stu-id="e3c31-233">An example should help clarify things.</span></span> <span data-ttu-id="e3c31-234">Imaginez qu’il existe un compte Windows nommé `SQLDebug` dans le domaine Windows.</span><span class="sxs-lookup"><span data-stu-id="e3c31-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="e3c31-235">Ce compte doit être ajouté à l’instance SQL Server distante en tant que connexion valide et en tant que membre du rôle `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="e3c31-236">Ensuite, pour déboguer l’instance SQL Server distante à partir de Visual Studio, vous devez exécuter Visual Studio en tant qu’utilisateur `SQLDebug`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="e3c31-237">Pour ce faire, vous devez vous déconnecter de notre station de travail, vous reconnecter en tant que `SQLDebug`, puis démarrer Visual Studio, mais une approche plus simple consiste à se connecter à notre station de travail à l’aide de vos propres informations d’identification, puis à utiliser `runas.exe` pour lancer Visual Studio en tant qu' `SQLDebug` utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e3c31-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="e3c31-238">`runas.exe` permet l’exécution d’une application particulière sous le forme d’un compte d’utilisateur différent.</span><span class="sxs-lookup"><span data-stu-id="e3c31-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="e3c31-239">Pour lancer Visual Studio en tant que `SQLDebug`, vous pouvez entrer l’instruction suivante sur la ligne de commande :</span><span class="sxs-lookup"><span data-stu-id="e3c31-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>

[!code-console[Main](debugging-stored-procedures-cs/samples/sample2.cmd)]

<span data-ttu-id="e3c31-240">Pour obtenir une explication plus détaillée de ce processus, consultez [William R. Vaughn](http://betav.com/BLOG/billva/) s *hitchhiker’s s Guide to Visual Studio and SQL Server, septième édition,* ainsi que [comment : définir des autorisations SQL Server pour le débogage](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="e3c31-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="e3c31-241">Si votre ordinateur de développement exécute Windows XP Service Pack 2, vous devez configurer le pare-feu de connexion Internet pour autoriser le débogage distant.</span><span class="sxs-lookup"><span data-stu-id="e3c31-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="e3c31-242">L’article Guide pratique [pour activer le débogage SQL Server 2005](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) note que cela implique deux étapes : (a) sur l’ordinateur hôte Visual Studio, vous devez ajouter `Devenv.exe` à la liste des exceptions et ouvrir le port TCP 135. et (b) sur l’ordinateur distant (SQL), vous devez ouvrir le port TCP 135 et ajouter `sqlservr.exe` à la liste des exceptions.</span><span class="sxs-lookup"><span data-stu-id="e3c31-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="e3c31-243">Si votre stratégie de domaine nécessite que la communication réseau soit effectuée via IPSec, vous devez ouvrir les ports UDP 4500 et UDP 500.</span><span class="sxs-lookup"><span data-stu-id="e3c31-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>

## <a name="summary"></a><span data-ttu-id="e3c31-244">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="e3c31-244">Summary</span></span>

<span data-ttu-id="e3c31-245">En plus de fournir une prise en charge du débogage pour le code d’application .NET, Visual Studio fournit également une variété d’options de débogage pour SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="e3c31-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="e3c31-246">Dans ce didacticiel, nous avons vu deux de ces options : débogage de base de données direct et débogage d’application.</span><span class="sxs-lookup"><span data-stu-id="e3c31-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="e3c31-247">Pour déboguer directement un objet de base de données T-SQL, recherchez l’objet à l’aide de l’Explorateur de serveurs cliquez dessus avec le bouton droit et choisissez pas à pas détaillé.</span><span class="sxs-lookup"><span data-stu-id="e3c31-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="e3c31-248">Cela démarre le débogueur et s’arrête sur la première instruction de l’objet de base de données. à ce stade, vous pouvez parcourir les instructions de l’objet et afficher et modifier les valeurs des paramètres.</span><span class="sxs-lookup"><span data-stu-id="e3c31-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="e3c31-249">À l’étape 1, nous avons utilisé cette approche pour effectuer un pas à pas détaillé dans la procédure stockée `Products_SelectByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="e3c31-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="e3c31-250">Le débogage d’application permet de définir des points d’arrêt directement dans les objets de base de données.</span><span class="sxs-lookup"><span data-stu-id="e3c31-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="e3c31-251">Lorsqu’un objet de base de données avec des points d’arrêt est appelé à partir d’une application cliente (telle qu’une application Web ASP.NET), le programme s’arrête lorsque le débogueur prend le relais.</span><span class="sxs-lookup"><span data-stu-id="e3c31-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="e3c31-252">Le débogage d’application est utile, car il montre plus clairement quelle action de l’application entraîne l’appel d’un objet de base de données particulier.</span><span class="sxs-lookup"><span data-stu-id="e3c31-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="e3c31-253">Toutefois, elle nécessite un peu plus de configuration et de configuration que le débogage de base de données directe.</span><span class="sxs-lookup"><span data-stu-id="e3c31-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="e3c31-254">Les objets de base de données peuvent également être débogués via des projets SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3c31-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="e3c31-255">Nous allons examiner l’utilisation de SQL Server projets et comment les utiliser pour créer et déboguer des objets de base de données managés dans le didacticiel suivant.</span><span class="sxs-lookup"><span data-stu-id="e3c31-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="e3c31-256">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="e3c31-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e3c31-257">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="e3c31-257">About the Author</span></span>

<span data-ttu-id="e3c31-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="e3c31-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e3c31-259">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="e3c31-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e3c31-260">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e3c31-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e3c31-261">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e3c31-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e3c31-262">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e3c31-262">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e3c31-263">[Précédent](protecting-connection-strings-and-other-configuration-information-cs.md)
> [Suivant](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)</span><span class="sxs-lookup"><span data-stu-id="e3c31-263">[Previous](protecting-connection-strings-and-other-configuration-information-cs.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)</span></span>
