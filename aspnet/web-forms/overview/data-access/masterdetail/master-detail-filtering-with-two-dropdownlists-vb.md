---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
title: Maître/détail avec deux DropDownList (VB) le filtrage | Microsoft Docs
author: rick-anderson
description: Ce didacticiel développe la relation maître/détail pour ajouter une troisième couche, à l’aide de deux contrôles DropDownList pour sélectionner le dit parent et le grand-parent souhaité...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 11ae4f64-01ba-4823-95f4-a2fe1f84f7d7
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
msc.type: authoredcontent
ms.openlocfilehash: 20df98f1aacb046bb9ec9fa5ad03e008dc234509
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57040116"
---
<a name="masterdetail-filtering-with-two-dropdownlists-vb"></a><span data-ttu-id="0f82d-103">Filtrage maître/détail avec deux DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="0f82d-103">Master/Detail Filtering With Two DropDownLists (VB)</span></span>
====================
<span data-ttu-id="0f82d-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0f82d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0f82d-105">[Télécharger l’exemple d’application](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) ou [télécharger le PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0f82d-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) or [Download PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span></span>

> <span data-ttu-id="0f82d-106">Ce didacticiel développe la relation maître/détail pour ajouter une troisième couche, à l’aide de deux contrôles DropDownList pour sélectionner les enregistrements parents et le grand-parent souhaités.</span><span class="sxs-lookup"><span data-stu-id="0f82d-106">This tutorial expands the master/detail relationship to add a third layer, using two DropDownList controls to select the desired parent and grandparent records.</span></span>


## <a name="introduction"></a><span data-ttu-id="0f82d-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="0f82d-107">Introduction</span></span>

<span data-ttu-id="0f82d-108">Dans le [didacticiel précédent](master-detail-filtering-with-a-dropdownlist-vb.md) nous avons examiné comment afficher un rapport maître/détail simple à l’aide d’un seul DropDownList rempli avec les catégories et un GridView affichant les produits qui appartiennent à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-108">In the [previous tutorial](master-detail-filtering-with-a-dropdownlist-vb.md) we examined how to display a simple master/details report using a single DropDownList populated with the categories and a GridView showing those products that belong to the selected category.</span></span> <span data-ttu-id="0f82d-109">Ce modèle de rapport fonctionne bien lors de l’affichage des enregistrements qui ont une relation un-à-plusieurs et peuvent facilement être étendus pour fonctionner pour les scénarios incluant plusieurs relations un-à-plusieurs.</span><span class="sxs-lookup"><span data-stu-id="0f82d-109">This report pattern works well when displaying records that have a one-to-many relationship and can easily be extended to work for scenarios that include multiple one-to-many relationships.</span></span> <span data-ttu-id="0f82d-110">Par exemple, un système de saisie de commandes aurait des tables qui correspondent aux clients, commandes et éléments de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="0f82d-110">For example, an order entry system would have tables that correspond to customers, orders, and order line items.</span></span> <span data-ttu-id="0f82d-111">Un client donné peut avoir plusieurs commandes avec chaque commande composée de plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="0f82d-111">A given customer may have multiple orders with each order consisting of multiple items.</span></span> <span data-ttu-id="0f82d-112">Ces données peuvent être présentées à l’utilisateur avec deux DropDownList et un GridView.</span><span class="sxs-lookup"><span data-stu-id="0f82d-112">Such data can be presented to the user with two DropDownLists and a GridView.</span></span> <span data-ttu-id="0f82d-113">La première DropDownList aurait un élément de liste pour chaque client dans la base de données et de la seconde de contenu en cours de commandes passées par le client sélectionné.</span><span class="sxs-lookup"><span data-stu-id="0f82d-113">The first DropDownList would have a list item for each customer in the database with the second one's contents being the orders placed by the selected customer.</span></span> <span data-ttu-id="0f82d-114">Un GridView répertorie les éléments de ligne de la commande sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-114">A GridView would list the line items from the selected order.</span></span>

<span data-ttu-id="0f82d-115">Si la base de données Northwind inclut les informations de détails de commande/customer/order canonique dans son `Customers`, `Orders`, et `Order Details` tables, ces tables ne sont pas capturés dans notre architecture.</span><span class="sxs-lookup"><span data-stu-id="0f82d-115">While the Northwind database include the canonical customer/order/order details information in its `Customers`, `Orders`, and `Order Details` tables, these tables aren't captured in our architecture.</span></span> <span data-ttu-id="0f82d-116">Néanmoins, nous pouvons toujours illustrent à l’aide de deux DropDownList dépendants.</span><span class="sxs-lookup"><span data-stu-id="0f82d-116">Nonetheless, we can still illustrate using two dependent DropDownLists.</span></span> <span data-ttu-id="0f82d-117">La première DropDownList répertorie les catégories et le second les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-117">The first DropDownList will list the categories and the second the products belonging to the selected category.</span></span> <span data-ttu-id="0f82d-118">Un contrôle DetailsView répertorie ensuite les détails du produit sélectionné.</span><span class="sxs-lookup"><span data-stu-id="0f82d-118">A DetailsView will then list the details of the selected product.</span></span>

## <a name="step-1-creating-and-populating-the-categories-dropdownlist"></a><span data-ttu-id="0f82d-119">Étape 1 : Création et remplissage de l’objet DropDownList de catégories</span><span class="sxs-lookup"><span data-stu-id="0f82d-119">Step 1: Creating and Populating the Categories DropDownList</span></span>

<span data-ttu-id="0f82d-120">Notre objectif premier consiste à ajouter de la liste DropDownList qui répertorie les catégories.</span><span class="sxs-lookup"><span data-stu-id="0f82d-120">Our first goal is to add the DropDownList that lists the categories.</span></span> <span data-ttu-id="0f82d-121">Ces étapes ont été examinés en détail dans le didacticiel précédent, mais sont résumées ici par souci d’exhaustivité.</span><span class="sxs-lookup"><span data-stu-id="0f82d-121">These steps were examined in detail in the preceding tutorial, but are summarized here for completeness.</span></span>

<span data-ttu-id="0f82d-122">Ouvrir le `MasterDetailsDetails.aspx` page dans le `Filtering` dossier, ajoutez un contrôle DropDownList à la page, définissez son `ID` propriété `Categories`, puis cliquez sur le lien configurer la Source de données dans sa balise active.</span><span class="sxs-lookup"><span data-stu-id="0f82d-122">Open the `MasterDetailsDetails.aspx` page in the `Filtering` folder, add a DropDownList to the page, set its `ID` property to `Categories`, and then click the Configure Data Source link in its smart tag.</span></span> <span data-ttu-id="0f82d-123">À partir de l’Assistant de Configuration de Source de données choisir d’ajouter une nouvelle source de données.</span><span class="sxs-lookup"><span data-stu-id="0f82d-123">From the Data Source Configuration Wizard choose to add a new data source.</span></span>


<span data-ttu-id="0f82d-124">[![Ajouter une nouvelle Source de données pour l’objet DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-124">[![Add a New Data Source for the DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span></span>

<span data-ttu-id="0f82d-125">**Figure 1**: Ajouter une nouvelle Source de données pour l’objet DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-125">**Figure 1**: Add a New Data Source for the DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span></span>


<span data-ttu-id="0f82d-126">La nouvelle source de données devrait être naturellement, un ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0f82d-126">The new data source should, naturally, be an ObjectDataSource.</span></span> <span data-ttu-id="0f82d-127">Nommez cette nouvelle ObjectDataSource `CategoriesDataSource` et appeler le `CategoriesBLL` l’objet `GetCategories()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="0f82d-127">Name this new ObjectDataSource `CategoriesDataSource` and have it invoke the `CategoriesBLL` object's `GetCategories()` method.</span></span>


<span data-ttu-id="0f82d-128">[![Choisissez d’utiliser la classe CategoriesBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span></span>

<span data-ttu-id="0f82d-129">**Figure 2**: Choisissez d’utiliser le `CategoriesBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-129">**Figure 2**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span></span>


<span data-ttu-id="0f82d-130">[![Configurer pour utiliser la méthode GetCategories() ObjectDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span></span>

<span data-ttu-id="0f82d-131">**Figure 3**: Configurer l’ObjectDataSource à utiliser le `GetCategories()` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-131">**Figure 3**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span></span>


<span data-ttu-id="0f82d-132">Après avoir configuré l’ObjectDataSource nous devons toujours spécifier quel champ de source de données doit être affiché dans le `Categories` DropDownList et celle qui doit être configuré en tant que la valeur de l’élément de liste.</span><span class="sxs-lookup"><span data-stu-id="0f82d-132">After configuring the ObjectDataSource we still need to specify which data source field should be displayed in the `Categories` DropDownList and which one should be configured as the value for the list item.</span></span> <span data-ttu-id="0f82d-133">Définir le `CategoryName` champ en tant que l’affichage et `CategoryID` comme valeur pour chaque élément de liste.</span><span class="sxs-lookup"><span data-stu-id="0f82d-133">Set the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="0f82d-134">[![Ont l’affichage DropDownList le champ nom de catégorie et utilisez CategoryID comme valeur](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span></span>

<span data-ttu-id="0f82d-135">**Figure 4**: Affiche la liste DropDownList le `CategoryName` champ et utilisez `CategoryID` comme valeur ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-135">**Figure 4**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span></span>


<span data-ttu-id="0f82d-136">À ce stade, nous avons un contrôle DropDownList (`Categories`) qui est rempli avec les enregistrements à partir de la `Categories` table.</span><span class="sxs-lookup"><span data-stu-id="0f82d-136">At this point we have a DropDownList control (`Categories`) that's populated with the records from the `Categories` table.</span></span> <span data-ttu-id="0f82d-137">Lorsque l’utilisateur choisit une nouvelle catégorie dans la liste DropDownList, nous devrons attraper une publication (postback) se produise pour actualiser le produit DropDownList que nous allons créer à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="0f82d-137">When the user chooses a new category from the DropDownList we'll want a postback to occur in order to refresh the product DropDownList that we're going to create in Step 2.</span></span> <span data-ttu-id="0f82d-138">Par conséquent, vérifiez l’option Activer AutoPostBack à partir de la `categories` balise active de DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0f82d-138">Therefore, check the Enable AutoPostBack option from the `categories` DropDownList's smart tag.</span></span>


<span data-ttu-id="0f82d-139">[![Activer AutoPostBack pour l’objet DropDownList de catégories](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-139">[![Enable AutoPostBack for the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span></span>

<span data-ttu-id="0f82d-140">**Figure 5**: Activer AutoPostBack pour le `Categories` DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-140">**Figure 5**: Enable AutoPostBack for the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span></span>


## <a name="step-2-displaying-the-selected-categorys-products-in-a-second-dropdownlist"></a><span data-ttu-id="0f82d-141">Étape 2 : Affichage des produits de la catégorie sélectionnée dans une deuxième DropDownList</span><span class="sxs-lookup"><span data-stu-id="0f82d-141">Step 2: Displaying the Selected Category's Products in a Second DropDownList</span></span>

<span data-ttu-id="0f82d-142">Avec le `Categories` DropDownList terminée, l’étape suivante consiste à afficher un contrôle DropDownList de produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-142">With the `Categories` DropDownList completed, our next step is to display a DropDownList of products belonging to the selected category.</span></span> <span data-ttu-id="0f82d-143">Pour ce faire, ajoutez un autre DropDownList vers la page nommée `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="0f82d-143">To accomplish this, add another DropDownList to the page named `ProductsByCategory`.</span></span> <span data-ttu-id="0f82d-144">Comme avec la `Categories` DropDownList, créer un nouveau ObjectDataSource pour le `ProductsByCategory` DropDownList nommé `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0f82d-144">As with the `Categories` DropDownList, create a new ObjectDataSource for the `ProductsByCategory` DropDownList named `ProductsByCategoryDataSource`.</span></span>


<span data-ttu-id="0f82d-145">[![Ajouter une nouvelle Source de données pour l’objet ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-145">[![Add a New Data Source for the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span></span>

<span data-ttu-id="0f82d-146">**Figure 6**: Ajouter une nouvelle Source de données pour le `ProductsByCategory` DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-146">**Figure 6**: Add a New Data Source for the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span></span>


<span data-ttu-id="0f82d-147">[![Créer un nouveau ObjectDataSource nommé ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-147">[![Create a New ObjectDataSource Named ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span></span>

<span data-ttu-id="0f82d-148">**Figure 7**: Créer une nouvelle nommée de ObjectDataSource `ProductsByCategoryDataSource` ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-148">**Figure 7**: Create a New ObjectDataSource Named `ProductsByCategoryDataSource` ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span></span>


<span data-ttu-id="0f82d-149">Dans la mesure où le `ProductsByCategory` besoins DropDownList pour afficher uniquement les produits appartenant à la catégorie sélectionnée, que ObjectDataSource appelle le `GetProductsByCategoryID(categoryID)` méthode à partir de la `ProductsBLL` objet.</span><span class="sxs-lookup"><span data-stu-id="0f82d-149">Since the `ProductsByCategory` DropDownList needs to display just those products belonging to the selected category, have the ObjectDataSource invoke the `GetProductsByCategoryID(categoryID)` method from the `ProductsBLL` object.</span></span>


<span data-ttu-id="0f82d-150">[![Choisissez d’utiliser la classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-150">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span></span>

<span data-ttu-id="0f82d-151">**Figure 8**: Choisissez d’utiliser le `ProductsBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-151">**Figure 8**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span></span>


<span data-ttu-id="0f82d-152">[![Configurer pour utiliser la méthode GetProductsByCategoryID(categoryID) ObjectDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-152">[![Configure the ObjectDataSource to Use the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span></span>

<span data-ttu-id="0f82d-153">**Figure 9**: Configurer l’ObjectDataSource à utiliser le `GetProductsByCategoryID(categoryID)` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-153">**Figure 9**: Configure the ObjectDataSource to Use the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span></span>


<span data-ttu-id="0f82d-154">Dans l’étape finale de l’Assistant, nous avons besoin spécifier la valeur de la *`categoryID`* paramètre.</span><span class="sxs-lookup"><span data-stu-id="0f82d-154">In the final step of the wizard we need to specify the value of the *`categoryID`* parameter.</span></span> <span data-ttu-id="0f82d-155">Attribuer ce paramètre à l’élément sélectionné à partir de la `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0f82d-155">Assign this parameter to the selected item from the `Categories` DropDownList.</span></span>


<span data-ttu-id="0f82d-156">[![Extraire la valeur du paramètre categoryID dans la liste de catégories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-156">[![Pull the categoryID Parameter Value from the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span></span>

<span data-ttu-id="0f82d-157">**Figure 10**: Extraire le *`categoryID`* valeur du paramètre à partir de la `Categories` DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-157">**Figure 10**: Pull the *`categoryID`* Parameter Value from the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span></span>


<span data-ttu-id="0f82d-158">Avec ObjectDataSource configuré, tous ne reste qu’à spécifier les champs de source de données sont utilisées pour l’affichage et la valeur des éléments de la liste DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0f82d-158">With the ObjectDataSource configured, all that remains is to specify what data source fields are used for the display and value of the DropDownList's items.</span></span> <span data-ttu-id="0f82d-159">Afficher le `ProductName` champ et utilisez le `ProductID` champ comme valeur.</span><span class="sxs-lookup"><span data-stu-id="0f82d-159">Display the `ProductName` field and use the `ProductID` field as the value.</span></span>


<span data-ttu-id="0f82d-160">[![Spécifiez les champs de Source de données utilisés pour le texte et les propriétés de valeur ListItems de le de la liste DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-160">[![Specify the Data Source Fields Used for the DropDownList's ListItems' Text and Value Properties](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span></span>

<span data-ttu-id="0f82d-161">**Figure 11**: Spécifiez les champs de Source de données utilisée pour la DropDownList `ListItem` s' `Text` et `Value` propriétés ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-161">**Figure 11**: Specify the Data Source Fields Used for the DropDownList's `ListItem` s' `Text` and `Value` Properties ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span></span>


<span data-ttu-id="0f82d-162">Avec ObjectDataSource et `ProductsByCategory` DropDownList configuré notre page affichera deux DropDownList : la première liste toutes les catégories tandis que la deuxième répertorie les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-162">With the ObjectDataSource and `ProductsByCategory` DropDownList configured our page will display two DropDownLists: the first will list all of the categories while the second will list those products belonging to the selected category.</span></span> <span data-ttu-id="0f82d-163">Lorsque l’utilisateur sélectionne une nouvelle catégorie dans la liste DropDownList première, résulte d’une publication (postback) et la deuxième DropDownList est petit, montrant les produits qui appartiennent à la catégorie qui vient d’être sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-163">When the user selects a new category from the first DropDownList, a postback will ensue and the second DropDownList will be rebound, showing those products that belong to the newly selected category.</span></span> <span data-ttu-id="0f82d-164">Figures 12 et 13 show `MasterDetailsDetails.aspx` en action lorsqu’ils sont affichés via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="0f82d-164">Figures 12 and 13 show `MasterDetailsDetails.aspx` in action when viewed through a browser.</span></span>


<span data-ttu-id="0f82d-165">[![Lors de la première visite la Page, la catégorie des boissons est sélectionnée.](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-165">[![When First Visiting the Page, the Beverages Category is Selected](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span></span>

<span data-ttu-id="0f82d-166">**Figure 12**: Lors de la première visite la Page, la catégorie des boissons est sélectionnée ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-166">**Figure 12**: When First Visiting the Page, the Beverages Category is Selected ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span></span>


<span data-ttu-id="0f82d-167">[![Choix d’une autre catégorie affiche produits de la nouvelle catégorie](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-167">[![Choosing a Different Category Displays the New Category's Products](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span></span>

<span data-ttu-id="0f82d-168">**Figure 13**: Choix d’un autre catégorie s’affiche produits de la nouvelle catégorie ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-168">**Figure 13**: Choosing a Different Category Displays the New Category's Products ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span></span>


<span data-ttu-id="0f82d-169">Actuellement le `productsByCategory` DropDownList, en cas de modification, est *pas* provoquer une publication (postback).</span><span class="sxs-lookup"><span data-stu-id="0f82d-169">Currently the `productsByCategory` DropDownList, when changed, does *not* cause a postback.</span></span> <span data-ttu-id="0f82d-170">Toutefois, nous allons une publication (postback) se produit une fois que nous avons ajouté un contrôle DetailsView pour afficher les détails du produit sélectionné (étape 3).</span><span class="sxs-lookup"><span data-stu-id="0f82d-170">However, we will want a postback to occur once we add a DetailsView to display the selected product's details (Step 3).</span></span> <span data-ttu-id="0f82d-171">Par conséquent, cochez la case à cocher Activer AutoPostBack à partir de la `productsByCategory` balise active de DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0f82d-171">Therefore, check the Enable AutoPostBack checkbox from the `productsByCategory` DropDownList's smart tag.</span></span>


<span data-ttu-id="0f82d-172">[![Activer la fonctionnalité de AutoPostBack pour le productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-172">[![Enable the AutoPostBack Feature for the productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span></span>

<span data-ttu-id="0f82d-173">**Figure 14**: Activer la fonctionnalité AutoPostBack pour le `productsByCategory` DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-173">**Figure 14**: Enable the AutoPostBack Feature for the `productsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span></span>


## <a name="step-3-using-a-detailsview-to-display-details-for-the-selected-product"></a><span data-ttu-id="0f82d-174">Étape 3 : À l’aide d’un contrôle DetailsView pour afficher les détails pour le produit sélectionné</span><span class="sxs-lookup"><span data-stu-id="0f82d-174">Step 3: Using a DetailsView to Display Details for the Selected Product</span></span>

<span data-ttu-id="0f82d-175">L’étape finale consiste à afficher les détails pour le produit sélectionné dans un contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0f82d-175">The final step is to display the details for the selected product in a DetailsView.</span></span> <span data-ttu-id="0f82d-176">Pour ce faire, ajoutez un contrôle DetailsView à la page, définissez son `ID` propriété `ProductDetails`et créer un nouveau ObjectDataSource pour celui-ci.</span><span class="sxs-lookup"><span data-stu-id="0f82d-176">To accomplish this, add a DetailsView to the page, set its `ID` property to `ProductDetails`, and create a new ObjectDataSource for it.</span></span> <span data-ttu-id="0f82d-177">Configurer cette ObjectDataSource afin d’extraire ses données à partir de la `ProductsBLL` la classe `GetProductByProductID(productID)` méthode à l’aide de la valeur sélectionnée de la `ProductsByCategory` DropDownList pour la valeur de la *`productID`* paramètre.</span><span class="sxs-lookup"><span data-stu-id="0f82d-177">Configure this ObjectDataSource to pull its data from the `ProductsBLL` class's `GetProductByProductID(productID)` method using the selected value of the `ProductsByCategory` DropDownList for the value of the *`productID`* parameter.</span></span>


<span data-ttu-id="0f82d-178">[![Choisissez d’utiliser la classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-178">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span></span>

<span data-ttu-id="0f82d-179">**Figure 15**: Choisissez d’utiliser le `ProductsBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-179">**Figure 15**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span></span>


<span data-ttu-id="0f82d-180">[![Configurer pour utiliser la méthode GetProductByProductID(productID) ObjectDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-180">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span></span>

<span data-ttu-id="0f82d-181">**Figure 16**: Configurer l’ObjectDataSource à utiliser le `GetProductByProductID(productID)` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-181">**Figure 16**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span></span>


<span data-ttu-id="0f82d-182">[![Extrayez la valeur du paramètre productID ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-182">[![Pull the productID Parameter Value from the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span></span>

<span data-ttu-id="0f82d-183">**Figure 17**: Extraire le *`productID`* valeur du paramètre à partir de la `ProductsByCategory` DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-183">**Figure 17**: Pull the *`productID`* Parameter Value from the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span></span>


<span data-ttu-id="0f82d-184">Vous pouvez choisir d’afficher tous les champs disponibles dans le `ProductDetails` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0f82d-184">You can choose to display any of the available fields in the `ProductDetails` DetailsView.</span></span> <span data-ttu-id="0f82d-185">J’ai choisi de supprimer le `ProductID`, `SupplierID`, et `CategoryID` champs et réorganisés et mis en forme les champs restants.</span><span class="sxs-lookup"><span data-stu-id="0f82d-185">I've opted to remove the `ProductID`, `SupplierID`, and `CategoryID` fields and reordered and formatted the remaining fields.</span></span> <span data-ttu-id="0f82d-186">En outre, j’ai effacés de DetailsView `Height` et `Width` propriétés, ce qui permet le contrôle DetailsView d’étendre à la largeur nécessaire pour obtenir un affichage optimal ses données au lieu il limité à une taille spécifiée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-186">In addition, I cleared out the DetailsView's `Height` and `Width` properties, allowing the DetailsView to expand to the width needed to best display its data rather than having it constrained to a specified size.</span></span> <span data-ttu-id="0f82d-187">Le balisage complet est affichée ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="0f82d-187">The full markup appears below:</span></span>


[!code-aspx[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample1.aspx)]

<span data-ttu-id="0f82d-188">Prenez un moment pour essayer la `MasterDetailsDetails.aspx` page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="0f82d-188">Take a moment to try out the `MasterDetailsDetails.aspx` page in a browser.</span></span> <span data-ttu-id="0f82d-189">À première vue, il peut sembler que tout fonctionne comme vous le souhaitez, mais il existe un problème subtil.</span><span class="sxs-lookup"><span data-stu-id="0f82d-189">At first glance it may appear that everything is working as desired, but there's a subtle problem.</span></span> <span data-ttu-id="0f82d-190">Lorsque vous choisissez une nouvelle catégorie la `ProductsByCategory` DropDownList est mis à jour pour inclure ces produits pour la catégorie sélectionnée, mais la `ProductDetails` DetailsView a continué à afficher les informations de produit précédentes.</span><span class="sxs-lookup"><span data-stu-id="0f82d-190">When you choose a new category the `ProductsByCategory` DropDownList is updated to include those products for the selected category, but the `ProductDetails` DetailsView continued to show the previous product information.</span></span> <span data-ttu-id="0f82d-191">Le contrôle DetailsView est mis à jour lors du choix d’un autre produit de la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-191">The DetailsView is updated when choosing a different product for the selected category.</span></span> <span data-ttu-id="0f82d-192">En outre, si vous testez minutieusement suffisamment, vous découvrirez que si vous choisissez en permanence de nouvelles catégories (tel que le choix des boissons à partir de la `Categories` DropDownList, puis les Condiments, confiseries puis) chaque autre sélection de catégorie provoque le `ProductDetails`Contrôle DetailsView afin d’être actualisé.</span><span class="sxs-lookup"><span data-stu-id="0f82d-192">Furthermore, if you test thoroughly enough, you'll find that if you continually choose new categories (such as choosing Beverages from the `Categories` DropDownList, then Condiments, then Confections) every other category selection causes the `ProductDetails` DetailsView to be refreshed.</span></span>

<span data-ttu-id="0f82d-193">Pour aider à concrétiser la ce problème, nous allons étudier un exemple spécifique.</span><span class="sxs-lookup"><span data-stu-id="0f82d-193">To help concretize this problem, let's look at a specific example.</span></span> <span data-ttu-id="0f82d-194">Lorsque vous visitez tout d’abord la page de la catégorie boissons est sélectionnée et les produits connexes sont chargés dans le `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0f82d-194">When you first visit the page the Beverages category is selected and the related products are loaded in the `ProductsByCategory` DropDownList.</span></span> <span data-ttu-id="0f82d-195">Tran est le produit sélectionné et ses détails sont affichent dans le `ProductDetails` DetailsView, comme illustré dans la Figure 18.</span><span class="sxs-lookup"><span data-stu-id="0f82d-195">Chai is the selected product and its details are displayed in the `ProductDetails` DetailsView, as shown in Figure 18.</span></span>


<span data-ttu-id="0f82d-196">[![Détails du produit sélectionné sont affichés dans un contrôle DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-196">[![The Selected Product's Details are Displayed in a DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span></span>

<span data-ttu-id="0f82d-197">**Figure 18**: Détails du produit sélectionné sont affichés dans un contrôle DetailsView ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-197">**Figure 18**: The Selected Product's Details are Displayed in a DetailsView ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span></span>


<span data-ttu-id="0f82d-198">Si vous modifiez la sélection de catégories à partir de boissons pour les Condiments, une publication (postback) et le `ProductsByCategory` DropDownList est mis à jour en conséquence, mais le contrôle DetailsView affiche toujours les détails de Tran.</span><span class="sxs-lookup"><span data-stu-id="0f82d-198">If you change the category selection from Beverages to Condiments, a postback occurs and the `ProductsByCategory` DropDownList is updated accordingly, but the DetailsView still displays details for Chai.</span></span>


<span data-ttu-id="0f82d-199">[![Le détails du produit sélectionné précédemment sont toujours affichées](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-199">[![The Previously Selected Product's Details are Still Displayed](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span></span>

<span data-ttu-id="0f82d-200">**Figure 19**: Le détails du produit sélectionné précédemment sont toujours affichées ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-200">**Figure 19**: The Previously Selected Product's Details are Still Displayed ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span></span>


<span data-ttu-id="0f82d-201">Sélection d’un nouveau produit dans la liste d’actualise le contrôle DetailsView comme prévu.</span><span class="sxs-lookup"><span data-stu-id="0f82d-201">Picking a new product from the list refreshes the DetailsView as expected.</span></span> <span data-ttu-id="0f82d-202">Si vous sélectionnez une nouvelle catégorie après avoir modifié le produit, le contrôle DetailsView n’actualisez à nouveau.</span><span class="sxs-lookup"><span data-stu-id="0f82d-202">If you pick a new category after changing the product, the DetailsView again won't refresh.</span></span> <span data-ttu-id="0f82d-203">Toutefois, si au lieu de choisir un nouveau produit, vous avez sélectionné une nouvelle catégorie, le contrôle DetailsView voulez-vous actualiser.</span><span class="sxs-lookup"><span data-stu-id="0f82d-203">However, if instead of choosing a new product you selected a new category, the DetailsView would refresh.</span></span> <span data-ttu-id="0f82d-204">Dans le monde est passe-t-il ici ?</span><span class="sxs-lookup"><span data-stu-id="0f82d-204">What in the world is going on here?</span></span>

<span data-ttu-id="0f82d-205">Le problème est un problème de synchronisation dans le cycle de vie de la page.</span><span class="sxs-lookup"><span data-stu-id="0f82d-205">The problem is a timing issue in the page's lifecycle.</span></span> <span data-ttu-id="0f82d-206">Chaque fois qu’une page est demandée qu'elle se poursuit dans un nombre d’étapes en tant que son rendu.</span><span class="sxs-lookup"><span data-stu-id="0f82d-206">Whenever a page is requested it proceeds through a number of steps as its rendering.</span></span> <span data-ttu-id="0f82d-207">Dans une de ces étapes ObjectDataSource contrôle vérifie si un de leurs `SelectParameters` valeurs ont changé.</span><span class="sxs-lookup"><span data-stu-id="0f82d-207">In one of these steps the ObjectDataSource controls check to see if any of their `SelectParameters` values have changed.</span></span> <span data-ttu-id="0f82d-208">Si, par conséquent, le contrôle Web de données lié à ObjectDataSource sait qu’il doit actualiser son affichage.</span><span class="sxs-lookup"><span data-stu-id="0f82d-208">If so, the data Web control bound to the ObjectDataSource knows that it needs to refresh its display.</span></span> <span data-ttu-id="0f82d-209">Par exemple, quand une nouvelle catégorie est sélectionnée, le `ProductsByCategoryDataSource` ObjectDataSource détecte que ses valeurs de paramètre ont été modifiés et le `ProductsByCategory` DropDownList lui-même, relie les produits pour la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-209">For example, when a new category is selected, the `ProductsByCategoryDataSource` ObjectDataSource detects that its parameter values have changed and the `ProductsByCategory` DropDownList rebinds itself, getting the products for the selected category.</span></span>

<span data-ttu-id="0f82d-210">Le problème qui survient dans cette situation est que le point dans le cycle de vie de page les ObjectDataSources vérifier les paramètres modifiés se produit *avant* le rétablissement de la liaison des données associées des contrôles Web.</span><span class="sxs-lookup"><span data-stu-id="0f82d-210">The problem that arises in this situation is that the point in the page lifecycle that the ObjectDataSources check for changed parameters occurs *before* the rebinding of the associated data Web controls.</span></span> <span data-ttu-id="0f82d-211">Par conséquent, lorsque vous sélectionnez une nouvelle catégorie la `ProductsByCategoryDataSource` ObjectDataSource détecte une modification de sa valeur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="0f82d-211">Therefore, when selecting a new category the `ProductsByCategoryDataSource` ObjectDataSource detects a change in its parameter's value.</span></span> <span data-ttu-id="0f82d-212">ObjectDataSource utilisé par le `ProductDetails` DetailsView, toutefois, ne notez les modifications requises, car le `ProductsByCategory` DropDownList doit être reliée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-212">The ObjectDataSource used by the `ProductDetails` DetailsView, however, doesn't note any such changes because the `ProductsByCategory` DropDownList has yet to be rebound.</span></span> <span data-ttu-id="0f82d-213">Plus loin dans le cycle de vie du `ProductsByCategory` DropDownList relie à son ObjectDataSource, en saisissant les produits pour la catégorie qui vient d’être sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-213">Later in the lifecycle the `ProductsByCategory` DropDownList rebinds to its ObjectDataSource, grabbing the products for the newly selected category.</span></span> <span data-ttu-id="0f82d-214">Bien que le `ProductsByCategory` les valeur de DropDownList a changé, le `ProductDetails` ObjectDataSource de DetailsView a déjà effectué son contrôle de valeur de paramètre ; par conséquent, le contrôle DetailsView affiche ses résultats précédents.</span><span class="sxs-lookup"><span data-stu-id="0f82d-214">While the `ProductsByCategory` DropDownList's value has changed, the `ProductDetails` DetailsView's ObjectDataSource has already done its parameter value check; therefore, the DetailsView displays its previous results.</span></span> <span data-ttu-id="0f82d-215">Cette interaction est représentée dans la Figure 20.</span><span class="sxs-lookup"><span data-stu-id="0f82d-215">This interaction is depicted in Figure 20.</span></span>


<span data-ttu-id="0f82d-216">[![La valeur de DropDownList de ProductsByCategory modifiée après que ObjectDataSource du ProductDetails DetailsView vérifie les modifications](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-216">[![The ProductsByCategory DropDownList Value Changes After the ProductDetails DetailsView's ObjectDataSource Checks for Changes](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span></span>

<span data-ttu-id="0f82d-217">**Figure 20**: Le `ProductsByCategory` DropDownList des modifications de valeur après la `ProductDetails` ObjectDataSource vérifie de DetailsView les modifications ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-217">**Figure 20**: The `ProductsByCategory` DropDownList Value Changes After the `ProductDetails` DetailsView's ObjectDataSource Checks for Changes ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span></span>


<span data-ttu-id="0f82d-218">Pour remédier à cela nous devons relier explicitement les `ProductDetails` DetailsView après le `ProductsByCategory` DropDownList a été liée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-218">To remedy this we need to explicitly rebind the `ProductDetails` DetailsView after the `ProductsByCategory` DropDownList has been bound.</span></span> <span data-ttu-id="0f82d-219">Nous pouvons effectuer cette opération en appelant le `ProductDetails` de DetailsView `DataBind()` méthode lorsque le `ProductsByCategory` de DropDownList `DataBound` se déclenche des événements.</span><span class="sxs-lookup"><span data-stu-id="0f82d-219">We can accomplish this by calling the `ProductDetails` DetailsView's `DataBind()` method when the `ProductsByCategory` DropDownList's `DataBound` event fires.</span></span> <span data-ttu-id="0f82d-220">Ajouter le code de gestionnaire d’événements suivant à la `MasterDetailsDetails.aspx` classe code-behind de la page (reportez-vous à la «[définition par programmation les valeurs des paramètres de l’ObjectDataSource](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)» pour une discussion sur l’ajout d’un gestionnaire d’événements) :</span><span class="sxs-lookup"><span data-stu-id="0f82d-220">Add the following event handler code to the `MasterDetailsDetails.aspx` page's code-behind class (refer to the "[Programmatically Setting the ObjectDataSource's Parameter Values](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" for a discussion on how to add an event handler):</span></span>


[!code-vb[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample2.vb)]

<span data-ttu-id="0f82d-221">Après cet appel explicit à la `ProductDetails` de DetailsView `DataBind()` méthode a été ajoutée, le didacticiel fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="0f82d-221">After this explicit call to the `ProductDetails` DetailsView's `DataBind()` method has been added, the tutorial works as expected.</span></span> <span data-ttu-id="0f82d-222">Points importants figure 21 comment cela modifié remédié à notre problème antérieures.</span><span class="sxs-lookup"><span data-stu-id="0f82d-222">Figure 21 highlights how this changed remedied our earlier problem.</span></span>


<span data-ttu-id="0f82d-223">[![ProductDetails DetailsView est DataBound événement est déclenché d’explicitement actualisée lorsque le ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="0f82d-223">[![The ProductDetails DetailsView is Explicitly Refreshed When the ProductsByCategory DropDownList's DataBound Event Fires](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span></span>

<span data-ttu-id="0f82d-224">**Figure 21**: Le `ProductDetails` DetailsView est explicitement actualisée lorsque le `ProductsByCategory` de DropDownList `DataBound` se déclenche des événements ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="0f82d-224">**Figure 21**: The `ProductDetails` DetailsView is Explicitly Refreshed When the `ProductsByCategory` DropDownList's `DataBound` Event Fires ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span></span>


## <a name="summary"></a><span data-ttu-id="0f82d-225">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="0f82d-225">Summary</span></span>

<span data-ttu-id="0f82d-226">Le DropDownList constitue un élément d’interface utilisateur idéal pour les rapports maître/détail s’il existe une relation un-à-plusieurs entre les enregistrements maître et détail.</span><span class="sxs-lookup"><span data-stu-id="0f82d-226">The DropDownList serves as an ideal user interface element for master/detail reports where there is a one-to-many relationship between the master and detail records.</span></span> <span data-ttu-id="0f82d-227">Dans le didacticiel précédent, nous avons vu comment utiliser un DropDownList unique pour filtrer les produits affichés par la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="0f82d-227">In the preceding tutorial we saw how to use a single DropDownList to filter the products displayed by the selected category.</span></span> <span data-ttu-id="0f82d-228">Dans ce didacticiel, nous remplacé le GridView de produits avec une DropDownList et un contrôle DetailsView permet d’afficher les détails du produit sélectionné.</span><span class="sxs-lookup"><span data-stu-id="0f82d-228">In this tutorial we replaced the GridView of products with a DropDownList, and used a DetailsView to display the details of the selected product.</span></span> <span data-ttu-id="0f82d-229">Les concepts abordés dans ce didacticiel peuvent facilement être étendus aux modèles de données impliquant plusieurs relations un-à-plusieurs, telles que les clients, commandes et éléments de commande.</span><span class="sxs-lookup"><span data-stu-id="0f82d-229">The concepts discussed in this tutorial can easily be extended to data models involving multiple one-to-many relationships, such as customers, orders, and order items.</span></span> <span data-ttu-id="0f82d-230">En règle générale, vous pouvez toujours ajouter un contrôle DropDownList pour chacune des entités « un » dans les relations un-à-plusieurs.</span><span class="sxs-lookup"><span data-stu-id="0f82d-230">In general, you can always add a DropDownList for each of the "one" entities in the one-to-many relationships.</span></span>

<span data-ttu-id="0f82d-231">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="0f82d-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0f82d-232">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="0f82d-232">About the Author</span></span>

<span data-ttu-id="0f82d-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="0f82d-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0f82d-234">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="0f82d-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0f82d-235">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0f82d-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0f82d-236">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0f82d-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0f82d-237">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0f82d-237">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0f82d-238">Remerciements</span><span class="sxs-lookup"><span data-stu-id="0f82d-238">Special Thanks To</span></span>

<span data-ttu-id="0f82d-239">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="0f82d-239">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0f82d-240">Entraîner un réviseur pour ce didacticiel a été Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="0f82d-240">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="0f82d-241">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="0f82d-241">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0f82d-242">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0f82d-242">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0f82d-243">[Précédent](master-detail-filtering-with-a-dropdownlist-vb.md)
> [Suivant](master-detail-filtering-across-two-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0f82d-243">[Previous](master-detail-filtering-with-a-dropdownlist-vb.md)
[Next](master-detail-filtering-across-two-pages-vb.md)</span></span>
