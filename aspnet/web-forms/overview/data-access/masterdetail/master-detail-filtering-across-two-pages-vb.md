---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
title: Filtrage maître/détail sur deux pages (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons implémenter ce modèle à l’aide d’un GridView pour répertorier les fournisseurs dans la base de données. Chaque ligne de fournisseur dans le contrôle GridView contient une vie...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 361d6a44-3f1f-4daf-85df-d4c2b8bf065d
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 0e30d47a565c3b6cb9f647d54d47c10a418762f4
ms.sourcegitcommit: 4e6d586faadbe4d9ef27122f86335ec9385134af
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/28/2020
ms.locfileid: "89044972"
---
# <a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="006b0-104">Filtrage maître/détail sur deux pages (VB)</span><span class="sxs-lookup"><span data-stu-id="006b0-104">Master/Detail Filtering Across Two Pages (VB)</span></span>

<span data-ttu-id="006b0-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="006b0-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="006b0-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) ou [Télécharger le PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="006b0-106">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) or [Download PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span></span>

> <span data-ttu-id="006b0-107">Dans ce didacticiel, nous allons implémenter ce modèle à l’aide d’un GridView pour répertorier les fournisseurs dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="006b0-107">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="006b0-108">Chaque ligne de fournisseur dans le contrôle GridView contient un lien Afficher les produits qui, lorsque vous cliquez dessus, permet à l’utilisateur d’accéder à une page distincte qui répertorie les produits pour le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="006b0-108">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="introduction"></a><span data-ttu-id="006b0-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="006b0-109">Introduction</span></span>

<span data-ttu-id="006b0-110">Dans les deux didacticiels précédents, nous avons vu comment afficher des rapports maître/détail dans une page Web unique à l’aide de DropDownList pour afficher les enregistrements « maîtres » et un contrôle [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) ou [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) pour afficher les détails.</span><span class="sxs-lookup"><span data-stu-id="006b0-110">In the previous two tutorials we saw how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) or [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) control to display the "details."</span></span> <span data-ttu-id="006b0-111">Un autre modèle courant utilisé pour les rapports maître/détails consiste à avoir les enregistrements maîtres sur une page Web et les détails affichés sur un autre.</span><span class="sxs-lookup"><span data-stu-id="006b0-111">Another common pattern used for master/details reports is to have the master records on one web page and the details shown on another.</span></span> <span data-ttu-id="006b0-112">Un site Web de forum, comme [les Forums ASP.net](https://forums.asp.net/), est un excellent exemple de ce modèle dans la pratique.</span><span class="sxs-lookup"><span data-stu-id="006b0-112">A forum website, like [the ASP.NET Forums](https://forums.asp.net/), is a great example of this pattern in practice.</span></span> <span data-ttu-id="006b0-113">Les Forums ASP.NET sont composés de différents forums Prise en main, Web Forms, des contrôles de présentation des données, etc.</span><span class="sxs-lookup"><span data-stu-id="006b0-113">The ASP.NET Forums are composed of a variety of forums Getting Started, Web Forms, Data Presentation Controls, and so on.</span></span> <span data-ttu-id="006b0-114">Chaque forum est composé de nombreux threads et chaque thread se compose d’un certain nombre de publications.</span><span class="sxs-lookup"><span data-stu-id="006b0-114">Each forum is composed of many threads and each thread is composed of a number of posts.</span></span> <span data-ttu-id="006b0-115">Sur la page d’accueil des forums ASP.NET, les forums sont répertoriés.</span><span class="sxs-lookup"><span data-stu-id="006b0-115">On the ASP.NET Forums homepage, the forums are listed.</span></span> <span data-ttu-id="006b0-116">Cliquer sur un forum vous `ShowForum.aspx` donne une page qui répertorie les threads de ce forum.</span><span class="sxs-lookup"><span data-stu-id="006b0-116">Clicking on a forum whisks you to a `ShowForum.aspx` page, which lists the threads for that forum.</span></span> <span data-ttu-id="006b0-117">De même, le fait de cliquer sur un thread vous amène à `ShowPost.aspx` , qui affiche les publications du thread sur lequel l’utilisateur a cliqué.</span><span class="sxs-lookup"><span data-stu-id="006b0-117">Likewise, clicking on a thread takes you to `ShowPost.aspx`, which displays the posts for the thread that was clicked.</span></span>

<span data-ttu-id="006b0-118">Dans ce didacticiel, nous allons implémenter ce modèle à l’aide d’un GridView pour répertorier les fournisseurs dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="006b0-118">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="006b0-119">Chaque ligne de fournisseur dans le contrôle GridView contient un lien Afficher les produits qui, lorsque vous cliquez dessus, permet à l’utilisateur d’accéder à une page distincte qui répertorie les produits pour le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="006b0-119">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="step-1-addingsupplierlistmasteraspxandproductsforsupplierdetailsaspxpages-to-thefilteringfolder"></a><span data-ttu-id="006b0-120">Étape 1 : ajout `SupplierListMaster.aspx` des `ProductsForSupplierDetails.aspx` pages et au `Filtering` dossier</span><span class="sxs-lookup"><span data-stu-id="006b0-120">Step 1: Adding`SupplierListMaster.aspx`and`ProductsForSupplierDetails.aspx`Pages to the`Filtering`Folder</span></span>

<span data-ttu-id="006b0-121">Lors de la définition de la mise en page dans le troisième didacticiel, nous avons ajouté plusieurs pages « Starter » dans les `BasicReporting` `Filtering` dossiers, et `CustomFormatting` .</span><span class="sxs-lookup"><span data-stu-id="006b0-121">When defining the page layout in the third tutorial we added a number of "starter" pages in the `BasicReporting`, `Filtering`, and `CustomFormatting` folders.</span></span> <span data-ttu-id="006b0-122">Toutefois, nous n’avons pas ajouté de page de démarrage pour ce didacticiel à ce moment-là, prenez un moment pour ajouter deux nouvelles pages au `Filtering` dossier : `SupplierListMaster.aspx` et `ProductsForSupplierDetails.aspx` .</span><span class="sxs-lookup"><span data-stu-id="006b0-122">However, we did not add a starter page for this tutorial at that time, so take a moment to add two new pages to the `Filtering` folder: `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx`.</span></span> <span data-ttu-id="006b0-123">`SupplierListMaster.aspx` répertorie les enregistrements « principaux » (fournisseurs) tout en `ProductsForSupplierDetails.aspx` affichant les produits du fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="006b0-123">`SupplierListMaster.aspx` will list the "master" records (the suppliers) while `ProductsForSupplierDetails.aspx` will display the products for the selected supplier.</span></span>

<span data-ttu-id="006b0-124">Lorsque vous créez ces deux nouvelles pages, veillez à les associer à la `Site.master` page maître.</span><span class="sxs-lookup"><span data-stu-id="006b0-124">When creating these two new pages be certain to associate them with the `Site.master` master page.</span></span>

![Ajouter les pages SupplierListMaster. aspx et ProductsForSupplierDetails. aspx au dossier de filtrage](master-detail-filtering-across-two-pages-vb/_static/image1.png)

<span data-ttu-id="006b0-126">**Figure 1**: ajouter les `SupplierListMaster.aspx` `ProductsForSupplierDetails.aspx` pages et au `Filtering` dossier</span><span class="sxs-lookup"><span data-stu-id="006b0-126">**Figure 1**: Add the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` Pages to the `Filtering` Folder</span></span>

<span data-ttu-id="006b0-127">En outre, lors de l’ajout de nouvelles pages au projet, veillez à mettre à jour le fichier de plan de site, `Web.sitemap` , en conséquence.</span><span class="sxs-lookup"><span data-stu-id="006b0-127">Also, when adding new pages to the project, be sure to update the site map file, `Web.sitemap`, accordingly.</span></span> <span data-ttu-id="006b0-128">Pour ce didacticiel, il vous suffit d’ajouter la `SupplierListMaster.aspx` page à la carte de site en utilisant le contenu XML suivant comme enfant de l’élément de filtrage des rapports `<siteMapNode>` :</span><span class="sxs-lookup"><span data-stu-id="006b0-128">For this tutorial simply add the `SupplierListMaster.aspx` page to the site map using the following XML content as a child of the Filtering Reports `<siteMapNode>` element:</span></span>

[!code-xml[Main](master-detail-filtering-across-two-pages-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="006b0-129">Vous pouvez aider à automatiser le processus de mise à jour du fichier de plan de site lors de l’ajout de nouvelles pages ASP.NET à l’aide de la [macro plan de site](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx)Visual Studio gratuite de [K. Scott Allen](http://odetocode.com/Blogs/scott/).</span><span class="sxs-lookup"><span data-stu-id="006b0-129">You can help automate the process of updating the site map file when adding new ASP.NET pages using [K. Scott Allen](http://odetocode.com/Blogs/scott/)'s free Visual Studio [Site Map Macro](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span></span>

## <a name="step-2-displaying-the-supplier-list-insupplierlistmasteraspx"></a><span data-ttu-id="006b0-130">Étape 2 : affichage de la liste des fournisseurs dans`SupplierListMaster.aspx`</span><span class="sxs-lookup"><span data-stu-id="006b0-130">Step 2: Displaying the Supplier List in`SupplierListMaster.aspx`</span></span>

<span data-ttu-id="006b0-131">Avec les `SupplierListMaster.aspx` `ProductsForSupplierDetails.aspx` pages et créées, l’étape suivante consiste à créer le contrôle GridView des fournisseurs dans `SupplierListMaster.aspx` .</span><span class="sxs-lookup"><span data-stu-id="006b0-131">With the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` pages created, our next step is to create the GridView of suppliers in `SupplierListMaster.aspx`.</span></span> <span data-ttu-id="006b0-132">Ajoutez un GridView à la page et liez-le à un nouvel ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="006b0-132">Add a GridView to the page and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="006b0-133">Cet ObjectDataSource doit utiliser la `SuppliersBLL` méthode de la classe `GetSuppliers()` pour retourner tous les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="006b0-133">This ObjectDataSource should use the `SuppliersBLL` class's `GetSuppliers()` method to return all suppliers.</span></span>

<span data-ttu-id="006b0-134">[![Sélectionnez la classe SuppliersBLL](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-134">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="006b0-135">**Figure 2**: sélectionner la `SuppliersBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-135">**Figure 2**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span></span>

<span data-ttu-id="006b0-136">[![Configurer ObjectDataSource pour utiliser la méthode GetSuppliers ()](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-136">[![Configure the ObjectDataSource to Use the GetSuppliers() Method](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="006b0-137">**Figure 3**: configurer ObjectDataSource pour utiliser la `GetSuppliers()` méthode ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-137">**Figure 3**: Configure the ObjectDataSource to Use the `GetSuppliers()` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="006b0-138">Nous devons inclure un lien intitulé Products View dans chaque ligne GridView qui, lorsque vous cliquez dessus, amène l’utilisateur à `ProductsForSupplierDetails.aspx` passer la valeur de la ligne sélectionnée `SupplierID` via la chaîne de chaîne.</span><span class="sxs-lookup"><span data-stu-id="006b0-138">We need to include a link titled View Products in each GridView row that, when clicked, takes the user to `ProductsForSupplierDetails.aspx` passing in the selected row's `SupplierID` value through the querystring.</span></span> <span data-ttu-id="006b0-139">Par exemple, si l’utilisateur clique sur le lien Afficher les produits pour le fournisseur Tokyo Traders (qui a une `SupplierID` valeur de 4), il doit être envoyé à `ProductsForSupplierDetails.aspx?SupplierID=4` .</span><span class="sxs-lookup"><span data-stu-id="006b0-139">For example, if user clicks on the View Products link for the Tokyo Traders supplier (which has a `SupplierID` value of 4), they should be sent to `ProductsForSupplierDetails.aspx?SupplierID=4`.</span></span>

<span data-ttu-id="006b0-140">Pour ce faire, ajoutez un [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) au GridView, qui ajoute un lien hypertexte à chaque ligne GridView.</span><span class="sxs-lookup"><span data-stu-id="006b0-140">To accomplish this, add a [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) to the GridView, which adds a hyperlink to each GridView row.</span></span> <span data-ttu-id="006b0-141">Commencez par cliquer sur le lien modifier les colonnes à partir de la balise active de GridView.</span><span class="sxs-lookup"><span data-stu-id="006b0-141">Start by clicking the Edit Columns link from the GridView's smart tag.</span></span> <span data-ttu-id="006b0-142">Ensuite, sélectionnez le HyperLinkField dans la liste en haut à gauche, puis cliquez sur Ajouter pour inclure le HyperLinkField dans la liste de champs du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="006b0-142">Next, select the HyperLinkField from the list in the upper left and click Add to include the HyperLinkField in the GridView's field list.</span></span>

<span data-ttu-id="006b0-143">[![Ajouter un HyperLinkField au GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-143">[![Add a HyperLinkField to the GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="006b0-144">**Figure 4**: ajouter un HyperLinkField à GridView ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-144">**Figure 4**: Add a HyperLinkField to the GridView ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span></span>

<span data-ttu-id="006b0-145">Le HyperLinkField peut être configuré pour utiliser les mêmes valeurs de texte ou d’URL que le lien dans chaque ligne GridView, ou peut baser ces valeurs sur les valeurs de données liées à chaque ligne particulière.</span><span class="sxs-lookup"><span data-stu-id="006b0-145">The HyperLinkField can be configured to use the same text or URL values the link in each GridView row, or can base these values on the data values bound to each particular row.</span></span> <span data-ttu-id="006b0-146">Pour spécifier une valeur statique sur toutes les lignes, utilisez les `Text` Propriétés ou du HyperLinkField `NavigateUrl` .</span><span class="sxs-lookup"><span data-stu-id="006b0-146">To specify a static value across all rows use the HyperLinkField's `Text` or `NavigateUrl` properties.</span></span> <span data-ttu-id="006b0-147">Étant donné que nous voulons que le texte du lien soit le même pour toutes les lignes, définissez la propriété de HyperLinkField `Text` sur Afficher les produits.</span><span class="sxs-lookup"><span data-stu-id="006b0-147">Since we want the link text to be the same for all rows, set the HyperLinkField's `Text` property to View Products.</span></span>

<span data-ttu-id="006b0-148">[![Définir la propriété Text de HyperLinkField pour afficher les produits](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-148">[![Set the HyperLinkField's Text Property to View Products](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="006b0-149">**Figure 5**: définir la propriété de HyperLinkField `Text` pour afficher les produits ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-149">**Figure 5**: Set the HyperLinkField's `Text` Property to View Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span></span>

<span data-ttu-id="006b0-150">Pour définir les valeurs de texte ou d’URL en fonction des données sous-jacentes liées à la ligne GridView, spécifiez les champs de données à partir desquels les valeurs de texte ou d’URL doivent être extraites dans les `DataTextField` `DataNavigateUrlFields` Propriétés ou.</span><span class="sxs-lookup"><span data-stu-id="006b0-150">To set the text or URL values to be based on the underlying data bound to the GridView row, specify the data fields the text or URL values should be pulled from in the `DataTextField` or `DataNavigateUrlFields` properties.</span></span> <span data-ttu-id="006b0-151">`DataTextField` peut uniquement être défini sur un champ de données unique ; `DataNavigateUrlFields`Toutefois, peut être défini sur une liste de champs de données délimités par des virgules.</span><span class="sxs-lookup"><span data-stu-id="006b0-151">`DataTextField` can only be set to a single data field; `DataNavigateUrlFields`, however, can be set to a comma-delimited list of data fields.</span></span> <span data-ttu-id="006b0-152">Nous devons souvent baser le texte ou l’URL sur une combinaison de la valeur du champ de données de la ligne actuelle et d’un balisage statique.</span><span class="sxs-lookup"><span data-stu-id="006b0-152">We frequently need to base the text or URL on a combination of the current row's data field value and some static markup.</span></span> <span data-ttu-id="006b0-153">Dans ce didacticiel, par exemple, nous voulons que l’URL des liens de HyperLinkField soit `ProductsForSupplierDetails.aspx?SupplierID=supplierID` , où correspond à la *`supplierID`* valeur row’s de chaque GridView `SupplierID` .</span><span class="sxs-lookup"><span data-stu-id="006b0-153">In this tutorial, for example, we want the URL of the HyperLinkField's links to be `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, where *`supplierID`* is each GridView's row's `SupplierID` value.</span></span> <span data-ttu-id="006b0-154">Notez que nous avons besoin des valeurs statiques et pilotées par les données ici : la `ProductsForSupplierDetails.aspx?SupplierID=` partie de l’URL du lien est statique, tandis que la *`supplierID`* partie est pilotée par les données, car sa valeur correspond à la propre valeur de chaque ligne `SupplierID` .</span><span class="sxs-lookup"><span data-stu-id="006b0-154">Notice that we need both static and data-driven values here: the `ProductsForSupplierDetails.aspx?SupplierID=` portion of the link's URL is static, whereas the *`supplierID`* portion is data-driven as its value is each row's own `SupplierID` value.</span></span>

<span data-ttu-id="006b0-155">Pour indiquer une combinaison de valeurs statiques et pilotées par les données, utilisez les `DataTextFormatString` `DataNavigateUrlFormatString` Propriétés et.</span><span class="sxs-lookup"><span data-stu-id="006b0-155">To indicate a combination of static and data-driven values, use the `DataTextFormatString` and `DataNavigateUrlFormatString` properties.</span></span> <span data-ttu-id="006b0-156">Dans ces propriétés, entrez le balisage statique si nécessaire, puis utilisez le marqueur `{0}` dans lequel vous voulez que la valeur du champ spécifié dans les `DataTextField` `DataNavigateUrlFields` Propriétés ou apparaisse.</span><span class="sxs-lookup"><span data-stu-id="006b0-156">In these properties enter the static markup as needed and then use the marker `{0}` where you want the value of the field specified in the `DataTextField` or `DataNavigateUrlFields` properties to appear.</span></span> <span data-ttu-id="006b0-157">Si `DataNavigateUrlFields` plusieurs champs sont spécifiés pour la propriété, utilisez l' `{0}` emplacement où vous souhaitez que la première valeur de champ soit insérée, `{1}` pour la deuxième valeur de champ, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="006b0-157">If the `DataNavigateUrlFields` property has multiple fields specified use `{0}` where you want the first field value inserted, `{1}` for the second field value, and so on.</span></span>

<span data-ttu-id="006b0-158">En appliquant cela à notre didacticiel, nous devons affecter `DataNavigateUrlFields` à la propriété la `SupplierID` valeur, car il s’agit du champ de données dont nous devons personnaliser la valeur en fonction de chaque ligne, et la `DataNavigateUrlFormatString` propriété à `ProductsForSupplierDetails.aspx?SupplierID={0}` .</span><span class="sxs-lookup"><span data-stu-id="006b0-158">Applying this to our tutorial, we need to set the `DataNavigateUrlFields` property to `SupplierID`, since that's the data field whose value we need to customize on a per-row basis, and the `DataNavigateUrlFormatString` property to `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span></span>

<span data-ttu-id="006b0-159">[![Configurez le HyperLinkField de façon à inclure l’URL de lien appropriée basée sur RéfFournisseur.](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-159">[![Configure the HyperLinkField to Include the Proper Link URL Based Upon the SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="006b0-160">**Figure 6**: configurer HyperLinkField pour inclure l’URL de lien appropriée en fonction du `SupplierID` ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-160">**Figure 6**: Configure the HyperLinkField to Include the Proper Link URL Based Upon the `SupplierID` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span></span>

<span data-ttu-id="006b0-161">Après avoir ajouté le HyperLinkField, n’hésitez pas à personnaliser et à réorganiser les champs du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="006b0-161">After adding the HyperLinkField, feel free to customize and reorder the GridView's fields.</span></span> <span data-ttu-id="006b0-162">Le balisage suivant montre le GridView une fois que j’ai effectué des personnalisations mineures au niveau des champs.</span><span class="sxs-lookup"><span data-stu-id="006b0-162">The following markup shows the GridView after I've made some minor field-level customizations.</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="006b0-163">Prenez un moment pour afficher la `SupplierListMaster.aspx` page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="006b0-163">Take a moment to view the `SupplierListMaster.aspx` page through a browser.</span></span> <span data-ttu-id="006b0-164">Comme le montre la figure 7, la page répertorie actuellement tous les fournisseurs, y compris un lien Afficher les produits.</span><span class="sxs-lookup"><span data-stu-id="006b0-164">As Figure 7 shows, the page currently lists all of the suppliers including a View Products link.</span></span> <span data-ttu-id="006b0-165">Le fait de cliquer sur le lien Afficher les produits vous permet d’accéder à la `ProductsForSupplierDetails.aspx` chaîne de QueryString du fournisseur `SupplierID` .</span><span class="sxs-lookup"><span data-stu-id="006b0-165">Clicking on the View Products link will take you to `ProductsForSupplierDetails.aspx`, passing along the supplier's `SupplierID` in the querystring.</span></span>

<span data-ttu-id="006b0-166">[![Chaque ligne de fournisseur contient un lien Afficher les produits](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-166">[![Each Supplier Row Contains a View Products Link](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="006b0-167">**Figure 7**: chaque ligne de fournisseur contient un lien Afficher les produits ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-167">**Figure 7**: Each Supplier Row Contains a View Products Link ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span></span>

## <a name="step-3-listing-the-suppliers-products-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="006b0-168">Étape 3 : énumération des produits du fournisseur dans`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="006b0-168">Step 3: Listing the Supplier's Products in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="006b0-169">À ce stade `SupplierListMaster.aspx` , la page envoie des utilisateurs `ProductsForSupplierDetails.aspx` à, en passant le fournisseur sélectionné `SupplierID` dans la chaîne de chaîne.</span><span class="sxs-lookup"><span data-stu-id="006b0-169">At this point the `SupplierListMaster.aspx` page is sending users to `ProductsForSupplierDetails.aspx`, passing the selected supplier's `SupplierID` in the querystring.</span></span> <span data-ttu-id="006b0-170">La dernière étape du didacticiel consiste à afficher les produits dans un GridView dans `ProductsForSupplierDetails.aspx` dont est `SupplierID` égal au `SupplierID` passé dans la chaîne de chaîne.</span><span class="sxs-lookup"><span data-stu-id="006b0-170">The tutorial's final step is to display the products in a GridView in `ProductsForSupplierDetails.aspx` whose `SupplierID` equals the `SupplierID` passed in through the querystring.</span></span> <span data-ttu-id="006b0-171">Pour ce faire, ajoutez un GridView à la `ProductsForSupplierDetails.aspx` page, à l’aide d’un nouveau contrôle ObjectDataSource nommé `ProductsBySupplierDataSource` qui appelle la `GetProductsBySupplierID(supplierID)` méthode à partir de la `ProductsBLL` classe.</span><span class="sxs-lookup"><span data-stu-id="006b0-171">To accomplish this start by adding a GridView to the `ProductsForSupplierDetails.aspx` page, using a new ObjectDataSource control named `ProductsBySupplierDataSource` that invokes the `GetProductsBySupplierID(supplierID)` method from the `ProductsBLL` class.</span></span>

<span data-ttu-id="006b0-172">[![Ajouter un nouvel ObjectDataSource nommé ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-172">[![Add a New ObjectDataSource Named ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="006b0-173">**Figure 8**: ajouter un nouvel ObjectDataSource nommé `ProductsBySupplierDataSource` ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-173">**Figure 8**: Add a New ObjectDataSource Named `ProductsBySupplierDataSource` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span></span>

<span data-ttu-id="006b0-174">[![Sélectionnez la classe ProductsBLL](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-174">[![Select the ProductsBLL Class](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="006b0-175">**Figure 9**: sélectionner la `ProductsBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-175">**Figure 9**: Select the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span></span>

<span data-ttu-id="006b0-176">[![Demander à ObjectDataSource d’appeler la méthode GetProductsBySupplierID (RéfFournisseur)](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-176">[![Have the ObjectDataSource Invoke the GetProductsBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="006b0-177">**Figure 10**: demander à ObjectDataSource d’appeler la `GetProductsBySupplierID(supplierID)` méthode ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-177">**Figure 10**: Have the ObjectDataSource Invoke the `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span></span>

<span data-ttu-id="006b0-178">L’étape finale de l’Assistant Configuration de la source de données nous invite à fournir la source du paramètre de la `GetProductsBySupplierID(supplierID)` méthode *`supplierID`* .</span><span class="sxs-lookup"><span data-stu-id="006b0-178">The final step of the Configure Data Source wizard asks us to provide the source of the `GetProductsBySupplierID(supplierID)` method's *`supplierID`* parameter.</span></span> <span data-ttu-id="006b0-179">Pour utiliser la valeur QueryString, définissez la source du paramètre sur QueryString et entrez le nom de la valeur QueryString à utiliser dans la zone de texte QueryStringField ( `SupplierID` ).</span><span class="sxs-lookup"><span data-stu-id="006b0-179">To use the querystring value, set the Parameter source to QueryString and enter the name of the querystring value to use in the QueryStringField textbox (`SupplierID`).</span></span>

<span data-ttu-id="006b0-180">[![Renseignez la valeur du paramètre RéfFournisseur à partir de la valeur QueryString RéfFournisseur.](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-180">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="006b0-181">**Figure 11**: remplir la *`supplierID`* valeur de paramètre à partir de la `SupplierID` valeur QueryString ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-181">**Figure 11**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span></span>

<span data-ttu-id="006b0-182">C’est tout !</span><span class="sxs-lookup"><span data-stu-id="006b0-182">That's all there is to it!</span></span> <span data-ttu-id="006b0-183">La figure 12 affiche la `ProductsForSupplierDetails.aspx` page lorsqu’elle est visitée en cliquant sur le lien Tokyo traders à partir de `SupplierListMaster.aspx` .</span><span class="sxs-lookup"><span data-stu-id="006b0-183">Figure 12 shows the `ProductsForSupplierDetails.aspx` page when visited by clicking the Tokyo Traders link from `SupplierListMaster.aspx`.</span></span>

<span data-ttu-id="006b0-184">[![Les produits fournis par Tokyo traders sont affichés](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-184">[![The Products Supplied by Tokyo Traders are Shown](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span></span>

<span data-ttu-id="006b0-185">**Figure 12**: les produits fournis par Tokyo traders sont affichés ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-185">**Figure 12**: The Products Supplied by Tokyo Traders are Shown ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span></span>

## <a name="displaying-supplier-information-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="006b0-186">Affichage des informations sur les fournisseurs dans`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="006b0-186">Displaying Supplier Information in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="006b0-187">Comme le montre la figure 12, la `ProductsForSupplierDetails.aspx` page répertorie simplement les produits fournis par le `SupplierID` spécifié dans QueryString.</span><span class="sxs-lookup"><span data-stu-id="006b0-187">As Figure 12 shows, the `ProductsForSupplierDetails.aspx` page simply lists the products that are supplied by the `SupplierID` specified in the querystring.</span></span> <span data-ttu-id="006b0-188">Une personne directement envoyée à cette page ne sait pas que la figure 12 montre les produits de Tokyo Traders.</span><span class="sxs-lookup"><span data-stu-id="006b0-188">Someone sent directly to this page, however, would not know that Figure 12 is showing Tokyo Traders' products.</span></span> <span data-ttu-id="006b0-189">Pour y remédier, nous pouvons également afficher des informations sur les fournisseurs dans cette page.</span><span class="sxs-lookup"><span data-stu-id="006b0-189">To remedy this we can display supplier information in this page as well.</span></span>

<span data-ttu-id="006b0-190">Commencez par ajouter un FormView au-dessus du GridView Products.</span><span class="sxs-lookup"><span data-stu-id="006b0-190">Start by adding a FormView above the products GridView.</span></span> <span data-ttu-id="006b0-191">Créez un nouveau contrôle ObjectDataSource nommé `SuppliersDataSource` qui appelle la `SuppliersBLL` méthode de la classe `GetSupplierBySupplierID(supplierID)` .</span><span class="sxs-lookup"><span data-stu-id="006b0-191">Create a new ObjectDataSource control named `SuppliersDataSource` that invokes the `SuppliersBLL` class's `GetSupplierBySupplierID(supplierID)` method.</span></span>

<span data-ttu-id="006b0-192">[![Sélectionnez la classe SuppliersBLL](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-192">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span></span>

<span data-ttu-id="006b0-193">**Figure 13**: sélectionner la `SuppliersBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-193">**Figure 13**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span></span>

<span data-ttu-id="006b0-194">[![Demander à ObjectDataSource d’appeler la méthode GetSupplierBySupplierID (RéfFournisseur)](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-194">[![Have the ObjectDataSource Invoke the GetSupplierBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span></span>

<span data-ttu-id="006b0-195">**Figure 14**: demander à ObjectDataSource d’appeler la `GetSupplierBySupplierID(supplierID)` méthode ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-195">**Figure 14**: Have the ObjectDataSource Invoke the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span></span>

<span data-ttu-id="006b0-196">Comme avec `ProductsBySupplierDataSource` , le paramètre doit être affecté à la valeur *`supplierID`* `SupplierID` QueryString.</span><span class="sxs-lookup"><span data-stu-id="006b0-196">As with the `ProductsBySupplierDataSource`, have the *`supplierID`* parameter assigned the value of the `SupplierID` querystring value.</span></span>

<span data-ttu-id="006b0-197">[![Renseignez la valeur du paramètre RéfFournisseur à partir de la valeur QueryString RéfFournisseur.](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-197">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span></span>

<span data-ttu-id="006b0-198">**Figure 15**: remplir la *`supplierID`* valeur de paramètre à partir de la `SupplierID` valeur QueryString ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-198">**Figure 15**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span></span>

<span data-ttu-id="006b0-199">Lors de la liaison du FormView au ObjectDataSource dans le Mode Création, Visual Studio crée automatiquement les `ItemTemplate` contrôles Web du FormView, `InsertItemTemplate` , et `EditItemTemplate` avec les contrôles Web Label et TextBox pour chacun des champs de données retournés par l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="006b0-199">When binding the FormView to the ObjectDataSource in the Design view, Visual Studio will automatically create the FormView's `ItemTemplate`, `InsertItemTemplate`, and `EditItemTemplate` with Label and TextBox Web controls for each of the data fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="006b0-200">Étant donné que nous voulons juste afficher les informations des fournisseurs, n’hésitez pas à supprimer le `InsertItemTemplate` et `EditItemTemplate` .</span><span class="sxs-lookup"><span data-stu-id="006b0-200">Since we just want to display supplier information feel free to remove the `InsertItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="006b0-201">Modifiez ensuite le ItemTemplate afin qu’il affiche le nom de la société du fournisseur dans un `<h3>` élément et l’adresse, la ville, le pays et le numéro de téléphone sous le nom de la société.</span><span class="sxs-lookup"><span data-stu-id="006b0-201">Next, edit the ItemTemplate so that it displays the supplier's company name in an `<h3>` element and the address, city, country, and phone number beneath the company name.</span></span> <span data-ttu-id="006b0-202">Vous pouvez également définir manuellement les informations du FormView `DataSourceID` et créer le `ItemTemplate` balisage, comme nous l’avons fait dans le didacticiel «[affichage des données avec ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)».</span><span class="sxs-lookup"><span data-stu-id="006b0-202">Alternatively, you can manually set the FormView's `DataSourceID` and create the `ItemTemplate` markup, as we did back in the "[Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" tutorial.</span></span>

<span data-ttu-id="006b0-203">Une fois ces modifications apportées, le balisage déclaratif du FormView doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="006b0-203">After these edits the FormView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="006b0-204">La figure 16 illustre une capture d’écran de la `ProductsForSupplierDetails.aspx` page une fois que les informations sur le fournisseur détaillées ci-dessus ont été incluses.</span><span class="sxs-lookup"><span data-stu-id="006b0-204">Figure 16 shows a screen shot of the `ProductsForSupplierDetails.aspx` page after the supplier information detailed above has been included.</span></span>

<span data-ttu-id="006b0-205">[![La liste des produits comprend un résumé du fournisseur.](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-205">[![The List of Products Includes a Summary About the Supplier](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span></span>

<span data-ttu-id="006b0-206">**Figure 16**: la liste des produits comprend un résumé du fournisseur ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-206">**Figure 16**: The List of Products Includes a Summary About the Supplier ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span></span>

## <a name="applying-the-final-touches-for-theproductsforsupplierdetailsaspxui"></a><span data-ttu-id="006b0-207">Application des touches finales de l' `ProductsForSupplierDetails.aspx` interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="006b0-207">Applying the Final Touches for the`ProductsForSupplierDetails.aspx`UI</span></span>

<span data-ttu-id="006b0-208">Pour améliorer l’expérience utilisateur pour ce rapport, nous devons effectuer quelques ajouts à la `ProductsForSupplierDetails.aspx` page.</span><span class="sxs-lookup"><span data-stu-id="006b0-208">To improve the user experience for this report there are a couple of additions we ought to make to the `ProductsForSupplierDetails.aspx` page.</span></span> <span data-ttu-id="006b0-209">Actuellement, la seule manière dont un utilisateur peut accéder à `ProductsForSupplierDetails.aspx` la liste des fournisseurs est de cliquer sur le bouton précédent du navigateur.</span><span class="sxs-lookup"><span data-stu-id="006b0-209">Currently the only way a user can go from the `ProductsForSupplierDetails.aspx` page back to the list of suppliers is to click their browser's back button.</span></span> <span data-ttu-id="006b0-210">Nous allons ajouter un contrôle de lien hypertexte à la `ProductsForSupplierDetails.aspx` page qui renvoie vers, ce qui permet `SupplierListMaster.aspx` à l’utilisateur de revenir à la liste principale.</span><span class="sxs-lookup"><span data-stu-id="006b0-210">Let's add a HyperLink control to the `ProductsForSupplierDetails.aspx` page that links back to `SupplierListMaster.aspx`, providing another way for the user to return to the master list.</span></span>

<span data-ttu-id="006b0-211">[![Ajouter un contrôle de lien hypertexte pour reconnecter l’utilisateur à SupplierListMaster. aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-211">[![Add a HyperLink Control to Take the User Back to SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span></span>

<span data-ttu-id="006b0-212">**Figure 17**: ajouter un contrôle de lien hypertexte pour reconnecter l’utilisateur `SupplierListMaster.aspx` ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-212">**Figure 17**: Add a HyperLink Control to Take the User Back to `SupplierListMaster.aspx` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span></span>

<span data-ttu-id="006b0-213">Si l’utilisateur clique sur le lien Afficher les produits pour un fournisseur qui n’a pas de produits, le `ProductsBySupplierDataSource` ObjectDataSource dans `ProductsForSupplierDetails.aspx` ne retourne aucun résultat.</span><span class="sxs-lookup"><span data-stu-id="006b0-213">If the user clicks on the View Products link for a supplier that doesn't have any products, the `ProductsBySupplierDataSource` ObjectDataSource in `ProductsForSupplierDetails.aspx` won't return any results.</span></span> <span data-ttu-id="006b0-214">Le GridView lié à ObjectDataSource n’affiche aucun balisage résultant dans une zone vide de la page dans le navigateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="006b0-214">The GridView bound to the ObjectDataSource won't render any markup resulting in a blank region on the page in the user's browser.</span></span> <span data-ttu-id="006b0-215">Pour communiquer plus clairement à l’utilisateur qu’aucun produit n’est associé au fournisseur sélectionné, nous pouvons définir la propriété du contrôle GridView `EmptyDataText` sur le message que nous souhaitons afficher lorsqu’une telle situation se produit.</span><span class="sxs-lookup"><span data-stu-id="006b0-215">To more clearly communicate to the user that there are no products associated with the selected supplier we can set the GridView's `EmptyDataText` property to the message we want displayed when such a situation arises.</span></span> <span data-ttu-id="006b0-216">J’ai défini cette propriété sur « aucun produit n’est fourni par ce fournisseur ».</span><span class="sxs-lookup"><span data-stu-id="006b0-216">I've set this property to "There are no products provided by this supplier'"</span></span>

<span data-ttu-id="006b0-217">Par défaut, tous les fournisseurs de la base de données Northwind fournissent au moins un produit.</span><span class="sxs-lookup"><span data-stu-id="006b0-217">By default, all suppliers in the Northwinds database provide at least one product.</span></span> <span data-ttu-id="006b0-218">Toutefois, pour ce didacticiel, j’ai modifié manuellement la `Products` table afin que le fournisseur escargots nouveaux ne soit plus associé à aucun produit.</span><span class="sxs-lookup"><span data-stu-id="006b0-218">However, for this tutorial I've manually modified the `Products` table so that the supplier Escargots Nouveaux is no longer associated with any products.</span></span> <span data-ttu-id="006b0-219">La figure 18 affiche la page de détails de escargots nouveaux après cette modification.</span><span class="sxs-lookup"><span data-stu-id="006b0-219">Figure 18 shows the details page for Escargots Nouveaux after this change has been made.</span></span>

<span data-ttu-id="006b0-220">[![Les utilisateurs sont informés que le fournisseur ne fournit aucun produit](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="006b0-220">[![Users are Informed that the Supplier Doesn't Provide Any Products](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span></span>

<span data-ttu-id="006b0-221">**Figure 18**: les utilisateurs sont informés que le fournisseur ne fournit aucun produit ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="006b0-221">**Figure 18**: Users are Informed that the Supplier Doesn't Provide Any Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span></span>

## <a name="summary"></a><span data-ttu-id="006b0-222">Résumé</span><span class="sxs-lookup"><span data-stu-id="006b0-222">Summary</span></span>

<span data-ttu-id="006b0-223">Bien que les rapports maître/détail puissent afficher à la fois les enregistrements maître et détail sur une seule page, dans de nombreux sites Web, ils sont séparés sur deux pages Web.</span><span class="sxs-lookup"><span data-stu-id="006b0-223">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="006b0-224">Dans ce didacticiel, nous avons vu comment implémenter ce rapport maître/détail en faisant en sorte que les fournisseurs soient listés dans un contrôle GridView dans la page Web « master » et les produits associés figurant dans la page « Détails ».</span><span class="sxs-lookup"><span data-stu-id="006b0-224">In this tutorial we looked at how to implement such a master/detail report by having the suppliers listed in a GridView in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="006b0-225">Chaque ligne de fournisseur dans la page Web principale contient un lien vers la page de détails qui a été transmise le long de la valeur de la ligne `SupplierID` .</span><span class="sxs-lookup"><span data-stu-id="006b0-225">Each supplier row in the master web page contained a link to the details page that passed along the row's `SupplierID` value.</span></span> <span data-ttu-id="006b0-226">De tels liens spécifiques à la ligne peuvent être ajoutés facilement à l’aide de l’HyperLinkField du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="006b0-226">Such row-specific links can be easily added using the GridView's HyperLinkField.</span></span>

<span data-ttu-id="006b0-227">Dans la page de détails, la récupération de ces produits pour le fournisseur spécifié a été effectuée en appelant la `ProductsBLL` méthode de la classe `GetProductsBySupplierID(supplierID)` .</span><span class="sxs-lookup"><span data-stu-id="006b0-227">In the details page retrieving those products for the specified supplier was accomplished by invoking the `ProductsBLL` class's `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="006b0-228">La *`supplierID`* valeur du paramètre a été spécifiée de manière déclarative à l’aide de QueryString comme source du paramètre.</span><span class="sxs-lookup"><span data-stu-id="006b0-228">The *`supplierID`* parameter value was specified declaratively using the querystring as the parameter source.</span></span> <span data-ttu-id="006b0-229">Nous avons également vu comment afficher les détails du fournisseur dans la page de détails à l’aide d’un FormView.</span><span class="sxs-lookup"><span data-stu-id="006b0-229">We also looked at how to display the supplier details in the details page using a FormView.</span></span>

<span data-ttu-id="006b0-230">Le [prochain didacticiel](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) est le dernier dans les rapports maître/détail.</span><span class="sxs-lookup"><span data-stu-id="006b0-230">Our [next tutorial](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) is the final one on master/detail reports.</span></span> <span data-ttu-id="006b0-231">Nous allons voir comment afficher une liste de produits dans un contrôle GridView où chaque ligne a un bouton Sélectionner.</span><span class="sxs-lookup"><span data-stu-id="006b0-231">We'll look at how to display a list of products in a GridView where each row has a Select button.</span></span> <span data-ttu-id="006b0-232">Le fait de cliquer sur le bouton Sélectionner affiche les détails de ce produit dans un contrôle DetailsView sur la même page.</span><span class="sxs-lookup"><span data-stu-id="006b0-232">Clicking on the Select button will display that product's details in a DetailsView control on the same page.</span></span>

<span data-ttu-id="006b0-233">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="006b0-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="006b0-234">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="006b0-234">About the Author</span></span>

<span data-ttu-id="006b0-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="006b0-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="006b0-236">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="006b0-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="006b0-237">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="006b0-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="006b0-238">Il peut être contacté à l’adresse [ mitchell@4GuysFromRolla.com .](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="006b0-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="006b0-239">ou via son blog, qui se trouve à l’adresse [http://ScottOnWriting.NET](http://ScottOnWriting.NET) .</span><span class="sxs-lookup"><span data-stu-id="006b0-239">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="006b0-240">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="006b0-240">Special Thanks To</span></span>

<span data-ttu-id="006b0-241">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="006b0-241">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="006b0-242">Le réviseur de leads pour ce didacticiel était Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="006b0-242">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="006b0-243">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="006b0-243">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="006b0-244">Dans ce cas, déposez-moi une ligne à l’adresse [ mitchell@4GuysFromRolla.com .](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="006b0-244">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="006b0-245">[Précédent](master-detail-filtering-with-two-dropdownlists-vb.md) 
>  [Suivant](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span><span class="sxs-lookup"><span data-stu-id="006b0-245">[Previous](master-detail-filtering-with-two-dropdownlists-vb.md)
[Next](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span></span>
