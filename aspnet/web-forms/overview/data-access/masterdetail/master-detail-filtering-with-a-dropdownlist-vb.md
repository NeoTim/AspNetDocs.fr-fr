---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
title: Filtrage avec une DropDownList (VB) maître/détail | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons voir comment afficher les enregistrements maîtres dans un contrôle DropDownList et les détails de l’élément de liste sélectionné dans un GridView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: ea44717e-ab2e-46cd-a692-e4a9c0de194c
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
msc.type: authoredcontent
ms.openlocfilehash: 5db5e30cac21bad0591f4476a1b1156b50117536
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59382262"
---
# <a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="a01cc-103">Filtrage maître/détail avec une DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="a01cc-103">Master/Detail Filtering With a DropDownList (VB)</span></span>

<span data-ttu-id="a01cc-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a01cc-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a01cc-105">[Télécharger l’exemple d’application](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) ou [télécharger le PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a01cc-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span></span>

> <span data-ttu-id="a01cc-106">Dans ce didacticiel, nous allons voir comment afficher les enregistrements maîtres dans un contrôle DropDownList et les détails de l’élément de liste sélectionné dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="a01cc-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>


## <a name="introduction"></a><span data-ttu-id="a01cc-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="a01cc-107">Introduction</span></span>

<span data-ttu-id="a01cc-108">Un type commun de rapport est la *maître/détail rapport*, dans laquelle commence le rapport en affichant un jeu d’enregistrements « maîtres ».</span><span class="sxs-lookup"><span data-stu-id="a01cc-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="a01cc-109">L’utilisateur peut puis accédez à un des principaux, affichant ainsi que master détails de l’enregistrement «. »</span><span class="sxs-lookup"><span data-stu-id="a01cc-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="a01cc-110">Maître/détail signale est un choix idéal pour visualiser les relations un-à-plusieurs, tel qu’un rapport affichant toutes les catégories, puis en autorisant un utilisateur de sélectionner une catégorie particulière et afficher ses produits associés.</span><span class="sxs-lookup"><span data-stu-id="a01cc-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="a01cc-111">En outre, les rapports maître/détail sont utiles pour afficher des informations détaillées à partir des tables en particulier « larges » (ceux qui ont un grand nombre de colonnes).</span><span class="sxs-lookup"><span data-stu-id="a01cc-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="a01cc-112">Par exemple, le niveau « maître » d’un rapport maître/détail peut-être afficher simplement le nom et l’unité de prix du produit des produits dans la base de données et exploration d’un produit particulier affiche les champs de produits supplémentaires (catégorie, fournisseur, quantité par unité, et ainsi de suite).</span><span class="sxs-lookup"><span data-stu-id="a01cc-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="a01cc-113">Il existe plusieurs façons avec laquelle un rapport maître/détail peut être implémenté.</span><span class="sxs-lookup"><span data-stu-id="a01cc-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="a01cc-114">Cet aspect ainsi que les trois didacticiels, nous allons examiner divers rapports maître/détail.</span><span class="sxs-lookup"><span data-stu-id="a01cc-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="a01cc-115">Dans ce didacticiel, nous allons voir comment afficher les enregistrements maîtres dans un [contrôle DropDownList](https://msdn.microsoft.com/library/dtx91y0z.aspx) et les détails de l’élément de liste sélectionné dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="a01cc-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="a01cc-116">En particulier, rapport maître/détail de ce didacticiel va répertorier les informations de catégorie et de produit.</span><span class="sxs-lookup"><span data-stu-id="a01cc-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="a01cc-117">Étape 1 : Afficher les catégories dans un contrôle DropDownList</span><span class="sxs-lookup"><span data-stu-id="a01cc-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="a01cc-118">Notre rapport maître/détail répertorie les catégories dans un contrôle DropDownList, avec les produits de l’élément de liste sélectionné affichées plus loin dans la page dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="a01cc-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="a01cc-119">La première tâche préalable des États-Unis, est ensuite, pour que les catégories affichées dans un contrôle DropDownList.</span><span class="sxs-lookup"><span data-stu-id="a01cc-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="a01cc-120">Ouvrez le `FilterByDropDownList.aspx` page dans le `Filtering` dossier, faites glisser sur un contrôle DropDownList de la boîte à outils vers le Concepteur de la page et définissez son `ID` propriété `Categories`.</span><span class="sxs-lookup"><span data-stu-id="a01cc-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="a01cc-121">Ensuite, cliquez sur le lien de choisir la Source de données à partir de la balise active de la liste DropDownList.</span><span class="sxs-lookup"><span data-stu-id="a01cc-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="a01cc-122">Ceci affichera l’Assistant Configuration de Source de données.</span><span class="sxs-lookup"><span data-stu-id="a01cc-122">This will display the Data Source Configuration wizard.</span></span>


<span data-ttu-id="a01cc-123">[![Spécifiez la Source de données de la liste DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span></span>

<span data-ttu-id="a01cc-124">**Figure 1**: Spécifiez la Source de données de l’objet DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span></span>


<span data-ttu-id="a01cc-125">Choisissez d’ajouter un nouveau ObjectDataSource nommé `CategoriesDataSource` qui appelle le `CategoriesBLL` la classe `GetCategories()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="a01cc-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>


<span data-ttu-id="a01cc-126">[![Ajouter un nouveau ObjectDataSource nommé CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span></span>

<span data-ttu-id="a01cc-127">**Figure 2**: Ajouter une nouvelle nommée de ObjectDataSource `CategoriesDataSource` ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span></span>


<span data-ttu-id="a01cc-128">[![Choisissez d’utiliser la classe CategoriesBLL](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span></span>

<span data-ttu-id="a01cc-129">**Figure 3**: Choisissez d’utiliser le `CategoriesBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span></span>


<span data-ttu-id="a01cc-130">[![Configurer pour utiliser la méthode GetCategories() ObjectDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span></span>

<span data-ttu-id="a01cc-131">**Figure 4**: Configurer l’ObjectDataSource à utiliser le `GetCategories()` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span></span>


<span data-ttu-id="a01cc-132">Après avoir configuré l’ObjectDataSource, nous avons besoin pour spécifier quel champ de source de données doit s’afficher dans DropDownList et qui, une doit être associée en tant que la valeur de l’élément de liste.</span><span class="sxs-lookup"><span data-stu-id="a01cc-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="a01cc-133">Avoir le `CategoryName` champ en tant que l’affichage et `CategoryID` comme valeur pour chaque élément de liste.</span><span class="sxs-lookup"><span data-stu-id="a01cc-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="a01cc-134">[![Ont l’affichage DropDownList le champ nom de catégorie et utilisez CategoryID comme valeur](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span></span>

<span data-ttu-id="a01cc-135">**Figure 5**: Affiche la liste DropDownList le `CategoryName` champ et utilisez `CategoryID` comme valeur ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span></span>


<span data-ttu-id="a01cc-136">À ce stade, nous avons un contrôle DropDownList qui est rempli avec les enregistrements à partir de la `Categories` table (toutes accompli dans environ six secondes).</span><span class="sxs-lookup"><span data-stu-id="a01cc-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="a01cc-137">Figure 6 illustre notre progression jusqu'à présent lorsqu’ils sont affichés via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="a01cc-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="a01cc-138">[![Une liste déroulante répertorie les catégories des actifs](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span></span>

<span data-ttu-id="a01cc-139">**Figure 6**: Une liste déroulante répertorie les catégories des actifs ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span></span>


## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="a01cc-140">Étape 2 : Ajout de produits GridView</span><span class="sxs-lookup"><span data-stu-id="a01cc-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="a01cc-141">Cette dernière étape dans notre rapport maître/détail consiste à répertorier les produits associés à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="a01cc-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="a01cc-142">Pour ce faire, ajoutez un GridView à la page et créer un nouveau ObjectDataSource nommé `productsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a01cc-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="a01cc-143">Ont le `productsDataSource` contrôle sélectionnons ses données à partir de la `ProductsBLL` la classe `GetProductsByCategoryID(categoryID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="a01cc-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>


<span data-ttu-id="a01cc-144">[![Sélectionnez la méthode GetProductsByCategoryID(categoryID)](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span></span>

<span data-ttu-id="a01cc-145">**Figure 7**: Sélectionnez le `GetProductsByCategoryID(categoryID)` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span></span>


<span data-ttu-id="a01cc-146">Après avoir choisi cette méthode, l’Assistant ObjectDataSource nous demande la valeur de la méthode *`categoryID`* paramètre.</span><span class="sxs-lookup"><span data-stu-id="a01cc-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="a01cc-147">Pour utiliser la valeur de l’élément sélectionné `categories` DropDownList élément définie la source de paramètre au contrôle et le ControlID à `Categories`.</span><span class="sxs-lookup"><span data-stu-id="a01cc-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>


<span data-ttu-id="a01cc-148">[![Définir la paramètre categoryID sur la valeur de l’objet DropDownList de catégories](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span></span>

<span data-ttu-id="a01cc-149">**Figure 8**: Définir le *`categoryID`* paramètre à la valeur de la `Categories` DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span></span>


<span data-ttu-id="a01cc-150">Prenez un moment pour consulter notre progression dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="a01cc-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="a01cc-151">Lors de la première visite la page, ces produits font partie de la catégorie sélectionnée (boissons) sont affichées (comme indiqué dans la Figure 9), mais la modification de la liste DropDownList ne met à jour les données.</span><span class="sxs-lookup"><span data-stu-id="a01cc-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="a01cc-152">Il s’agit, car une publication (postback) doit survenir pour que le contrôle GridView à mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="a01cc-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="a01cc-153">Pour ce faire, nous avons deux options (qui ne nécessite l’écriture de code) :</span><span class="sxs-lookup"><span data-stu-id="a01cc-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="a01cc-154">**Définir les catégories DropDownList**[propriété AutoPostBack](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**sur True.**</span><span class="sxs-lookup"><span data-stu-id="a01cc-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="a01cc-155">(Vous pouvez parvenir en sélectionnant l’option Activer AutoPostBack dans la balise active de la liste DropDownList.) Cela déclenchera une publication (postback) lorsque vous sélectionnez la DropDownList élément est modifié par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a01cc-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="a01cc-156">Par conséquent, lorsque l’utilisateur sélectionne une nouvelle catégorie dans la liste DropDownList résulte une publication (postback) et le contrôle GridView sera actualisée avec les produits de la catégorie qui vient d’être sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="a01cc-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="a01cc-157">(Il s’agit de l’approche que j’ai utilisé dans ce didacticiel.)</span><span class="sxs-lookup"><span data-stu-id="a01cc-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="a01cc-158">**Ajouter un contrôle bouton en regard de la liste DropDownList.**</span><span class="sxs-lookup"><span data-stu-id="a01cc-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="a01cc-159">Définissez ses `Text` propriété pour l’actualisation ou quelque chose de similaire.</span><span class="sxs-lookup"><span data-stu-id="a01cc-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="a01cc-160">Avec cette approche, l’utilisateur devra sélectionner une nouvelle catégorie et puis cliquez sur le bouton.</span><span class="sxs-lookup"><span data-stu-id="a01cc-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="a01cc-161">En cliquant sur le bouton pour provoquer une publication (postback) et mettre à jour le contrôle GridView pour répertorier les produits de la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="a01cc-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="a01cc-162">Les figures 9 et 10 montrent le rapport maître/détail en action.</span><span class="sxs-lookup"><span data-stu-id="a01cc-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>


<span data-ttu-id="a01cc-163">[![Lors de la première visite la Page, les produits de boissons sont affichés.](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span></span>

<span data-ttu-id="a01cc-164">**Figure 9**: Lors de la première visite la Page, les produits de boissons sont affichés ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span></span>


<span data-ttu-id="a01cc-165">[![Sélection d’un nouveau produit (produit) automatiquement provoque une publication (postback), la mise à jour le contrôle GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span></span>

<span data-ttu-id="a01cc-166">**Figure 10**: Sélection d’un nouveau produit (produit) automatiquement provoque une publication (postback), la mise à jour le contrôle GridView ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span></span>


## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="a01cc-167">Ajout d’un élément de liste «--Choisir une catégorie-- »</span><span class="sxs-lookup"><span data-stu-id="a01cc-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="a01cc-168">Lors de la visite de tout d’abord le `FilterByDropDownList.aspx` page les catégories premier élément de liste du DropDownList (boissons) est sélectionné par défaut, montrant les produits de boissons dans le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="a01cc-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="a01cc-169">Non montrant les produits de la première catégorie, que nous souhaiterons peut-être d’avoir à la place un élément DropDownList sélectionné qui dit quelque chose comme «--choisir une catégorie-- ».</span><span class="sxs-lookup"><span data-stu-id="a01cc-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="a01cc-170">Pour ajouter un nouvel élément de liste à l’objet DropDownList, accédez à la fenêtre Propriétés, puis cliquez sur le bouton de sélection dans le `Items` propriété.</span><span class="sxs-lookup"><span data-stu-id="a01cc-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="a01cc-171">Ajouter un nouvel élément de liste avec la `Text` «--choisir une catégorie-- » et le `Value` `-1`.</span><span class="sxs-lookup"><span data-stu-id="a01cc-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>


<span data-ttu-id="a01cc-172">[![Ajouter un--choisir une catégorie, élément de liste](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span></span>

<span data-ttu-id="a01cc-173">**Figure 11**: Ajouter un--choisir une catégorie, élément de liste ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span></span>


<span data-ttu-id="a01cc-174">Vous pouvez également ajouter l’élément de liste en ajoutant le balisage suivant à la liste DropDownList :</span><span class="sxs-lookup"><span data-stu-id="a01cc-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>


[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample1.aspx)]

<span data-ttu-id="a01cc-175">En outre, nous devons définir le contrôle DropDownList `AppendDataBoundItems` sur True, car lorsque les catégories sont liés à la liste DropDownList à partir de l’ObjectDataSource elles remplaceront tous les éléments ajoutés manuellement la liste si `AppendDataBoundItems` n’est pas True.</span><span class="sxs-lookup"><span data-stu-id="a01cc-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>


![Définissez la propriété AppendDataBoundItems sur True](master-detail-filtering-with-a-dropdownlist-vb/_static/image34.png)

<span data-ttu-id="a01cc-177">**Figure 12**: Définir le `AppendDataBoundItems` True à la propriété</span><span class="sxs-lookup"><span data-stu-id="a01cc-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>


<span data-ttu-id="a01cc-178">Après ces modifications, lors de la visite de tout d’abord la page de l’option «--choisir une catégorie-- » est sélectionnée et aucun produit n’est affichés.</span><span class="sxs-lookup"><span data-stu-id="a01cc-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>


<span data-ttu-id="a01cc-179">[![Sur le chargement de Page Initial aucun produit n’est affichés](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span></span>

<span data-ttu-id="a01cc-180">**Figure 13**: Sur les produits d’aucune Page charge initiale s’affichent ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span></span>


<span data-ttu-id="a01cc-181">Aucun produit n’est affichés lorsque car l’élément de liste «--Choisir une catégorie-- » est sélectionnée est parce que sa valeur est `-1` et il n’y aucun produit dans la base de données avec un `CategoryID` de `-1`.</span><span class="sxs-lookup"><span data-stu-id="a01cc-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="a01cc-182">S’il s’agit du comportement voulu, puis que vous avez terminé à ce stade !</span><span class="sxs-lookup"><span data-stu-id="a01cc-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="a01cc-183">Si, toutefois, vous souhaitez afficher *tous les* des catégories lorsque l’élément de liste «--Choisir une catégorie-- » est sélectionné, revenir à la `ProductsBLL` classe et de personnaliser le `GetProductsByCategoryID(categoryID)` méthode afin qu’elle appelle le `GetProducts()` (méthode) si passé dans *`categoryID`* paramètre est inférieur à zéro :</span><span class="sxs-lookup"><span data-stu-id="a01cc-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>


[!code-vb[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample2.vb)]

<span data-ttu-id="a01cc-184">La technique utilisée ici est similaire à l’approche que nous avons utilisé pour afficher tous les fournisseurs dans le [paramètres déclaratifs](../basic-reporting/declarative-parameters-cs.md) (didacticiel), bien que dans cet exemple, nous utilisons la valeur `-1` pour indiquer que tous les enregistrements doivent être récupéré par opposition à `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="a01cc-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `Nothing`.</span></span> <span data-ttu-id="a01cc-185">Il s’agit, car le *`categoryID`* paramètre de la `GetProductsByCategoryID(categoryID)` méthode attend comme valeur d’entier passés, tandis que dans le didacticiel de paramètres déclaratifs nous étions en passant un paramètre d’entrée de chaîne.</span><span class="sxs-lookup"><span data-stu-id="a01cc-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="a01cc-186">La figure 14 montre la capture d’écran `FilterByDropDownList.aspx` lorsque l’option «--choisir une catégorie-- » est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="a01cc-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="a01cc-187">Ici, tous les produits sont affichés par défaut, et l’utilisateur peut limiter l’affichage en choisissant une catégorie spécifique.</span><span class="sxs-lookup"><span data-stu-id="a01cc-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>


<span data-ttu-id="a01cc-188">[![Tous les produits sont maintenant répertoriés par défaut](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="a01cc-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span></span>

<span data-ttu-id="a01cc-189">**Figure 14**: Tous les produits sont maintenant répertoriés par défaut ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="a01cc-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span></span>


## <a name="summary"></a><span data-ttu-id="a01cc-190">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="a01cc-190">Summary</span></span>

<span data-ttu-id="a01cc-191">Lors de l’affichage des données liées de manière hiérarchique, il permet souvent de présenter les données à l’aide de rapports maître/détail, à partir de laquelle l’utilisateur peut démarrer feuilletant les données à partir du haut de la hiérarchie et afficher les détails.</span><span class="sxs-lookup"><span data-stu-id="a01cc-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="a01cc-192">Dans ce didacticiel, nous avons examiné la création d’un rapport maître/détail simple montrant les produits d’une catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="a01cc-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="a01cc-193">Cela a été accompli en utilisant un DropDownList pour la liste des catégories et un GridView pour les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="a01cc-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="a01cc-194">Dans le [didacticiel suivant](master-detail-filtering-with-two-dropdownlists-vb.md) nous allons l’une étape interface de DropDownList en outre, à l’aide de deux DropDownList.</span><span class="sxs-lookup"><span data-stu-id="a01cc-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-vb.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="a01cc-195">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="a01cc-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a01cc-196">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="a01cc-196">About the Author</span></span>

<span data-ttu-id="a01cc-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="a01cc-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a01cc-198">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="a01cc-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a01cc-199">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a01cc-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a01cc-200">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a01cc-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a01cc-201">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a01cc-201">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a01cc-202">[Précédent](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
> [Suivant](master-detail-filtering-with-two-dropdownlists-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a01cc-202">[Previous](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Next](master-detail-filtering-with-two-dropdownlists-vb.md)</span></span>
