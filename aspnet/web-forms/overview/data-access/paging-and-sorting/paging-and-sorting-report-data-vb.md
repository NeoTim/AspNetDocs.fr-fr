---
uid: web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
title: Pagination et tri des données de rapport (VB) | Microsoft Docs
author: rick-anderson
description: La pagination et le tri sont deux fonctionnalités très courantes lors de l’affichage des données dans une application en ligne. Dans ce didacticiel, nous allons commencer par examiner l’ajout du tri et...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: b895e37e-0e69-45cc-a7e4-17ddd2e1b38d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 6785b5cd2d4d3a2c2e7f2c2fea93f5cd5e2fdf24
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74619075"
---
# <a name="paging-and-sorting-report-data-vb"></a><span data-ttu-id="e1a61-104">Pagination et tri des données des rapports (VB)</span><span class="sxs-lookup"><span data-stu-id="e1a61-104">Paging and Sorting Report Data (VB)</span></span>

<span data-ttu-id="e1a61-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e1a61-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e1a61-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe) ou [Télécharger le PDF](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e1a61-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe) or [Download PDF](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span></span>

> <span data-ttu-id="e1a61-107">La pagination et le tri sont deux fonctionnalités très courantes lors de l’affichage des données dans une application en ligne.</span><span class="sxs-lookup"><span data-stu-id="e1a61-107">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="e1a61-108">Dans ce didacticiel, nous allons d’abord ajouter le tri et la pagination à vos rapports, que nous utiliserons ensuite dans les prochains didacticiels.</span><span class="sxs-lookup"><span data-stu-id="e1a61-108">In this tutorial we'll take a first look at adding sorting and paging to our reports, which we will then build upon in future tutorials.</span></span>

## <a name="introduction"></a><span data-ttu-id="e1a61-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="e1a61-109">Introduction</span></span>

<span data-ttu-id="e1a61-110">La pagination et le tri sont deux fonctionnalités très courantes lors de l’affichage des données dans une application en ligne.</span><span class="sxs-lookup"><span data-stu-id="e1a61-110">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="e1a61-111">Par exemple, lors de la recherche de livres ASP.NET dans une librairie en ligne, il peut y avoir des centaines de livres de ce type, mais le rapport qui répertorie les résultats de la recherche ne répertorie que dix correspondances par page.</span><span class="sxs-lookup"><span data-stu-id="e1a61-111">For example, when searching for ASP.NET books at an online bookstore, there may be hundreds of such books, but the report listing the search results lists only ten matches per page.</span></span> <span data-ttu-id="e1a61-112">En outre, les résultats peuvent être triés par titre, par prix, par nombre de pages, par nom d’auteur, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="e1a61-112">Moreover, the results can be sorted by title, price, page count, author name, and so on.</span></span> <span data-ttu-id="e1a61-113">Tandis que les 23 derniers didacticiels ont examiné comment créer un grand nombre de rapports, y compris les interfaces qui permettent d’ajouter, de modifier et de supprimer des données, nous n’avons pas vu comment trier les données, et les seuls exemples de pagination que nous avons vus ont été avec DetailsView et FormView commandes.</span><span class="sxs-lookup"><span data-stu-id="e1a61-113">While the past 23 tutorials have examined how to build a variety of reports, including interfaces that permit adding, editing, and deleting data, we ve not looked at how to sort data and the only paging examples we ve seen have been with the DetailsView and FormView controls.</span></span>

<span data-ttu-id="e1a61-114">Dans ce didacticiel, nous allons voir comment ajouter le tri et la pagination à vos rapports, ce qui peut être accompli en cochant simplement quelques cases.</span><span class="sxs-lookup"><span data-stu-id="e1a61-114">In this tutorial we'll see how to add sorting and paging to our reports, which can be accomplished by simply checking a few checkboxes.</span></span> <span data-ttu-id="e1a61-115">Malheureusement, cette implémentation simpliste présente ses inconvénients. l’interface de tri laisse un peu de choix et les routines de pagination ne sont pas conçues pour une pagination efficace via des jeux de résultats volumineux.</span><span class="sxs-lookup"><span data-stu-id="e1a61-115">Unfortunately, this simplistic implementation has its drawbacks the sorting interface leaves a bit to be desired and the paging routines are not designed for efficiently paging through large result sets.</span></span> <span data-ttu-id="e1a61-116">Les prochains didacticiels découvriront comment surmonter les limitations des solutions de pagination et de tri prêtes à l’emploi.</span><span class="sxs-lookup"><span data-stu-id="e1a61-116">Future tutorials will explore how to overcome the limitations of the out-of-the-box paging and sorting solutions.</span></span>

## <a name="step-1-adding-the-paging-and-sorting-tutorial-web-pages"></a><span data-ttu-id="e1a61-117">Étape 1 : ajout des pages Web du didacticiel de pagination et de tri</span><span class="sxs-lookup"><span data-stu-id="e1a61-117">Step 1: Adding the Paging and Sorting Tutorial Web Pages</span></span>

<span data-ttu-id="e1a61-118">Avant de commencer ce didacticiel, nous allons tout d’abord prendre un moment pour ajouter les pages ASP.NET dont nous aurons besoin pour ce didacticiel et les trois prochaines.</span><span class="sxs-lookup"><span data-stu-id="e1a61-118">Before we start this tutorial, let s first take a moment to add the ASP.NET pages we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="e1a61-119">Commencez par créer un nouveau dossier dans le projet nommé `PagingAndSorting`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-119">Start by creating a new folder in the project named `PagingAndSorting`.</span></span> <span data-ttu-id="e1a61-120">Ensuite, ajoutez les cinq pages ASP.NET suivantes à ce dossier, en faisant en sorte qu’elles soient toutes configurées pour utiliser la page maître `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="e1a61-120">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `SimplePagingSorting.aspx`
- `EfficientPaging.aspx`
- `SortParameter.aspx`
- `CustomSortingUI.aspx`

![Créer un dossier PagingAndSorting et ajouter les pages du didacticiel ASP.NET](paging-and-sorting-report-data-vb/_static/image1.png)

<span data-ttu-id="e1a61-122">**Figure 1**: créer un dossier PagingAndSorting et ajouter les pages du didacticiel ASP.net</span><span class="sxs-lookup"><span data-stu-id="e1a61-122">**Figure 1**: Create a PagingAndSorting Folder and Add the Tutorial ASP.NET Pages</span></span>

<span data-ttu-id="e1a61-123">Ensuite, ouvrez la page `Default.aspx`, puis faites glisser le contrôle utilisateur `SectionLevelTutorialListing.ascx` à partir du dossier `UserControls` sur l’aire de conception.</span><span class="sxs-lookup"><span data-stu-id="e1a61-123">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="e1a61-124">Ce contrôle utilisateur, que nous avons créé dans le didacticiel sur les [pages maîtres et la navigation](../introduction/master-pages-and-site-navigation-vb.md) dans les sites, énumère le plan du site et affiche ces didacticiels dans la section actuelle d’une liste à puces.</span><span class="sxs-lookup"><span data-stu-id="e1a61-124">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays those tutorials in the current section in a bulleted list.</span></span>

![Ajouter le contrôle utilisateur SectionLevelTutorialListing. ascx à default. aspx](paging-and-sorting-report-data-vb/_static/image2.png)

<span data-ttu-id="e1a61-126">**Figure 2**: ajouter le contrôle utilisateur SectionLevelTutorialListing. ascx à default. aspx</span><span class="sxs-lookup"><span data-stu-id="e1a61-126">**Figure 2**: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx</span></span>

<span data-ttu-id="e1a61-127">Pour que la liste à puces affiche les didacticiels de pagination et de tri que nous allons créer, vous devez les ajouter au plan du site.</span><span class="sxs-lookup"><span data-stu-id="e1a61-127">In order to have the bulleted list display the paging and sorting tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="e1a61-128">Ouvrez le fichier `Web.sitemap` et ajoutez le balisage suivant après la modification, l’insertion et la suppression du balisage de nœud de plan de site :</span><span class="sxs-lookup"><span data-stu-id="e1a61-128">Open the `Web.sitemap` file and add the following markup after the Editing, Inserting, and Deleting site map node markup:</span></span>

[!code-xml[Main](paging-and-sorting-report-data-vb/samples/sample1.xml)]

![Mettre à jour le plan du site pour inclure les nouvelles pages ASP.NET](paging-and-sorting-report-data-vb/_static/image3.png)

<span data-ttu-id="e1a61-130">**Figure 3**: mettre à jour le plan du site pour inclure les nouvelles pages ASP.net</span><span class="sxs-lookup"><span data-stu-id="e1a61-130">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>

## <a name="step-2-displaying-product-information-in-a-gridview"></a><span data-ttu-id="e1a61-131">Étape 2 : affichage des informations sur le produit dans un GridView</span><span class="sxs-lookup"><span data-stu-id="e1a61-131">Step 2: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="e1a61-132">Avant d’implémenter les fonctionnalités de pagination et de tri, nous allons tout d’abord créer un contrôle GridView non pouvant être trié et non paginable standard qui répertorie les informations sur le produit.</span><span class="sxs-lookup"><span data-stu-id="e1a61-132">Before we actually implement paging and sorting capabilities, let s first create a standard non-sortable, non-pageable GridView that lists the product information.</span></span> <span data-ttu-id="e1a61-133">Il s’agit d’une tâche que nous avons effectuée beaucoup de fois dans cette série de didacticiels pour que ces étapes soient familières.</span><span class="sxs-lookup"><span data-stu-id="e1a61-133">This is a task we ve done many times before throughout this tutorial series so these steps should be familiar.</span></span> <span data-ttu-id="e1a61-134">Commencez par ouvrir la page de `SimplePagingSorting.aspx` et faites glisser un contrôle GridView de la boîte à outils vers le concepteur, en affectant à sa propriété `ID` la valeur `Products`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-134">Start by opening the `SimplePagingSorting.aspx` page and drag a GridView control from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="e1a61-135">Ensuite, créez un ObjectDataSource qui utilise la méthode ProductsBLL Class s `GetProducts()` pour retourner toutes les informations sur le produit.</span><span class="sxs-lookup"><span data-stu-id="e1a61-135">Next, create a new ObjectDataSource that uses the ProductsBLL class s `GetProducts()` method to return all of the product information.</span></span>

![Récupérer des informations sur tous les produits à l’aide de la méthode GetProducts ()](paging-and-sorting-report-data-vb/_static/image4.png)

<span data-ttu-id="e1a61-137">**Figure 4**: récupérer des informations sur tous les produits à l’aide de la méthode GetProducts ()</span><span class="sxs-lookup"><span data-stu-id="e1a61-137">**Figure 4**: Retrieve Information About All of the Products Using the GetProducts() Method</span></span>

<span data-ttu-id="e1a61-138">Étant donné que ce rapport est un rapport en lecture seule, il n’est pas nécessaire de mapper les méthodes de `Insert()`, `Update()`ou de `Delete()` ObjectDataSource aux méthodes `ProductsBLL` correspondantes ; par conséquent, choisissez (aucun) dans la liste déroulante des onglets mettre à jour, insérer et supprimer.</span><span class="sxs-lookup"><span data-stu-id="e1a61-138">Since this report is a read-only report, there s no need to map the ObjectDataSource s `Insert()`, `Update()`, or `Delete()` methods to corresponding `ProductsBLL` methods; therefore, choose (None) from the drop-down list for the UPDATE, INSERT, and DELETE tabs.</span></span>

![Choisissez l’option (aucune) dans la liste déroulante des onglets mettre à jour, insérer et supprimer](paging-and-sorting-report-data-vb/_static/image5.png)

<span data-ttu-id="e1a61-140">**Figure 5**: sélectionner l’option (aucune) dans la liste déroulante des onglets mettre à jour, insérer et supprimer</span><span class="sxs-lookup"><span data-stu-id="e1a61-140">**Figure 5**: Choose the (None) Option in the Drop-Down List in the UPDATE, INSERT, and DELETE Tabs</span></span>

<span data-ttu-id="e1a61-141">Ensuite, nous allons personnaliser les champs GridView s afin que seuls les noms des produits, les fournisseurs, les catégories, les prix et les États abandonnés s’affichent.</span><span class="sxs-lookup"><span data-stu-id="e1a61-141">Next, let s customize the GridView s fields so that only the products names, suppliers, categories, prices, and discontinued statuses are displayed.</span></span> <span data-ttu-id="e1a61-142">En outre, n’hésitez pas à apporter des modifications de mise en forme au niveau des champs, telles que l’ajustement des propriétés de `HeaderText` ou la mise en forme du prix en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="e1a61-142">Furthermore, feel free to make any field-level formatting changes, such as adjusting the `HeaderText` properties or formatting the price as a currency.</span></span> <span data-ttu-id="e1a61-143">Une fois ces modifications effectuées, votre balisage déclaratif s doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="e1a61-143">After these changes, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample2.aspx)]

<span data-ttu-id="e1a61-144">La figure 6 montre notre progression jusqu’à présent dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="e1a61-144">Figure 6 shows our progress thus far when viewed through a browser.</span></span> <span data-ttu-id="e1a61-145">Notez que la page répertorie tous les produits dans un seul écran, indiquant chaque nom de produit, catégorie, fournisseur, prix et état abandonné.</span><span class="sxs-lookup"><span data-stu-id="e1a61-145">Note that the page lists all of the products in one screen, showing each product s name, category, supplier, price, and discontinued status.</span></span>

<span data-ttu-id="e1a61-146">[![chacun des produits est répertorié](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-146">[![Each of the Products are Listed](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span></span>

<span data-ttu-id="e1a61-147">**Figure 6**: chaque produit est répertorié ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-147">**Figure 6**: Each of the Products are Listed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image8.png))</span></span>

## <a name="step-3-adding-paging-support"></a><span data-ttu-id="e1a61-148">Étape 3 : ajout de la prise en charge de la pagination</span><span class="sxs-lookup"><span data-stu-id="e1a61-148">Step 3: Adding Paging Support</span></span>

<span data-ttu-id="e1a61-149">La liste de *tous* les produits sur un seul écran peut entraîner une surcharge d’informations pour l’utilisateur qui utilise les données.</span><span class="sxs-lookup"><span data-stu-id="e1a61-149">Listing *all* of the products on one screen can lead to information overload for the user perusing the data.</span></span> <span data-ttu-id="e1a61-150">Pour faciliter la gestion des résultats, nous pouvons diviser les données en pages de données plus petites et permettre à l’utilisateur de parcourir les données une page à la fois.</span><span class="sxs-lookup"><span data-stu-id="e1a61-150">To help make the results more manageable, we can break up the data into smaller pages of data and allow the user to step through the data one page at a time.</span></span> <span data-ttu-id="e1a61-151">Pour ce faire, cochez la case Activer la pagination de la balise active GridView s (cela définit la [propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx) gridview s`AllowPaging` sur `true`).</span><span class="sxs-lookup"><span data-stu-id="e1a61-151">To accomplish this simply check the Enable Paging checkbox from the GridView s smart tag (this sets the GridView s [`AllowPaging` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx) to `true`).</span></span>

<span data-ttu-id="e1a61-152">[![activez la case à cocher Activer la pagination pour ajouter la prise en charge de la pagination](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-152">[![Check the Enable Paging Checkbox to Add Paging Support](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="e1a61-153">**Figure 7**: cochez la case Activer la pagination pour ajouter la prise en charge de la pagination ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-153">**Figure 7**: Check the Enable Paging Checkbox to Add Paging Support ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="e1a61-154">L’activation de la pagination limite le nombre d’enregistrements affichés par page et ajoute une *interface de pagination* au GridView.</span><span class="sxs-lookup"><span data-stu-id="e1a61-154">Enabling paging limits the number of records shown per page and adds a *paging interface* to the GridView.</span></span> <span data-ttu-id="e1a61-155">L’interface de pagination par défaut, illustrée à la figure 7, est une série de numéros de page, ce qui permet à l’utilisateur de naviguer rapidement d’une page de données à une autre.</span><span class="sxs-lookup"><span data-stu-id="e1a61-155">The default paging interface, shown in Figure 7, is a series of page numbers, allowing the user to quickly navigate from one page of data to another.</span></span> <span data-ttu-id="e1a61-156">Cette interface de pagination doit vous sembler familière, comme nous l’avons vu lors de l’ajout de la prise en charge de la pagination aux contrôles DetailsView et FormView dans les didacticiels précédents.</span><span class="sxs-lookup"><span data-stu-id="e1a61-156">This paging interface should look familiar, as we ve seen it when adding paging support to the DetailsView and FormView controls in past tutorials.</span></span>

<span data-ttu-id="e1a61-157">Les contrôles DetailsView et FormView n’affichent qu’un seul enregistrement par page.</span><span class="sxs-lookup"><span data-stu-id="e1a61-157">Both the DetailsView and FormView controls only show a single record per page.</span></span> <span data-ttu-id="e1a61-158">Toutefois, le GridView consulte sa [propriété`PageSize`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx) pour déterminer le nombre d’enregistrements à afficher par page (la valeur par défaut de cette propriété est 10).</span><span class="sxs-lookup"><span data-stu-id="e1a61-158">The GridView, however, consults its [`PageSize` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx) to determine how many records to show per page (this property defaults to a value of 10).</span></span>

<span data-ttu-id="e1a61-159">Cette interface de pagination GridView, DetailsView et FormView peut être personnalisée à l’aide des propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="e1a61-159">This GridView, DetailsView, and FormView s paging interface can be customized using the following properties:</span></span>

- <span data-ttu-id="e1a61-160">`PagerStyle` indique les informations de style pour l’interface de pagination ; peut spécifier des paramètres comme `BackColor`, `ForeColor`, `CssClass`, `HorizontalAlign`, etc.</span><span class="sxs-lookup"><span data-stu-id="e1a61-160">`PagerStyle` indicates the style information for the paging interface; can specify settings like `BackColor`, `ForeColor`, `CssClass`, `HorizontalAlign`, and so on.</span></span>
- <span data-ttu-id="e1a61-161">`PagerSettings` contient un multitude de propriétés qui peut personnaliser les fonctionnalités de l’interface de pagination. `PageButtonCount` indique le nombre maximal de numéros de page numériques affichés dans l’interface de pagination (la valeur par défaut est 10); la [propriété`Mode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx) indique le fonctionnement de l’interface de pagination et peut avoir la valeur :</span><span class="sxs-lookup"><span data-stu-id="e1a61-161">`PagerSettings` contains a bevy of properties that can customize the functionality of the paging interface; `PageButtonCount` indicates the maximum number of numeric page numbers displayed in the paging interface (the default is 10); the [`Mode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx) indicates how the paging interface operates and can be set to:</span></span> 

    - <span data-ttu-id="e1a61-162">`NextPrevious` affiche les boutons suivant et précédent, ce qui permet à l’utilisateur d’avancer ou de reculer d’une page à la fois.</span><span class="sxs-lookup"><span data-stu-id="e1a61-162">`NextPrevious` shows a Next and Previous buttons, allowing the user to step forwards or backwards one page at a time</span></span>
    - <span data-ttu-id="e1a61-163">`NextPreviousFirstLast` en plus des boutons suivant et précédent, le premier et le dernier bouton sont également inclus, ce qui permet à l’utilisateur de passer rapidement à la première ou dernière page de données.</span><span class="sxs-lookup"><span data-stu-id="e1a61-163">`NextPreviousFirstLast` in addition to Next and Previous buttons, First and Last buttons are also included, allowing the user to quickly move to the first or last page of data</span></span>
    - <span data-ttu-id="e1a61-164">`Numeric` affiche une série de numéros de page, ce qui permet à l’utilisateur d’accéder immédiatement à n’importe quelle page</span><span class="sxs-lookup"><span data-stu-id="e1a61-164">`Numeric` shows a series of page numbers, allowing the user to immediately jump to any page</span></span>
    - <span data-ttu-id="e1a61-165">`NumericFirstLast` en plus des numéros de page, comprend les boutons premier et dernier, ce qui permet à l’utilisateur de passer rapidement à la première ou à la dernière page de données ; les premier et dernier boutons s’affichent uniquement si tous les numéros de page numériques ne sont pas adaptés</span><span class="sxs-lookup"><span data-stu-id="e1a61-165">`NumericFirstLast` in addition to the page numbers, includes First and Last buttons, allowing the user to quickly move to the first or last page of data; the First/Last buttons are only shown if all of the numeric page numbers cannot fit</span></span>

<span data-ttu-id="e1a61-166">En outre, les propriétés GridView, DetailsView et FormView offrent toutes les propriétés `PageIndex` et `PageCount`, qui indiquent respectivement la page actuelle affichée et le nombre total de pages de données.</span><span class="sxs-lookup"><span data-stu-id="e1a61-166">Moreover, the GridView, DetailsView, and FormView all offer the `PageIndex` and `PageCount` properties, which indicate the current page being viewed and the total number of pages of data, respectively.</span></span> <span data-ttu-id="e1a61-167">La propriété `PageIndex` est indexée à partir de 0, ce qui signifie que lorsque vous affichez la première page de données, `PageIndex` est égal à 0.</span><span class="sxs-lookup"><span data-stu-id="e1a61-167">The `PageIndex` property is indexed starting at 0, meaning that when viewing the first page of data `PageIndex` will equal 0.</span></span> <span data-ttu-id="e1a61-168">`PageCount`, en revanche, commence à compter à 1, ce qui signifie que `PageIndex` est limitée aux valeurs comprises entre 0 et `PageCount - 1`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-168">`PageCount`, on the other hand, starts counting at 1, meaning that `PageIndex` is limited to the values between 0 and `PageCount - 1`.</span></span>

<span data-ttu-id="e1a61-169">Essayons quelques instants pour améliorer l’apparence par défaut de notre interface de pagination de GridView s.</span><span class="sxs-lookup"><span data-stu-id="e1a61-169">Let s take a moment to improve the default appearance of our GridView s paging interface.</span></span> <span data-ttu-id="e1a61-170">En particulier, faites en sorte que l’interface de pagination soit alignée à droite avec un arrière-plan gris clair.</span><span class="sxs-lookup"><span data-stu-id="e1a61-170">Specifically, let s have the paging interface right-aligned with a light gray background.</span></span> <span data-ttu-id="e1a61-171">Au lieu de définir ces propriétés directement par le biais de la propriété GridView s `PagerStyle`, créez une classe CSS dans `Styles.css` nommée `PagerRowStyle`, puis affectez la propriété `PagerStyle` s `CssClass` par le biais de notre thème.</span><span class="sxs-lookup"><span data-stu-id="e1a61-171">Rather than setting these properties directly through the GridView s `PagerStyle` property, let s create a CSS class in `Styles.css` named `PagerRowStyle` and then assign the `PagerStyle` s `CssClass` property through our Theme.</span></span> <span data-ttu-id="e1a61-172">Commencez par ouvrir `Styles.css` et ajoutez la définition de classe CSS suivante :</span><span class="sxs-lookup"><span data-stu-id="e1a61-172">Start by opening `Styles.css` and adding the following CSS class definition:</span></span>

[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample3.css)]

<span data-ttu-id="e1a61-173">Ensuite, ouvrez le fichier `GridView.skin` dans le dossier `DataWebControls` dans le dossier `App_Themes`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-173">Next, open the `GridView.skin` file in the `DataWebControls` folder within the `App_Themes` folder.</span></span> <span data-ttu-id="e1a61-174">Comme nous l’avons vu dans le didacticiel sur les *pages maîtres et la navigation* dans les sites, les fichiers d’apparence peuvent être utilisés pour spécifier les valeurs de propriété par défaut d’un contrôle Web.</span><span class="sxs-lookup"><span data-stu-id="e1a61-174">As we discussed in the *Master Pages and Site Navigation* tutorial, Skin files can be used to specify the default property values for a Web control.</span></span> <span data-ttu-id="e1a61-175">Par conséquent, augmentez les paramètres existants pour inclure la définition de la propriété `PagerStyle` s `CssClass` sur `PagerRowStyle`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-175">Therefore, augment the existing settings to include setting the `PagerStyle` s `CssClass` property to `PagerRowStyle`.</span></span> <span data-ttu-id="e1a61-176">En outre, configurez l’interface de pagination pour afficher au maximum cinq boutons de page numériques à l’aide de l’interface de pagination `NumericFirstLast`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-176">Also, let s configure the paging interface to show at most five numeric page buttons using the `NumericFirstLast` paging interface.</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample4.aspx)]

## <a name="the-paging-user-experience"></a><span data-ttu-id="e1a61-177">L’expérience utilisateur de pagination</span><span class="sxs-lookup"><span data-stu-id="e1a61-177">The Paging User Experience</span></span>

<span data-ttu-id="e1a61-178">La figure 8 illustre la page Web lorsqu’elle est visitée via un navigateur après la vérification de la case à cocher de la pagination de GridView s et que les configurations `PagerStyle` et `PagerSettings` ont été effectuées par le biais du fichier `GridView.skin`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-178">Figure 8 shows the web page when visited through a browser after the GridView s Enable Paging checkbox has been checked and the `PagerStyle` and `PagerSettings` configurations have been made through the `GridView.skin` file.</span></span> <span data-ttu-id="e1a61-179">Notez que seuls dix enregistrements sont affichés et que l’interface de pagination indique que nous affichons la première page de données.</span><span class="sxs-lookup"><span data-stu-id="e1a61-179">Note how only ten records are shown, and the paging interface indicates that we are viewing the first page of data.</span></span>

<span data-ttu-id="e1a61-180">[![avec la pagination activée, seul un sous-ensemble des enregistrements s’affiche à la fois.](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-180">[![With Paging Enabled, Only a Subset of the Records are Displayed at a Time](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="e1a61-181">**Figure 8**: lorsque la pagination est activée, seul un sous-ensemble des enregistrements s’affiche à la fois ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-181">**Figure 8**: With Paging Enabled, Only a Subset of the Records are Displayed at a Time ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="e1a61-182">Lorsque l’utilisateur clique sur l’un des numéros de page dans l’interface de pagination, une publication (postback) est effectuée et les rechargements de page indiquent les enregistrements de la page demandée.</span><span class="sxs-lookup"><span data-stu-id="e1a61-182">When the user clicks on one of the page numbers in the paging interface, a postback ensues and the page reloads showing that requested page s records.</span></span> <span data-ttu-id="e1a61-183">La figure 9 montre les résultats après avoir choisi d’afficher la dernière page de données.</span><span class="sxs-lookup"><span data-stu-id="e1a61-183">Figure 9 shows the results after opting to view the final page of data.</span></span> <span data-ttu-id="e1a61-184">Notez que la dernière page n’a qu’un seul enregistrement ; Cela est dû au fait qu’il y a 81 enregistrements au total, ce qui aboutit à huit pages de 10 enregistrements par page, plus une page avec un enregistrement solitaire.</span><span class="sxs-lookup"><span data-stu-id="e1a61-184">Notice that the final page only has one record; this is because there are 81 records in total, resulting in eight pages of 10 records per page plus one page with a lone record.</span></span>

<span data-ttu-id="e1a61-185">[![le fait de cliquer sur un numéro de page provoque une publication et affiche le sous-ensemble approprié d’enregistrements](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-185">[![Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="e1a61-186">**Figure 9**: un clic sur un numéro de page entraîne une publication (postback) et affiche le sous-ensemble approprié d’enregistrements ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-186">**Figure 9**: Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image17.png))</span></span>

## <a name="paging-s-server-side-workflow"></a><span data-ttu-id="e1a61-187">Pagination du flux de travail côté serveur</span><span class="sxs-lookup"><span data-stu-id="e1a61-187">Paging s Server-Side Workflow</span></span>

<span data-ttu-id="e1a61-188">Lorsque l’utilisateur final clique sur un bouton dans l’interface de pagination, une publication (postback) est effectuée et le flux de travail côté serveur suivant commence :</span><span class="sxs-lookup"><span data-stu-id="e1a61-188">When the end user clicks on a button in the paging interface, a postback ensues and the following server-side workflow begins:</span></span>

1. <span data-ttu-id="e1a61-189">L’événement `PageIndexChanging` GridView s (ou DetailsView ou FormView) est déclenché</span><span class="sxs-lookup"><span data-stu-id="e1a61-189">The GridView s (or DetailsView or FormView) `PageIndexChanging` event fires</span></span>
2. <span data-ttu-id="e1a61-190">ObjectDataSource redemande *toutes* les données de la couche BLL ; les valeurs de propriété GridView s `PageIndex` et `PageSize` sont utilisées pour déterminer les enregistrements retournés par la couche BLL qui doivent être affichés dans le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="e1a61-190">The ObjectDataSource re-requests *all* of the data from the BLL; the GridView s `PageIndex` and `PageSize` property values are used to determine what records returned from the BLL need to be displayed in the GridView</span></span>
3. <span data-ttu-id="e1a61-191">L’événement `PageIndexChanged` GridView s est déclenché</span><span class="sxs-lookup"><span data-stu-id="e1a61-191">The GridView s `PageIndexChanged` event fires</span></span>

<span data-ttu-id="e1a61-192">À l’étape 2, ObjectDataSource redemande toutes les données de sa source de données.</span><span class="sxs-lookup"><span data-stu-id="e1a61-192">In Step 2, the ObjectDataSource re-requests all of the data from its data source.</span></span> <span data-ttu-id="e1a61-193">Ce style de pagination est communément appelé *pagination par défaut*, car il s’agit du comportement de pagination utilisé par défaut lors de la définition de la propriété `AllowPaging` sur `true`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-193">This style of paging is commonly referred to as *default paging*, as it s the paging behavior used by default when setting the `AllowPaging` property to `true`.</span></span> <span data-ttu-id="e1a61-194">Avec la pagination par défaut, le contrôle Web de données naïvement récupère tous les enregistrements pour chaque page de données, même si seul un sous-ensemble d’enregistrements est effectivement rendu dans le code HTML qui est envoyé au navigateur.</span><span class="sxs-lookup"><span data-stu-id="e1a61-194">With default paging the data Web control naively retrieves all records for each page of data, even though only a subset of records are actually rendered into the HTML that s sent to the browser.</span></span> <span data-ttu-id="e1a61-195">À moins que les données de la base de données ne soient mises en cache par la couche BLL ou ObjectDataSource, la pagination par défaut est impossible pour les jeux de résultats suffisamment volumineux ou pour les applications Web avec un grand nombre d’utilisateurs simultanés.</span><span class="sxs-lookup"><span data-stu-id="e1a61-195">Unless the database data is cached by the BLL or ObjectDataSource, default paging is unworkable for sufficiently large result sets or for web applications with many concurrent users.</span></span>

<span data-ttu-id="e1a61-196">Dans le didacticiel suivant, nous allons examiner comment implémenter la *pagination personnalisée*.</span><span class="sxs-lookup"><span data-stu-id="e1a61-196">In the next tutorial we'll examine how to implement *custom paging*.</span></span> <span data-ttu-id="e1a61-197">Avec la pagination personnalisée, vous pouvez demander spécifiquement à ObjectDataSource de récupérer uniquement l’ensemble précis des enregistrements nécessaires pour la page de données demandée.</span><span class="sxs-lookup"><span data-stu-id="e1a61-197">With custom paging you can specifically instruct the ObjectDataSource to only retrieve the precise set of records needed for the requested page of data.</span></span> <span data-ttu-id="e1a61-198">Comme vous pouvez l’imaginer, la pagination personnalisée améliore considérablement l’efficacité de la pagination par le biais de jeux de résultats volumineux.</span><span class="sxs-lookup"><span data-stu-id="e1a61-198">As you can imagine, custom paging greatly improves the efficiency of paging through large result sets.</span></span>

> [!NOTE]
> <span data-ttu-id="e1a61-199">Bien que la pagination par défaut ne soit pas appropriée lors de la pagination de jeux de résultats suffisamment volumineux ou pour des sites avec de nombreux utilisateurs simultanés, sachez que la pagination personnalisée nécessite plus de modifications et d’efforts pour implémenter et n’est pas aussi simple que d’activer une case à cocher (par défaut pagination).</span><span class="sxs-lookup"><span data-stu-id="e1a61-199">While default paging is not suitable when paging through sufficiently large result sets or for sites with many simultaneous users, realize that custom paging requires more changes and effort to implement and is not as simple as checking a checkbox (as is default paging).</span></span> <span data-ttu-id="e1a61-200">Par conséquent, la pagination par défaut peut être le choix idéal pour les petits sites Web à faible trafic ou pour la pagination via des jeux de résultats relativement petits, car elle est beaucoup plus facile et plus rapide à mettre en œuvre.</span><span class="sxs-lookup"><span data-stu-id="e1a61-200">Therefore, default paging may be the ideal choice for small, low-traffic websites or when paging through relatively small result sets, as it s much easier and quicker to implement.</span></span>

<span data-ttu-id="e1a61-201">Par exemple, si nous savons que nous n’aurons jamais plus de 100 produits dans notre base de données, le gain de performances minimal apprécié par la pagination personnalisée est probablement compensé par l’effort nécessaire pour l’implémenter.</span><span class="sxs-lookup"><span data-stu-id="e1a61-201">For example, if we know that we'll never have more than 100 products in our database, the minimal performance gain enjoyed by custom paging is likely offset by the effort required to implement it.</span></span> <span data-ttu-id="e1a61-202">Toutefois, si nous avons un jour qui a des milliers ou des dizaines de milliers de produits, le *non* -déploiement de la pagination personnalisée risquerait de nuire à l’évolutivité de notre application.</span><span class="sxs-lookup"><span data-stu-id="e1a61-202">If, however, we may one day have thousands or tens of thousands of products, *not* implementing custom paging would greatly hamper the scalability of our application.</span></span>

## <a name="step-4-customizing-the-paging-experience"></a><span data-ttu-id="e1a61-203">Étape 4 : personnalisation de l’expérience de pagination</span><span class="sxs-lookup"><span data-stu-id="e1a61-203">Step 4: Customizing the Paging Experience</span></span>

<span data-ttu-id="e1a61-204">Les contrôles Web de données fournissent un certain nombre de propriétés qui peuvent être utilisées pour améliorer l’expérience de pagination des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="e1a61-204">The data Web controls provide a number of properties that can be used to enhance the user s paging experience.</span></span> <span data-ttu-id="e1a61-205">La propriété `PageCount`, par exemple, indique le nombre total de pages, tandis que la propriété `PageIndex` indique la page actuellement visitée et peut être définie pour déplacer rapidement un utilisateur vers une page spécifique.</span><span class="sxs-lookup"><span data-stu-id="e1a61-205">The `PageCount` property, for example, indicates how many total pages there are, while the `PageIndex` property indicates the current page being visited and can be set to quickly move a user to a specific page.</span></span> <span data-ttu-id="e1a61-206">Pour illustrer comment utiliser ces propriétés pour améliorer l’expérience de pagination des utilisateurs, ajoutez un contrôle Web Label à notre page pour informer l’utilisateur de la page visitée, ainsi qu’un contrôle DropDownList qui lui permet d’accéder rapidement à une page donnée. .</span><span class="sxs-lookup"><span data-stu-id="e1a61-206">To illustrate how to use these properties to improve upon the user s paging experience, let s add a Label Web control to our page that informs the user what page they re currently visiting, along with a DropDownList control that allows them to quickly jump to any given page.</span></span>

<span data-ttu-id="e1a61-207">Tout d’abord, ajoutez un contrôle Web Label à votre page, affectez à sa propriété `ID` la valeur `PagingInformation`et effacez sa propriété `Text`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-207">First, add a Label Web control to your page, set its `ID` property to `PagingInformation`, and clear out its `Text` property.</span></span> <span data-ttu-id="e1a61-208">Ensuite, créez un gestionnaire d’événements pour l’événement `DataBound` GridView s et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e1a61-208">Next, create an event handler for the GridView s `DataBound` event and add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample5.vb)]

<span data-ttu-id="e1a61-209">Ce gestionnaire d’événements affecte la propriété `PagingInformation` étiquette s `Text` à un message informant l’utilisateur que la page sur laquelle il est actuellement visité `Products.PageIndex + 1` le nombre total de pages `Products.PageCount` (nous ajoutons 1 à la propriété `Products.PageIndex`, car `PageIndex` est indexé à partir de 0).</span><span class="sxs-lookup"><span data-stu-id="e1a61-209">This event handler assigns the `PagingInformation` Label s `Text` property to a message informing the user the page they are currently visiting `Products.PageIndex + 1` out of how many total pages `Products.PageCount` (we add 1 to the `Products.PageIndex` property because `PageIndex` is indexed starting at 0).</span></span> <span data-ttu-id="e1a61-210">J’ai choisi la propriété assigner cette étiquette `Text` dans le gestionnaire d’événements `DataBound` au lieu du gestionnaire d’événements `PageIndexChanged`, car l’événement `DataBound` se déclenche chaque fois que des données sont liées au GridView alors que le gestionnaire d’événements `PageIndexChanged` se déclenche uniquement lorsque l’index de page est modifié.</span><span class="sxs-lookup"><span data-stu-id="e1a61-210">I chose the assign this Label s `Text` property in the `DataBound` event handler as opposed to the `PageIndexChanged` event handler because the `DataBound` event fires every time data is bound to the GridView whereas the `PageIndexChanged` event handler only fires when the page index is changed.</span></span> <span data-ttu-id="e1a61-211">Lorsque le GridView est initialement lié aux données sur la première page, l’événement `PageIndexChanging` ne se déclenche pas (contrairement à l’événement `DataBound`).</span><span class="sxs-lookup"><span data-stu-id="e1a61-211">When the GridView is initially data bound on the first page visit, the `PageIndexChanging` event doesn t fire (whereas the `DataBound` event does).</span></span>

<span data-ttu-id="e1a61-212">Avec cet ajout, l’utilisateur affiche maintenant un message indiquant la page visitée et le nombre total de pages de données qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="e1a61-212">With this addition, the user is now shown a message indicating what page they are visiting and how many total pages of data there are.</span></span>

<span data-ttu-id="e1a61-213">[![le numéro de page actuel et le nombre total de pages affichées](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-213">[![The Current Page Number and Total Number of Pages are Displayed](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="e1a61-214">**Figure 10**: le numéro de page actuel et le nombre total de pages s’affichent ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-214">**Figure 10**: The Current Page Number and Total Number of Pages are Displayed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="e1a61-215">En plus du contrôle Label, les autres ajoutent également un contrôle DropDownList qui répertorie les numéros de page dans le GridView avec la page actuellement affichée sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e1a61-215">In addition to the Label control, let s also add a DropDownList control that lists the page numbers in the GridView with the currently viewed page selected.</span></span> <span data-ttu-id="e1a61-216">L’idée est que l’utilisateur peut rapidement passer de la page actuelle à une autre en sélectionnant simplement le nouvel index de page dans le DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e1a61-216">The idea here is that the user can quickly jump from the current page to another by simply selecting the new page index from the DropDownList.</span></span> <span data-ttu-id="e1a61-217">Commencez par ajouter un contrôle DropDownList au concepteur, en affectant à sa propriété `ID` la valeur `PageList` et en activant l’option Activer AutoPostBack à partir de sa balise active.</span><span class="sxs-lookup"><span data-stu-id="e1a61-217">Start by adding a DropDownList to the Designer, setting its `ID` property to `PageList` and checking the Enable AutoPostBack option from its smart tag.</span></span>

<span data-ttu-id="e1a61-218">Ensuite, revenez au gestionnaire d’événements `DataBound` et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e1a61-218">Next, return to the `DataBound` event handler and add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample6.vb)]

<span data-ttu-id="e1a61-219">Ce code commence par effacer les éléments dans le `PageList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e1a61-219">This code begins by clearing out the items in the `PageList` DropDownList.</span></span> <span data-ttu-id="e1a61-220">Cela peut paraître superflu, car il n’est pas prévu que le nombre de pages change, mais d’autres utilisateurs utilisent le système simultanément, en ajoutant ou en supprimant des enregistrements de la table `Products`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-220">This may seem superfluous, since one wouldn't expect the number of pages to change, but other users may be using the system simultaneously, adding or removing records from the `Products` table.</span></span> <span data-ttu-id="e1a61-221">De telles insertions ou suppressions pourraient altérer le nombre de pages de données.</span><span class="sxs-lookup"><span data-stu-id="e1a61-221">Such insertions or deletions could alter the number of pages of data.</span></span>

<span data-ttu-id="e1a61-222">Ensuite, nous devons recréer les numéros de page et avoir celui qui est mappé au GridView actuel `PageIndex` sélectionné par défaut.</span><span class="sxs-lookup"><span data-stu-id="e1a61-222">Next, we need to create the page numbers again and have the one that maps to the current GridView `PageIndex` selected by default.</span></span> <span data-ttu-id="e1a61-223">Nous faisons cela avec une boucle comprise entre 0 et `PageCount - 1`, en ajoutant un nouveau `ListItem` dans chaque itération et en définissant sa propriété `Selected` sur true si l’index d’itération actuel est égal à la propriété GridView s `PageIndex`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-223">We accomplish this with a loop from 0 to `PageCount - 1`, adding a new `ListItem` in each iteration and setting its `Selected` property to true if the current iteration index equals the GridView s `PageIndex` property.</span></span>

<span data-ttu-id="e1a61-224">Enfin, nous devons créer un gestionnaire d’événements pour l’événement DropDownList s `SelectedIndexChanged`, qui se déclenche chaque fois que l’utilisateur choisit un élément différent dans la liste.</span><span class="sxs-lookup"><span data-stu-id="e1a61-224">Finally, we need to create an event handler for the DropDownList s `SelectedIndexChanged` event, which fires each time the user pick a different item from the list.</span></span> <span data-ttu-id="e1a61-225">Pour créer ce gestionnaire d’événements, il vous suffit de double-cliquer sur le DropDownList dans le concepteur, puis d’ajouter le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e1a61-225">To create this event handler, simply double-click the DropDownList in the Designer, then add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample7.vb)]

<span data-ttu-id="e1a61-226">Comme le montre la figure 11, le simple fait de modifier la propriété GridView s `PageIndex` entraîne la reliaison des données au contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="e1a61-226">As Figure 11 shows, merely changing the GridView s `PageIndex` property causes the data to be rebound to the GridView.</span></span> <span data-ttu-id="e1a61-227">Dans le gestionnaire d’événements `DataBound` GridView s, la `ListItem` DropDownList appropriée est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e1a61-227">In the GridView s `DataBound` event handler, the appropriate DropDownList `ListItem` is selected.</span></span>

<span data-ttu-id="e1a61-228">[![l’utilisateur est automatiquement dirigé vers la sixième page lors de la sélection de l’élément de liste déroulante page 6](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-228">[![The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="e1a61-229">**Figure 11**: l’utilisateur est automatiquement dirigé vers la sixième page lors de la sélection de l’élément de liste déroulante page 6 ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-229">**Figure 11**: The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image23.png))</span></span>

## <a name="step-5-adding-bi-directional-sorting-support"></a><span data-ttu-id="e1a61-230">Étape 5 : ajout de la prise en charge du tri bidirectionnel</span><span class="sxs-lookup"><span data-stu-id="e1a61-230">Step 5: Adding Bi-Directional Sorting Support</span></span>

<span data-ttu-id="e1a61-231">L’ajout de la prise en charge du tri bidirectionnel est aussi simple que l’ajout de la prise en charge de la pagination. activez simplement l’option Activer le tri à partir de la balise active de GridView s (qui affecte à la propriété GridView s [`AllowSorting`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx) la valeur `true`).</span><span class="sxs-lookup"><span data-stu-id="e1a61-231">Adding bi-directional sorting support is as simple as adding paging support simply check the Enable Sorting option from the GridView s smart tag (which sets the GridView s [`AllowSorting` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx) to `true`).</span></span> <span data-ttu-id="e1a61-232">Cela génère le rendu de chacun des en-têtes des champs GridView s en tant que LinkButtons qui, lorsque vous cliquez dessus, provoquent une publication (postback) et retournent les données triées par la colonne sur laquelle l’utilisateur a cliqué dans l’ordre croissant.</span><span class="sxs-lookup"><span data-stu-id="e1a61-232">This renders each of the headers of the GridView s fields as LinkButtons that, when clicked, cause a postback and return the data sorted by the clicked column in ascending order.</span></span> <span data-ttu-id="e1a61-233">Le fait de cliquer sur le même LinkButton d’en-tête retrie à nouveau les données dans l’ordre décroissant.</span><span class="sxs-lookup"><span data-stu-id="e1a61-233">Clicking the same header LinkButton again re-sorts the data in descending order.</span></span>

> [!NOTE]
> <span data-ttu-id="e1a61-234">Si vous utilisez une couche d’accès aux données personnalisée plutôt qu’un DataSet typé, vous ne disposez peut-être pas de l’option Activer le tri dans la balise active GridView s.</span><span class="sxs-lookup"><span data-stu-id="e1a61-234">If you are using a custom Data Access Layer rather than a Typed DataSet, you may not have an Enable Sorting option in the GridView s smart tag.</span></span> <span data-ttu-id="e1a61-235">Seuls les GridViews liés à des sources de données qui prennent en charge le tri en mode natif disposent de cette case à cocher disponible.</span><span class="sxs-lookup"><span data-stu-id="e1a61-235">Only GridViews bound to data sources that natively support sorting have this checkbox available.</span></span> <span data-ttu-id="e1a61-236">Le DataSet typé fournit une prise en charge de tri prête à l’emploi puisque le DataTable ADO.NET fournit une méthode `Sort` qui, lorsqu’elle est appelée, trie les DataRow s à l’aide des critères spécifiés.</span><span class="sxs-lookup"><span data-stu-id="e1a61-236">The Typed DataSet provides out-of-the-box sorting support since the ADO.NET DataTable provides a `Sort` method that, when invoked, sorts the DataTable s DataRows using the criteria specified.</span></span>

<span data-ttu-id="e1a61-237">Si votre couche DAL ne retourne pas d’objets qui prennent en charge le tri en mode natif, vous devez configurer ObjectDataSource pour transmettre les informations de tri à la couche de logique métier, qui peut soit trier les données, soit faire en sorte que les données soient triées par la couche DAL.</span><span class="sxs-lookup"><span data-stu-id="e1a61-237">If your DAL does not return objects that natively support sorting you will need to configure the ObjectDataSource to pass sorting information to the Business Logic Layer, which can either sort the data or have the data sorted by the DAL.</span></span> <span data-ttu-id="e1a61-238">Nous allons découvrir comment trier les données au niveau de la logique métier et des couches d’accès aux données dans un prochain didacticiel.</span><span class="sxs-lookup"><span data-stu-id="e1a61-238">We'll explore how to sort data at the Business Logic and Data Access Layers in a future tutorial.</span></span>

<span data-ttu-id="e1a61-239">Les LinkButtonss de tri sont rendus sous forme de liens hypertexte HTML, dont les couleurs actuelles (bleu pour un lien non visité et un lien rouge foncé pour un lien visité) sont en conflit avec la couleur d’arrière-plan de la ligne d’en-tête.</span><span class="sxs-lookup"><span data-stu-id="e1a61-239">The sorting LinkButtons are rendered as HTML hyperlinks, whose current colors (blue for an unvisited link and a dark red for a visited link) clash with the background color of the header row.</span></span> <span data-ttu-id="e1a61-240">À la place, laissez tous les liens d’en-tête de ligne s’afficher en blanc, qu’ils aient été ou non visités.</span><span class="sxs-lookup"><span data-stu-id="e1a61-240">Instead, let s have all header row links displayed in white, regardless of whether they ve been visited or not.</span></span> <span data-ttu-id="e1a61-241">Pour ce faire, vous pouvez ajouter le code suivant à la classe `Styles.css` :</span><span class="sxs-lookup"><span data-stu-id="e1a61-241">This can be accomplished by adding the following to the `Styles.css` class:</span></span>

[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample8.css)]

<span data-ttu-id="e1a61-242">Cette syntaxe indique d’utiliser le texte blanc lors de l’affichage de ces liens hypertexte dans un élément qui utilise la classe HeaderStyle.</span><span class="sxs-lookup"><span data-stu-id="e1a61-242">This syntax indicates to use white text when displaying those hyperlinks within an element that uses the HeaderStyle class.</span></span>

<span data-ttu-id="e1a61-243">Après cet ajout de CSS, lors de la visite de la page via un navigateur, votre écran doit ressembler à la figure 12.</span><span class="sxs-lookup"><span data-stu-id="e1a61-243">After this CSS addition, when visiting the page through a browser your screen should look similar to Figure 12.</span></span> <span data-ttu-id="e1a61-244">En particulier, la figure 12 montre les résultats une fois que vous avez cliqué sur le lien de l’en-tête s des champs de prix.</span><span class="sxs-lookup"><span data-stu-id="e1a61-244">In particular, Figure 12 shows the results after the Price field s header link has been clicked.</span></span>

<span data-ttu-id="e1a61-245">[![les résultats ont été triés par prix unitaire dans l’ordre croissant](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-245">[![The Results Have Been Sorted by the UnitPrice in Ascending Order](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span></span>

<span data-ttu-id="e1a61-246">**Figure 12**: les résultats ont été triés par prix unitaire dans l’ordre croissant ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-246">**Figure 12**: The Results Have Been Sorted by the UnitPrice in Ascending Order ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image26.png))</span></span>

## <a name="examining-the-sorting-workflow"></a><span data-ttu-id="e1a61-247">Examen du flux de travail de tri</span><span class="sxs-lookup"><span data-stu-id="e1a61-247">Examining the Sorting Workflow</span></span>

<span data-ttu-id="e1a61-248">Tous les champs GridView, BoundField, CheckBoxField, TemplateField, etc., ont une propriété `SortExpression` qui indique l’expression à utiliser pour trier les données lorsque l’utilisateur clique sur le lien d’en-tête de tri de ce champ.</span><span class="sxs-lookup"><span data-stu-id="e1a61-248">All GridView fields the BoundField, CheckBoxField, TemplateField, and so on have a `SortExpression` property that indicates the expression that should be used to sort the data when that field s sorting header link is clicked.</span></span> <span data-ttu-id="e1a61-249">Le GridView possède également une propriété `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-249">The GridView also has a `SortExpression` property.</span></span> <span data-ttu-id="e1a61-250">Quand l’utilisateur clique sur un contrôle LinkButton d’en-tête de tri, le contrôle GridView affecte à la propriété `SortExpression` la valeur de ce `SortExpression` champ.</span><span class="sxs-lookup"><span data-stu-id="e1a61-250">When a sorting header LinkButton is clicked, the GridView assigns that field s `SortExpression` value to its `SortExpression` property.</span></span> <span data-ttu-id="e1a61-251">Ensuite, les données sont récupérées à partir de ObjectDataSource et triées en fonction de la propriété GridView s `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-251">Next, the data is re-retrieved from the ObjectDataSource and sorted according to the GridView s `SortExpression` property.</span></span> <span data-ttu-id="e1a61-252">La liste suivante décrit en détail la séquence d’étapes qui s’écoule lorsqu’un utilisateur final trie les données dans un GridView :</span><span class="sxs-lookup"><span data-stu-id="e1a61-252">The following list details the sequence of steps that transpires when an end user sorts the data in a GridView:</span></span>

1. <span data-ttu-id="e1a61-253">L’événement de [Tri](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx) GridView s est déclenché</span><span class="sxs-lookup"><span data-stu-id="e1a61-253">The GridView s [Sorting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx) fires</span></span>
2. <span data-ttu-id="e1a61-254">La propriété GridView s [`SortExpression`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) est définie sur le `SortExpression` du champ dont l’en-tête de tri LinkButton a été cliqué</span><span class="sxs-lookup"><span data-stu-id="e1a61-254">The GridView s [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) is set to the `SortExpression` of the field whose sorting header LinkButton was clicked</span></span>
3. <span data-ttu-id="e1a61-255">ObjectDataSource récupère à nouveau toutes les données de la couche BLL, puis trie les données à l’aide du `SortExpression` GridView s</span><span class="sxs-lookup"><span data-stu-id="e1a61-255">The ObjectDataSource re-retrieves all of the data from the BLL and then sorts the data using the GridView s `SortExpression`</span></span>
4. <span data-ttu-id="e1a61-256">La propriété de la `PageIndex` GridView s est réinitialisée à 0, ce qui signifie que lorsque le tri de l’utilisateur est retourné à la première page de données (en supposant que la prise en charge de la pagination a été implémentée)</span><span class="sxs-lookup"><span data-stu-id="e1a61-256">The GridView s `PageIndex` property is reset to 0, meaning that when sorting the user is returned to the first page of data (assuming paging support has been implemented)</span></span>
5. <span data-ttu-id="e1a61-257">L' [événement`Sorted`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx) GridView s est déclenché</span><span class="sxs-lookup"><span data-stu-id="e1a61-257">The GridView s [`Sorted` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx) fires</span></span>

<span data-ttu-id="e1a61-258">Comme avec la pagination par défaut, l’option de tri par défaut récupère *tous* les enregistrements de la couche BLL.</span><span class="sxs-lookup"><span data-stu-id="e1a61-258">Like with default paging, the default sorting option re-retrieves *all* of the records from the BLL.</span></span> <span data-ttu-id="e1a61-259">Lors de l’utilisation du tri sans pagination ou lors de l’utilisation du tri avec la pagination par défaut, il n’existe aucun moyen de contourner ce gain de performance (à l’instar de la mise en cache des données de base de données)</span><span class="sxs-lookup"><span data-stu-id="e1a61-259">When using sorting without paging or when using sorting with default paging, there s no way to circumvent this performance hit (short of caching the database data).</span></span> <span data-ttu-id="e1a61-260">Toutefois, comme nous le verrons dans un prochain didacticiel, il est possible de trier efficacement les données lors de l’utilisation de la pagination personnalisée.</span><span class="sxs-lookup"><span data-stu-id="e1a61-260">However, as we'll see in a future tutorial, it s possible to efficiently sort data when using custom paging.</span></span>

<span data-ttu-id="e1a61-261">Lors de la liaison d’un ObjectDataSource au contrôle GridView via la liste déroulante de la balise active GridView s, la propriété `SortExpression` de chaque champ GridView est automatiquement assignée au nom du champ de données dans la classe `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="e1a61-261">When binding an ObjectDataSource to the GridView through the drop-down list in the GridView s smart tag, each GridView field automatically has its `SortExpression` property assigned to the name of the data field in the `ProductsRow` class.</span></span> <span data-ttu-id="e1a61-262">Par exemple, le `ProductName` BoundField s `SortExpression` a la valeur `ProductName`, comme indiqué dans le balisage déclaratif suivant :</span><span class="sxs-lookup"><span data-stu-id="e1a61-262">For example, the `ProductName` BoundField s `SortExpression` is set to `ProductName`, as shown in the following declarative markup:</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample9.aspx)]

<span data-ttu-id="e1a61-263">Un champ peut être configuré de sorte qu’il ne puisse pas être trié en effaçant sa propriété `SortExpression` (en l’assignant à une chaîne vide).</span><span class="sxs-lookup"><span data-stu-id="e1a61-263">A field can be configured so that it s not sortable by clearing out its `SortExpression` property (assigning it to an empty string).</span></span> <span data-ttu-id="e1a61-264">Pour illustrer cela, imaginez que nous ne souhaitions pas permettre à nos clients de trier nos produits par prix.</span><span class="sxs-lookup"><span data-stu-id="e1a61-264">To illustrate this, imagine that we didn't want to let our customers sort our products by price.</span></span> <span data-ttu-id="e1a61-265">La propriété `UnitPrice` BoundField s `SortExpression` peut être supprimée soit du balisage déclaratif, soit de la boîte de dialogue champs (accessible en cliquant sur le lien modifier les colonnes dans la balise active de GridView s).</span><span class="sxs-lookup"><span data-stu-id="e1a61-265">The `UnitPrice` BoundField s `SortExpression` property can be removed either from the declarative markup or through the Fields dialog box (which is accessible by clicking on the Edit Columns link in the GridView s smart tag).</span></span>

![Les résultats ont été triés par prix unitaire dans l’ordre croissant](paging-and-sorting-report-data-vb/_static/image27.png)

<span data-ttu-id="e1a61-267">**Figure 13**: les résultats ont été triés par prix unitaire dans l’ordre croissant</span><span class="sxs-lookup"><span data-stu-id="e1a61-267">**Figure 13**: The Results Have Been Sorted by the UnitPrice in Ascending Order</span></span>

<span data-ttu-id="e1a61-268">Une fois que la propriété `SortExpression` a été supprimée pour le `UnitPrice` BoundField, l’en-tête est restitué sous forme de texte et non en tant que lien, ce qui empêche les utilisateurs de trier les données par prix.</span><span class="sxs-lookup"><span data-stu-id="e1a61-268">Once the `SortExpression` property has been removed for the `UnitPrice` BoundField, the header is rendered as text rather than as a link, thereby preventing users from sorting the data by price.</span></span>

<span data-ttu-id="e1a61-269">[![en supprimant la propriété SortExpression, les utilisateurs ne peuvent plus trier les produits par prix](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-269">[![By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="e1a61-270">**Figure 14**: en supprimant la propriété SortExpression, les utilisateurs ne peuvent plus trier les produits par prix ([cliquez pour afficher l’image en taille réelle](paging-and-sorting-report-data-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-270">**Figure 14**: By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image30.png))</span></span>

## <a name="programmatically-sorting-the-gridview"></a><span data-ttu-id="e1a61-271">Tri par programmation du contrôle GridView</span><span class="sxs-lookup"><span data-stu-id="e1a61-271">Programmatically Sorting the GridView</span></span>

<span data-ttu-id="e1a61-272">Vous pouvez également trier par programmation le contenu de GridView à l’aide de la [méthode`Sort`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx)GridView s.</span><span class="sxs-lookup"><span data-stu-id="e1a61-272">You can also sort the contents of the GridView programmatically by using the GridView s [`Sort` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx).</span></span> <span data-ttu-id="e1a61-273">Transmettez simplement la valeur `SortExpression` pour effectuer un tri en même temps que la [`SortDirection`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` ou `Descending`), et les données GridView s seront retriées.</span><span class="sxs-lookup"><span data-stu-id="e1a61-273">Simply pass in the `SortExpression` value to sort by along with the [`SortDirection`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` or `Descending`), and the GridView s data will be re-sorted.</span></span>

<span data-ttu-id="e1a61-274">Imaginez que la raison pour laquelle nous avons désactivé le tri par le `UnitPrice` était parce que nous avons peur que nos clients achètent simplement les produits les plus chers.</span><span class="sxs-lookup"><span data-stu-id="e1a61-274">Imagine that the reason we turned off sorting by the `UnitPrice` was because we were worried that our customers would simply buy only the lowest-priced products.</span></span> <span data-ttu-id="e1a61-275">Toutefois, nous souhaitons les inciter à acheter les produits les plus chers. nous aimerions donc pouvoir trier les produits par prix, mais uniquement du prix le plus onéreux au moins.</span><span class="sxs-lookup"><span data-stu-id="e1a61-275">However, we want to encourage them to buy the most expensive products, so we d like them to be able to sort the products by price, but only from the most expensive price to the least.</span></span>

<span data-ttu-id="e1a61-276">Pour ce faire, ajoutez un contrôle Web Button à la page, affectez à sa propriété `ID` la valeur `SortPriceDescending`et à sa propriété `Text` la valeur Trier par Price.</span><span class="sxs-lookup"><span data-stu-id="e1a61-276">To accomplish this add a Button Web control to the page, set its `ID` property to `SortPriceDescending`, and its `Text` property to Sort by Price.</span></span> <span data-ttu-id="e1a61-277">Ensuite, créez un gestionnaire d’événements pour le bouton s `Click` événement en double-cliquant sur le contrôle bouton dans le concepteur.</span><span class="sxs-lookup"><span data-stu-id="e1a61-277">Next, create an event handler for the Button s `Click` event by double-clicking the Button control in the Designer.</span></span> <span data-ttu-id="e1a61-278">Ajoutez le code suivant à ce gestionnaire d’événements :</span><span class="sxs-lookup"><span data-stu-id="e1a61-278">Add the following code to this event handler:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample10.vb)]

<span data-ttu-id="e1a61-279">En cliquant sur ce bouton, vous redonnez à l’utilisateur la première page contenant les produits triés par prix, de la plus coûteuse à la moins coûteuse (voir figure 15).</span><span class="sxs-lookup"><span data-stu-id="e1a61-279">Clicking this Button returns the user to the first page with the products sorted by price, from most expensive to least expensive (see Figure 15).</span></span>

<span data-ttu-id="e1a61-280">[![cliquant sur le bouton classe les produits du plus onéreux au moins](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e1a61-280">[![Clicking the Button Orders the Products From the Most Expensive to the Least](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="e1a61-281">**Figure 15**: cliquer sur le bouton classe les produits du plus onéreux au moins ([cliquez pour afficher l’image en plein écran](paging-and-sorting-report-data-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="e1a61-281">**Figure 15**: Clicking the Button Orders the Products From the Most Expensive to the Least ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="e1a61-282">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="e1a61-282">Summary</span></span>

<span data-ttu-id="e1a61-283">Dans ce didacticiel, nous avons vu comment implémenter les fonctionnalités de pagination et de tri par défaut, qui étaient aussi simples que de vérifier une case à cocher.</span><span class="sxs-lookup"><span data-stu-id="e1a61-283">In this tutorial we saw how to implement default paging and sorting capabilities, both of which were as easy as checking a checkbox!</span></span> <span data-ttu-id="e1a61-284">Lorsqu’un utilisateur effectue un tri ou des pages de données, un flux de travail similaire est déplié :</span><span class="sxs-lookup"><span data-stu-id="e1a61-284">When a user sorts or pages through data, a similar workflow unfolds:</span></span>

1. <span data-ttu-id="e1a61-285">Une publication (postback) résulte</span><span class="sxs-lookup"><span data-stu-id="e1a61-285">A postback ensues</span></span>
2. <span data-ttu-id="e1a61-286">L’événement de préniveau des contrôles Web de données est déclenché (`PageIndexChanging` ou `Sorting`)</span><span class="sxs-lookup"><span data-stu-id="e1a61-286">The data Web control s pre-level event fires (`PageIndexChanging` or `Sorting`)</span></span>
3. <span data-ttu-id="e1a61-287">Toutes les données sont récupérées à nouveau par ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="e1a61-287">All of the data is re-retrieved by the ObjectDataSource</span></span>
4. <span data-ttu-id="e1a61-288">L’événement de publication des contrôles Web de données est déclenché (`PageIndexChanged` ou `Sorted`)</span><span class="sxs-lookup"><span data-stu-id="e1a61-288">The data Web control s post-level event fires (`PageIndexChanged` or `Sorted`)</span></span>

<span data-ttu-id="e1a61-289">Bien que l’implémentation de la pagination et du tri de base soit un peu, l’effort nécessaire pour utiliser la pagination personnalisée plus efficace ou pour améliorer l’interface de pagination ou de tri est plus poussé.</span><span class="sxs-lookup"><span data-stu-id="e1a61-289">While implementing basic paging and sorting is a breeze, more effort must be exerted to utilize the more efficient custom paging or to further enhance the paging or sorting interface.</span></span> <span data-ttu-id="e1a61-290">Les prochains didacticiels exploreront ces rubriques.</span><span class="sxs-lookup"><span data-stu-id="e1a61-290">Future tutorials will explore these topics.</span></span>

<span data-ttu-id="e1a61-291">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="e1a61-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e1a61-292">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="e1a61-292">About the Author</span></span>

<span data-ttu-id="e1a61-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="e1a61-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e1a61-294">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="e1a61-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e1a61-295">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e1a61-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e1a61-296">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e1a61-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e1a61-297">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e1a61-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e1a61-298">[Précédent](creating-a-customized-sorting-user-interface-cs.md)
> [Suivant](efficiently-paging-through-large-amounts-of-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e1a61-298">[Previous](creating-a-customized-sorting-user-interface-cs.md)
[Next](efficiently-paging-through-large-amounts-of-data-vb.md)</span></span>
