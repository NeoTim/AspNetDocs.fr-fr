---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: Création d’une Interface d’utilisateur de tri personnalisée (VB) | Microsoft Docs
author: rick-anderson
description: Lors de l’affichage d’une longue liste des données triées, il peut être très utile de regrouper les données associées en introduisant des lignes du séparateur. Dans ce didacticiel, nous verrons comment cre...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 571e34a8c87bf54b8dd71c912f16ebcdab3c87a7
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59383445"
---
# <a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="7fa87-104">Création d’une interface utilisateur de tri personnalisée (VB)</span><span class="sxs-lookup"><span data-stu-id="7fa87-104">Creating a Customized Sorting User Interface (VB)</span></span>

<span data-ttu-id="7fa87-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7fa87-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7fa87-106">[Télécharger l’exemple d’application](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) ou [télécharger le PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7fa87-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="7fa87-107">Lors de l’affichage d’une longue liste des données triées, il peut être très utile de regrouper les données associées en introduisant des lignes du séparateur.</span><span class="sxs-lookup"><span data-stu-id="7fa87-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="7fa87-108">Dans ce didacticiel, nous allons voir comment créer une interface utilisateur tri.</span><span class="sxs-lookup"><span data-stu-id="7fa87-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="7fa87-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="7fa87-109">Introduction</span></span>

<span data-ttu-id="7fa87-110">Affichage d’une longue liste de lorsque les données triées contenant uniquement un certain nombre de valeurs différentes dans la colonne triée, un utilisateur final peut s’avérer difficile de discerner où, exactement, les limites de différence se produisent.</span><span class="sxs-lookup"><span data-stu-id="7fa87-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="7fa87-111">Par exemple, il existe des 81 produits dans la base de données, mais les choix de catégorie différente seulement neuf (huit catégories uniques ainsi que les `NULL` option).</span><span class="sxs-lookup"><span data-stu-id="7fa87-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="7fa87-112">Prenons le cas d’un utilisateur souhaitant en examinant les produits qui relèvent de la catégorie de la mer.</span><span class="sxs-lookup"><span data-stu-id="7fa87-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="7fa87-113">À partir d’une page qui répertorie *tous les* des produits dans un GridView unique, l’utilisateur peut décider de son meilleur résultat consiste à trier les résultats par catégorie, qui regroupe tous les produits Seafood ensemble.</span><span class="sxs-lookup"><span data-stu-id="7fa87-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="7fa87-114">Après le tri par catégorie, l’utilisateur doit ensuite de recherche dans la liste, recherchez où les produits regroupés en mer commencer et se terminer.</span><span class="sxs-lookup"><span data-stu-id="7fa87-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="7fa87-115">Dans la mesure où les résultats sont triés par ordre alphabétique par nom de la catégorie recherche les produits de la mer n’est pas difficile, mais elle nécessite toujours étroitement analyse la liste des éléments dans la grille.</span><span class="sxs-lookup"><span data-stu-id="7fa87-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="7fa87-116">Pour aider à mettre en surbrillance les limites entre les groupes triés, de nombreux sites Web utilisent une interface utilisateur qui ajoute un séparateur entre ces groupes.</span><span class="sxs-lookup"><span data-stu-id="7fa87-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="7fa87-117">Séparateurs comme celles indiquées dans la Figure 1 permet à un utilisateur de plus rapidement trouver un groupe particulier et identifier ses limites, ainsi que déterminer quels groupes distincts existent dans les données.</span><span class="sxs-lookup"><span data-stu-id="7fa87-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>


<span data-ttu-id="7fa87-118">[![Chaque groupe de catégories est clairement identifié](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7fa87-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="7fa87-119">**Figure 1**: Chaque groupe de catégories est clairement identifié ([cliquez pour afficher l’image en taille réelle](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="7fa87-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>


<span data-ttu-id="7fa87-120">Dans ce didacticiel, nous allons voir comment créer une interface utilisateur tri.</span><span class="sxs-lookup"><span data-stu-id="7fa87-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="7fa87-121">Étape 1 : Création d’un GridView Standard, pouvant être trié</span><span class="sxs-lookup"><span data-stu-id="7fa87-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="7fa87-122">Avant de nous explorons comment augmenter le contrôle GridView pour fournir l’interface de tri améliorée, permettent de s tout d’abord créer un GridView standard, pouvant être trié qui répertorie les produits.</span><span class="sxs-lookup"><span data-stu-id="7fa87-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="7fa87-123">Commencez par ouvrir le `CustomSortingUI.aspx` page dans le `PagingAndSorting` dossier.</span><span class="sxs-lookup"><span data-stu-id="7fa87-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="7fa87-124">Ajouter un GridView à la page, définissez son `ID` propriété `ProductList`et le lier à un nouveau ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7fa87-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="7fa87-125">Configurer l’ObjectDataSource à utiliser le `ProductsBLL` classe s `GetProducts()` méthode de sélection des enregistrements.</span><span class="sxs-lookup"><span data-stu-id="7fa87-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="7fa87-126">Ensuite, configurez le contrôle GridView tel qu’il contient uniquement le `ProductName`, `CategoryName`, `SupplierName`, et `UnitPrice` BoundFields et le CheckBoxField abandonné.</span><span class="sxs-lookup"><span data-stu-id="7fa87-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="7fa87-127">Enfin, configurez le contrôle GridView pour prendre en charge le tri en cochant la case à cocher Activer le tri dans la balise active de GridView s (ou en définissant son `AllowSorting` propriété `true`).</span><span class="sxs-lookup"><span data-stu-id="7fa87-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="7fa87-128">Après avoir apporté ces ajouts à la `CustomSortingUI.aspx` page, le balisage déclaratif doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="7fa87-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="7fa87-129">Prenez un moment pour consulter notre progression jusqu'à présent dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="7fa87-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="7fa87-130">Figure 2 montre le contrôle GridView sortable lorsque ses données sont triées par catégorie dans l’ordre alphabétique.</span><span class="sxs-lookup"><span data-stu-id="7fa87-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>


<span data-ttu-id="7fa87-131">[![Les opérations de mappage GridView pouvant être trié les données sont triées par catégorie](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="7fa87-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="7fa87-132">**Figure 2**: Les opérations de mappage pouvant être trié GridView données sont triées par catégorie ([cliquez pour afficher l’image en taille réelle](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="7fa87-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="7fa87-133">Étape 2 : Exploration des Techniques permettant d’ajouter les lignes du séparateur</span><span class="sxs-lookup"><span data-stu-id="7fa87-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="7fa87-134">Avec GridView générique, pouvant être trié complète, reste qu’à être en mesure d’ajouter les lignes du séparateur dans le contrôle GridView avant chaque groupe trié.</span><span class="sxs-lookup"><span data-stu-id="7fa87-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="7fa87-135">Mais comment ces lignes possible d’injecter dans le contrôle GridView ?</span><span class="sxs-lookup"><span data-stu-id="7fa87-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="7fa87-136">Pour l’essentiel, nous devons effectuer une itération dans les lignes s GridView, déterminer où les différences entre les valeurs dans la colonne triée et puis ajoutez la ligne de séparateur approprié.</span><span class="sxs-lookup"><span data-stu-id="7fa87-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="7fa87-137">Lorsque vous réfléchissez à ce problème, cela semble naturel que la solution se trouve quelque part dans le s GridView `RowDataBound` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="7fa87-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="7fa87-138">Comme expliqué dans la [mise en forme en fonction lors de données personnalisées](../custom-formatting/custom-formatting-based-upon-data-vb.md) didacticiel, ce gestionnaire d’événements est couramment utilisé lors de la mise en forme au niveau des lignes selon les données de ligne s.</span><span class="sxs-lookup"><span data-stu-id="7fa87-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="7fa87-139">Toutefois, le `RowDataBound` Gestionnaire d’événements n’est pas la solution ici, comme les lignes ne peuvent pas être ajoutés au GridView par programmation à partir de ce gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="7fa87-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="7fa87-140">Les opérations de mappage GridView `Rows` collection, en fait, est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="7fa87-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="7fa87-141">Pour ajouter des lignes supplémentaires au GridView, nous avons trois possibilités :</span><span class="sxs-lookup"><span data-stu-id="7fa87-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="7fa87-142">Ajoutez ces lignes de séparateur de métadonnées aux données réelles qui sont liées au GridView</span><span class="sxs-lookup"><span data-stu-id="7fa87-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="7fa87-143">Une fois que le contrôle GridView a été lié aux données, ajoutez d’autres `TableRow` contrôlent la collecte des instances pour les opérations de mappage GridView</span><span class="sxs-lookup"><span data-stu-id="7fa87-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="7fa87-144">Créer un contrôle serveur personnalisé qui étend le contrôle GridView et remplace ces méthodes responsables du développement de la structure de s GridView</span><span class="sxs-lookup"><span data-stu-id="7fa87-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="7fa87-145">Création d’un contrôle serveur personnalisé serait la meilleure approche si cette fonctionnalité était nécessaire sur de nombreuses pages web ou sur plusieurs sites Web.</span><span class="sxs-lookup"><span data-stu-id="7fa87-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="7fa87-146">Toutefois, elle entraînerait un peu de code et une exploration approfondie dans les profondeurs des mécanismes internes s GridView.</span><span class="sxs-lookup"><span data-stu-id="7fa87-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="7fa87-147">Par conséquent, nous étudierons pas cette option pour ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="7fa87-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="7fa87-148">Les deux autres options d’ajout d’une ligne séparateur pour les données réelles en cours liées au GridView et la manipulation de la collection de contrôles GridView s après son été lié - attaquer le problème différemment et méritent une discussion.</span><span class="sxs-lookup"><span data-stu-id="7fa87-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="7fa87-149">Ajout de lignes aux données liées au GridView</span><span class="sxs-lookup"><span data-stu-id="7fa87-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="7fa87-150">Lorsque le contrôle GridView est lié à une source de données, il crée un `GridViewRow` pour chaque enregistrement retourné par la source de données.</span><span class="sxs-lookup"><span data-stu-id="7fa87-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="7fa87-151">Par conséquent, nous pouvons injecter les lignes du séparateur nécessaires en ajoutant des enregistrements de séparateur à la source de données avant de le lier au contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="7fa87-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="7fa87-152">La figure 3 illustre ce concept.</span><span class="sxs-lookup"><span data-stu-id="7fa87-152">Figure 3 illustrates this concept.</span></span>


![Une Technique consiste à ajouter des lignes de séparateur à la Source de données](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="7fa87-154">**Figure 3**: Une Technique consiste à ajouter des lignes de séparateur à la Source de données</span><span class="sxs-lookup"><span data-stu-id="7fa87-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>


<span data-ttu-id="7fa87-155">Utiliser les enregistrements de séparateur à terme entre guillemets, car il n’existe aucun enregistrement de séparation particulière ; au lieu de cela, nous devons d’une certaine manière indicateur servant à un enregistrement particulier dans la source de données comme un séparateur au lieu d’une ligne de données normale.</span><span class="sxs-lookup"><span data-stu-id="7fa87-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="7fa87-156">Pour nos exemples, nous re liaison un `ProductsDataTable` instance au GridView, qui se compose de `ProductRows`.</span><span class="sxs-lookup"><span data-stu-id="7fa87-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="7fa87-157">Nous pouvons également marquer un enregistrement en tant que ligne de séparateur en définissant son `CategoryID` propriété `-1` (dans la mesure où une telle valeur n’a pas pu existe normalement).</span><span class="sxs-lookup"><span data-stu-id="7fa87-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="7fa87-158">Pour utiliser cette technique d nous devez effectuer les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="7fa87-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="7fa87-159">Récupérer par programme les données à lier au contrôle GridView (un `ProductsDataTable` instance)</span><span class="sxs-lookup"><span data-stu-id="7fa87-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="7fa87-160">Trier les données selon le s GridView `SortExpression` et `SortDirection` propriétés</span><span class="sxs-lookup"><span data-stu-id="7fa87-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="7fa87-161">Effectuer une itération dans le `ProductsRows` dans le `ProductsDataTable`, cherchez où se situent les différences dans la colonne triée</span><span class="sxs-lookup"><span data-stu-id="7fa87-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="7fa87-162">À chaque limite de groupe, injecter un enregistrement de séparateur `ProductsRow` instance dans le DataTable, ce qui l’a s `CategoryID` la valeur `-1` (ou toute désignation a été décidée pour marquer un enregistrement comme enregistrement séparateur)</span><span class="sxs-lookup"><span data-stu-id="7fa87-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="7fa87-163">Après l’injection les lignes du séparateur, lier par programmation les données au GridView</span><span class="sxs-lookup"><span data-stu-id="7fa87-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="7fa87-164">Outre ces cinq étapes, d nous devons également fournir un gestionnaire d’événements pour les opérations de mappage GridView `RowDataBound` événement.</span><span class="sxs-lookup"><span data-stu-id="7fa87-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="7fa87-165">Ici, nous d vérifier chacune `DataRow` et déterminer s’il concernait un séparateur de ligne, un dont `CategoryID` paramètre était `-1`.</span><span class="sxs-lookup"><span data-stu-id="7fa87-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="7fa87-166">Dans ce cas, nous d souhaiterez probablement ajuster sa mise en forme ou le texte affiché dans l’ou les cellules.</span><span class="sxs-lookup"><span data-stu-id="7fa87-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="7fa87-167">À l’aide de cette technique pour injecter les tri des limites des groupes nécessite un peu plus de travail qu’indiqué ci-dessus, que vous devez également fournir un gestionnaire d’événements pour les opérations de mappage GridView `Sorting` effectuer le suivi de l’événement et conserver de la `SortExpression` et `SortDirection` valeurs.</span><span class="sxs-lookup"><span data-stu-id="7fa87-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="7fa87-168">Manipulation de la s GridView contrôler la collecte après lui s été lié aux données</span><span class="sxs-lookup"><span data-stu-id="7fa87-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="7fa87-169">Plutôt que les données de messagerie avant de le lier au contrôle GridView, nous pouvons ajouter les lignes du séparateur *après* l’a été lié aux données au GridView.</span><span class="sxs-lookup"><span data-stu-id="7fa87-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="7fa87-170">Le processus de liaison de données crée la hiérarchie des contrôles GridView s, qui, en réalité, est simplement un `Table` instance composées d’une collection de lignes, chacune d’elles est composé d’une collection de cellules.</span><span class="sxs-lookup"><span data-stu-id="7fa87-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="7fa87-171">Plus précisément, la collection de contrôles GridView s contient un `Table` objet racine, un `GridViewRow` (qui est dérivée de la `TableRow` classe) pour chaque enregistrement dans le `DataSource` lié au GridView et un `TableCell` objet dans chaque `GridViewRow` instance pour chaque champ de données dans le `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="7fa87-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="7fa87-172">Pour ajouter des lignes du séparateur entre chaque groupe de tri, nous pouvons manipuler directement cette hiérarchie de contrôle une fois qu’il a été créé.</span><span class="sxs-lookup"><span data-stu-id="7fa87-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="7fa87-173">Nous pouvons être certain que la hiérarchie des contrôles GridView s a été créée pour la dernière fois au moment que du rendu de la page.</span><span class="sxs-lookup"><span data-stu-id="7fa87-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="7fa87-174">Par conséquent, cette approche remplace le `Page` classe s `Render` méthode, à quel point la hiérarchie des contrôles finale s GridView est mis à jour pour inclure les lignes du séparateur nécessaires.</span><span class="sxs-lookup"><span data-stu-id="7fa87-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="7fa87-175">Figure 4 illustre ce processus.</span><span class="sxs-lookup"><span data-stu-id="7fa87-175">Figure 4 illustrates this process.</span></span>


<span data-ttu-id="7fa87-176">[![Une autre Technique manipule la hiérarchie des contrôles GridView s](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="7fa87-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="7fa87-177">**Figure 4**: Une autre Technique manipule la hiérarchie des contrôles de s GridView ([cliquez pour afficher l’image en taille réelle](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="7fa87-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>


<span data-ttu-id="7fa87-178">Pour ce didacticiel, nous allons utiliser cette dernière approche pour personnaliser l’expérience utilisateur de tri.</span><span class="sxs-lookup"><span data-stu-id="7fa87-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="7fa87-179">Le code je m présenter dans ce didacticiel est basé sur l’exemple fourni dans [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) entrée de blog de s, [lecture un peu avec le regroupement de tri GridView](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="7fa87-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>


## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="7fa87-180">Étape 3 : Ajoutant les lignes de séparateur à la hiérarchie des contrôles GridView s</span><span class="sxs-lookup"><span data-stu-id="7fa87-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="7fa87-181">Étant donné que nous ne souhaitons pas ajouter les lignes de séparateur à la hiérarchie des contrôles GridView s après que sa hiérarchie de contrôle a été créé et créé pour la dernière fois sur cette page, visitez, nous souhaitons effectuer cet ajout à la fin du cycle de vie de page, mais avant le c GridView réelle ontrôle hiérarchie a été rendu en HTML.</span><span class="sxs-lookup"><span data-stu-id="7fa87-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="7fa87-182">Le dernier point possible auquel nous pouvons effectuer cette opération est la `Page` classe s `Render` événement que nous pouvons remplacer dans notre classe code-behind à l’aide de la signature de méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="7fa87-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="7fa87-183">Lorsque le `Page` classe d’origine `Render` méthode est appelée `base.Render(writer)` chacun des contrôles dans la page s’affichera, générer la balise en fonction de leur hiérarchie des contrôles.</span><span class="sxs-lookup"><span data-stu-id="7fa87-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="7fa87-184">Par conséquent, il est impératif que nous les appelons `base.Render(writer)`, de sorte que la page est rendue, hiérarchie avant d’appeler des contrôles et que nous manipuler le s GridView `base.Render(writer)`, de sorte que les lignes du séparateur ont été ajoutés à la hiérarchie des contrôles GridView s avant s été rendu.</span><span class="sxs-lookup"><span data-stu-id="7fa87-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="7fa87-185">Pour injecter des en-têtes de groupe de tri, nous devons tout d’abord vous assurer que l’utilisateur a demandé que les données triées.</span><span class="sxs-lookup"><span data-stu-id="7fa87-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="7fa87-186">Par défaut, le contenu de s GridView n’est pas trié, et par conséquent nous n’avez pas besoin d’entrer n’importe quel groupe de tri des en-têtes.</span><span class="sxs-lookup"><span data-stu-id="7fa87-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="7fa87-187">Si vous souhaitez que le contrôle GridView à trier par une colonne particulière lors du premier chargement de la page, appelez les opérations de mappage GridView `Sort` méthode sur la première visite de page (mais pas sur les publications ultérieures).</span><span class="sxs-lookup"><span data-stu-id="7fa87-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="7fa87-188">Pour ce faire, ajoutez cet appel dans le `Page_Load` Gestionnaire d’événements au sein d’un `if (!Page.IsPostBack)` conditionnel.</span><span class="sxs-lookup"><span data-stu-id="7fa87-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="7fa87-189">Faire référence à la [la pagination et tri des données de rapport](paging-and-sorting-report-data-vb.md) informations didacticiels pour en savoir plus sur la `Sort` (méthode).</span><span class="sxs-lookup"><span data-stu-id="7fa87-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>


<span data-ttu-id="7fa87-190">En supposant que les données ont été triées, la tâche suivante consiste à déterminer quelle colonne données a été triées par et puis pour analyser les lignes de différences dans la colonne s vous recherchez des valeurs.</span><span class="sxs-lookup"><span data-stu-id="7fa87-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="7fa87-191">Le code suivant permet de s’assurer que les données ont été triées et recherche la colonne par laquelle les données ont été triées :</span><span class="sxs-lookup"><span data-stu-id="7fa87-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="7fa87-192">Si le contrôle GridView présente encore être triées, le s GridView `SortExpression` propriété n’est pas été définie.</span><span class="sxs-lookup"><span data-stu-id="7fa87-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="7fa87-193">Par conséquent, nous voulons uniquement ajouter les lignes de séparateur si cette propriété a une valeur.</span><span class="sxs-lookup"><span data-stu-id="7fa87-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="7fa87-194">Le cas échéant, nous devons ensuite déterminer l’index de la colonne par laquelle les données a été triées.</span><span class="sxs-lookup"><span data-stu-id="7fa87-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="7fa87-195">Cela s’effectue en parcourant le s GridView `Columns` collection, la recherche de la colonne dont la propriété `SortExpression` propriété est égale à la s GridView `SortExpression` propriété.</span><span class="sxs-lookup"><span data-stu-id="7fa87-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="7fa87-196">En plus de l’index de colonne s, nous extrayons également le `HeaderText` propriété, qui est utilisée pour afficher les lignes du séparateur.</span><span class="sxs-lookup"><span data-stu-id="7fa87-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="7fa87-197">Avec l’index de la colonne par laquelle les données sont triées, l’étape finale consiste pour énumérer les lignes du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="7fa87-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="7fa87-198">Pour chaque ligne, nous devons déterminer si la valeur de s colonne triée diffère de la valeur de s ligne s triées colonne précédente.</span><span class="sxs-lookup"><span data-stu-id="7fa87-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="7fa87-199">Si, par conséquent, nous devons injecter un nouveau `GridViewRow` instance dans la hiérarchie des contrôles.</span><span class="sxs-lookup"><span data-stu-id="7fa87-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="7fa87-200">Cela s’effectue par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="7fa87-200">This is accomplished with the following code:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="7fa87-201">Ce code commence par référencer par programme le `Table` de l’objet trouvé à la racine de la hiérarchie des contrôles GridView s et la création d’une variable chaîne nommée `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="7fa87-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="7fa87-202">`lastValue` est utilisé pour comparer la valeur de colonne s triées de ligne actuelle avec la valeur précédente de la ligne s.</span><span class="sxs-lookup"><span data-stu-id="7fa87-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="7fa87-203">Ensuite, les opérations de mappage GridView `Rows` collection est énumérée, et pour chaque ligne, la valeur de la colonne triée est stockée dans le `currentValue` variable.</span><span class="sxs-lookup"><span data-stu-id="7fa87-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="7fa87-204">Pour déterminer la valeur de la colonne triée ligne particulière, j’utilise la cellule s `Text` propriété.</span><span class="sxs-lookup"><span data-stu-id="7fa87-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="7fa87-205">Cela fonctionne bien pour BoundFields, mais ne sera pas fonctionnent comme vous le souhaitez pour TemplateField, CheckBoxFields et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="7fa87-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="7fa87-206">Nous allons examiner comment faire pour prendre en compte pour les autres champs de GridView, peu de temps.</span><span class="sxs-lookup"><span data-stu-id="7fa87-206">We'll look at how to account for alternate GridView fields shortly.</span></span>


<span data-ttu-id="7fa87-207">Le `currentValue` et `lastValue` variables sont ensuite comparés.</span><span class="sxs-lookup"><span data-stu-id="7fa87-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="7fa87-208">S’ils sont différents, nous devons ajouter une nouvelle ligne de séparateur à la hiérarchie des contrôles.</span><span class="sxs-lookup"><span data-stu-id="7fa87-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="7fa87-209">Pour ce faire, vous devez déterminer l’index de la `GridViewRow` dans le `Table` objet s `Rows` collection, création de nouveaux `GridViewRow` et `TableCell` instances, puis en ajoutant le `TableCell` et `GridViewRow` à la hiérarchie des contrôles.</span><span class="sxs-lookup"><span data-stu-id="7fa87-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="7fa87-210">Remarque que le séparateur de lignes s Solitaire `TableCell` est mis en forme tel qu’il s’étend sur toute la largeur du contrôle GridView, est mis en forme à l’aide de la `SortHeaderRowStyle` classe CSS et a son `Text` tel qu’il affiche à la fois le groupe de tri nom de propriété (par exemple, la catégorie) et la valeur de s groupe (par exemple, boissons).</span><span class="sxs-lookup"><span data-stu-id="7fa87-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="7fa87-211">Enfin, `lastValue` est mis à jour à la valeur de `currentValue`.</span><span class="sxs-lookup"><span data-stu-id="7fa87-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="7fa87-212">La classe CSS utilisée pour mettre en forme la ligne d’en-tête de groupe tri `SortHeaderRowStyle` doit être spécifié dans le `Styles.css` fichier.</span><span class="sxs-lookup"><span data-stu-id="7fa87-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="7fa87-213">N’hésitez pas à utiliser les paramètres de style vous séduire ; J’ai utilisé les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="7fa87-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>


[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="7fa87-214">Avec le code actuel, l’interface de tri ajoute des en-têtes de groupe de tri lors du tri par n’importe quel BoundField (voir Figure 5, qui montre une capture d’écran lors du tri par fournisseur).</span><span class="sxs-lookup"><span data-stu-id="7fa87-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="7fa87-215">Toutefois, lors du tri par n’importe quel autre type de champ (par exemple, un CheckBoxField ou d’un TemplateField), les en-têtes de groupe de tri sont nulle part à rechercher (voir Figure 6).</span><span class="sxs-lookup"><span data-stu-id="7fa87-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>


<span data-ttu-id="7fa87-216">[![L’Interface de tri inclut les en-têtes de groupe de tri lors du tri par BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="7fa87-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="7fa87-217">**Figure 5**: Le tri Interface inclut tri en-têtes lors de tri des groupes par BoundFields ([cliquez pour afficher l’image en taille réelle](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="7fa87-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>


<span data-ttu-id="7fa87-218">[![Les en-têtes de groupe de tri sont manquants lors de tri une CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="7fa87-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="7fa87-219">**Figure 6**: Les en-têtes de groupe de tri sont manquants lors de tri une CheckBoxField ([cliquez pour afficher l’image en taille réelle](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="7fa87-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>


<span data-ttu-id="7fa87-220">Les en-têtes de groupe de tri sont manquants lors du tri par un CheckBoxField est parce que le code utilise actuellement uniquement la `TableCell` s `Text` propriété afin de déterminer la valeur de la colonne triée pour chaque ligne.</span><span class="sxs-lookup"><span data-stu-id="7fa87-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="7fa87-221">Pour CheckBoxFields, le `TableCell` s `Text` propriété est une chaîne vide ; au lieu de cela, la valeur est disponible via un contrôle de case à cocher Web qui se trouve dans le `TableCell` s `Controls` collection.</span><span class="sxs-lookup"><span data-stu-id="7fa87-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="7fa87-222">Pour gérer les types de champs autres que BoundFields, nous avons besoin compléter le code où le `currentValue` variable est assignée pour vérifier l’existence d’une case à cocher dans la `TableCell` s `Controls` collection.</span><span class="sxs-lookup"><span data-stu-id="7fa87-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="7fa87-223">Au lieu d’utiliser `currentValue = gvr.Cells(sortColumnIndex).Text`, remplacez ce code par le suivant :</span><span class="sxs-lookup"><span data-stu-id="7fa87-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="7fa87-224">Ce code examine la colonne triée `TableCell` pour la ligne actuelle pour déterminer s’il existe des contrôles dans le `Controls` collection.</span><span class="sxs-lookup"><span data-stu-id="7fa87-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="7fa87-225">S’il existe et que le premier contrôle est une case à cocher, le `currentValue` variable est définie sur Oui ou non, en fonction de la case à cocher s `Checked` propriété.</span><span class="sxs-lookup"><span data-stu-id="7fa87-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="7fa87-226">Sinon, la valeur est obtenue à partir de la `TableCell` s `Text` propriété.</span><span class="sxs-lookup"><span data-stu-id="7fa87-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="7fa87-227">Cette logique peut être répliquée pour gérer le tri pour n’importe quel TemplateField qui peut-être exister dans le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="7fa87-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="7fa87-228">Avec l’ajout de code ci-dessus, les en-têtes de groupe de tri sont désormais présentes lors du tri par le CheckBoxField abandonné (voir la Figure 7).</span><span class="sxs-lookup"><span data-stu-id="7fa87-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>


<span data-ttu-id="7fa87-229">[![Les en-têtes de groupe de tri sont désormais présentes lorsque tri un CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="7fa87-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="7fa87-230">**Figure 7**: Les en-têtes de groupe de tri sont désormais présentes lorsque tri un CheckBoxField ([cliquez pour afficher l’image en taille réelle](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="7fa87-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="7fa87-231">Si vous disposez de produits avec `NULL` de base de données des valeurs pour le `CategoryID`, `SupplierID`, ou `UnitPrice` champs, ces valeurs seront affichent comme des chaînes vides dans le contrôle GridView par défaut, ce qui signifie le texte de ligne s séparateur pour les produits avec `NULL`valeurs seront lues comme catégorie : (autrement dit, il s aucun nom de catégorie : comme avec la catégorie : Boissons).</span><span class="sxs-lookup"><span data-stu-id="7fa87-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="7fa87-232">Si vous souhaitez une valeur affichée ici vous pouvez définir le BoundFields [ `NullDisplayText` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) au texte que vous souhaitez afficher, ou vous pouvez ajouter une instruction conditionnelle dans la méthode Render quand vous assignez le `currentValue` pour le séparateur ligne s `Text` propriété.</span><span class="sxs-lookup"><span data-stu-id="7fa87-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>


## <a name="summary"></a><span data-ttu-id="7fa87-233">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="7fa87-233">Summary</span></span>

<span data-ttu-id="7fa87-234">Le contrôle GridView n’inclut pas de nombreuses options intégrées pour la personnalisation de l’interface de tri.</span><span class="sxs-lookup"><span data-stu-id="7fa87-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="7fa87-235">Toutefois, avec un peu de code de bas niveau, il s possible de modifier la hiérarchie des contrôles GridView s pour créer une interface plus personnalisée.</span><span class="sxs-lookup"><span data-stu-id="7fa87-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="7fa87-236">Dans ce didacticiel, nous avons vu comment ajouter une ligne de séparateur de groupe de tri pour un GridView triable, qui identifie plus facilement les groupes distincts et les limites de ces groupes.</span><span class="sxs-lookup"><span data-stu-id="7fa87-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="7fa87-237">Pour obtenir des exemples supplémentaires d’interfaces de tri personnalisés, consultez [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [quelques ASP.NET 2.0 GridView tri trucs et astuces](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) entrée de blog.</span><span class="sxs-lookup"><span data-stu-id="7fa87-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="7fa87-238">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="7fa87-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7fa87-239">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="7fa87-239">About the Author</span></span>

<span data-ttu-id="7fa87-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="7fa87-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7fa87-241">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="7fa87-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7fa87-242">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7fa87-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7fa87-243">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7fa87-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7fa87-244">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7fa87-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="7fa87-245">Précédent</span><span class="sxs-lookup"><span data-stu-id="7fa87-245">Previous</span></span>](sorting-custom-paged-data-vb.md)
