---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: Création d’une couche d’accès aux données (C#) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons démarrer depuis le début et créer la couche DAL (Data Access), à l’aide de groupes de données typés, accéder aux informations dans une base de données.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: 4a6942df142ef40b92a8461afbc5f61fdfbde4ba
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57037846"
---
<a name="creating-a-data-access-layer-c"></a><span data-ttu-id="85acd-103">Création d’une couche d’accès aux données (C#)</span><span class="sxs-lookup"><span data-stu-id="85acd-103">Creating a Data Access Layer (C#)</span></span>
====================
<span data-ttu-id="85acd-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="85acd-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="85acd-105">Télécharger PDF</span><span class="sxs-lookup"><span data-stu-id="85acd-105">Download PDF</span></span>](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)

> <span data-ttu-id="85acd-106">Dans ce didacticiel, nous allons démarrer depuis le début et créer la couche DAL (Data Access), à l’aide de groupes de données typés, accéder aux informations dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="85acd-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="85acd-107">Introduction</span></span>

<span data-ttu-id="85acd-108">En tant que développeurs web, nos vies tournent autour de l’utilisation des données.</span><span class="sxs-lookup"><span data-stu-id="85acd-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="85acd-109">Nous allons créer des bases de données pour stocker les données, le code pour extraire et modifier et les pages web pour collecter et résumer.</span><span class="sxs-lookup"><span data-stu-id="85acd-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="85acd-110">Il s’agit du premier didacticiel d’une longue série qui explorera les techniques permettant d’implémenter ces modèles courants dans ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="85acd-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="85acd-111">Nous allons commencer par créer un [architecture logicielle](http://en.wikipedia.org/wiki/Software_architecture) composé d’une couche DAL (Data Access) à l’aide de données typés, une couche BLL (Business Logic) qui applique des règles d’entreprise personnalisées, et une couche de présentation composée d’ASP.NET pages qui partager une mise en page courantes.</span><span class="sxs-lookup"><span data-stu-id="85acd-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="85acd-112">Une fois que ce point de départ du serveur principal a été défini, nous passerons à la création de rapports, montrant comment afficher, synthétiser, collecter et valider les données à partir d’une application web.</span><span class="sxs-lookup"><span data-stu-id="85acd-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="85acd-113">Ces didacticiels sont conçues pour être concis et fournissent des instructions pas à pas avec de nombreuses captures d’écran pour vous guident tout au long du processus visuellement.</span><span class="sxs-lookup"><span data-stu-id="85acd-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="85acd-114">Chaque didacticiel est disponible dans les versions de Visual Basic et C# et inclut un téléchargement de l’intégralité du code utilisé.</span><span class="sxs-lookup"><span data-stu-id="85acd-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="85acd-115">(Ce premier didacticiel est assez long, mais le reste sont présentées dans des segments digestes beaucoup plus).</span><span class="sxs-lookup"><span data-stu-id="85acd-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="85acd-116">Pour ces didacticiels nous allons utiliser une version de Microsoft SQL Server 2005 Express Edition de la base de données Northwind placé dans le **application\_données** directory.</span><span class="sxs-lookup"><span data-stu-id="85acd-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="85acd-117">Outre le fichier de base de données, le **application\_données** dossier contient également les scripts SQL pour la création de la base de données, au cas où vous souhaitez utiliser une version de base de données différente.</span><span class="sxs-lookup"><span data-stu-id="85acd-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="85acd-118">Ces scripts peuvent également être [téléchargé directement auprès de Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), si vous préférez.</span><span class="sxs-lookup"><span data-stu-id="85acd-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="85acd-119">Si vous utilisez une autre version de SQL Server de la base de données Northwind, vous devez mettre à jour le **NORTHWNDConnectionString** définition dans l’application **Web.config** fichier.</span><span class="sxs-lookup"><span data-stu-id="85acd-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="85acd-120">L’application web a été créée à l’aide de Visual Studio 2005 Professional Edition en tant qu’un projet de site Web basé sur le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="85acd-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="85acd-121">Toutefois, tous les didacticiels fonctionnera aussi bien avec la version gratuite de Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="85acd-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="85acd-122">Dans ce didacticiel, nous allons démarrer depuis le début et créer la couche DAL (Data Access), suivie de la création de la couche BLL (Business Logic) dans le deuxième didacticiel et à travailler sur la mise en page et de navigation dans la troisième.</span><span class="sxs-lookup"><span data-stu-id="85acd-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="85acd-123">Les didacticiels après que celui tiers s’appuiera sur la Fondation présentées dans les trois premiers.</span><span class="sxs-lookup"><span data-stu-id="85acd-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="85acd-124">Nous avons beaucoup de choses à aborder dans ce premier didacticiel, par conséquent, démarrez Visual Studio et c’est parti !</span><span class="sxs-lookup"><span data-stu-id="85acd-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="85acd-125">Étape 1 : Création d’un projet Web et la connexion à la base de données</span><span class="sxs-lookup"><span data-stu-id="85acd-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="85acd-126">Avant de nous pouvons créer notre couche d’accès aux données (DAL), nous devons d’abord créer un site web et le programme d’installation de notre base de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="85acd-127">Commencez par créer un nouveau fichier basé sur un système web site ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="85acd-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="85acd-128">Pour ce faire, accédez au menu fichier et choisissez Nouveau Site Web, en affichant la boîte de dialogue Nouveau Site Web.</span><span class="sxs-lookup"><span data-stu-id="85acd-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="85acd-129">Choisissez le modèle de Site Web ASP.NET, la valeur de la liste déroulante emplacement du système de fichiers, choisissez un dossier pour placer le site web, la valeur est le langage C#.</span><span class="sxs-lookup"><span data-stu-id="85acd-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>


<span data-ttu-id="85acd-130">[![Créer un Site Web de système de nouveau fichier](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="85acd-131">**Figure 1**: Créer un Site Web de New File System-Based ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>


<span data-ttu-id="85acd-132">Cela créera un nouveau site web avec un **Default.aspx** page ASP.NET et un **application\_données** dossier.</span><span class="sxs-lookup"><span data-stu-id="85acd-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="85acd-133">Avec le site web créé, l’étape suivante consiste à ajouter une référence à la base de données dans l’Explorateur de serveurs de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="85acd-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="85acd-134">En ajoutant une base de données à l’Explorateur de serveurs vous pouvez ajouter des tables, des procédures stockées, vues et ainsi de suite, le tout depuis Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="85acd-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="85acd-135">Vous pouvez également afficher les données de la table ou créer vos propres requêtes manuellement ou sous forme graphique via le Générateur de requêtes.</span><span class="sxs-lookup"><span data-stu-id="85acd-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="85acd-136">En outre, lorsque nous générons les jeux de données typé pour la couche DAL nous allons devoir pointer Visual Studio à la base de données à partir duquel les jeux de données typé doit être construit.</span><span class="sxs-lookup"><span data-stu-id="85acd-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="85acd-137">Bien que nous pouvons fournir ces informations de connexion à ce stade dans le temps, Visual Studio remplit automatiquement une liste déroulante des bases de données déjà inscrite dans l’Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="85acd-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="85acd-138">Les étapes pour l’ajout de la base de données Northwind à l’Explorateur de serveurs varient selon que vous souhaitiez utiliser la base de données SQL Server 2005 Express Edition dans la **application\_données** dossier ou si vous avez un Microsoft SQL Server 2000 ou 2005 configuration de serveur de base de données que vous souhaitez utiliser à la place.</span><span class="sxs-lookup"><span data-stu-id="85acd-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="85acd-139">À l’aide d’une base de données dans theApp dans\_DataFolder</span><span class="sxs-lookup"><span data-stu-id="85acd-139">Using a Database in theApp\_DataFolder</span></span>

<span data-ttu-id="85acd-140">Si vous n’avez pas d’un SQL Server 2000 ou 2005 server de base de données pour se connecter à, ou si vous souhaitez simplement éviter d’avoir à ajouter la base de données à un serveur de base de données, vous pouvez utiliser la version de SQL Server 2005 Express Edition de la base de données Northwind qui se trouve dans l’aucun téléchargé e's **application\_données** dossier (**NORTHWND. MDF**).</span><span class="sxs-lookup"><span data-stu-id="85acd-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="85acd-141">Une base de données est placé dans le **application\_données** dossier est automatiquement ajouté à l’Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="85acd-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="85acd-142">En supposant que vous disposez de SQL Server 2005 Express Edition installé sur votre ordinateur, vous devez voir un nœud nommé NORTHWND. MDF dans l’Explorateur de serveurs, que vous pouvez développer et explorez ses tables, vues, procédures stockées et ainsi de suite (voir Figure 2).</span><span class="sxs-lookup"><span data-stu-id="85acd-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="85acd-143">Le **application\_données** dossier peut contenir également Microsoft Access **.mdb** fichiers, qui, comme leurs homologues SQL Server, sont automatiquement ajoutés à l’Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="85acd-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="85acd-144">Si vous ne souhaitez pas utiliser une des options de SQL Server, vous pouvez toujours [télécharger une version de Microsoft Access du fichier de base de données Northwind](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) et le déposer dans le **application\_données** directory.</span><span class="sxs-lookup"><span data-stu-id="85acd-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="85acd-145">N’oubliez pas, toutefois, que les bases de données Access ne sont pas aussi riches en fonctionnalités que SQL Server et ne sont pas conçus pour être utilisés dans les scénarios de site web.</span><span class="sxs-lookup"><span data-stu-id="85acd-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="85acd-146">En outre, deux des didacticiels 35 + vont utiliser certaines fonctionnalités de niveau de base de données qui ne sont pas pris en charge par l’accès.</span><span class="sxs-lookup"><span data-stu-id="85acd-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="85acd-147">Connexion à la base de données dans un serveur de base de données Microsoft SQL Server 2000 ou 2005</span><span class="sxs-lookup"><span data-stu-id="85acd-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="85acd-148">Ou bien, vous pouvez vous connecter à une base de données Northwind installé sur un serveur de base de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="85acd-149">Si le serveur de base de données n’a pas déjà installé la base de données Northwind, vous devez ajoutez-le d’abord au serveur de base de données en exécutant le script d’installation inclus dans le téléchargement de ce didacticiel ou par [télécharger la version de SQL Server 2000 de Northwind et le script d’installation](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directement à partir de site web de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="85acd-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="85acd-150">Une fois que vous avez installé la base de données, accédez à l’Explorateur de serveurs dans Visual Studio, cliquez sur le nœud Connexions de données, puis choisissez Ajouter une connexion.</span><span class="sxs-lookup"><span data-stu-id="85acd-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="85acd-151">Si vous ne voyez pas l’Explorateur de serveurs Accédez à la vue / Explorateur de serveurs, ou appuyez sur Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="85acd-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="85acd-152">Cela fait apparaître la boîte de dialogue Ajouter une connexion, où vous pouvez spécifier le serveur pour vous connecter à, les informations d’authentification et le nom de la base de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="85acd-153">Une fois que vous avez correctement configuré les informations de connexion de base de données et cliqué sur le bouton OK, la base de données est ajouté en tant que nœud sous le nœud Connexions de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="85acd-154">Vous pouvez développer le nœud de base de données pour Explorer ses tables, vues, procédures stockées et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="85acd-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Ajouter une connexion à la base de données de votre serveur de base de données Northwind](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="85acd-156">**Figure 2**: Ajouter une connexion à la base de données de votre serveur de base de données Northwind</span><span class="sxs-lookup"><span data-stu-id="85acd-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="85acd-157">Étape 2 : Création de la couche d’accès aux données</span><span class="sxs-lookup"><span data-stu-id="85acd-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="85acd-158">Lorsque vous travaillez avec les données une option consiste à incorporer la logique spécifique de données directement dans la couche de présentation (dans une application web, la marque de pages ASP.NET de la couche de présentation).</span><span class="sxs-lookup"><span data-stu-id="85acd-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="85acd-159">Cette opération peut prendre la forme d’écriture du code ADO.NET dans la partie du code de la page ASP.NET ou à l’aide du contrôle SqlDataSource à partir de la partie du balisage.</span><span class="sxs-lookup"><span data-stu-id="85acd-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="85acd-160">Dans les deux cas, cette approche couple étroitement la logique d’accès aux données avec la couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="85acd-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="85acd-161">Il est toutefois, l’approche recommandée, pour séparer la logique d’accès aux données à partir de la couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="85acd-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="85acd-162">Cette couche distincte est appelée par la couche d’accès aux données, la couche DAL pour faire court et est généralement implémentée comme un projet de bibliothèque de classes distinct.</span><span class="sxs-lookup"><span data-stu-id="85acd-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="85acd-163">Les avantages de cette architecture en couches sont bien documentées (voir la section « Autres lectures » à la fin de ce didacticiel pour plus d’informations sur ces avantages) et est l’approche que nous puissions appliquer dans cette série.</span><span class="sxs-lookup"><span data-stu-id="85acd-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="85acd-164">Tout le code qui est spécifique à la source de données sous-jacente telles que la création d’une connexion à la base de données émission **sélectionnez**, **insérer**, **mise à jour**, et  **SUPPRIMER** commandes et ainsi de suite doivent se trouver dans la couche DAL.</span><span class="sxs-lookup"><span data-stu-id="85acd-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="85acd-165">La couche de présentation ne doit pas contenir toutes les références à ce code d’accès aux données, mais il doit effectuer à la place des appels dans la couche DAL pour les demandes de toutes les données.</span><span class="sxs-lookup"><span data-stu-id="85acd-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="85acd-166">Couches d’accès aux données contiennent généralement des méthodes pour accéder à la base de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="85acd-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="85acd-167">La base de données Northwind, par exemple, a **produits** et **catégories** tables qui enregistrent les produits pour les catégories à laquelle ils appartiennent et de la vente.</span><span class="sxs-lookup"><span data-stu-id="85acd-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="85acd-168">Dans notre DAL nous aura des méthodes telles que :</span><span class="sxs-lookup"><span data-stu-id="85acd-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="85acd-169">**GetCategories(),** qui retourne des informations sur toutes les catégories</span><span class="sxs-lookup"><span data-stu-id="85acd-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="85acd-170">**GetProducts()**, qui retourne des informations sur tous les produits</span><span class="sxs-lookup"><span data-stu-id="85acd-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="85acd-171">**GetProductsByCategoryID (*categoryID*)**, qui retourne tous les produits qui appartiennent à une catégorie spécifiée</span><span class="sxs-lookup"><span data-stu-id="85acd-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="85acd-172">**GetProductByProductID (*productID*)**, qui retourne des informations sur un produit particulier</span><span class="sxs-lookup"><span data-stu-id="85acd-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="85acd-173">Ces méthodes, lorsqu’elle est appelée, seront se connecter à la base de données, exécuter une requête appropriée et retourner les résultats.</span><span class="sxs-lookup"><span data-stu-id="85acd-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="85acd-174">Comment nous retournons ces résultats est important.</span><span class="sxs-lookup"><span data-stu-id="85acd-174">How we return these results is important.</span></span> <span data-ttu-id="85acd-175">Ces méthodes peut simplement retourner un jeu de données ou d’un DataReader rempli par la requête de base de données, mais dans l’idéal, ces résultats doivent être retournés à l’aide de *objets fortement typés*.</span><span class="sxs-lookup"><span data-stu-id="85acd-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="85acd-176">Un objet fortement typé est un dont le schéma est préconçus strictement défini au moment de la compilation, tandis que l’inverse, un objet faiblement typé, est un dont le schéma n’est pas connu jusqu'à l’exécution.</span><span class="sxs-lookup"><span data-stu-id="85acd-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="85acd-177">Par exemple, le DataReader et le jeu de données (par défaut) sont des objets faiblement typé, car leur schéma est défini par les colonnes retournées par la requête de base de données utilisée pour les remplir.</span><span class="sxs-lookup"><span data-stu-id="85acd-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="85acd-178">Pour accéder à une colonne particulière d’un DataTable faiblement typé, nous devons utiliser une syntaxe comme : <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span><span class="sxs-lookup"><span data-stu-id="85acd-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span></span> <span data-ttu-id="85acd-179">Typage faible de la table de données dans cet exemple est exposée par le fait que nous avons besoin d’accéder au nom de colonne à l’aide d’une chaîne ou un index ordinal.</span><span class="sxs-lookup"><span data-stu-id="85acd-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="85acd-180">Une table de données fortement typées, quant à eux, aura chacune de ses colonnes implémentés en tant que propriétés, résultant dans le code qui ressemble à : <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span><span class="sxs-lookup"><span data-stu-id="85acd-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span></span>

<span data-ttu-id="85acd-181">Pour retourner des objets fortement typés, les développeurs peuvent créer leurs propres objets métier personnalisés ou utiliser des DataSets typés.</span><span class="sxs-lookup"><span data-stu-id="85acd-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="85acd-182">Un objet métier est implémenté par le développeur comme représente une classe dont les propriétés reflètent généralement les colonnes de la table sous-jacente de la base de données l’objet métier.</span><span class="sxs-lookup"><span data-stu-id="85acd-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="85acd-183">Un DataSet typé est une classe générée pour vous par Visual Studio basé sur un schéma de base de données et dont les membres sont fortement typées en fonction de ce schéma.</span><span class="sxs-lookup"><span data-stu-id="85acd-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="85acd-184">Le jeu de données typées elle-même se compose des classes qui étendent les classes ADO.NET DataSet, DataTable et DataRow.</span><span class="sxs-lookup"><span data-stu-id="85acd-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="85acd-185">En plus des tables de données fortement typées, typés incluent maintenant des TableAdapters, qui sont des classes avec des méthodes pour remplir les tables de données du jeu de données et la propagation des modifications dans les tables de données dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="85acd-186">Pour plus d’informations sur les avantages et inconvénients de l’utilisation de DataSets typés et des objets métier personnalisés, reportez-vous à [composants de conception de la couche données et en passant par le biais des couches de données](https://msdn.microsoft.com/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="85acd-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>


<span data-ttu-id="85acd-187">Nous allons utiliser des jeux de données fortement typées pour l’architecture des ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="85acd-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="85acd-188">La figure 3 illustre le flux de travail entre les différentes couches d’une application qui utilise des DataSet typés.</span><span class="sxs-lookup"><span data-stu-id="85acd-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="85acd-189">[![Tout Code d’accès aux données est relégués à la couche DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="85acd-190">**Figure 3**: Tout Code d’accès aux données est relégués à la couche DAL ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="85acd-191">Création d’un DataSet typé et un adaptateur de Table</span><span class="sxs-lookup"><span data-stu-id="85acd-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="85acd-192">Pour commencer à créer notre DAL, nous commençons par ajouter un DataSet typé à notre projet.</span><span class="sxs-lookup"><span data-stu-id="85acd-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="85acd-193">Pour ce faire, avec le bouton droit sur le nœud de projet dans l’Explorateur de solutions et choisissez Ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="85acd-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="85acd-194">Sélectionnez l’option de jeu de données à partir de la liste des modèles et nommez-le **Northwind.xsd**.</span><span class="sxs-lookup"><span data-stu-id="85acd-194">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>


<span data-ttu-id="85acd-195">[![Choisissez d’ajouter un nouveau jeu de données à votre projet](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="85acd-196">**Figure 4**: Choisissez d’ajouter un nouveau jeu de données à votre projet ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>


<span data-ttu-id="85acd-197">Après avoir cliqué sur Ajouter, lorsque vous êtes invité à ajouter le jeu de données pour le **application\_Code** dossier, cliquez sur Oui.</span><span class="sxs-lookup"><span data-stu-id="85acd-197">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="85acd-198">Le concepteur pour le DataSet typé s’affiche, et l’Assistant Configuration de TableAdapter démarre, ce qui vous permet d’ajouter votre premier TableAdapter au DataSet typé.</span><span class="sxs-lookup"><span data-stu-id="85acd-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="85acd-199">Un DataSet typé constitue une collection fortement typée des données ; Il est composé fortement typée d’instances de DataTable, chacun d’eux est à son tour composé d’instances de DataRow fortement typée.</span><span class="sxs-lookup"><span data-stu-id="85acd-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="85acd-200">Nous allons créer une table de données fortement typées pour chacune des tables de base de données sous-jacente dont nous avons besoin pour travailler dans cette série de didacticiels.</span><span class="sxs-lookup"><span data-stu-id="85acd-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="85acd-201">Nous allons commencer par la création d’un DataTable pour le **produits** table.</span><span class="sxs-lookup"><span data-stu-id="85acd-201">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="85acd-202">N’oubliez pas que les tables de données fortement typées n’incluent pas toutes les informations sur l’accès aux données à partir de leur table de base de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="85acd-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="85acd-203">Afin de récupérer les données pour remplir le DataTable, nous utilisons une classe TableAdapter, qui fonctionne comme notre couche d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="85acd-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="85acd-204">Pour notre **produits** DataTable, le TableAdapter contiendra les méthodes **GetProducts()**, **GetProductByCategoryID (*categoryID*)**, et ainsi de suite que nous allons appeler à partir de la couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="85acd-204">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="85acd-205">Rôle du DataTable est de servir en tant que les objets fortement typés permettant de passer des données entre les couches.</span><span class="sxs-lookup"><span data-stu-id="85acd-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="85acd-206">L’Assistant Configuration de TableAdapter commence par vous invitant à sélectionner la base de données à utiliser.</span><span class="sxs-lookup"><span data-stu-id="85acd-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="85acd-207">La liste déroulante affiche ces bases de données dans l’Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="85acd-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="85acd-208">Si vous n’avez pas ajouté à la base de données Northwind à l’Explorateur de serveurs, vous pouvez cliquer sur le bouton Nouvelle connexion pour l’instant à le faire.</span><span class="sxs-lookup"><span data-stu-id="85acd-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="85acd-209">[![Choisissez la base de données Northwind dans la liste déroulante](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="85acd-210">**Figure 5**: Choisissez la base de données Northwind dans la liste déroulante ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>


<span data-ttu-id="85acd-211">Après avoir sélectionné la base de données et en cliquant sur Suivant, vous demandera si vous souhaitez enregistrer la chaîne de connexion dans le **Web.config** fichier.</span><span class="sxs-lookup"><span data-stu-id="85acd-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="85acd-212">En enregistrant la chaîne de connexion, vous éviterez en fait, il dur codé dans les classes TableAdapter, ce qui simplifie les choses si les informations de chaîne de connexion changent à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="85acd-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="85acd-213">Si vous optez pour enregistrer la chaîne de connexion dans le fichier de configuration, il est placé dans le **&lt;connectionStrings&gt;** section, ce qui peut être [éventuellement chiffré](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) améliorées sécurité ou modifiés ultérieurement par le biais de la nouvelle Page de propriété ASP.NET 2.0 au sein de l’outil d’administration de l’interface graphique utilisateur IIS, qui est plus idéale pour les administrateurs.</span><span class="sxs-lookup"><span data-stu-id="85acd-213">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="85acd-214">[![Enregistrer la chaîne de connexion dans Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="85acd-215">**Figure 6**: Enregistrer la chaîne de connexion à **Web.config** ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-215">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>


<span data-ttu-id="85acd-216">Ensuite, nous devons définir le schéma pour le premier DataTable fortement typée et fournir la première méthode pour notre TableAdapter à utiliser lors du remplissage du DataSet fortement typée.</span><span class="sxs-lookup"><span data-stu-id="85acd-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="85acd-217">Ces deux étapes sont réalisées simultanément en créant une requête qui retourne les colonnes de la table que nous voulons reflétées dans notre DataTable.</span><span class="sxs-lookup"><span data-stu-id="85acd-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="85acd-218">À la fin de l’Assistant, nous allons donner un nom de méthode pour cette requête.</span><span class="sxs-lookup"><span data-stu-id="85acd-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="85acd-219">Une fois que qui a été accompli, cette méthode peut être appelée à partir de notre couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="85acd-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="85acd-220">La méthode exécute la requête définie et remplir un DataTable fortement typée.</span><span class="sxs-lookup"><span data-stu-id="85acd-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="85acd-221">Pour commencer la définition de la requête SQL, nous devons tout d’abord indiquer comment nous voulons le TableAdapter pour émettre la requête.</span><span class="sxs-lookup"><span data-stu-id="85acd-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="85acd-222">Nous pouvons utiliser d’instruction SQL ad hoc, créez une nouvelle procédure stockée ou utiliser une procédure stockée existante.</span><span class="sxs-lookup"><span data-stu-id="85acd-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="85acd-223">Pour ces didacticiels, nous utiliserons des instructions SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="85acd-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="85acd-224">Reportez-vous à [Brian Noyes](http://briannoyes.net/)de l’article, [créer une couche d’accès aux données avec le Concepteur de DataSet Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) pour obtenir un exemple d’utilisation de procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="85acd-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="85acd-225">[![Interroger les données à l’aide d’une instruction SQL de Ad-Hoc](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="85acd-226">**Figure 7**: Interroger les données à l’aide d’une instruction SQL de Ad-Hoc ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>


<span data-ttu-id="85acd-227">À ce stade nous pouvons saisir dans la requête SQL manuellement.</span><span class="sxs-lookup"><span data-stu-id="85acd-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="85acd-228">Lors de la création de la première méthode du TableAdapter vous souhaitez généralement que la requête retourne les colonnes qui doivent être exprimés dans le DataTable.</span><span class="sxs-lookup"><span data-stu-id="85acd-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="85acd-229">Nous pouvons le faire en créant une requête qui retourne toutes les colonnes et toutes les lignes de la **produits** table :</span><span class="sxs-lookup"><span data-stu-id="85acd-229">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>


<span data-ttu-id="85acd-230">[![Entrez la requête SQL dans la zone de texte](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="85acd-231">**Figure 8**: Entrez la requête SQL dans le Textbox ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>


<span data-ttu-id="85acd-232">Vous pouvez également utiliser le Générateur de requêtes et de construire graphiquement la requête, comme illustré à la Figure 9.</span><span class="sxs-lookup"><span data-stu-id="85acd-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="85acd-233">[![Créer la requête sous forme de graphique, par le biais de l’éditeur de requête](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="85acd-234">**Figure 9**: Créer la requête sous forme graphique, par le biais de l’éditeur de requête ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>


<span data-ttu-id="85acd-235">Après avoir créé la requête, mais avant de passer à l’écran suivant, cliquez sur le bouton Options avancées.</span><span class="sxs-lookup"><span data-stu-id="85acd-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="85acd-236">Dans les projets de Site Web, « générer, mise à jour, instructions Insert et Delete » est la seule option activée par défaut ; avancée Si vous exécutez cet Assistant à partir d’une bibliothèque de classes ou d’un projet Windows l’option « Utiliser l’accès concurrentiel optimiste » sera également être sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="85acd-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="85acd-237">Laissez l’option « Utiliser l’accès concurrentiel optimiste » désactivée pour l’instant.</span><span class="sxs-lookup"><span data-stu-id="85acd-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="85acd-238">Nous allons examiner l’accès concurrentiel optimiste dans les didacticiels futures.</span><span class="sxs-lookup"><span data-stu-id="85acd-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="85acd-239">[![Sélectionnez uniquement les instructions générer Insert, Update et Delete Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="85acd-240">**Figure 10**: Sélectionnez uniquement les instructions générer Insert, Update et Delete Option ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>


<span data-ttu-id="85acd-241">Après avoir vérifié les options avancées, cliquez sur Suivant pour passer à l’écran final.</span><span class="sxs-lookup"><span data-stu-id="85acd-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="85acd-242">Ici nous avons invités à sélectionner les méthodes à ajouter au TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="85acd-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="85acd-243">Il existe deux modèles de remplissage des données :</span><span class="sxs-lookup"><span data-stu-id="85acd-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="85acd-244">**Remplir un DataTable** avec cette approche est de créer une méthode qui prend un DataTable en tant que paramètre et le remplit en fonction des résultats de la requête.</span><span class="sxs-lookup"><span data-stu-id="85acd-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="85acd-245">La classe DataAdapter ADO.NET, par exemple, implémente ce modèle avec son **Fill()** (méthode).</span><span class="sxs-lookup"><span data-stu-id="85acd-245">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="85acd-246">**Retourner un DataTable** avec cette approche de la méthode crée et remplit la table de données pour vous et le retourne comme valeur de retour de méthodes.</span><span class="sxs-lookup"><span data-stu-id="85acd-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="85acd-247">Vous pouvez avoir le TableAdapter à implémenter une ou les deux de ces modèles.</span><span class="sxs-lookup"><span data-stu-id="85acd-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="85acd-248">Vous pouvez également renommer les méthodes fournies ici.</span><span class="sxs-lookup"><span data-stu-id="85acd-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="85acd-249">Laissez les cases cochées, bien que nous utiliserons uniquement ce dernier modèle tout au long de ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="85acd-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="85acd-250">Nous allons renommer également, au lieu de cela générique **GetData** méthode **GetProducts**.</span><span class="sxs-lookup"><span data-stu-id="85acd-250">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="85acd-251">Si elle est activée, la case à cocher finale, « GenerateDBDirectMethods, » crée **Insert()**, **Update()**, et **Delete()** méthodes du TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="85acd-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="85acd-252">Si vous laissez cette option désactivée, toutes les mises à jour doit être effectuée via la seule du TableAdapter **Update()** (méthode), qui accepte le jeu de données typé, un DataTable, un seul objet DataRow ou un tableau de DataRows.</span><span class="sxs-lookup"><span data-stu-id="85acd-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="85acd-253">(Si vous avez désactivé les « générer Insert, Update et Delete instructions » option à partir des propriétés avancées dans la Figure 9, cette case à cocher paramètre n’a aucun effet.) Laissez cette case à cocher activée.</span><span class="sxs-lookup"><span data-stu-id="85acd-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="85acd-254">[![Diffère de nom de la méthode GetData GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="85acd-255">**Figure 11**: Modifier le nom de la méthode à partir de **GetData** à **GetProducts** ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-255">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>


<span data-ttu-id="85acd-256">Terminez l’Assistant en cliquant sur Terminer.</span><span class="sxs-lookup"><span data-stu-id="85acd-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="85acd-257">Une fois que l’Assistant se ferme, nous revenons au Concepteur de DataSet qui affiche la table de données que nous venons de créer.</span><span class="sxs-lookup"><span data-stu-id="85acd-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="85acd-258">Vous pouvez voir la liste des colonnes dans le **produits** DataTable (**ProductID**, **ProductName**, et ainsi de suite), ainsi que les méthodes de la  **ProductsTableAdapter** (**Fill()** et **GetProducts()**).</span><span class="sxs-lookup"><span data-stu-id="85acd-258">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>


<span data-ttu-id="85acd-259">[![Le DataTable de produits et ProductsTableAdapter ont été ajoutés au DataSet typé](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="85acd-260">**Figure 12**: Le **produits** DataTable et **ProductsTableAdapter** ont été ajoutés au DataSet typé ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-260">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>


<span data-ttu-id="85acd-261">À ce stade, nous avons un DataSet typé avec un seul objet DataTable (**Northwind.Products**) et une classe fortement typée de DataAdapter (**NorthwindTableAdapters.ProductsTableAdapter**) avec un  **GetProducts()** (méthode).</span><span class="sxs-lookup"><span data-stu-id="85acd-261">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="85acd-262">Ces objets peuvent être utilisés pour accéder à une liste de tous les produits à partir de code tel que :</span><span class="sxs-lookup"><span data-stu-id="85acd-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="85acd-263">Ce code ne nécessitait pas nous écrire un peu de code d’accès spécifique de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="85acd-264">Nous n’avait pas d’instancier des classes ADO.NET, nous n’avions pas à faire référence à des chaînes de connexion, les requêtes SQL, ou des procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="85acd-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="85acd-265">Au lieu de cela, le TableAdapter fournit le code d’accès aux données de bas niveau pour nous.</span><span class="sxs-lookup"><span data-stu-id="85acd-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="85acd-266">Chaque objet utilisé dans cet exemple est également fortement typées, ce qui permet de Visual Studio fournir IntelliSense et la vérification du type de compilation.</span><span class="sxs-lookup"><span data-stu-id="85acd-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="85acd-267">Et le meilleur de toutes les tables de données retournés par le TableAdapter peut être lié aux données ASP.NET Web contrôles, tels que le contrôle GridView, DetailsView, DropDownList, CheckBoxList et plusieurs autres.</span><span class="sxs-lookup"><span data-stu-id="85acd-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="85acd-268">L’exemple suivant illustre la liaison le DataTable retourné par la **GetProducts()** méthode sur un GridView dans un incomplètes trois lignes de code seulement dans le **Page\_charge** Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="85acd-268">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="85acd-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="85acd-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="85acd-270">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="85acd-270">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]


<span data-ttu-id="85acd-271">[![La liste de produits s’affiche dans un GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="85acd-272">**Figure 13**: La liste de produits s’affiche dans un GridView ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>


<span data-ttu-id="85acd-273">Bien que cet exemple obligatoire que nous écrivons les trois lignes de code dans notre page ASP.NET **Page\_charge** Gestionnaire d’événements, dans un avenir didacticiels, nous allons examiner l’utilisation de l’ObjectDataSource pour extraire des données de façon déclarative le LA COUCHE DAL.</span><span class="sxs-lookup"><span data-stu-id="85acd-273">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="85acd-274">Avec ObjectDataSource, nous n’aurez pas à écrire du code et obtiendra également en charge la pagination et tri !</span><span class="sxs-lookup"><span data-stu-id="85acd-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="85acd-275">Étape 3 : Ajout de paramétrables de méthodes pour la couche d’accès aux données</span><span class="sxs-lookup"><span data-stu-id="85acd-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="85acd-276">À ce stade notre **ProductsTableAdapter** classe ne possède qu’une seule méthode, **GetProducts()**, qui retourne tous les produits dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-276">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="85acd-277">S’il est sans aucun doute utile de pouvoir travailler avec tous les produits, voici les heures lorsque nous devrons pour récupérer des informations sur un produit spécifique ou tous les produits qui appartiennent à une catégorie particulière.</span><span class="sxs-lookup"><span data-stu-id="85acd-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="85acd-278">Pour ajouter ces fonctionnalités à notre couche d’accès aux données, nous pouvons ajouter des méthodes paramétrables au TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="85acd-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="85acd-279">Nous allons ajouter le **GetProductsByCategoryID (*categoryID*)** (méthode).</span><span class="sxs-lookup"><span data-stu-id="85acd-279">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="85acd-280">Pour ajouter une nouvelle méthode à la couche DAL, retournez dans le Concepteur de DataSet, cliquez sur le **ProductsTableAdapter** section, puis choisissez Ajouter une requête.</span><span class="sxs-lookup"><span data-stu-id="85acd-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>


![Avec le bouton droit sur le TableAdapter et choisissez Ajouter une requête](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="85acd-282">**Figure 14**: Avec le bouton droit sur le TableAdapter et choisissez Ajouter une requête</span><span class="sxs-lookup"><span data-stu-id="85acd-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="85acd-283">Nous allons tout d’abord invité à indiquer si nous souhaitons accéder à la base de données à l’aide d’une instruction de SQL ad hoc ou d’une procédure stockée nouveau ou existante.</span><span class="sxs-lookup"><span data-stu-id="85acd-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="85acd-284">Nous allons choisir d’utiliser une instruction SQL ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="85acd-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="85acd-285">Ensuite, nous avons demandés quel type de requête SQL que nous souhaitons utiliser.</span><span class="sxs-lookup"><span data-stu-id="85acd-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="85acd-286">Dans la mesure où nous voulons renvoyer tous les produits qui appartiennent à une catégorie spécifiée, nous souhaitons écrire un **sélectionnez** instruction qui retourne des lignes.</span><span class="sxs-lookup"><span data-stu-id="85acd-286">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>


<span data-ttu-id="85acd-287">[![Choisissez de créer une instruction SELECT qui retourne des lignes](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="85acd-288">**Figure 15**: Choisissez de créer un **sélectionnez** instruction qui retourne les lignes ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-288">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>


<span data-ttu-id="85acd-289">L’étape suivante consiste à définir la requête SQL utilisée pour accéder aux données.</span><span class="sxs-lookup"><span data-stu-id="85acd-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="85acd-290">Dans la mesure où nous voulons renvoyer uniquement les produits qui appartiennent à une catégorie particulière, j’utilise le même <strong>sélectionnez</strong> instruction à partir de <strong>GetProducts()</strong>, mais ajoutez le code suivant <strong>où</strong> clause : <strong>OÙ CategoryID = @CategoryID</strong> .</span><span class="sxs-lookup"><span data-stu-id="85acd-290">Since we want to return only those products that belong to a particular category, I use the same <strong>SELECT</strong> statement from <strong>GetProducts()</strong>, but add the following <strong>WHERE</strong> clause: <strong>WHERE CategoryID = @CategoryID</strong>.</span></span> <span data-ttu-id="85acd-291">Le <strong>@CategoryID</strong> paramètre indique à l’Assistant TableAdapter que la méthode que nous créons nécessite un paramètre d’entrée du type correspondant (à savoir, un entier nullable).</span><span class="sxs-lookup"><span data-stu-id="85acd-291">The <strong>@CategoryID</strong> parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="85acd-292">[![Entrez une requête pour retourner uniquement les produits dans une catégorie spécifiée](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="85acd-293">**Figure 16**: Entrez une requête pour retourner uniquement les produits dans une catégorie spécifiée ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>


<span data-ttu-id="85acd-294">Dans la dernière étape que nous pouvons choisir les modèles à utiliser, ainsi que de personnaliser les noms des méthodes générées d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="85acd-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="85acd-295">Pour le motif de remplissage, nous allons modifier le nom à <strong>FillByCategoryID</strong> et pour la valeur de retour un DataTable retourner le modèle (le <strong>obtenir*X</strong>*  méthodes), nous allons utiliser  <strong>GetProductsByCategoryID</strong>.</span><span class="sxs-lookup"><span data-stu-id="85acd-295">For the Fill pattern, let's change the name to <strong>FillByCategoryID</strong> and for the return a DataTable return pattern (the <strong>Get*X</strong>* methods), let's use <strong>GetProductsByCategoryID</strong>.</span></span>


<span data-ttu-id="85acd-296">[![Choisissez les noms pour les méthodes TableAdapter](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="85acd-297">**Figure 17**: Choisissez les noms pour les méthodes TableAdapter ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>


<span data-ttu-id="85acd-298">À l’issue de l’Assistant, le Concepteur de DataSet inclut les nouvelles méthodes TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="85acd-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![Les produits peuvent maintenant être interrogées par catégorie](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="85acd-300">**Figure 18**: Les produits peuvent maintenant être interrogées par catégorie</span><span class="sxs-lookup"><span data-stu-id="85acd-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="85acd-301">Prenez un moment pour ajouter un **GetProductByProductID (*productID*)** méthode à l’aide de la même technique.</span><span class="sxs-lookup"><span data-stu-id="85acd-301">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="85acd-302">Ces requêtes paramétrables peuvent être testées directement depuis le Concepteur de DataSet.</span><span class="sxs-lookup"><span data-stu-id="85acd-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="85acd-303">Avec le bouton droit sur la méthode du TableAdapter et choisissez Aperçu des données.</span><span class="sxs-lookup"><span data-stu-id="85acd-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="85acd-304">Ensuite, entrez les valeurs à utiliser pour les paramètres et cliquez sur Aperçu.</span><span class="sxs-lookup"><span data-stu-id="85acd-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="85acd-305">[![Ces appartenant produits à la catégorie boissons sont affichés.](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="85acd-306">**Figure 19**: Ces appartenant produits à la catégorie boissons sont affichés ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>


<span data-ttu-id="85acd-307">Avec le **GetProductsByCategoryID (*categoryID*)** méthode dans notre DAL, nous pouvons maintenant créer une page ASP.NET qui affiche uniquement les produits dans une catégorie spécifiée.</span><span class="sxs-lookup"><span data-stu-id="85acd-307">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="85acd-308">L’exemple suivant affiche tous les produits qui se trouvent dans la catégorie des boissons, et qui ont un **CategoryID** de 1.</span><span class="sxs-lookup"><span data-stu-id="85acd-308">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="85acd-309">Beverages.ASP</span><span class="sxs-lookup"><span data-stu-id="85acd-309">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="85acd-310">Beverages.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="85acd-310">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]


<span data-ttu-id="85acd-311">[![Ces produits de la catégorie boissons sont affichés.](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="85acd-312">**Figure 20**: Ces produits de la catégorie boissons sont affichés ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="85acd-313">Étape 4 : Insertion, mise à jour et suppression de données</span><span class="sxs-lookup"><span data-stu-id="85acd-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="85acd-314">Il existe deux modèles couramment utilisés pour l’insertion, la mise à jour et suppression de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="85acd-315">Le premier modèle, que j’appellerai le modèle direct de base de données, implique la création de méthodes qui, lorsqu’elle est appelée, problème un **insérer**, **mise à jour**, ou **supprimer** commande à la base de données qui fonctionne sur un enregistrement de base de données unique.</span><span class="sxs-lookup"><span data-stu-id="85acd-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="85acd-316">Ces méthodes sont généralement transmis dans une série de valeurs scalaires (entiers, chaînes, valeurs booléennes, dates/heures et ainsi de suite) qui correspondent aux valeurs à insérer, mettre à jour ou supprimer.</span><span class="sxs-lookup"><span data-stu-id="85acd-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="85acd-317">Par exemple, avec ce modèle pour le **produits** table, la méthode delete prendrait dans un paramètre de type entier indiquant le **ProductID** de l’enregistrement à supprimer, tandis que la méthode d’insertion prendrait un chaîne pour le **ProductName**, un décimal pour la **UnitPrice**, un entier pour le **UnitsOnStock**, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="85acd-317">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>


<span data-ttu-id="85acd-318">[![Chaque insertion, mise à jour et supprimer la demande sont envoyée à la base de données immédiatement](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="85acd-319">**Figure 21**: Chaque insertion, mise à jour et supprimer la demande sont envoyée à la base de données immédiatement ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>


<span data-ttu-id="85acd-320">L’autre modèle, je me référerai à dans le lot de mises à jour de modèle, consiste à mettre à jour d’un DataSet, DataTable ou collection de DataRows dans un appel de méthode ensemble.</span><span class="sxs-lookup"><span data-stu-id="85acd-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="85acd-321">Avec ce modèle un développeur supprime, insère et modifie les DataRows dans un DataTable, puis transmet ces objets DataRow ou un DataTable dans une méthode de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="85acd-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="85acd-322">Puis cette méthode énumère les DataRows transmis, détermine s’ils ont été modifiés, ajoutés ou supprimés (via le DataRow [propriété RowState](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) valeur) et émet la demande de base de données appropriée pour chaque enregistrement.</span><span class="sxs-lookup"><span data-stu-id="85acd-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="85acd-323">[![Toutes les modifications sont synchronisées avec la base de données lorsque la méthode de mise à jour est appelée.](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="85acd-324">**Figure 22**: Toutes les modifications sont synchronisées avec la base de données lorsque la méthode de mise à jour est appelée ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>


<span data-ttu-id="85acd-325">Le TableAdapter utilise le modèle de mise à jour de lot par défaut, mais prend également en charge le modèle de base de données directe.</span><span class="sxs-lookup"><span data-stu-id="85acd-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="85acd-326">Étant donné que nous avons sélectionné l’option « Générer, mise à jour, instructions Insert et Delete » à partir des propriétés avancées lors de la création de notre TableAdapter, le **ProductsTableAdapter** contient un **Update()** (méthode), qui implémente le modèle de mise à jour par lots.</span><span class="sxs-lookup"><span data-stu-id="85acd-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="85acd-327">Plus précisément, le TableAdapter contient un **Update()** méthode qui peut être passée pour le jeu de données typé, un DataTable fortement typée ou DataRows un ou plusieurs.</span><span class="sxs-lookup"><span data-stu-id="85acd-327">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="85acd-328">Si vous avez laissé la case à cocher « GenerateDBDirectMethods » cochée lorsque créant d’abord le TableAdapter le modèle direct de base de données sera également implémentée par le biais de **Insert()**, **Update()**, et **Delete()**  méthodes.</span><span class="sxs-lookup"><span data-stu-id="85acd-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="85acd-329">Les deux modèles de modification de données utilisent le TableAdapter **InsertCommand**, **UpdateCommand**, et **DeleteCommand** propriétés émettre leurs **insérer** , **Mise à jour**, et **supprimer** commandes pour la base de données.</span><span class="sxs-lookup"><span data-stu-id="85acd-329">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="85acd-330">Vous pouvez inspecter et modifier le **InsertCommand**, **UpdateCommand**, et **DeleteCommand** propriétés en cliquant sur le TableAdapter dans le Concepteur de DataSet et en accédant ensuite dans la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="85acd-330">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="85acd-331">(Vérifiez que vous avez sélectionné le TableAdapter et qui le **ProductsTableAdapter** objet est celui sélectionné dans la liste déroulante dans la fenêtre Propriétés.)</span><span class="sxs-lookup"><span data-stu-id="85acd-331">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="85acd-332">[![Le TableAdapter a InsertCommand, UpdateCommand et DeleteCommand propriétés](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="85acd-333">**Figure 23**: Le TableAdapter a **InsertCommand**, **UpdateCommand**, et **DeleteCommand** propriétés ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-333">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>


<span data-ttu-id="85acd-334">Pour examiner ou modifier ces propriétés de commande de base de données, cliquez sur le **CommandText** sous-propriété, qui ouvre le Générateur de requêtes.</span><span class="sxs-lookup"><span data-stu-id="85acd-334">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="85acd-335">[![Configurer le INSERT, UPDATE et instructions DELETE dans le Générateur de requêtes](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="85acd-336">**Figure 24**: Configurer le **insérer**, **mise à jour**, et **supprimer** instructions dans le Générateur de requêtes ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-336">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>


<span data-ttu-id="85acd-337">L’exemple de code suivant montre comment utiliser le modèle de mise à jour par lots à doubler le prix de tous les produits qui ne sont pas supprimées et qui ont des 25 unités en stock ou moins :</span><span class="sxs-lookup"><span data-stu-id="85acd-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="85acd-338">Le code ci-dessous illustre comment utiliser le modèle direct de base de données par programmation supprimer un produit particulier, puis mettre à jour un et ajouter un nouveau :</span><span class="sxs-lookup"><span data-stu-id="85acd-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="85acd-339">Création personnalisée Insert, Update, méthodes et Delete</span><span class="sxs-lookup"><span data-stu-id="85acd-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="85acd-340">Le **Insert()**, **Update()**, et **Delete()** méthodes créées par la méthode directe de base de données peuvent être un peu délicate, en particulier pour les tables avec plusieurs colonnes.</span><span class="sxs-lookup"><span data-stu-id="85acd-340">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="85acd-341">Examinez l’exemple de code précédent, sans IntelliSense aide n’est pas particulièrement claire que **produits** colonne de table est mappé à chaque paramètre d’entrée pour le **Update()** et **Insert()**  méthodes.</span><span class="sxs-lookup"><span data-stu-id="85acd-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="85acd-342">Il peut arriver lorsque nous ne souhaitons mettre à jour une seule colonne ou les deux, ou un texte personnalisé **Insert()** méthode qui sera, par exemple, retourner la valeur de l’enregistrement inséré **identité** (incrémentation automatique) champ.</span><span class="sxs-lookup"><span data-stu-id="85acd-342">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="85acd-343">Pour créer une telle méthode personnalisée, revenez dans le Concepteur de DataSet.</span><span class="sxs-lookup"><span data-stu-id="85acd-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="85acd-344">Avec le bouton droit sur le TableAdapter et choisissez Ajouter une requête, retour à l’Assistant TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="85acd-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="85acd-345">Sur le deuxième écran, nous pouvons indiquer le type de requête permettant de créer.</span><span class="sxs-lookup"><span data-stu-id="85acd-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="85acd-346">Nous allons créer une méthode qui ajoute un nouveau produit, puis retourne la valeur de l’enregistrement qui vient d’être ajouté **ProductID**.</span><span class="sxs-lookup"><span data-stu-id="85acd-346">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="85acd-347">Par conséquent, choisir de créer un **insérer** requête.</span><span class="sxs-lookup"><span data-stu-id="85acd-347">Therefore, opt to create an **INSERT** query.</span></span>


<span data-ttu-id="85acd-348">[![Créez une méthode pour ajouter une nouvelle ligne à la Table Products](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="85acd-349">**Figure 25**: Créez une méthode pour ajouter une nouvelle ligne à la **produits** Table ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-349">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>


<span data-ttu-id="85acd-350">Dans l’écran suivant le **InsertCommand**de **CommandText** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="85acd-350">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="85acd-351">Augmenter cette requête en ajoutant des **sélectionner une étendue\_Identity() ne** à la fin de la requête, qui retourne la dernière valeur identity insérée dans une **identité** colonne dans la même portée.</span><span class="sxs-lookup"><span data-stu-id="85acd-351">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="85acd-352">(Consultez le [documentation technique](https://msdn.microsoft.com/library/ms190315.aspx) pour plus d’informations sur **étendue\_Identity() ne** et pourquoi vous souhaiterez probablement [utiliser étendue\_Identity() n’à la place de @ @IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Assurez-vous que vous obtenez le **insérer** instruction par un point-virgule avant d’ajouter le **sélectionnez** instruction.</span><span class="sxs-lookup"><span data-stu-id="85acd-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>


<span data-ttu-id="85acd-353">[![Augmenter la requête pour retourner la valeur SCOPE_IDENTITY()](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="85acd-354">**Figure 26**: Augmenter le retour de la requête la **étendue\_Identity() ne** valeur ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-354">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>


<span data-ttu-id="85acd-355">Enfin, nommez la nouvelle méthode **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="85acd-355">Finally, name the new method **InsertProduct**.</span></span>


<span data-ttu-id="85acd-356">[![Définir le nouveau nom de méthode à InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="85acd-357">**Figure 27**: La valeur est le nouveau nom de méthode **InsertProduct** ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-357">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>


<span data-ttu-id="85acd-358">Lorsque vous revenez sur le Concepteur de DataSet vous verrez que le **ProductsTableAdapter** contient une nouvelle méthode, **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="85acd-358">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="85acd-359">Si cette nouvelle méthode n’a pas un paramètre pour chaque colonne dans le **produits** table, il est probable qu’est vous avez oublié de mettre fin à la **insérer** instruction par un point-virgule.</span><span class="sxs-lookup"><span data-stu-id="85acd-359">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="85acd-360">Configurer le **InsertProduct** (méthode) et assurez-vous d’avoir un point-virgule qui entourent le **insérer** et **sélectionnez** instructions.</span><span class="sxs-lookup"><span data-stu-id="85acd-360">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="85acd-361">Par défaut, insérer les méthodes de requête non de méthodes problème, ce qui signifie qu’elles retournent le nombre de lignes affectées.</span><span class="sxs-lookup"><span data-stu-id="85acd-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="85acd-362">Toutefois, nous voulons le **InsertProduct** méthode pour retourner la valeur retournée par la requête, et non le nombre de lignes affectées.</span><span class="sxs-lookup"><span data-stu-id="85acd-362">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="85acd-363">Pour ce faire, vous devez ajuster le **InsertProduct** la méthode **ExecuteMode** propriété **scalaire**.</span><span class="sxs-lookup"><span data-stu-id="85acd-363">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>


<span data-ttu-id="85acd-364">[![Remplacez la propriété ExecuteMode scalaire](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="85acd-365">**Figure 28**: Modifier le **ExecuteMode** propriété **scalaire** ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-365">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>


<span data-ttu-id="85acd-366">Le code suivant illustre cette nouvelle **InsertProduct** méthode en action :</span><span class="sxs-lookup"><span data-stu-id="85acd-366">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="85acd-367">Étape 5 : Fin de la couche d’accès aux données</span><span class="sxs-lookup"><span data-stu-id="85acd-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="85acd-368">Notez que le **ProductsTableAdapters** classe retourne la **CategoryID** et **SupplierID** valeurs à partir de la **produits** table, mais n’inclut pas le **CategoryName** colonne à partir de la **catégories** table ou la **CompanyName** colonne à partir de la **fournisseurs**table, bien qu’il s’agit probablement les colonnes que nous souhaitons afficher lors de l’affichage des informations sur le produit.</span><span class="sxs-lookup"><span data-stu-id="85acd-368">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="85acd-369">Nous pouvons augmenter la méthode du TableAdapter initiale, **GetProducts()**, à inclure à la fois le **CategoryName** et **CompanyName** les valeurs de colonne, qui met à jour le DataTable fortement typée pour inclure également ces nouvelles colonnes.</span><span class="sxs-lookup"><span data-stu-id="85acd-369">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="85acd-370">Cela peut poser un problème, cependant, comme les méthodes du TableAdapter pour l’insertion, la mise à jour, et suppression des données sont basées sur cette méthode initiale.</span><span class="sxs-lookup"><span data-stu-id="85acd-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="85acd-371">Heureusement, les méthodes générées automatiquement pour l’insertion, de la mise à jour et de suppression ne sont pas affectées par les sous-requêtes dans les **sélectionnez** clause.</span><span class="sxs-lookup"><span data-stu-id="85acd-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="85acd-372">En veillant à ajouter nos requêtes à **catégories** et **fournisseurs** comme des sous-requêtes, plutôt que **joindre** s, nous allons éviter d’avoir à retravailler ces méthodes de modification des données.</span><span class="sxs-lookup"><span data-stu-id="85acd-372">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="85acd-373">Avec le bouton droit sur le **GetProducts()** méthode dans le **ProductsTableAdapter** et choisissez configurer.</span><span class="sxs-lookup"><span data-stu-id="85acd-373">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="85acd-374">Ensuite, ajustez le **sélectionnez** clause afin qu’il se présente comme :</span><span class="sxs-lookup"><span data-stu-id="85acd-374">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]


<span data-ttu-id="85acd-375">[![Mettre à jour de l’instruction SELECT de la méthode GetProducts()](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="85acd-376">**Figure 29**: Mise à jour le **sélectionnez** instruction pour la **GetProducts()** (méthode) ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-376">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>


<span data-ttu-id="85acd-377">Après la mise à jour le **GetProducts()** méthode à utiliser cette nouvelle requête de la table de données inclut deux nouvelles colonnes : **CategoryName** et **intitulée**.</span><span class="sxs-lookup"><span data-stu-id="85acd-377">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>


![Le DataTable produits présente deux nouvelles colonnes](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="85acd-379">**Figure 30**: Le **produits** DataTable présente deux nouvelles colonnes</span><span class="sxs-lookup"><span data-stu-id="85acd-379">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>


<span data-ttu-id="85acd-380">Prenez un moment pour mettre à jour le **sélectionnez** clause dans la **GetProductsByCategoryID (*categoryID*)** méthode également.</span><span class="sxs-lookup"><span data-stu-id="85acd-380">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="85acd-381">Si vous mettez à jour le **GetProducts()** **sélectionnez** à l’aide de **joindre** syntaxe le Concepteur de DataSet ne pourrez pas générer automatiquement les méthodes d’insertion, de la mise à jour et de suppression les données de base de données à l’aide de la base de données dirigent de modèle.</span><span class="sxs-lookup"><span data-stu-id="85acd-381">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="85acd-382">Au lieu de cela, vous devrez créer manuellement les beaucoup, comme nous l’avons fait avec le **InsertProduct** méthode précédemment dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="85acd-382">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="85acd-383">En outre, vous devrez manuellement fournissent la **InsertCommand**, **UpdateCommand**, et **DeleteCommand** les valeurs de propriété si vous souhaitez utiliser le lot de mise à jour du modèle.</span><span class="sxs-lookup"><span data-stu-id="85acd-383">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="85acd-384">Ajouter les TableAdapters restants</span><span class="sxs-lookup"><span data-stu-id="85acd-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="85acd-385">Jusqu'à présent, nous avons examiné uniquement travailler avec un TableAdapter unique pour une table de base de données unique.</span><span class="sxs-lookup"><span data-stu-id="85acd-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="85acd-386">Toutefois, la base de données Northwind contient plusieurs tables associées que nous allons devoir travailler avec dans notre application web.</span><span class="sxs-lookup"><span data-stu-id="85acd-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="85acd-387">Un DataSet typé peut contenir plusieurs, liées DataTables.</span><span class="sxs-lookup"><span data-stu-id="85acd-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="85acd-388">Par conséquent, pour terminer notre DAL nous devons ajouter des tables de données pour les autres tables, que nous allons utiliser dans ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="85acd-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="85acd-389">Pour ajouter un nouveau TableAdapter à un DataSet typé, ouvrez le Concepteur de DataSet, avec le bouton droit dans le concepteur et choisissez Ajouter / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="85acd-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="85acd-390">Cela crée un nouveau DataTable et TableAdapter et vous guident tout au long de l’Assistant que nous avons examiné précédemment dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="85acd-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="85acd-391">Prenez quelques minutes pour créer des TableAdapters et les requêtes suivantes d’à l’aide des méthodes suivantes.</span><span class="sxs-lookup"><span data-stu-id="85acd-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="85acd-392">Notez que les requêtes dans le **ProductsTableAdapter** inclure de sous-requêtes pour récupérer les noms de catégorie et le fournisseur de chaque produit.</span><span class="sxs-lookup"><span data-stu-id="85acd-392">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="85acd-393">En outre, si vous avez suivi le long, vous avez déjà ajouté le **ProductsTableAdapter** la classe **GetProducts()** et **GetProductsByCategoryID (*categoryID\* )*\* méthodes.</span><span class="sxs-lookup"><span data-stu-id="85acd-393">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="85acd-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="85acd-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="85acd-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="85acd-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
  - <span data-ttu-id="85acd-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="85acd-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
  - <span data-ttu-id="85acd-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="85acd-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
  - <span data-ttu-id="85acd-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="85acd-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="85acd-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="85acd-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="85acd-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="85acd-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
  - <span data-ttu-id="85acd-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="85acd-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="85acd-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="85acd-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="85acd-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="85acd-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
  - <span data-ttu-id="85acd-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="85acd-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
  - <span data-ttu-id="85acd-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="85acd-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="85acd-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="85acd-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="85acd-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="85acd-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
  - <span data-ttu-id="85acd-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="85acd-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
  - <span data-ttu-id="85acd-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="85acd-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]


<span data-ttu-id="85acd-410">[![Le Concepteur de DataSet une fois que les quatre TableAdapters ont été ajoutés.](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="85acd-411">**Figure 31**: Le jeu de données concepteur après le quatre TableAdapters ont été ajoutés ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="85acd-412">Ajouter du Code personnalisé à la couche DAL</span><span class="sxs-lookup"><span data-stu-id="85acd-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="85acd-413">Les TableAdapters et les DataTables ajouté au jeu de données typé sont exprimées en tant qu’un fichier de définition de schéma XML (**Northwind.xsd**).</span><span class="sxs-lookup"><span data-stu-id="85acd-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="85acd-414">Vous pouvez afficher ces informations de schéma en cliquant sur le **Northwind.xsd** de fichiers dans l’Explorateur de solutions et en choisissant Afficher le Code.</span><span class="sxs-lookup"><span data-stu-id="85acd-414">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="85acd-415">[![Le fichier XML Schema Definition (XSD) pour le Northwind de DataSet typé](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="85acd-416">**Figure 32**: Le fichier de définition de schéma XML (XSD) pour le DataSet typé de Northwind ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>


<span data-ttu-id="85acd-417">Ces informations de schéma sont traduites en code C# ou Visual Basic au moment du design lorsque compilé ou lors de l’exécution (si nécessaire), après quoi vous pouvez détaillé avec le débogueur.</span><span class="sxs-lookup"><span data-stu-id="85acd-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="85acd-418">Pour afficher ce code généré automatiquement accédez à l’affichage de classes et l’extraction vers le bas pour les classes TableAdapter ou DataSet typée.</span><span class="sxs-lookup"><span data-stu-id="85acd-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="85acd-419">Si vous ne voyez pas l’affichage de classes sur votre écran, accédez au menu Affichage et sélectionnez-la à partir de là ou appuyez sur Ctrl + Maj + C.</span><span class="sxs-lookup"><span data-stu-id="85acd-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="85acd-420">À partir de l’affichage de classes, vous pouvez voir les propriétés, les méthodes et les événements des classes Typed DataSet et TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="85acd-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="85acd-421">Pour afficher le code pour une méthode particulière, double-cliquez sur le nom de méthode dans l’affichage de classes ou avec le bouton droit dessus et choisissez Atteindre la définition.</span><span class="sxs-lookup"><span data-stu-id="85acd-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Inspecter le Code généré automatiquement en sélectionnant Aller à la définition de l’affichage de classes](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="85acd-423">**Figure 33**: Inspecter le Code généré automatiquement en sélectionnant Aller à la définition de l’affichage de classes</span><span class="sxs-lookup"><span data-stu-id="85acd-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="85acd-424">Si le code généré automatiquement peut être économiser beaucoup de temps, le code est souvent très générique et doit être personnalisé pour répondre aux besoins uniques d’une application.</span><span class="sxs-lookup"><span data-stu-id="85acd-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="85acd-425">Le risque d’étendre le code généré automatiquement, cependant, est que l’outil qui a généré le code peut décider, qu'il est temps de « régénérer » et d’écraser vos personnalisations.</span><span class="sxs-lookup"><span data-stu-id="85acd-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="85acd-426">Avec le nouveau concept d’une classe partielle de .NET 2.0, il est facile fractionner une classe dans plusieurs fichiers.</span><span class="sxs-lookup"><span data-stu-id="85acd-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="85acd-427">Cela permet d’ajouter nos propres méthodes, les propriétés et les événements pour les classes générées automatiquement sans avoir à vous soucier de remplacer notre personnalisations de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="85acd-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="85acd-428">Pour illustrer comment personnaliser la couche DAL, nous allons ajouter un **GetProducts()** méthode à la **SuppliersRow** classe.</span><span class="sxs-lookup"><span data-stu-id="85acd-428">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="85acd-429">Le **SuppliersRow** classe représente un enregistrement unique dans le **fournisseurs** table ; chaque fournisseur de peut fournisseur zéro pour nombreux produits, donc **GetProducts()** retournera ceux produits du fournisseur spécifié.</span><span class="sxs-lookup"><span data-stu-id="85acd-429">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="85acd-430">Pour accomplir cela créer un nouveau fichier de classe dans le **application\_Code** dossier nommé **SuppliersRow.cs** et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="85acd-430">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="85acd-431">Cette classe partielle indique au compilateur qu’au moment où créer le **Northwind.SuppliersRow** classe pour inclure le **GetProducts()** méthode que nous venons de définir.</span><span class="sxs-lookup"><span data-stu-id="85acd-431">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="85acd-432">Si vous générez votre projet et puis revenez à l’affichage de classes que vous verrez **GetProducts()** maintenant répertorié en tant que méthode de **Northwind.SuppliersRow**.</span><span class="sxs-lookup"><span data-stu-id="85acd-432">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>


![La méthode GetProducts() est désormais une partie de la classe Northwind.SuppliersRow](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="85acd-434">**Figure 34**: Le **GetProducts()** méthode fait désormais partie de la **Northwind.SuppliersRow** classe</span><span class="sxs-lookup"><span data-stu-id="85acd-434">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>


<span data-ttu-id="85acd-435">Le **GetProducts()** méthode peut maintenant être utilisée pour énumérer l’ensemble des produits pour un fournisseur particulier, comme le montre le code suivant :</span><span class="sxs-lookup"><span data-stu-id="85acd-435">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="85acd-436">Ces données peuvent également être affichées dans les ASP. Données de NET contrôles Web.</span><span class="sxs-lookup"><span data-stu-id="85acd-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="85acd-437">La page suivante utilise un contrôle GridView avec deux champs :</span><span class="sxs-lookup"><span data-stu-id="85acd-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="85acd-438">Un BoundField qui affiche le nom de chaque fournisseur, et</span><span class="sxs-lookup"><span data-stu-id="85acd-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="85acd-439">TemplateField qui contient un contrôle BulletedList qui est lié aux résultats retournés par la **GetProducts()** méthode pour chaque fournisseur.</span><span class="sxs-lookup"><span data-stu-id="85acd-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="85acd-440">Nous allons examiner comment afficher ces rapports maître / détail dans les didacticiels futures.</span><span class="sxs-lookup"><span data-stu-id="85acd-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="85acd-441">Pour l’instant, cet exemple est conçu pour illustrer l’utilisation de la méthode personnalisée ajoutée à la **Northwind.SuppliersRow** classe.</span><span class="sxs-lookup"><span data-stu-id="85acd-441">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="85acd-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="85acd-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="85acd-443">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="85acd-443">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]


<span data-ttu-id="85acd-444">[![Nom de la société du fournisseur est répertorié dans la colonne de gauche, leurs produits dans la droite](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="85acd-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="85acd-445">**Figure 35**: Nom de la société du fournisseur est répertorié dans la colonne de gauche, leurs produits dans la droite ([cliquez pour afficher l’image en taille réelle](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="85acd-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="85acd-446">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="85acd-446">Summary</span></span>

<span data-ttu-id="85acd-447">Lorsque la création d’une application web de création de la DAL doit être une des premières étapes à suivre avant de commencer à créer votre couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="85acd-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="85acd-448">Avec Visual Studio, la création d’une DAL basée sur des DataSet typés est une tâche qui peut être accomplie en 10 à 15 minutes sans écrire une ligne de code.</span><span class="sxs-lookup"><span data-stu-id="85acd-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="85acd-449">Les didacticiels en progressant seront appuie sur cette couche DAL.</span><span class="sxs-lookup"><span data-stu-id="85acd-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="85acd-450">Dans le [didacticiel suivant](creating-a-business-logic-layer-cs.md) nous allons définir un nombre de règles d’entreprise et voir comment les implémenter dans une couche de logique métier distincts.</span><span class="sxs-lookup"><span data-stu-id="85acd-450">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="85acd-451">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="85acd-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="85acd-452">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="85acd-452">Further Reading</span></span>

<span data-ttu-id="85acd-453">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="85acd-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="85acd-454">Création d’une DAL à l’aide de fortement typée des TableAdapters et les tables de données dans Visual Studio 2005 et ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="85acd-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="85acd-455">Conception des composants de la couche données et passer des données via des niveaux</span><span class="sxs-lookup"><span data-stu-id="85acd-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="85acd-456">Créer une couche d’accès aux données avec le Concepteur de DataSet Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="85acd-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="85acd-457">Chiffrement des informations de Configuration dans ASP.NET 2.0 Applications</span><span class="sxs-lookup"><span data-stu-id="85acd-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="85acd-458">Vue d’ensemble de TableAdapter</span><span class="sxs-lookup"><span data-stu-id="85acd-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="85acd-459">Utilisation d’un DataSet typé</span><span class="sxs-lookup"><span data-stu-id="85acd-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="85acd-460">Utilisation de l’accès des données fortement typées dans Visual Studio 2005 et ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="85acd-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="85acd-461">Comment étendre les méthodes TableAdapter</span><span class="sxs-lookup"><span data-stu-id="85acd-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="85acd-462">Récupération de données scalaire à partir d’une procédure stockée</span><span class="sxs-lookup"><span data-stu-id="85acd-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="85acd-463">Vidéos de formation sur les rubriques contenues dans ce didacticiel</span><span class="sxs-lookup"><span data-stu-id="85acd-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="85acd-464">Couches d’accès aux données dans les applications ASP.NET</span><span class="sxs-lookup"><span data-stu-id="85acd-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="85acd-465">Comment lier manuellement un jeu de données à un contrôle Datagrid</span><span class="sxs-lookup"><span data-stu-id="85acd-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="85acd-466">Utilisation des jeux de données et les filtres à partir d’une Application ASP</span><span class="sxs-lookup"><span data-stu-id="85acd-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="85acd-467">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="85acd-467">About the Author</span></span>

<span data-ttu-id="85acd-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="85acd-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="85acd-469">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="85acd-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="85acd-470">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="85acd-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="85acd-471">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="85acd-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="85acd-472">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="85acd-472">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="85acd-473">Remerciements</span><span class="sxs-lookup"><span data-stu-id="85acd-473">Special Thanks To</span></span>

<span data-ttu-id="85acd-474">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="85acd-474">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="85acd-475">Les réviseurs tête pour ce didacticiel ont été Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez et Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="85acd-475">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="85acd-476">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="85acd-476">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="85acd-477">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="85acd-477">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="85acd-478">Next</span><span class="sxs-lookup"><span data-stu-id="85acd-478">Next</span></span>](creating-a-business-logic-layer-cs.md)
