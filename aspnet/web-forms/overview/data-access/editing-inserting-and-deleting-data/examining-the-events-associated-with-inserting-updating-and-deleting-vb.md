---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
title: Examen des événements associés à l’insertion, à la mise à jour et à la suppression (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons examiner l’utilisation des événements qui se produisent avant, pendant et après une opération d’insertion, de mise à jour ou de suppression d’un contrôle Web de données ASP.NET. W...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: c9bd10a7-eff8-4d8c-bec9-963c2aef2d6e
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 35edb3cefc6fe23bb56e667c02d10dc7798f730d
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74633130"
---
# <a name="examining-the-events-associated-with-inserting-updating-and-deleting-vb"></a><span data-ttu-id="ebda7-104">Examen des événements associés à l’insertion, à la mise à jour et à la suppression (VB)</span><span class="sxs-lookup"><span data-stu-id="ebda7-104">Examining the Events Associated with Inserting, Updating, and Deleting (VB)</span></span>

<span data-ttu-id="ebda7-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ebda7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ebda7-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) ou [Télécharger le PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ebda7-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span></span>

> <span data-ttu-id="ebda7-107">Dans ce didacticiel, nous allons examiner l’utilisation des événements qui se produisent avant, pendant et après une opération d’insertion, de mise à jour ou de suppression d’un contrôle Web de données ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ebda7-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="ebda7-108">Nous verrons également comment personnaliser l’interface de modification pour mettre à jour uniquement un sous-ensemble des champs de produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="introduction"></a><span data-ttu-id="ebda7-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="ebda7-109">Introduction</span></span>

<span data-ttu-id="ebda7-110">Lors de l’utilisation des fonctionnalités intégrées d’insertion, de modification ou de suppression des contrôles GridView, DetailsView ou FormView, une série d’étapes s’écoulent lorsque l’utilisateur final termine le processus d’ajout d’un nouvel enregistrement ou de mise à jour ou de suppression d’un enregistrement existant.</span><span class="sxs-lookup"><span data-stu-id="ebda7-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="ebda7-111">Comme nous l’avons vu dans le [didacticiel précédent](an-overview-of-inserting-updating-and-deleting-data-vb.md), quand une ligne est modifiée dans le contrôle GridView, le bouton modifier est remplacé par les boutons mettre à jour et annuler et les BoundFields s’activent dans les zones de texte.</span><span class="sxs-lookup"><span data-stu-id="ebda7-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-vb.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="ebda7-112">Une fois que l’utilisateur final a mis à jour les données et cliqué sur mettre à jour, les étapes suivantes sont effectuées lors de la publication :</span><span class="sxs-lookup"><span data-stu-id="ebda7-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="ebda7-113">Le GridView remplit le `UpdateParameters` de l’ObjectDataSource avec le ou les champs d’identification uniques de l’enregistrement modifié (via la propriété `DataKeyNames`), ainsi que les valeurs entrées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebda7-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="ebda7-114">Le contrôle GridView appelle la méthode de `Update()` ObjectDataSource, qui à son tour appelle la méthode appropriée dans l’objet sous-jacent (`ProductsDAL.UpdateProduct`, dans le didacticiel précédent)</span><span class="sxs-lookup"><span data-stu-id="ebda7-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="ebda7-115">Les données sous-jacentes, qui incluent désormais les modifications mises à jour, sont reliées au GridView</span><span class="sxs-lookup"><span data-stu-id="ebda7-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="ebda7-116">Au cours de cette séquence d’étapes, un certain nombre d’événements se déclenchent, ce qui nous permet de créer des gestionnaires d’événements pour ajouter une logique personnalisée, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="ebda7-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="ebda7-117">Par exemple, avant l’étape 1, l’événement `RowUpdating` de GridView se déclenche.</span><span class="sxs-lookup"><span data-stu-id="ebda7-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="ebda7-118">À ce stade, vous pouvez annuler la demande de mise à jour en cas d’erreur de validation.</span><span class="sxs-lookup"><span data-stu-id="ebda7-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="ebda7-119">Lorsque la méthode `Update()` est appelée, l’événement `Updating` de l’ObjectDataSource se déclenche, ce qui vous donne la possibilité d’ajouter ou de personnaliser les valeurs d’un `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="ebda7-120">Une fois l’exécution de la méthode de l’objet sous-jacent de ObjectDataSource terminée, l’événement de `Updated` de l’ObjectDataSource est déclenché.</span><span class="sxs-lookup"><span data-stu-id="ebda7-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="ebda7-121">Un gestionnaire d’événements pour l’événement `Updated` peut inspecter les détails sur l’opération de mise à jour, comme le nombre de lignes affectées et si une exception s’est produite ou non.</span><span class="sxs-lookup"><span data-stu-id="ebda7-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="ebda7-122">Enfin, après l’étape 2, l’événement `RowUpdated` de GridView se déclenche ; un gestionnaire d’événements pour cet événement peut examiner des informations supplémentaires sur l’opération de mise à jour qui vient d’être effectuée.</span><span class="sxs-lookup"><span data-stu-id="ebda7-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="ebda7-123">La figure 1 illustre cette série d’événements et d’étapes lors de la mise à jour d’un GridView.</span><span class="sxs-lookup"><span data-stu-id="ebda7-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="ebda7-124">Le modèle d’événement de la figure 1 n’est pas unique pour la mise à jour avec un GridView.</span><span class="sxs-lookup"><span data-stu-id="ebda7-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="ebda7-125">L’insertion, la mise à jour ou la suppression de données à partir de GridView, DetailsView ou FormView précipite la même séquence d’événements de pré-et de dernier niveau pour le contrôle Web de données et l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>

<span data-ttu-id="ebda7-126">[![une série d’événements et de pré-événements se déclenche lors de la mise à jour de données dans un GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="ebda7-127">**Figure 1**: une série d’événements et de pré-événements se déclenche lors de la mise à jour de données dans un GridView ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span></span>

<span data-ttu-id="ebda7-128">Dans ce didacticiel, nous allons examiner l’utilisation de ces événements pour étendre les fonctionnalités intégrées d’insertion, de mise à jour et de suppression des contrôles Web de données ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ebda7-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="ebda7-129">Nous verrons également comment personnaliser l’interface de modification pour mettre à jour uniquement un sous-ensemble des champs de produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="ebda7-130">Étape 1 : mise à jour des champs`ProductName`et`UnitPrice`d’un produit</span><span class="sxs-lookup"><span data-stu-id="ebda7-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="ebda7-131">Dans les interfaces de modification du didacticiel précédent, *tous les* champs de produit qui n’étaient pas en lecture seule devaient être inclus.</span><span class="sxs-lookup"><span data-stu-id="ebda7-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="ebda7-132">Si nous devions supprimer un champ de l' `QuantityPerUnit` GridView-disons-lors de la mise à jour des données, le contrôle Web de données ne définissait pas la valeur de la `UpdateParameters` de l’ObjectDataSource `QuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="ebda7-133">L’ObjectDataSource transmettra ensuite une valeur de `Nothing` dans la méthode BLL (Business Logic Layer) `UpdateProduct`, qui modifierait la `QuantityPerUnit` colonne de l’enregistrement de base de données modifié en une valeur `NULL`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-133">The ObjectDataSource would then pass in a value of `Nothing` into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="ebda7-134">De même, si un champ obligatoire, tel que `ProductName`, est supprimé de l’interface de modification, la mise à jour échoue avec l’exception « la*colonne «ProductName » n’autorise pas les valeurs NULL*».</span><span class="sxs-lookup"><span data-stu-id="ebda7-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="ebda7-135">La raison de ce comportement est que l’ObjectDataSource a été configuré pour appeler la méthode `UpdateProduct` de la classe `ProductsBLL`, qui attendait un paramètre d’entrée pour chacun des champs de produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="ebda7-136">Par conséquent, la collection d' `UpdateParameters` de l’ObjectDataSource contenait un paramètre pour chacun des paramètres d’entrée de la méthode.</span><span class="sxs-lookup"><span data-stu-id="ebda7-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="ebda7-137">Si nous souhaitons fournir un contrôle Web de données qui permet à l’utilisateur final de mettre à jour uniquement un sous-ensemble de champs, nous devons soit définir par programmation les valeurs manquantes de `UpdateParameters` dans le gestionnaire d’événements `Updating` de l’ObjectDataSource, soit créer et appeler une méthode BLL qui attend uniquement un sous-ensemble des champs.</span><span class="sxs-lookup"><span data-stu-id="ebda7-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="ebda7-138">Étudions cette dernière approche.</span><span class="sxs-lookup"><span data-stu-id="ebda7-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="ebda7-139">En particulier, nous allons créer une page qui affiche uniquement les champs `ProductName` et `UnitPrice` dans un GridView modifiable.</span><span class="sxs-lookup"><span data-stu-id="ebda7-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="ebda7-140">L’interface de modification de ce GridView permettra uniquement à l’utilisateur de mettre à jour les deux champs affichés, `ProductName` et `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="ebda7-141">Étant donné que cette interface de modification fournit uniquement un sous-ensemble des champs d’un produit, nous devons soit créer un ObjectDataSource qui utilise la méthode de `UpdateProduct` de la couche BLL existante et avoir les valeurs de champ de produit manquantes définies par programme dans son gestionnaire d’événements `Updating`, soit créer une nouvelle méthode BLL qui attend uniquement le sous-ensemble de champs définis dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="ebda7-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="ebda7-142">Pour ce didacticiel, nous allons utiliser la dernière option et créer une surcharge de la méthode `UpdateProduct`, qui accepte uniquement trois paramètres d’entrée : `productName`, `unitPrice`et `productID`:</span><span class="sxs-lookup"><span data-stu-id="ebda7-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="ebda7-143">À l’instar de la méthode `UpdateProduct` d’origine, cette surcharge commence par vérifier s’il existe un produit dans la base de données avec le `ProductID`spécifié.</span><span class="sxs-lookup"><span data-stu-id="ebda7-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="ebda7-144">Si ce n’est pas le cas, elle retourne `False`, indiquant que la demande de mise à jour des informations sur le produit a échoué.</span><span class="sxs-lookup"><span data-stu-id="ebda7-144">If not, it returns `False`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="ebda7-145">Dans le cas contraire, il met à jour les champs `ProductName` et `UnitPrice` de l’enregistrement de produit existant en conséquence et valide la mise à jour en appelant la méthode `Update()` du TableAdapter, en passant l’instance `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdapter's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="ebda7-146">Grâce à cet ajout à notre classe `ProductsBLL`, nous sommes prêts à créer l’interface GridView simplifiée.</span><span class="sxs-lookup"><span data-stu-id="ebda7-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="ebda7-147">Ouvrez le `DataModificationEvents.aspx` dans le dossier `EditInsertDelete` et ajoutez un contrôle GridView à la page.</span><span class="sxs-lookup"><span data-stu-id="ebda7-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="ebda7-148">Créez un ObjectDataSource et configurez-le de façon à ce qu’il utilise la classe `ProductsBLL` avec son mappage de méthode `Select()` à `GetProducts` et son `Update()` méthode de mappage à la surcharge `UpdateProduct` qui accepte uniquement les paramètres d’entrée `productName`, `unitPrice`et `productID`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="ebda7-149">La figure 2 illustre l’Assistant Création d’une source de données lors du mappage de la méthode d' `Update()` ObjectDataSource à la nouvelle surcharge de méthode `UpdateProduct` de la classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>

<span data-ttu-id="ebda7-150">[![mapper la méthode Update () de ObjectDataSource à la nouvelle surcharge UpdateProduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span></span>

<span data-ttu-id="ebda7-151">**Figure 2**: mapper la méthode de `Update()` ObjectDataSource à la nouvelle surcharge de `UpdateProduct` ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span></span>

<span data-ttu-id="ebda7-152">Dans la mesure où notre exemple a uniquement besoin de pouvoir modifier les données, mais pas d’insérer ou de supprimer des enregistrements, prenez un moment pour indiquer explicitement que les méthodes d' `Insert()` et de `Delete()` de l’ObjectDataSource ne doivent pas être mappées à l’une des méthodes de la classe `ProductsBLL` en accédant aux onglets insérer et supprimer et en choisissant (aucun) dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="ebda7-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>

<span data-ttu-id="ebda7-153">[![sélectionnez (aucun) dans la liste déroulante des onglets insérer et supprimer](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="ebda7-154">**Figure 3**: choisir (aucun) dans la liste déroulante des onglets insérer et supprimer ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span></span>

<span data-ttu-id="ebda7-155">À la fin de cet Assistant, activez la case à cocher Activer la modification à partir de la balise active de GridView.</span><span class="sxs-lookup"><span data-stu-id="ebda7-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="ebda7-156">Une fois l’exécution de l’Assistant Création de source de données terminée et la liaison à GridView, Visual Studio a créé la syntaxe déclarative pour les deux contrôles.</span><span class="sxs-lookup"><span data-stu-id="ebda7-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="ebda7-157">Accédez à la vue source pour inspecter le balisage déclaratif de ObjectDataSource, comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="ebda7-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="ebda7-158">Étant donné qu’il n’existe aucun mappage pour les méthodes `Insert()` et `Delete()` de l’ObjectDataSource, il n’y a aucune section `InsertParameters` ou `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="ebda7-159">En outre, étant donné que la méthode `Update()` est mappée à la surcharge de méthode `UpdateProduct` qui accepte uniquement trois paramètres d’entrée, la section `UpdateParameters` contient seulement trois instances `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="ebda7-160">Notez que la propriété de `OldValuesParameterFormatString` ObjectDataSource est définie sur `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="ebda7-161">Cette propriété est définie automatiquement par Visual Studio lors de l’utilisation de l’Assistant Configuration de la source de données.</span><span class="sxs-lookup"><span data-stu-id="ebda7-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="ebda7-162">Toutefois, étant donné que nos méthodes BLL ne s’attendent pas à ce que la valeur d’origine `ProductID` soit passée, supprimez cette assignation de propriété de la syntaxe déclarative de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="ebda7-163">Si vous supprimez simplement la valeur de la propriété `OldValuesParameterFormatString` de la Fenêtre Propriétés dans le Mode Création, la propriété existera toujours dans la syntaxe déclarative, mais sera définie sur une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="ebda7-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="ebda7-164">Supprimez la propriété de la syntaxe déclarative ou, à partir de la Fenêtre Propriétés, affectez la valeur par défaut, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

<span data-ttu-id="ebda7-165">Alors que ObjectDataSource n’a `UpdateParameters` pour le nom, le prix et l’ID du produit, Visual Studio a ajouté un BoundField ou CheckBoxField dans le GridView pour chacun des champs du produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>

<span data-ttu-id="ebda7-166">[![le GridView contient un BoundField ou CheckBoxField pour chacun des champs du produit](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span></span>

<span data-ttu-id="ebda7-167">**Figure 4**: le GridView contient un BoundField ou un CheckBoxField pour chacun des champs du produit ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span></span>

<span data-ttu-id="ebda7-168">Lorsque l’utilisateur final modifie un produit et clique sur son bouton mettre à jour, le contrôle GridView énumère les champs qui n’étaient pas en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="ebda7-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="ebda7-169">Il définit ensuite la valeur du paramètre correspondant dans la collection de `UpdateParameters` de l’ObjectDataSource sur la valeur entrée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebda7-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="ebda7-170">S’il n’existe pas de paramètre correspondant, le contrôle GridView en ajoute un à la collection.</span><span class="sxs-lookup"><span data-stu-id="ebda7-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="ebda7-171">Par conséquent, si notre GridView contient BoundFields et CheckBoxFields pour tous les champs du produit, l’ObjectDataSource finit par appeler la surcharge `UpdateProduct` qui prend tous ces paramètres, bien que le balisage déclaratif de ObjectDataSource spécifie uniquement trois paramètres d’entrée (voir figure 5).</span><span class="sxs-lookup"><span data-stu-id="ebda7-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="ebda7-172">De même, s’il existe une combinaison de champs de produit non en lecture seule dans le GridView qui ne correspond pas aux paramètres d’entrée d’une surcharge `UpdateProduct`, une exception est levée lors de la tentative de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="ebda7-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>

<span data-ttu-id="ebda7-173">[![le contrôle GridView ajoutera des paramètres à la collection UpdateParameters de l’ObjectDataSource](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span></span>

<span data-ttu-id="ebda7-174">**Figure 5**: le GridView ajoute des paramètres à la collection d’ObjectDataSource `UpdateParameters` ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span></span>

<span data-ttu-id="ebda7-175">Pour vous assurer que ObjectDataSource appelle la surcharge `UpdateProduct` qui accepte uniquement le nom, le prix et l’ID du produit, nous devons limiter le contrôle GridView aux champs modifiables uniquement pour les `ProductName` et les `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="ebda7-176">Pour ce faire, vous pouvez supprimer les autres BoundFields et CheckBoxFields, en définissant la propriété `ReadOnly` de ces autres champs sur `True`ou d’une combinaison des deux.</span><span class="sxs-lookup"><span data-stu-id="ebda7-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `True`, or by some combination of the two.</span></span> <span data-ttu-id="ebda7-177">Pour ce didacticiel, nous allons simplement supprimer tous les champs GridView, à l’exception des `ProductName` et `UnitPrice` BoundFields, après quoi le balisage déclaratif de GridView ressemble à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="ebda7-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="ebda7-178">Même si la surcharge `UpdateProduct` attend trois paramètres d’entrée, nous avons seulement deux BoundFields dans notre GridView.</span><span class="sxs-lookup"><span data-stu-id="ebda7-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="ebda7-179">Cela est dû au fait que le paramètre d’entrée `productID` est une valeur de clé primaire et est transmis par le biais de la valeur de la propriété `DataKeyNames` de la ligne modifiée.</span><span class="sxs-lookup"><span data-stu-id="ebda7-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="ebda7-180">Notre GridView, avec la surcharge `UpdateProduct`, permet à un utilisateur de modifier uniquement le nom et le prix d’un produit sans perdre aucun des autres champs de produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>

<span data-ttu-id="ebda7-181">[![l’interface autorise uniquement la modification du nom et du prix du produit](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span></span>

<span data-ttu-id="ebda7-182">**Figure 6**: l’interface permet de modifier uniquement le nom et le prix du produit ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ebda7-183">Comme indiqué dans le didacticiel précédent, il est primordial que l’état d’affichage de GridView s soit activé (comportement par défaut).</span><span class="sxs-lookup"><span data-stu-id="ebda7-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="ebda7-184">Si vous affectez à la propriété GridView s `EnableViewState` la valeur `false`, vous risquez d’avoir des utilisateurs simultanés qui suppriment ou modifient des enregistrements de manière involontaire.</span><span class="sxs-lookup"><span data-stu-id="ebda7-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="ebda7-185">Consultez [Avertissement : problème d’accès concurrentiel avec ASP.NET 2,0 GridViews/DetailsView/FormViews qui prennent en charge l’édition et/ou la suppression et dont l’état d’affichage est désactivé](http://scottonwriting.net/sowblog/posts/10054.aspx) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="ebda7-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="ebda7-186">Amélioration de la mise en forme`UnitPrice`</span><span class="sxs-lookup"><span data-stu-id="ebda7-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="ebda7-187">Tandis que l’exemple de GridView illustré à la figure 6 fonctionne, le champ `UnitPrice` n’est pas mis en forme du tout, ce qui entraîne l’affichage d’un prix qui n’a pas de symboles monétaires et a quatre décimales.</span><span class="sxs-lookup"><span data-stu-id="ebda7-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="ebda7-188">Pour appliquer une mise en forme monétaire pour les lignes non modifiables, il vous suffit de définir la propriété `DataFormatString` de `UnitPrice` BoundField sur `{0:c}` et sa propriété `HtmlEncode` sur `False`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `False`.</span></span>

<span data-ttu-id="ebda7-189">[![définir en conséquence les propriétés DataFormatString et HtmlEncode du UnitPrice](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span></span>

<span data-ttu-id="ebda7-190">**Figure 7**: définir les propriétés de `DataFormatString` et de `HtmlEncode` du `UnitPrice`[en conséquence (cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span></span>

<span data-ttu-id="ebda7-191">Avec cette modification, les lignes non modifiables mettent en forme le prix comme une devise ; Toutefois, la ligne modifiée affiche toujours la valeur sans le symbole monétaire et avec quatre décimales.</span><span class="sxs-lookup"><span data-stu-id="ebda7-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>

<span data-ttu-id="ebda7-192">[![les lignes non modifiables sont désormais mises en forme en tant que valeurs monétaires](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-192">[![The Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span></span>

<span data-ttu-id="ebda7-193">**Figure 8**: les lignes non modifiables sont maintenant mises en forme en tant que valeurs monétaires ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-193">**Figure 8**: The Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span></span>

<span data-ttu-id="ebda7-194">Les instructions de mise en forme spécifiées dans la propriété `DataFormatString` peuvent être appliquées à l’interface de modification en affectant à la propriété `ApplyFormatInEditMode` de BoundField la valeur `True` (la valeur par défaut est `False`).</span><span class="sxs-lookup"><span data-stu-id="ebda7-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `True` (the default is `False`).</span></span> <span data-ttu-id="ebda7-195">Prenez un moment pour définir cette propriété sur `True`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-195">Take a moment to set this property to `True`.</span></span>

<span data-ttu-id="ebda7-196">[![affectez la valeur true à la propriété ApplyFormatInEditMode de l’BoundField UnitPrice](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to True](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span></span>

<span data-ttu-id="ebda7-197">**Figure 9**: définir la propriété `ApplyFormatInEditMode` de `UnitPrice` BoundField sur `True` ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `True` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span></span>

<span data-ttu-id="ebda7-198">Avec cette modification, la valeur de la `UnitPrice` affichée dans la ligne modifiée est également mise en forme en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="ebda7-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>

<span data-ttu-id="ebda7-199">[![la valeur UnitPrice de la ligne modifiée est maintenant mise en forme en tant que devise](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span></span>

<span data-ttu-id="ebda7-200">**Figure 10**: la valeur `UnitPrice` de la ligne modifiée est maintenant mise en forme en tant que devise ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span></span>

<span data-ttu-id="ebda7-201">Toutefois, la mise à jour d’un produit avec le symbole monétaire dans la zone de texte, par exemple $19,00 lève une `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="ebda7-202">Lorsque le GridView tente d’attribuer les valeurs fournies par l’utilisateur à la collection d' `UpdateParameters` ObjectDataSource, il ne peut pas convertir la chaîne `UnitPrice` « $19,00 » en `Decimal` requise par le paramètre (voir figure 11).</span><span class="sxs-lookup"><span data-stu-id="ebda7-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `Decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="ebda7-203">Pour remédier à cela, nous pouvons créer un gestionnaire d’événements pour l’événement `RowUpdating` de GridView et le faire analyser le `UnitPrice` fourni par l’utilisateur comme un `Decimal`au format monétaire.</span><span class="sxs-lookup"><span data-stu-id="ebda7-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `Decimal`.</span></span>

<span data-ttu-id="ebda7-204">L’événement `RowUpdating` de GridView accepte comme deuxième paramètre un objet de type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), qui inclut un dictionnaire `NewValues` comme l’une de ses propriétés qui contient les valeurs fournies par l’utilisateur prêtes à être assignées à la collection de `UpdateParameters` de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="ebda7-205">Nous pouvons remplacer la valeur `UnitPrice` existante dans la collection `NewValues` par une valeur décimale analysée à l’aide du format monétaire avec les lignes de code suivantes dans le gestionnaire d’événements `RowUpdating` :</span><span class="sxs-lookup"><span data-stu-id="ebda7-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample4.vb)]

<span data-ttu-id="ebda7-206">Si l’utilisateur a fourni une valeur `UnitPrice` (telle que « $19,00 »), cette valeur est remplacée par la valeur décimale calculée par [Decimal. Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), en analysant la valeur en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="ebda7-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="ebda7-207">Cette opération analyse correctement la valeur décimale dans l’événement des symboles monétaires, des virgules, des points décimaux, etc., et utilise l' [énumération NumberStyles](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) dans l’espace de noms [System. Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="ebda7-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="ebda7-208">La figure 11 illustre le problème causé par les symboles monétaires dans le `UnitPrice`fourni par l’utilisateur, ainsi que la façon dont le gestionnaire d’événements `RowUpdating` de GridView peut être utilisé pour analyser correctement cette entrée.</span><span class="sxs-lookup"><span data-stu-id="ebda7-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>

<span data-ttu-id="ebda7-209">[![la valeur UnitPrice de la ligne modifiée est maintenant mise en forme en tant que devise](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span></span>

<span data-ttu-id="ebda7-210">**Figure 11**: la valeur `UnitPrice` de la ligne modifiée est maintenant mise en forme en tant que devise ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span></span>

## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="ebda7-211">Étape 2 : interdiction de`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="ebda7-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="ebda7-212">Alors que la base de données est configurée pour autoriser les valeurs de `NULL` dans la colonne `UnitPrice` de `Products` table, nous pouvons souhaiter empêcher les utilisateurs visitant cette page spécifique de spécifier une valeur de `UnitPrice` `NULL`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="ebda7-213">Autrement dit, si un utilisateur ne parvient pas à entrer une valeur de `UnitPrice` lors de la modification d’une ligne de produit, plutôt que d’enregistrer les résultats dans la base de données, nous souhaitons afficher un message indiquant à l’utilisateur que, par le biais de cette page, un tarif doit être spécifié pour tous les produits modifiés.</span><span class="sxs-lookup"><span data-stu-id="ebda7-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="ebda7-214">L’objet `GridViewUpdateEventArgs` passé dans le gestionnaire d’événements `RowUpdating` de GridView contient une propriété `Cancel` qui, si elle est définie sur `True`, termine le processus de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="ebda7-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `True`, terminates the updating process.</span></span> <span data-ttu-id="ebda7-215">Nous allons étendre le gestionnaire d’événements `RowUpdating` pour définir `e.Cancel` à `True` et afficher un message expliquant pourquoi si la valeur `UnitPrice` de la collection `NewValues` a la valeur `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `True` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection has a value of `Nothing`.</span></span>

<span data-ttu-id="ebda7-216">Commencez par ajouter un contrôle Web Label à la page nommée `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="ebda7-217">Ce contrôle Label est affiché si l’utilisateur ne parvient pas à spécifier une valeur de `UnitPrice` lors de la mise à jour d’un produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="ebda7-218">Affectez à la propriété `Text` de l’étiquette la valeur « vous devez fournir un prix pour le produit ».</span><span class="sxs-lookup"><span data-stu-id="ebda7-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="ebda7-219">J’ai également créé une nouvelle classe CSS dans `Styles.css` nommée `Warning` avec la définition suivante :</span><span class="sxs-lookup"><span data-stu-id="ebda7-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>

[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample5.css)]

<span data-ttu-id="ebda7-220">Enfin, définissez la propriété `CssClass` de l’étiquette sur `Warning`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="ebda7-221">À ce stade, le concepteur doit afficher le message d’avertissement dans une taille de police rouge, gras, italique, très grande au-dessus de GridView, comme illustré à la figure 12.</span><span class="sxs-lookup"><span data-stu-id="ebda7-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>

<span data-ttu-id="ebda7-222">[![une étiquette a été ajoutée au-dessus du GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span></span>

<span data-ttu-id="ebda7-223">**Figure 12**: une étiquette a été ajoutée au-dessus du contrôle GridView ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span></span>

<span data-ttu-id="ebda7-224">Par défaut, cette étiquette doit être masquée. par conséquent, définissez sa propriété `Visible` sur `False` dans le gestionnaire d’événements `Page_Load` :</span><span class="sxs-lookup"><span data-stu-id="ebda7-224">By default, this Label should be hidden, so set its `Visible` property to `False` in the `Page_Load` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="ebda7-225">Si l’utilisateur tente de mettre à jour un produit sans spécifier le `UnitPrice`, nous voulons annuler la mise à jour et afficher l’étiquette d’avertissement.</span><span class="sxs-lookup"><span data-stu-id="ebda7-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="ebda7-226">Complétez le gestionnaire d’événements `RowUpdating` du GridView comme suit :</span><span class="sxs-lookup"><span data-stu-id="ebda7-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="ebda7-227">Si un utilisateur tente d’enregistrer un produit sans spécifier de prix, la mise à jour est annulée et un message utile s’affiche.</span><span class="sxs-lookup"><span data-stu-id="ebda7-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="ebda7-228">Bien que la base de données (et la logique métier) autorise `NULL` `UnitPrice` s, cette page ASP.NET particulière ne le fait pas.</span><span class="sxs-lookup"><span data-stu-id="ebda7-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>

<span data-ttu-id="ebda7-229">[![un utilisateur ne peut pas laisser un PrixUnitaire vide](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span></span>

<span data-ttu-id="ebda7-230">**Figure 13**: un utilisateur ne peut pas laisser `UnitPrice` vide ([Cliquer pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span></span>

<span data-ttu-id="ebda7-231">Jusqu’à présent, nous avons vu comment utiliser l’événement `RowUpdating` de GridView pour modifier par programmation les valeurs de paramètres assignées à la collection de `UpdateParameters` de l’ObjectDataSource et comment annuler complètement le processus de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="ebda7-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="ebda7-232">Ces concepts portent sur les contrôles DetailsView et FormView, et s’appliquent également à l’insertion et à la suppression.</span><span class="sxs-lookup"><span data-stu-id="ebda7-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="ebda7-233">Ces tâches peuvent également être effectuées au niveau ObjectDataSource par le biais de gestionnaires d’événements pour ses événements `Inserting`, `Updating`et `Deleting`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="ebda7-234">Ces événements se déclenchent avant l’appel de la méthode associée de l’objet sous-jacent et fournissent une opportunité de dernière chance de modifier la collection de paramètres d’entrée ou d’annuler l’opération.</span><span class="sxs-lookup"><span data-stu-id="ebda7-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="ebda7-235">Les gestionnaires d’événements de ces trois événements sont passés à un objet de type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) qui a deux propriétés intéressantes :</span><span class="sxs-lookup"><span data-stu-id="ebda7-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="ebda7-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), qui, s’il est défini sur `True`, annule l’opération en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="ebda7-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `True`, cancels the operation being performed</span></span>
- <span data-ttu-id="ebda7-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), qui est la collection de `InsertParameters`, `UpdateParameters`ou `DeleteParameters`, selon que le gestionnaire d’événements est destiné à l’événement `Inserting`, `Updating`ou `Deleting`</span><span class="sxs-lookup"><span data-stu-id="ebda7-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="ebda7-238">Pour illustrer l’utilisation des valeurs de paramètre au niveau de l’ObjectDataSource, nous allons inclure un DetailsView dans notre page qui permet aux utilisateurs d’ajouter un nouveau produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="ebda7-239">Ce DetailsView sera utilisé pour fournir une interface permettant d’ajouter rapidement un nouveau produit à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ebda7-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="ebda7-240">Pour conserver une interface utilisateur cohérente lors de l’ajout d’un nouveau produit, n’hésitez pas à autoriser l’utilisateur à entrer des valeurs pour les champs `ProductName` et `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="ebda7-241">Par défaut, les valeurs qui ne sont pas fournies dans l’interface d’insertion du contrôle DetailsView sont définies sur une valeur de base de données `NULL`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="ebda7-242">Toutefois, nous pouvons utiliser l’événement `Inserting` de l’ObjectDataSource pour injecter des valeurs par défaut différentes, comme nous le verrons bientôt.</span><span class="sxs-lookup"><span data-stu-id="ebda7-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="ebda7-243">Étape 3 : fournir une interface pour ajouter de nouveaux produits</span><span class="sxs-lookup"><span data-stu-id="ebda7-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="ebda7-244">Faites glisser un DetailsView de la boîte à outils vers le concepteur au-dessus du GridView, effacez ses propriétés `Height` et `Width`, puis liez-le à l’ObjectDataSource déjà présent sur la page.</span><span class="sxs-lookup"><span data-stu-id="ebda7-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="ebda7-245">Cela ajoute un BoundField ou CheckBoxField pour chacun des champs du produit.</span><span class="sxs-lookup"><span data-stu-id="ebda7-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="ebda7-246">Étant donné que nous souhaitons utiliser ce DetailsView pour ajouter de nouveaux produits, nous devons vérifier l’option Activer l’insertion à partir de la balise active. Toutefois, il n’existe pas d’option de ce type, car la méthode de `Insert()` de l’ObjectDataSource n’est pas mappée à une méthode dans la classe `ProductsBLL` (Rappelez-vous que nous définissons ce mappage sur (aucun) lors de la configuration de la source de données, voir la figure 3).</span><span class="sxs-lookup"><span data-stu-id="ebda7-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="ebda7-247">Pour configurer l’ObjectDataSource, sélectionnez le lien configurer la source de données à partir de sa balise active, en lançant l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="ebda7-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="ebda7-248">Le premier écran vous permet de modifier l’objet sous-jacent auquel ObjectDataSource est lié. Laissez la valeur `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="ebda7-249">L’écran suivant répertorie les mappages des méthodes de l’ObjectDataSource aux objets sous-jacents.</span><span class="sxs-lookup"><span data-stu-id="ebda7-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="ebda7-250">Bien que nous indiquions explicitement que les méthodes `Insert()` et `Delete()` ne devaient pas être mappées à des méthodes, si vous accédez aux onglets insertion et suppression, vous verrez qu’un mappage est présent.</span><span class="sxs-lookup"><span data-stu-id="ebda7-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="ebda7-251">Cela est dû au fait que les méthodes de `AddProduct` et de `DeleteProduct` du `ProductsBLL`utilisent l’attribut `DataObjectMethodAttribute` pour indiquer qu’il s’agit des méthodes par défaut pour `Insert()` et `Delete()`, respectivement.</span><span class="sxs-lookup"><span data-stu-id="ebda7-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="ebda7-252">Par conséquent, l’Assistant ObjectDataSource les sélectionne chaque fois que vous exécutez l’Assistant, sauf si une autre valeur est spécifiée explicitement.</span><span class="sxs-lookup"><span data-stu-id="ebda7-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="ebda7-253">Laissez la méthode `Insert()` pointant vers la méthode `AddProduct`, mais définissez à nouveau la liste déroulante de l’onglet supprimer sur (aucune).</span><span class="sxs-lookup"><span data-stu-id="ebda7-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>

<span data-ttu-id="ebda7-254">[![définir la méthode AddProduct dans la liste déroulante de l’onglet Insertion](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span></span>

<span data-ttu-id="ebda7-255">**Figure 14**: définir la liste déroulante de l’onglet Insertion sur la méthode `AddProduct` ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span></span>

<span data-ttu-id="ebda7-256">[![définir la liste déroulante de l’onglet supprimer sur (aucun)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span></span>

<span data-ttu-id="ebda7-257">**Figure 15**: définir la liste déroulante de l’onglet supprimer sur (aucun) ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span></span>

<span data-ttu-id="ebda7-258">Après avoir apporté ces modifications, la syntaxe déclarative de ObjectDataSource sera étendue pour inclure une collection `InsertParameters`, comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="ebda7-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample8.aspx)]

<span data-ttu-id="ebda7-259">La réexécution de l’Assistant a ajouté la propriété `OldValuesParameterFormatString`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="ebda7-260">Prenez un moment pour effacer cette propriété en la définissant sur la valeur par défaut (`{0}`) ou en la supprimant entièrement de la syntaxe déclarative.</span><span class="sxs-lookup"><span data-stu-id="ebda7-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="ebda7-261">Avec ObjectDataSource fournissant des fonctionnalités d’insertion, la balise active du contrôle DetailsView inclut désormais la case à cocher Activer l’insertion. Revenez au concepteur et cochez cette option.</span><span class="sxs-lookup"><span data-stu-id="ebda7-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="ebda7-262">Ensuite, réduisez le DetailsView pour qu’il n’ait que deux BoundFields-`ProductName` et `UnitPrice`-et CommandField.</span><span class="sxs-lookup"><span data-stu-id="ebda7-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="ebda7-263">À ce stade, la syntaxe déclarative du contrôle DetailsView doit ressembler à ceci :</span><span class="sxs-lookup"><span data-stu-id="ebda7-263">At this point the DetailsView's declarative syntax should look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample9.aspx)]

<span data-ttu-id="ebda7-264">La figure 16 illustre cette page lorsque vous l’affichez dans un navigateur à ce stade.</span><span class="sxs-lookup"><span data-stu-id="ebda7-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="ebda7-265">Comme vous pouvez le voir, le contrôle DetailsView répertorie le nom et le prix du premier produit (Chai).</span><span class="sxs-lookup"><span data-stu-id="ebda7-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="ebda7-266">Ce que nous voulons, toutefois, est une interface d’insertion qui permet à l’utilisateur d’ajouter rapidement un nouveau produit à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ebda7-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>

<span data-ttu-id="ebda7-267">[![le contrôle DetailsView est actuellement affiché en mode lecture seule](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span></span>

<span data-ttu-id="ebda7-268">**Figure 16**: le contrôle DetailsView est actuellement affiché en mode lecture seule ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span></span>

<span data-ttu-id="ebda7-269">Pour afficher le DetailsView dans son mode d’insertion, nous devons définir la propriété `DefaultMode` sur `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="ebda7-270">Le contrôle DetailsView est alors rendu en mode insertion lors de sa première visite et il est conservé après l’insertion d’un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="ebda7-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="ebda7-271">Comme le montre la figure 17, un contrôle DetailsView fournit une interface rapide pour l’ajout d’un nouvel enregistrement.</span><span class="sxs-lookup"><span data-stu-id="ebda7-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>

<span data-ttu-id="ebda7-272">[![le contrôle DetailsView fournit une interface pour ajouter rapidement un nouveau produit](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span></span>

<span data-ttu-id="ebda7-273">**Figure 17**: le contrôle DetailsView fournit une interface permettant d’ajouter rapidement un nouveau produit ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span></span>

<span data-ttu-id="ebda7-274">Lorsque l’utilisateur entre un nom de produit et un prix (par exemple, « Acme Water » et 1,99, comme dans la figure 17) et clique sur Insérer, une publication (postback) se produit et le workflow d’insertion commence, sanctionné par l’ajout d’un nouvel enregistrement de produit à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ebda7-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="ebda7-275">Le contrôle DetailsView gère son interface d’insertion et le contrôle GridView est automatiquement lié à sa source de données afin d’inclure le nouveau produit, comme illustré à la figure 18.</span><span class="sxs-lookup"><span data-stu-id="ebda7-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>

![Le produit](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image52.png)

<span data-ttu-id="ebda7-277">**Figure 18**: le produit « Acme Water » a été ajouté à la base de données</span><span class="sxs-lookup"><span data-stu-id="ebda7-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>

<span data-ttu-id="ebda7-278">Alors que le GridView de la figure 18 ne l’affiche pas, les champs de produit absents de l’interface DetailsView `CategoryID`, `SupplierID`, `QuantityPerUnit`, etc., sont affectés `NULL` valeurs de base de données.</span><span class="sxs-lookup"><span data-stu-id="ebda7-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="ebda7-279">Vous pouvez le constater en effectuant les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="ebda7-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="ebda7-280">Accéder au Explorateur de serveurs dans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ebda7-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="ebda7-281">Développement du nœud de base de données `NORTHWND.MDF`</span><span class="sxs-lookup"><span data-stu-id="ebda7-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="ebda7-282">Cliquez avec le bouton droit sur le nœud `Products` de la table de base de données</span><span class="sxs-lookup"><span data-stu-id="ebda7-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="ebda7-283">Sélectionner Afficher les données de la table</span><span class="sxs-lookup"><span data-stu-id="ebda7-283">Select Show Table Data</span></span>

<span data-ttu-id="ebda7-284">Cela permet de répertorier tous les enregistrements dans la table `Products`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="ebda7-285">Comme le montre la figure 19, toutes les colonnes du nouveau produit autres que `ProductID`, `ProductName`et `UnitPrice` comportent des valeurs de `NULL`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>

<span data-ttu-id="ebda7-286">[![les champs de produit non fournis dans le contrôle DetailsView reçoivent des valeurs NULL](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span></span>

<span data-ttu-id="ebda7-287">**Figure 19**: les champs de produit non fournis dans le contrôle DetailsView sont affectés `NULL` valeurs ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span></span>

<span data-ttu-id="ebda7-288">Nous pouvons fournir une valeur par défaut autre que `NULL` pour une ou plusieurs de ces valeurs de colonne, soit parce que `NULL` n’est pas la meilleure option par défaut, soit parce que la colonne de base de données elle-même n’autorise pas les `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="ebda7-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="ebda7-289">Pour ce faire, nous pouvons définir par programmation les valeurs des paramètres de la collection de `InputParameters` du contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ebda7-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="ebda7-290">Cette assignation peut être effectuée dans le gestionnaire d’événements pour l’événement de `ItemInserting` du contrôle DetailsView ou l’événement de `Inserting` de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="ebda7-291">Étant donné que nous avons déjà examiné l’utilisation des événements antérieurs et postérieurs au niveau du contrôle de données Web, nous allons explorer l’utilisation des événements de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="ebda7-292">Étape 4 : affectation de valeurs aux paramètres`CategoryID`et`SupplierID`</span><span class="sxs-lookup"><span data-stu-id="ebda7-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="ebda7-293">Pour ce didacticiel, supposons que pour notre application, lors de l’ajout d’un nouveau produit via cette interface, un `CategoryID` et `SupplierID` valeur de 1 lui soient attribués.</span><span class="sxs-lookup"><span data-stu-id="ebda7-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="ebda7-294">Comme mentionné précédemment, l’ObjectDataSource contient une paire d’événements de pré-et de poste qui se déclenchent pendant le processus de modification des données.</span><span class="sxs-lookup"><span data-stu-id="ebda7-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="ebda7-295">Lorsque sa méthode `Insert()` est appelée, ObjectDataSource commence par déclencher son événement `Inserting`, puis appelle la méthode à laquelle sa méthode `Insert()` a été mappée, puis déclenche l’événement `Inserted`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="ebda7-296">Le gestionnaire d’événements `Inserting` vous offre une dernière possibilité de modifier les paramètres d’entrée ou d’annuler l’opération.</span><span class="sxs-lookup"><span data-stu-id="ebda7-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="ebda7-297">Dans une application réelle, vous souhaiterez peut-être laisser l’utilisateur spécifier la catégorie et le fournisseur ou choisir cette valeur pour ces éléments en fonction de certains critères ou de la logique métier (au lieu de sélectionner aveuglément un ID de 1).</span><span class="sxs-lookup"><span data-stu-id="ebda7-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="ebda7-298">Quoi qu’il en soit, l’exemple montre comment définir par programmation la valeur d’un paramètre d’entrée à partir de l’événement de préniveau de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>

<span data-ttu-id="ebda7-299">Prenez un moment pour créer un gestionnaire d’événements pour l’événement de `Inserting` de l’ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="ebda7-300">Notez que le deuxième paramètre d’entrée du gestionnaire d’événements est un objet de type `ObjectDataSourceMethodEventArgs`, qui a une propriété pour accéder à la collection de paramètres (`InputParameters`) et à une propriété pour annuler l’opération (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="ebda7-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample10.vb)]

<span data-ttu-id="ebda7-301">À ce stade, la propriété `InputParameters` contient la collection d’ObjectDataSource `InsertParameters` avec les valeurs assignées à partir du contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ebda7-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="ebda7-302">Pour modifier la valeur de l’un de ces paramètres, utilisez simplement : `e.InputParameters("paramName") = value`.</span><span class="sxs-lookup"><span data-stu-id="ebda7-302">To change the value of one of these parameters, simply use: `e.InputParameters("paramName") = value`.</span></span> <span data-ttu-id="ebda7-303">Par conséquent, pour définir les `CategoryID` et `SupplierID` sur les valeurs 1, ajustez le `Inserting` gestionnaire d’événements de façon à ce qu’il ressemble à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="ebda7-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample11.vb)]

<span data-ttu-id="ebda7-304">Cette fois-ci, lorsque vous ajoutez un nouveau produit (par exemple, Acme soda), les colonnes `CategoryID` et `SupplierID` du nouveau produit sont définies sur 1 (voir figure 20).</span><span class="sxs-lookup"><span data-stu-id="ebda7-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>

<span data-ttu-id="ebda7-305">[![les nouveaux produits ont maintenant leurs valeurs CategoryID et RéfFournisseur définies sur 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="ebda7-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span></span>

<span data-ttu-id="ebda7-306">**Figure 20**: les valeurs `CategoryID` et `SupplierID` des nouveaux produits sont désormais définies sur 1 ([cliquez pour afficher l’image en taille réelle](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="ebda7-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ebda7-307">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="ebda7-307">Summary</span></span>

<span data-ttu-id="ebda7-308">Pendant le processus de modification, d’insertion et de suppression, le contrôle Web de données et l’ObjectDataSource passent par un certain nombre d’événements de pré-et de après-niveau.</span><span class="sxs-lookup"><span data-stu-id="ebda7-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="ebda7-309">Dans ce didacticiel, nous avons examiné les événements de préversion et vu comment les utiliser pour personnaliser les paramètres d’entrée ou annuler l’opération de modification des données à la fois à partir du contrôle Web des données et des événements de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ebda7-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="ebda7-310">Dans le didacticiel suivant, nous allons examiner comment créer et utiliser des gestionnaires d’événements pour les événements de publication.</span><span class="sxs-lookup"><span data-stu-id="ebda7-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="ebda7-311">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="ebda7-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ebda7-312">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="ebda7-312">About the Author</span></span>

<span data-ttu-id="ebda7-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="ebda7-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ebda7-314">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="ebda7-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ebda7-315">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ebda7-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ebda7-316">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ebda7-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ebda7-317">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="ebda7-317">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ebda7-318">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="ebda7-318">Special Thanks To</span></span>

<span data-ttu-id="ebda7-319">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="ebda7-319">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ebda7-320">Les réviseurs de leads pour ce didacticiel étaient Jackie Goor et Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="ebda7-320">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="ebda7-321">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="ebda7-321">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ebda7-322">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ebda7-322">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ebda7-323">[Précédent](an-overview-of-inserting-updating-and-deleting-data-vb.md)
> [Suivant](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ebda7-323">[Previous](an-overview-of-inserting-updating-and-deleting-data-vb.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span></span>
