---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb
title: Ajout de contrôles de validation aux interfaces de modification et d’insertion (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons voir combien il est facile d’ajouter des contrôles de validation aux EditItemTemplate et InsertItemTemplate d’un contrôle Web de données, afin de fournir un plus grand nombre de contrôles...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: e3d7028a-7a22-4a4f-babe-d53afc41c0e2
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c5ad110ee0836f0a464b02a2b29254e2e06381e
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78592826"
---
# <a name="adding-validation-controls-to-the-editing-and-inserting-interfaces-vb"></a><span data-ttu-id="5319d-103">Ajout de contrôles Validation aux interfaces de modification et d’insertion (VB)</span><span class="sxs-lookup"><span data-stu-id="5319d-103">Adding Validation Controls to the Editing and Inserting Interfaces (VB)</span></span>

<span data-ttu-id="5319d-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5319d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5319d-105">[Télécharger l’exemple d’application](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_VB.exe) ou [Télécharger le PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/datatutorial19vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5319d-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_VB.exe) or [Download PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/datatutorial19vb1.pdf)</span></span>

> <span data-ttu-id="5319d-106">Dans ce didacticiel, nous allons voir combien il est facile d’ajouter des contrôles de validation aux EditItemTemplate et InsertItemTemplate d’un contrôle Web de données, afin de fournir une interface utilisateur plus infaillible.</span><span class="sxs-lookup"><span data-stu-id="5319d-106">In this tutorial we'll see how easy it is to add validation controls to the EditItemTemplate and InsertItemTemplate of a data Web control, to provide a more foolproof user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="5319d-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="5319d-107">Introduction</span></span>

<span data-ttu-id="5319d-108">Les contrôles GridView et DetailsView des exemples que nous avons explorés au cours des trois derniers didacticiels ont tous été composés de BoundFields et CheckBoxFields (les types de champs ajoutés automatiquement par Visual Studio lors de la liaison d’un GridView ou d’un DetailsView à une source de données) contrôle via la balise active).</span><span class="sxs-lookup"><span data-stu-id="5319d-108">The GridView and DetailsView controls in the examples we've explored over the past three tutorials have all been composed of BoundFields and CheckBoxFields (the field types automatically added by Visual Studio when binding a GridView or DetailsView to a data source control through the smart tag).</span></span> <span data-ttu-id="5319d-109">Lors de la modification d’une ligne dans un contrôle GridView ou DetailsView, les BoundFields qui ne sont pas en lecture seule sont convertis en zones de texte, à partir desquelles l’utilisateur final peut modifier les données existantes.</span><span class="sxs-lookup"><span data-stu-id="5319d-109">When editing a row in a GridView or DetailsView, those BoundFields that are not read-only are converted into textboxes, from which the end user can modify the existing data.</span></span> <span data-ttu-id="5319d-110">De même, lors de l’insertion d’un nouvel enregistrement dans un contrôle DetailsView, les BoundFields dont la propriété `InsertVisible` a la valeur `True` (valeur par défaut) sont rendus sous forme de zones de texte vides, dans lesquelles l’utilisateur peut fournir les valeurs de champ de l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="5319d-110">Similarly, when inserting a new record into a DetailsView control, those BoundFields whose `InsertVisible` property is set to `True` (the default) are rendered as empty textboxes, into which the user can provide the new record's field values.</span></span> <span data-ttu-id="5319d-111">De même, les CheckBoxFields, qui sont désactivés dans l’interface standard en lecture seule, sont convertis en cases à cocher activées dans les interfaces de modification et d’insertion.</span><span class="sxs-lookup"><span data-stu-id="5319d-111">Likewise, CheckBoxFields, which are disabled in the standard, read-only interface, are converted into enabled checkboxes in the editing and inserting interfaces.</span></span>

<span data-ttu-id="5319d-112">Alors que les interfaces de modification et d’insertion par défaut pour BoundField et CheckBoxField peuvent être utiles, l’interface ne dispose d’aucune sorte de validation.</span><span class="sxs-lookup"><span data-stu-id="5319d-112">While the default editing and inserting interfaces for the BoundField and CheckBoxField can be helpful, the interface lacks any sort of validation.</span></span> <span data-ttu-id="5319d-113">Si un utilisateur fait une erreur d’entrée de données, par exemple en omettant le champ `ProductName` ou en entrant une valeur non valide pour `UnitsInStock` (telle que-50), une exception est levée à partir des profondeurs de l’architecture de l’application.</span><span class="sxs-lookup"><span data-stu-id="5319d-113">If a user makes a data entry mistake - such as omitting the `ProductName` field or entering an invalid value for `UnitsInStock` (such as -50) an exception will be raised from within the depths of the application architecture.</span></span> <span data-ttu-id="5319d-114">Bien que cette exception puisse être gérée de façon appropriée comme illustré dans le [didacticiel précédent](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md), idéalement, la modification ou l’insertion d’une interface utilisateur inclurait des contrôles de validation pour empêcher un utilisateur d’entrer de telles données non valides en premier lieu.</span><span class="sxs-lookup"><span data-stu-id="5319d-114">While this exception can be gracefully handled as demonstrated in the [previous tutorial](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md), ideally the editing or inserting user interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="5319d-115">Pour fournir une interface de modification ou d’insertion personnalisée, nous devons remplacer BoundField ou CheckBoxField par un TemplateField.</span><span class="sxs-lookup"><span data-stu-id="5319d-115">In order to provide a customized editing or inserting interface, we need to replace the BoundField or CheckBoxField with a TemplateField.</span></span> <span data-ttu-id="5319d-116">TemplateFields, qui a été le sujet de la discussion dans l' [utilisation de TemplateFields dans le contrôle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) et [l’utilisation de TemplateFields dans les](../custom-formatting/using-templatefields-in-the-detailsview-control-vb.md) didacticiels de contrôle DetailsView, peut être constitué de plusieurs modèles définissant des interfaces distinctes pour différents États de ligne.</span><span class="sxs-lookup"><span data-stu-id="5319d-116">TemplateFields, which were the topic of discussion in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) and [Using TemplateFields in the DetailsView Control](../custom-formatting/using-templatefields-in-the-detailsview-control-vb.md) tutorials, can consist of multiple templates defining separate interfaces for different row states.</span></span> <span data-ttu-id="5319d-117">Le `ItemTemplate` TemplateField est utilisé lors du rendu de champs ou de lignes en lecture seule dans les contrôles DetailsView ou GridView, tandis que les `EditItemTemplate` et `InsertItemTemplate` indiquent les interfaces à utiliser respectivement pour les modes édition et insertion.</span><span class="sxs-lookup"><span data-stu-id="5319d-117">The TemplateField's `ItemTemplate` is used to when rendering read-only fields or rows in the DetailsView or GridView controls, whereas the `EditItemTemplate` and `InsertItemTemplate` indicate the interfaces to use for the editing and inserting modes, respectively.</span></span>

<span data-ttu-id="5319d-118">Dans ce didacticiel, nous allons voir combien il est facile d’ajouter des contrôles de validation à la `EditItemTemplate` du TemplateField et `InsertItemTemplate` de fournir une interface utilisateur plus infaillible.</span><span class="sxs-lookup"><span data-stu-id="5319d-118">In this tutorial we'll see how easy it is to add validation controls to the TemplateField's `EditItemTemplate` and `InsertItemTemplate` to provide a more foolproof user interface.</span></span> <span data-ttu-id="5319d-119">Plus précisément, ce didacticiel prend l’exemple créé dans le didacticiel [examen des événements associés à l’insertion, la mise à jour et la suppression](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) et augmente les interfaces de modification et d’insertion pour inclure la validation appropriée.</span><span class="sxs-lookup"><span data-stu-id="5319d-119">Specifically, this tutorial takes the example created in the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial and augments the editing and inserting interfaces to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromexamining-the-events-associated-with-inserting-updating-and-deleting"></a><span data-ttu-id="5319d-120">Étape 1 : réplication de l’exemple à partir de[l’examen des événements associés à l’insertion, la mise à jour et la suppression](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5319d-120">Step 1: Replicating the Example from[Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>

<span data-ttu-id="5319d-121">Dans le didacticiel [examen des événements associés à l’insertion, à la mise à jour et à la suppression,](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) nous avons créé une page qui répertorie les noms et les prix des produits dans un GridView modifiable.</span><span class="sxs-lookup"><span data-stu-id="5319d-121">In the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial we created a page that listed the names and prices of the products in an editable GridView.</span></span> <span data-ttu-id="5319d-122">En outre, la page incluait un DetailsView dont la propriété `DefaultMode` était définie sur `Insert`, ce qui rendait donc toujours le rendu en mode insertion.</span><span class="sxs-lookup"><span data-stu-id="5319d-122">Additionally, the page included a DetailsView whose `DefaultMode` property was set to `Insert`, thereby always rendering in insert mode.</span></span> <span data-ttu-id="5319d-123">À partir de ce DetailsView, l’utilisateur peut entrer le nom et le prix d’un nouveau produit, cliquer sur Insérer et l’avoir ajouté au système (voir la figure 1).</span><span class="sxs-lookup"><span data-stu-id="5319d-123">From this DetailsView, the user could enter the name and price for a new product, click Insert, and have it added to the system (see Figure 1).</span></span>

<span data-ttu-id="5319d-124">[![l’exemple précédent permet aux utilisateurs d’ajouter de nouveaux produits et de modifier ceux qui existent déjà.](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-124">[![The Previous Example Allows Users to Add New Products and Edit Existing Ones](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image1.png)</span></span>

<span data-ttu-id="5319d-125">**Figure 1**: l’exemple précédent permet aux utilisateurs d’ajouter de nouveaux produits et de modifier ceux qui existent déjà ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-125">**Figure 1**: The Previous Example Allows Users to Add New Products and Edit Existing Ones ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image3.png))</span></span>

<span data-ttu-id="5319d-126">L’objectif de ce didacticiel est d’augmenter le DetailsView et GridView pour fournir des contrôles de validation.</span><span class="sxs-lookup"><span data-stu-id="5319d-126">Our goal for this tutorial is to augment the DetailsView and GridView to provide validation controls.</span></span> <span data-ttu-id="5319d-127">En particulier, notre logique de validation :</span><span class="sxs-lookup"><span data-stu-id="5319d-127">In particular, our validation logic will:</span></span>

- <span data-ttu-id="5319d-128">Exiger que le nom soit fourni lors de l’insertion ou de la modification d’un produit</span><span class="sxs-lookup"><span data-stu-id="5319d-128">Require that the name be provided when inserting or editing a product</span></span>
- <span data-ttu-id="5319d-129">Exiger que le prix soit fourni lors de l’insertion d’un enregistrement ; lors de la modification d’un enregistrement, nous avons toujours besoin d’un prix, mais utilisera la logique de programmation dans le gestionnaire d’événements `RowUpdating` du GridView déjà présent dans le didacticiel précédent</span><span class="sxs-lookup"><span data-stu-id="5319d-129">Require that the price be provided when inserting a record; when editing a record, we will still require a price, but will use the programmatic logic in the GridView's `RowUpdating` event handler already present from the earlier tutorial</span></span>
- <span data-ttu-id="5319d-130">Vérifiez que la valeur entrée pour le prix est un format monétaire valide</span><span class="sxs-lookup"><span data-stu-id="5319d-130">Ensure that the value entered for the price is a valid currency format</span></span>

<span data-ttu-id="5319d-131">Avant de pouvoir examiner l’exemple précédent pour inclure la validation, nous devons d’abord répliquer l’exemple de la page `DataModificationEvents.aspx` vers la page de ce didacticiel, `UIValidation.aspx`.</span><span class="sxs-lookup"><span data-stu-id="5319d-131">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `DataModificationEvents.aspx` page to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="5319d-132">Pour ce faire, nous devons copier à la fois le balisage déclaratif de la page `DataModificationEvents.aspx` et son code source.</span><span class="sxs-lookup"><span data-stu-id="5319d-132">To accomplish this we need to copy over both the `DataModificationEvents.aspx` page's declarative markup and its source code.</span></span> <span data-ttu-id="5319d-133">Tout d’abord, copiez le balisage déclaratif en effectuant les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="5319d-133">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="5319d-134">Ouvrir la page `DataModificationEvents.aspx` dans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5319d-134">Open the `DataModificationEvents.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="5319d-135">Accédez au balisage déclaratif de la page (cliquez sur le bouton source en bas de la page).</span><span class="sxs-lookup"><span data-stu-id="5319d-135">Go to the page's declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="5319d-136">Copiez le texte dans les balises `<asp:Content>` et `</asp:Content>` (lignes 3 à 44), comme illustré à la figure 2.</span><span class="sxs-lookup"><span data-stu-id="5319d-136">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 44), as shown in Figure 2.</span></span>

<span data-ttu-id="5319d-137">[![copier le texte dans le contrôle &lt;asp : content&gt;](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-137">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image4.png)</span></span>

<span data-ttu-id="5319d-138">**Figure 2**: copier le texte dans le contrôle de `<asp:Content>` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-138">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image6.png))</span></span>

1. <span data-ttu-id="5319d-139">Ouvrir la page `UIValidation.aspx`</span><span class="sxs-lookup"><span data-stu-id="5319d-139">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="5319d-140">Atteindre le balisage déclaratif de la page</span><span class="sxs-lookup"><span data-stu-id="5319d-140">Go to the page's declarative markup</span></span>
3. <span data-ttu-id="5319d-141">Collez le texte dans le contrôle `<asp:Content>`.</span><span class="sxs-lookup"><span data-stu-id="5319d-141">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="5319d-142">Pour copier le code source, ouvrez la page `DataModificationEvents.aspx.vb` et copiez simplement le texte *dans* la classe `EditInsertDelete_DataModificationEvents`.</span><span class="sxs-lookup"><span data-stu-id="5319d-142">To copy over the source code, open the `DataModificationEvents.aspx.vb` page and copy just the text *within* the `EditInsertDelete_DataModificationEvents` class.</span></span> <span data-ttu-id="5319d-143">Copiez les trois gestionnaires d’événements (`Page_Load`, `GridView1_RowUpdating`et `ObjectDataSource1_Inserting`), mais ne copiez **pas** la déclaration de classe.</span><span class="sxs-lookup"><span data-stu-id="5319d-143">Copy the three event handlers (`Page_Load`, `GridView1_RowUpdating`, and `ObjectDataSource1_Inserting`), but do **not** copy the class declaration.</span></span> <span data-ttu-id="5319d-144">Collez le texte copié *dans* la classe `EditInsertDelete_UIValidation` dans `UIValidation.aspx.vb`.</span><span class="sxs-lookup"><span data-stu-id="5319d-144">Paste the copied text *within* the `EditInsertDelete_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="5319d-145">Après avoir déplacé le contenu et le code de `DataModificationEvents.aspx` vers `UIValidation.aspx`, prenez un moment pour tester votre progression dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="5319d-145">After moving over the content and code from `DataModificationEvents.aspx` to `UIValidation.aspx`, take a moment to test out your progress in a browser.</span></span> <span data-ttu-id="5319d-146">Vous devez voir la même sortie et expérimenter les mêmes fonctionnalités dans chacune de ces deux pages (reportez-vous à la figure 1 pour obtenir une capture d’écran de `DataModificationEvents.aspx` en action).</span><span class="sxs-lookup"><span data-stu-id="5319d-146">You should see the same output and experience the same functionality in each of these two pages (refer back to Figure 1 for a screen shot of `DataModificationEvents.aspx` in action).</span></span>

## <a name="step-2-converting-the-boundfields-into-templatefields"></a><span data-ttu-id="5319d-147">Étape 2 : conversion du BoundFields en TemplateFields</span><span class="sxs-lookup"><span data-stu-id="5319d-147">Step 2: Converting the BoundFields Into TemplateFields</span></span>

<span data-ttu-id="5319d-148">Pour ajouter des contrôles de validation aux interfaces de modification et d’insertion, les BoundFields utilisés par les contrôles DetailsView et GridView doivent être convertis en TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="5319d-148">To add validation controls to the editing and inserting interfaces, the BoundFields used by the DetailsView and GridView controls need to be converted into TemplateFields.</span></span> <span data-ttu-id="5319d-149">Pour ce faire, cliquez respectivement sur les liens modifier les colonnes et modifier les champs dans les balises actives GridView et DetailsView.</span><span class="sxs-lookup"><span data-stu-id="5319d-149">To achieve this, click on the Edit Columns and Edit Fields links in the GridView and DetailsView's smart tags, respectively.</span></span> <span data-ttu-id="5319d-150">À partir de là, sélectionnez chacun des BoundFields et cliquez sur le lien « convertir ce champ en TemplateField ».</span><span class="sxs-lookup"><span data-stu-id="5319d-150">There, select each of the BoundFields and click the "Convert this field into a TemplateField" link.</span></span>

<span data-ttu-id="5319d-151">[![convertir chaque BoundFields du contrôle DetailsView et GridView en TemplateFields](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-151">[![Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image7.png)</span></span>

<span data-ttu-id="5319d-152">**Figure 3**: convertir chaque BoundFields du contrôle DetailsView et de GridView en TemplateFields ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-152">**Figure 3**: Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image9.png))</span></span>

<span data-ttu-id="5319d-153">La conversion d’un BoundField en TemplateField via la boîte de dialogue champs génère un TemplateField qui présente les mêmes interfaces en lecture seule, modification et insertion que le BoundField lui-même.</span><span class="sxs-lookup"><span data-stu-id="5319d-153">Converting a BoundField into a TemplateField through the Fields dialog box generates a TemplateField that exhibits the same read-only, editing, and inserting interfaces as the BoundField itself.</span></span> <span data-ttu-id="5319d-154">Le balisage suivant montre la syntaxe déclarative pour le champ `ProductName` dans le DetailsView une fois qu’il a été converti en TemplateField :</span><span class="sxs-lookup"><span data-stu-id="5319d-154">The following markup shows the declarative syntax for the `ProductName` field in the DetailsView after it has been converted into a TemplateField:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample1.aspx)]

<span data-ttu-id="5319d-155">Notez que ce TemplateField avait trois modèles créés automatiquement `ItemTemplate`, `EditItemTemplate`et `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="5319d-155">Note that this TemplateField had three templates automatically created `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate`.</span></span> <span data-ttu-id="5319d-156">L' `ItemTemplate` affiche une valeur de champ de données unique (`ProductName`) à l’aide d’un contrôle Web Label, tandis que le `EditItemTemplate` et `InsertItemTemplate` présenter la valeur du champ de données dans un contrôle Web TextBox qui associe le champ de données à la propriété `Text` de la zone de texte à l’aide de la liaison de données bidirectionnelle.</span><span class="sxs-lookup"><span data-stu-id="5319d-156">The `ItemTemplate` displays a single data field value (`ProductName`) using a Label Web control, while the `EditItemTemplate` and `InsertItemTemplate` present the data field value in a TextBox Web control that associates the data field with the TextBox's `Text` property using two-way databinding.</span></span> <span data-ttu-id="5319d-157">Étant donné que nous utilisons uniquement le DetailsView dans cette page pour l’insertion, vous pouvez supprimer les `ItemTemplate` et `EditItemTemplate` des deux TemplateFields, bien qu’il n’y ait pas de danger de les laisser.</span><span class="sxs-lookup"><span data-stu-id="5319d-157">Since we are only using the DetailsView in this page for inserting, you may remove the `ItemTemplate` and `EditItemTemplate` from the two TemplateFields, although there's no harm in leaving them.</span></span>

<span data-ttu-id="5319d-158">Étant donné que le contrôle GridView ne prend pas en charge les fonctionnalités d’insertion intégrées du contrôle DetailsView, la conversion du champ `ProductName` du contrôle GridView en TemplateField entraîne uniquement l' `ItemTemplate` et l' `EditItemTemplate`:</span><span class="sxs-lookup"><span data-stu-id="5319d-158">Since the GridView does not support the built-in inserting features of the DetailsView, converting the GridView's `ProductName` field into a TemplateField results in only an `ItemTemplate` and `EditItemTemplate`:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample2.aspx)]

<span data-ttu-id="5319d-159">En cliquant sur le bouton « convertir ce champ en TemplateField », Visual Studio a créé un TemplateField dont les modèles imitent l’interface utilisateur du BoundField converti.</span><span class="sxs-lookup"><span data-stu-id="5319d-159">By clicking the "Convert this field into a TemplateField," Visual Studio has created a TemplateField whose templates mimic the user interface of the converted BoundField.</span></span> <span data-ttu-id="5319d-160">Vous pouvez le vérifier en visitant cette page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="5319d-160">You can verify this by visiting this page through a browser.</span></span> <span data-ttu-id="5319d-161">Vous constaterez que l’apparence et le comportement du TemplateFields sont identiques à ceux de l’utilisation de BoundFields à la place.</span><span class="sxs-lookup"><span data-stu-id="5319d-161">You'll find that the appearance and behavior of the TemplateFields is identical to the experience when BoundFields were used instead.</span></span>

> [!NOTE]
> <span data-ttu-id="5319d-162">N’hésitez pas à personnaliser les interfaces de modification dans les modèles en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="5319d-162">Feel free to customize the editing interfaces in the templates as needed.</span></span> <span data-ttu-id="5319d-163">Par exemple, nous pouvons souhaiter que la zone de texte dans le `UnitPrice` TemplateFields soit rendue sous la forme d’une zone de texte plus petite que la zone de texte `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="5319d-163">For example, we may want to have the TextBox in the `UnitPrice` TemplateFields rendered as a smaller textbox than the `ProductName` textbox.</span></span> <span data-ttu-id="5319d-164">Pour ce faire, vous pouvez définir la propriété `Columns` de la zone de texte sur une valeur appropriée ou fournir une largeur absolue via la propriété `Width`.</span><span class="sxs-lookup"><span data-stu-id="5319d-164">To accomplish this you can set the TextBox's `Columns` property to an appropriate value or provide an absolute width via the `Width` property.</span></span> <span data-ttu-id="5319d-165">Dans le didacticiel suivant, nous verrons comment personnaliser complètement l’interface de modification en remplaçant la zone de texte par un autre contrôle Web d’entrée de données.</span><span class="sxs-lookup"><span data-stu-id="5319d-165">In the next tutorial we'll see how to completely customize the editing interface by replacing the TextBox with an alternate data entry Web control.</span></span>

## <a name="step-3-adding-the-validation-controls-to-the-gridviewsedititemtemplate-s"></a><span data-ttu-id="5319d-166">Étape 3 : ajout des contrôles de validation aux`EditItemTemplate` de GridView</span><span class="sxs-lookup"><span data-stu-id="5319d-166">Step 3: Adding the Validation Controls to the GridView's`EditItemTemplate` s</span></span>

<span data-ttu-id="5319d-167">Lors de la construction de formulaires de saisie de données, il est important que les utilisateurs entrent les champs obligatoires et que toutes les entrées fournies soient des valeurs valides et correctement mises en forme.</span><span class="sxs-lookup"><span data-stu-id="5319d-167">When constructing data entry forms, it is important that users enter any required fields and that all provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="5319d-168">Pour vous assurer que les entrées d’un utilisateur sont valides, ASP.NET fournit cinq contrôles de validation intégrés conçus pour valider la valeur d’un contrôle d’entrée unique :</span><span class="sxs-lookup"><span data-stu-id="5319d-168">To help ensure that a user's inputs are valid, ASP.NET provides five built-in validation controls that are designed to be used to validate the value of a single input control:</span></span>

- <span data-ttu-id="5319d-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) garantit qu’une valeur a été fournie</span><span class="sxs-lookup"><span data-stu-id="5319d-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="5319d-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) valide une valeur par rapport à une autre valeur de contrôle Web ou une valeur constante, ou garantit que le format de la valeur est légal pour un type de données spécifié</span><span class="sxs-lookup"><span data-stu-id="5319d-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value's format is legal for a specified data type</span></span>
- <span data-ttu-id="5319d-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) garantit qu’une valeur est comprise dans une plage de valeurs</span><span class="sxs-lookup"><span data-stu-id="5319d-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="5319d-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) valide une valeur par rapport à une [expression régulière](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="5319d-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="5319d-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) valide une valeur par rapport à une méthode personnalisée définie par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="5319d-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="5319d-174">Pour plus d’informations sur ces cinq contrôles, consultez la [section contrôles de validation](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) des [didacticiels de démarrage rapide ASP.net](https://asp.net/QuickStart/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="5319d-174">For more information on these five controls, check out the [Validation Controls section](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://asp.net/QuickStart/aspnet/).</span></span>

<span data-ttu-id="5319d-175">Pour notre didacticiel, nous allons utiliser un contrôle RequiredFieldValidator à la fois dans les `ProductName` DetailsView et GridView, ainsi qu’avec un RequiredFieldValidator dans le `UnitPrice` TemplateField du contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="5319d-175">For our tutorial we'll need to use a RequiredFieldValidator in both the DetailsView and GridView's `ProductName` TemplateFields and a RequiredFieldValidator in the DetailsView's `UnitPrice` TemplateField.</span></span> <span data-ttu-id="5319d-176">En outre, nous devons ajouter un CompareValidator aux deux contrôles `UnitPrice` TemplateFields, qui garantit que le prix entré a une valeur supérieure ou égale à 0 et qu’il est présenté dans un format monétaire valide.</span><span class="sxs-lookup"><span data-stu-id="5319d-176">Furthermore, we'll need to add a CompareValidator to both controls' `UnitPrice` TemplateFields that ensures that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="5319d-177">Alors que ASP.NET 1. x contenait ces cinq mêmes contrôles de validation, ASP.NET 2,0 a ajouté un certain nombre d’améliorations, les deux principaux étant la prise en charge des scripts côté client pour les navigateurs autres qu’Internet Explorer et la possibilité de partitionner les contrôles de validation sur une page dans groupes de validation.</span><span class="sxs-lookup"><span data-stu-id="5319d-177">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers other than Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="5319d-178">Pour plus d’informations sur les nouvelles fonctionnalités de contrôle de validation dans 2,0, consultez [la section discroisant les contrôles de validation dans ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="5319d-178">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>

<span data-ttu-id="5319d-179">Commençons par ajouter les contrôles de validation nécessaires aux `EditItemTemplate` s dans le TemplateFields du GridView.</span><span class="sxs-lookup"><span data-stu-id="5319d-179">Let's start by adding the necessary validation controls to the `EditItemTemplate` s in the GridView's TemplateFields.</span></span> <span data-ttu-id="5319d-180">Pour ce faire, cliquez sur le lien modifier les modèles à partir de la balise active du contrôle GridView pour afficher l’interface de modification du modèle.</span><span class="sxs-lookup"><span data-stu-id="5319d-180">To accomplish this, click on the Edit Templates link from the GridView's smart tag to bring up the template editing interface.</span></span> <span data-ttu-id="5319d-181">À partir de là, vous pouvez sélectionner le modèle à modifier dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="5319d-181">From here, you can select which template to edit from the drop-down list.</span></span> <span data-ttu-id="5319d-182">Étant donné que nous souhaitons augmenter l’interface de modification, nous devons ajouter des contrôles de validation aux `ProductName` et à la `EditItemTemplate` de `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="5319d-182">Since we want to augment the editing interface, we need to add validation controls to the `ProductName` and `UnitPrice`'s `EditItemTemplate` s.</span></span>

<span data-ttu-id="5319d-183">[![nous devons étendre les EditItemTemplates ProductName et UnitPrice](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-183">[![We Need to Extend the ProductName and UnitPrice's EditItemTemplates](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image10.png)</span></span>

<span data-ttu-id="5319d-184">**Figure 4**: nous devons étendre la `ProductName` et les `EditItemTemplate` de `UnitPrice`([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-184">**Figure 4**: We Need to Extend the `ProductName` and `UnitPrice`'s `EditItemTemplate` s ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image12.png))</span></span>

<span data-ttu-id="5319d-185">Dans la `EditItemTemplate``ProductName`, ajoutez un RequiredFieldValidator en le faisant glisser de la boîte à outils vers l’interface de modification de modèle, en plaçant après la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="5319d-185">In the `ProductName` `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing after the TextBox.</span></span>

<span data-ttu-id="5319d-186">[![ajouter un RequiredFieldValidator à la valeur ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-186">[![Add a RequiredFieldValidator to the ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image13.png)</span></span>

<span data-ttu-id="5319d-187">**Figure 5**: ajouter un RequiredFieldValidator au `EditItemTemplate` `ProductName` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-187">**Figure 5**: Add a RequiredFieldValidator to the `ProductName` `EditItemTemplate` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image15.png))</span></span>

<span data-ttu-id="5319d-188">Tous les contrôles de validation fonctionnent en validant l’entrée d’un seul contrôle Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5319d-188">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="5319d-189">Par conséquent, nous devons indiquer que le contrôle RequiredFieldValidator que nous venons d’ajouter doit effectuer une validation par rapport à la zone de texte de la `EditItemTemplate`; pour ce faire, affectez à la [propriété ControlToValidate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) du contrôle de validation la `ID` du contrôle Web approprié.</span><span class="sxs-lookup"><span data-stu-id="5319d-189">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the TextBox in the `EditItemTemplate`; this is accomplished by setting the validation control's [ControlToValidate property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control.</span></span> <span data-ttu-id="5319d-190">La zone de texte a actuellement le `ID` nondescript de `TextBox1`, mais nous allons la remplacer par une valeur plus appropriée.</span><span class="sxs-lookup"><span data-stu-id="5319d-190">The TextBox currently has the rather nondescript `ID` of `TextBox1`, but let's change it to something more appropriate.</span></span> <span data-ttu-id="5319d-191">Cliquez sur la zone de texte dans le modèle, puis, dans la Fenêtre Propriétés, remplacez la `ID` `TextBox1` par `EditProductName`.</span><span class="sxs-lookup"><span data-stu-id="5319d-191">Click on the TextBox in the template and then, from the Properties window, change the `ID` from `TextBox1` to `EditProductName`.</span></span>

<span data-ttu-id="5319d-192">[![modifier l’ID de la zone de texte en EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-192">[![Change the TextBox's ID to EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image16.png)</span></span>

<span data-ttu-id="5319d-193">**Figure 6**: modifier le `ID` de la zone de texte en `EditProductName` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-193">**Figure 6**: Change the TextBox's `ID` to `EditProductName` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image18.png))</span></span>

<span data-ttu-id="5319d-194">Ensuite, affectez à la propriété de `ControlToValidate` de RequiredFieldValidator la valeur `EditProductName`.</span><span class="sxs-lookup"><span data-stu-id="5319d-194">Next, set the RequiredFieldValidator's `ControlToValidate` property to `EditProductName`.</span></span> <span data-ttu-id="5319d-195">Enfin, définissez la [propriété ErrorMessage](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) sur « vous devez fournir le nom du produit » et la [propriété Text](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) sur «\*».</span><span class="sxs-lookup"><span data-stu-id="5319d-195">Finally, set the [ErrorMessage property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to "You must provide the product's name" and the [Text property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to "\*".</span></span> <span data-ttu-id="5319d-196">La valeur de la propriété `Text`, si elle est fournie, est le texte affiché par le contrôle de validation si la validation échoue.</span><span class="sxs-lookup"><span data-stu-id="5319d-196">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="5319d-197">La valeur de la propriété `ErrorMessage`, qui est obligatoire, est utilisée par le contrôle ValidationSummary ; Si la valeur de la propriété `Text` est omise, la valeur de la propriété `ErrorMessage` est également le texte affiché par le contrôle de validation sur une entrée non valide.</span><span class="sxs-lookup"><span data-stu-id="5319d-197">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is also the text displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="5319d-198">Après avoir défini ces trois propriétés de RequiredFieldValidator, votre écran doit ressembler à la figure 7.</span><span class="sxs-lookup"><span data-stu-id="5319d-198">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 7.</span></span>

<span data-ttu-id="5319d-199">[![définir les propriétés ControlToValidate, ErrorMessage et Text de RequiredFieldValidator](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-199">[![Set the RequiredFieldValidator's ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image19.png)</span></span>

<span data-ttu-id="5319d-200">**Figure 7**: définir les propriétés de `ControlToValidate`, `ErrorMessage`et `Text` du RequiredFieldValidator ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-200">**Figure 7**: Set the RequiredFieldValidator's `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image21.png))</span></span>

<span data-ttu-id="5319d-201">Une fois que le contrôle RequiredFieldValidator a été ajouté au `ProductName` `EditItemTemplate`, il ne reste plus qu’à ajouter la validation nécessaire au `EditItemTemplate``UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="5319d-201">With the RequiredFieldValidator added to the `ProductName` `EditItemTemplate`, all that remains is to add the necessary validation to the `UnitPrice` `EditItemTemplate`.</span></span> <span data-ttu-id="5319d-202">Étant donné que nous avons décidé que, pour cette page, l' `UnitPrice` est facultatif lors de la modification d’un enregistrement, nous n’avons pas besoin d’ajouter un RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="5319d-202">Since we've decided that, for this page, the `UnitPrice` is optional when editing a record, we don't need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="5319d-203">Toutefois, nous devons ajouter un CompareValidator pour vous assurer que le `UnitPrice`, s’il est fourni, est correctement mis en forme en tant que devise et supérieur ou égal à 0.</span><span class="sxs-lookup"><span data-stu-id="5319d-203">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="5319d-204">Avant d’ajouter CompareValidator à la `UnitPrice` `EditItemTemplate`, nous allons d’abord modifier l’ID du contrôle Web TextBox de `TextBox2` à `EditUnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="5319d-204">Before we add the CompareValidator to the `UnitPrice` `EditItemTemplate`, let's first change the TextBox Web control's ID from `TextBox2` to `EditUnitPrice`.</span></span> <span data-ttu-id="5319d-205">Après avoir apporté cette modification, ajoutez le CompareValidator, en affectant à sa propriété `ControlToValidate` la valeur `EditUnitPrice`, à sa propriété `ErrorMessage` la valeur « le prix doit être supérieur ou égal à zéro et ne peut pas inclure le symbole monétaire », et sa propriété `Text` à «\*».</span><span class="sxs-lookup"><span data-stu-id="5319d-205">After making this change, add the CompareValidator, setting its `ControlToValidate` property to `EditUnitPrice`, its `ErrorMessage` property to "The price must be greater than or equal to zero and cannot include the currency symbol", and its `Text` property to "\*".</span></span>

<span data-ttu-id="5319d-206">Pour indiquer que la valeur de `UnitPrice` doit être supérieure ou égale à 0, affectez à la [propriété Operator](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) du CompareValidator la valeur `GreaterThanEqual`, à sa [propriété ValueToCompare](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) la valeur « 0 » et à sa [propriété de type](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) la valeur `Currency`.</span><span class="sxs-lookup"><span data-stu-id="5319d-206">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator's [Operator property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [ValueToCompare property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to "0", and its [Type property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span> <span data-ttu-id="5319d-207">La syntaxe déclarative suivante montre le `EditItemTemplate` du `UnitPrice` TemplateField après que ces modifications ont été apportées :</span><span class="sxs-lookup"><span data-stu-id="5319d-207">The following declarative syntax shows the `UnitPrice` TemplateField's `EditItemTemplate` after these changes have been made:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample3.aspx)]

<span data-ttu-id="5319d-208">Après avoir apporté ces modifications, ouvrez la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="5319d-208">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="5319d-209">Si vous tentez d’omettre le nom ou d’entrer une valeur de prix non valide lors de la modification d’un produit, un astérisque apparaît en regard de la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="5319d-209">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="5319d-210">Comme le montre la figure 8, une valeur de prix qui comprend le symbole monétaire, tel que $19,95, est considérée comme non valide.</span><span class="sxs-lookup"><span data-stu-id="5319d-210">As Figure 8 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="5319d-211">Le `Currency` du CompareValidator `Type` autorise des séparateurs numériques (tels que des virgules ou des points, selon les paramètres de culture) et un signe plus ou moins de début, mais n’autorise *pas* de symbole monétaire.</span><span class="sxs-lookup"><span data-stu-id="5319d-211">The CompareValidator's `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="5319d-212">Ce comportement peut déguiser les utilisateurs, car l’interface de modification restitue actuellement le `UnitPrice` à l’aide du format monétaire.</span><span class="sxs-lookup"><span data-stu-id="5319d-212">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="5319d-213">Rappelez-vous que dans les événements associés au didacticiel d' *insertion, de mise à jour et de suppression* , nous définissons la propriété `DataFormatString` de BoundField sur `{0:c}` afin de la mettre en forme en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="5319d-213">Recall that in the *Events Associated with Inserting, Updating, and Deleting* tutorial we set the BoundField's `DataFormatString` property to `{0:c}` in order to format it as a currency.</span></span> <span data-ttu-id="5319d-214">En outre, nous définissons la propriété `ApplyFormatInEditMode` sur true, provoquant l’interface de modification du contrôle GridView pour mettre en forme la `UnitPrice` en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="5319d-214">Furthermore, we set the `ApplyFormatInEditMode` property to true, causing the GridView's editing interface to format the `UnitPrice` as a currency.</span></span> <span data-ttu-id="5319d-215">Lors de la conversion de BoundField en TemplateField, Visual Studio a noté ces paramètres et a mis en forme la propriété de `Text` de la zone de texte en tant que devise à l’aide de la syntaxe de liaison de données `<%# Bind("UnitPrice", "{0:c}") %>`.</span><span class="sxs-lookup"><span data-stu-id="5319d-215">When converting the BoundField into a TemplateField, Visual Studio noted these settings and formatted the TextBox's `Text` property as a currency using the databinding syntax `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span>

<span data-ttu-id="5319d-216">[![un astérisque apparaît en regard des zones de texte avec une entrée non valide](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-216">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image22.png)</span></span>

<span data-ttu-id="5319d-217">**Figure 8**: un astérisque apparaît en regard des zones de texte avec une entrée non valide ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-217">**Figure 8**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image24.png))</span></span>

<span data-ttu-id="5319d-218">Tandis que la validation fonctionne telle quelle, l’utilisateur doit supprimer manuellement le symbole monétaire lors de la modification d’un enregistrement, ce qui n’est pas acceptable.</span><span class="sxs-lookup"><span data-stu-id="5319d-218">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="5319d-219">Pour y remédier, nous disposons de trois options :</span><span class="sxs-lookup"><span data-stu-id="5319d-219">To remedy this, we have three options:</span></span>

1. <span data-ttu-id="5319d-220">Configurez la `EditItemTemplate` afin que la valeur `UnitPrice` ne soit pas mise en forme en tant que devise.</span><span class="sxs-lookup"><span data-stu-id="5319d-220">Configure the `EditItemTemplate` so that the `UnitPrice` value is not formatted as a currency.</span></span>
2. <span data-ttu-id="5319d-221">Autorisez l’utilisateur à entrer un symbole monétaire en supprimant CompareValidator et en le remplaçant par un RegularExpressionValidator qui vérifie correctement une valeur monétaire correctement mise en forme.</span><span class="sxs-lookup"><span data-stu-id="5319d-221">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that properly checks for a properly formatted currency value.</span></span> <span data-ttu-id="5319d-222">Le problème ici est que l’expression régulière pour valider une valeur monétaire n’est pas assez conviviale et nécessiterait l’écriture de code si nous voulions incorporer des paramètres de culture.</span><span class="sxs-lookup"><span data-stu-id="5319d-222">The problem here is that the regular expression to validate a currency value is not pretty and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="5319d-223">Supprimez complètement le contrôle de validation et reposez-vous sur la logique de validation côté serveur dans le gestionnaire d’événements `RowUpdating` du GridView.</span><span class="sxs-lookup"><span data-stu-id="5319d-223">Remove the validation control altogether and rely on server-side validation logic in the GridView's `RowUpdating` event handler.</span></span>

<span data-ttu-id="5319d-224">Passons à l’option #1 pour cet exercice.</span><span class="sxs-lookup"><span data-stu-id="5319d-224">Let's go with option #1 for this exercise.</span></span> <span data-ttu-id="5319d-225">Actuellement, le `UnitPrice` est mis en forme en tant que devise en raison de l’expression de liaison de données pour la zone de texte dans le `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span><span class="sxs-lookup"><span data-stu-id="5319d-225">Currently the `UnitPrice` is formatted as a currency due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="5319d-226">Modifiez l’instruction de liaison en `Bind("UnitPrice", "{0:n2}")`, qui met en forme le résultat sous la forme d’un nombre avec deux chiffres de précision.</span><span class="sxs-lookup"><span data-stu-id="5319d-226">Change the Bind statement to `Bind("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="5319d-227">Vous pouvez effectuer cette opération directement par le biais de la syntaxe déclarative ou en cliquant sur le lien modifier les DataBindings dans la zone de texte `EditUnitPrice` de la `EditItemTemplate` du `UnitPrice` TemplateField (voir figures 9 et 10).</span><span class="sxs-lookup"><span data-stu-id="5319d-227">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `EditUnitPrice` TextBox in the `UnitPrice` TemplateField's `EditItemTemplate` (see Figures 9 and 10).</span></span>

<span data-ttu-id="5319d-228">[![cliquez sur le lien modifier les DataBindings de la zone de texte](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-228">[![Click on the TextBox's Edit DataBindings link](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image25.png)</span></span>

<span data-ttu-id="5319d-229">**Figure 9**: cliquez sur le lien modifier les DataBindings de la zone de texte ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-229">**Figure 9**: Click on the TextBox's Edit DataBindings link ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image27.png))</span></span>

<span data-ttu-id="5319d-230">[![spécifier le spécificateur de format dans l’instruction de liaison](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-230">[![Specify the Format Specifier in the Bind Statement](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image28.png)</span></span>

<span data-ttu-id="5319d-231">**Figure 10**: spécifier le spécificateur de format dans l’instruction `Bind` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-231">**Figure 10**: Specify the Format Specifier in the `Bind` Statement ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image30.png))</span></span>

<span data-ttu-id="5319d-232">Avec cette modification, le prix mis en forme dans l’interface de modification comprend des virgules comme séparateur de groupes et un point comme séparateur décimal, mais ne quitte pas le symbole monétaire.</span><span class="sxs-lookup"><span data-stu-id="5319d-232">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="5319d-233">Le `EditItemTemplate` `UnitPrice` n’inclut pas un RequiredFieldValidator, ce qui permet la publication et la logique de mise à jour pour commencer.</span><span class="sxs-lookup"><span data-stu-id="5319d-233">The `UnitPrice` `EditItemTemplate` doesn't include a RequiredFieldValidator, allowing the postback to ensue and the updating logic to commence.</span></span> <span data-ttu-id="5319d-234">Toutefois, le gestionnaire d’événements `RowUpdating` copié à partir du didacticiel *examen des événements associés à l’insertion, à la mise à jour et à la suppression* comprend une vérification par programme qui garantit que la `UnitPrice` est fournie.</span><span class="sxs-lookup"><span data-stu-id="5319d-234">However, the `RowUpdating` event handler copied over from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial includes a programmatic check that ensures that the `UnitPrice` is provided.</span></span> <span data-ttu-id="5319d-235">N’hésitez pas à supprimer cette logique, à la conserver en l’espace de la fonction, ou à ajouter un RequiredFieldValidator au `EditItemTemplate`de `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="5319d-235">Feel free to remove this logic, leave it in as-is, or add a RequiredFieldValidator to the `UnitPrice` `EditItemTemplate`.</span></span>

## <a name="step-4-summarizing-data-entry-problems"></a><span data-ttu-id="5319d-236">Étape 4 : synthèse des problèmes d’entrée de données</span><span class="sxs-lookup"><span data-stu-id="5319d-236">Step 4: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="5319d-237">Outre les cinq contrôles de validation, ASP.NET comprend le [contrôle ValidationSummary](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), qui affiche le `ErrorMessage` s de ces contrôles de validation qui ont détecté des données non valides.</span><span class="sxs-lookup"><span data-stu-id="5319d-237">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="5319d-238">Ces données de synthèse peuvent être affichées sous forme de texte sur la page Web ou par le biais d’une MessageBox modale côté client.</span><span class="sxs-lookup"><span data-stu-id="5319d-238">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="5319d-239">Nous allons améliorer ce didacticiel pour inclure une MessageBox côté client résumant tous les problèmes de validation.</span><span class="sxs-lookup"><span data-stu-id="5319d-239">Let's enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="5319d-240">Pour ce faire, faites glisser un contrôle ValidationSummary de la boîte à outils vers le concepteur.</span><span class="sxs-lookup"><span data-stu-id="5319d-240">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="5319d-241">L’emplacement du contrôle de validation n’a pas vraiment d’importance, car nous allons le configurer pour afficher uniquement le résumé en tant que MessageBox.</span><span class="sxs-lookup"><span data-stu-id="5319d-241">The location of the Validation control doesn't really matter, since we're going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="5319d-242">Après avoir ajouté le contrôle, définissez sa [propriété ShowSummary](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) sur `False` et sa [propriété méthode ShowMessageBox](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) sur `True`.</span><span class="sxs-lookup"><span data-stu-id="5319d-242">After adding the control, set its [ShowSummary property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [ShowMessageBox property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="5319d-243">Dans ce cas, toutes les erreurs de validation sont résumées dans la MessageBox côté client.</span><span class="sxs-lookup"><span data-stu-id="5319d-243">With this addition, any validation errors are summarized in a client-side messagebox.</span></span>

<span data-ttu-id="5319d-244">[![les erreurs de validation sont résumées dans la MessageBox côté client](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-244">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image31.png)</span></span>

<span data-ttu-id="5319d-245">**Figure 11**: les erreurs de validation sont résumées dans la MessageBox côté client ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-245">**Figure 11**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image33.png))</span></span>

## <a name="step-5-adding-the-validation-controls-to-the-detailsviewsinsertitemtemplate"></a><span data-ttu-id="5319d-246">Étape 5 : ajout des contrôles de validation à la`InsertItemTemplate` du contrôle DetailsView</span><span class="sxs-lookup"><span data-stu-id="5319d-246">Step 5: Adding the Validation Controls to the DetailsView's`InsertItemTemplate`</span></span>

<span data-ttu-id="5319d-247">Tout ce qui reste pour ce didacticiel consiste à ajouter les contrôles de validation à l’interface d’insertion du contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="5319d-247">All that remains for this tutorial is to add the validation controls to the DetailsView's inserting interface.</span></span> <span data-ttu-id="5319d-248">Le processus d’ajout de contrôles de validation aux modèles du contrôle DetailsView est identique à celui examiné à l’étape 3. par conséquent, nous allons effectuer une tâche dans cette étape.</span><span class="sxs-lookup"><span data-stu-id="5319d-248">The process of adding validation controls to the DetailsView's templates is identical to that examined in Step 3; therefore, we'll breeze through the task in this step.</span></span> <span data-ttu-id="5319d-249">Comme nous l’avons fait avec le `EditItemTemplate` de GridView, je vous encourage à renommer les `ID` s des zones de texte nondescript `TextBox1` et `TextBox2` à `InsertProductName` et `InsertUnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="5319d-249">As we did with the GridView's `EditItemTemplate` s, I encourage you to rename the `ID` s of the TextBoxes from the nondescript `TextBox1` and `TextBox2` to `InsertProductName` and `InsertUnitPrice`.</span></span>

<span data-ttu-id="5319d-250">Ajoutez un RequiredFieldValidator à la `InsertItemTemplate``ProductName`.</span><span class="sxs-lookup"><span data-stu-id="5319d-250">Add a RequiredFieldValidator to the `ProductName` `InsertItemTemplate`.</span></span> <span data-ttu-id="5319d-251">Définissez le `ControlToValidate` sur le `ID` de la zone de texte dans le modèle, sa propriété `Text` sur «\*» et sa propriété `ErrorMessage` sur « vous devez fournir le nom du produit ».</span><span class="sxs-lookup"><span data-stu-id="5319d-251">Set the `ControlToValidate` to the `ID` of the TextBox in the template, its `Text` property to "\*" and its `ErrorMessage` property to "You must provide the product's name".</span></span>

<span data-ttu-id="5319d-252">Étant donné que la `UnitPrice` est requise pour cette page lors de l’ajout d’un nouvel enregistrement, ajoutez un contrôle RequiredFieldValidator au `InsertItemTemplate``UnitPrice`, en définissant ses propriétés `ControlToValidate`, `Text`et `ErrorMessage` de façon appropriée.</span><span class="sxs-lookup"><span data-stu-id="5319d-252">Since the `UnitPrice` is required for this page when adding a new record, add a RequiredFieldValidator to the `UnitPrice` `InsertItemTemplate`, setting its `ControlToValidate`, `Text`, and `ErrorMessage` properties appropriately.</span></span> <span data-ttu-id="5319d-253">Enfin, ajoutez un CompareValidator au `UnitPrice` `InsertItemTemplate` également, en configurant ses propriétés `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`et `ValueToCompare` comme nous l’avons fait avec le CompareValidator du `UnitPrice`dans le `EditItemTemplate`du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="5319d-253">Finally, add a CompareValidator to the `UnitPrice` `InsertItemTemplate` as well, configuring its `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`, and `ValueToCompare` properties just like we did with the `UnitPrice`'s CompareValidator in the GridView's `EditItemTemplate`.</span></span>

<span data-ttu-id="5319d-254">Après l’ajout de ces contrôles de validation, un nouveau produit ne peut pas être ajouté au système si son nom n’est pas fourni ou si son prix est un nombre négatif ou formaté illégalement.</span><span class="sxs-lookup"><span data-stu-id="5319d-254">After adding these validation controls, a new product cannot be added to the system if its name is not supplied or if its price is a negative number or illegally formatted.</span></span>

<span data-ttu-id="5319d-255">[![logique de validation a été ajoutée à l’interface d’insertion du contrôle DetailsView](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-255">[![Validation Logic has been Added to the DetailsView's Inserting Interface](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image34.png)</span></span>

<span data-ttu-id="5319d-256">**Figure 12**: la logique de validation a été ajoutée à l’interface d’insertion du contrôle DetailsView ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-256">**Figure 12**: Validation Logic has been Added to the DetailsView's Inserting Interface ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image36.png))</span></span>

## <a name="step-6-partitioning-the-validation-controls-into-validation-groups"></a><span data-ttu-id="5319d-257">Étape 6 : partitionnement des contrôles de validation en groupes de validation</span><span class="sxs-lookup"><span data-stu-id="5319d-257">Step 6: Partitioning the Validation Controls Into Validation Groups</span></span>

<span data-ttu-id="5319d-258">Notre page se compose de deux ensembles logiquement disparates de contrôles de validation : ceux qui correspondent à l’interface de modification du contrôle GridView et ceux qui correspondent à l’interface d’insertion du contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="5319d-258">Our page consists of two logically disparate sets of validation controls: those that correspond to the GridView's editing interface and those that correspond to the DetailsView's inserting interface.</span></span> <span data-ttu-id="5319d-259">Par défaut, lorsqu’une publication se produit, *tous les* contrôles de validation de la page sont vérifiés.</span><span class="sxs-lookup"><span data-stu-id="5319d-259">By default, when a postback occurs *all* validation controls on the page are checked.</span></span> <span data-ttu-id="5319d-260">Toutefois, lors de la modification d’un enregistrement, nous ne souhaitons pas valider les contrôles de validation de l’interface d’insertion du contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="5319d-260">However, when editing a record we don't want the DetailsView's inserting interface's validation controls to validate.</span></span> <span data-ttu-id="5319d-261">La figure 13 illustre notre dilemme en cours lorsqu’un utilisateur modifie un produit avec des valeurs parfaitement valides, en cliquant sur mettre à jour provoque une erreur de validation, car les valeurs nom et prix de l’interface d’insertion sont vides.</span><span class="sxs-lookup"><span data-stu-id="5319d-261">Figure 13 illustrates our current dilemma when a user is editing a product with perfectly legal values, clicking Update causes a validation error because the name and price values in the inserting interface are blank.</span></span>

<span data-ttu-id="5319d-262">[![la mise à jour d’un produit provoque le déclenchement des contrôles de validation de l’interface d’insertion](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-262">[![Updating a Product Causes the Inserting Interface's Validation Controls to Fire](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image37.png)</span></span>

<span data-ttu-id="5319d-263">**Figure 13**: la mise à jour d’un produit entraîne le déclenchement des contrôles de validation de l’interface d’insertion ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-263">**Figure 13**: Updating a Product Causes the Inserting Interface's Validation Controls to Fire ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image39.png))</span></span>

<span data-ttu-id="5319d-264">Les contrôles de validation dans ASP.NET 2,0 peuvent être partitionnés en groupes de validation par le biais de leur propriété `ValidationGroup`.</span><span class="sxs-lookup"><span data-stu-id="5319d-264">The validation controls in ASP.NET 2.0 can be partitioned into validation groups through their `ValidationGroup` property.</span></span> <span data-ttu-id="5319d-265">Pour associer un ensemble de contrôles de validation dans un groupe, affectez simplement à leur propriété `ValidationGroup` la même valeur.</span><span class="sxs-lookup"><span data-stu-id="5319d-265">To associate a set of validation controls in a group, simply set their `ValidationGroup` property to the same value.</span></span> <span data-ttu-id="5319d-266">Pour notre didacticiel, définissez les propriétés `ValidationGroup` des contrôles de validation dans le TemplateFields de GridView sur `EditValidationControls` et les propriétés `ValidationGroup` du TemplateFields du contrôle DetailsView à `InsertValidationControls`.</span><span class="sxs-lookup"><span data-stu-id="5319d-266">For our tutorial, set the `ValidationGroup` properties of the validation controls in the GridView's TemplateFields to `EditValidationControls` and the `ValidationGroup` properties of the DetailsView's TemplateFields to `InsertValidationControls`.</span></span> <span data-ttu-id="5319d-267">Ces modifications peuvent être effectuées directement dans le balisage déclaratif ou via le Fenêtre Propriétés lors de l’utilisation de l’interface de modification du modèle du concepteur.</span><span class="sxs-lookup"><span data-stu-id="5319d-267">These changes can be done directly in the declarative markup or through the Properties window when using the Designer's edit template interface.</span></span>

<span data-ttu-id="5319d-268">Outre les contrôles de validation, les contrôles liés aux boutons et aux boutons dans ASP.NET 2,0 incluent également une propriété `ValidationGroup`.</span><span class="sxs-lookup"><span data-stu-id="5319d-268">In addition to the validation controls, the Button and Button-related controls in ASP.NET 2.0 also include a `ValidationGroup` property.</span></span> <span data-ttu-id="5319d-269">La validité des validateurs d’un groupe de validation est vérifiée uniquement lorsqu’une publication (postback) est induite par un bouton qui a le même paramètre de propriété `ValidationGroup`.</span><span class="sxs-lookup"><span data-stu-id="5319d-269">A validation group's validators are checked for validity only when a postback is induced by a Button that has the same `ValidationGroup` property setting.</span></span> <span data-ttu-id="5319d-270">Par exemple, pour que le bouton d’insertion du contrôle DetailsView déclenche la `InsertValidationControls` groupe de validation, nous devons affecter à la propriété `ValidationGroup` de CommandField la valeur `InsertValidationControls` (voir figure 14).</span><span class="sxs-lookup"><span data-stu-id="5319d-270">For example, in order for the DetailsView's Insert button to trigger the `InsertValidationControls` validation group we need to set the CommandField's `ValidationGroup` property to `InsertValidationControls` (see Figure 14).</span></span> <span data-ttu-id="5319d-271">En outre, définissez la propriété CommandField’s `ValidationGroup` de GridView sur `EditValidationControls`.</span><span class="sxs-lookup"><span data-stu-id="5319d-271">Additionally, set the GridView's CommandField's `ValidationGroup` property to `EditValidationControls`.</span></span>

<span data-ttu-id="5319d-272">[![définir la propriété ValidationGroup CommandField’s du contrôle DetailsView sur InsertValidationControls](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="5319d-272">[![Set the DetailsView's CommandField's ValidationGroup property to InsertValidationControls](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image40.png)</span></span>

<span data-ttu-id="5319d-273">**Figure 14**: définir la propriété CommandField’s `ValidationGroup` du contrôle DetailsView sur `InsertValidationControls` ([cliquez pour afficher l’image en taille réelle](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="5319d-273">**Figure 14**: Set the DetailsView's CommandField's `ValidationGroup` property to `InsertValidationControls` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image42.png))</span></span>

<span data-ttu-id="5319d-274">Une fois ces modifications effectuées, les TemplateFields et CommandFields du contrôle DetailsView et GridView doivent ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="5319d-274">After these changes, the DetailsView and GridView's TemplateFields and CommandFields should look similar to the following:</span></span>

<span data-ttu-id="5319d-275">TemplateFields et CommandField du contrôle DetailsView</span><span class="sxs-lookup"><span data-stu-id="5319d-275">The DetailsView's TemplateFields and CommandField</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample4.aspx)]

<span data-ttu-id="5319d-276">CommandField et TemplateFields de GridView</span><span class="sxs-lookup"><span data-stu-id="5319d-276">The GridView's CommandField and TemplateFields</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample5.aspx)]

<span data-ttu-id="5319d-277">À ce stade, les contrôles de validation spécifiques à la modification se déclenchent uniquement quand l’utilisateur clique sur le bouton mettre à jour de GridView et que les contrôles de validation spécifiques à l’insertion se déclenchent uniquement quand l’utilisateur clique sur le bouton d’insertion du contrôle DetailsView, ce qui résout le problème mis en surbrillance à la figure 13.</span><span class="sxs-lookup"><span data-stu-id="5319d-277">At this point the edit-specific validation controls fire only when the GridView's Update button is clicked and the insert-specific validation controls fire only when the DetailsView's Insert button is clicked, resolving the problem highlighted by Figure 13.</span></span> <span data-ttu-id="5319d-278">Toutefois, avec cette modification, notre contrôle ValidationSummary ne s’affiche plus lors de l’entrée de données non valides.</span><span class="sxs-lookup"><span data-stu-id="5319d-278">However, with this change our ValidationSummary control no longer displays when entering invalid data.</span></span> <span data-ttu-id="5319d-279">Le contrôle ValidationSummary contient également une propriété `ValidationGroup` et affiche uniquement des informations récapitulatives pour ces contrôles de validation dans son groupe de validation.</span><span class="sxs-lookup"><span data-stu-id="5319d-279">The ValidationSummary control also contains a `ValidationGroup` property and only shows summary information for those validation controls in its validation group.</span></span> <span data-ttu-id="5319d-280">Par conséquent, nous devons disposer de deux contrôles de validation dans cette page, un pour le groupe de validation `InsertValidationControls` et un pour `EditValidationControls`.</span><span class="sxs-lookup"><span data-stu-id="5319d-280">Therefore, we need to have two validation controls in this page, one for the `InsertValidationControls` validation group and one for `EditValidationControls`.</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample6.aspx)]

<span data-ttu-id="5319d-281">Avec cet ajout, notre didacticiel est terminé.</span><span class="sxs-lookup"><span data-stu-id="5319d-281">With this addition our tutorial is complete!</span></span>

## <a name="summary"></a><span data-ttu-id="5319d-282">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="5319d-282">Summary</span></span>

<span data-ttu-id="5319d-283">Bien que BoundFields puisse fournir à la fois une interface d’insertion et de modification, l’interface n’est pas personnalisable.</span><span class="sxs-lookup"><span data-stu-id="5319d-283">While BoundFields can provide both an inserting and editing interface, the interface is not customizable.</span></span> <span data-ttu-id="5319d-284">En règle générale, nous souhaitons ajouter des contrôles de validation à l’interface de modification et d’insertion pour garantir que l’utilisateur entre les entrées requises dans un format légal.</span><span class="sxs-lookup"><span data-stu-id="5319d-284">Commonly, we want to add validation controls to the editing and inserting interface to ensure that the user enters required inputs in a legal format.</span></span> <span data-ttu-id="5319d-285">Pour ce faire, nous devons convertir le BoundFields en TemplateFields et ajouter les contrôles de validation au (x) modèle (s) approprié (s).</span><span class="sxs-lookup"><span data-stu-id="5319d-285">To accomplish this we must convert the BoundFields into TemplateFields and add the validation controls to the appropriate template(s).</span></span> <span data-ttu-id="5319d-286">Dans ce didacticiel, nous avons étendu l’exemple du didacticiel *examen des événements associés à l’insertion, à la mise à jour et à la suppression* , en ajoutant des contrôles de validation à l’interface d’insertion du contrôle DetailsView et à l’interface de modification du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="5319d-286">In this tutorial we extended the example from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial, adding validation controls to both the DetailsView's inserting interface and the GridView's editing interface.</span></span> <span data-ttu-id="5319d-287">En outre, nous avons vu comment afficher des informations de validation récapitulatives à l’aide du contrôle ValidationSummary et comment partitionner les contrôles de validation sur la page en groupes de validation distincts.</span><span class="sxs-lookup"><span data-stu-id="5319d-287">Moreover, we saw how to display summary validation information using the ValidationSummary control and how to partition the validation controls on the page into distinct validation groups.</span></span>

<span data-ttu-id="5319d-288">Comme nous l’avons vu dans ce didacticiel, les TemplateFields permettent de compléter les interfaces de modification et d’insertion pour inclure des contrôles de validation.</span><span class="sxs-lookup"><span data-stu-id="5319d-288">As we saw in this tutorial, TemplateFields allow the editing and inserting interfaces to be augmented to include validation controls.</span></span> <span data-ttu-id="5319d-289">TemplateFields peut également être étendu pour inclure des contrôles Web d’entrée supplémentaires, ce qui permet de remplacer la zone de texte par un contrôle Web plus approprié.</span><span class="sxs-lookup"><span data-stu-id="5319d-289">TemplateFields can also be extended to include additional input Web controls, enabling the TextBox to be replaced by a more suitable Web control.</span></span> <span data-ttu-id="5319d-290">Dans notre prochain didacticiel, nous verrons comment remplacer le contrôle TextBox par un contrôle DropDownList lié aux données, ce qui est idéal lors de la modification d’une clé étrangère (par exemple `CategoryID` ou `SupplierID` dans la table `Products`).</span><span class="sxs-lookup"><span data-stu-id="5319d-290">In our next tutorial we'll see how to replace the TextBox control with a data-bound DropDownList control, which is ideal when editing a foreign key (such as `CategoryID` or `SupplierID` in the `Products` table).</span></span>

<span data-ttu-id="5319d-291">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="5319d-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5319d-292">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="5319d-292">About the Author</span></span>

<span data-ttu-id="5319d-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="5319d-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5319d-294">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="5319d-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5319d-295">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5319d-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5319d-296">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5319d-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5319d-297">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5319d-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5319d-298">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="5319d-298">Special Thanks To</span></span>

<span data-ttu-id="5319d-299">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="5319d-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5319d-300">Les réviseurs de leads pour ce didacticiel étaient Liz Shulok et Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="5319d-300">Lead reviewers for this tutorial were Liz Shulok and Zack Jones.</span></span> <span data-ttu-id="5319d-301">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="5319d-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5319d-302">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5319d-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5319d-303">[Précédent](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)
> [Suivant](customizing-the-data-modification-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5319d-303">[Previous](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)
[Next](customizing-the-data-modification-interface-vb.md)</span></span>
