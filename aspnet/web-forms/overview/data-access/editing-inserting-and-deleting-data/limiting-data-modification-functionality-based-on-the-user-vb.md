---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
title: Limitation des fonctionnalités de modification des données en fonction de l’utilisateur (VB) | Microsoft Docs
author: rick-anderson
description: Dans une application Web qui permet aux utilisateurs de modifier des données, différents comptes d’utilisateur peuvent avoir des privilèges d’édition de données différents. Dans ce didacticiel, nous allons examiner la manière dont t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 9dc264a6-feb8-474b-8b91-008c50708065
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
msc.type: authoredcontent
ms.openlocfilehash: c257a930e4d27fcd42591a541e700786bf413bf0
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74626882"
---
# <a name="limiting-data-modification-functionality-based-on-the-user-vb"></a><span data-ttu-id="d5afc-104">Limitation des fonctionnalités de modification des données en fonction de l’utilisateur (VB)</span><span class="sxs-lookup"><span data-stu-id="d5afc-104">Limiting Data Modification Functionality Based on the User (VB)</span></span>

<span data-ttu-id="d5afc-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d5afc-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d5afc-106">[Télécharger l’exemple d’application](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) ou [Télécharger le PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d5afc-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span></span>

> <span data-ttu-id="d5afc-107">Dans une application Web qui permet aux utilisateurs de modifier des données, différents comptes d’utilisateur peuvent avoir des privilèges d’édition de données différents.</span><span class="sxs-lookup"><span data-stu-id="d5afc-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="d5afc-108">Dans ce didacticiel, nous allons examiner comment ajuster dynamiquement les fonctionnalités de modification des données en fonction de l’utilisateur visité.</span><span class="sxs-lookup"><span data-stu-id="d5afc-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>

## <a name="introduction"></a><span data-ttu-id="d5afc-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="d5afc-109">Introduction</span></span>

<span data-ttu-id="d5afc-110">Plusieurs applications Web prennent en charge les comptes d’utilisateur et fournissent différentes options, rapports et fonctionnalités en fonction de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="d5afc-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="d5afc-111">Par exemple, avec nos didacticiels, nous pouvons autoriser les utilisateurs des sociétés fournisseurs à se connecter au site et à mettre à jour des informations générales sur leurs produits (leur nom et leur quantité par unité), ainsi que des informations sur le fournisseur, telles que le nom de la société. adresse, informations sur la personne à contacter, etc.</span><span class="sxs-lookup"><span data-stu-id="d5afc-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="d5afc-112">En outre, nous pouvons souhaiter inclure des comptes d’utilisateur pour les personnes de notre société afin qu’ils puissent se connecter et mettre à jour les informations sur les produits, comme les unités en stock, le niveau de réorganisation, etc.</span><span class="sxs-lookup"><span data-stu-id="d5afc-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="d5afc-113">Notre application Web peut également autoriser les utilisateurs anonymes à visiter (les personnes qui n’ont pas ouvert de session), mais les limiterait à afficher simplement les données.</span><span class="sxs-lookup"><span data-stu-id="d5afc-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="d5afc-114">Avec un tel système de compte d’utilisateur en place, nous souhaitons que les contrôles Web de données de nos pages ASP.NET offrent les fonctionnalités d’insertion, de modification et de suppression appropriées pour l’utilisateur actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="d5afc-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="d5afc-115">Dans ce didacticiel, nous allons examiner comment ajuster dynamiquement les fonctionnalités de modification des données en fonction de l’utilisateur visité.</span><span class="sxs-lookup"><span data-stu-id="d5afc-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="d5afc-116">En particulier, nous allons créer une page qui affiche les informations sur les fournisseurs dans un DetailsView modifiable avec un GridView qui répertorie les produits fournis par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="d5afc-117">Si l’utilisateur visitant la page provient de notre entreprise, il peut : afficher les informations sur les fournisseurs. modifier leur adresse ; et de modifier les informations pour tous les produits fournis par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="d5afc-118">Toutefois, si l’utilisateur provient d’une société particulière, il peut uniquement afficher et modifier ses propres informations d’adresse et ne peut modifier que les produits qui n’ont pas été marqués comme abandonnés.</span><span class="sxs-lookup"><span data-stu-id="d5afc-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>

<span data-ttu-id="d5afc-119">[![un utilisateur de notre société peut modifier les informations sur les fournisseurs](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span></span>

<span data-ttu-id="d5afc-120">**Figure 1**: un utilisateur de notre société peut modifier les informations sur les fournisseurs ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span></span>

<span data-ttu-id="d5afc-121">[![un utilisateur d’un fournisseur particulier peut uniquement afficher et modifier ses informations](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span></span>

<span data-ttu-id="d5afc-122">**Figure 2**: un utilisateur d’un fournisseur particulier peut uniquement afficher et modifier ses informations ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span></span>

<span data-ttu-id="d5afc-123">Commençons !</span><span class="sxs-lookup"><span data-stu-id="d5afc-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="d5afc-124">Le système d’appartenance ASP.NET 2,0 s fournit une plateforme standardisée et extensible pour la création, la gestion et la validation des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="d5afc-125">Étant donné qu’un examen du système d’appartenance n’entre pas dans le cadre de ces didacticiels, il est préférable de « simuler » l’appartenance à des visiteurs anonymes pour choisir s’ils proviennent d’un fournisseur particulier ou de notre entreprise.</span><span class="sxs-lookup"><span data-stu-id="d5afc-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="d5afc-126">Pour plus d’informations sur l’adhésion, reportez-vous à la série d’articles examen de l' [appartenance, des rôles et des profils de ASP.NET 2,0 s](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) .</span><span class="sxs-lookup"><span data-stu-id="d5afc-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>

## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="d5afc-127">Étape 1 : permettre à l’utilisateur de spécifier ses droits d’accès</span><span class="sxs-lookup"><span data-stu-id="d5afc-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="d5afc-128">Dans une application Web réelle, les informations sur le compte des utilisateurs incluent la nécessité de travailler pour notre société ou pour un fournisseur particulier, et ces informations sont accessibles par programmation à partir de nos pages de ASP.NET une fois que l’utilisateur s’est connecté au site.</span><span class="sxs-lookup"><span data-stu-id="d5afc-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="d5afc-129">Ces informations peuvent être capturées via le système de rôles ASP.NET 2,0 s, en tant qu’informations de compte au niveau de l’utilisateur via le système de profil ou via des moyens personnalisés.</span><span class="sxs-lookup"><span data-stu-id="d5afc-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="d5afc-130">Étant donné que l’objectif de ce didacticiel est de montrer comment ajuster les fonctionnalités de modification des données en fonction de l’utilisateur connecté et qu’il n’est pas destiné à présenter l’appartenance, les rôles et les systèmes de profil ASP.NET 2,0 s, nous allons utiliser un mécanisme très simple pour déterminer le fonctionnalités de l’utilisateur visitant la page : contrôle DropDownList à partir duquel l’utilisateur peut indiquer s’il doit être en mesure d’afficher et de modifier les informations sur les fournisseurs ou, le cas échéant, les informations spécifiques du fournisseur qu’ils peuvent afficher et modifier.</span><span class="sxs-lookup"><span data-stu-id="d5afc-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="d5afc-131">Si l’utilisateur indique qu’il peut afficher et modifier toutes les informations sur le fournisseur (valeur par défaut), il peut parcourir tous les fournisseurs, modifier les informations sur l’adresse du fournisseur et modifier le nom et la quantité par unité pour tout produit fourni par le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="d5afc-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="d5afc-132">Si l’utilisateur indique qu’il peut uniquement afficher et modifier un fournisseur particulier, il peut uniquement afficher les détails et les produits pour ce fournisseur et ne peut mettre à jour que les informations de nom et de quantité par unité pour les produits qui *ne sont pas* interrompus.</span><span class="sxs-lookup"><span data-stu-id="d5afc-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="d5afc-133">Dans le cadre de ce didacticiel, la première étape consiste à créer ce DropDownList et à le remplir avec les fournisseurs dans le système.</span><span class="sxs-lookup"><span data-stu-id="d5afc-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="d5afc-134">Ouvrez la page `UserLevelAccess.aspx` dans le dossier `EditInsertDelete`, ajoutez un contrôle DropDownList dont la propriété `ID` est définie sur `Suppliers`et liez ce DropDownList à un nouvel ObjectDataSource nommé `AllSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>

<span data-ttu-id="d5afc-135">[![créer un ObjectDataSource nommé AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span></span>

<span data-ttu-id="d5afc-136">**Figure 3**: créer un ObjectDataSource nommé `AllSuppliersDataSource` ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span></span>

<span data-ttu-id="d5afc-137">Comme nous voulons que ce DropDownList comprenne tous les fournisseurs, configurez le ObjectDataSource pour appeler la méthode de `GetSuppliers()` de la classe `SuppliersBLL`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="d5afc-138">Assurez-vous également que la méthode d' `Update()` ObjectDataSource est mappée à la méthode de `SuppliersBLL` classe s `UpdateSupplierAddress`, car cet ObjectDataSource sera également utilisé par le contrôle DetailsView que nous ajouterons à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="d5afc-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="d5afc-139">Après avoir terminé l’Assistant ObjectDataSource, effectuez les étapes en configurant le `Suppliers` DropDownList de telle sorte qu’il affiche le champ de données `CompanyName` et utilise le champ de données `SupplierID` comme valeur pour chaque `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>

<span data-ttu-id="d5afc-140">[![configurer la DropDownList des fournisseurs pour utiliser les champs de données CompanyName et RéfFournisseur](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span></span>

<span data-ttu-id="d5afc-141">**Figure 4**: configurer la `Suppliers` DropDownList pour utiliser les champs de données `CompanyName` et `SupplierID` ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span></span>

<span data-ttu-id="d5afc-142">À ce stade, le DropDownList répertorie les noms de société des fournisseurs dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="d5afc-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="d5afc-143">Toutefois, nous devons également inclure l’option « Afficher/modifier tous les fournisseurs » sur le DropDownList.</span><span class="sxs-lookup"><span data-stu-id="d5afc-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="d5afc-144">Pour ce faire, affectez à la propriété `Suppliers` DropDownList s `AppendDataBoundItems` la valeur `true` puis ajoutez une `ListItem` dont la propriété `Text` est « afficher/modifier tous les fournisseurs » et dont la valeur est `-1`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="d5afc-145">Cela peut être ajouté directement par le biais du balisage déclaratif ou via le concepteur en accédant au Fenêtre Propriétés et en cliquant sur les ellipses dans la propriété DropDownList s `Items`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="d5afc-146">Reportez-vous au didacticiel [*maître/détail avec un didacticiel DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) pour une discussion plus détaillée sur l’ajout d’un élément Sélectionner tout à un contrôle DropDownList lié aux données.</span><span class="sxs-lookup"><span data-stu-id="d5afc-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>

<span data-ttu-id="d5afc-147">Une fois la propriété `AppendDataBoundItems` définie et le `ListItem` ajouté, le balisage déclaratif s doit ressembler à ceci :</span><span class="sxs-lookup"><span data-stu-id="d5afc-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample1.aspx)]

<span data-ttu-id="d5afc-148">La figure 5 illustre une capture d’écran de la progression actuelle, affichée dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>

<span data-ttu-id="d5afc-149">[![la DropDownList des fournisseurs contient un ListItem afficher tout, plus un pour chaque fournisseur](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span></span>

<span data-ttu-id="d5afc-150">**Figure 5**: le DropDownList `Suppliers` contient un `ListItem`afficher tout, plus un pour chaque fournisseur ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span></span>

<span data-ttu-id="d5afc-151">Étant donné que nous voulons mettre à jour l’interface utilisateur immédiatement après que l’utilisateur a modifié sa sélection, définissez la propriété `Suppliers` DropDownList s `AutoPostBack` sur `true`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="d5afc-152">À l’étape 2, nous allons créer un contrôle DetailsView qui affichera les informations du ou des fournisseurs en fonction de la sélection DropDownList.</span><span class="sxs-lookup"><span data-stu-id="d5afc-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="d5afc-153">Ensuite, à l’étape 3, nous allons créer un gestionnaire d’événements pour cet événement `SelectedIndexChanged` DropDownList, dans lequel nous ajouterons du code qui lie les informations de fournisseur appropriées au DetailsView en fonction du fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="d5afc-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="d5afc-154">Étape 2 : ajout d’un contrôle DetailsView</span><span class="sxs-lookup"><span data-stu-id="d5afc-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="d5afc-155">Nous utilisons un DetailsView pour afficher les informations sur les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="d5afc-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="d5afc-156">Pour l’utilisateur qui peut afficher et modifier tous les fournisseurs, le contrôle DetailsView prend en charge la pagination, ce qui permet à l’utilisateur de parcourir les informations de fournisseur d’un enregistrement à la fois.</span><span class="sxs-lookup"><span data-stu-id="d5afc-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="d5afc-157">Toutefois, si l’utilisateur travaille pour un fournisseur particulier, le contrôle DetailsView affiche uniquement les informations spécifiques de ce fournisseur et n’inclut pas d’interface de pagination.</span><span class="sxs-lookup"><span data-stu-id="d5afc-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="d5afc-158">Dans les deux cas, le contrôle DetailsView doit autoriser l’utilisateur à modifier les champs adresse, ville et pays du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="d5afc-159">Ajoutez un DetailsView à la page sous la `Suppliers` DropDownList, affectez à sa propriété `ID` la valeur `SupplierDetails`et liez-le à la `AllSuppliersDataSource` ObjectDataSource créée à l’étape précédente.</span><span class="sxs-lookup"><span data-stu-id="d5afc-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="d5afc-160">Cochez ensuite les cases activer la pagination et activer la modification à partir de la balise active DetailsView s.</span><span class="sxs-lookup"><span data-stu-id="d5afc-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="d5afc-161">Si vous ne voyez pas l’option Activer la modification dans la balise active de DetailsView s, elle est introuvable, car vous n’avez pas mappé la méthode ObjectDataSource s `Update()` à la méthode de la classe `SuppliersBLL` s `UpdateSupplierAddress`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="d5afc-162">Prenez un moment pour revenir en arrière et apporter cette modification de configuration, après quoi l’option Activer la modification doit apparaître dans la balise active de DetailsView s.</span><span class="sxs-lookup"><span data-stu-id="d5afc-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>

<span data-ttu-id="d5afc-163">Étant donné que la méthode `SuppliersBLL` classe s `UpdateSupplierAddress` accepte uniquement quatre paramètres : `supplierID`, `address`, `city`et `country`-modifier le BoundFields DetailsView s afin que les BoundFields `CompanyName` et `Phone` soient en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="d5afc-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="d5afc-164">En outre, supprimez complètement le `SupplierID` BoundField.</span><span class="sxs-lookup"><span data-stu-id="d5afc-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="d5afc-165">Enfin, la propriété `OldValuesParameterFormatString` de la `AllSuppliersDataSource` ObjectDataSource est actuellement définie sur `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="d5afc-166">Prenez un moment pour supprimer complètement ce paramètre de propriété de la syntaxe déclarative ou affectez-lui la valeur par défaut `{0}`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="d5afc-167">Après avoir configuré les `SupplierDetails` DetailsView et `AllSuppliersDataSource` ObjectDataSource, nous aurons le balisage déclaratif suivant :</span><span class="sxs-lookup"><span data-stu-id="d5afc-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample2.aspx)]

<span data-ttu-id="d5afc-168">À ce stade, le contrôle DetailsView peut être paginé et les informations sur l’adresse du fournisseur sélectionné peuvent être mises à jour, quelle que soit la sélection effectuée dans la `Suppliers` DropDownList (voir figure 6).</span><span class="sxs-lookup"><span data-stu-id="d5afc-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>

<span data-ttu-id="d5afc-169">[![les informations sur les fournisseurs peuvent être affichées et l’adresse mise à jour](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span></span>

<span data-ttu-id="d5afc-170">**Figure 6**: les informations de tous les fournisseurs peuvent être affichées et l’adresse mise à jour ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span></span>

## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="d5afc-171">Étape 3 : afficher uniquement les informations sur le fournisseur sélectionné</span><span class="sxs-lookup"><span data-stu-id="d5afc-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="d5afc-172">Notre page affiche actuellement les informations pour tous les fournisseurs, qu’un fournisseur particulier ait été sélectionné à partir de la `Suppliers` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="d5afc-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="d5afc-173">Pour afficher uniquement les informations du fournisseur sélectionné, nous devons ajouter un autre ObjectDataSource à notre page, qui récupère des informations sur un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="d5afc-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="d5afc-174">Ajoutez un nouvel ObjectDataSource à la page, en lui attribuant un nom `SingleSupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="d5afc-175">À partir de sa balise active, cliquez sur le lien configurer la source de données et faites en sorte qu’il utilise la méthode `SuppliersBLL` classe s `GetSupplierBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="d5afc-176">Comme pour le `AllSuppliersDataSource` ObjectDataSource, la méthode `SingleSupplierDataSource` ObjectDataSource s `Update()` mappée à la méthode `UpdateSupplierAddress` de la classe `SuppliersBLL` s.</span><span class="sxs-lookup"><span data-stu-id="d5afc-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>

<span data-ttu-id="d5afc-177">[![configurer le ObjectDataSource SingleSupplierDataSource pour utiliser la méthode GetSupplierBySupplierID (RéfFournisseur)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span></span>

<span data-ttu-id="d5afc-178">**Figure 7**: configurer le `SingleSupplierDataSource` ObjectDataSource pour utiliser la méthode `GetSupplierBySupplierID(supplierID)` ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span></span>

<span data-ttu-id="d5afc-179">Ensuite, nous avons invité à spécifier la source du paramètre de la méthode `GetSupplierBySupplierID(supplierID)` `supplierID` paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="d5afc-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="d5afc-180">Dans la mesure où nous souhaitons afficher les informations du fournisseur sélectionné à partir de la DropDownList, utilisez la propriété `Suppliers` DropDownList s `SelectedValue` comme source du paramètre.</span><span class="sxs-lookup"><span data-stu-id="d5afc-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="d5afc-181">[![utiliser la DropDownList Suppliers comme source de paramètres RéfFournisseur](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span></span>

<span data-ttu-id="d5afc-182">**Figure 8**: utiliser la `Suppliers` DropDownList comme source de paramètre `supplierID` ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span></span>

<span data-ttu-id="d5afc-183">Même avec ce second ObjectDataSource ajouté, le contrôle DetailsView est actuellement configuré pour toujours utiliser le `AllSuppliersDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d5afc-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="d5afc-184">Nous devons ajouter une logique pour ajuster la source de données utilisée par le DetailsView en fonction de l’élément `Suppliers` DropDownList sélectionné.</span><span class="sxs-lookup"><span data-stu-id="d5afc-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="d5afc-185">Pour ce faire, créez un gestionnaire d’événements `SelectedIndexChanged` pour la DropDownList des fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="d5afc-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="d5afc-186">Vous pouvez le créer le plus facilement en double-cliquant sur le DropDownList dans le concepteur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="d5afc-187">Ce gestionnaire d’événements doit déterminer la source de données à utiliser et doit relier les données au contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="d5afc-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="d5afc-188">Pour ce faire, vous devez utiliser le code suivant :</span><span class="sxs-lookup"><span data-stu-id="d5afc-188">This is accomplished with the following code:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample3.vb)]

<span data-ttu-id="d5afc-189">Le gestionnaire d’événements commence par déterminer si l’option « Afficher/modifier tous les fournisseurs » a été sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="d5afc-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="d5afc-190">Si tel était le cas, il définit le `SupplierDetails` DetailsView s `DataSourceID` sur `AllSuppliersDataSource` et retourne l’utilisateur au premier enregistrement de l’ensemble de fournisseurs en affectant à la propriété `PageIndex` la valeur 0.</span><span class="sxs-lookup"><span data-stu-id="d5afc-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="d5afc-191">Toutefois, si l’utilisateur a sélectionné un fournisseur particulier dans le DropDownList, le `DataSourceID` DetailsView est assigné à `SingleSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="d5afc-192">Quelle que soit la source de données utilisée, le mode de `SuppliersDetails` est rétabli en mode lecture seule et les données sont reliées au DetailsView par un appel à la méthode `DataBind()` du contrôle `SuppliersDetails`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="d5afc-193">Lorsque ce gestionnaire d’événements est en place, le contrôle DetailsView affiche maintenant le fournisseur sélectionné, sauf si l’option « Afficher/modifier tous les fournisseurs » a été sélectionnée. dans ce cas, tous les fournisseurs peuvent être consultés via l’interface de pagination.</span><span class="sxs-lookup"><span data-stu-id="d5afc-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="d5afc-194">La figure 9 illustre la page avec l’option « Afficher/modifier tous les fournisseurs » sélectionnée ; Notez que l’interface de pagination est présente, ce qui permet à l’utilisateur de consulter et de mettre à jour n’importe quel fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="d5afc-195">La figure 10 illustre la page avec le fournisseur de maison ma.</span><span class="sxs-lookup"><span data-stu-id="d5afc-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="d5afc-196">Seules les informations de ma maison sont visibles et modifiables dans ce cas.</span><span class="sxs-lookup"><span data-stu-id="d5afc-196">Only Ma Maison s information is viewable and editable in this case.</span></span>

<span data-ttu-id="d5afc-197">[![toutes les informations relatives aux fournisseurs peuvent être affichées et modifiées](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span></span>

<span data-ttu-id="d5afc-198">**Figure 9**: toutes les informations relatives aux fournisseurs peuvent être affichées et modifiées ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span></span>

<span data-ttu-id="d5afc-199">[![seules les informations sur les fournisseurs sélectionnés peuvent être affichées et modifiées](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span></span>

<span data-ttu-id="d5afc-200">**Figure 10**: seules les informations sur le fournisseur sélectionné peuvent être affichées et modifiées ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d5afc-201">Pour ce didacticiel, les `EnableViewState` contrôle DropDownList et DetailsView doivent avoir la valeur `true` (valeur par défaut), car les modifications des objets DropDownList `SelectedIndex` et des propriétés du contrôle DetailsView `DataSourceID` s doivent être mémorisées sur les publications.</span><span class="sxs-lookup"><span data-stu-id="d5afc-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>

## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="d5afc-202">Étape 4 : affichage des produits des fournisseurs dans un contrôle GridView modifiable</span><span class="sxs-lookup"><span data-stu-id="d5afc-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="d5afc-203">Le contrôle DetailsView étant terminé, l’étape suivante consiste à inclure un GridView modifiable qui répertorie les produits fournis par le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="d5afc-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="d5afc-204">Ce GridView doit autoriser uniquement les modifications apportées aux champs `ProductName` et `QuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="d5afc-205">En outre, si l’utilisateur visitant la page provient d’un fournisseur particulier, il ne doit autoriser que les mises à jour des produits qui ne sont *pas* interrompus.</span><span class="sxs-lookup"><span data-stu-id="d5afc-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="d5afc-206">Pour ce faire, nous devons d’abord ajouter une surcharge de la méthode `ProductsBLL` Class s `UpdateProducts` qui accepte uniquement les champs `ProductID`, `ProductName`et `QuantityPerUnit` comme entrées.</span><span class="sxs-lookup"><span data-stu-id="d5afc-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="d5afc-207">Nous avons parcouru ce processus au préalable dans de nombreux didacticiels. nous allons donc juste examiner le code, qui doit être ajouté à `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="d5afc-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample4.vb)]

<span data-ttu-id="d5afc-208">Une fois cette surcharge créée, nous sommes prêts à ajouter le contrôle GridView et son ObjectDataSource associé.</span><span class="sxs-lookup"><span data-stu-id="d5afc-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="d5afc-209">Ajoutez un nouveau contrôle GridView à la page, affectez à sa propriété `ID` la valeur `ProductsBySupplier`et configurez-le pour qu’il utilise un nouvel ObjectDataSource nommé `ProductsBySupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="d5afc-210">Comme nous voulons que ce GridView répertorie ces produits par le fournisseur sélectionné, utilisez la méthode `ProductsBLL` classe s `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="d5afc-211">Mappez également la méthode `Update()` à la nouvelle surcharge `UpdateProduct` que nous venons de créer.</span><span class="sxs-lookup"><span data-stu-id="d5afc-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>

<span data-ttu-id="d5afc-212">[![configurer ObjectDataSource pour utiliser la surcharge UpdateProduct que vous venez de créer](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span></span>

<span data-ttu-id="d5afc-213">**Figure 11**: configurer ObjectDataSource pour utiliser la surcharge de `UpdateProduct` que vous venez de créer ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span></span>

<span data-ttu-id="d5afc-214">Nous avons demandé à sélectionner la source de paramètre de la méthode `GetProductsBySupplierID(supplierID)` `supplierID` paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="d5afc-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="d5afc-215">Étant donné que nous souhaitons afficher les produits pour le fournisseur sélectionné dans le contrôle DetailsView, utilisez la propriété `SuppliersDetails` DetailsView Control s `SelectedValue` comme source du paramètre.</span><span class="sxs-lookup"><span data-stu-id="d5afc-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="d5afc-216">[![utiliser la propriété SelectedValue SuppliersDetails DetailsView s comme source de paramètre](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span></span>

<span data-ttu-id="d5afc-217">**Figure 12**: utiliser la propriété `SuppliersDetails` DetailsView s `SelectedValue` en tant que source de paramètre ([Cliquer pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span></span>

<span data-ttu-id="d5afc-218">En retournant dans le GridView, supprimez tous les champs GridView à l’exception de `ProductName`, `QuantityPerUnit`et `Discontinued`, en marquant le `Discontinued` CheckBoxField en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="d5afc-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="d5afc-219">Cochez également l’option Activer la modification de la balise active GridView s.</span><span class="sxs-lookup"><span data-stu-id="d5afc-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="d5afc-220">Une fois ces modifications effectuées, le balisage déclaratif pour les contrôles GridView et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="d5afc-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample5.aspx)]

<span data-ttu-id="d5afc-221">Comme avec notre ObjectDataSources précédent, la propriété `OldValuesParameterFormatString` est définie sur `original_{0}`, ce qui entraîne des problèmes lors de la tentative de mise à jour d’un nom de produit ou d’une quantité par unité.</span><span class="sxs-lookup"><span data-stu-id="d5afc-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="d5afc-222">Supprimez cette propriété de la syntaxe déclarative ou affectez-lui la valeur par défaut, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="d5afc-223">Une fois cette configuration terminée, notre page répertorie maintenant les produits fournis par le fournisseur sélectionné dans le contrôle GridView (voir figure 13).</span><span class="sxs-lookup"><span data-stu-id="d5afc-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="d5afc-224">Actuellement, vous pouvez mettre à jour *n’importe quel* nom ou quantité de produit par unité.</span><span class="sxs-lookup"><span data-stu-id="d5afc-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="d5afc-225">Toutefois, nous devons mettre à jour la logique de la page pour que cette fonctionnalité soit interdite pour les produits abandonnés pour les utilisateurs associés à un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="d5afc-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="d5afc-226">Nous allons aborder ce dernier élément à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="d5afc-226">We'll tackle this final piece in Step 5.</span></span>

<span data-ttu-id="d5afc-227">[![les produits fournis par le fournisseur sélectionné s’affichent.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span></span>

<span data-ttu-id="d5afc-228">**Figure 13**: affichage des produits fournis par le fournisseur sélectionné ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d5afc-229">Avec l’ajout de ce GridView modifiable, le gestionnaire d’événements `Suppliers` DropDownList s `SelectedIndexChanged` doit être mis à jour pour ramener le contrôle GridView à un État en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="d5afc-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="d5afc-230">Dans le cas contraire, si un autre fournisseur est sélectionné au milieu de la modification des informations sur le produit, l’index correspondant dans le GridView pour le nouveau fournisseur sera également modifiable.</span><span class="sxs-lookup"><span data-stu-id="d5afc-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="d5afc-231">Pour éviter cela, il vous suffit de définir la propriété GridView s `EditIndex` sur `-1` dans le gestionnaire d’événements `SelectedIndexChanged`.</span><span class="sxs-lookup"><span data-stu-id="d5afc-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>

<span data-ttu-id="d5afc-232">Rappelez-vous également qu’il est important que l’état d’affichage de GridView s soit activé (comportement par défaut).</span><span class="sxs-lookup"><span data-stu-id="d5afc-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="d5afc-233">Si vous affectez à la propriété GridView s `EnableViewState` la valeur `false`, vous risquez d’avoir des utilisateurs simultanés qui suppriment ou modifient des enregistrements de manière involontaire.</span><span class="sxs-lookup"><span data-stu-id="d5afc-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="d5afc-234">Consultez [Avertissement : problème d’accès concurrentiel avec ASP.NET 2,0 GridViews/DetailsView/FormViews qui prennent en charge l’édition et/ou la suppression et dont l’état d’affichage est désactivé](http://scottonwriting.net/sowblog/posts/10054.aspx) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="d5afc-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="d5afc-235">Étape 5 : interdire la modification des produits abandonnés lorsque l’option Afficher/modifier tous les fournisseurs n’est pas sélectionnée</span><span class="sxs-lookup"><span data-stu-id="d5afc-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="d5afc-236">Tandis que le `ProductsBySupplier` GridView est entièrement fonctionnel, il accorde actuellement un trop grand accès aux utilisateurs d’un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="d5afc-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="d5afc-237">Conformément aux règles de votre entreprise, ces utilisateurs ne doivent pas être en mesure de mettre à jour les produits abandonnés.</span><span class="sxs-lookup"><span data-stu-id="d5afc-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="d5afc-238">Pour l’appliquer, nous pouvons masquer (ou désactiver) le bouton modifier dans les lignes GridView avec les produits abandonnés lorsque la page est visitée par un utilisateur d’un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="d5afc-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="d5afc-239">Créez un gestionnaire d’événements pour l’événement `RowDataBound` GridView s.</span><span class="sxs-lookup"><span data-stu-id="d5afc-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="d5afc-240">Dans ce gestionnaire d’événements, nous devons déterminer si l’utilisateur est associé à un fournisseur particulier, ce qui, pour ce didacticiel, peut être déterminé en vérifiant la propriété de la `SelectedValue` DropDownList des fournisseurs, s’il s’agit d’une autre valeur que-1, l’utilisateur est associé à un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="d5afc-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="d5afc-241">Pour ces utilisateurs, nous devons ensuite déterminer si le produit n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="d5afc-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="d5afc-242">Nous pouvons extraire une référence à l’instance réelle de `ProductRow` liée à la ligne GridView via la propriété `e.Row.DataItem`, comme indiqué dans le didacticiel [*affichage des informations de synthèse dans le pied de page de GridView s*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="d5afc-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial.</span></span> <span data-ttu-id="d5afc-243">Si le produit n’est plus disponible, nous pouvons saisir une référence par programmation au bouton modifier dans le contrôle de GridView s CommandField à l’aide des techniques présentées dans le didacticiel précédent, en [*ajoutant une confirmation côté client lors*](adding-client-side-confirmation-when-deleting-vb.md)de la suppression.</span><span class="sxs-lookup"><span data-stu-id="d5afc-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-vb.md).</span></span> <span data-ttu-id="d5afc-244">Une fois que nous avons une référence, nous pouvons masquer ou désactiver le bouton.</span><span class="sxs-lookup"><span data-stu-id="d5afc-244">Once we have a reference we can then hide or disable the button.</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample6.vb)]

<span data-ttu-id="d5afc-245">Lorsque ce gestionnaire d’événements est en place, lorsque vous visitez cette page en tant qu’utilisateur d’un fournisseur spécifique, les produits qui ne sont plus disponibles ne sont pas modifiables, car le bouton modifier est masqué pour ces produits.</span><span class="sxs-lookup"><span data-stu-id="d5afc-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="d5afc-246">Par exemple, chef Anton s Gumbo Mix est un produit abandonné pour le fournisseur de désoleils de Cajun-Orléans.</span><span class="sxs-lookup"><span data-stu-id="d5afc-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="d5afc-247">Lorsque vous accédez à la page de ce fournisseur spécifique, le bouton modifier de ce produit est masqué (voir figure 14).</span><span class="sxs-lookup"><span data-stu-id="d5afc-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="d5afc-248">Toutefois, lorsque vous vous rendez à l’aide du bouton « afficher/modifier tous les fournisseurs », le bouton modifier est disponible (voir figure 15).</span><span class="sxs-lookup"><span data-stu-id="d5afc-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>

<span data-ttu-id="d5afc-249">[![pour les utilisateurs spécifiques à un fournisseur le bouton modifier pour chef Anton s Gumbo Mix est masqué](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span></span>

<span data-ttu-id="d5afc-250">**Figure 14**: pour les utilisateurs spécifiques au fournisseur, le bouton modifier pour le chef de la combinaison du chef de Gumbo s est masqué ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span></span>

<span data-ttu-id="d5afc-251">[![pour afficher/modifier tous les utilisateurs de fournisseurs, le bouton modifier pour chef Anton s Gumbo Mix est affiché](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="d5afc-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span></span>

<span data-ttu-id="d5afc-252">**Figure 15**: pour afficher/modifier tous les utilisateurs de fournisseurs, le bouton modifier pour chef Anton s Gumbo Mix s’affiche ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="d5afc-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span></span>

## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="d5afc-253">Vérification des droits d’accès dans la couche de logique métier</span><span class="sxs-lookup"><span data-stu-id="d5afc-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="d5afc-254">Dans ce didacticiel, la page ASP.NET gère toute la logique en ce qui concerne les informations que l’utilisateur peut voir et les produits qu’il peut mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="d5afc-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="d5afc-255">Dans l’idéal, cette logique serait également présente dans la couche de logique métier.</span><span class="sxs-lookup"><span data-stu-id="d5afc-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="d5afc-256">Par exemple, la méthode `SuppliersBLL` classe s `GetSuppliers()` (qui retourne tous les fournisseurs) peut inclure une vérification pour s’assurer que l’utilisateur actuellement connecté n’est *pas* associé à un fournisseur spécifique.</span><span class="sxs-lookup"><span data-stu-id="d5afc-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="d5afc-257">De même, la méthode `UpdateSupplierAddress` peut inclure une vérification pour s’assurer que l’utilisateur actuellement connecté a travaillé pour notre société (et par conséquent peut mettre à jour toutes les informations d’adresse des fournisseurs) ou est associé au fournisseur dont les données sont mises à jour.</span><span class="sxs-lookup"><span data-stu-id="d5afc-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="d5afc-258">Je n’ai pas inclus de telles vérifications de couche BLL ici, car dans notre didacticiel, les droits des utilisateurs sont déterminés par un contrôle DropDownList sur la page, auquel les classes BLL ne peuvent pas accéder.</span><span class="sxs-lookup"><span data-stu-id="d5afc-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="d5afc-259">Lors de l’utilisation du système d’appartenance ou de l’un des schémas d’authentification prêts à l’emploi fournis par ASP.NET (par exemple, l’authentification Windows), les informations sur les utilisateurs et les rôles de l’utilisateur actuellement connecté sont accessibles à partir de la couche BLL, ce qui rend ce type d’accès contrôles de droits possibles aux couches présentation et couche BLL.</span><span class="sxs-lookup"><span data-stu-id="d5afc-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="d5afc-260">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="d5afc-260">Summary</span></span>

<span data-ttu-id="d5afc-261">La plupart des sites qui fournissent des comptes d’utilisateur doivent personnaliser l’interface de modification des données en fonction de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="d5afc-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="d5afc-262">Les utilisateurs administratifs peuvent être en mesure de supprimer et de modifier n’importe quel enregistrement, tandis que les utilisateurs non administratifs peuvent être limités à la mise à jour ou à la suppression des enregistrements qu’ils ont créés eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="d5afc-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="d5afc-263">Quel que soit le scénario, les classes Data Web Controls, ObjectDataSource et de la couche de logique métier peuvent être étendues pour ajouter ou refuser certaines fonctionnalités en fonction de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="d5afc-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="d5afc-264">Dans ce didacticiel, nous avons vu comment limiter les données affichables et modifiables selon que l’utilisateur a été associé à un fournisseur particulier ou s’il a travaillé pour notre entreprise.</span><span class="sxs-lookup"><span data-stu-id="d5afc-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="d5afc-265">Ce didacticiel conclut notre examen de l’insertion, de la mise à jour et de la suppression de données à l’aide des contrôles GridView, DetailsView et FormView.</span><span class="sxs-lookup"><span data-stu-id="d5afc-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="d5afc-266">À partir du prochain didacticiel, nous allons attirer l’attention sur l’ajout de la prise en charge de la pagination et du tri.</span><span class="sxs-lookup"><span data-stu-id="d5afc-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="d5afc-267">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="d5afc-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d5afc-268">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="d5afc-268">About the Author</span></span>

<span data-ttu-id="d5afc-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept livres ASP/ASP. net et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec des technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="d5afc-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d5afc-270">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="d5afc-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d5afc-271">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 2,0 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d5afc-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d5afc-272">Il peut être contacté à [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d5afc-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d5afc-273">ou via son blog, qui se trouve sur [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d5afc-273">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="d5afc-274">Précédent</span><span class="sxs-lookup"><span data-stu-id="d5afc-274">Previous</span></span>](adding-client-side-confirmation-when-deleting-vb.md)
