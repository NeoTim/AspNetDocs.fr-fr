---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb
title: Maître/détail à l’aide d’une liste à puces des enregistrements maîtres avec une DataList des détails (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel nous compressons le rapport de deux pages maître/détail du didacticiel précédent en une seule page affichant une liste à puces des noms de catégorie sur t...
ms.author: riande
ms.date: 10/17/2006
ms.assetid: ee20742f-6fb7-49a0-a009-058fe363aacb
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 0f7f42545d2492c7330da57f7e767199f50b659e
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108443"
---
# <a name="masterdetail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb"></a><span data-ttu-id="6abfb-103">Représentation maître/détail avec une liste à puces des enregistrements maîtres avec une DataList des détails (VB)</span><span class="sxs-lookup"><span data-stu-id="6abfb-103">Master/Detail Using a Bulleted List of Master Records with a Details DataList (VB)</span></span>

<span data-ttu-id="6abfb-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6abfb-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6abfb-105">[Télécharger l’exemple d’application](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_VB.exe) ou [télécharger le PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/datatutorial35vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6abfb-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_VB.exe) or [Download PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/datatutorial35vb1.pdf)</span></span>

> <span data-ttu-id="6abfb-106">Dans ce didacticiel nous compressons le rapport de deux pages maître/détail du didacticiel précédent en une seule page affichant une liste à puces des noms de catégories sur le côté gauche de l’écran et les produits de la catégorie sélectionnée sur la droite de l’écran.</span><span class="sxs-lookup"><span data-stu-id="6abfb-106">In this tutorial we'll compress the two-page master/detail report of the previous tutorial into a single page, showing a bulleted list of category names on the left side of the screen and the selected category's products on the right of the screen.</span></span>

## <a name="introduction"></a><span data-ttu-id="6abfb-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="6abfb-107">Introduction</span></span>

<span data-ttu-id="6abfb-108">Dans le [didacticiel précédent](master-detail-filtering-acess-two-pages-datalist-vb.md) nous avons vu comment séparer un rapport maître/détail sur deux pages.</span><span class="sxs-lookup"><span data-stu-id="6abfb-108">In the [preceding tutorial](master-detail-filtering-acess-two-pages-datalist-vb.md) we looked at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="6abfb-109">Dans la page maître, nous avons utilisé un contrôle Repeater pour afficher une liste à puces des catégories.</span><span class="sxs-lookup"><span data-stu-id="6abfb-109">In the master page we used a Repeater control to render a bulleted list of categories.</span></span> <span data-ttu-id="6abfb-110">Chaque nom de catégorie a été un lien hypertexte que, lorsque vous cliquez dessus, serait prennent l’utilisateur à la page de détails, où un contrôle DataList de deux colonnes vous a montré les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="6abfb-110">Each category name was a hyperlink that, when clicked, would take the user to the details page, where a two-column DataList showed those products belonging to the selected category.</span></span>

<span data-ttu-id="6abfb-111">Dans ce didacticiel nous compressons le didacticiel de deux pages en une seule page affichant une liste à puces des noms de catégories sur le côté gauche de l’écran avec chaque nom de catégorie restitué sous la forme d’un bouton de lien.</span><span class="sxs-lookup"><span data-stu-id="6abfb-111">In this tutorial we'll compress the two-page tutorial into a single page, showing a bulleted list of category names on the left side of the screen with each category name rendered as a LinkButton.</span></span> <span data-ttu-id="6abfb-112">Cliquant sur le nom de catégorie de type LinkButton induit une publication (postback) et lie les produits de s catégorie sélectionnée à un contrôle DataList de deux colonnes sur la droite de l’écran.</span><span class="sxs-lookup"><span data-stu-id="6abfb-112">Clicking one of the category name LinkButtons induces a postback and binds the selected category s products to a two-column DataList on the right of the screen.</span></span> <span data-ttu-id="6abfb-113">Outre l’affichage de chaque nom de catégorie s, le Repeater sur la gauche montre nombre total de produits sont une catégorie donnée (voir Figure 1).</span><span class="sxs-lookup"><span data-stu-id="6abfb-113">In addition to displaying each category s name, the Repeater on the left shows how many total products there are for a given category (see Figure 1).</span></span>

<span data-ttu-id="6abfb-114">[![La catégorie s nom et le nombre Total de produits sont affichés sur la gauche](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-114">[![The Category s Name and Total Number of Products are Displayed on the Left](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image1.png)</span></span>

<span data-ttu-id="6abfb-115">**Figure 1**: La catégorie s nom et le nombre Total de produits sont affichés sur la gauche ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-115">**Figure 1**: The Category s Name and Total Number of Products are Displayed on the Left ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image3.png))</span></span>

## <a name="step-1-displaying-a-repeater-in-the-left-portion-of-the-screen"></a><span data-ttu-id="6abfb-116">Étape 1 : Affichage d’un répéteur dans la partie gauche de l’écran</span><span class="sxs-lookup"><span data-stu-id="6abfb-116">Step 1: Displaying a Repeater in the Left Portion of the Screen</span></span>

<span data-ttu-id="6abfb-117">Pour ce didacticiel, nous avons besoin d’afficher la liste à puces des catégories à gauche des produits s catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="6abfb-117">For this tutorial we need to have the bulleted list of categories appear to the left of the selected category s products.</span></span> <span data-ttu-id="6abfb-118">Contenu dans une page web peut être positionnée à l’aide de balises HTML standard éléments paragraphe, les espaces insécables, `<table>` s et ainsi de suite ou via des techniques de feuille de style (CSS) en cascade.</span><span class="sxs-lookup"><span data-stu-id="6abfb-118">Content within a web page can be positioned using standard HTML elements paragraph tags, non-breaking spaces, `<table>` s, and so on or through cascading stylesheet (CSS) techniques.</span></span> <span data-ttu-id="6abfb-119">Tous nos didacticiels utilisaient jusqu’ici des techniques CSS pour le positionnement.</span><span class="sxs-lookup"><span data-stu-id="6abfb-119">All of our tutorials thus far have used CSS techniques for positioning.</span></span> <span data-ttu-id="6abfb-120">Lorsque nous avons créé l’interface utilisateur de navigation dans notre page maître dans le [Pages maîtres et Navigation dans les sites](../introduction/master-pages-and-site-navigation-vb.md) didacticiel, nous avons utilisé *positionnement absolu*, indiquant le décalage de pixel précis pour la navigation liste et le contenu principal.</span><span class="sxs-lookup"><span data-stu-id="6abfb-120">When we built the navigation user interface in our master page in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial we used *absolute positioning*, indicating the precise pixel offset for the navigation list and the main content.</span></span> <span data-ttu-id="6abfb-121">Vous pouvez également les CSS peut être utilisées pour positionner un élément à droite ou gauche d’un autre via *flottante*.</span><span class="sxs-lookup"><span data-stu-id="6abfb-121">Alternatively, CSS can be used to position one element to the right or left of another through *floating*.</span></span> <span data-ttu-id="6abfb-122">Nous pouvons afficher la liste à puces des catégories à gauche des produits s catégorie sélectionnée en flottante répéteur à gauche du contrôle DataList</span><span class="sxs-lookup"><span data-stu-id="6abfb-122">We can have the bulleted list of categories appear to the left of the selected category s products by floating the Repeater to the left of the DataList</span></span>

<span data-ttu-id="6abfb-123">Ouvrez le `CategoriesAndProducts.aspx` page à partir de la `DataListRepeaterFiltering` dossier et ajouter à la page un Repeater et DataList.</span><span class="sxs-lookup"><span data-stu-id="6abfb-123">Open the `CategoriesAndProducts.aspx` page from the `DataListRepeaterFiltering` folder and add to the page a Repeater and a DataList.</span></span> <span data-ttu-id="6abfb-124">Définir le Repeater s `ID` à `Categories` et le contrôle DataList s à `CategoryProducts`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-124">Set the Repeater s `ID` to `Categories` and the DataList s to `CategoryProducts`.</span></span> <span data-ttu-id="6abfb-125">Accédez à la vue de Source et placer les contrôles Repeater et DataList dans leurs propres `<div>` éléments.</span><span class="sxs-lookup"><span data-stu-id="6abfb-125">Go to the Source view and put the Repeater and DataList controls within their own `<div>` elements.</span></span> <span data-ttu-id="6abfb-126">Autrement dit, placez le Repeater au sein d’un `<div>` élément premier et ensuite le contrôle DataList dans son propre `<div>` élément directement après le répéteur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-126">That is, enclose the Repeater within a `<div>` element first and then the DataList in its own `<div>` element directly after the Repeater.</span></span> <span data-ttu-id="6abfb-127">Votre balisage à ce stade doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="6abfb-127">Your markup at this point should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample1.aspx)]

<span data-ttu-id="6abfb-128">Pour détacher le répéteur à gauche du contrôle DataList, nous devons utiliser le `float` attribut de style CSS, comme suit :</span><span class="sxs-lookup"><span data-stu-id="6abfb-128">To float the Repeater to the left of the DataList, we need to use the `float` CSS style attribute, like so:</span></span>

[!code-html[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample2.html)]

<span data-ttu-id="6abfb-129">Le `float: left;` flotte le premier `<div>` élément vers la gauche du second.</span><span class="sxs-lookup"><span data-stu-id="6abfb-129">The `float: left;` floats the first `<div>` element to the left of the second one.</span></span> <span data-ttu-id="6abfb-130">Le `width` et `padding-right` paramètres indiquent la première `<div>` s `width` et la marge intérieure est ajoutée entre le `<div>` contenu de l’élément s et sa marge de droite.</span><span class="sxs-lookup"><span data-stu-id="6abfb-130">The `width` and `padding-right` settings indicate the first `<div>` s `width` and how much padding is added between the `<div>` element s content and its right margin.</span></span> <span data-ttu-id="6abfb-131">Pour plus d’informations sur flottante éléments en CSS extraire le [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span><span class="sxs-lookup"><span data-stu-id="6abfb-131">For more information on floating elements in CSS check out the [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span></span>

<span data-ttu-id="6abfb-132">Plutôt que de spécifier le paramètre de style directement par le biais de la première `<p>` élément s `style` d’attribut, permettent de s au lieu de cela créer une classe CSS dans `Styles.css` nommé `FloatLeft`:</span><span class="sxs-lookup"><span data-stu-id="6abfb-132">Rather than specify the style setting directly through the first `<p>` element s `style` attribute, let s instead create a new CSS class in `Styles.css` named `FloatLeft`:</span></span>

[!code-css[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample3.css)]

<span data-ttu-id="6abfb-133">Puis nous pouvons remplacer le `<div>` avec `<div class="FloatLeft">`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-133">Then we can replace the `<div>` with `<div class="FloatLeft">`.</span></span>

<span data-ttu-id="6abfb-134">Après avoir ajouté la classe CSS et de configuration le balisage dans le `CategoriesAndProducts.aspx` page, accédez au concepteur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-134">After adding the CSS class and configuring the markup in the `CategoriesAndProducts.aspx` page, go to the Designer.</span></span> <span data-ttu-id="6abfb-135">Vous devez voir le répéteur de virgule flottante à gauche du contrôle DataList (bien que le droit à la fois juste apparaissent maintenant comme cases grises depuis nous ve encore à configurer leurs sources de données ou des modèles).</span><span class="sxs-lookup"><span data-stu-id="6abfb-135">You should see the Repeater floating to the left of the DataList (although right now both just appear as gray boxes since we ve yet to configure their data sources or templates).</span></span>

<span data-ttu-id="6abfb-136">[![Le contrôle Repeater est flotte à gauche du contrôle DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-136">[![The Repeater is Floated to the Left of the DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image4.png)</span></span>

<span data-ttu-id="6abfb-137">**Figure 2**: Le contrôle Repeater est flotte à gauche du contrôle DataList ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-137">**Figure 2**: The Repeater is Floated to the Left of the DataList ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image6.png))</span></span>

## <a name="step-2-determining-the-number-of-products-for-each-category"></a><span data-ttu-id="6abfb-138">Étape 2 : Détermination du nombre de produits pour chaque catégorie</span><span class="sxs-lookup"><span data-stu-id="6abfb-138">Step 2: Determining the Number of Products for Each Category</span></span>

<span data-ttu-id="6abfb-139">S Repeater et DataList entourant le balisage complet, nous vous êtes prêt pour lier les données de catégorie pour le répéteur de contrôler.</span><span class="sxs-lookup"><span data-stu-id="6abfb-139">With the Repeater and DataList s surrounding markup complete, we re ready to bind the category data to the Repeater control.</span></span> <span data-ttu-id="6abfb-140">Toutefois, comme le montre la liste à puces des catégories dans la Figure 1, en plus de chaque nom de s catégorie nous devons également afficher le nombre de produits de la catégorie.</span><span class="sxs-lookup"><span data-stu-id="6abfb-140">However, as the bulleted list of categories in Figure 1 shows, in addition to each category s name we also need to display the number of products associated with the category.</span></span> <span data-ttu-id="6abfb-141">Pour accéder à ces informations, nous pouvons :</span><span class="sxs-lookup"><span data-stu-id="6abfb-141">To access this information we can either:</span></span>

- <span data-ttu-id="6abfb-142">**Déterminer ces informations à partir de la classe de code-behind de s de page ASP.NET.**</span><span class="sxs-lookup"><span data-stu-id="6abfb-142">**Determine this information from the ASP.NET page s code-behind class.**</span></span> <span data-ttu-id="6abfb-143">Étant donné un particulier *`categoryID`* nous pouvons déterminer le nombre de produits associés en appelant le `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="6abfb-143">Given a particular *`categoryID`* we can determine the number of associated products by calling the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="6abfb-144">Cette méthode retourne un `ProductsDataTable` de l’objet dont la propriété `Count` propriété indique combien `ProductsRow` s existe, ce qui est le nombre de produits pour spécifié *`categoryID`*.</span><span class="sxs-lookup"><span data-stu-id="6abfb-144">This method returns a `ProductsDataTable` object whose `Count` property indicates how many `ProductsRow` s exists, which is the number of products for the specified *`categoryID`*.</span></span> <span data-ttu-id="6abfb-145">Nous pouvons créer un `ItemDataBound` Gestionnaire d’événements pour le contrôle Repeater qui, pour chaque catégorie lié à la répétition, appelle le `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` (méthode) et inclut son nombre dans la sortie.</span><span class="sxs-lookup"><span data-stu-id="6abfb-145">We can create an `ItemDataBound` event handler for the Repeater that, for each category bound to the Repeater, calls the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method and includes its count in the output.</span></span>
- <span data-ttu-id="6abfb-146">**Mise à jour le `CategoriesDataTable` dans le DataSet typé à inclure un `NumberOfProducts` colonne.**</span><span class="sxs-lookup"><span data-stu-id="6abfb-146">**Update the `CategoriesDataTable` in the Typed DataSet to include a `NumberOfProducts` column.**</span></span> <span data-ttu-id="6abfb-147">Nous pouvons ensuite mettre à jour le `GetCategories()` méthode dans le `CategoriesDataTable` d’inclure ces informations, vous pouvez également `GetCategories()` en tant que-est et créer un nouveau `CategoriesDataTable` méthode appelée `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-147">We can then update the `GetCategories()` method in the `CategoriesDataTable` to include this information or, alternatively, leave `GetCategories()` as-is and create a new `CategoriesDataTable` method called `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="6abfb-148">Permettent d’Explorer ces deux techniques s.</span><span class="sxs-lookup"><span data-stu-id="6abfb-148">Let s explore both of these techniques.</span></span> <span data-ttu-id="6abfb-149">La première approche est plus simple à implémenter, car nous n’avez pas besoin pour mettre à jour de la couche d’accès aux données ; Toutefois, elle nécessite plus de communications avec la base de données.</span><span class="sxs-lookup"><span data-stu-id="6abfb-149">The first approach is simpler to implement since we don t need to update the Data Access Layer; however, it requires more communications with the database.</span></span> <span data-ttu-id="6abfb-150">L’appel à la `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` méthode dans le `ItemDataBound` Gestionnaire d’événements ajoute un appel de la base de données supplémentaires pour chaque catégorie affichée dans le répéteur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-150">The call to the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method in the `ItemDataBound` event handler adds an extra database call for each category displayed in the Repeater.</span></span> <span data-ttu-id="6abfb-151">Avec cette technique, il existe *N* + appels de base de 1 données, où *N* est le nombre de catégories affichées dans le répéteur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-151">With this technique there are *N* + 1 database calls, where *N* is the number of categories displayed in the Repeater.</span></span> <span data-ttu-id="6abfb-152">Avec la deuxième approche, le nombre de produits est retourné avec les informations sur les catégories à partir de la `CategoriesBLL` classe s `GetCategories()` (ou `GetCategoriesAndNumberOfProducts()`) méthode, ce qui entraîne qu’un voyage à la base de données.</span><span class="sxs-lookup"><span data-stu-id="6abfb-152">With the second approach, the product count is returned with information about each category from the `CategoriesBLL` class s `GetCategories()` (or `GetCategoriesAndNumberOfProducts()`) method, thereby resulting in just one trip to the database.</span></span>

## <a name="determining-the-number-of-products-in-the-itemdatabound-event-handler"></a><span data-ttu-id="6abfb-153">Détermination du nombre de produits dans le Gestionnaire d’événement ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="6abfb-153">Determining the Number of Products in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="6abfb-154">Détermination du nombre de produits pour chaque catégorie dans le répéteur s `ItemDataBound` Gestionnaire d’événements ne nécessite pas de toute modification apportée à nos couche d’accès aux données existantes.</span><span class="sxs-lookup"><span data-stu-id="6abfb-154">Determining the number of products for each category in the Repeater s `ItemDataBound` event handler does not require any modifications to our existing Data Access Layer.</span></span> <span data-ttu-id="6abfb-155">Toutes les modifications peuvent être apportées directement dans le `CategoriesAndProducts.aspx` page.</span><span class="sxs-lookup"><span data-stu-id="6abfb-155">All modifications can be made directly within the `CategoriesAndProducts.aspx` page.</span></span> <span data-ttu-id="6abfb-156">Commencez par ajouter un nouveau ObjectDataSource nommé `CategoriesDataSource` via la balise active Repeater s.</span><span class="sxs-lookup"><span data-stu-id="6abfb-156">Start by adding a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="6abfb-157">Ensuite, configurez le `CategoriesDataSource` ObjectDataSource afin qu’il récupère ses données à partir de la `CategoriesBLL` classe s `GetCategories()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="6abfb-157">Next, configure the `CategoriesDataSource` ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>

<span data-ttu-id="6abfb-158">[![Configurer l’ObjectDataSource pour utiliser la classe CategoriesBLL s GetCategories() (méthode)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-158">[![Configure the ObjectDataSource to Use the CategoriesBLL class s GetCategories() Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image7.png)</span></span>

<span data-ttu-id="6abfb-159">**Figure 3**: Configurer l’ObjectDataSource à utiliser le `CategoriesBLL` classe s `GetCategories()` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-159">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` class s `GetCategories()` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image9.png))</span></span>

<span data-ttu-id="6abfb-160">Chaque élément dans le `Categories` Repeater doit être interactif et, lorsque vous cliquez dessus, provoquer la `CategoryProducts` DataList pour afficher ces produits pour la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="6abfb-160">Each item in the `Categories` Repeater needs to be clickable and, when clicked, cause the `CategoryProducts` DataList to display those products for the selected category.</span></span> <span data-ttu-id="6abfb-161">Cela est possible en rendant chaque catégorie d’un lien hypertexte, liaison vers cette même page (`CategoriesAndProducts.aspx`), mais en passant le `CategoryID` via la chaîne de requête, tout comme nous l’avons vu dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="6abfb-161">This can be accomplished by making each category a hyperlink, linking back to this same page (`CategoriesAndProducts.aspx`), but passing the `CategoryID` through the querystring, much like we saw in the previous tutorial.</span></span> <span data-ttu-id="6abfb-162">L’avantage de cette approche est qu’une page affichant une produits de catégorie particulière s peut être marqué d’un signet et indexée par un moteur de recherche.</span><span class="sxs-lookup"><span data-stu-id="6abfb-162">The advantage of this approach is that a page displaying a particular category s products can be bookmarked and indexed by a search engine.</span></span>

<span data-ttu-id="6abfb-163">Ou bien, nous pouvons faire chaque catégorie LinkButton, qui est l’approche que nous allons utiliser pour ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="6abfb-163">Alternatively, we can make each category a LinkButton, which is the approach we'll use for this tutorial.</span></span> <span data-ttu-id="6abfb-164">Le LinkButton est rendu dans le navigateur de l’utilisateur s comme un lien hypertexte, mais, lorsque vous cliquez dessus, déclenche une publication (postback) ; lors de la publication, les opérations de mappage DataList ObjectDataSource doit être actualisé pour afficher les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="6abfb-164">The LinkButton renders in the user s browser as a hyperlink but, when clicked, induces a postback; on postback, the DataList s ObjectDataSource needs to be refreshed to display those products belonging to the selected category.</span></span> <span data-ttu-id="6abfb-165">Pour ce didacticiel, à l’aide d’un lien hypertexte plus judicieux que l’utilisation de LinkButton ; Toutefois, il peut être autres scénarios où il est plus avantageux d’à l’aide d’un bouton de lien.</span><span class="sxs-lookup"><span data-stu-id="6abfb-165">For this tutorial, using a hyperlink makes more sense than using a LinkButton; however, there may be other scenarios where using a LinkButton is more advantageous.</span></span> <span data-ttu-id="6abfb-166">Tandis que l’approche de lien hypertexte serait idéal pour cet exemple, permettent de s au lieu de cela Explorer à l’aide du bouton de lien.</span><span class="sxs-lookup"><span data-stu-id="6abfb-166">While the hyperlink approach would be ideal for this example, let s instead explore using the LinkButton.</span></span> <span data-ttu-id="6abfb-167">Comme nous allons le voir, l’utilisation de LinkButton introduit des défis qui ne pourrait pas autrement se présenter avec un lien hypertexte.</span><span class="sxs-lookup"><span data-stu-id="6abfb-167">As we'll see, using a LinkButton introduces some challenges that would not otherwise arise with a hyperlink.</span></span> <span data-ttu-id="6abfb-168">Par conséquent, à l’aide d’un LinkButton dans ce didacticiel sera mettez en surbrillance ces défis et aider à fournir des solutions pour les scénarios où nous souhaiterons peut-être utiliser un LinkButton au lieu d’un lien hypertexte.</span><span class="sxs-lookup"><span data-stu-id="6abfb-168">Therefore, using a LinkButton in this tutorial will highlight these challenges and help provide solutions for those scenarios where we may want to use a LinkButton instead of a hyperlink.</span></span>

> [!NOTE]
> <span data-ttu-id="6abfb-169">Il est conseillé de répéter ce didacticiel à l’aide d’un contrôle de lien hypertexte ou `<a>` élément à la place le LinkButton.</span><span class="sxs-lookup"><span data-stu-id="6abfb-169">You are encouraged to repeat this tutorial using a HyperLink control or `<a>` element in lieu of the LinkButton.</span></span>

<span data-ttu-id="6abfb-170">Le balisage suivant montre la syntaxe déclarative pour le contrôle Repeater et ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6abfb-170">The following markup shows the declarative syntax for the Repeater and the ObjectDataSource.</span></span> <span data-ttu-id="6abfb-171">Notez que les modèles de s Repeater affichent une liste à puces avec chaque élément comme un LinkButton :</span><span class="sxs-lookup"><span data-stu-id="6abfb-171">Note that the Repeater s templates render a bulleted list with each item as a LinkButton:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample4.aspx)]

> [!NOTE]
> <span data-ttu-id="6abfb-172">Pour ce didacticiel, le Repeater doit avoir son état d’affichage est activé (Notez l’omission de la `EnableViewState="False"` à partir de la syntaxe déclarative Repeater s).</span><span class="sxs-lookup"><span data-stu-id="6abfb-172">For this tutorial the Repeater must have its view state enabled (note the omission of the `EnableViewState="False"` from the Repeater s declarative syntax).</span></span> <span data-ttu-id="6abfb-173">À l’étape 3 nous allons créer un gestionnaire d’événements pour le contrôle Repeater s `ItemCommand` événements dans laquelle nous mettrons à jour le contrôle DataList s ObjectDataSource s `SelectParameters` collection.</span><span class="sxs-lookup"><span data-stu-id="6abfb-173">In step 3 we'll be creating an event handler for the Repeater s `ItemCommand` event in which we'll be updating the DataList s ObjectDataSource s `SelectParameters` collection.</span></span> <span data-ttu-id="6abfb-174">Le Repeater s `ItemCommand`, toutefois, ne se déclenchera pas si l’état d’affichage est désactivé.</span><span class="sxs-lookup"><span data-stu-id="6abfb-174">The Repeater s `ItemCommand`, however, won't fire if view state is disabled.</span></span> <span data-ttu-id="6abfb-175">Consultez [embarrassante A une question de ASP.NET](http://scottonwriting.net/sowblog/posts/1263.aspx) et [sa solution](http://scottonwriting.net/sowBlog/posts/1268.aspx) pour plus d’informations sur la raison pour laquelle l’état d’affichage doit être activé pour un répéteur s `ItemCommand` l’événement.</span><span class="sxs-lookup"><span data-stu-id="6abfb-175">See [A Stumper of an ASP.NET Question](http://scottonwriting.net/sowblog/posts/1263.aspx) and [its solution](http://scottonwriting.net/sowBlog/posts/1268.aspx) for more information on why view state must be enabled for a Repeater s `ItemCommand` event to fire.</span></span>

<span data-ttu-id="6abfb-176">Le LinkButton le `ID` valeur de propriété de `ViewCategory` n’a pas son `Text` jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="6abfb-176">The LinkButton with the `ID` property value of `ViewCategory` does not have its `Text` property set.</span></span> <span data-ttu-id="6abfb-177">Si nous avions voulions seulement afficher le nom de catégorie, nous serait avez défini la propriété Text de façon déclarative, via la syntaxe de liaison de données, comme suit :</span><span class="sxs-lookup"><span data-stu-id="6abfb-177">If we had just wanted to display the category name, we would have set the Text property declaratively, through databinding syntax, like so:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample5.aspx)]

<span data-ttu-id="6abfb-178">Toutefois, nous souhaitons afficher à la fois le nom de catégorie s *et* le nombre de produits appartenant à cette catégorie.</span><span class="sxs-lookup"><span data-stu-id="6abfb-178">However, we want to show both the category s name *and* the number of products belonging to that category.</span></span> <span data-ttu-id="6abfb-179">Ces informations peuvent être extraites de répéteur s `ItemDataBound` Gestionnaire d’événements en effectuant un appel à la `ProductBLL` classe s `GetCategoriesByProductID(categoryID)` méthode et déterminer le nombre d’enregistrements est retourné dans le résultat `ProductsDataTable`, comme le code suivant illustre :</span><span class="sxs-lookup"><span data-stu-id="6abfb-179">This information can be retrieved from the Repeater s `ItemDataBound` event handler by making a call to the `ProductBLL` class s `GetCategoriesByProductID(categoryID)` method and determining how many records are returned in the resulting `ProductsDataTable`, as the following code illustrates:</span></span>

[!code-vb[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="6abfb-180">Nous commençons en s’assurant que nous re fonctionne avec un élément de données (un dont `ItemType` est `Item` ou `AlternatingItem`), puis référencez la `CategoriesRow` instance qui a simplement été liée à l’actuel `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-180">We start out by ensuring that we re working with a data item (one whose `ItemType` is `Item` or `AlternatingItem`) and then reference the `CategoriesRow` instance that has just been bound to the current `RepeaterItem`.</span></span> <span data-ttu-id="6abfb-181">Ensuite, nous déterminons le nombre de produits pour cette catégorie en créant une instance de la `ProductsBLL` classe, appelant ses `GetCategoriesByProductID(categoryID)` méthode et déterminer le nombre d’enregistrements renvoyés à l’aide de la `Count` propriété.</span><span class="sxs-lookup"><span data-stu-id="6abfb-181">Next, we determine the number of products for this category by creating an instance of the `ProductsBLL` class, calling its `GetCategoriesByProductID(categoryID)` method, and determining the number of records returned using the `Count` property.</span></span> <span data-ttu-id="6abfb-182">Enfin, le `ViewCategory` LinkButton dans ItemTemplate est références et son `Text` propriété est définie sur *CategoryName* (*NumberOfProductsInCategory*), où  *NumberOfProductsInCategory* est sous forme de nombre décimale.</span><span class="sxs-lookup"><span data-stu-id="6abfb-182">Finally, the `ViewCategory` LinkButton in the ItemTemplate is references and its `Text` property is set to *CategoryName* (*NumberOfProductsInCategory*), where *NumberOfProductsInCategory* is formatted as a number with zero decimal places.</span></span>

> [!NOTE]
> <span data-ttu-id="6abfb-183">Vous pouvez également nous aurions pu ajouter un *mise en forme de la fonction* à la classe code-behind de page s ASP.NET qui accepte une catégorie s `CategoryName` et `CategoryID` valeurs et retourne le `CategoryName` concaténé avec le nombre de produits de la catégorie (comme déterminé en appelant le `GetCategoriesByProductID(categoryID)` méthode).</span><span class="sxs-lookup"><span data-stu-id="6abfb-183">Alternatively, we could have added a *formatting function* to the ASP.NET page s code-behind class that accepts a category s `CategoryName` and `CategoryID` values and returns the `CategoryName` concatenated with the number of products in the category (as determined by calling the `GetCategoriesByProductID(categoryID)` method).</span></span> <span data-ttu-id="6abfb-184">Les résultats d’une telle fonction mise en forme peut être affectées de façon déclarative à la s LinkButton propriété de texte en remplaçant le besoin du `ItemDataBound` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="6abfb-184">The results of such a formatting function could be declaratively assigned to the LinkButton s Text property replacing the need for the `ItemDataBound` event handler.</span></span> <span data-ttu-id="6abfb-185">Reportez-vous à la [à l’aide de TemplateFields dans le contrôle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) ou [mise en forme les contrôles DataList et Repeater sur données](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) didacticiels pour plus d’informations sur l’utilisation de fonctions de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="6abfb-185">Refer to the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) or [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) tutorials for more information on using formatting functions.</span></span>

<span data-ttu-id="6abfb-186">Après avoir ajouté ce gestionnaire d’événements, prenez un moment pour tester la page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-186">After adding this event handler, take a moment to test the page through a browser.</span></span> <span data-ttu-id="6abfb-187">Notez la façon dont chaque catégorie est répertorié dans une liste à puces, affichant le nom de catégorie s et le nombre de produits de la catégorie (voir Figure 4).</span><span class="sxs-lookup"><span data-stu-id="6abfb-187">Note how each category is listed in a bulleted list, displaying the category s name and the number of products associated with the category (see Figure 4).</span></span>

<span data-ttu-id="6abfb-188">[![Chaque nom de catégorie et le nombre de produits sont affichés.](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-188">[![Each Category s Name and Number of Products are Displayed](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image10.png)</span></span>

<span data-ttu-id="6abfb-189">**Figure 4**: Chaque nom de catégorie et le nombre de produits sont affichés ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-189">**Figure 4**: Each Category s Name and Number of Products are Displayed ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image12.png))</span></span>

## <a name="updating-thecategoriesdatatableandcategoriestableadapterto-include-the-number-of-products-for-each-category"></a><span data-ttu-id="6abfb-190">La mise à jour le`CategoriesDataTable`et`CategoriesTableAdapter`pour inclure le nombre de produits pour chaque catégorie</span><span class="sxs-lookup"><span data-stu-id="6abfb-190">Updating the`CategoriesDataTable`and`CategoriesTableAdapter`to Include the Number of Products for Each Category</span></span>

<span data-ttu-id="6abfb-191">Au lieu de la détermination du nombre de produits pour chaque catégorie tel qu’il s lié à la répétition, nous pouvons simplifier ce processus en ajustant la `CategoriesDataTable` et `CategoriesTableAdapter` dans la couche d’accès aux données à inclure ces informations en mode natif.</span><span class="sxs-lookup"><span data-stu-id="6abfb-191">Rather than determining the number of products for each category as it s bound to the Repeater, we can streamline this process by adjusting the `CategoriesDataTable` and `CategoriesTableAdapter` in the Data Access Layer to include this information natively.</span></span> <span data-ttu-id="6abfb-192">Pour ce faire, nous devons ajouter une nouvelle colonne à `CategoriesDataTable` pour contenir le nombre de produits associés.</span><span class="sxs-lookup"><span data-stu-id="6abfb-192">To achieve this, we must add a new column to `CategoriesDataTable` to hold the number of associated products.</span></span> <span data-ttu-id="6abfb-193">Pour ajouter une nouvelle colonne à un DataTable, ouvrez le DataSet typé (`App_Code\DAL\Northwind.xsd`), avec le bouton droit sur la table de données à modifier, puis sélectionnez Ajouter / colonne.</span><span class="sxs-lookup"><span data-stu-id="6abfb-193">To add a new column to a DataTable, open the Typed DataSet (`App_Code\DAL\Northwind.xsd`), right-click on the DataTable to modify, and choose Add / Column.</span></span> <span data-ttu-id="6abfb-194">Ajouter une nouvelle colonne à la `CategoriesDataTable` (voir Figure 5).</span><span class="sxs-lookup"><span data-stu-id="6abfb-194">Add a new column to the `CategoriesDataTable` (see Figure 5).</span></span>

<span data-ttu-id="6abfb-195">[![Ajouter une nouvelle colonne à la CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-195">[![Add a New Column to the CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image13.png)</span></span>

<span data-ttu-id="6abfb-196">**Figure 5**: Ajouter une nouvelle colonne à la `CategoriesDataSource` ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-196">**Figure 5**: Add a New Column to the `CategoriesDataSource` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image15.png))</span></span>

<span data-ttu-id="6abfb-197">Cela ajoutera une nouvelle colonne nommée `Column1`, que vous pouvez modifier en tapant simplement un nom différent.</span><span class="sxs-lookup"><span data-stu-id="6abfb-197">This will add a new column named `Column1`, which you can change by simply typing in a different name.</span></span> <span data-ttu-id="6abfb-198">Renommer cette colonne `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-198">Rename this new column to `NumberOfProducts`.</span></span> <span data-ttu-id="6abfb-199">Ensuite, nous devons configurer les propriétés de cette colonne s.</span><span class="sxs-lookup"><span data-stu-id="6abfb-199">Next, we need to configure this column s properties.</span></span> <span data-ttu-id="6abfb-200">Cliquez sur la nouvelle colonne et accédez à la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="6abfb-200">Click on the new column and go to the Properties window.</span></span> <span data-ttu-id="6abfb-201">Modifier la colonne s `DataType` propriété à partir de `System.String` à `System.Int32` et définir le `ReadOnly` propriété `True`, comme illustré dans la Figure 6.</span><span class="sxs-lookup"><span data-stu-id="6abfb-201">Change the column s `DataType` property from `System.String` to `System.Int32` and set the `ReadOnly` property to `True`, as shown in Figure 6.</span></span>

![Définir le type de données et les propriétés en lecture seule de la nouvelle colonne](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image16.png)

<span data-ttu-id="6abfb-203">**Figure 6**: Définir le `DataType` et `ReadOnly` propriétés de la nouvelle colonne</span><span class="sxs-lookup"><span data-stu-id="6abfb-203">**Figure 6**: Set the `DataType` and `ReadOnly` Properties of the New Column</span></span>

<span data-ttu-id="6abfb-204">Bien que le `CategoriesDataTable` a maintenant un `NumberOfProducts` colonne, sa valeur n’est pas définie par une des requêtes s TableAdapter correspondantes.</span><span class="sxs-lookup"><span data-stu-id="6abfb-204">While the `CategoriesDataTable` now has a `NumberOfProducts` column, its value is not set by any of the corresponding TableAdapter s queries.</span></span> <span data-ttu-id="6abfb-205">Nous pouvons mettre à jour le `GetCategories()` retourné de méthode pour retourner ces informations si nous voulons que ces informations chaque fois les informations de catégorie sont récupérées.</span><span class="sxs-lookup"><span data-stu-id="6abfb-205">We can update the `GetCategories()` method to return this information if we want such information returned every time category information is retrieved.</span></span> <span data-ttu-id="6abfb-206">Si, toutefois, il nous suffit de saisir le nombre de produits associés pour les catégories dans de rares cas (par exemple, tout simplement pour ce didacticiel), nous pouvons laisser `GetCategories()` en tant que-est et créer une nouvelle méthode qui retourne cette information.</span><span class="sxs-lookup"><span data-stu-id="6abfb-206">If, however, we only need to grab the number of associated products for the categories in rare instances (such as just for this tutorial), then we can leave `GetCategories()` as-is and create a new method that returns this information.</span></span> <span data-ttu-id="6abfb-207">S permettent d’utiliser cette dernière approche, création d’une nouvelle méthode nommée `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-207">Let s use this latter approach, creating a new method named `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="6abfb-208">Pour ajouter de nouveaux `GetCategoriesAndNumberOfProducts()` (méthode), avec le bouton droit sur le `CategoriesTableAdapter` et choisissez Nouvelle requête.</span><span class="sxs-lookup"><span data-stu-id="6abfb-208">To add this new `GetCategoriesAndNumberOfProducts()` method, right-click on the `CategoriesTableAdapter` and choose New Query.</span></span> <span data-ttu-id="6abfb-209">Cela permet d’afficher le TableAdapter interroger Assistant de Configuration, ce qui nous ve utilisé plusieurs fois dans les didacticiels précédents.</span><span class="sxs-lookup"><span data-stu-id="6abfb-209">This brings up the TableAdapter Query Configuration Wizard, which we ve used numerous times in previous tutorials.</span></span> <span data-ttu-id="6abfb-210">Pour cette méthode, démarrez l’Assistant en indiquant que la requête utilise une instruction SQL ad hoc qui retourne des lignes.</span><span class="sxs-lookup"><span data-stu-id="6abfb-210">For this method, start the wizard by indicating that the query uses an ad-hoc SQL statement that returns rows.</span></span>

<span data-ttu-id="6abfb-211">[![Créer la méthode à l’aide d’une instruction SQL de Ad-Hoc](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-211">[![Create the Method Using an Ad-Hoc SQL Statement](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image17.png)</span></span>

<span data-ttu-id="6abfb-212">**Figure 7**: Créer la méthode à l’aide une instruction SQL de Ad-Hoc ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-212">**Figure 7**: Create the Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image19.png))</span></span>

<span data-ttu-id="6abfb-213">[![L’instruction SQL retourne des lignes](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-213">[![The SQL Statement Returns Rows](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image20.png)</span></span>

<span data-ttu-id="6abfb-214">**Figure 8**: L’instruction SQL retourne les lignes ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-214">**Figure 8**: The SQL Statement Returns Rows ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image22.png))</span></span>

<span data-ttu-id="6abfb-215">L’écran suivant de l’Assistant nous invite pour la requête à utiliser.</span><span class="sxs-lookup"><span data-stu-id="6abfb-215">The next wizard screen prompts us for the query to use.</span></span> <span data-ttu-id="6abfb-216">Pour retourner chaque catégorie s `CategoryID`, `CategoryName`, et `Description` champs, ainsi que le nombre de produits de la catégorie, utilisent la commande suivante `SELECT` instruction :</span><span class="sxs-lookup"><span data-stu-id="6abfb-216">To return each category s `CategoryID`, `CategoryName`, and `Description` fields, along with the number of products associated with the category, use the following `SELECT` statement:</span></span>

[!code-sql[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample7.sql)]

<span data-ttu-id="6abfb-217">[![Spécifiez la requête à utiliser](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-217">[![Specify the Query to Use](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image23.png)</span></span>

<span data-ttu-id="6abfb-218">**Figure 9**: Spécifiez la requête à utiliser ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-218">**Figure 9**: Specify the Query to Use ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image25.png))</span></span>

<span data-ttu-id="6abfb-219">Notez que la sous-requête qui calcule le nombre de produits de la catégorie a pour alias `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-219">Note that the subquery that computes the number of products associated with the category is aliased as `NumberOfProducts`.</span></span> <span data-ttu-id="6abfb-220">Cette correspondance d’affectation de noms entraîne la valeur retournée par cette sous-requête à associer à la `CategoriesDataTable` s `NumberOfProducts` colonne.</span><span class="sxs-lookup"><span data-stu-id="6abfb-220">This naming match causes the value returned by this subquery to be associated with the `CategoriesDataTable` s `NumberOfProducts` column.</span></span>

<span data-ttu-id="6abfb-221">Après avoir entré cette requête, la dernière étape consiste à choisir le nom de la nouvelle méthode.</span><span class="sxs-lookup"><span data-stu-id="6abfb-221">After entering this query, the last step is to choose the name for the new method.</span></span> <span data-ttu-id="6abfb-222">Utilisez `FillWithNumberOfProducts` et `GetCategoriesAndNumberOfProducts` pour le remplissage un DataTable et la retourner un DataTable des modèles, respectivement.</span><span class="sxs-lookup"><span data-stu-id="6abfb-222">Use `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span>

<span data-ttu-id="6abfb-223">[![Nom de la nouvelle FillWithNumberOfProducts de méthodes de s TableAdapter et GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-223">[![Name the New TableAdapter s Methods FillWithNumberOfProducts and GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image26.png)</span></span>

<span data-ttu-id="6abfb-224">**Figure 10**: Nommez le s TableAdapter de nouvelles méthodes `FillWithNumberOfProducts` et `GetCategoriesAndNumberOfProducts` ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-224">**Figure 10**: Name the New TableAdapter s Methods `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image28.png))</span></span>

<span data-ttu-id="6abfb-225">À ce stade, la couche Data Access a été étendue pour inclure le nombre de produits par catégorie.</span><span class="sxs-lookup"><span data-stu-id="6abfb-225">At this point the Data Access Layer has been extended to include the number of products per category.</span></span> <span data-ttu-id="6abfb-226">Étant donné que tous nos couche de présentation achemine tous les appels à la couche DAL via une couche de logique métier distincts nous devons ajouter un correspondant `GetCategoriesAndNumberOfProducts` méthode à la `CategoriesBLL` classe :</span><span class="sxs-lookup"><span data-stu-id="6abfb-226">Since all our presentation layer routes all calls to the DAL through a separate Business Logic Layer we need to add a corresponding `GetCategoriesAndNumberOfProducts` method to the `CategoriesBLL` class:</span></span>

[!code-vb[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample8.vb)]

<span data-ttu-id="6abfb-227">Avec la couche DAL et de la couche BLL terminée, nous re prêt pour lier ces données à la `Categories` Repeater dans `CategoriesAndProducts.aspx`!</span><span class="sxs-lookup"><span data-stu-id="6abfb-227">With the DAL and BLL complete, we re ready to bind this data to the `Categories` Repeater in `CategoriesAndProducts.aspx`!</span></span> <span data-ttu-id="6abfb-228">Si vous avez déjà créé déjà ObjectDataSource pour le répéteur du déterminer le nombre de produits dans le `ItemDataBound` section du Gestionnaire d’événements, supprimer ce ObjectDataSource et Repeater s `DataSourceID` propriété définition ; également ses le Repeater s `ItemDataBound` événement du Gestionnaire d’événements en supprimant le `Handles Categories.OnItemDataBound` syntaxe dans la classe code-behind ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6abfb-228">If you ve already created an ObjectDataSource for the Repeater from the Determining the Number of Products in the `ItemDataBound` Event Handler section, delete this ObjectDataSource and remove the Repeater s `DataSourceID` property setting; also unwire the Repeater s `ItemDataBound` event from the event handler by removing the `Handles Categories.OnItemDataBound` syntax in the ASP.NET code-behind class.</span></span>

<span data-ttu-id="6abfb-229">Avec le contrôle Repeater dans son état d’origine, ajouter un nouveau ObjectDataSource nommé `CategoriesDataSource` via la balise active Repeater s.</span><span class="sxs-lookup"><span data-stu-id="6abfb-229">With the Repeater back in its original state, add a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="6abfb-230">Configurer ObjectDataSource à utiliser le `CategoriesBLL` (classe), mais il lieu d’utiliser le `GetCategories()` (méthode), ont il utiliser `GetCategoriesAndNumberOfProducts()` à la place (voir Figure 11).</span><span class="sxs-lookup"><span data-stu-id="6abfb-230">Configure the ObjectDataSource to use the `CategoriesBLL` class, but instead of having it use the `GetCategories()` method, have it use `GetCategoriesAndNumberOfProducts()` instead (see Figure 11).</span></span>

<span data-ttu-id="6abfb-231">[![Configurer pour utiliser la méthode GetCategoriesAndNumberOfProducts ObjectDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-231">[![Configure the ObjectDataSource to Use the GetCategoriesAndNumberOfProducts Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image29.png)</span></span>

<span data-ttu-id="6abfb-232">**Figure 11**: Configurer l’ObjectDataSource à utiliser le `GetCategoriesAndNumberOfProducts` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-232">**Figure 11**: Configure the ObjectDataSource to Use the `GetCategoriesAndNumberOfProducts` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image31.png))</span></span>

<span data-ttu-id="6abfb-233">Ensuite, mettez à jour le `ItemTemplate` afin que les opérations de mappage LinkButton `Text` propriété est affectée façon déclarative à l’aide de la syntaxe de liaison de données et comprend à la fois le `CategoryName` et `NumberOfProducts` des champs de données.</span><span class="sxs-lookup"><span data-stu-id="6abfb-233">Next, update the `ItemTemplate` so that the LinkButton s `Text` property is declaratively assigned using databinding syntax and includes both the `CategoryName` and `NumberOfProducts` data fields.</span></span> <span data-ttu-id="6abfb-234">Le balisage déclaratif complet pour le contrôle Repeater et `CategoriesDataSource` ObjectDataSource suivi :</span><span class="sxs-lookup"><span data-stu-id="6abfb-234">The complete declarative markup for the Repeater and the `CategoriesDataSource` ObjectDataSource follow:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample9.aspx)]

<span data-ttu-id="6abfb-235">La sortie rendue en mettant à jour de la couche DAL pour inclure un `NumberOfProducts` colonne est identique à l’aide de la `ItemDataBound` approche de gestionnaire d’événements (vous référer à la Figure 4 pour voir un écran capture du répéteur montrant les noms de catégorie et le nombre de produits).</span><span class="sxs-lookup"><span data-stu-id="6abfb-235">The output rendered by updating the DAL to include a `NumberOfProducts` column is the same as using the `ItemDataBound` event handler approach (refer back to Figure 4 to see a screen shot of the Repeater showing the category names and number of products).</span></span>

## <a name="step-3-displaying-the-selected-category-s-products"></a><span data-ttu-id="6abfb-236">Étape 3 : Afficher les produits de s catégorie sélectionnée</span><span class="sxs-lookup"><span data-stu-id="6abfb-236">Step 3: Displaying the Selected Category s Products</span></span>

<span data-ttu-id="6abfb-237">À ce stade, nous avons le `Categories` Repeater affichant la liste des catégories, ainsi que le nombre de produits dans chaque catégorie.</span><span class="sxs-lookup"><span data-stu-id="6abfb-237">At this point we have the `Categories` Repeater displaying the list of categories along with the number of products in each category.</span></span> <span data-ttu-id="6abfb-238">Le Repeater utilise un LinkButton pour chaque catégorie que, lorsque vous cliquez dessus, entraîne une publication (postback), auquel point nous devons afficher ces produits pour la catégorie sélectionnée dans le `CategoryProducts` DataList.</span><span class="sxs-lookup"><span data-stu-id="6abfb-238">The Repeater uses a LinkButton for each category that, when clicked, causes a postback, at which point we need to display those products for the selected category in the `CategoryProducts` DataList.</span></span>

<span data-ttu-id="6abfb-239">Un défi de nous consiste à avoir le contrôle DataList afficher seulement ces produits pour la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="6abfb-239">One challenge facing us is how to have the DataList display just those products for the selected category.</span></span> <span data-ttu-id="6abfb-240">Dans le [maître/détail utilisant un GridView maître avec un contrôle DetailsView détails](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) didacticiel, nous avons vu comment générer un GridView dont les lignes a pu être sélectionnée, avec la ligne sélectionnée s décrit en détail qui est affiché dans un contrôle DetailsView sur la même page.</span><span class="sxs-lookup"><span data-stu-id="6abfb-240">In the [Master/Detail Using a Selectable Master GridView with a Details DetailsView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) tutorial we saw how to build a GridView whose rows could be selected, with the selected row s details being displayed in a DetailsView on the same page.</span></span> <span data-ttu-id="6abfb-241">Les opérations de mappage GridView ObjectDataSource a retourné des informations concernant tous les produits à l’aide de la `ProductsBLL` s `GetProducts()` méthode lors de la s DetailsView ObjectDataSource récupéré des informations sur le produit sélectionné à l’aide la `GetProductsByProductID(productID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="6abfb-241">The GridView s ObjectDataSource returned information about all products using the `ProductsBLL` s `GetProducts()` method while the DetailsView s ObjectDataSource retrieved information about the selected product using the `GetProductsByProductID(productID)` method.</span></span> <span data-ttu-id="6abfb-242">Le *`productID`* valeur du paramètre a été fournie de manière déclarative en l’associant à la valeur de la s GridView `SelectedValue` propriété.</span><span class="sxs-lookup"><span data-stu-id="6abfb-242">The *`productID`* parameter value was provided declaratively by associating it with the value of the GridView s `SelectedValue` property.</span></span> <span data-ttu-id="6abfb-243">Malheureusement, le contrôle Repeater n’a pas un `SelectedValue` propriété et ne peut pas servir en tant que paramètre source.</span><span class="sxs-lookup"><span data-stu-id="6abfb-243">Unfortunately, the Repeater does not have a `SelectedValue` property and cannot serve as a parameter source.</span></span>

> [!NOTE]
> <span data-ttu-id="6abfb-244">Il s’agit d’un des défis qui apparaissent lorsque vous utilisez le LinkButton dans un répéteur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-244">This is one of those challenges that appear when using the LinkButton in a Repeater.</span></span> <span data-ttu-id="6abfb-245">Si nous avions utilisé un lien hypertexte pour transmettre le `CategoryID` via la chaîne de requête au lieu de cela, nous pourrions utiliser ce champ de chaîne de requête comme source pour la valeur du paramètre s.</span><span class="sxs-lookup"><span data-stu-id="6abfb-245">Had we used a hyperlink to pass in the `CategoryID` through the querystring instead, we could use that QueryString field as the source for the parameter s value.</span></span>

<span data-ttu-id="6abfb-246">Avant de nous soucier de l’absence d’un `SelectedValue` propriété pour le contrôle Repeater, cependant, permettre de s tout d’abord lier le contrôle DataList à ObjectDataSource et spécifier ses `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-246">Before we worry about the lack of a `SelectedValue` property for the Repeater, though, let s first bind the DataList to an ObjectDataSource and specify its `ItemTemplate`.</span></span>

<span data-ttu-id="6abfb-247">À partir de la balise active DataList s, choisir d’ajouter un nouveau ObjectDataSource nommé `CategoryProductsDataSource` et configurez-le pour utiliser le `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="6abfb-247">From the DataList s smart tag, opt to add a new ObjectDataSource named `CategoryProductsDataSource` and configure it to use the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="6abfb-248">Étant donné que le contrôle DataList dans ce didacticiel offre une interface en lecture seule, n’hésitez pas à définir les listes déroulantes dans l’instruction INSERT, UPDATE et supprimer des onglets à (None).</span><span class="sxs-lookup"><span data-stu-id="6abfb-248">Since the DataList in this tutorial offers a read-only interface, feel free to set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="6abfb-249">[![Configurer pour utiliser la méthode de classe de ProductsBLL s GetProductsByCategoryID(categoryID) ObjectDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-249">[![Configure the ObjectDataSource to Use ProductsBLL Class s GetProductsByCategoryID(categoryID) Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image32.png)</span></span>

<span data-ttu-id="6abfb-250">**Figure 12**: Configurer l’ObjectDataSource à utiliser `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-250">**Figure 12**: Configure the ObjectDataSource to Use `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image34.png))</span></span>

<span data-ttu-id="6abfb-251">Dans la mesure où le `GetProductsByCategoryID(categoryID)` méthode attend un paramètre d’entrée (*`categoryID`*), l’Assistant Configurer la Source de données permet de spécifier la source du paramètre s.</span><span class="sxs-lookup"><span data-stu-id="6abfb-251">Since the `GetProductsByCategoryID(categoryID)` method expects an input parameter (*`categoryID`*), the Configure Data Source wizard allows us to specify the parameter s source.</span></span> <span data-ttu-id="6abfb-252">Les catégories avaient été répertoriés dans un GridView ou un contrôle DataList, nous d définition de la liste de liste déroulante de paramètre source au contrôle et le ControlID à la `ID` des données de contrôle Web.</span><span class="sxs-lookup"><span data-stu-id="6abfb-252">Had the categories been listed in a GridView or a DataList, we d set the Parameter source drop-down list to Control and the ControlID to the `ID` of the data Web control.</span></span> <span data-ttu-id="6abfb-253">Toutefois, puisque le manque de répéteur un `SelectedValue` il ne peut pas être utilisé comme source de paramètre de propriété.</span><span class="sxs-lookup"><span data-stu-id="6abfb-253">However, since the Repeater lacks a `SelectedValue` property it cannot be used as a parameter source.</span></span> <span data-ttu-id="6abfb-254">Si vous activez, vous trouverez que la liste déroulante ControlID contienne uniquement un seul contrôle `ID``CategoryProducts`, le `ID` de DataList.</span><span class="sxs-lookup"><span data-stu-id="6abfb-254">If you check, you'll find that the ControlID drop-down list only contains one control `ID``CategoryProducts`, the `ID` of the DataList.</span></span>

<span data-ttu-id="6abfb-255">Pour l’instant, définition de la liste de liste déroulante de source de paramètre None.</span><span class="sxs-lookup"><span data-stu-id="6abfb-255">For now, set the Parameter source drop-down list to None.</span></span> <span data-ttu-id="6abfb-256">Nous allons se retrouvent assignation par programme cette valeur de paramètre lorsqu’une catégorie que LinkButton est activé dans le répéteur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-256">We'll end up programmatically assigning this parameter value when a category LinkButton is clicked in the Repeater.</span></span>

<span data-ttu-id="6abfb-257">[![Faire pas spécifier une Source de paramètre pour la paramètre categoryID](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-257">[![Do Not Specify a Parameter Source for the categoryID Parameter](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image35.png)</span></span>

<span data-ttu-id="6abfb-258">**Figure 13**: Faire pas spécifier une Source de paramètre pour le *`categoryID`* paramètre ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-258">**Figure 13**: Do Not Specify a Parameter Source for the *`categoryID`* Parameter ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image37.png))</span></span>

<span data-ttu-id="6abfb-259">À l’issue de l’Assistant Configurer la Source de données, Visual Studio génère automatiquement le contrôle DataList s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-259">After completing the Configure Data Source wizard, Visual Studio auto-generates the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="6abfb-260">Remplacez cette valeur par défaut `ItemTemplate` avec le modèle nous utilisé dans le didacticiel précédent ; en outre, définissez le contrôle DataList s `RepeatColumns` propriété à 2.</span><span class="sxs-lookup"><span data-stu-id="6abfb-260">Replace this default `ItemTemplate` with the template we used in the preceding tutorial; also, set the DataList s `RepeatColumns` property to 2.</span></span> <span data-ttu-id="6abfb-261">Après avoir apporté ces modifications le balisage déclaratif pour vos contrôles DataList et son ObjectDataSource associé doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="6abfb-261">After making these changes the declarative markup for your DataList and its associated ObjectDataSource should look like the following:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample10.aspx)]

<span data-ttu-id="6abfb-262">Actuellement, le `CategoryProductsDataSource` ObjectDataSource s *`categoryID`* paramètre n’est jamais défini, aucun produit n’est affichés lorsque vous affichez la page.</span><span class="sxs-lookup"><span data-stu-id="6abfb-262">Currently, the `CategoryProductsDataSource` ObjectDataSource s *`categoryID`* parameter is never set, so no products are displayed when viewing the page.</span></span> <span data-ttu-id="6abfb-263">Ce que nous devons faire est ont cette valeur de paramètre selon le `CategoryID` de la catégorie utilisateur a cliqué dessue dans le répéteur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-263">What we need to do is have this parameter value set based on the `CategoryID` of the clicked category in the Repeater.</span></span> <span data-ttu-id="6abfb-264">Cela introduit deux défis : tout d’abord, comment nous déterminons quand un LinkButton dans le répéteur s `ItemTemplate` a été cliqué dessus ; et le deuxième comment nous déterminons le `CategoryID` de la catégorie correspondante, l’utilisateur a cliqué sur dont LinkButton ?</span><span class="sxs-lookup"><span data-stu-id="6abfb-264">This introduces two challenges: first, how do we determine when a LinkButton in the Repeater s `ItemTemplate` has been clicked; and second, how can we determine the `CategoryID` of the corresponding category whose LinkButton was clicked?</span></span>

<span data-ttu-id="6abfb-265">Le LinkButton comme les contrôles Button et ImageButton a un `Click` événement et un [ `Command` événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span><span class="sxs-lookup"><span data-stu-id="6abfb-265">The LinkButton like the Button and ImageButton controls has a `Click` event and a [`Command` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span></span> <span data-ttu-id="6abfb-266">Le `Click` événement est conçu pour Notez simplement que le LinkButton a été cliqué.</span><span class="sxs-lookup"><span data-stu-id="6abfb-266">The `Click` event is designed to simply note that the LinkButton has been clicked.</span></span> <span data-ttu-id="6abfb-267">Dans certains cas, toutefois, en plus de noter que le LinkButton a été cliqué nous devons également transmettre des informations supplémentaires au gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="6abfb-267">At times, however, in addition to noting that the LinkButton has been clicked we also need to pass some extra information to the event handler.</span></span> <span data-ttu-id="6abfb-268">Si c’est le cas, le LinkButton s [ `CommandName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) et [ `CommandArgument` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) propriétés peuvent être attribuées à ces informations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="6abfb-268">If this is the case, the LinkButton s [`CommandName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) and [`CommandArgument`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) properties can be assigned this extra information.</span></span> <span data-ttu-id="6abfb-269">Ensuite, lorsque l’utilisateur clique sur le LinkButton, son `Command` se déclenche des événements (au lieu de son `Click` événement) et le Gestionnaire d’événements reçoit les valeurs de la `CommandName` et `CommandArgument` propriétés.</span><span class="sxs-lookup"><span data-stu-id="6abfb-269">Then, when the LinkButton is clicked, its `Command` event fires (instead of its `Click` event) and the event handler is passed the values of the `CommandName` and `CommandArgument` properties.</span></span>

<span data-ttu-id="6abfb-270">Lorsqu’un `Command` événement est déclenché à partir d’un modèle dans le répéteur, les opérations de mappage Repeater [ `ItemCommand` événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) se déclenche et est passé le `CommandName` et `CommandArgument` les valeurs de l’utilisateur a cliqué dessu LinkButton (ou bouton ou ImageButton).</span><span class="sxs-lookup"><span data-stu-id="6abfb-270">When a `Command` event is raised from within a template in the Repeater, the Repeater s [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) fires and is passed the `CommandName` and `CommandArgument` values of the clicked LinkButton (or Button or ImageButton).</span></span> <span data-ttu-id="6abfb-271">Par conséquent, pour déterminer quand une catégorie LinkButton dans le répéteur a été cliquée, nous devons effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="6abfb-271">Therefore, to determine when a category LinkButton in the Repeater has been clicked, we need to do the following:</span></span>

1. <span data-ttu-id="6abfb-272">Définir le `CommandName` propriété du contrôle LinkButton dans le répéteur s `ItemTemplate` à une valeur (Je ve utilisé ListProducts).</span><span class="sxs-lookup"><span data-stu-id="6abfb-272">Set the `CommandName` property of the LinkButton in the Repeater s `ItemTemplate` to some value (I ve used ListProducts ).</span></span> <span data-ttu-id="6abfb-273">En définissant ce paramètre `CommandName` valeur, le LinkButton s `Command` événement est déclenché lorsque l’utilisateur clique sur le LinkButton.</span><span class="sxs-lookup"><span data-stu-id="6abfb-273">By setting this `CommandName` value, the LinkButton s `Command` event fires when the LinkButton is clicked.</span></span>
2. <span data-ttu-id="6abfb-274">Définir le LinkButton s `CommandArgument` valeur à la propriété de l’élément actuel s `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-274">Set the LinkButton s `CommandArgument` property to the value of the current item s `CategoryID`.</span></span>
3. <span data-ttu-id="6abfb-275">Créer un gestionnaire d’événements pour le contrôle Repeater s `ItemCommand` événement.</span><span class="sxs-lookup"><span data-stu-id="6abfb-275">Create an event handler for the Repeater s `ItemCommand` event.</span></span> <span data-ttu-id="6abfb-276">Dans le gestionnaire, jeu d’événements le `CategoryProductsDataSource` ObjectDataSource s `CategoryID` paramètre à la valeur du passé en `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-276">In the event handler, set the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span>

<span data-ttu-id="6abfb-277">Ce qui suit `ItemTemplate` balisage pour le contrôle Repeater catégories implémente les étapes 1 et 2.</span><span class="sxs-lookup"><span data-stu-id="6abfb-277">The following `ItemTemplate` markup for the Categories Repeater implements steps 1 and 2.</span></span> <span data-ttu-id="6abfb-278">Notez comment la `CommandArgument` est assignée à l’élément de données s `CategoryID` à l’aide de la syntaxe de liaison de données :</span><span class="sxs-lookup"><span data-stu-id="6abfb-278">Note how the `CommandArgument` value is assigned the data item s `CategoryID` using databinding syntax:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample11.aspx)]

<span data-ttu-id="6abfb-279">Chaque fois que la création d’un `ItemCommand` Gestionnaire d’événements qu’il est préférable de toujours à vérifier au préalable entrant `CommandName` valeur car *n’importe quel* `Command` événement déclenché par *n’importe quel* Button, LinkButton, ou ImageButton du Repeater entraîne le `ItemCommand` l’événement.</span><span class="sxs-lookup"><span data-stu-id="6abfb-279">Whenever creating an `ItemCommand` event handler it is prudent to always first check the incoming `CommandName` value because *any* `Command` event raised by *any* Button, LinkButton, or ImageButton within the Repeater will cause the `ItemCommand` event to fire.</span></span> <span data-ttu-id="6abfb-280">Pendant que nous seulement disposons actuellement une telle LinkButton maintenant, dans le futur nous (ou un autre développeur de notre équipe) pourrais ajouter contrôles Web de bouton supplémentaires pour le contrôle Repeater qui, lorsque vous cliquez dessus, déclenche les mêmes `ItemCommand` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="6abfb-280">While we currently only have one such LinkButton now, in the future we (or another developer on our team) might add additional button Web controls to the Repeater that, when clicked, raises the same `ItemCommand` event handler.</span></span> <span data-ttu-id="6abfb-281">Par conséquent, il est préférable de toujours s’assurer que vous vérifiez le `CommandName` propriété et poursuivre votre logique de programmation uniquement si elle correspond à la valeur attendue.</span><span class="sxs-lookup"><span data-stu-id="6abfb-281">Therefore, it s best to always make sure you check the `CommandName` property and only proceed with your programmatic logic if it matches up to the value expected.</span></span>

<span data-ttu-id="6abfb-282">Après avoir vérifié que le passé dans `CommandName` ListProducts est égale à, le Gestionnaire d’événements puis assigne le `CategoryProductsDataSource` ObjectDataSource s `CategoryID` paramètre à la valeur du passé en `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="6abfb-282">After ensuring that the passed-in `CommandName` value equals ListProducts, the event handler then assigns the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span> <span data-ttu-id="6abfb-283">Cette modification de l’ObjectDataSource s `SelectParameters` entraîne automatiquement le contrôle DataList pour se relier à la source de données, montrant les produits pour la catégorie qui vient d’être sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="6abfb-283">This modification to the ObjectDataSource s `SelectParameters` automatically causes the DataList to rebind itself to the data source, showing the products for the newly selected category.</span></span>

[!code-vb[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample12.vb)]

<span data-ttu-id="6abfb-284">Avec ces ajouts, notre didacticiel est terminé !</span><span class="sxs-lookup"><span data-stu-id="6abfb-284">With these additions, our tutorial is complete!</span></span> <span data-ttu-id="6abfb-285">Prenez un moment pour faire des tests dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="6abfb-285">Take a moment to test it out in a browser.</span></span> <span data-ttu-id="6abfb-286">Figure 14 illustre l’écran lors de la première visite la page.</span><span class="sxs-lookup"><span data-stu-id="6abfb-286">Figure 14 shows the screen when first visiting the page.</span></span> <span data-ttu-id="6abfb-287">Dans la mesure où une catégorie doit encore être sélectionné, aucun produit n’est affichés.</span><span class="sxs-lookup"><span data-stu-id="6abfb-287">Since a category has yet to be selected, no products are displayed.</span></span> <span data-ttu-id="6abfb-288">Cliquez sur une catégorie, c'est-à-dire les produits pour afficher ces produits dans la catégorie de produit dans une vue de deux colonnes (voir Figure 15).</span><span class="sxs-lookup"><span data-stu-id="6abfb-288">Clicking on a category, such as Produce, displays those products in the Product category in a two-column view (see Figure 15).</span></span>

<span data-ttu-id="6abfb-289">[![Aucun produit n’est affichée lors de la première visite de la Page](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-289">[![No Products are Displayed When First Visiting the Page](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image38.png)</span></span>

<span data-ttu-id="6abfb-290">**Figure 14**: Aucun produit n’est affichée lors de la première visite de la Page ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-290">**Figure 14**: No Products are Displayed When First Visiting the Page ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image40.png))</span></span>

<span data-ttu-id="6abfb-291">[![En cliquant sur les listes de catégories produisent les produits correspondants à droite](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="6abfb-291">[![Clicking the Produce Category Lists the Matching Products to the Right](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image41.png)</span></span>

<span data-ttu-id="6abfb-292">**Figure 15**: En cliquant sur la catégorie de produits répertorie les produits de mise en correspondance vers la droite ([cliquez pour afficher l’image en taille réelle](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="6abfb-292">**Figure 15**: Clicking the Produce Category Lists the Matching Products to the Right ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image43.png))</span></span>

## <a name="summary"></a><span data-ttu-id="6abfb-293">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="6abfb-293">Summary</span></span>

<span data-ttu-id="6abfb-294">Comme nous l’avons vu dans ce didacticiel et précédente, les rapports maître/détail peuvent être répartis sur deux pages ou consolidées sur un.</span><span class="sxs-lookup"><span data-stu-id="6abfb-294">As we saw in this tutorial and the preceding one, master/detail reports can be spread out across two pages, or consolidated on one.</span></span> <span data-ttu-id="6abfb-295">Pour afficher un rapport maître/détails sur une seule page, cependant, présente des défis sur la façon de mieux le maître de disposition et les enregistrements de détails sur la page.</span><span class="sxs-lookup"><span data-stu-id="6abfb-295">Displaying a master/details report on a single page, however, introduces some challenges on how best to layout the master and details records on the page.</span></span> <span data-ttu-id="6abfb-296">Dans le *maître/détail utilisant un GridView maître avec un contrôle DetailsView détails* didacticiel, nous avons dû les enregistrements de détails sont affichés ci-dessus les enregistrements maîtres ; dans ce didacticiel, nous avons utilisé les techniques CSS pour avoir la valeur float enregistrements principaux à le gauche des détails.</span><span class="sxs-lookup"><span data-stu-id="6abfb-296">In the *Master/Detail Using a Selectable Master GridView with a Details DetailsView* tutorial we had the details records appear above the master records; in this tutorial we used CSS techniques to have the master records float to the left of the details.</span></span>

<span data-ttu-id="6abfb-297">Ainsi que d’afficher les rapports maître/détails, il nous fallait également la possibilité de découvrir comment récupérer le nombre de produits associés à chaque catégorie, ainsi que la manière dont pour effectuer la logique côté serveur quand un LinkButton (ou bouton ou ImageButton) un clic sur depuis un Repeater.</span><span class="sxs-lookup"><span data-stu-id="6abfb-297">Along with displaying master/details reports, we also had the opportunity to explore how to retrieve the number of products associated with each category as well as how to perform server-side logic when a LinkButton (or Button or ImageButton) is clicked from within a Repeater.</span></span>

<span data-ttu-id="6abfb-298">Ce didacticiel terminé notre examen des rapports maître/détail avec les contrôles DataList et Repeater.</span><span class="sxs-lookup"><span data-stu-id="6abfb-298">This tutorial completes our examination of master/detail reports with the DataList and Repeater.</span></span> <span data-ttu-id="6abfb-299">Notre ensemble de didacticiels suivant illustre comment ajouter la modification et suppression de fonctionnalités pour le contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="6abfb-299">Our next set of tutorials will illustrate how to add editing and deleting capabilities to the DataList control.</span></span>

<span data-ttu-id="6abfb-300">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="6abfb-300">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="6abfb-301">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="6abfb-301">Further Reading</span></span>

<span data-ttu-id="6abfb-302">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="6abfb-302">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="6abfb-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) un didacticiel sur flottante éléments CSS avec CSS</span><span class="sxs-lookup"><span data-stu-id="6abfb-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) a tutorial on floating CSS elements with CSS</span></span>
- <span data-ttu-id="6abfb-304">[Positionnement CSS](http://www.brainjar.com/css/positioning/) plus d’informations sur le positionnement des éléments avec CSS</span><span class="sxs-lookup"><span data-stu-id="6abfb-304">[CSS Positioning](http://www.brainjar.com/css/positioning/) more information on positioning elements with CSS</span></span>
- <span data-ttu-id="6abfb-305">[Disposition Out contenu avec HTML](http://www.w3schools.com/html/html_layout.asp) à l’aide de `<table>` s et autres éléments HTML de positionnement</span><span class="sxs-lookup"><span data-stu-id="6abfb-305">[Laying Out Content with HTML](http://www.w3schools.com/html/html_layout.asp) using `<table>` s and other HTML elements for positioning</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6abfb-306">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="6abfb-306">About the Author</span></span>

<span data-ttu-id="6abfb-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept les livres sur ASP/ASP.NET et fondateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="6abfb-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6abfb-308">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="6abfb-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6abfb-309">Son dernier ouvrage est [*SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6abfb-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6abfb-310">Il peut être contacté à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6abfb-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="6abfb-311">ou via son blog, qui se trouve à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6abfb-311">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6abfb-312">Remerciements</span><span class="sxs-lookup"><span data-stu-id="6abfb-312">Special Thanks To</span></span>

<span data-ttu-id="6abfb-313">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="6abfb-313">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6abfb-314">Entraîner un réviseur pour ce didacticiel a été Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="6abfb-314">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="6abfb-315">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="6abfb-315">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6abfb-316">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6abfb-316">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="6abfb-317">Précédent</span><span class="sxs-lookup"><span data-stu-id="6abfb-317">Previous</span></span>](master-detail-filtering-acess-two-pages-datalist-vb.md)
