---
uid: web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12
title: 'Déploiement d’une application Web ASP.NET avec SQL Server Compact à l’aide de Visual Studio ou Visual Web Developer : déploiement vers IIS en tant qu’environnement de test-5 sur 12 | Microsoft Docs'
author: tdykstra
description: Cette série de didacticiels vous montre comment déployer (publier) un projet d’application Web ASP.NET qui comprend une base de données SQL Server Compact à l’aide de Stu...
ms.author: riande
ms.date: 11/17/2011
ms.assetid: 493b2a66-816c-485c-8315-952ed1085ccc
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12
msc.type: authoredcontent
ms.openlocfilehash: 5d85232ff2cb229d771d517db7173721c9e277bf
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74633516"
---
# <a name="deploying-an-aspnet-web-application-with-sql-server-compact-using-visual-studio-or-visual-web-developer-deploying-to-iis-as-a-test-environment---5-of-12"></a><span data-ttu-id="e7994-103">Déploiement d’une application Web ASP.NET avec SQL Server Compact à l’aide de Visual Studio ou Visual Web Developer : déploiement vers IIS en tant qu’environnement de test-5 sur 12</span><span class="sxs-lookup"><span data-stu-id="e7994-103">Deploying an ASP.NET Web Application with SQL Server Compact using Visual Studio or Visual Web Developer: Deploying to IIS as a Test Environment - 5 of 12</span></span>

<span data-ttu-id="e7994-104">par [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="e7994-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="e7994-105">Télécharger le projet de démarrage</span><span class="sxs-lookup"><span data-stu-id="e7994-105">Download Starter Project</span></span>](https://code.msdn.microsoft.com/Deploying-an-ASPNET-Web-4e31366b)

> <span data-ttu-id="e7994-106">Cette série de didacticiels vous montre comment déployer (publier) un projet d’application Web ASP.NET qui comprend une base de données SQL Server Compact à l’aide de Visual Studio 2012 RC ou Visual Studio Express 2012 RC pour le Web.</span><span class="sxs-lookup"><span data-stu-id="e7994-106">This series of tutorials shows you how to deploy (publish) an ASP.NET web application project that includes a SQL Server Compact database by using Visual Studio 2012 RC or Visual Studio Express 2012 RC for Web.</span></span> <span data-ttu-id="e7994-107">Vous pouvez également utiliser Visual Studio 2010 si vous installez la mise à jour de publication Web.</span><span class="sxs-lookup"><span data-stu-id="e7994-107">You can also use Visual Studio 2010 if you install the Web Publish Update.</span></span> <span data-ttu-id="e7994-108">Pour obtenir une présentation de la série, consultez [le premier didacticiel de la série](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="e7994-108">For an introduction to the series, see [the first tutorial in the series](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span></span>
> 
> <span data-ttu-id="e7994-109">Pour obtenir un didacticiel qui présente les fonctionnalités de déploiement introduites après la version RC de Visual Studio 2012, montre comment déployer des éditions SQL Server autres que SQL Server Compact et montre comment déployer vers Azure App Service Web Apps, consultez [déploiement Web ASP.net à l’aide de Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="e7994-109">For a tutorial that shows deployment features introduced after the RC release of Visual Studio 2012, shows how to deploy SQL Server editions other than SQL Server Compact, and shows how to deploy to Azure App Service Web Apps, see [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span></span>

## <a name="overview"></a><span data-ttu-id="e7994-110">Vue d'ensemble de</span><span class="sxs-lookup"><span data-stu-id="e7994-110">Overview</span></span>

<span data-ttu-id="e7994-111">Ce didacticiel montre comment déployer une application Web ASP.NET sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="e7994-111">This tutorial shows how to deploy an ASP.NET web application to IIS on the local computer.</span></span>

<span data-ttu-id="e7994-112">Lorsque vous développez une application, vous testez généralement en l’exécutant dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e7994-112">When you develop an application, you generally test by running it in Visual Studio.</span></span> <span data-ttu-id="e7994-113">Par défaut, cela signifie que vous utilisez le Serveur Visual Studio Development (également appelé Cassini).</span><span class="sxs-lookup"><span data-stu-id="e7994-113">By default, this means you're using the Visual Studio Development Server (also known as Cassini).</span></span> <span data-ttu-id="e7994-114">Le Serveur Visual Studio Development facilite le test pendant le développement dans Visual Studio, mais il ne fonctionne pas exactement comme IIS.</span><span class="sxs-lookup"><span data-stu-id="e7994-114">The Visual Studio Development Server makes it easy to test during development in Visual Studio, but it doesn't work exactly like IIS.</span></span> <span data-ttu-id="e7994-115">Par conséquent, il est possible qu’une application s’exécute correctement lorsque vous la Testez dans Visual Studio, mais échoue quand elle est déployée sur IIS dans un environnement d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="e7994-115">As a result, it's possible that an application will run correctly when you test it in Visual Studio, but fail when it's deployed to IIS in a hosting environment.</span></span>

<span data-ttu-id="e7994-116">Vous pouvez tester votre application de manière plus fiable en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="e7994-116">You can test your application more reliably in these ways:</span></span>

1. <span data-ttu-id="e7994-117">Utilisez IIS Express ou IIS complet au lieu du Serveur Visual Studio Development quand vous testez dans Visual Studio pendant le développement.</span><span class="sxs-lookup"><span data-stu-id="e7994-117">Use IIS Express or full IIS instead of the Visual Studio Development Server when you test in Visual Studio during development.</span></span> <span data-ttu-id="e7994-118">Cette méthode émule généralement plus précisément la manière dont votre site s’exécutera sous IIS.</span><span class="sxs-lookup"><span data-stu-id="e7994-118">This method generally emulates more accurately how your site will run under IIS.</span></span> <span data-ttu-id="e7994-119">Toutefois, cette méthode ne teste pas votre processus de déploiement et ne vérifie pas que le résultat du processus de déploiement s’exécutera correctement.</span><span class="sxs-lookup"><span data-stu-id="e7994-119">However, this method does not test your deployment process or validate that the result of the deployment process will run correctly.</span></span>
2. <span data-ttu-id="e7994-120">Déployez l’application sur votre ordinateur de développement à l’aide du même processus que celui que vous utiliserez ultérieurement pour le déployer dans votre environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e7994-120">Deploy the application to IIS on your development computer by using the same process that you'll use later to deploy it to your production environment.</span></span> <span data-ttu-id="e7994-121">Cette méthode valide votre processus de déploiement en plus de la validation que votre application s’exécutera correctement sous IIS.</span><span class="sxs-lookup"><span data-stu-id="e7994-121">This method validates your deployment process in addition to validating that your application will run correctly under IIS.</span></span>
3. <span data-ttu-id="e7994-122">Déployez l’application dans un environnement de test aussi proche que possible de votre environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e7994-122">Deploy the application to a test environment that is as close as possible to your production environment.</span></span> <span data-ttu-id="e7994-123">Étant donné que l’environnement de production de ces didacticiels est un fournisseur d’hébergement tiers, l’environnement de test idéal serait un deuxième compte avec le fournisseur d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="e7994-123">Since the production environment for these tutorials is a third-party hosting provider, the ideal test environment would be a second account with the hosting provider.</span></span> <span data-ttu-id="e7994-124">Vous ne devez utiliser ce second compte que pour le test, mais il serait configuré de la même façon que le compte de production.</span><span class="sxs-lookup"><span data-stu-id="e7994-124">You would use this second account only for testing, but it would be set up the same way as the production account.</span></span>

<span data-ttu-id="e7994-125">Ce didacticiel présente les étapes de l’option 2.</span><span class="sxs-lookup"><span data-stu-id="e7994-125">This tutorial shows the steps for option 2.</span></span> <span data-ttu-id="e7994-126">Les instructions pour l’option 3 sont fournies à la fin du didacticiel [sur le déploiement dans l’environnement de production](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) . à la fin de ce didacticiel, des liens vers des ressources sont disponibles pour l’option 1.</span><span class="sxs-lookup"><span data-stu-id="e7994-126">Guidance for option 3 is provided at the end of the [Deploying to the Production Environment](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial, and at the end of this tutorial there are links to resources for option 1.</span></span>

<span data-ttu-id="e7994-127">Rappel : Si vous recevez un message d’erreur ou si une action ne fonctionne pas au fur et à mesure que vous parcourez le didacticiel, veillez à consulter la [page de résolution des problèmes](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="e7994-127">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span></span>

## <a name="configuring-the-application-to-run-in-medium-trust"></a><span data-ttu-id="e7994-128">Configuration de l’application pour qu’elle s’exécute dans un niveau de confiance moyen</span><span class="sxs-lookup"><span data-stu-id="e7994-128">Configuring the Application to Run in Medium Trust</span></span>

<span data-ttu-id="e7994-129">Avant d’installer IIS et de le déployer, vous devez modifier un paramètre de fichier Web. config afin que le site s’exécute plus comme dans un environnement d’hébergement partagé standard.</span><span class="sxs-lookup"><span data-stu-id="e7994-129">Before installing IIS and deploying to it, you'll change a Web.config file setting in order to make the site run more like it will in a typical shared hosting environment.</span></span>

<span data-ttu-id="e7994-130">En général, les fournisseurs d’hébergement exécutent votre site Web dans un niveau de *confiance moyen*, ce qui signifie qu’il n’est pas autorisé de faire certaines choses.</span><span class="sxs-lookup"><span data-stu-id="e7994-130">Hosting providers typically run your web site in *medium trust*, which means there are some things it is not allowed to do.</span></span> <span data-ttu-id="e7994-131">Par exemple, le code d’application ne peut pas accéder au registre Windows et ne peut pas lire ou écrire des fichiers qui se trouvent en dehors de la hiérarchie des dossiers de votre application.</span><span class="sxs-lookup"><span data-stu-id="e7994-131">For example, application code can't access the Windows registry and can't read or write files that are outside of your application's folder hierarchy.</span></span> <span data-ttu-id="e7994-132">Par défaut, votre application s’exécute avec un *niveau de confiance élevé* sur votre ordinateur local, ce qui signifie que l’application peut être en mesure d’effectuer des opérations qui échouent lorsque vous la déployez en production.</span><span class="sxs-lookup"><span data-stu-id="e7994-132">By default your application runs in *high trust* on your local computer, which means that the application might be able to do things that would fail when you deploy it to production.</span></span> <span data-ttu-id="e7994-133">Par conséquent, pour que l’environnement de test reflète plus précisément l’environnement de production, vous configurez l’application pour qu’elle s’exécute dans un niveau de confiance moyen.</span><span class="sxs-lookup"><span data-stu-id="e7994-133">Therefore, to make the test environment more accurately reflect the production environment, you'll configure the application to run in medium trust.</span></span>

<span data-ttu-id="e7994-134">Dans le fichier Web. config de l’application, ajoutez un élément **Trust** dans l’élément **System. Web** , comme illustré dans cet exemple.</span><span class="sxs-lookup"><span data-stu-id="e7994-134">In the application Web.config file, add a **trust** element in the **system.web** element, as shown in this example.</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample1.xml?highlight=4)]

<span data-ttu-id="e7994-135">L’application s’exécute maintenant dans un niveau de confiance moyen dans IIS, même sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="e7994-135">The application will now run in medium trust in IIS even on your local computer.</span></span> <span data-ttu-id="e7994-136">Ce paramètre vous permet d’intercepter le plus tôt possible toutes les tentatives de code d’application qui pourraient échouer en production.</span><span class="sxs-lookup"><span data-stu-id="e7994-136">This setting enables you to catch as early as possible any attempts by application code to do something that would fail in production.</span></span>

> [!NOTE]
> <span data-ttu-id="e7994-137">Si vous utilisez Migrations Entity Framework Code First, assurez-vous que la version 5,0 ou une version ultérieure est installée.</span><span class="sxs-lookup"><span data-stu-id="e7994-137">If you are using Entity Framework Code First Migrations, make sure that you have version 5.0 or later installed.</span></span> <span data-ttu-id="e7994-138">Dans Entity Framework version 4,3, les migrations requièrent une confiance totale pour mettre à jour le schéma de la base de données.</span><span class="sxs-lookup"><span data-stu-id="e7994-138">In Entity Framework version 4.3, Migrations requires full trust in order to update the database schema.</span></span>

## <a name="installing-iis-and-web-deploy"></a><span data-ttu-id="e7994-139">Installation d’IIS et de Web Deploy</span><span class="sxs-lookup"><span data-stu-id="e7994-139">Installing IIS and Web Deploy</span></span>

<span data-ttu-id="e7994-140">Pour effectuer un déploiement sur IIS sur votre ordinateur de développement, IIS et Web Deploy doivent être installés.</span><span class="sxs-lookup"><span data-stu-id="e7994-140">To deploy to IIS on your development computer, you must have IIS and Web Deploy installed.</span></span> <span data-ttu-id="e7994-141">Celles-ci ne sont pas incluses dans la configuration par défaut de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="e7994-141">These are not included in the default Windows 7 configuration.</span></span> <span data-ttu-id="e7994-142">Si vous avez déjà installé IIS et Web Deploy, passez à la section suivante.</span><span class="sxs-lookup"><span data-stu-id="e7994-142">If you have already installed both IIS and Web Deploy, skip to the next section.</span></span>

<span data-ttu-id="e7994-143">L’utilisation de l' [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx) est la méthode recommandée pour installer iis et Web Deploy, car le Web Platform Installer installe une configuration recommandée pour IIS et installe automatiquement les composants requis pour iis et Web Deploy si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="e7994-143">Using the [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx) is the preferred way to install IIS and Web Deploy, because the Web Platform Installer installs a recommended configuration for IIS and it automatically installs the prerequisites for IIS and Web Deploy if necessary.</span></span>

<span data-ttu-id="e7994-144">Pour exécuter Web Platform Installer pour installer IIS et Web Deploy, utilisez le lien suivant.</span><span class="sxs-lookup"><span data-stu-id="e7994-144">To run Web Platform Installer to install IIS and Web Deploy, use the following link.</span></span> <span data-ttu-id="e7994-145">Si vous avez déjà installé IIS, Web Deploy ou l’un de ses composants requis, le Web Platform Installer installe uniquement ce qui est manquant.</span><span class="sxs-lookup"><span data-stu-id="e7994-145">If you already have installed IIS, Web Deploy or any of their required components, the Web Platform Installer installs only what is missing.</span></span>

- [<span data-ttu-id="e7994-146">Installer IIS et Web Deploy à l’aide de WebPI</span><span class="sxs-lookup"><span data-stu-id="e7994-146">Install IIS and Web Deploy using WebPI</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=IIS7;ASPNET;NETFramework4;WDeploy)

## <a name="setting-the-default-application-pool-to-net-4"></a><span data-ttu-id="e7994-147">Définition du pool d’applications par défaut sur .NET 4</span><span class="sxs-lookup"><span data-stu-id="e7994-147">Setting the Default Application Pool to .NET 4</span></span>

<span data-ttu-id="e7994-148">Après l’installation d’IIS, exécutez le **Gestionnaire des services Internet** pour vous assurer que le .NET Framework version 4 est affecté au pool d’applications par défaut.</span><span class="sxs-lookup"><span data-stu-id="e7994-148">After installing IIS, run **IIS Manager** to make sure that the .NET Framework version 4 is assigned to the default application pool.</span></span>

<span data-ttu-id="e7994-149">Dans le menu **Démarrer** de Windows, sélectionnez **exécuter**, entrez « inetmgr », puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="e7994-149">From the Windows **Start** menu, select **Run**, enter "inetmgr", and then click **OK**.</span></span> <span data-ttu-id="e7994-150">(Si la commande **exécuter** ne se trouve pas dans votre menu **Démarrer** , vous pouvez appuyer sur la touche Windows et R pour l’ouvrir.</span><span class="sxs-lookup"><span data-stu-id="e7994-150">(If the **Run** command is not in your **Start** menu, you can press the Windows Key and R to open it.</span></span> <span data-ttu-id="e7994-151">Ou cliquez avec le bouton droit sur la barre des tâches, cliquez sur **Propriétés**, sélectionnez l’onglet **menu Démarrer** , cliquez sur **personnaliser**, puis sélectionnez **exécuter la commande**.)</span><span class="sxs-lookup"><span data-stu-id="e7994-151">Or right-click the taskbar, click **Properties**, select the **Start Menu** tab, click **Customize**, and select **Run command**.)</span></span>

<span data-ttu-id="e7994-152">Dans le volet **connexions** , développez le nœud du serveur, puis sélectionnez **pools d’applications**.</span><span class="sxs-lookup"><span data-stu-id="e7994-152">In the **Connections** pane, expand the server node and select **Application Pools**.</span></span> <span data-ttu-id="e7994-153">Dans le volet **pools d’applications** , si **DefaultAppPool** est affecté à la version 4 du .NET Framework, comme dans l’illustration suivante, passez à la section suivante.</span><span class="sxs-lookup"><span data-stu-id="e7994-153">In the **Application Pools** pane, if **DefaultAppPool** is assigned to the .NET framework version 4 as in the following illustration, skip to the next section.</span></span>

<span data-ttu-id="e7994-154">[![Inetmgr_showing_4.0_app_pools](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-154">[![Inetmgr_showing_4.0_app_pools](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image1.png)</span></span>

<span data-ttu-id="e7994-155">Si vous ne voyez que deux pools d’applications et que les deux sont définis sur la .NET Framework 2,0, vous devez installer ASP.NET 4 dans IIS :</span><span class="sxs-lookup"><span data-stu-id="e7994-155">If you see only two application pools and both of them are set to the .NET Framework 2.0, you have to install ASP.NET 4 in IIS:</span></span>

- <span data-ttu-id="e7994-156">Ouvrez une fenêtre d’invite de commandes en cliquant avec le bouton droit sur **invite de commandes** dans le menu **Démarrer** de Windows, puis en sélectionnant **exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="e7994-156">Open a command prompt window by right-clicking **Command Prompt** in the Windows **Start** menu and selecting **Run as Administrator**.</span></span> <span data-ttu-id="e7994-157">Exécutez ensuite [aspnet\_regiis. exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) pour installer ASP.net 4 dans IIS, à l’aide des commandes suivantes.</span><span class="sxs-lookup"><span data-stu-id="e7994-157">Then run [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) to install ASP.NET 4 in IIS, using the following commands.</span></span> <span data-ttu-id="e7994-158">(Dans les systèmes 64 bits, remplacez « Framework » par « Framework64 ».)</span><span class="sxs-lookup"><span data-stu-id="e7994-158">(In 64-bit systems, replace "Framework" with "Framework64".)</span></span>

    [!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample2.cmd)]

    <span data-ttu-id="e7994-159">[![aspnet_regiis_installing_ASP. NET_4](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-159">[![aspnet_regiis_installing_ASP.NET_4](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image3.png)</span></span>

    <span data-ttu-id="e7994-160">Cette commande crée de nouveaux pools d’applications pour le .NET Framework 4, mais le pool d’applications par défaut est toujours défini sur 2,0.</span><span class="sxs-lookup"><span data-stu-id="e7994-160">This command creates new application pools for the .NET Framework 4, but the default application pool will still be set to 2.0.</span></span> <span data-ttu-id="e7994-161">Vous allez déployer une application qui cible .NET 4 vers ce pool d’applications. vous devez donc modifier le pool d’applications en .NET 4.</span><span class="sxs-lookup"><span data-stu-id="e7994-161">You'll be deploying an application that targets .NET 4 to that application pool, so you have to change the application pool to .NET 4.</span></span>

<span data-ttu-id="e7994-162">Si vous avez fermé le **Gestionnaire des services Internet**, réexécutez-le, développez le nœud du serveur, puis cliquez sur **pools d’applications** pour afficher à nouveau le volet **pools d’applications** .</span><span class="sxs-lookup"><span data-stu-id="e7994-162">If you closed **IIS Manager**, run it again, expand the server node, and click **Application Pools** to display the **Application Pools** pane again.</span></span>

<span data-ttu-id="e7994-163">Dans le volet **pools d’applications** , cliquez sur **DefaultAppPool**, puis dans le volet **actions** , cliquez sur **paramètres de base**.</span><span class="sxs-lookup"><span data-stu-id="e7994-163">In the **Application Pools** pane, click **DefaultAppPool**, and then in the **Actions** pane click **Basic Settings**.</span></span>

<span data-ttu-id="e7994-164">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-164">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image5.png)</span></span>

<span data-ttu-id="e7994-165">Dans la boîte de dialogue **modifier le pool d’applications** , remplacez **.NET Framework version** par **.NET Framework v 4.0.30319** , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="e7994-165">In the **Edit Application Pool** dialog box, change **.NET Framework version** to **.NET Framework v4.0.30319** and click **OK**.</span></span>

<span data-ttu-id="e7994-166">[![Selecting_. NET_4_for_DefaultAppPool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-166">[![Selecting_.NET_4_for_DefaultAppPool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image7.png)</span></span>

<span data-ttu-id="e7994-167">Vous êtes maintenant prêt à publier sur IIS.</span><span class="sxs-lookup"><span data-stu-id="e7994-167">You are now ready to publish to IIS.</span></span>

## <a name="publishing-to-iis"></a><span data-ttu-id="e7994-168">Publication sur IIS</span><span class="sxs-lookup"><span data-stu-id="e7994-168">Publishing to IIS</span></span>

<span data-ttu-id="e7994-169">Vous pouvez déployer de plusieurs façons à l’aide de Visual Studio 2010 et Web Deploy :</span><span class="sxs-lookup"><span data-stu-id="e7994-169">There are several ways you can deploy using Visual Studio 2010 and Web Deploy:</span></span>

- <span data-ttu-id="e7994-170">Utilisez la publication en un clic de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e7994-170">Use Visual Studio one-click publish.</span></span>
- <span data-ttu-id="e7994-171">Créez un *package de déploiement* et installez-le à l’aide de l’interface utilisateur du gestionnaire des services Internet.</span><span class="sxs-lookup"><span data-stu-id="e7994-171">Create a *deployment package* and install it using the IIS Manager UI.</span></span> <span data-ttu-id="e7994-172">Le package de déploiement se compose d’un fichier *. zip* qui contient tous les fichiers et les métadonnées nécessaires à l’installation d’un site dans IIS.</span><span class="sxs-lookup"><span data-stu-id="e7994-172">The deployment package consists of a *.zip* file that contains all the files and metadata needed to install a site in IIS.</span></span>
- <span data-ttu-id="e7994-173">Créez un package de déploiement et installez-le à l’aide de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="e7994-173">Create a deployment package and install it using the command line.</span></span>

<span data-ttu-id="e7994-174">Le processus que vous avez parcouru dans les didacticiels précédents pour configurer Visual Studio afin d’automatiser les tâches de déploiement s’applique à toutes ces trois méthodes.</span><span class="sxs-lookup"><span data-stu-id="e7994-174">The process you went through in the previous tutorials to set up Visual Studio to automate deployment tasks applies to all of these three methods.</span></span> <span data-ttu-id="e7994-175">Dans ces didacticiels, vous allez utiliser la première de ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="e7994-175">In these tutorials you'll use the first of these methods.</span></span> <span data-ttu-id="e7994-176">Pour plus d’informations sur l’utilisation des packages de déploiement, consultez [mappage de contenu de déploiement ASP.net](https://msdn.microsoft.com/library/bb386521.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7994-176">For information about using deployment packages, see [ASP.NET Deployment Content Map](https://msdn.microsoft.com/library/bb386521.aspx).</span></span>

<span data-ttu-id="e7994-177">Avant la publication, assurez-vous que vous exécutez Visual Studio en mode administrateur.</span><span class="sxs-lookup"><span data-stu-id="e7994-177">Before publishing, make sure that you are running Visual Studio in administrator mode.</span></span> <span data-ttu-id="e7994-178">(Dans le menu **Démarrer** de Windows 7, cliquez avec le bouton droit sur l’icône de la version de Visual Studio que vous utilisez et sélectionnez **exécuter en tant qu’administrateur**.) Le mode administrateur est requis pour la publication uniquement lorsque vous publiez sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="e7994-178">(In the Windows 7 **Start** menu, right-click the icon for the version of Visual Studio you're using and select **Run as Administrator**.) Administrator mode is required for publishing only when you are publishing to IIS on the local computer.</span></span>

<span data-ttu-id="e7994-179">Dans **Explorateur de solutions**, cliquez avec le bouton droit sur le projet ContosoUniversity (pas sur le projet CONTOSOUNIVERSITY. dal), puis sélectionnez **publier**.</span><span class="sxs-lookup"><span data-stu-id="e7994-179">In **Solution Explorer**, right-click the ContosoUniversity project (not the ContosoUniversity.DAL project) and select **Publish**.</span></span>

<span data-ttu-id="e7994-180">L’Assistant **publier le site Web** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="e7994-180">The **Publish Web** wizard appears.</span></span>

![Publish_Web_wizard_Profile_tab](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image9.png)

<span data-ttu-id="e7994-182">Dans la liste déroulante, sélectionnez **&lt;nouveau...&gt;** .</span><span class="sxs-lookup"><span data-stu-id="e7994-182">In the drop-down list, select **&lt;New...&gt;**.</span></span>

<span data-ttu-id="e7994-183">Dans la boîte de dialogue **nouveau profil** , entrez « test », puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="e7994-183">In the **New Profile** dialog box, enter "Test", and then click **OK**.</span></span>

![New_Profile_dialog_box](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image10.png)

<span data-ttu-id="e7994-185">Ce nom est le même que le nœud central du fichier de transformation Web. test. config que vous avez créé précédemment.</span><span class="sxs-lookup"><span data-stu-id="e7994-185">This name is the same as the middle node of the Web.Test.config transform file that you created earlier.</span></span> <span data-ttu-id="e7994-186">Cette correspondance est ce qui entraîne l’application des transformations Web. test. config lorsque vous publiez à l’aide de ce profil.</span><span class="sxs-lookup"><span data-stu-id="e7994-186">This correspondence is what causes the Web.Test.config transformations to be applied when you publish by using this profile.</span></span>

<span data-ttu-id="e7994-187">L’Assistant passe automatiquement à l’onglet **connexion** .</span><span class="sxs-lookup"><span data-stu-id="e7994-187">The wizard automatically advances to the **Connection** tab.</span></span>

<span data-ttu-id="e7994-188">Dans la zone **URL du service** , entrez *localhost*.</span><span class="sxs-lookup"><span data-stu-id="e7994-188">In the **Service URL** box, enter *localhost*.</span></span>

<span data-ttu-id="e7994-189">Dans la zone **site/application** , entrez *Default Web site/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="e7994-189">In the **Site/application** box, enter *Default Web Site/ContosoUniversity*.</span></span>

<span data-ttu-id="e7994-190">Dans la zone **URL de destination** , entrez `http://localhost/ContosoUniversity`.</span><span class="sxs-lookup"><span data-stu-id="e7994-190">In the **Destination URL** box, enter `http://localhost/ContosoUniversity`.</span></span>

<span data-ttu-id="e7994-191">Le paramètre de l' **URL de destination** n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="e7994-191">The **Destination URL** setting isn't required.</span></span> <span data-ttu-id="e7994-192">Une fois le déploiement de l’application terminé, Visual Studio ouvre automatiquement votre navigateur par défaut à cette URL.</span><span class="sxs-lookup"><span data-stu-id="e7994-192">When Visual Studio finishes deploying the application, it automatically opens your default browser to this URL.</span></span> <span data-ttu-id="e7994-193">Si vous ne souhaitez pas que le navigateur s’ouvre automatiquement après le déploiement, laissez cette zone vide.</span><span class="sxs-lookup"><span data-stu-id="e7994-193">If you don't want the browser to open automatically after deployment, leave this box blank.</span></span>

![Publish_Web_wizard_Connection_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image11.png)

<span data-ttu-id="e7994-195">Cliquez sur **valider la connexion** pour vérifier que les paramètres sont corrects et que vous pouvez vous connecter à IIS sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="e7994-195">Click **Validate Connection** to verify that the settings are correct and you can connect to IIS on the local computer.</span></span>

<span data-ttu-id="e7994-196">Une coche verte vérifie que la connexion a réussi.</span><span class="sxs-lookup"><span data-stu-id="e7994-196">A green check mark verifies that the connection is successful.</span></span>

![Publish_Web_wizard_Connection_tab_validated](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image12.png)

<span data-ttu-id="e7994-198">Cliquez sur **suivant** pour passer à l’onglet **paramètres** .</span><span class="sxs-lookup"><span data-stu-id="e7994-198">Click **Next** to advance to the **Settings** tab.</span></span>

<span data-ttu-id="e7994-199">La zone de liste déroulante **configuration** spécifie la configuration de build à déployer.</span><span class="sxs-lookup"><span data-stu-id="e7994-199">The **Configuration** drop-down box specifies the build configuration to deploy.</span></span> <span data-ttu-id="e7994-200">La valeur par défaut est Release, ce que vous voulez.</span><span class="sxs-lookup"><span data-stu-id="e7994-200">The default value is Release, which is what you want.</span></span>

<span data-ttu-id="e7994-201">Laissez la case à cocher **Supprimer les fichiers supplémentaires à la destination** désactivée.</span><span class="sxs-lookup"><span data-stu-id="e7994-201">Leave the **Remove additional files at destination** check box cleared.</span></span> <span data-ttu-id="e7994-202">Étant donné qu’il s’agit de votre premier déploiement, il n’y aura pas encore de fichiers dans le dossier de destination.</span><span class="sxs-lookup"><span data-stu-id="e7994-202">Since this is your first deployment, there won't be any files in the destination folder yet.</span></span>

<span data-ttu-id="e7994-203">Dans la section **bases de données** , entrez la valeur suivante dans la zone chaîne de connexion pour **SchoolContext**:</span><span class="sxs-lookup"><span data-stu-id="e7994-203">In the **Databases** section, enter the following value in the connection string box for **SchoolContext**:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample3.cmd)]

<span data-ttu-id="e7994-204">Le processus de déploiement placera cette chaîne de connexion dans le fichier Web. config déployé, car **utiliser cette chaîne de connexion au moment** de l’exécution est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e7994-204">The deployment process will put this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

<span data-ttu-id="e7994-205">Également sous **SchoolContext**, sélectionnez **appliquer migrations code First**.</span><span class="sxs-lookup"><span data-stu-id="e7994-205">Also under **SchoolContext**, select **Apply Code First Migrations**.</span></span> <span data-ttu-id="e7994-206">Avec cette option, le processus de déploiement configure le fichier Web. config déployé pour spécifier l’initialiseur de `MigrateDatabaseToLatestVersion`.</span><span class="sxs-lookup"><span data-stu-id="e7994-206">This option causes the deployment process to configure the deployed Web.config file to specify the `MigrateDatabaseToLatestVersion` initializer.</span></span> <span data-ttu-id="e7994-207">Cet initialiseur met automatiquement à jour la base de données avec la version la plus récente lorsque l’application accède pour la première fois à la base de données après le déploiement.</span><span class="sxs-lookup"><span data-stu-id="e7994-207">This initializer automatically updates the database to the latest version when the application accesses the database for the first time after deployment.</span></span>

<span data-ttu-id="e7994-208">Dans la zone chaîne de connexion pour **DefaultConnection**, entrez la valeur suivante :</span><span class="sxs-lookup"><span data-stu-id="e7994-208">In the connection string box for **DefaultConnection**, enter the following value:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample4.cmd)]

<span data-ttu-id="e7994-209">Laissez **mettre à jour la base de données** vide.</span><span class="sxs-lookup"><span data-stu-id="e7994-209">Leave **Update database** cleared.</span></span> <span data-ttu-id="e7994-210">La base de données d’appartenance sera déployée en copiant le fichier. sdf dans l’application\_données, et vous ne souhaitez pas que le processus de déploiement fasse quoi que ce soit d’autre avec cette base de données.</span><span class="sxs-lookup"><span data-stu-id="e7994-210">The membership database will be deployed by copying the .sdf file in App\_Data, and you don't want the deployment process to do anything else with this database.</span></span>

![Publish_Web_wizard_Settings_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image13.png)

<span data-ttu-id="e7994-212">Cliquez sur **suivant** pour passer à l’onglet **Aperçu** .</span><span class="sxs-lookup"><span data-stu-id="e7994-212">Click **Next** to advance to the **Preview** tab.</span></span>

<span data-ttu-id="e7994-213">Dans l’onglet **Aperçu** , cliquez sur **Démarrer l’aperçu** pour afficher la liste des fichiers qui seront copiés.</span><span class="sxs-lookup"><span data-stu-id="e7994-213">In the **Preview** tab, click **Start Preview** to see a list of the files that will be copied.</span></span>

![Publish_Web_wizard_Preview_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image14.png)

![Publish_Web_wizard_Preview_tab_Test_with_file_list](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image15.png)

<span data-ttu-id="e7994-216">Cliquez sur **Publier**.</span><span class="sxs-lookup"><span data-stu-id="e7994-216">Click **Publish**.</span></span>

<span data-ttu-id="e7994-217">Si Visual Studio n’est pas en mode administrateur, vous pouvez obtenir un message d’erreur qui indique une erreur d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="e7994-217">If Visual Studio is not in administrator mode, you might get an error message that indicates a permissions error.</span></span> <span data-ttu-id="e7994-218">Dans ce cas, fermez Visual Studio, ouvrez-le en mode administrateur, puis réessayez de publier.</span><span class="sxs-lookup"><span data-stu-id="e7994-218">In that case, close Visual Studio, open it in administrator mode, and try to publish again.</span></span>

<span data-ttu-id="e7994-219">Si Visual Studio est en mode administrateur, la fenêtre **sortie** signale la réussite de la génération et de la publication.</span><span class="sxs-lookup"><span data-stu-id="e7994-219">If Visual Studio is in administrator mode, the **Output** window reports successful build and publish.</span></span>

![Output_window_publish_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image16.png)

<span data-ttu-id="e7994-221">Le navigateur s’ouvre automatiquement sur l’ordinateur local à partir de la page d’hébergement de Contoso University qui s’exécute dans IIS.</span><span class="sxs-lookup"><span data-stu-id="e7994-221">The browser automatically opens to the Contoso University Home page running in IIS on the local computer.</span></span>

<span data-ttu-id="e7994-222">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-222">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image17.png)</span></span>

## <a name="testing-in-the-test-environment"></a><span data-ttu-id="e7994-223">Test dans l’environnement de test</span><span class="sxs-lookup"><span data-stu-id="e7994-223">Testing in the Test Environment</span></span>

<span data-ttu-id="e7994-224">Notez que l’indicateur d’environnement affiche « (test) » au lieu de « (dev) », qui indique que la transformation *Web. config* de l’indicateur d’environnement a réussi.</span><span class="sxs-lookup"><span data-stu-id="e7994-224">Notice that the environment indicator shows "(Test)" instead of "(Dev)", which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

<span data-ttu-id="e7994-225">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image20.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-225">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image20.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image19.png)</span></span>

<span data-ttu-id="e7994-226">Exécutez la page **students** pour vérifier que la base de données déployée ne dispose d’aucun étudiant.</span><span class="sxs-lookup"><span data-stu-id="e7994-226">Run the **Students** page to verify that the deployed database has no students.</span></span> <span data-ttu-id="e7994-227">Lorsque vous sélectionnez cette page, le chargement peut prendre quelques minutes, car Code First crée la base de données, puis exécute la méthode `Seed`.</span><span class="sxs-lookup"><span data-stu-id="e7994-227">When you select this page it may take a few minutes to load because Code First creates the database and then runs the `Seed` method.</span></span> <span data-ttu-id="e7994-228">(Ce n’est pas le cas lorsque vous étiez sur la page d’hébergement parce que l’application n’a pas encore essayé d’accéder à la base de données.)</span><span class="sxs-lookup"><span data-stu-id="e7994-228">(It didn't do that when you were on the home page because the application didn't try to access the database yet.)</span></span>

<span data-ttu-id="e7994-229">[![Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image22.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-229">[![Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image22.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image21.png)</span></span>

<span data-ttu-id="e7994-230">Exécutez la page des **enseignants** pour vérifier que code First amorcé la base de données avec les données de l’instructeur :</span><span class="sxs-lookup"><span data-stu-id="e7994-230">Run the **Instructors** page to verify that Code First seeded the database with instructor data:</span></span>

<span data-ttu-id="e7994-231">[![Instructors_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image24.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-231">[![Instructors_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image24.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image23.png)</span></span>

<span data-ttu-id="e7994-232">Sélectionnez **Ajouter des élèves** dans le menu **élèves** , ajoutez un étudiant, puis affichez le nouvel étudiant dans la page des **étudiants** pour vérifier que vous pouvez écrire correctement dans la base de données :</span><span class="sxs-lookup"><span data-stu-id="e7994-232">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database:</span></span>

<span data-ttu-id="e7994-233">[![Add_Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image26.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-233">[![Add_Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image26.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image25.png)</span></span>

<span data-ttu-id="e7994-234">[![Students_page_with_new_student_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image28.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-234">[![Students_page_with_new_student_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image28.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image27.png)</span></span>

<span data-ttu-id="e7994-235">Dans le menu **cours** , sélectionnez **mettre à jour les crédits**.</span><span class="sxs-lookup"><span data-stu-id="e7994-235">From the **Courses** menu, select **Update Credits**.</span></span> <span data-ttu-id="e7994-236">La page **mettre à jour les crédits** requiert des autorisations d’administrateur, donc la page **de connexion** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="e7994-236">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="e7994-237">Entrez les informations d’identification du compte d’administrateur que vous avez créées précédemment (« admin » et « pas $ w0rd »).</span><span class="sxs-lookup"><span data-stu-id="e7994-237">Enter the administrator account credentials that you created earlier ("admin" and "Pas$w0rd").</span></span> <span data-ttu-id="e7994-238">La page **mettre à jour les crédits** s’affiche, qui vérifie que le compte d’administrateur que vous avez créé dans le didacticiel précédent a été correctement déployé dans l’environnement de test.</span><span class="sxs-lookup"><span data-stu-id="e7994-238">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="e7994-239">[![Log_In_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image30.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-239">[![Log_In_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image30.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image29.png)</span></span>

<span data-ttu-id="e7994-240">[![Update_Credits_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image32.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-240">[![Update_Credits_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image32.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image31.png)</span></span>

<span data-ttu-id="e7994-241">Vérifiez qu’un dossier *ELMAH* existe uniquement avec le fichier d’espace réservé.</span><span class="sxs-lookup"><span data-stu-id="e7994-241">Verify that an *Elmah* folder exists with only the placeholder file in it.</span></span>

<span data-ttu-id="e7994-242">[![Elmah_folder_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image34.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="e7994-242">[![Elmah_folder_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image34.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image33.png)</span></span>

<a id="efcfmigrations"></a>

## <a name="reviewing-the-automatic-webconfig-changes-for-code-first-migrations"></a><span data-ttu-id="e7994-243">Examen des modifications automatiques de Web. config pour Migrations Code First</span><span class="sxs-lookup"><span data-stu-id="e7994-243">Reviewing the Automatic Web.config Changes for Code First Migrations</span></span>

<span data-ttu-id="e7994-244">Ouvrez le fichier *Web. config* dans l’application déployée sur *C:\inetpub\wwwroot\ContosoUniversity* . vous pouvez voir où le processus de déploiement a configuré migrations code First pour mettre à jour automatiquement la base de données vers la dernière version.</span><span class="sxs-lookup"><span data-stu-id="e7994-244">Open the *Web.config* file in the deployed application at *C:\inetpub\wwwroot\ContosoUniversity* and you can see where the deployment process configured Code First Migrations to automatically update the database to the latest version.</span></span>

![](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image35.png)

<span data-ttu-id="e7994-245">Le processus de déploiement a également créé une nouvelle chaîne de connexion pour Migrations Code First à utiliser exclusivement pour la mise à jour du schéma de base de données :</span><span class="sxs-lookup"><span data-stu-id="e7994-245">The deployment process also created a new connection string for Code First Migrations to use exclusively for updating the database schema:</span></span>

![DatabasePublish_connection_string](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image36.png)

<span data-ttu-id="e7994-247">Cette chaîne de connexion supplémentaire vous permet de spécifier un compte d’utilisateur pour les mises à jour de schéma de base de données et un autre compte d’utilisateur pour l’accès aux données d’application.</span><span class="sxs-lookup"><span data-stu-id="e7994-247">This additional connection string enables you to specify one user account for database schema updates, and a different user account for application data access.</span></span> <span data-ttu-id="e7994-248">Par exemple, vous pouvez attribuer le rôle de propriétaire de la base de\_dB à Migrations Code First et DB\_DataReader et DB\_des rôles DataWriter à l’application.</span><span class="sxs-lookup"><span data-stu-id="e7994-248">For example, you could assign the db\_owner role to Code First Migrations, and db\_datareader and db\_datawriter roles to the application.</span></span> <span data-ttu-id="e7994-249">Il s’agit d’un modèle de défense en profondeur courant qui empêche le code potentiellement malveillant dans l’application de modifier le schéma de base de données.</span><span class="sxs-lookup"><span data-stu-id="e7994-249">This is a common defense-in-depth pattern that prevents potentially malicious code in the application from changing the database schema.</span></span> <span data-ttu-id="e7994-250">(Par exemple, cela peut se produire dans le cas d’une attaque par injection SQL réussie.) Ce modèle n’est pas utilisé par ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="e7994-250">(For example, this might happen in a successful SQL injection attack.) This pattern is not used by these tutorials.</span></span> <span data-ttu-id="e7994-251">Il ne s’applique pas à SQL Server Compact, et il ne s’applique pas lorsque vous migrez vers SQL Server dans un didacticiel ultérieur de cette série.</span><span class="sxs-lookup"><span data-stu-id="e7994-251">It does not apply to SQL Server Compact, and it does not apply when you migrate to SQL Server in a later tutorial in this series.</span></span> <span data-ttu-id="e7994-252">Le site Cytanium offre un seul compte d’utilisateur pour accéder à la base de données SQL Server que vous créez sur Cytanium.</span><span class="sxs-lookup"><span data-stu-id="e7994-252">The Cytanium site offers just one user account for accessing the SQL Server database that you create at Cytanium.</span></span> <span data-ttu-id="e7994-253">Si vous êtes en mesure d’implémenter ce modèle dans votre scénario, vous pouvez le faire en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="e7994-253">If you are able to implement this pattern in your scenario, you can do it by performing the following steps:</span></span>

1. <span data-ttu-id="e7994-254">Dans l’onglet **paramètres** de l’Assistant **publier le site Web** , entrez la chaîne de connexion qui spécifie un utilisateur disposant d’autorisations de mise à jour complète du schéma de base de données et désactivez la case à cocher **utiliser cette chaîne de connexion au moment** de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e7994-254">In the **Settings** tab of the **Publish Web** wizard, enter the connection string that specifies a user with full database schema update permissions, and clear the **Use this connection string at runtime** check box.</span></span> <span data-ttu-id="e7994-255">Dans le fichier Web. config déployé, il s’agit de la chaîne de connexion `DatabasePublish`.</span><span class="sxs-lookup"><span data-stu-id="e7994-255">In the deployed Web.config file, this becomes the `DatabasePublish` connection string.</span></span>
2. <span data-ttu-id="e7994-256">Créez une transformation de fichier Web. config pour la chaîne de connexion que vous souhaitez que l’application utilise au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e7994-256">Create a Web.config file transformation for the connection string that you want the application to use at run time.</span></span>

<span data-ttu-id="e7994-257">Vous avez maintenant déployé votre application sur IIS sur votre ordinateur de développement et vous l’avez testée ici.</span><span class="sxs-lookup"><span data-stu-id="e7994-257">You have now deployed your application to IIS on your development computer and tested it there.</span></span> <span data-ttu-id="e7994-258">Cela permet de vérifier que le processus de déploiement a copié le contenu de l’application à l’emplacement approprié (à l’exclusion des fichiers que vous ne souhaitez pas déployer) et que Web Deploy configuré IIS correctement au cours du déploiement.</span><span class="sxs-lookup"><span data-stu-id="e7994-258">This verifies that the deployment process copied the application's content to the right location (excluding the files that you did not want to deploy), and also that Web Deploy configured IIS correctly during deployment.</span></span> <span data-ttu-id="e7994-259">Dans le didacticiel suivant, vous allez exécuter un test supplémentaire qui recherche une tâche de déploiement qui n’a pas encore été effectuée : définition des autorisations de dossier sur le dossier *ELMAH* .</span><span class="sxs-lookup"><span data-stu-id="e7994-259">In the next tutorial, you'll run one more test that finds a deployment task that has not yet been done: setting folder permissions on the *Elmah* folder.</span></span>

## <a name="more-information"></a><span data-ttu-id="e7994-260">Plus d’informations</span><span class="sxs-lookup"><span data-stu-id="e7994-260">More Information</span></span>

<span data-ttu-id="e7994-261">Pour plus d’informations sur l’exécution d’IIS ou de IIS Express dans Visual Studio, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="e7994-261">For information about running IIS or IIS Express in Visual Studio, see the following resources:</span></span>

- <span data-ttu-id="e7994-262">[IIS Express vue d’ensemble](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) du site IIS.net.</span><span class="sxs-lookup"><span data-stu-id="e7994-262">[IIS Express Overview](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) on the IIS.net site.</span></span>
- <span data-ttu-id="e7994-263">[Présentation de IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) sur le blog de Scott Guthrie.</span><span class="sxs-lookup"><span data-stu-id="e7994-263">[Introducing IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) on Scott Guthrie's blog.</span></span>
- <span data-ttu-id="e7994-264">[Comment : spécifier le serveur Web pour les projets Web dans Visual Studio](https://msdn.microsoft.com/library/ms178108.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7994-264">[How to: Specify the Web Server for Web Projects in Visual Studio](https://msdn.microsoft.com/library/ms178108.aspx).</span></span>
- <span data-ttu-id="e7994-265">[Principales différences entre IIS et le serveur de développement ASP.net](../deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) sur le site ASP.net.</span><span class="sxs-lookup"><span data-stu-id="e7994-265">[Core Differences Between IIS and the ASP.NET Development Server](../deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) on the ASP.NET site.</span></span>
- <span data-ttu-id="e7994-266">[Testez votre Application ASP.NET MVC ou Web Forms sur IIS 7 en 30 secondes](https://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30-seconds.aspx) sur le blog de Rick Anderson.</span><span class="sxs-lookup"><span data-stu-id="e7994-266">[Test your ASP.NET MVC or Web Forms Application on IIS 7 in 30 seconds](https://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30-seconds.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="e7994-267">Cette entrée fournit des exemples de la façon dont les tests avec le Serveur Visual Studio Development (Cassini) ne sont pas aussi fiables que les tests dans IIS Express et pourquoi le test dans IIS Express n’est pas aussi fiable que le test dans IIS.</span><span class="sxs-lookup"><span data-stu-id="e7994-267">This entry provides examples of why testing with the Visual Studio Development Server (Cassini) is not as reliable as testing in IIS Express, and why testing in IIS Express is not as reliable as testing in IIS.</span></span>

<span data-ttu-id="e7994-268">Pour plus d’informations sur les problèmes susceptibles de survenir lorsque votre application s’exécute dans un niveau de confiance moyen, consultez [hébergement d’Applications ASP.net en confiance moyenne](http://www.4guysfromrolla.com/articles/100307-1.aspx) sur les 4 Guys à partir du site Rolla.</span><span class="sxs-lookup"><span data-stu-id="e7994-268">For information about what issues might arise when your application runs in medium trust, see [Hosting ASP.NET Applications in Medium Trust](http://www.4guysfromrolla.com/articles/100307-1.aspx) on the 4 Guys from Rolla site.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e7994-269">[Précédent](deployment-to-a-hosting-provider-configuring-project-properties-4-of-12.md)
> [Suivant](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)</span><span class="sxs-lookup"><span data-stu-id="e7994-269">[Previous](deployment-to-a-hosting-provider-configuring-project-properties-4-of-12.md)
[Next](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)</span></span>
