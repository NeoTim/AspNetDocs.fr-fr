---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: Interaction avec la Page maître depuis la Page de contenu (VB) | Microsoft Docs
author: rick-anderson
description: Examine la manière d’appeler des méthodes, définissez des propriétés, etc. de la Page maître à partir du code dans la Page de contenu.
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 59a00305cdcaf41ac0b37649382b9c3dc9ce1b0c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57047646"
---
<a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="ef77d-103">Interaction avec la page de contenu à partir de la page maître (VB)</span><span class="sxs-lookup"><span data-stu-id="ef77d-103">Interacting with the Master Page from the Content Page (VB)</span></span>
====================
<span data-ttu-id="ef77d-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ef77d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ef77d-105">[Télécharger le Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) ou [télécharger le PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="ef77d-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="ef77d-106">Examine la manière d’appeler des méthodes, définissez des propriétés, etc. de la Page maître à partir du code dans la Page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="ef77d-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="ef77d-107">Introduction</span></span>

<span data-ttu-id="ef77d-108">Au cours des cinq derniers didacticiels, nous avons examiné comment créer une page maître, définir des zones de contenu, lier des pages ASP.NET à une page maître et définissent le contenu spécifique à la page.</span><span class="sxs-lookup"><span data-stu-id="ef77d-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="ef77d-109">Lorsqu’un visiteur demande une page de contenu particulier, le contenu et le balisage des pages maîtres sont fusionnés lors de l’exécution, ce qui entraîne le rendu d’une hiérarchie de contrôle unifié.</span><span class="sxs-lookup"><span data-stu-id="ef77d-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="ef77d-110">Par conséquent, nous avons déjà vu une manière qui la page maître et celle de ses pages de contenu peuvent interagir : la page de contenu énonce le balisage à transfuse dans les contrôles ContentPlaceHolder de la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="ef77d-111">Ce que nous avons encore à examiner est comment la page maître et la page de contenu peuvent interagir par programmation.</span><span class="sxs-lookup"><span data-stu-id="ef77d-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="ef77d-112">En plus de définir le balisage pour les contrôles ContentPlaceHolder de la page maître, une page de contenu peut également affecter des valeurs aux propriétés publiques de sa page maître et appeler ses méthodes publiques.</span><span class="sxs-lookup"><span data-stu-id="ef77d-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="ef77d-113">De même, une page maître peut interagir avec ses pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="ef77d-114">Alors que les interactions par programme entre une page maître et le contenu est moins fréquentes que l’interaction entre les marques de leurs déclaratifs, il existe de nombreux scénarios où ces interactions par programme sont nécessaire.</span><span class="sxs-lookup"><span data-stu-id="ef77d-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="ef77d-115">Dans ce didacticiel, nous allons examiner comment une page de contenu peut interagir par programmation avec sa page maître ; dans le didacticiel suivant, nous allons examiner comment la page maître peut même interagir avec ses pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="ef77d-116">Exemples de l’Interaction entre une Page de contenu et sa Page maître par programmation</span><span class="sxs-lookup"><span data-stu-id="ef77d-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="ef77d-117">Lorsqu’une région particulière d’une page doit être configurée sur une base de page par page, nous utilisons un contrôle ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="ef77d-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="ef77d-118">Mais qu’en est-il des situations où la majorité des pages doivent émettre une sortie certains, mais un petit nombre de pages pour le personnaliser pour afficher autre chose ?</span><span class="sxs-lookup"><span data-stu-id="ef77d-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="ef77d-119">Un exemple, que nous avons examiné dans le [ *ContentPlaceHolders multiples et par défaut contenu* ](multiple-contentplaceholders-and-default-content-vb.md) didacticiel, implique l’affichage d’une interface de connexion sur chaque page.</span><span class="sxs-lookup"><span data-stu-id="ef77d-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="ef77d-120">Bien que la plupart des pages doivent inclure une interface de connexion, elle doit être supprimée pour un certain nombre de pages, tels que : la page de connexion principale (`Login.aspx`) ; la page Créer un compte ; et les autres pages qui sont uniquement accessibles aux utilisateurs authentifiés.</span><span class="sxs-lookup"><span data-stu-id="ef77d-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="ef77d-121">Le [ *ContentPlaceHolders multiples et contenu par défaut* ](multiple-contentplaceholders-and-default-content-vb.md) didacticiel vous a montré comment définir le contenu par défaut pour un ContentPlaceHolder dans la page maître et puis comment substituer dans les pages où le contenu par défaut n’était pas voulu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="ef77d-122">Une autre option consiste à créer une propriété publique ou une méthode dans la page maître qui indique s’il faut afficher ou masquer l’interface de connexion.</span><span class="sxs-lookup"><span data-stu-id="ef77d-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="ef77d-123">Par exemple, la page maître peut inclure une propriété publique nommée `ShowLoginUI` dont la valeur a été utilisée pour définir le `Visible` propriété du contrôle de connexion dans la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="ef77d-124">Ces pages de contenu où l’interface utilisateur de connexion doit être supprimée peut ensuite par programmation définir le `ShowLoginUI` propriété `False`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="ef77d-125">Par exemple, l’exemple le plus courant de contenu et l’interaction de la page maître se produit lorsque les données affichées dans la page maître doit être actualisé après qu’une action a été dépassé dans la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="ef77d-126">Imaginez une page maître qui inclut un GridView qui affiche les cinq plus récemment ajouté des enregistrements à partir d’une table de base de données particulière et que l’une des ses pages de contenu inclut une interface pour l’ajout de nouveaux enregistrements à cette table.</span><span class="sxs-lookup"><span data-stu-id="ef77d-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="ef77d-127">Lorsqu’un utilisateur visite la page pour ajouter un nouvel enregistrement, il voit que les cinq récemment ajoutées enregistrements affichés dans la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="ef77d-128">Après avoir renseigné les valeurs pour les colonnes du nouvel enregistrement, elle envoie le formulaire.</span><span class="sxs-lookup"><span data-stu-id="ef77d-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="ef77d-129">En supposant que le contrôle GridView dans la page maître a son `EnableViewState` propriété définie sur True (valeur par défaut), son contenu est rechargé à partir de l’état d’affichage et, par conséquent, les cinq mêmes enregistrements sont affichent, même si un enregistrement plus récent vient d’être ajouté à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="ef77d-130">Cela risque de perturber l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ef77d-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="ef77d-131">Même si vous désactivez l’état d’affichage du contrôle GridView afin qu’il relie à sa source de données sous-jacente à chaque publication, il toujours n’indiquent pas l’enregistrement ajouté juste car les données sont liées au GridView plus tôt dans le cycle de vie de page que lorsque le nouvel enregistrement est ajouté à la datab ASE.</span><span class="sxs-lookup"><span data-stu-id="ef77d-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>


<span data-ttu-id="ef77d-132">Pour résoudre ce problème afin que l’enregistrement juste-ajouté s’affiche dans la page maître du GridView sur la publication (postback), nous devons indiquer le contrôle GridView à relier à sa source de données *après* le nouvel enregistrement a été ajouté à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="ef77d-133">Cela requiert une interaction entre le contenu et les pages maîtres, car l’interface pour ajouter que le nouvel enregistrement (et ses gestionnaires d’événements) se trouvent dans la page de contenu, mais le contrôle GridView qui doit être actualisé est dans la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="ef77d-134">Étant donné que l’actualisation d’affichage de la page maître à partir d’un gestionnaire d’événements dans la page de contenu fait partie des besoins plus courants pour le contenu et l’interaction de la page maître, nous allons Explorer ce sujet plus en détail.</span><span class="sxs-lookup"><span data-stu-id="ef77d-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="ef77d-135">Le téléchargement de ce didacticiel inclut une base de données Microsoft SQL Server 2005 Express Edition nommé `NORTHWIND.MDF` dans du site Web `App_Data` dossier.</span><span class="sxs-lookup"><span data-stu-id="ef77d-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="ef77d-136">La base de données Northwind stocke produit, employé et informations sur les ventes d’une société fictive, Northwind Traders.</span><span class="sxs-lookup"><span data-stu-id="ef77d-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="ef77d-137">Étape 1 présente cinq affichage plus récemment ajouté des produits dans un GridView dans la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="ef77d-138">Étape 2 crée une page de contenu pour l’ajout de nouveaux produits.</span><span class="sxs-lookup"><span data-stu-id="ef77d-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="ef77d-139">Étape 3 examine comment créer des propriétés et méthodes publiques dans la page maître et étape 4 illustre comment interagir par programmation avec ces propriétés et méthodes à partir de la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="ef77d-140">Ce didacticiel n’aborde pas des spécificités de l’utilisation des données dans ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ef77d-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="ef77d-141">Les étapes de configuration de la page maître afficher des données et la page de contenu pour l’insertion de données sont terminées, encore breezy.</span><span class="sxs-lookup"><span data-stu-id="ef77d-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="ef77d-142">Pour obtenir une présentation plus approfondie à l’affichage et insertion de données et l’utilisation des contrôles SqlDataSource et GridView, consultez les ressources dans la section relevés supplémentaire à la fin de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="ef77d-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>


## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="ef77d-143">Étape 1 : Afficher les cinq plus récemment ajouté les produits dans la Page maître</span><span class="sxs-lookup"><span data-stu-id="ef77d-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="ef77d-144">Ouvrez la page maître Site.master et ajoutez une étiquette et un contrôle GridView à la `leftContent` `<div>`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="ef77d-145">Désactivez out l’étiquette `Text` propriété, la valeur son `EnableViewState` propriété `False`et son `ID` propriété `GridMessage`; définir le GridView `ID` propriété `RecentProducts`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="ef77d-146">Ensuite, à partir du concepteur, développez la balise active le contrôle GridView et choisissez de le lier à une source de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="ef77d-147">Cette opération lance l’Assistant Configuration de Source de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="ef77d-148">Étant donné que la base de données Northwind dans la `App_Data` dossier est une base de données Microsoft SQL Server, choisissez de créer un SqlDataSource en sélectionnant (voir Figure 1) ; nommez SqlDataSource `RecentProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>


<span data-ttu-id="ef77d-149">[![Lier le contrôle GridView à un contrôle SqlDataSource nommé RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="ef77d-150">**Figure 01**: Lier le contrôle GridView à un contrôle SqlDataSource nommé `RecentProductsDataSource` ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>


<span data-ttu-id="ef77d-151">L’étape suivante nous demande de spécifier ce que la base de données pour se connecter à.</span><span class="sxs-lookup"><span data-stu-id="ef77d-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="ef77d-152">Choisissez le `NORTHWIND.MDF` de base de données de fichier à partir de la liste déroulante et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="ef77d-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="ef77d-153">Comme il s’agit de la première fois que nous avons utilisé cette base de données, l’Assistant propose stocker la chaîne de connexion dans `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="ef77d-154">Il a à stocker la chaîne de connexion en utilisant le nom `NorthwindConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>


<span data-ttu-id="ef77d-155">[![Se connecter à la base de données Northwind](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="ef77d-156">**Figure 02**: Se connecter à la base de données Northwind ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>


<span data-ttu-id="ef77d-157">L’Assistant Configurer la Source de données fournit deux moyens par lequel nous pouvons spécifier la requête utilisée pour récupérer des données :</span><span class="sxs-lookup"><span data-stu-id="ef77d-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="ef77d-158">En spécifiant une instruction SQL personnalisée ou une procédure stockée, ou</span><span class="sxs-lookup"><span data-stu-id="ef77d-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="ef77d-159">En choisissant une table ou vue, puis en spécifiant les colonnes à retourner</span><span class="sxs-lookup"><span data-stu-id="ef77d-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="ef77d-160">Étant donné que nous voulons renvoyer que simplement cinq récemment ajoutées des produits, nous devons spécifier une instruction SQL personnalisée.</span><span class="sxs-lookup"><span data-stu-id="ef77d-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="ef77d-161">Utilisez la commande suivante `SELECT` requête :</span><span class="sxs-lookup"><span data-stu-id="ef77d-161">Use the following `SELECT` query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="ef77d-162">Le `TOP 5` mot clé retourne uniquement les cinq premiers enregistrements de la requête.</span><span class="sxs-lookup"><span data-stu-id="ef77d-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="ef77d-163">Le `Products` clé primaire de la table, `ProductID`, est un `IDENTITY` colonne, ce qui nous permet de garantir que chaque produit de nouveau ajouté à la table a une valeur supérieure à l’entrée précédente.</span><span class="sxs-lookup"><span data-stu-id="ef77d-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="ef77d-164">Par conséquent, trier les résultats par `ProductID` dans l’ordre décroissant renvoie les produits compter le plus récemment créées.</span><span class="sxs-lookup"><span data-stu-id="ef77d-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>


<span data-ttu-id="ef77d-165">[![Retourner les cinq produits les plus récentes](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="ef77d-166">**Figure 03**: Retourner les cinq plus récemment ajouté produits ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>


<span data-ttu-id="ef77d-167">À l’issue de l’Assistant, Visual Studio génère deux BoundFields pour le contrôle GridView afficher le `ProductName` et `UnitPrice` champs renvoyés à partir de la base de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="ef77d-168">À ce stade le balisage déclaratif de votre page maître doit inclure balisage similaire à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="ef77d-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="ef77d-169">Comme vous pouvez le voir, le balisage contient : le contrôle Web Label (`GridMessage`) ; le contrôle GridView `RecentProducts`, avec deux BoundFields ; et un contrôle SqlDataSource qui renvoie les cinq plus récemment ajouté des produits.</span><span class="sxs-lookup"><span data-stu-id="ef77d-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="ef77d-170">Avec ce GridView créé et son contrôle SqlDataSource configuré, visitez le site Web via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="ef77d-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="ef77d-171">Comme le montre la Figure 4, vous verrez une grille dans l’angle inférieur gauche qui répertorie les cinq plus récemment ajouté des produits.</span><span class="sxs-lookup"><span data-stu-id="ef77d-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>


<span data-ttu-id="ef77d-172">[![Le contrôle GridView affiche cinq produits les plus récentes](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="ef77d-173">**Figure 04**: Le contrôle GridView affiche les cinq plus récemment ajouté produits ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>


> [!NOTE]
> <span data-ttu-id="ef77d-174">N’hésitez pas à nettoyer l’apparence du contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="ef77d-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="ef77d-175">Quelques suggestions incluent la mise en forme affichés `UnitPrice` valeur comme une devise et à l’aide de couleurs d’arrière-plan et polices pour améliorer l’apparence de la grille.</span><span class="sxs-lookup"><span data-stu-id="ef77d-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>


## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="ef77d-176">Étape 2 : Création d’une Page de contenu pour ajouter de nouveaux produits</span><span class="sxs-lookup"><span data-stu-id="ef77d-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="ef77d-177">La tâche suivante consiste à créer une page de contenu à partir de laquelle un utilisateur peut ajouter un nouveau produit à la `Products` table.</span><span class="sxs-lookup"><span data-stu-id="ef77d-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="ef77d-178">Ajoutez une nouvelle page de contenu pour le `Admin` dossier nommé `AddProduct.aspx`, veillez à lier à la `Site.master` page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="ef77d-179">La figure 5 illustre l’Explorateur de solutions, une fois que cette page a été ajoutée au site Web.</span><span class="sxs-lookup"><span data-stu-id="ef77d-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="ef77d-180">[![Ajouter une nouvelle Page ASP.NET dans le dossier Admin](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="ef77d-181">**Figure 05**: Ajoutez une nouvelle Page ASP.NET pour le `Admin` dossier ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>


<span data-ttu-id="ef77d-182">N’oubliez pas que dans le [ *spécifiant le titre, les balises Meta et les autres en-têtes HTML dans la Page maître* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) didacticiel, nous avons créé une classe de page de base personnalisée nommée `BasePage` qui a généré le titre de la page s’il s’agissait pas explicitement défini.</span><span class="sxs-lookup"><span data-stu-id="ef77d-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="ef77d-183">Accédez à la `AddProduct.aspx` code-behind de la page de classe et de la dériver de `BasePage` (au lieu d’à partir de `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="ef77d-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="ef77d-184">Enfin, mettez à jour le `Web.sitemap` fichier à inclure une entrée pour cette leçon.</span><span class="sxs-lookup"><span data-stu-id="ef77d-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="ef77d-185">Ajoutez le balisage suivant sous le `<siteMapNode>` pour la leçon les problèmes de nommage ID de contrôle :</span><span class="sxs-lookup"><span data-stu-id="ef77d-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>


[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="ef77d-186">Comme indiqué dans la Figure 6, l’ajout de ce `<siteMapNode>` élément apparaît dans la liste des leçons.</span><span class="sxs-lookup"><span data-stu-id="ef77d-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="ef77d-187">Retour à `AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="ef77d-188">Dans le contrôle de contenu pour le `MainContent` ContentPlaceHolder, ajoutez un contrôle DetailsView et nommez-le `NewProduct`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="ef77d-189">Lier le contrôle DetailsView à un nouveau contrôle SqlDataSource nommé `NewProductDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="ef77d-190">Comme avec SqlDataSource à l’étape 1, configurer l’Assistant afin qu’il utilise la base de données Northwind et choisir de spécifier une instruction SQL personnalisée.</span><span class="sxs-lookup"><span data-stu-id="ef77d-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="ef77d-191">Étant donné que le contrôle DetailsView doit être utilisé pour ajouter des éléments à la base de données, nous devons spécifier à la fois un `SELECT` instruction et un `INSERT` instruction.</span><span class="sxs-lookup"><span data-stu-id="ef77d-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="ef77d-192">Utilisez la commande suivante `SELECT` requête :</span><span class="sxs-lookup"><span data-stu-id="ef77d-192">Use the following `SELECT` query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="ef77d-193">Ensuite, ajoutez le code suivant à partir de l’onglet Insérer, `INSERT` instruction :</span><span class="sxs-lookup"><span data-stu-id="ef77d-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="ef77d-194">Après la fin de l’Assistant accédez à la balise active de DetailsView et cochez la case « Activer l’insertion ».</span><span class="sxs-lookup"><span data-stu-id="ef77d-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="ef77d-195">Cette opération ajoute une CommandField pour le contrôle DetailsView avec son `ShowInsertButton` propriété définie sur True.</span><span class="sxs-lookup"><span data-stu-id="ef77d-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="ef77d-196">Étant donné que cette DetailsView sera utilisé uniquement pour l’insertion de données, définissez le DetailsView `DefaultMode` propriété `Insert`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="ef77d-197">C’est aussi simple que cela !</span><span class="sxs-lookup"><span data-stu-id="ef77d-197">That's all there is to it!</span></span> <span data-ttu-id="ef77d-198">Nous allons tester cette page.</span><span class="sxs-lookup"><span data-stu-id="ef77d-198">Let's test this page.</span></span> <span data-ttu-id="ef77d-199">Visitez `AddProduct.aspx` via un navigateur, entrez un nom et le prix (voir Figure 6).</span><span class="sxs-lookup"><span data-stu-id="ef77d-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>


<span data-ttu-id="ef77d-200">[![Ajouter un nouveau produit à la base de données](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="ef77d-201">**Figure 06**: Ajouter un nouveau produit à la base de données ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>


<span data-ttu-id="ef77d-202">Après avoir tapé le nom et le prix de votre nouveau produit, cliquez sur le bouton d’insertion.</span><span class="sxs-lookup"><span data-stu-id="ef77d-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="ef77d-203">Ainsi, le formulaire à la publication (postback).</span><span class="sxs-lookup"><span data-stu-id="ef77d-203">This causes the form to postback.</span></span> <span data-ttu-id="ef77d-204">Lors de la de publication, le contrôle SqlDataSource `INSERT` instruction est exécutée ; ses deux paramètres sont remplis avec les valeurs entrées par l’utilisateur dans deux contrôles de zone de texte de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ef77d-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="ef77d-205">Malheureusement, il n’existe aucun retour visuel une insertion a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="ef77d-206">Il serait intéressant d’avoir un message affiché, confirmant qu’un nouvel enregistrement a été ajouté.</span><span class="sxs-lookup"><span data-stu-id="ef77d-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="ef77d-207">Je laisse cela en guise d’exercice pour le lecteur.</span><span class="sxs-lookup"><span data-stu-id="ef77d-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="ef77d-208">En outre, après avoir ajouté un nouvel enregistrement dans le contrôle DetailsView le contrôle GridView dans la page maître affiche toujours les cinq mêmes enregistrements qu’avant ; Il n’inclut pas l’enregistrement juste-ajouté.</span><span class="sxs-lookup"><span data-stu-id="ef77d-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="ef77d-209">Nous allons examiner comment résoudre ce problème dans les étapes à venir.</span><span class="sxs-lookup"><span data-stu-id="ef77d-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="ef77d-210">Outre l’ajout d’une forme d’une rétroaction visuelle qui l’insertion a réussi, je vous encourage également mettre à jour d’interface d’insertion de DetailsView pour inclure la validation.</span><span class="sxs-lookup"><span data-stu-id="ef77d-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="ef77d-211">Actuellement, il n’existe aucune validation.</span><span class="sxs-lookup"><span data-stu-id="ef77d-211">Currently, there is no validation.</span></span> <span data-ttu-id="ef77d-212">Si un utilisateur entre une valeur non valide pour le `UnitPrice` champ, tels que « trop coûteux, « une exception sera levée lors de la publication lorsque le système tente de convertir cette chaîne en un nombre décimal.</span><span class="sxs-lookup"><span data-stu-id="ef77d-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="ef77d-213">Pour plus d’informations sur la personnalisation de l’insertion de l’interface, reportez-vous à la [ *personnalisation de l’Interface de Modification de données* didacticiel](https://asp.net/learn/data-access/tutorial-20-vb.aspx) à partir de mon [utilisation de la série de didacticiels données](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="ef77d-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="ef77d-214">Étape 3 : Création de propriétés et méthodes publiques dans la Page maître</span><span class="sxs-lookup"><span data-stu-id="ef77d-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="ef77d-215">À l’étape 1, nous avons ajouté un contrôle Web Label nommé `GridMessage` ci-dessus le contrôle GridView dans la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="ef77d-216">Cette étiquette est destinée à afficher éventuellement un message.</span><span class="sxs-lookup"><span data-stu-id="ef77d-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="ef77d-217">Par exemple, après l’ajout d’un nouvel enregistrement à la `Products` table, que nous voulons afficher un message qui lit : «*ProductName* a été ajouté à la base de données. »</span><span class="sxs-lookup"><span data-stu-id="ef77d-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="ef77d-218">Au lieu de coder en dur le texte de cette étiquette dans la page maître, nous pourrions le message à être personnalisés par la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="ef77d-219">Étant donné que le contrôle d’étiquette est implémenté comme une variable membre protégée au sein de la page maître que n’est pas accessible directement à partir de pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="ef77d-220">Pour pouvoir fonctionner avec l’étiquette au sein d’une page maître à partir de la page de contenu (ou, d’ailleurs, n’importe quel contrôle Web dans la page maître) nous devons créer une propriété publique dans la page maître qui expose le contrôle Web ou sert de proxy par lequel une de ses propriétés peut être  accessible.</span><span class="sxs-lookup"><span data-stu-id="ef77d-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="ef77d-221">Ajoutez la syntaxe suivante à la classe de code-behind de la page maître pour exposer l’étiquette `Text` propriété :</span><span class="sxs-lookup"><span data-stu-id="ef77d-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="ef77d-222">Lorsqu’un nouvel enregistrement est ajouté à la `Products` table à partir d’une page de contenu le `RecentProducts` GridView dans la page maître a besoin relier à sa source de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="ef77d-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="ef77d-223">Pour relier l’appel de GridView son `DataBind` (méthode).</span><span class="sxs-lookup"><span data-stu-id="ef77d-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="ef77d-224">Étant donné que le contrôle GridView dans la page maître n’est pas accessible par programme pour les pages de contenu, nous devez créer une méthode publique dans la page maître, lorsqu’elle est appelée, relie les données au GridView.</span><span class="sxs-lookup"><span data-stu-id="ef77d-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="ef77d-225">Ajoutez la méthode suivante à la classe de code-behind de la page maître :</span><span class="sxs-lookup"><span data-stu-id="ef77d-225">Add the following method to the master page's code-behind class:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="ef77d-226">Avec le `GridMessageText` propriété et `RefreshRecentProductsGrid` méthode en place, n’importe quelle page de contenu peut par programmation définir ou lire la valeur de la `GridMessage` l’étiquette `Text` propriété ou lier de nouveau les données à le `RecentProducts` GridView.</span><span class="sxs-lookup"><span data-stu-id="ef77d-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="ef77d-227">Étape 4 examine comment accéder aux propriétés publiques et les méthodes de la page maître à partir d’une page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="ef77d-228">N’oubliez pas de marquer des propriétés et des méthodes en tant que la page maître `Public`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="ef77d-229">Si vous ne désignez pas des explicitement ces propriétés et méthodes en tant que `Public`, ils ne seront plus accessibles à partir de la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>


## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="ef77d-230">Étape 4 : Appel des membres publics de la Page maître à partir d’une Page de contenu</span><span class="sxs-lookup"><span data-stu-id="ef77d-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="ef77d-231">Maintenant que la page maître a les propriétés publiques nécessaires et les méthodes, nous sommes prêts à appeler ces propriétés et méthodes à partir de la `AddProduct.aspx` page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="ef77d-232">Plus précisément, nous devons définir la page maître `GridMessageText` propriété et appelez ses `RefreshRecentProductsGrid` méthode une fois que le nouveau produit a été ajouté à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="ef77d-233">Tous les contrôles de Web ASP.NET données déclenchent des événements juste avant et après l’exécution de différentes tâches, qui permettent de facilement pour les développeurs de pages de prendre des mesures par programmation avant ou après la tâche.</span><span class="sxs-lookup"><span data-stu-id="ef77d-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="ef77d-234">Par exemple, lorsque l’utilisateur final clique sur un bouton Insérer de DetailsView, de publication (postback) du contrôle DetailsView déclenche son `ItemInserting` événement avant de commencer l’insertion du flux de travail.</span><span class="sxs-lookup"><span data-stu-id="ef77d-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="ef77d-235">Il insère ensuite l’enregistrement dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-235">It then inserts the record into the database.</span></span> <span data-ttu-id="ef77d-236">Ensuite, le contrôle DetailsView déclenche son `ItemInserted` événement.</span><span class="sxs-lookup"><span data-stu-id="ef77d-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="ef77d-237">Par conséquent, pour utiliser la page maître une fois que le nouveau produit a été ajouté, créer un gestionnaire d’événements pour le DetailsView `ItemInserted` événement.</span><span class="sxs-lookup"><span data-stu-id="ef77d-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="ef77d-238">Il existe une page de contenu peut interagir par programmation avec sa page maître de deux manières :</span><span class="sxs-lookup"><span data-stu-id="ef77d-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="ef77d-239">À l’aide de la `Page.Master` propriété, qui retourne une référence faiblement typée à la page maître, ou</span><span class="sxs-lookup"><span data-stu-id="ef77d-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="ef77d-240">Spécifiez le chemin de type ou le fichier de page maître par le biais de la page un `@MasterType` directive ; cela ajoute automatiquement une propriété fortement typée vers la page nommée `Master`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="ef77d-241">Commençons par examiner les deux approches.</span><span class="sxs-lookup"><span data-stu-id="ef77d-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="ef77d-242">À l’aide de la faiblement typé`Page.Master`propriété</span><span class="sxs-lookup"><span data-stu-id="ef77d-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="ef77d-243">Toutes les pages de web ASP.NET doit dériver de la `Page` (classe), qui se trouve dans le `System.Web.UI` espace de noms.</span><span class="sxs-lookup"><span data-stu-id="ef77d-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="ef77d-244">Le `Page` classe inclut un [ `Master` propriété](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) qui retourne une référence à la page maître de la page.</span><span class="sxs-lookup"><span data-stu-id="ef77d-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="ef77d-245">Si la page n’a pas d’une page maître `Master` retourne `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="ef77d-246">Le `Master` propriété retourne un objet de type [ `MasterPage` ](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (également située dans le `System.Web.UI` espace de noms) qui est le type de base dont dérivent toutes les pages maîtres à partir de.</span><span class="sxs-lookup"><span data-stu-id="ef77d-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="ef77d-247">Par conséquent, à l’utilisation des propriétés publiques ou les méthodes définies dans la page maître de notre site Web nous devons effectuer un cast du `MasterPage` objet retourné par la `Master` propriété vers le type approprié.</span><span class="sxs-lookup"><span data-stu-id="ef77d-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="ef77d-248">Étant donné que nous avons nommé notre fichier de page maître `Site.master`, la classe code-behind s’appelait `Site`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="ef77d-249">Par conséquent, le code suivant convertit le `Page.Master` propriété à une instance de la `Site` classe.</span><span class="sxs-lookup"><span data-stu-id="ef77d-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="ef77d-250">Maintenant que nous avons converti la faiblement typé `Page.Master` propriété au type de Site, nous pouvons référencer les propriétés et méthodes spécifiques au Site.</span><span class="sxs-lookup"><span data-stu-id="ef77d-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="ef77d-251">Comme le montre la Figure 7, la propriété publique `GridMessageText` apparaît dans la liste déroulante IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="ef77d-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>


<span data-ttu-id="ef77d-252">[![IntelliSense affiche notre Page principale propriétés et méthodes publiques](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="ef77d-253">**Figure 07**: IntelliSense affiche notre Page principale propriétés et méthodes publiques ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>


> [!NOTE]
> <span data-ttu-id="ef77d-254">Si vous avez nommé votre fichier de page maître `MasterPage.master` , nom de la classe code-behind de la page maître est `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="ef77d-255">Cela peut entraîner des code ambiguë lors de la conversion du type `System.Web.UI.MasterPage` à votre `MasterPage` classe.</span><span class="sxs-lookup"><span data-stu-id="ef77d-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="ef77d-256">En bref, vous devez qualifier complètement le type que vous effectuez un cast, ce qui peut être un peu difficile lorsque vous utilisez le modèle de projet de Site Web.</span><span class="sxs-lookup"><span data-stu-id="ef77d-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="ef77d-257">Je vous suggère consisterait à faire en sorte que lorsque vous créez votre page maître vous il donnez un nom autre que `MasterPage.master` ou, mieux encore, créez une référence fortement typée à la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>


### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="ef77d-258">Création d’une référence fortement typée avec la`@MasterType`(Directive)</span><span class="sxs-lookup"><span data-stu-id="ef77d-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="ef77d-259">Si vous examinez attentivement, vous pouvez voir que classe de code-behind d’une page ASP.NET est une classe partielle (Notez le `Partial` mot clé dans la définition de classe).</span><span class="sxs-lookup"><span data-stu-id="ef77d-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="ef77d-260">Classes partielles ont été introduits dans C# et Visual Basic avec.NET Framework 2.0 et, en bref, permettant aux membres d’une classe à être définie dans plusieurs fichiers.</span><span class="sxs-lookup"><span data-stu-id="ef77d-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="ef77d-261">Le fichier de classe code-behind - `AddProduct.aspx.vb`, par exemple - contient le code que nous, le développeur de pages, créez.</span><span class="sxs-lookup"><span data-stu-id="ef77d-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="ef77d-262">En plus de notre code, le moteur ASP.NET crée automatiquement un fichier de classe distincte avec des propriétés et gestionnaires d’événements qui traduisent par le balisage déclaratif hiérarchie de classe de la page.</span><span class="sxs-lookup"><span data-stu-id="ef77d-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="ef77d-263">La génération de code automatique qui se produit chaque fois qu’une page ASP.NET est visitée la voie pour certaines possibilités plutôt intéressant et utiles.</span><span class="sxs-lookup"><span data-stu-id="ef77d-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="ef77d-264">Dans le cas des pages maîtres, si nous indiquent au moteur de ASP.NET quelle page maître est utilisé par notre page de contenu, cela génère un fortement typée `Master` propriété pour nous.</span><span class="sxs-lookup"><span data-stu-id="ef77d-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="ef77d-265">Utilisez le [ `@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) pour informer le moteur ASP.NET de type de page maître de la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="ef77d-266">Le `@MasterType` directive peut accepter le nom de type de la page maître ou son chemin d’accès de fichier.</span><span class="sxs-lookup"><span data-stu-id="ef77d-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="ef77d-267">Pour spécifier que le `AddProduct.aspx` page utilise `Site.master` comme sa page maître, ajoutez la directive suivante en haut du `AddProduct.aspx`:</span><span class="sxs-lookup"><span data-stu-id="ef77d-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="ef77d-268">Cette directive indique au moteur d’ASP.NET pour ajouter une référence fortement typée à la page maître via une propriété nommée `Master`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="ef77d-269">Avec le `@MasterType` directive en place, nous pouvons appeler le `Site.master` maître de la page Propriétés et méthodes publiques directement via le `Master` propriété sans toutes les conversions.</span><span class="sxs-lookup"><span data-stu-id="ef77d-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="ef77d-270">Si vous omettez le `@MasterType` directive, la syntaxe `Page.Master` et `Master` retournent la même chose : un objet faiblement typé à la page maître de la page.</span><span class="sxs-lookup"><span data-stu-id="ef77d-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="ef77d-271">Si vous incluez le `@MasterType` directive puis `Master` retourne une référence fortement typée à la page maître spécifiée.</span><span class="sxs-lookup"><span data-stu-id="ef77d-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="ef77d-272">`Page.Master`, cependant, retourne toujours une référence faiblement typée.</span><span class="sxs-lookup"><span data-stu-id="ef77d-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="ef77d-273">Pour examiner plus poussée pourquoi c’est le cas et comment la `Master` propriété est construite lors de la `@MasterType` directive est incluse, consultez [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)d’entrée de blog [ `@MasterType` dans ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef77d-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>


### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="ef77d-274">La mise à jour de la Page maître après l’ajout d’un nouveau produit</span><span class="sxs-lookup"><span data-stu-id="ef77d-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="ef77d-275">Maintenant que nous savons comment appeler des propriétés publiques et les méthodes à partir d’une page de contenu d’une page maître, nous sommes prêts à mettre à jour le `AddProduct.aspx` page afin que la page maître soit actualisée après avoir ajouté un nouveau produit.</span><span class="sxs-lookup"><span data-stu-id="ef77d-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="ef77d-276">Au début de l’étape 4, nous avons créé un gestionnaire d’événements pour le contrôle DetailsView `ItemInserting` événement, qui s’exécute immédiatement après que le nouveau produit a été ajouté à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="ef77d-277">Ajoutez le code suivant à ce gestionnaire d’événements :</span><span class="sxs-lookup"><span data-stu-id="ef77d-277">Add the following code to that event handler:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="ef77d-278">Le code ci-dessus utilise les deux le faiblement typé `Page.Master` propriété et fortement typées `Master` propriété.</span><span class="sxs-lookup"><span data-stu-id="ef77d-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="ef77d-279">Notez que le `GridMessageText` propriété est définie sur «*ProductName* ajouté à la grille... » Les valeurs du produit ajouté juste sont accessibles via le `e.Values` collection, comme vous pouvez le voir, le juste ajouté `ProductName` valeur est accessible via `e.Values("ProductName")`.</span><span class="sxs-lookup"><span data-stu-id="ef77d-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="ef77d-280">La figure 8 illustre la `AddProduct.aspx` page immédiatement après un nouveau produit - de Scott Soda - a été ajoutée à la base de données.</span><span class="sxs-lookup"><span data-stu-id="ef77d-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="ef77d-281">Notez que le nom du produit juste-ajouté est indiqué dans l’étiquette de la page maître et que le contrôle GridView a été actualisé pour inclure le produit et son prix.</span><span class="sxs-lookup"><span data-stu-id="ef77d-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>


<span data-ttu-id="ef77d-282">[![Affichent le produit ajouté juste de l’étiquette et GridView de la Page maître](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ef77d-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="ef77d-283">**Figure 08**: Affichent le produit Just-Added de l’étiquette et GridView de la Page maître ([cliquez pour afficher l’image en taille réelle](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ef77d-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>


## <a name="summary"></a><span data-ttu-id="ef77d-284">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="ef77d-284">Summary</span></span>

<span data-ttu-id="ef77d-285">Dans l’idéal, une page maître et ses pages de contenu sont complètement séparées les unes des autres et ne nécessitent aucun niveau d’interaction.</span><span class="sxs-lookup"><span data-stu-id="ef77d-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="ef77d-286">Tandis que les pages maîtres et les pages de contenu doivent être conçus avec cet objectif à l’esprit, il existe un nombre de scénarios courants dans lesquels une page de contenu doit interagir avec sa page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="ef77d-287">Une des raisons plus courantes se concentre sur la mise à jour une partie spécifique de l’affichage de page maître basé sur une action qui se sont produites dans la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="ef77d-288">La bonne nouvelle est qu’il est relativement simple d’avoir une page de contenu interagir par programmation avec sa page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="ef77d-289">Commencez par créer des propriétés ou méthodes publiques dans la page maître qui encapsulent les fonctionnalités qui devant être appelé par une page de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="ef77d-290">Puis, dans la page de contenu, accéder aux propriétés et méthodes de la page maître via les faiblement typé `Page.Master` propriété ou utilisez le `@MasterType` directive permettant de créer une référence fortement typée à la page maître.</span><span class="sxs-lookup"><span data-stu-id="ef77d-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="ef77d-291">Dans le didacticiel suivant, nous examinons comment la page maître interagir par programmation avec une de ses pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef77d-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="ef77d-292">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="ef77d-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="ef77d-293">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="ef77d-293">Further Reading</span></span>

<span data-ttu-id="ef77d-294">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="ef77d-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ef77d-295">L’accès et la mise à jour des données dans ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ef77d-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="ef77d-296">Pages maître ASP.NET : Conseils, astuces et pièges</span><span class="sxs-lookup"><span data-stu-id="ef77d-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="ef77d-297">`@MasterType` dans ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="ef77d-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="ef77d-298">Informations de transmission entre le contenu et les Pages maîtres</span><span class="sxs-lookup"><span data-stu-id="ef77d-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="ef77d-299">Utilisation des données dans les didacticiels ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ef77d-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="ef77d-300">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="ef77d-300">About the Author</span></span>

<span data-ttu-id="ef77d-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de plusieurs livres de sur ASP/ASP.NET et fondateur de 4GuysFromRolla.com, travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="ef77d-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ef77d-302">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="ef77d-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ef77d-303">Son dernier livre s’intitule [ *Sams Teach vous-même ASP.NET 3.5 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ef77d-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="ef77d-304">Scott peut être atteint à [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) ou via son blog à [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="ef77d-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="ef77d-305">Remerciements</span><span class="sxs-lookup"><span data-stu-id="ef77d-305">Special Thanks To</span></span>

<span data-ttu-id="ef77d-306">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="ef77d-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ef77d-307">Entraîner un réviseur pour ce didacticiel a été Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="ef77d-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="ef77d-308">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="ef77d-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ef77d-309">Dans ce cas, envoyez-moi une ligne à [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ef77d-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ef77d-310">[Précédent](control-id-naming-in-content-pages-vb.md)
> [Suivant](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ef77d-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
