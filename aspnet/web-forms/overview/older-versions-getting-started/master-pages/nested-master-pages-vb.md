---
uid: web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
title: Imbriqué des Pages maîtres (VB) | Microsoft Docs
author: rick-anderson
description: Montre comment imbriquer une page maître dans une autre.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 14d9aa1b-4dca-43a0-aa9d-a6e891fee019
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 86507c92b531898db1c9d29ba2ac28cc35d5d284
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57060236"
---
<a name="nested-master-pages-vb"></a><span data-ttu-id="0c9b1-103">Pages maîtres imbriquées (VB)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-103">Nested Master Pages (VB)</span></span>
====================
<span data-ttu-id="0c9b1-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0c9b1-105">[Télécharger le Code](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip) ou [télécharger le PDF](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-105">[Download Code](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip) or [Download PDF](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span></span>

> <span data-ttu-id="0c9b1-106">Montre comment imbriquer une page maître dans une autre.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-106">Shows how to nest one master page within another.</span></span>


## <a name="introduction"></a><span data-ttu-id="0c9b1-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="0c9b1-107">Introduction</span></span>

<span data-ttu-id="0c9b1-108">Au cours des neuf derniers didacticiels, nous avons vu comment implémenter une mise en page de l’échelle du site avec les pages maîtres.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-108">Over the course of the past nine tutorials we have seen how to implement a site-wide layout with master pages.</span></span> <span data-ttu-id="0c9b1-109">En bref, les pages maîtres nous permettent, le développeur de pages, pour définir le balisage courantes dans la page maître, ainsi que des régions spécifiques qui peuvent être personnalisées sur une base de la page de contenu-par-contenu de la page.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-109">In a nutshell, master pages allow us, the page developer, to define common markup in the master page along with specific regions that can be customized on a content page-by-content page basis.</span></span> <span data-ttu-id="0c9b1-110">Les contrôles ContentPlaceHolder dans une page maître indiquent les régions personnalisables ; le code personnalisé pour les contrôles ContentPlaceHolder sont définies dans la page de contenu par le biais de contrôles de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-110">The ContentPlaceHolder controls in a master page indicate the customizable regions; the customized markup for the ContentPlaceHolder controls are defined in the content page via Content controls.</span></span>

<span data-ttu-id="0c9b1-111">Les techniques de page maître que nous avons exploré jusqu'à présent sont idéales si vous avez une disposition unique utilisée sur l’ensemble du site.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-111">The master page techniques we've explored thus far are great if you have a single layout used across the entire site.</span></span> <span data-ttu-id="0c9b1-112">Toutefois, de nombreux sites Web de grande taille ont une disposition de site personnalisé entre les différentes sections.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-112">However, many large websites have a site layout that is customized across various sections.</span></span> <span data-ttu-id="0c9b1-113">Par exemple, considérez une application de soins de santé utilisée par le personnel de l’hôpital pour gérer la facturation, les activités et les informations relatives aux patients.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-113">For example, consider a health care application used by hospital staff to manage patient information, activities, and billing.</span></span> <span data-ttu-id="0c9b1-114">Il peut y avoir trois types de pages web dans cette application :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-114">There may be three types of web pages in this application:</span></span>

- <span data-ttu-id="0c9b1-115">Personnel membre spécifiques où les membres du personnel peuvent mettre à jour la disponibilité, afficher les planifications, ou demander des congés.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-115">Staff member-specific pages where staff members can update availability, view schedules, or request vacation time.</span></span>
- <span data-ttu-id="0c9b1-116">Pages de patient spécifiques où les membres du personnel permet d’afficher ou modifier les informations d’un patient spécifique.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-116">Patient-specific pages where staff members view or edit information for a specific patient.</span></span>
- <span data-ttu-id="0c9b1-117">Pages de facturation spécifique où comptables examiner actuel revendication d’états et les rapports financiers.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-117">Billing-specific pages where accountants review current claim statuses and financial reports.</span></span>

<span data-ttu-id="0c9b1-118">Chaque page susceptibles de partager une disposition commune, tel qu’un menu sur le haut et une série de liens fréquemment utilisées dans la partie inférieure.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-118">Every page might share a common layout, such as a menu across the top and a series of frequently used links along the bottom.</span></span> <span data-ttu-id="0c9b1-119">Mais le personnel-, patient-et les pages de facturation spécifiques peuvent avoir besoin personnaliser cette disposition générique.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-119">But the staff-, patient-, and billing-specific pages may need to customize this generic layout.</span></span> <span data-ttu-id="0c9b1-120">Par exemple, peut-être toutes les pages du personnel spécifique doivent inclure une liste de calendrier et des tâches montrant la disponibilité et la planification quotidienne de l’utilisateur actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-120">For example, perhaps all staff-specific pages should include a calendar and task list showing the currently logged on user's availability and daily schedule.</span></span> <span data-ttu-id="0c9b1-121">Peut-être toutes les pages spécifiques à un patient besoin d’afficher le nom, adresse et les informations d’assurance pour le patient dont les informations sont en cours de modification.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-121">Perhaps all patient-specific pages need to show the name, address, and insurance information for the patient whose information is being edited.</span></span>

<span data-ttu-id="0c9b1-122">Il est possible de créer de telles dispositions personnalisées à l’aide de *des pages maîtres imbriquées*.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-122">It's possible to create such customized layouts by using *nested master pages*.</span></span> <span data-ttu-id="0c9b1-123">Pour implémenter le scénario ci-dessus, nous démarre en créant une page maître qui a défini le contenu de mise en page, le menu et le pied de page à l’échelle du site, avec ContentPlaceHolders définissant les zones personnalisables.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-123">To implement the above scenario, we would start by creating a master page that defined the site-wide layout, the menu and footer content, with ContentPlaceHolders defining the customizable regions.</span></span> <span data-ttu-id="0c9b1-124">Nous créerions ensuite trois pages maîtres imbriquées, une pour chaque type de page web.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-124">We would then create three nested master pages, one for each type of web page.</span></span> <span data-ttu-id="0c9b1-125">Chaque page maître imbriquée définirait le contenu entre le type des pages de contenu qui utilisent la page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-125">Each nested master page would define the content among the type of content pages that use the master page.</span></span> <span data-ttu-id="0c9b1-126">En d’autres termes, la page maître imbriquée pour les pages de contenu spécifique d’un patient inclurait balisage et la logique de programmation pour l’affichage d’informations sur le patient en cours de modification.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-126">In other words, the nested master page for patient-specific content pages would include markup and programmatic logic for displaying information about the patient being edited.</span></span> <span data-ttu-id="0c9b1-127">Lors de la création d’une page spécifique d’un patient nous serait le lier à cette page maître imbriquée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-127">When creating a new patient-specific page we would bind it to this nested master page.</span></span>

<span data-ttu-id="0c9b1-128">Ce didacticiel commence par la mise en évidence les avantages des pages maîtres imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-128">This tutorial starts by highlighting the benefits of nested master pages.</span></span> <span data-ttu-id="0c9b1-129">Il montre ensuite comment créer et utiliser les pages maîtres imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-129">It then shows how to create and use nested master pages.</span></span>

> [!NOTE]
> <span data-ttu-id="0c9b1-130">Les pages maîtres imbriquées ont été possibles depuis la version 2.0 du .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-130">Nested master pages have been possible since version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="0c9b1-131">Toutefois, Visual Studio 2005 n’incluent pas de prise en charge au moment du design pour les pages maîtres imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-131">However, Visual Studio 2005 did not include design-time support for nested master pages.</span></span> <span data-ttu-id="0c9b1-132">La bonne nouvelle est que Visual Studio 2008 offre une riche expérience au moment du design pour les pages maîtres imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-132">The good news is that Visual Studio 2008 offers a rich design-time experience for nested master pages.</span></span> <span data-ttu-id="0c9b1-133">Si vous souhaitez utiliser les pages maîtres imbriquées mais que vous utilisez Visual Studio 2005, consultez [Scott Guthrie](https://weblogs.asp.net/scottgu/)d’entrée de blog, [astuces pour les Pages maîtres imbriquées dans VS 2005 conception](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-133">If you are interested in using nested master pages but are still using Visual Studio 2005, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [Tips for Nested Master Pages in VS 2005 Design-Time](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span></span>


## <a name="the-benefits-of-nested-master-pages"></a><span data-ttu-id="0c9b1-134">Les avantages des Pages maîtres imbriquées</span><span class="sxs-lookup"><span data-stu-id="0c9b1-134">The Benefits of Nested Master Pages</span></span>

<span data-ttu-id="0c9b1-135">De nombreux sites Web ont une conception de site principal, mais aussi plus des conceptions personnalisées spécifiques à certains types de pages.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-135">Many websites have an overarching site design as well as more customized designs specific to certain types of pages.</span></span> <span data-ttu-id="0c9b1-136">Par exemple, dans notre application web de démonstration, nous avons créé une section d’Administration rudimentaire (les pages dans le `~/Admin` dossier).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-136">For instance, in our demo web application we have created a rudimentary Administration section (the pages in the `~/Admin` folder).</span></span> <span data-ttu-id="0c9b1-137">Actuellement les pages web dans le `~/Admin` dossier utilisent la même page maître en tant que ces pages pas dans la section administration (à savoir, `Site.master` ou `Alternate.master`, en fonction de sélection de l’utilisateur).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-137">Currently the web pages in the `~/Admin` folder use the same master page as those pages not in the administration section (namely, `Site.master` or `Alternate.master`, depending on the user's selection).</span></span>

> [!NOTE]
> <span data-ttu-id="0c9b1-138">Pour l’instant, supposons que notre site a qu’une seule page maître, `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-138">For now, pretend that our site has just one master page, `Site.master`.</span></span> <span data-ttu-id="0c9b1-139">Nous aborderons à l’aide de pages maîtres imbriquées avec les pages maîtres de deux (ou plus) en commençant par « À l’aide un imbriquée Master pour l’Administration Section de la Page » plus loin dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-139">We'll address using nested master pages with two (or more) master pages starting with "Using a Nested Master Page for the Administration Section" later in this tutorial.</span></span>


<span data-ttu-id="0c9b1-140">Imaginez que nous avons invités à personnaliser la disposition des pages d’Administration pour inclure des informations supplémentaires ou des liens qui sinon ne serait pas présents dans les autres pages du site.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-140">Imagine that we were asked to customize the layout of the Administration pages to include additional information or links that would not otherwise be present in other pages in the site.</span></span> <span data-ttu-id="0c9b1-141">Il existe quatre techniques pour implémenter cette exigence :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-141">There are four techniques to implement this requirement:</span></span>

1. <span data-ttu-id="0c9b1-142">Ajouter manuellement les informations spécifiques à l’Administration et les liens à chaque page de contenu dans le `~/Admin` dossier.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-142">Manually add the Administration-specific information and links to every content page in the `~/Admin` folder.</span></span>
2. <span data-ttu-id="0c9b1-143">Mise à jour le `Site.master` page maître à inclure les informations spécifiques à la section d’Administration et les liens, puis ajoutez le code à la page maître pour afficher ou masquer ces sections selon si une des pages d’Administration est visitée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-143">Update the `Site.master` master page to include the Administration section-specific information and links, and then add code to the master page to show or hide these sections based on whether one of the Administration pages is being visited.</span></span>
3. <span data-ttu-id="0c9b1-144">Créer une page maître spécifiquement pour la section Administration, recopiez les balises de `Site.master`, ajoutez les informations spécifiques à la section d’Administration et les liens, puis mettez à jour les pages de contenu dans le `~/Admin` dossier à utiliser ce nouveau maître page.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-144">Create a new master page specifically for the Administration section, copy over the markup from `Site.master`, add the Administration section-specific information and links, and then update the content pages in the `~/Admin` folder to use this new master page.</span></span>
4. <span data-ttu-id="0c9b1-145">Créer une page maître imbriquée qui lie à `Site.master` et avoir les pages de contenu dans le `~/Admin` cette nouvelle utilisation des dossiers imbriqués page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-145">Create a nested master page that binds to `Site.master` and have the content pages in the `~/Admin` folder use this new nested master page.</span></span> <span data-ttu-id="0c9b1-146">Cette page maître imbriquée inclurait simplement les informations et liens supplémentaires spécifiques aux pages d’Administration et qu’il serait inutile de répéter le balisage prédéfinie dans `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-146">This nested master page would include just the additional information and links specific to the Administration pages and would not need to repeat the markup already defined in `Site.master`.</span></span>

<span data-ttu-id="0c9b1-147">La première option est moins aisée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-147">The first option is the least palatable.</span></span> <span data-ttu-id="0c9b1-148">L’objectif de l’utilisation des pages maîtres est à s’éloigner de devoir copier et coller le balisage courants pour les nouvelles pages ASP.NET manuellement.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-148">The whole point of using master pages is to move away from having to manually copy and paste common markup to new ASP.NET pages.</span></span> <span data-ttu-id="0c9b1-149">La deuxième option est acceptable, mais rend la moins facile à gérer comme il épaissit les pages maîtres avec le balisage qui s’affiche qu’occasionnellement et nécessite que les développeurs modifiez la page maître pour contourner ce balisage et d’avoir à mémoriser, de l’application exactement, certaine balisage s’affiche et lorsqu’il est masqué.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-149">The second option is acceptable, but makes the application less maintainable as it bulks up the master pages with markup that is only occasionally displayed and requires developers editing the master page to work around this markup and to have to remember when, exactly, certain markup is displayed versus when it is hidden.</span></span> <span data-ttu-id="0c9b1-150">Cette approche serait moins tenable en tant que personnalisations à partir de types plus et plus de pages web nécessaires pour être prise en charge par cette page maître unique.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-150">This approach would be less tenable as customizations from more and more types of web pages needed to be accommodated by this single master page.</span></span>

<span data-ttu-id="0c9b1-151">La troisième option supprime l’encombrement et la complexité émet les remontées avec la deuxième option.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-151">The third option removes the clutter and complexity issues the surfaced with the second option.</span></span> <span data-ttu-id="0c9b1-152">Toutefois, option de trois principal inconvénient est qu’il nous oblige à copier et coller la mise en page courantes à partir de `Site.master` vers la nouvelle page maître de spécifique à la section d’Administration.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-152">However, option three's main drawback is that it requires us to copy and paste the common layout from `Site.master` to the new Administration section-specific master page.</span></span> <span data-ttu-id="0c9b1-153">Si vous décidez plus tard modifier la disposition de l’échelle du site que nous devons penser à modifier dans deux emplacements.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-153">If we later decide to change the site-wide layout we have to remember to change it in two places.</span></span>

<span data-ttu-id="0c9b1-154">La quatrième option, des pages maîtres imbriquées, nous permettent de profiter des deuxième et troisième options.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-154">The fourth option, nested master pages, give us the best of the second and third options.</span></span> <span data-ttu-id="0c9b1-155">Les informations de disposition de l’échelle du site sont conservées dans un fichier : la page maître de niveau supérieur - alors que le contenu spécifique de régions particulières est réparti dans différents fichiers.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-155">The site-wide layout information is maintained in one file - the top-level master page - while the content specific to particular regions is separated out into different files.</span></span>

<span data-ttu-id="0c9b1-156">Ce didacticiel commence par un coup de œil à la création et l’utilisation d’une page maître imbriquée simple.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-156">This tutorial starts with a look at creating and using a simple nested master page.</span></span> <span data-ttu-id="0c9b1-157">Nous créons une toute nouvelle page maître de niveau supérieur, les deux pages maîtres imbriquées et les deux pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-157">We create a brand new top-level master page, two nested master pages, and two content pages.</span></span> <span data-ttu-id="0c9b1-158">À partir de « À l’aide un imbriqués Master Page pour la Section Administration », nous allons examiner la mise à jour de notre architecture existante de la page maître pour inclure l’utilisation des pages maîtres imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-158">Starting with "Using a Nested Master Page for the Administration Section," we look at updating our existing master page architecture to include the use of nested master pages.</span></span> <span data-ttu-id="0c9b1-159">Plus précisément, nous créer une page maître imbriquée et utilisez-le pour inclure du contenu personnalisé supplémentaire pour les pages de contenu dans le `~/Admin` dossier.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-159">Specifically, we create a nested master page and use it to include additional custom content for the content pages in the `~/Admin` folder.</span></span>

## <a name="step-1-creating-a-simple-top-level-master-page"></a><span data-ttu-id="0c9b1-160">Étape 1 : Création d’une Page maître de niveau supérieur Simple</span><span class="sxs-lookup"><span data-stu-id="0c9b1-160">Step 1: Creating a Simple Top-Level Master Page</span></span>

<span data-ttu-id="0c9b1-161">Création d’un serveur maître imbriqué à partir de la principale existante pages et ensuite la mise à jour une page de contenu existante pour utiliser cette nouvelle page maître imbriquée au lieu de la page maître de niveau supérieur qu’il comporte peu de complexité, car les pages de contenu existants attendent déjà certains Contrôles ContentPlaceHolder définis dans la page maître de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-161">Creating a nested master based on one of the existing master pages and then updating an existing content page to use this new nested master page instead of the top-level master page entails some complexity because the existing content pages already expect certain ContentPlaceHolder controls defined in the top-level master page.</span></span> <span data-ttu-id="0c9b1-162">Par conséquent, la page maître imbriquée doit également inclure les mêmes contrôles ContentPlaceHolder portant le même nom.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-162">Therefore, the nested master page must also include the same ContentPlaceHolder controls with the same names.</span></span> <span data-ttu-id="0c9b1-163">En outre, notre application de démonstration particulier a deux pages maîtres (`Site.master` et `Alternate.master`) qui sont affectées dynamiquement à une page de contenu en fonction des préférences de l’utilisateur, qui ajoute davantage à cette complexité.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-163">Furthermore, our particular demo application has two master pages (`Site.master` and `Alternate.master`) that are dynamically assigned to a content page based on a user's preferences, which further adds to this complexity.</span></span> <span data-ttu-id="0c9b1-164">Nous allons examiner la mise à jour de l’application existante à utiliser les pages maîtres imbriquées plus loin dans ce didacticiel, mais nous allons concentrer tout d’abord sur une simple imbriqués exemple des pages maîtres.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-164">We will look at updating the existing application to use nested master pages later in this tutorial, but let's first focus on a simple nested master pages example.</span></span>

<span data-ttu-id="0c9b1-165">Créez un dossier nommé `NestedMasterPages` puis ajoutez un nouveau fichier de page maître dans ce dossier nommé `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-165">Create a new folder named `NestedMasterPages` and then add a new master page file to that folder named `Simple.master`.</span></span> <span data-ttu-id="0c9b1-166">(Voir Figure 1 pour une capture d’écran de l’Explorateur de solutions après l’ajout de ce dossier et le fichier.) Faites glisser le `AlternateStyles.css` fichier de feuille de style à partir de l’Explorateur de solutions sur le concepteur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-166">(See Figure 1 for a screen shot of the Solution Explorer after this folder and file have been added.) Drag the `AlternateStyles.css` style sheet file from the Solution Explorer onto the Designer.</span></span> <span data-ttu-id="0c9b1-167">Cette opération ajoute une `<link>` élément vers le fichier de feuille de style dans le `<head>` élément, après laquelle la page maître `<head>` balisage de l’élément doit ressembler à :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-167">This adds a `<link>` element to the style sheet file in the `<head>` element, after which the master page's `<head>` element's markup should look like:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample1.aspx)]

<span data-ttu-id="0c9b1-168">Ensuite, ajoutez le balisage suivant dans le formulaire Web de `Simple.master`:</span><span class="sxs-lookup"><span data-stu-id="0c9b1-168">Next, add the following markup within the Web Form of `Simple.master`:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="0c9b1-169">Ce balisage affiche un lien intitulé « Pages maîtres imbriquées (Simple) » en haut de la page dans une grande taille de police blanche sur fond bleu foncé.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-169">This markup displays a link titled "Nested Master Pages (Simple)" at the top of the page in a large white font on a navy background.</span></span> <span data-ttu-id="0c9b1-170">Sous qui est le `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-170">Beneath that is the `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="0c9b1-171">La figure 1 illustre le `Simple.master` page maître lors du chargement dans le concepteur Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-171">Figure 1 shows the `Simple.master` master page when loaded in the Visual Studio Designer.</span></span>


<span data-ttu-id="0c9b1-172">[![La Page maître imbriquée définit le contenu spécifique aux Pages dans la Section Administration](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-172">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span></span>

<span data-ttu-id="0c9b1-173">**Figure 01**: L’imbriqués Master Page définit contenu spécifique aux Pages dans la Section Administration ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-173">**Figure 01**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image3.png))</span></span>


## <a name="step-2-creating-a-simple-nested-master-page"></a><span data-ttu-id="0c9b1-174">Étape 2 : Création d’une Page maître imbriquée Simple</span><span class="sxs-lookup"><span data-stu-id="0c9b1-174">Step 2: Creating a Simple Nested Master Page</span></span>

<span data-ttu-id="0c9b1-175">`Simple.master` contient deux contrôles ContentPlaceHolder : le `MainContent` ContentPlaceHolder, nous avons ajouté dans un formulaire Web avec le `head` ContentPlaceHolder dans le `<head>` élément.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-175">`Simple.master` contains two ContentPlaceHolder controls: the `MainContent` ContentPlaceHolder we added within the Web Form along with the `head` ContentPlaceHolder in the `<head>` element.</span></span> <span data-ttu-id="0c9b1-176">Si vous deviez créer une page de contenu, puis liez-le à `Simple.master` la page de contenu aurait deux contrôles de contenu faisant référence aux deux ContentPlaceHolders.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-176">If we were to create a content page and bind it to `Simple.master` the content page would have two Content controls referencing the two ContentPlaceHolders.</span></span> <span data-ttu-id="0c9b1-177">De même, si nous créer une page maître imbriquée et liez-le à `Simple.master` puis la page maître imbriquée aura deux contrôles de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-177">Similarly, if we create a nested master page and bind it to `Simple.master` then the nested master page will have two Content controls.</span></span>

<span data-ttu-id="0c9b1-178">Nous allons ajouter une nouvelle page maître imbriquée à la `NestedMasterPages` dossier nommé `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-178">Let's add a new nested master page to the `NestedMasterPages` folder named `SimpleNested.master`.</span></span> <span data-ttu-id="0c9b1-179">Avec le bouton droit sur le `NestedMasterPages` dossier et choisissez Ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-179">Right-click on the `NestedMasterPages` folder and choose Add New Item.</span></span> <span data-ttu-id="0c9b1-180">Ceci fait apparaître la boîte de dialogue Ajouter un nouvel élément indiquée dans la Figure 2.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-180">This brings up the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="0c9b1-181">Sélectionnez le type de modèle de Page maître et tapez le nom de la nouvelle page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-181">Select the Master Page template type and type in the name of the new master page.</span></span> <span data-ttu-id="0c9b1-182">Pour indiquer que la nouvelle page maître doit être une page maître imbriquée, cochez la case à cocher « Sélectionner la page maître ».</span><span class="sxs-lookup"><span data-stu-id="0c9b1-182">To indicate that the new master page should be a nested master page, check the "Select master page" checkbox.</span></span>

<span data-ttu-id="0c9b1-183">Ensuite, cliquez sur le bouton Ajouter.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-183">Next, click the Add button.</span></span> <span data-ttu-id="0c9b1-184">Ceci affichera le même, sélectionnez une boîte de dialogue de Page maître vous voyez lors de la liaison d’une page de contenu à une page maître (voir Figure 3).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-184">This will display the same Select a Master Page dialog box you see when binding a content page to a master page (see Figure 3).</span></span> <span data-ttu-id="0c9b1-185">Choisissez le `Simple.master` page maître dans le `NestedMasterPages` dossier et cliquez sur OK.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-185">Choose the `Simple.master` master page in the `NestedMasterPages` folder and click OK.</span></span>

> [!NOTE]
> <span data-ttu-id="0c9b1-186">Si vous avez créé votre site Web ASP.NET à l’aide du modèle de projet d’Application Web au lieu du modèle de projet de Site Web, vous ne verrez pas la case à cocher « Sélectionner la page maître » dans la boîte de dialogue Ajouter un nouvel élément indiquée dans la Figure 2.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-186">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="0c9b1-187">Pour créer une page maître imbriquée lorsque vous utilisez le modèle de projet d’Application Web, vous devez choisir le modèle de Page maître imbriquée (au lieu du modèle de Page maître).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-187">To create a nested master page when using the Web Application Project model you must choose the Nested Master Page template (instead of the Master Page template).</span></span> <span data-ttu-id="0c9b1-188">Après avoir sélectionné le modèle de Page maître imbriquée et en cliquant sur Ajouter, le même sélectionner une Page maître boîte de dialogue illustrée dans la Figure 3 s’affiche.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-188">After selecting the Nested Master Page template and clicking Add, the same Select a Master Page dialog box shown in Figure 3 will appear.</span></span>


<span data-ttu-id="0c9b1-189">[![Vérifier le &quot;sélectionner la page maître&quot; case à cocher pour ajouter une Page maître imbriquée](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-189">[![Check the &quot;Select master page&quot; Checkbox to Add a Nested Master Page](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span></span>

<span data-ttu-id="0c9b1-190">**Figure 02**: Cochez la case « Sélectionner la page maître » pour ajouter une Page maître imbriquée ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-190">**Figure 02**: Check the "Select master page" Checkbox to Add a Nested Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image6.png))</span></span>


<span data-ttu-id="0c9b1-191">[![Lier la Page maître imbriquée à la Page maître de Simple.master](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-191">[![Bind the Nested Master Page to the Simple.master Master Page](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span></span>

<span data-ttu-id="0c9b1-192">**Figure 03**: Lier la Page maître imbriquée à la `Simple.master` Page maître ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-192">**Figure 03**: Bind the Nested Master Page to the `Simple.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image9.png))</span></span>


<span data-ttu-id="0c9b1-193">Balisage déclaratif de la page maître imbriquée, illustré ci-dessous, contient deux contrôles de contenu faisant référence à des contrôles ContentPlaceHolder deux le niveau supérieur de la page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-193">The nested master page's declarative markup, shown below, contains two Content controls referencing the top-level master page's two ContentPlaceHolder controls.</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="0c9b1-194">À l’exception de la `<%@ Master %>` directive, balisage déclaratif initiale de la page maître imbriquée est identique à la balise qui est initialement générée lors de la liaison d’une page de contenu à la même page maître de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-194">Except for the `<%@ Master %>` directive, the nested master page's initial declarative markup is identical to the markup that is initially generated when binding a content page to the same top-level master page.</span></span> <span data-ttu-id="0c9b1-195">Comme une page de contenu `<%@ Page %>` directive, le `<%@ Master %>` directive ici inclut un `MasterPageFile` attribut qui spécifie la page maître du parent de la page maître imbriquée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-195">Like a content page's `<%@ Page %>` directive, the `<%@ Master %>` directive here includes a `MasterPageFile` attribute that specifies the nested master page's parent master page.</span></span> <span data-ttu-id="0c9b1-196">La principale différence entre la page maître imbriquée et une page de contenu lié à la même page maître de niveau supérieur est que la page maître imbriquée peut inclure des contrôles ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-196">The main difference between the nested master page and a content page bound to the same top-level master page is that the nested master page can include ContentPlaceHolder controls.</span></span> <span data-ttu-id="0c9b1-197">Les contrôles ContentPlaceHolder de la page maître imbriquée définissent les régions où les pages de contenu peuvent personnaliser le balisage.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-197">The nested master page's ContentPlaceHolder controls define the regions where the content pages can customize the markup.</span></span>

<span data-ttu-id="0c9b1-198">Mettre à jour cette page maître imbriquée afin qu’il affiche le texte « Hello, from SimpleNested ! »</span><span class="sxs-lookup"><span data-stu-id="0c9b1-198">Update this nested master page so that it displays the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="0c9b1-199">dans le contrôle de contenu qui correspond à la `MainContent` contrôle ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-199">in the Content control that corresponds to the `MainContent` ContentPlaceHolder control.</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample4.aspx)]

<span data-ttu-id="0c9b1-200">Après avoir apporté cet ajout, enregistrez la page maître imbriquée et puis ajoutez une nouvelle page de contenu pour le `NestedMasterPages` dossier nommé `Default.aspx`, puis liez-le à le `SimpleNested.master` page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-200">After making this addition, save the nested master page and then add a new content page to the `NestedMasterPages` folder named `Default.aspx`, and bind it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="0c9b1-201">Lors de l’ajout de cette page, vous pouvez être surpris de voir qu’elle contient sans contrôles de contenu (voir Figure 4) !</span><span class="sxs-lookup"><span data-stu-id="0c9b1-201">Upon adding this page you may be surprised to see that it contains no Content controls (see Figure 4)!</span></span> <span data-ttu-id="0c9b1-202">Une page de contenu peut accéder uniquement à son *parent* maître ContentPlaceHolders de la page.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-202">A content page can only access its *parent* master page's ContentPlaceHolders.</span></span> <span data-ttu-id="0c9b1-203">`SimpleNested.master` ne contient pas tous les contrôles ContentPlaceHolder ; Par conséquent, n’importe quelle page de contenu liée à cette page maître ne peut pas contenir les contrôles de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-203">`SimpleNested.master` does not contain any ContentPlaceHolder controls; therefore, any content page bound to this master page cannot contain any Content controls.</span></span>


<span data-ttu-id="0c9b1-204">[![La nouvelle Page de contenu ne contient aucun contrôle de contenu](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-204">[![The New Content Page Contains No Content Controls](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span></span>

<span data-ttu-id="0c9b1-205">**Figure 04**: La nouvelle Page contient aucun contenu contrôles de contenu ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-205">**Figure 04**: The New Content Page Contains No Content Controls ([Click to view full-size image](nested-master-pages-vb/_static/image12.png))</span></span>


<span data-ttu-id="0c9b1-206">Ce que nous devons faire est de mettre à jour de la page maître imbriquée (`SimpleNested.master`) pour inclure les contrôles ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-206">What we need to do is update the nested master page (`SimpleNested.master`) to include ContentPlaceHolder controls.</span></span> <span data-ttu-id="0c9b1-207">En général, vous allez que vos pages maîtres imbriquées pour inclure un ContentPlaceHolder pour chaque ContentPlaceHolder défini par sa page maître parente, ce qui permet sa page maître enfant ou une page de contenu pour travailler avec du niveau supérieur de la page maître ContentPlaceHolder contrôles.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-207">Typically you'll want your nested master pages to include a ContentPlaceHolder for each ContentPlaceHolder defined by its parent master page, thereby allowing its child master page or content page to work with any of the top-level master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="0c9b1-208">Mise à jour le `SimpleNested.master` page maître pour inclure un ContentPlaceHolder dans ses deux contrôles de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-208">Update the `SimpleNested.master` master page to include a ContentPlaceHolder in its two Content controls.</span></span> <span data-ttu-id="0c9b1-209">Nommez les contrôles ContentPlaceHolder le même que le contrôle ContentPlaceHolder à que leur contrôle de contenu fait référence.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-209">Give the ContentPlaceHolder controls the same name as the ContentPlaceHolder control their Content control refers to.</span></span> <span data-ttu-id="0c9b1-210">Autrement dit, ajoutez un contrôle ContentPlaceHolder nommé `MainContent` pour le contenu de contrôle dans `SimpleNested.master` qui fait référence à la `MainContent` ContentPlaceHolder dans `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-210">That is, add a ContentPlaceHolder control named `MainContent` to the Content control in `SimpleNested.master` that references the `MainContent` ContentPlaceHolder in `Simple.master`.</span></span> <span data-ttu-id="0c9b1-211">Faire la même chose dans le contrôle de contenu qui référence le `head` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-211">Do the same thing in the Content control that references the `head` ContentPlaceHolder.</span></span>

> [!NOTE]
> <span data-ttu-id="0c9b1-212">Bien que je recommande d’affectation de noms les contrôles ContentPlaceHolder dans la page maître imbriquée identique aux ContentPlaceHolders dans la page maître de niveau supérieur, cette symétrie d’affectation de noms n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-212">While I recommend naming the ContentPlaceHolder controls in the nested master page the same as the ContentPlaceHolders in the top-level master page, this naming symmetry is not required.</span></span> <span data-ttu-id="0c9b1-213">Vous pouvez donner les contrôles ContentPlaceHolder dans votre page maître imbriquée de n’importe quel nom de que votre choix.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-213">You can give the ContentPlaceHolder controls in your nested master page any name you like.</span></span> <span data-ttu-id="0c9b1-214">Toutefois, j’ai s’avérer plus facile à retenir que ContentPlaceHolders correspondent avec les zones de la page si ma page maître de niveau supérieur et les pages maîtres imbriquées utilisent les mêmes noms.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-214">However, I find it easier to remember what ContentPlaceHolders correspond with what regions of the page if my top-level master page and nested master pages use the same names.</span></span>


<span data-ttu-id="0c9b1-215">Après avoir apporté ces ajouts votre `SimpleNested.master` balisage déclaratif de la page maître doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-215">After making these additions your `SimpleNested.master` master page's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="0c9b1-216">Supprimer le `Default.aspx` page que nous venons de créer de contenu, puis ajouter de nouveau, en le liant à le `SimpleNested.master` page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-216">Delete the `Default.aspx` content page we just created and then re-add it, binding it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="0c9b1-217">Cette fois Visual Studio ajoute deux contrôles de contenu pour le `Default.aspx`, référençant le ContentPlaceHolders maintenant définie dans `SimpleNested.master` (voir Figure 6).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-217">This time Visual Studio adds two Content controls to the `Default.aspx`, referencing the ContentPlaceHolders now defined in `SimpleNested.master` (see Figure 6).</span></span> <span data-ttu-id="0c9b1-218">Ajoutez le texte, « Hello, from Default.aspx ! »</span><span class="sxs-lookup"><span data-stu-id="0c9b1-218">Add the text, "Hello, from Default.aspx!"</span></span> <span data-ttu-id="0c9b1-219">dans le contenu du contrôle référencé `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-219">in the Content control that referenced `MainContent`.</span></span>

<span data-ttu-id="0c9b1-220">La figure 5 illustre les trois entités impliquées dans ce cas - `Simple.master`, `SimpleNested.master`, et `Default.aspx` - et leurs relations avec les uns des autres.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-220">Figure 5 shows the three entities involved here - `Simple.master`, `SimpleNested.master`, and `Default.aspx` - and how they relate to one another.</span></span> <span data-ttu-id="0c9b1-221">Comme le montre le diagramme, la page maître imbriquée implémente des contrôles de contenu pour ContentPlaceHolder de son parent.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-221">As the diagram shows, the nested master page implements Content controls for its parent's ContentPlaceHolder.</span></span> <span data-ttu-id="0c9b1-222">Si ces régions doivent être accessibles à la page de contenu, la page maître imbriquée doit ajouter son propre ContentPlaceHolders aux contrôles de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-222">If these regions need to be accessible to the content page, the nested master page must add its own ContentPlaceHolders to the Content controls.</span></span>


<span data-ttu-id="0c9b1-223">[![Les Pages maîtres de niveau supérieur et imbriqués dictent le contenu mise en Page](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-223">[![The Top-Level and Nested Master Pages Dictate the Content Page's Layout](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span></span>

<span data-ttu-id="0c9b1-224">**Figure 05**: Les Pages maîtres imbriquées et de niveau supérieur dictent le mise contenu en Page ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-224">**Figure 05**: The Top-Level and Nested Master Pages Dictate the Content Page's Layout ([Click to view full-size image](nested-master-pages-vb/_static/image15.png))</span></span>


<span data-ttu-id="0c9b1-225">Ce comportement illustre comment une page de contenu ou la page maître est uniquement informé de sa page maître parente.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-225">This behavior illustrates how a content page or master page is only cognizant of its parent master page.</span></span> <span data-ttu-id="0c9b1-226">Ce comportement est également indiqué par le concepteur Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-226">This behavior is also indicated by the Visual Studio Designer.</span></span> <span data-ttu-id="0c9b1-227">La figure 6 illustre le concepteur pour `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-227">Figure 6 shows the Designer for `Default.aspx`.</span></span> <span data-ttu-id="0c9b1-228">Bien que le concepteur affiche clairement quelles régions sont modifiables à partir de la page de contenu et les parties ne sont pas, il ne lever l’ambiguïté quelles sont les zones non modifiables de la page maître imbriquée et quelles sont les régions à partir de la page maître de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-228">While the Designer clearly shows what regions are editable from the content page and what portions aren't, it doesn't disambiguate what non-editable regions are from the nested master page and what regions are from the top-level master page.</span></span>


<span data-ttu-id="0c9b1-229">[![Le contenu maintenant de Page inclut des contrôles de contenu pour ContentPlaceHolders la Page maître imbriquée](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-229">[![The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span></span>

<span data-ttu-id="0c9b1-230">**Figure 06**: Le contenu Page maintenant inclut des contrôles de contenu pour ContentPlaceHolders de la Page maître imbriquée ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-230">**Figure 06**: The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders ([Click to view full-size image](nested-master-pages-vb/_static/image18.png))</span></span>


## <a name="step-3-adding-a-second-simple-nested-master-page"></a><span data-ttu-id="0c9b1-231">Étape 3 : Ajout d’une deuxième Page maître imbriquée Simple</span><span class="sxs-lookup"><span data-stu-id="0c9b1-231">Step 3: Adding a Second Simple Nested Master Page</span></span>

<span data-ttu-id="0c9b1-232">L’avantage de pages maîtres imbriquées est plus évident lorsqu’il y a plusieurs pages maîtres imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-232">The benefit of nested master pages is more evident when there are multiple nested master pages.</span></span> <span data-ttu-id="0c9b1-233">Pour illustrer cet avantage, créez une autre page maître imbriquée dans la `NestedMasterPages` dossier ; page maître nommez cette nouvelle imbriqué `SimpleNestedAlternate.master` et liez-le à le `Simple.master` page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-233">To illustrate this benefit, create another nested master page in the `NestedMasterPages` folder; name this new nested master page `SimpleNestedAlternate.master` and bind it to the `Simple.master` master page.</span></span> <span data-ttu-id="0c9b1-234">Ajout de contrôles ContentPlaceHolder dans deux contrôles de contenu de la page maître imbriquée, comme nous l’avons fait à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-234">Add ContentPlaceHolder controls in the nested master page's two Content controls like we did in Step 2.</span></span> <span data-ttu-id="0c9b1-235">Également ajouter le texte, « Hello, from SimpleNestedAlternate ! »</span><span class="sxs-lookup"><span data-stu-id="0c9b1-235">Also add the text, "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="0c9b1-236">dans le contrôle de contenu qui correspond à la page maître niveau supérieur `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-236">in the Content control that corresponds to the top-level master page's `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="0c9b1-237">Après avoir apporté ces modifications balisage déclaratif de votre nouvelle page maître imbriquée doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-237">After making these changes your new nested master page's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample6.aspx)]

<span data-ttu-id="0c9b1-238">Créer une page de contenu nommée `Alternate.aspx` dans le `NestedMasterPages` dossier et liez-le à le `SimpleNestedAlternate.master` page maître imbriquée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-238">Create a content page named `Alternate.aspx` in the `NestedMasterPages` folder and bind it to the `SimpleNestedAlternate.master` nested master page.</span></span> <span data-ttu-id="0c9b1-239">Ajoutez le texte, « Hello, émis par d’autres ! »</span><span class="sxs-lookup"><span data-stu-id="0c9b1-239">Add the text, "Hello, from Alternate!"</span></span> <span data-ttu-id="0c9b1-240">dans le contrôle de contenu qui correspond à `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-240">in the Content control that corresponds to `MainContent`.</span></span> <span data-ttu-id="0c9b1-241">La figure 7 illustre `Alternate.aspx` lorsqu’ils sont affichés par le biais du concepteur Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-241">Figure 7 shows `Alternate.aspx` when viewed through the Visual Studio Designer.</span></span>


<span data-ttu-id="0c9b1-242">[![Alternate.aspx est lié à la Page maître de SimpleNestedAlternate.master](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-242">[![Alternate.aspx is Bound to the SimpleNestedAlternate.master Master Page](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span></span>

<span data-ttu-id="0c9b1-243">**Figure 07**: `Alternate.aspx` est lié à la `SimpleNestedAlternate.master` Page maître ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-243">**Figure 07**: `Alternate.aspx` is Bound to the `SimpleNestedAlternate.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image21.png))</span></span>


<span data-ttu-id="0c9b1-244">Comparez le concepteur dans la Figure 7 vers le concepteur dans la Figure 6.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-244">Compare the Designer in Figure 7 to the Designer in Figure 6.</span></span> <span data-ttu-id="0c9b1-245">Les deux pages de contenu partagent la même disposition définie dans la page maître de niveau supérieur (`Simple.master`), à savoir le titre « Nested Master Pages didacticiel (Simple) ».</span><span class="sxs-lookup"><span data-stu-id="0c9b1-245">Both content pages share the same layout defined in the top-level master page (`Simple.master`), namely the "Nested Master Pages Tutorial (Simple)" title.</span></span> <span data-ttu-id="0c9b1-246">Les deux ont encore contenu distinct défini dans leurs pages maîtres parent - le texte « Hello, from SimpleNested ! »</span><span class="sxs-lookup"><span data-stu-id="0c9b1-246">Yet both have distinct content defined in their parent master pages - the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="0c9b1-247">dans la Figure 6 et « Hello, from SimpleNestedAlternate ! »</span><span class="sxs-lookup"><span data-stu-id="0c9b1-247">in Figure 6 and "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="0c9b1-248">dans la Figure 7.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-248">in Figure 7.</span></span> <span data-ttu-id="0c9b1-249">Certes, sont simples à comprendre ces différences ici, mais vous pouvez étendre cet exemple pour inclure des différences plus significatives.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-249">Granted, these differences here are trivial, but you could extend this example to include more meaningful differences.</span></span> <span data-ttu-id="0c9b1-250">Par exemple, le `SimpleNested.master` page peut inclure un menu avec des options spécifiques à ses pages de contenu, tandis que `SimpleNestedAlternate.master` peut-être des informations pertinentes sur les pages de contenu qui lui sont liés.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-250">For instance, the `SimpleNested.master` page might include a menu with options specific to its content pages, whereas `SimpleNestedAlternate.master` might have information pertinent to the content pages that bind to it.</span></span>

<span data-ttu-id="0c9b1-251">Imaginons maintenant que nous avions besoin apporter une modification à la disposition du site global.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-251">Now, imagine that we needed to make a change to the overarching site layout.</span></span> <span data-ttu-id="0c9b1-252">Par exemple, imaginez que nous voulions ajouter une liste de liens communes à toutes les pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-252">For example, imagine that we wanted to add a list of common links to all content pages.</span></span> <span data-ttu-id="0c9b1-253">Pour cela nous mettons à jour la page maître de niveau supérieur, `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-253">To accomplish this we update the top-level master page, `Simple.master`.</span></span> <span data-ttu-id="0c9b1-254">Les modifications sont immédiatement répercutées dans ses pages maîtres imbriquées et, par extension, leurs pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-254">Any changes there are immediately reflected in its nested master pages and, by extension, their content pages.</span></span>

<span data-ttu-id="0c9b1-255">Pour illustrer la facilité avec laquelle nous pouvons modifier la disposition de site principal, ouvrez le `Simple.master` page maître et ajoutez le balisage suivant entre la `topContent` et `mainContent` `<div>` éléments :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-255">To demonstrate the ease with which we can change the overarching site layout, open the `Simple.master` master page and add the following markup between the `topContent` and `mainContent` `<div>` elements:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample7.aspx)]

<span data-ttu-id="0c9b1-256">Cela ajoute deux liens en haut de chaque page qui lie à `Simple.master`, `SimpleNested.master`, ou `SimpleNestedAlternate.master`; ces modifications s’appliquent immédiatement à des pages maîtres imbriqués et leurs pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-256">This adds two links to the top of every page that binds to `Simple.master`, `SimpleNested.master`, or `SimpleNestedAlternate.master`; these changes apply to all nested master pages and their content pages immediately.</span></span> <span data-ttu-id="0c9b1-257">La figure 8 illustre `Alternate.aspx` lorsqu’ils sont affichés via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-257">Figure 8 shows `Alternate.aspx` when viewed through a browser.</span></span> <span data-ttu-id="0c9b1-258">Notez l’ajout des liens en haut de la page (par rapport à la Figure 7).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-258">Note the addition of the links at the top of the page (compared to Figure 7).</span></span>


<span data-ttu-id="0c9b1-259">[![Passé à la Page maître de niveau supérieur sont immédiatement répercutées dans son imbriqués des Pages maîtres et de leurs Pages de contenu](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-259">[![Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span></span>

<span data-ttu-id="0c9b1-260">**Figure 08**: Passé à la Page maître de niveau supérieur sont immédiatement répercutées dans son imbriqués des Pages maîtres et de leurs Pages de contenu ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-260">**Figure 08**: Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages ([Click to view full-size image](nested-master-pages-vb/_static/image24.png))</span></span>


## <a name="using-a-nested-master-page-for-the-administration-section"></a><span data-ttu-id="0c9b1-261">À l’aide d’une Page maître imbriquée pour la Section Administration</span><span class="sxs-lookup"><span data-stu-id="0c9b1-261">Using a Nested Master Page for the Administration Section</span></span>

<span data-ttu-id="0c9b1-262">À ce stade nous avoir examiné les avantages du maître imbriquée des pages et que vous avez vu comment créer et les utiliser dans une application ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-262">At this point we have looked at the advantages of nested master pages and have seen how to create and use them in an ASP.NET application.</span></span> <span data-ttu-id="0c9b1-263">Les exemples dans les étapes 1, 2 et 3, était cependant, la création d’une nouvelle page maître de niveau supérieur, les nouvelles pages maîtres imbriquées et les nouvelles pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-263">The examples in Steps 1, 2, and 3, however, involved creating a new top-level master page, new nested master pages, and new content pages.</span></span> <span data-ttu-id="0c9b1-264">Nous allons ajouter une nouvelle page maître imbriquée à un site Web avec une page maître niveau supérieur et les pages de contenu ?</span><span class="sxs-lookup"><span data-stu-id="0c9b1-264">What about adding a new nested master page to a website with an existing top-level master page and content pages?</span></span>

<span data-ttu-id="0c9b1-265">L’intégration d’une page maître imbriquée dans un site Web existant et en l’associant avec des pages de contenu existants nécessitent un peu plus d’efforts qu’en partant de zéro.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-265">Integrating a nested master page into an existing website and associating it with existing content pages requires a bit more effort than starting from scratch.</span></span> <span data-ttu-id="0c9b1-266">Les étapes 4, 5, 6 et 7 Explorer ces défis, comme nous améliorer notre application de démonstration pour inclure une page maître imbriquée nommée `AdminNested.master` qui contient des instructions pour l’administrateur et est utilisé par les pages ASP.NET dans le `~/Admin` dossier.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-266">Steps 4, 5, 6, and 7 explore these challenges as we augment our demo application to include a new nested master page named `AdminNested.master` that contains instructions for the administrator and is used by the ASP.NET pages in the `~/Admin` folder.</span></span>

<span data-ttu-id="0c9b1-267">L’intégration d’une page maître imbriquée dans notre application de démonstration présente les problèmes suivants :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-267">Integrating a nested master page into our demo application introduces the following hurdles:</span></span>

- <span data-ttu-id="0c9b1-268">Le contenu existant des pages dans le `~/Admin` dossier avoir certaines attentes à partir de leur page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-268">The existing content pages in the `~/Admin` folder have certain expectations from their master page.</span></span> <span data-ttu-id="0c9b1-269">Pour commencer, ils s’attendent certains contrôles ContentPlaceHolder à être présent.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-269">For starters, they expect certain ContentPlaceHolder controls to be present.</span></span> <span data-ttu-id="0c9b1-270">En outre, le `~/Admin/AddProduct.aspx` et `~/Admin/Products.aspx` pages appellent public de la page maître `RefreshRecentProductsGrid` (méthode), définissez son `GridMessageText` propriété, ou avoir un gestionnaire d’événements pour son `PricesDoubled` événement.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-270">Furthermore, the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages call the master page's public `RefreshRecentProductsGrid` method, set its `GridMessageText` property, or have an event handler for its `PricesDoubled` event.</span></span> <span data-ttu-id="0c9b1-271">Par conséquent, notre page maître imbriquée doit fournir le mêmes ContentPlaceHolders et les membres publics.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-271">Consequently, our nested master page must provide the same ContentPlaceHolders and public members.</span></span>
- <span data-ttu-id="0c9b1-272">Dans le didacticiel précédent, nous avons amélioré la `BasePage` classe pour définir dynamiquement le `Page` l’objet `MasterPageFile` propriété basée sur une variable de Session.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-272">In the preceding tutorial we enhanced the `BasePage` class to dynamically set the `Page` object's `MasterPageFile` property based on a Session variable.</span></span> <span data-ttu-id="0c9b1-273">Comment pour nous prenons en charge des pages maîtres dynamiques lors de l’utilisation des pages maîtres imbriquées ?</span><span class="sxs-lookup"><span data-stu-id="0c9b1-273">How to we support dynamic master pages when using nested master pages?</span></span>

<span data-ttu-id="0c9b1-274">Ces deux défis ferez apparaître comme nous générer la page maître imbriquée et l’utiliser à partir de nos pages de contenu existants.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-274">These two challenges will surface as we build the nested master page and use it from our existing content pages.</span></span> <span data-ttu-id="0c9b1-275">Nous allons examiner et supprimer ces problèmes lorsqu’ils surviennent.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-275">We'll investigate and surmount these issues as they arise.</span></span>

## <a name="step-4-creating-the-nested-master-page"></a><span data-ttu-id="0c9b1-276">Étape 4 : Création de la Page maître imbriquée</span><span class="sxs-lookup"><span data-stu-id="0c9b1-276">Step 4: Creating the Nested Master Page</span></span>

<span data-ttu-id="0c9b1-277">Notre première tâche consiste à créer la page maître imbriquée à utiliser par les pages dans la section Administration.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-277">Our first task is to create the nested master page to be used by the pages in the Administration section.</span></span> <span data-ttu-id="0c9b1-278">Comme nous l’avons vu à l’étape 2, lors de l’ajout d’une nouvelle nested page maître, nous devons spécifier la page maître du parent de la page maître imbriquée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-278">As we saw in Step 2, when adding a new nested master page we need to specify the nested master page's parent master page.</span></span> <span data-ttu-id="0c9b1-279">Mais nous avons deux pages maîtres de niveau supérieur : `Site.master` et `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-279">But we have two top-level master pages: `Site.master` and `Alternate.master`.</span></span> <span data-ttu-id="0c9b1-280">Rappelez-vous que nous avons créé `Alternate.master` dans le didacticiel précédent et écrit du code le `BasePage` cet ensemble de la classe la `Page` l’objet `MasterPageFile` propriété lors de l’exécution soit `Site.master` ou `Alternate.master` selon la valeur de la `MyMasterPage` Variable de session.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-280">Recall that we created `Alternate.master` in the preceding tutorial and wrote code in the `BasePage` class that set the `Page` object's `MasterPageFile` property at runtime to either `Site.master` or `Alternate.master` depending on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="0c9b1-281">Comment nous configurer notre page maître imbriquée afin qu’il utilise la page maître de niveau supérieur approprié ?</span><span class="sxs-lookup"><span data-stu-id="0c9b1-281">How do we configure our nested master page so that it uses the appropriate top-level master page?</span></span> <span data-ttu-id="0c9b1-282">Nous avons deux options :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-282">We have two options:</span></span>

- <span data-ttu-id="0c9b1-283">Créer deux pages maîtres imbriquées, `AdminNestedSite.master` et `AdminNestedAlternate.master`et les lier aux pages maîtres niveau supérieur `Site.master` et `Alternate.master`, respectivement.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-283">Create two nested master pages, `AdminNestedSite.master` and `AdminNestedAlternate.master`, and bind them to the top-level master pages `Site.master` and `Alternate.master`, respectively.</span></span> <span data-ttu-id="0c9b1-284">Dans `BasePage`, ensuite, nous affectons la `Page` l’objet `MasterPageFile` à la page maître imbriquée appropriée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-284">In `BasePage`, then, we'd set the `Page` object's `MasterPageFile` to the appropriate nested master page.</span></span>
- <span data-ttu-id="0c9b1-285">Créer une page maître imbriquée unique et les pages de contenu utilisent cette page maître particulier.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-285">Create a single nested master page and have the content pages use this particular master page.</span></span> <span data-ttu-id="0c9b1-286">Ensuite, lors de l’exécution, nous devons définir la page maître imbriquée `MasterPageFile` propriété à la page maître de niveau supérieur appropriée lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-286">Then, at runtime, we'd need to set the nested master page's `MasterPageFile` property to the appropriate top-level master page at runtime.</span></span> <span data-ttu-id="0c9b1-287">(Comme vous pouvez avez deviné, pages maîtres ont également un `MasterPageFile` propriété.)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-287">(As you might have figured out by now, master pages also have a `MasterPageFile` property.)</span></span>

<span data-ttu-id="0c9b1-288">Nous allons utiliser la deuxième option.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-288">Let's use the second option.</span></span> <span data-ttu-id="0c9b1-289">Créer un fichier page maître imbriquée unique dans le `~/Admin` dossier nommé `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-289">Create a single nested master page file in the `~/Admin` folder named `AdminNested.master`.</span></span> <span data-ttu-id="0c9b1-290">Étant donné que les deux `Site.master` et `Alternate.master` ont le même ensemble de contrôles ContentPlaceHolder, peu importe quelle page maître vous liez à, bien que je vous encourage à lier à `Site.master` pour des raisons de sécurité de la cohérence.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-290">Because both `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls, it doesn't matter what master page you bind it to, although I encourage you to bind it to `Site.master` for consistency's sake.</span></span>


<span data-ttu-id="0c9b1-291">[![Ajouter une Page maître imbriquée dans le dossier ~/Admin.](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-291">[![Add a Nested Master Page to the ~/Admin Folder.](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span></span>

<span data-ttu-id="0c9b1-292">**Figure 09**: Ajouter une Page maître imbriquée à la `~/Admin` dossier.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-292">**Figure 09**: Add a Nested Master Page to the `~/Admin` Folder.</span></span> <span data-ttu-id="0c9b1-293">([Cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-293">([Click to view full-size image](nested-master-pages-vb/_static/image27.png))</span></span>


<span data-ttu-id="0c9b1-294">Étant donné que la page maître imbriquée est liée à une page maître avec quatre contrôles ContentPlaceHolder, Visual Studio ajoute quatre contrôles de contenu pour un balisage initial du nouveau fichier page maître imbriquée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-294">Because the nested master page is bound to a master page with four ContentPlaceHolder controls, Visual Studio adds four Content controls to the new nested master page file's initial markup.</span></span> <span data-ttu-id="0c9b1-295">Comme nous l’avons fait dans les étapes 2 et 3, ajoutez un contrôle ContentPlaceHolder dans chaque contrôle de contenu, en lui donnant le même nom qu’un contrôle ContentPlaceHolder le niveau supérieur de la page maître.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-295">Like we did in Steps 2 and 3, add a ContentPlaceHolder control in each Content control, giving it the same name as the top-level master page's ContentPlaceHolder control.</span></span> <span data-ttu-id="0c9b1-296">Ajoutez également le balisage suivant au contrôle de contenu qui correspond à la `MainContent` ContentPlaceHolder :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-296">Also add the following markup to the Content control that corresponds to the `MainContent` ContentPlaceHolder:</span></span>


[!code-html[Main](nested-master-pages-vb/samples/sample8.html)]

<span data-ttu-id="0c9b1-297">Ensuite, définissez le `instructions` de classe CSS dans le `Styles.css` et `AlternateStyles.css` fichiers CSS.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-297">Next, define the `instructions` CSS class in the `Styles.css` and `AlternateStyles.css` CSS files.</span></span> <span data-ttu-id="0c9b1-298">Les règles CSS suivantes provoquent des éléments HTML mise en forme en la `instructions` classe à afficher avec une couleur d’arrière-plan jaune et une bordure noire unie :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-298">The following CSS rules cause HTML elements styled with the `instructions` class to be displayed with a light yellow background color and a black, solid border:</span></span>


[!code-css[Main](nested-master-pages-vb/samples/sample9.css)]

<span data-ttu-id="0c9b1-299">Étant donné que ce balisage a été ajouté à la page maître imbriquée, il apparaît uniquement dans les pages qui utilisent cette page maître imbriquée (à savoir, les pages dans la section Administration).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-299">Because this markup has been added to the nested master page, it will only appear in those pages that use this nested master page (namely, the pages in the Administration section).</span></span>

<span data-ttu-id="0c9b1-300">Après avoir apporté ces ajouts à votre page maître imbriquée, son balisage déclaratif doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-300">After making these additions to your nested master page, its declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample10.aspx)]

<span data-ttu-id="0c9b1-301">Notez que chaque contrôle de contenu a un contrôle ContentPlaceHolder et que les contrôles ContentPlaceHolder `ID` propriétés reçoivent les mêmes valeurs que les contrôles ContentPlaceHolder correspondants dans la page maître de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-301">Note that each Content control has a ContentPlaceHolder control and that the ContentPlaceHolder controls' `ID` properties are assigned the same values as the corresponding ContentPlaceHolder controls in the top-level master page.</span></span> <span data-ttu-id="0c9b1-302">En outre, le balisage spécifique à la section Administration apparaît dans le `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-302">Moreover, the Administration section-specific markup appears in the `MainContent` ContentPlaceHolder.</span></span>

<span data-ttu-id="0c9b1-303">La figure 10 illustre le `AdminNested.master` page maître imbriquée lorsqu’ils sont affichés via le Concepteur de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-303">Figure 10 shows the `AdminNested.master` nested master page when viewed through Visual Studio's Designer.</span></span> <span data-ttu-id="0c9b1-304">Vous pouvez voir les instructions dans la zone jaune en haut de la `MainContent` contrôle de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-304">You can see the instructions in the yellow box at the top of the `MainContent` Content control.</span></span>


<span data-ttu-id="0c9b1-305">[![La Page maître imbriquée s’étend à la Page maître de niveau supérieur pour inclure des Instructions pour l’administrateur.](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-305">[![The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span></span>

<span data-ttu-id="0c9b1-306">**Figure 10**: La Page maître imbriquée s’étend à la Page maître de niveau supérieur pour inclure des Instructions pour l’administrateur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-306">**Figure 10**: The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.</span></span> <span data-ttu-id="0c9b1-307">([Cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-307">([Click to view full-size image](nested-master-pages-vb/_static/image30.png))</span></span>


## <a name="step-5-updating-the-existing-content-pages-to-use-the-new-nested-master-page"></a><span data-ttu-id="0c9b1-308">Étape 5 : La mise à jour les Pages de contenu existants pour utiliser la nouvelle Page maître imbriquée</span><span class="sxs-lookup"><span data-stu-id="0c9b1-308">Step 5: Updating the Existing Content Pages to Use the New Nested Master Page</span></span>

<span data-ttu-id="0c9b1-309">Chaque fois que nous ajoutons une nouvelle page de contenu à la section d’Administration que nous devons liez-le à le `AdminNested.master` page maître que nous venons de créer.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-309">Anytime we add a new content page to the Administration section we need to bind it to the `AdminNested.master` master page we just created.</span></span> <span data-ttu-id="0c9b1-310">Mais qu’en est-il des existant pages de contenu ?</span><span class="sxs-lookup"><span data-stu-id="0c9b1-310">But what about the existing content pages?</span></span> <span data-ttu-id="0c9b1-311">Actuellement, toutes les pages de contenu sur le site de dérivent à partir de la `BasePage` classe, qui définit par programme le contenu de page maître lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-311">Currently, all content pages in the site derive from the `BasePage` class, which programmatically sets the content page's master page at runtime.</span></span> <span data-ttu-id="0c9b1-312">Cela n’est pas le comportement souhaité pour les pages de contenu dans la section Administration.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-312">This is not the behavior we want for the content pages in the Administration section.</span></span> <span data-ttu-id="0c9b1-313">Au lieu de cela, nous voulons ces pages de contenu à toujours utiliser le `AdminNested.master` page.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-313">Instead, we want these content pages to always use the `AdminNested.master` page.</span></span> <span data-ttu-id="0c9b1-314">Il sera la responsabilité de la page maître imbriquée pour choisir la page de contenu à droite de niveau supérieur lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-314">It will be the responsibility of the nested master page to choose the right top-level content page at runtime.</span></span>

<span data-ttu-id="0c9b1-315">À la meilleure façon d’atteindre ce souhaité comportement consiste à créer une nouvelle classe de page de base personnalisée nommée `AdminBasePage` qui étend la `BasePage` classe.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-315">To best way to achieve this desired behavior is to create a new custom base page class named `AdminBasePage` that extends the `BasePage` class.</span></span> <span data-ttu-id="0c9b1-316">`AdminBasePage` pouvez ensuite substituer les `SetMasterPageFile` et définir le `Page` l’objet `MasterPageFile` à la valeur codée en dur « ~ / Admin/AdminNested.master ».</span><span class="sxs-lookup"><span data-stu-id="0c9b1-316">`AdminBasePage` can then override the `SetMasterPageFile` and set the `Page` object's `MasterPageFile` to the hard-coded value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="0c9b1-317">De cette façon, n’importe quelle page qui dérive de `AdminBasePage` utilisera `AdminNested.master`, tandis que n’importe quelle page qui dérive de `BasePage` aura son `MasterPageFile` propriété la valeur dynamiquement » ~ / Site.master » ou « ~ / Alternate.master » selon la valeur de la `MyMasterPage` Variable de session.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-317">In this way, any page that derives from `AdminBasePage` will use `AdminNested.master`, whereas any page that derives from `BasePage` will have its `MasterPageFile` property set dynamically to either "~/Site.master" or "~/Alternate.master" based on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="0c9b1-318">Commencez par ajouter un nouveau fichier de classe à la `App_Code` dossier nommé `AdminBasePage.vb`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-318">Start by adding a new class file to the `App_Code` folder named `AdminBasePage.vb`.</span></span> <span data-ttu-id="0c9b1-319">Avez `AdminBasePage` étendre `BasePage` , puis vous remplacez le `SetMasterPageFile` (méthode).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-319">Have `AdminBasePage` extend `BasePage` and then override the `SetMasterPageFile` method.</span></span> <span data-ttu-id="0c9b1-320">Dans cette méthode affecter le `MasterPageFile` la valeur « ~ / Admin/AdminNested.master ».</span><span class="sxs-lookup"><span data-stu-id="0c9b1-320">In that method assign the `MasterPageFile` the value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="0c9b1-321">Après avoir apporté ces modifications à votre classe de fichier doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-321">After making these changes your class file should look similar to the following:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample11.vb)]

<span data-ttu-id="0c9b1-322">Nous devons maintenant avoir les pages de contenu existants dans la section dériver à partir de l’Administration `AdminBasePage` au lieu de `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-322">We now need to have the existing content pages in the Administration section derive from `AdminBasePage` instead of `BasePage`.</span></span> <span data-ttu-id="0c9b1-323">Accédez au fichier de classe code-behind pour chaque page de contenu dans le `~/Admin` dossier et apporter cette modification.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-323">Go to the code-behind class file for each content page in the `~/Admin` folder and make this change.</span></span> <span data-ttu-id="0c9b1-324">Par exemple, dans `~/Admin/Default.aspx` vous modifieriez la déclaration de classe code-behind à partir de :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-324">For example, in `~/Admin/Default.aspx` you'd change the code-behind class declaration from:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample12.vb)]

<span data-ttu-id="0c9b1-325">À :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-325">To:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample13.vb)]

<span data-ttu-id="0c9b1-326">Figure 11 illustre comment la page maître de niveau supérieur (`Site.master` ou `Alternate.master`), la page maître imbriquée (`AdminNested.master`), et les pages de contenu de la section Administration sont liés entre eux.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-326">Figure 11 depicts how the top-level master page (`Site.master` or `Alternate.master`), the nested master page (`AdminNested.master`), and the Administration section content pages relate to one another.</span></span>


<span data-ttu-id="0c9b1-327">[![La Page maître imbriquée définit le contenu spécifique aux Pages dans la Section Administration](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-327">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span></span>

<span data-ttu-id="0c9b1-328">**Figure 11**: L’imbriqués Master Page définit contenu spécifique aux Pages dans la Section Administration ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-328">**Figure 11**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image33.png))</span></span>


## <a name="step-6-mirroring-the-master-pages-public-methods-and-properties"></a><span data-ttu-id="0c9b1-329">Étape 6 : Mise en miroir des propriétés et méthodes publiques de la Page maître</span><span class="sxs-lookup"><span data-stu-id="0c9b1-329">Step 6: Mirroring the Master Page's Public Methods and Properties</span></span>

<span data-ttu-id="0c9b1-330">N’oubliez pas que le `~/Admin/AddProduct.aspx` et `~/Admin/Products.aspx` pages interagissent par programmation avec la page maître : `~/Admin/AddProduct.aspx` appelle la page maître publique du `RefreshRecentProductsGrid` (méthode) et définit ses `GridMessageText` propriété ; `~/Admin/Products.aspx` a un gestionnaire d’événements pour le `PricesDoubled` événement.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-330">Recall that the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages interact programmatically with the master page: `~/Admin/AddProduct.aspx` calls the master page's public `RefreshRecentProductsGrid` method and sets its `GridMessageText` property; `~/Admin/Products.aspx` has an event handler for the `PricesDoubled` event.</span></span> <span data-ttu-id="0c9b1-331">Dans le didacticiel précédent, nous avons créé un `MustInherit` `BaseMasterPage` classe qui a défini ces membres publics.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-331">In the preceding tutorial we created a `MustInherit` `BaseMasterPage` class that defined these public members.</span></span>

<span data-ttu-id="0c9b1-332">Le `~/Admin/AddProduct.aspx` et `~/Admin/Products.aspx` pages supposent que leur page maître dérive le `BaseMasterPage` classe.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-332">The `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages assume that their master page derives from the `BaseMasterPage` class.</span></span> <span data-ttu-id="0c9b1-333">Le `AdminNested.master` page, cependant, actuellement étend la `System.Web.UI.MasterPage` classe.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-333">The `AdminNested.master` page, however, currently extends the `System.Web.UI.MasterPage` class.</span></span> <span data-ttu-id="0c9b1-334">Par conséquent, lors de la visite `~/Admin/Products.aspx` un `InvalidCastException` est levée avec le message : « Impossible de convertit un objet de type ' ASP.admin\_adminnested\_maître ' en type 'BaseMasterPage'. »</span><span class="sxs-lookup"><span data-stu-id="0c9b1-334">As a result, when visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown with the message: "Unable to cast object of type 'ASP.admin\_adminnested\_master' to type 'BaseMasterPage'."</span></span>

<span data-ttu-id="0c9b1-335">Pour corriger cela nous devons disposer le `AdminNested.master` étendre la classe code-behind `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-335">To fix this we need to have the `AdminNested.master` code-behind class extend `BaseMasterPage`.</span></span> <span data-ttu-id="0c9b1-336">Mettre à jour de la déclaration de classe code-behind de la page maître imbriquée à partir de :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-336">Update the nested master page's code-behind class declaration from:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample14.vb)]

<span data-ttu-id="0c9b1-337">À :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-337">To:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample15.vb)]

<span data-ttu-id="0c9b1-338">Nous n’avons pas encore terminé.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-338">We're not done yet.</span></span> <span data-ttu-id="0c9b1-339">Nous devons substituer les membres marqués comme `MustOverride`, à savoir `RefreshRecentProductsGrid` et `GridMessageText`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-339">We need to override the members marked as `MustOverride`, namely `RefreshRecentProductsGrid` and `GridMessageText`.</span></span> <span data-ttu-id="0c9b1-340">Ces membres sont utilisés par les pages maîtres de niveau supérieur pour mettre à jour leurs interfaces utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-340">These members are used by the top-level master pages to update their user interfaces.</span></span> <span data-ttu-id="0c9b1-341">(En fait, seul le `Site.master` page maître utilise ces méthodes, bien que les deux pages maîtres de niveau supérieur implémentent ces méthodes, étant donné que les deux étendent `BaseMasterPage`.)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-341">(Actually, only the `Site.master` master page uses these methods, although both top-level master pages implement these methods, since both extend `BaseMasterPage`.)</span></span>

<span data-ttu-id="0c9b1-342">Bien que nous devons implémenter ces membres dans `AdminNested.master`, il suffit ces implémentations est simplement appeler le même membre dans la page maître de niveau supérieur utilisée par la page maître imbriquée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-342">While we need to implement these members in `AdminNested.master`, all these implementations need to do is simply call the same member in the top-level master page used by the nested master page.</span></span> <span data-ttu-id="0c9b1-343">Par exemple, lorsqu’une page de contenu dans la section Administration appelle la page maître imbriquée `RefreshRecentProductsGrid` (méthode), la page maître imbriquée suffit à faire est, à son tour, appelez `Site.master` ou `Alternate.master`de `RefreshRecentProductsGrid` (méthode).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-343">For instance, when a content page in the Administration section calls the nested master page's `RefreshRecentProductsGrid` method, all the nested master page needs to do is, in turn, call `Site.master` or `Alternate.master`'s `RefreshRecentProductsGrid` method.</span></span>

<span data-ttu-id="0c9b1-344">Pour ce faire, démarrez en ajoutant le code suivant `@MasterType` directive au début du `AdminNested.master`:</span><span class="sxs-lookup"><span data-stu-id="0c9b1-344">To achieve this, start by adding the following `@MasterType` directive to the top of `AdminNested.master`:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample16.aspx)]

<span data-ttu-id="0c9b1-345">N’oubliez pas que le `@MasterType` directive ajoute une propriété fortement typée à la classe code-behind nommée `Master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-345">Recall that the `@MasterType` directive adds a strongly-typed property to the code-behind class named `Master`.</span></span> <span data-ttu-id="0c9b1-346">Substituez ensuite la `RefreshRecentProductsGrid` et `GridMessageText` membres et vous déléguez simplement l’appel à la `Master`correspondante de méthode du :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-346">Then override the `RefreshRecentProductsGrid` and `GridMessageText` members and simply delegate the call to the `Master`'s corresponding method:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample17.vb)]

<span data-ttu-id="0c9b1-347">Avec ce code en place, vous pourrez consultez et utilisez les pages de contenu dans la section Administration.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-347">With this code in place, you should be able to visit and use the content pages in the Administration section.</span></span> <span data-ttu-id="0c9b1-348">La figure 12 illustre le `~/Admin/Products.aspx` page lorsqu’ils sont affichés via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-348">Figure 12 shows the `~/Admin/Products.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="0c9b1-349">Comme vous pouvez le voir, cette page inclut la zone des Instructions d’Administration, qui est définie dans la page maître imbriquée.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-349">As you can see, the page includes the Administration Instructions box, which is defined in the nested master page.</span></span>


<span data-ttu-id="0c9b1-350">[![Les Pages de contenu dans la Section Administration incluent des Instructions en haut de chaque Page](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-350">[![The Content Pages in the Administration Section Include Instructions at the Top of Each Page](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span></span>

<span data-ttu-id="0c9b1-351">**Figure 12**: Les Pages de contenu dans l’Administration Section incluent des Instructions sur le haut de chaque Page ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-351">**Figure 12**: The Content Pages in the Administration Section Include Instructions at the Top of Each Page ([Click to view full-size image](nested-master-pages-vb/_static/image36.png))</span></span>


## <a name="step-7-using-the-appropriate-top-level-master-page-at-runtime"></a><span data-ttu-id="0c9b1-352">Étape 7 : À l’aide de la Page principale de niveau supérieur appropriée lors de l’exécution</span><span class="sxs-lookup"><span data-stu-id="0c9b1-352">Step 7: Using the Appropriate Top-Level Master Page at Runtime</span></span>

<span data-ttu-id="0c9b1-353">Alors que toutes les pages de contenu dans la section Administration entièrement fonctionnels, ils utilisent tous la même page maître de niveau supérieur et ignorer la page maître sélectionnée par l’utilisateur au niveau `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-353">While all the content pages in the Administration section are fully functional, they all use the same top-level master page and ignore the master page selected by the user at `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="0c9b1-354">Ce comportement est dû au fait que la page maître imbriquée a son `MasterPageFile` propriété à affecter statiquement aux `Site.master` dans son `<%@ Master %>` directive.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-354">This behavior is due to the fact that the nested master page has its `MasterPageFile` property statically set to `Site.master` in its `<%@ Master %>` directive.</span></span>

<span data-ttu-id="0c9b1-355">Pour utiliser la page maître de niveau supérieur sélectionnée par l’utilisateur final, nous devons définir la `AdminNested.master`de `MasterPageFile` valeur à la propriété dans le `MyMasterPage` variable de Session.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-355">To use the top-level master page selected by the end user we need to set the `AdminNested.master`'s `MasterPageFile` property to the value in the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="0c9b1-356">Car nous avons défini les pages de contenu `MasterPageFile` propriétés dans `BasePage`, vous pouvez penser que nous affectons la page maître imbriquée `MasterPageFile` propriété dans `BaseMasterPage` ou dans le `AdminNested.master`de classe code-behind.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-356">Because we set the content pages' `MasterPageFile` properties in `BasePage`, you may think that we would set the nested master page's `MasterPageFile` property in `BaseMasterPage` or in the `AdminNested.master`'s code-behind class.</span></span> <span data-ttu-id="0c9b1-357">Cela ne fonctionne pas, toutefois, étant donné que nous devons avoir défini le `MasterPageFile` propriété à la fin de la phase PreInit.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-357">This won't work, however, because we need to have set the `MasterPageFile` property by the end of the PreInit stage.</span></span> <span data-ttu-id="0c9b1-358">L’heure plus tôt que nous pouvons exploiter par programmation sur le cycle de vie de page à partir d’une page maître est l’étape Init (ce qui se produit après l’étape PreInit).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-358">The earliest time that we can programmatically tap into the page lifecycle from a master page is the Init stage (which occurs after the PreInit stage).</span></span>

<span data-ttu-id="0c9b1-359">Par conséquent, nous devons définir la page maître imbriquée `MasterPageFile` propriété à partir des pages de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-359">Therefore, we need to set the nested master page's `MasterPageFile` property from the content pages.</span></span> <span data-ttu-id="0c9b1-360">Seul le contenu des pages qui utilisent le `AdminNested.master` dérivent de la page maître `AdminBasePage`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-360">The only content pages that use the `AdminNested.master` master page derive from `AdminBasePage`.</span></span> <span data-ttu-id="0c9b1-361">Par conséquent, nous pouvons placées cette logique.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-361">Therefore, we can put this logic there.</span></span> <span data-ttu-id="0c9b1-362">À l’étape 5 nous a remplacé le `SetMasterPageFile` méthode, en définissant l’objet Page `MasterPageFile` propriété à « ~ / Admin/AdminNested.master ».</span><span class="sxs-lookup"><span data-stu-id="0c9b1-362">In Step 5 we overrode the `SetMasterPageFile` method, setting the Page object's `MasterPageFile` property to "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="0c9b1-363">Mise à jour `SetMasterPageFile` également définir la page maître `MasterPageFile` propriété pour le résultat stocké dans la Session :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-363">Update `SetMasterPageFile` to also set the master page's `MasterPageFile` property to the result stored in Session:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample18.vb)]

<span data-ttu-id="0c9b1-364">Le `GetMasterPageFileFromSession` (méthode), ce qui nous avons ajouté à la `BasePage` classe dans le didacticiel précédent, retourne le chemin d’accès du fichier de page maître approprié selon la valeur de variable de Session.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-364">The `GetMasterPageFileFromSession` method, which we added to the `BasePage` class in the preceding tutorial, returns the appropriate master page file path based on the Session variable value.</span></span>

<span data-ttu-id="0c9b1-365">Avec cette modification en place, sélection de page maître de l’utilisateur s’appliquent à la section Administration.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-365">With this change in place, the user's master page selection carries over to the Administration section.</span></span> <span data-ttu-id="0c9b1-366">La figure 13 montre la même page, comme la Figure 12, mais une fois que l’utilisateur a changé sa sélection de page maître pour `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-366">Figure 13 shows the same page as Figure 12, but after the user has changed their master page selection to `Alternate.master`.</span></span>


<span data-ttu-id="0c9b1-367">[![La Page d’Administration imbriquée utilise la Page principale de niveau supérieur sélectionné par l’utilisateur](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-367">[![The Nested Administration Page Uses the Top-Level Master Page Selected by the User](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span></span>

<span data-ttu-id="0c9b1-368">**Figure 13**: La Page d’Administration Nested utilise la Page de principale de niveau supérieur sélectionné par l’utilisateur ([cliquez pour afficher l’image en taille réelle](nested-master-pages-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="0c9b1-368">**Figure 13**: The Nested Administration Page Uses the Top-Level Master Page Selected by the User ([Click to view full-size image](nested-master-pages-vb/_static/image39.png))</span></span>


## <a name="summary"></a><span data-ttu-id="0c9b1-369">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="0c9b1-369">Summary</span></span>

<span data-ttu-id="0c9b1-370">Quantité pages de contenu comment like peuvent lier à une page maître, il est possible de créer une prédiction imbriquée des pages maîtres par une page maître enfant lient à une page maître parente.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-370">Much like how content pages can bind to a master page, it is possible to create nested master pages by having a child master page bind to a parent master page.</span></span> <span data-ttu-id="0c9b1-371">La page maître enfant peut définir des contrôles de contenu pour chacun des ContentPlaceHolders de son parent ; elle peut ensuite ajouter ses propres contrôles ContentPlaceHolder (ainsi que d’autres balises) pour ces contrôles de contenu.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-371">The child master page may define Content controls for each of its parent's ContentPlaceHolders; it can then add its own ContentPlaceHolder controls (as well as other markup) to these Content controls.</span></span> <span data-ttu-id="0c9b1-372">Les pages maîtres imbriquées sont très utiles dans les applications web de grande taille dont toutes les pages partagent un aspect global, mais certaines sections du site requièrent des personnalisations uniques.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-372">Nested master pages are quite useful in large web applications where all pages share an overarching look and feel, yet certain sections of the site require unique customizations.</span></span>

<span data-ttu-id="0c9b1-373">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="0c9b1-373">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="0c9b1-374">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="0c9b1-374">Further Reading</span></span>

<span data-ttu-id="0c9b1-375">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="0c9b1-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="0c9b1-376">Pages maître ASP.NET imbriquées</span><span class="sxs-lookup"><span data-stu-id="0c9b1-376">Nested ASP.NET Master Pages</span></span>](https://msdn.microsoft.com/library/x2b3ktt7.aspx)
- [<span data-ttu-id="0c9b1-377">Conseils pour les Pages maîtres imbriquées et de conception de Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="0c9b1-377">Tips for Nested Master Pages and VS 2005 Design-Time</span></span>](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx)
- [<span data-ttu-id="0c9b1-378">Visual Studio 2008 imbriqués prise en charge de la Page maître</span><span class="sxs-lookup"><span data-stu-id="0c9b1-378">VS 2008 Nested Master Page Support</span></span>](https://weblogs.asp.net/scottgu/archive/2007/07/09/vs-2008-nested-master-page-support.aspx)

### <a name="about-the-author"></a><span data-ttu-id="0c9b1-379">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="0c9b1-379">About the Author</span></span>

<span data-ttu-id="0c9b1-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de plusieurs livres de sur ASP/ASP.NET et fondateur de 4GuysFromRolla.com, travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0c9b1-381">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-381">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0c9b1-382">Son dernier livre s’intitule [ *Sams Teach vous-même ASP.NET 3.5 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-382">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="0c9b1-383">Scott peut être atteint à [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) ou via son blog à [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="0c9b1-383">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="0c9b1-384">Remerciements</span><span class="sxs-lookup"><span data-stu-id="0c9b1-384">Special Thanks To</span></span>

<span data-ttu-id="0c9b1-385">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="0c9b1-385">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0c9b1-386">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="0c9b1-386">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0c9b1-387">Dans ce cas, envoyez-moi une ligne à [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0c9b1-387">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0c9b1-388">Précédent</span><span class="sxs-lookup"><span data-stu-id="0c9b1-388">Previous</span></span>](specifying-the-master-page-programmatically-vb.md)
