---
uid: web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
title: URL dans les pages maîtres (VB) | Microsoft Docs
author: rick-anderson
description: Résout le risque de rupture des URL dans la page maître en raison du fait que le fichier de la page maître se trouve dans un répertoire relatif différent de la page de contenu. Recherche la relocalisation...
ms.author: riande
ms.date: 06/10/2008
ms.assetid: 43d1e83c-0092-4dcf-977c-e709c4dce7c3
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 01627988f68bb619969a5fe3cfaae68fe70b5d4f
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78548110"
---
# <a name="urls-in-master-pages-vb"></a><span data-ttu-id="e35fe-104">URL dans les pages maîtres (VB)</span><span class="sxs-lookup"><span data-stu-id="e35fe-104">URLs in Master Pages (VB)</span></span>

<span data-ttu-id="e35fe-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e35fe-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e35fe-106">[Télécharger le code](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) ou [Télécharger le PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="e35fe-106">[Download Code](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) or [Download PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span></span>

> <span data-ttu-id="e35fe-107">Résout le risque de rupture des URL dans la page maître en raison du fait que le fichier de la page maître se trouve dans un répertoire relatif différent de la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="e35fe-107">Addresses how URLs in the master page can break due to the master page file being in a different relative directory than the content page.</span></span> <span data-ttu-id="e35fe-108">Examine la relocalisation des URL via ~ dans la syntaxe déclarative et l’utilisation de ResolveUrl et ResolveClientUrl par programmation.</span><span class="sxs-lookup"><span data-stu-id="e35fe-108">Looks at rebasing URLs via ~ in the declarative syntax and using ResolveUrl and ResolveClientUrl programmatically.</span></span> <span data-ttu-id="e35fe-109">(Consultez également</span><span class="sxs-lookup"><span data-stu-id="e35fe-109">(Also look at</span></span>

## <a name="introduction"></a><span data-ttu-id="e35fe-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="e35fe-110">Introduction</span></span>

<span data-ttu-id="e35fe-111">Dans tous les exemples que nous avons vus jusqu’à présent, les pages maître et de contenu se trouvent dans le même dossier (le dossier racine du site Web).</span><span class="sxs-lookup"><span data-stu-id="e35fe-111">In all the examples we've seen thus far, the master and content pages have been located in the same folder (the website's root folder).</span></span> <span data-ttu-id="e35fe-112">Mais il n’y a aucune raison pour laquelle les pages maîtres et de contenu doivent se trouver dans le même dossier.</span><span class="sxs-lookup"><span data-stu-id="e35fe-112">But there's no reason why the master and content pages must be in the same folder.</span></span> <span data-ttu-id="e35fe-113">Vous pouvez certainement créer des pages de contenu dans des sous-dossiers.</span><span class="sxs-lookup"><span data-stu-id="e35fe-113">You can certainly create content pages in subfolders.</span></span> <span data-ttu-id="e35fe-114">De même, vous pouvez créer un dossier `~/MasterPages/` dans lequel vous placez les pages maîtres de votre site.</span><span class="sxs-lookup"><span data-stu-id="e35fe-114">Similarly, you might create a `~/MasterPages/` folder where you place your site's master pages.</span></span>

<span data-ttu-id="e35fe-115">L’un des problèmes potentiels liés au placement de pages maîtres et de contenu dans des dossiers distincts implique des URL rompues.</span><span class="sxs-lookup"><span data-stu-id="e35fe-115">One potential issue with placing master and content pages in different folders involves broken URLs.</span></span> <span data-ttu-id="e35fe-116">Si la page maître contient des URL relatives dans des liens hypertexte, des images ou d’autres éléments, le lien n’est pas valide pour les pages de contenu qui se trouvent dans un dossier différent.</span><span class="sxs-lookup"><span data-stu-id="e35fe-116">If the master page contains relative URLs in hyperlinks, images, or other elements, the link will be invalid for content pages that reside in a different folder.</span></span> <span data-ttu-id="e35fe-117">Dans ce didacticiel, nous examinons la source de ce problème, ainsi que les solutions de contournement.</span><span class="sxs-lookup"><span data-stu-id="e35fe-117">In this tutorial we examine the source of this problem as well as workarounds.</span></span>

## <a name="the-problem-with-relative-urls"></a><span data-ttu-id="e35fe-118">Le problème avec les URL relatives</span><span class="sxs-lookup"><span data-stu-id="e35fe-118">The Problem with Relative URLs</span></span>

<span data-ttu-id="e35fe-119">Une URL sur une page Web est dite *URL relative* si l’emplacement de la ressource vers laquelle elle pointe est relatif à l’emplacement de la page Web dans la structure de dossiers du site Web.</span><span class="sxs-lookup"><span data-stu-id="e35fe-119">A URL on a web page is said to be a *relative URL* if the location of the resource it points to is relative to the web page's location in the website's folder structure.</span></span> <span data-ttu-id="e35fe-120">Les URL qui ne commencent pas par une barre oblique de début (`/`) ou un protocole (tel que `http://`) sont relatives, car elles sont résolues par le navigateur en fonction de l’emplacement de la page Web qui contient l’URL.</span><span class="sxs-lookup"><span data-stu-id="e35fe-120">Any URL that does not start with a leading forward slash (`/`) or a protocol (such as `http://`) is relative because it is resolved by the browser based on the location of the web page that contains the URL.</span></span>

<span data-ttu-id="e35fe-121">Par exemple, notre site Web contient un dossier `~/Images/` avec un fichier image unique, `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-121">For example, our website has an `~/Images/` folder with a single image file, `PoweredByASPNET.gif`.</span></span> <span data-ttu-id="e35fe-122">Le fichier de page maître `Site.master` a un élément `<img>` dans la région `footerContent` avec le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="e35fe-122">The master page file `Site.master` has an `<img>` element in the `footerContent` region with the following markup:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample1.html)]

<span data-ttu-id="e35fe-123">La valeur d’attribut `src` dans l’élément `<img>` est une URL relative, car elle ne commence pas par `/` ou `http://`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-123">The `src` attribute value in the `<img>` element is a relative URL because it does not start with `/` or `http://`.</span></span> <span data-ttu-id="e35fe-124">En résumé, la valeur d’attribut `src` indique au navigateur d’examiner le sous-dossier `Images` pour un fichier nommé `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-124">In short, the `src` attribute value tells the browser to look in the `Images` subfolder for a file named `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="e35fe-125">Quand vous visitez une page de contenu, le balisage ci-dessus est envoyé directement au navigateur.</span><span class="sxs-lookup"><span data-stu-id="e35fe-125">When visiting a content page, the above markup is sent directly to the browser.</span></span> <span data-ttu-id="e35fe-126">Prenez un moment pour visiter `About.aspx` et afficher la source HTML envoyée au navigateur.</span><span class="sxs-lookup"><span data-stu-id="e35fe-126">Take a moment to visit `About.aspx` and view the HTML source sent to the browser.</span></span> <span data-ttu-id="e35fe-127">Vous constaterez que le même balisage dans la page maître a été envoyée au navigateur.</span><span class="sxs-lookup"><span data-stu-id="e35fe-127">You will find that the exact same markup in the master page was sent to the browser.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample2.html)]

<span data-ttu-id="e35fe-128">Si la page de contenu se trouve dans le dossier racine (comme c’est le cas `About.aspx`), tout fonctionne comme prévu, car il existe un sous-dossier `Images` relatif au dossier racine.</span><span class="sxs-lookup"><span data-stu-id="e35fe-128">If the content page is in the root folder (as is `About.aspx`) everything works as expected because there is an `Images` subfolder relative to the root folder.</span></span> <span data-ttu-id="e35fe-129">Toutefois, les choses s’interrompent si la page de contenu se trouve dans un dossier différent de celui de la page maître.</span><span class="sxs-lookup"><span data-stu-id="e35fe-129">However, things break down if the content page is in a different folder than the master page.</span></span> <span data-ttu-id="e35fe-130">Pour illustrer cela, créez un sous-dossier nommé `Admin`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-130">To illustrate this, create a subfolder named `Admin`.</span></span> <span data-ttu-id="e35fe-131">Ensuite, ajoutez une page de contenu nommée `Default.aspx` au dossier `Admin`, en veillant à lier la nouvelle page à la page maître `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-131">Next, add a content page named `Default.aspx` to the `Admin` folder, making sure to bind the new page to the `Site.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="e35fe-132">Dans le didacticiel [*spécification du titre, des balises meta et d’autres en-têtes HTML du didacticiel de la page maître,* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) nous avons créé une classe de page de base personnalisée nommée `BasePage` qui définit automatiquement le titre de la page de contenu (si elle n’a pas été explicitement assignée).</span><span class="sxs-lookup"><span data-stu-id="e35fe-132">In the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that automatically set the content page's title (if it was not explicitly assigned).</span></span> <span data-ttu-id="e35fe-133">N’oubliez pas que la classe code-behind de la page nouvellement créée dérive de `BasePage` pour pouvoir utiliser cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="e35fe-133">Don't forget to have the newly created page's code-behind class derive from `BasePage` so that it can utilize this functionality.</span></span>

<span data-ttu-id="e35fe-134">Une fois que vous avez créé cette page de contenu, votre Explorateur de solutions doit ressembler à la figure 1.</span><span class="sxs-lookup"><span data-stu-id="e35fe-134">After you have created this content page, your Solution Explorer should look similar to Figure 1.</span></span>

![Un nouveau dossier et une nouvelle page ASP.NET ont été ajoutés au projet](urls-in-master-pages-vb/_static/image1.png)

<span data-ttu-id="e35fe-136">**Figure 01**: un nouveau dossier et une nouvelle page ASP.net ont été ajoutés au projet</span><span class="sxs-lookup"><span data-stu-id="e35fe-136">**Figure 01**: A New Folder and ASP.NET Page Have Been Added to the Project</span></span>

<span data-ttu-id="e35fe-137">Ensuite, mettez à jour le fichier `Web.sitemap` pour inclure une nouvelle entrée `<siteMapNode>` pour cette leçon.</span><span class="sxs-lookup"><span data-stu-id="e35fe-137">Next, update the `Web.sitemap` file to include a new `<siteMapNode>` entry for this lesson.</span></span> <span data-ttu-id="e35fe-138">Le code XML suivant montre le balisage complet `Web.sitemap`, qui comprend désormais l’ajout d’un troisième élément `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-138">The following XML shows the complete `Web.sitemap` markup, which now includes the addition of a third `<siteMapNode>` element.</span></span>

[!code-xml[Main](urls-in-master-pages-vb/samples/sample3.xml)]

<span data-ttu-id="e35fe-139">La page de `Default.aspx` nouvellement créée doit avoir quatre contrôles de contenu correspondant aux quatre ContentPlaceHolders dans `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-139">The newly created `Default.aspx` page should have four Content controls corresponding to the four ContentPlaceHolders in `Site.master`.</span></span> <span data-ttu-id="e35fe-140">Ajoutez du texte au contrôle de contenu référençant le `MainContent` ContentPlaceHolder, puis accédez à la page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="e35fe-140">Add some text to the Content control referencing the `MainContent` ContentPlaceHolder and then visit the page through a browser.</span></span> <span data-ttu-id="e35fe-141">Comme le montre la figure 2, le navigateur ne peut pas trouver le fichier image `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-141">As Figure 2 shows, the browser cannot find the `PoweredByASPNET.gif` image file.</span></span> <span data-ttu-id="e35fe-142">Comment cela se fait-il ?</span><span class="sxs-lookup"><span data-stu-id="e35fe-142">What's going on here?</span></span>

<span data-ttu-id="e35fe-143">La page de contenu `~/Admin/Default.aspx` reçoit le même code HTML pour la région `footerContent` que la page `About.aspx` :</span><span class="sxs-lookup"><span data-stu-id="e35fe-143">The `~/Admin/Default.aspx` content page is sent the same HTML for the `footerContent` region as was the `About.aspx` page:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample4.html)]

<span data-ttu-id="e35fe-144">Étant donné que l’attribut `src` de l’élément `<img>` est une URL relative, le navigateur tente de rechercher un dossier `Images` relatif à l’emplacement du dossier de la page Web.</span><span class="sxs-lookup"><span data-stu-id="e35fe-144">Because the `<img>` element's `src` attribute is a relative URL, the browser attempts to look for an `Images` folder relative to the web page's folder location.</span></span> <span data-ttu-id="e35fe-145">En d’autres termes, le navigateur recherche le fichier image `Admin/Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-145">In other words, the browser is looking for the image file `Admin/Images/PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="e35fe-146">[![le fichier image PoweredByASPNET. gif est introuvable](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="e35fe-146">[![The PoweredByASPNET.gif Image File Cannot Be Found](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="e35fe-147">**Figure 02**: le fichier image `PoweredByASPNET.gif` est introuvable ([cliquez pour afficher l’image en taille réelle](urls-in-master-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="e35fe-147">**Figure 02**: The `PoweredByASPNET.gif` Image File Cannot Be Found  ([Click to view full-size image](urls-in-master-pages-vb/_static/image4.png))</span></span>

### <a name="replacing-relative-urls-with-absolute-urls"></a><span data-ttu-id="e35fe-148">Remplacement des URL relatives par des URL absolues</span><span class="sxs-lookup"><span data-stu-id="e35fe-148">Replacing Relative URLs with Absolute URLs</span></span>

<span data-ttu-id="e35fe-149">L’inverse d’une URL relative est une *URL absolue*, qui est une URL qui commence par une barre oblique (`/`) ou un protocole tel que `http://`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-149">The opposite of a relative URL is an *absolute URL*, which is one that starts with a forward slash (`/`) or a protocol such as `http://`.</span></span> <span data-ttu-id="e35fe-150">Étant donné qu’une URL absolue spécifie l’emplacement d’une ressource à partir d’un point fixe connu, la même URL absolue est valide dans n’importe quelle page Web, quel que soit l’emplacement de la page Web dans la structure de dossiers du site Web.</span><span class="sxs-lookup"><span data-stu-id="e35fe-150">Because an absolute URL specifies the location of a resource from a known fixed point, the same absolute URL is valid in any web page, regardless of the web page's location in the website's folder structure.</span></span>

<span data-ttu-id="e35fe-151">Pour remédier à l’image cassée illustrée dans la figure 2, nous devons mettre à jour l’attribut `src` de l’élément `<img>` afin qu’il utilise une URL absolue au lieu d’une URL relative.</span><span class="sxs-lookup"><span data-stu-id="e35fe-151">To remedy the broken image shown in Figure 2, we need to update the `<img>` element's `src` attribute so that it uses an absolute URL instead of a relative one.</span></span> <span data-ttu-id="e35fe-152">Pour déterminer l’URL absolue correcte, accédez à l’une des pages Web de votre site Web, puis examinez la barre d’adresses.</span><span class="sxs-lookup"><span data-stu-id="e35fe-152">To determine the correct absolute URL, visit one of the web pages in your website and examine the Address bar.</span></span> <span data-ttu-id="e35fe-153">Comme le montre la barre d’adresses de la figure 2, le chemin d’accès complet à l’application Web est `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-153">As the Address bar in Figure 2 shows, the fully qualified path to the web application is `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span></span> <span data-ttu-id="e35fe-154">Par conséquent, nous pourrions mettre à jour l’attribut `src` de l’élément `<img>` avec l’une ou l’autre des deux URL absolues suivantes :</span><span class="sxs-lookup"><span data-stu-id="e35fe-154">Therefore, we could update the `<img>` element's `src` attribute to either of the following two absolute URLs:</span></span>

- `/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`
- `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`

<span data-ttu-id="e35fe-155">Prenez un moment pour mettre à jour l’attribut `src` de l’élément `<img>` sur une URL absolue à l’aide de l’un des formulaires ci-dessus, puis accédez à la page `~/Admin/Default.aspx` via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="e35fe-155">Take a moment to update the `<img>` element's `src` attribute to an absolute URL using one of the forms shown above and then visit the `~/Admin/Default.aspx` page through a browser.</span></span> <span data-ttu-id="e35fe-156">Cette fois, le navigateur trouvera et affichera correctement le fichier image `PoweredByASPNET.gif` (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="e35fe-156">This time the browser will correctly find and display the `PoweredByASPNET.gif` image file (see Figure 3).</span></span>

<span data-ttu-id="e35fe-157">[![l’image PoweredByASPNET. gif est maintenant affichée](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e35fe-157">[![The PoweredByASPNET.gif Image is Now Displayed](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="e35fe-158">**Figure 03**: l’image `PoweredByASPNET.gif` s’affiche à présent ([cliquez pour afficher l’image en taille réelle](urls-in-master-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="e35fe-158">**Figure 03**: The `PoweredByASPNET.gif` Image is Now Displayed  ([Click to view full-size image](urls-in-master-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="e35fe-159">Bien que le codage en dur dans l’URL absolue fonctionne, il associe étroitement votre code HTML à l’emplacement du serveur et du dossier du site Web, ce qui peut changer.</span><span class="sxs-lookup"><span data-stu-id="e35fe-159">While hard coding in the absolute URL works, it tightly couples your HTML to the website's server and folder location, which may change.</span></span> <span data-ttu-id="e35fe-160">L’utilisation d’une URL absolue de la forme `http://localhost:3908/...` est fragile car le numéro de port qui précède localhost est sélectionné automatiquement chaque fois que le serveur Web de développement ASP.NET intégré de Visual Studio est démarré.</span><span class="sxs-lookup"><span data-stu-id="e35fe-160">Using an absolute URL of the form `http://localhost:3908/...` is brittle because the port number preceding localhost is selected automatically each time Visual Studio's built-in ASP.NET Development Web Server is started.</span></span> <span data-ttu-id="e35fe-161">De même, la partie `http://localhost` est valide uniquement lors du test local.</span><span class="sxs-lookup"><span data-stu-id="e35fe-161">Similarly, the `http://localhost` part is only valid when testing locally.</span></span> <span data-ttu-id="e35fe-162">Une fois que le code est déployé sur un serveur de production, la base de l’URL passe à autre chose, comme `http://www.yourserver.com`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-162">Once the code is deployed to a production server, the URL base will change to something else, like `http://www.yourserver.com`.</span></span> <span data-ttu-id="e35fe-163">L’URL absolue au format `/ASPNET_MasterPages_Tutorial_04_VB/...` souffre également d’une même fragilité, car ce chemin d’application diffère souvent entre les serveurs de développement et de production.</span><span class="sxs-lookup"><span data-stu-id="e35fe-163">The absolute URL in the form `/ASPNET_MasterPages_Tutorial_04_VB/...` also suffers from the same brittleness because oftentimes this application path differs between development and production servers.</span></span>

<span data-ttu-id="e35fe-164">La bonne nouvelle, c’est que ASP.NET offre une méthode permettant de générer une URL relative valide au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e35fe-164">The good news is that ASP.NET offers a method for generating a valid relative URL at runtime.</span></span>

## <a name="usingandresolveclienturl"></a><span data-ttu-id="e35fe-165">Utilisation de`~`et`ResolveClientUrl`</span><span class="sxs-lookup"><span data-stu-id="e35fe-165">Using`~`and`ResolveClientUrl`</span></span>

<span data-ttu-id="e35fe-166">Plutôt que de coder en dur une URL absolue, ASP.NET permet aux développeurs de pages d’utiliser le tilde (`~`) pour indiquer la racine de l’application Web.</span><span class="sxs-lookup"><span data-stu-id="e35fe-166">Rather than hard code an absolute URL, ASP.NET allows page developers to use the tilde (`~`) to indicate the root of the web application.</span></span> <span data-ttu-id="e35fe-167">Par exemple, précédemment dans ce didacticiel, j’ai utilisé la notation `~/Admin/Default.aspx` dans le texte pour faire référence à la page `Default.aspx` dans le dossier `Admin`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-167">For example, earlier in this tutorial I used the notation `~/Admin/Default.aspx` in the text to refer to the `Default.aspx` page in the `Admin` folder.</span></span> <span data-ttu-id="e35fe-168">Le `~` indique que le dossier `Admin` est un sous-dossier de la racine de l’application Web.</span><span class="sxs-lookup"><span data-stu-id="e35fe-168">The `~` indicates that the `Admin` folder is a subfolder of the web application's root.</span></span>

<span data-ttu-id="e35fe-169">La [méthode`ResolveClientUrl`](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) de la classe `Control` prend une URL et la modifie en une URL relative appropriée pour la page Web sur laquelle le contrôle réside.</span><span class="sxs-lookup"><span data-stu-id="e35fe-169">The `Control` class's [`ResolveClientUrl` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) takes a URL and modifies it to a relative URL appropriate for the web page on which the control resides.</span></span> <span data-ttu-id="e35fe-170">Par exemple, l’appel de `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` à partir de `About.aspx` retourne `Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-170">For example, calling `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` from `About.aspx` returns `Images/PoweredByASPNET.gif`.</span></span> <span data-ttu-id="e35fe-171">Toutefois, son appel à partir de `~/Admin/Default.aspx`retourne `../Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-171">Calling it from `~/Admin/Default.aspx`, however, returns `../Images/PoweredByASPNET.gif`.</span></span>

> [!NOTE]
> <span data-ttu-id="e35fe-172">Étant donné que tous les contrôles serveur ASP.NET dérivent de la classe `Control`, tous les contrôles serveur ont accès à la méthode `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-172">Because all ASP.NET server controls derive from the `Control` class, all server controls have access to the `ResolveClientUrl` method.</span></span> <span data-ttu-id="e35fe-173">Même la classe `Page` dérive de la classe `Control`, ce qui signifie que vous pouvez utiliser cette méthode directement à partir des classes code-behind de vos pages ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e35fe-173">Even the `Page` class derives from the `Control` class, meaning that you can use this method directly from your ASP.NET pages' code-behind classes.</span></span>

### <a name="usingin-the-declarative-markup"></a><span data-ttu-id="e35fe-174">Utilisation de`~`dans le balisage déclaratif</span><span class="sxs-lookup"><span data-stu-id="e35fe-174">Using`~`in the Declarative Markup</span></span>

<span data-ttu-id="e35fe-175">Plusieurs contrôles Web ASP.NET incluent des propriétés associées à l’URL : le contrôle de lien hypertexte a une propriété `NavigateUrl` ; le contrôle image a une propriété `ImageUrl` ; et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="e35fe-175">Several ASP.NET Web controls include URL-related properties: the HyperLink control has a `NavigateUrl` property; the Image control has an `ImageUrl` property; and so on.</span></span> <span data-ttu-id="e35fe-176">Lorsqu’ils sont rendus, ces contrôles passent leurs valeurs de propriété associées à l’URL à `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-176">When rendered, these controls pass their URL-related property values to `ResolveClientUrl`.</span></span> <span data-ttu-id="e35fe-177">Par conséquent, si ces propriétés contiennent un `~` pour indiquer la racine de l’application Web, l’URL sera modifiée en une URL relative valide.</span><span class="sxs-lookup"><span data-stu-id="e35fe-177">Consequently, if these properties contain a `~` to indicate the root of the web application, the URL will be modified to a valid relative URL.</span></span>

<span data-ttu-id="e35fe-178">N’oubliez pas que seuls les contrôles serveur ASP.NET transforment les `~` dans leurs propriétés associées à l’URL.</span><span class="sxs-lookup"><span data-stu-id="e35fe-178">Keep in mind that only ASP.NET server controls transform the `~` in their URL-related properties.</span></span> <span data-ttu-id="e35fe-179">Si un `~` apparaît dans le balisage HTML statique, comme `<img src="~/Images/PoweredByASPNET.gif" />`, le moteur ASP.NET envoie l' `~` au navigateur avec le reste du contenu HTML.</span><span class="sxs-lookup"><span data-stu-id="e35fe-179">If a `~` appears in static HTML markup, such as `<img src="~/Images/PoweredByASPNET.gif" />`, the ASP.NET engine sends the `~` to the browser along with the rest of the HTML content.</span></span> <span data-ttu-id="e35fe-180">Le navigateur suppose que le `~` fait partie de l’URL.</span><span class="sxs-lookup"><span data-stu-id="e35fe-180">The browser assumes that the `~` is part of the URL.</span></span> <span data-ttu-id="e35fe-181">Par exemple, si le navigateur reçoit le balisage `<img src="~/Images/PoweredByASPNET.gif" />` il part du principe qu’il existe un sous-dossier nommé `~` avec un sous-dossier `Images` contenant le fichier image `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-181">For example, if the browser receives the markup `<img src="~/Images/PoweredByASPNET.gif" />` it assumes there is a subfolder named `~` with a subfolder `Images` that contains the image file `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="e35fe-182">Pour corriger le balisage de l’image dans `Site.master`, remplacez l’élément `<img>` existant par un contrôle Web d’image ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e35fe-182">To fix the image markup in `Site.master`, replace the existing `<img>` element with an ASP.NET Image Web control.</span></span> <span data-ttu-id="e35fe-183">Définissez la `ID` du contrôle Web de l’image sur `PoweredByImage`, sa propriété `ImageUrl` sur `~/Images/PoweredByASPNET.gif`, et sa propriété `AlternateText` sur « Powered by ASP.NET ! ».</span><span class="sxs-lookup"><span data-stu-id="e35fe-183">Set the Image Web control's `ID` to `PoweredByImage`, its `ImageUrl` property to `~/Images/PoweredByASPNET.gif`, and its `AlternateText` property to "Powered by ASP.NET!"</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="e35fe-184">Après avoir apporté cette modification à la page maître, réexaminez la page de `~/Admin/Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-184">After making this change to the master page, revisit the `~/Admin/Default.aspx` page again.</span></span> <span data-ttu-id="e35fe-185">Cette fois, le `PoweredByASPNET.gif` fichier image s’affiche dans la page (voir figure 3).</span><span class="sxs-lookup"><span data-stu-id="e35fe-185">This time the `PoweredByASPNET.gif` image file appears in the page (see Figure 3).</span></span> <span data-ttu-id="e35fe-186">Lorsque le contrôle Web de l’image est affiché, il utilise la méthode `ResolveClientUrl` pour résoudre sa valeur de propriété `ImageUrl`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-186">When the Image Web control is rendered it uses the `ResolveClientUrl` method to resolve its `ImageUrl` property value.</span></span> <span data-ttu-id="e35fe-187">Dans `~/Admin/Default.aspx` la `ImageUrl` est convertie en URL relative appropriée, comme le montre l’extrait de code suivant de la source HTML :</span><span class="sxs-lookup"><span data-stu-id="e35fe-187">In `~/Admin/Default.aspx` the `ImageUrl` is converted into an appropriate relative URL, as the following snippet of HTML source shows:</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="e35fe-188">En plus d’être utilisés dans les propriétés de contrôle Web basée sur une URL, le `~` peut également être utilisé lors de l’appel des méthodes `Response.Redirect` et `Server.MapPath`, entre autres.</span><span class="sxs-lookup"><span data-stu-id="e35fe-188">In addition to being used in URL-based Web control properties, the `~` can also be used when calling the `Response.Redirect` and `Server.MapPath` methods, among others.</span></span> <span data-ttu-id="e35fe-189">En outre, la méthode `ResolveClientUrl` peut être appelée directement à partir d’un ASP.NET ou d’un balisage déclaratif d’une page maître, si nécessaire ; consultez l’entrée de blog de [Fritz oignon](https://www.pluralsight.com/blogs/fritz/) [en utilisant `ResolveClientUrl` dans le balisage](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span><span class="sxs-lookup"><span data-stu-id="e35fe-189">Also, the `ResolveClientUrl` method may be invoked directly from an ASP.NET or master page's declarative markup, if needed; see [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)'s blog entry [Using `ResolveClientUrl` in Markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span></span>

## <a name="fixing-the-master-pages-remaining-relative-urls"></a><span data-ttu-id="e35fe-190">Correction des URL relatives restantes de la page maître</span><span class="sxs-lookup"><span data-stu-id="e35fe-190">Fixing the Master Page's Remaining Relative URLs</span></span>

<span data-ttu-id="e35fe-191">En plus de l’élément `<img>` dans le `footerContent` que nous venons de corriger, la page maître contient une URL plus relative qui requiert votre attention.</span><span class="sxs-lookup"><span data-stu-id="e35fe-191">In addition to the `<img>` element in the `footerContent` that we just fixed, the master page contains one more relative URL that requires our attention.</span></span> <span data-ttu-id="e35fe-192">La région `topContent` comprend le lien « didacticiels sur les pages maîtres », qui pointe vers `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-192">The `topContent` region includes the link "Master Pages Tutorials," which points to `Default.aspx`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample7.html)]

<span data-ttu-id="e35fe-193">Étant donné que cette URL est relative, elle envoie l’utilisateur à la page `Default.aspx` dans le dossier de la page de contenu visitée.</span><span class="sxs-lookup"><span data-stu-id="e35fe-193">Because this URL is relative, it will send the user to the `Default.aspx` page in the folder of the content page they are visiting.</span></span> <span data-ttu-id="e35fe-194">Pour que ce lien pointe toujours vers `Default.aspx` dans le dossier racine, nous devons remplacer l’élément `<a>` par un contrôle HyperLink Web afin de pouvoir utiliser la notation `~`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-194">To have this link always point to `Default.aspx` in the root folder we need to replace the `<a>` element with a HyperLink Web control so that we can use the `~` notation.</span></span>

<span data-ttu-id="e35fe-195">Supprimez le balisage de l’élément `<a>` et ajoutez un contrôle de lien hypertexte à la place.</span><span class="sxs-lookup"><span data-stu-id="e35fe-195">Remove the `<a>` element markup and add a HyperLink control in its place.</span></span> <span data-ttu-id="e35fe-196">Définissez la `ID` du lien hypertexte sur `lnkHome`, sa propriété `NavigateUrl` sur `~/Default.aspx`, et sa propriété `Text` sur « didacticiels sur les pages maîtres ».</span><span class="sxs-lookup"><span data-stu-id="e35fe-196">Set the HyperLink's `ID` to `lnkHome`, its `NavigateUrl` property to `~/Default.aspx`, and its `Text` property to "Master Pages Tutorials."</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample8.aspx)]

<span data-ttu-id="e35fe-197">C’est tout !</span><span class="sxs-lookup"><span data-stu-id="e35fe-197">That's it!</span></span> <span data-ttu-id="e35fe-198">À ce stade, toutes les URL de notre page maître sont correctement basées sur le rendu d’une page de contenu, quels que soient les dossiers dans lesquels se trouvent la page maître et la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="e35fe-198">At this point all the URLs in our master page are properly based when rendered by a content page regardless of what folders the master page and content page are located in.</span></span>

### <a name="automatic-url-resolution-in-theheadsection"></a><span data-ttu-id="e35fe-199">Résolution automatique des URL dans la section`<head>`</span><span class="sxs-lookup"><span data-stu-id="e35fe-199">Automatic URL Resolution in the`<head>`Section</span></span>

<span data-ttu-id="e35fe-200">Dans le didacticiel [*création d’une disposition à l’ensemble du site à l’aide de pages maîtres*](creating-a-site-wide-layout-using-master-pages-vb.md) , nous avons ajouté un `<link>` au fichier `Styles.css` dans la région `<head>` :</span><span class="sxs-lookup"><span data-stu-id="e35fe-200">In the [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md) tutorial we added a `<link>` to the `Styles.css` file in the `<head>` region:</span></span>

[!code-aspx[Main](urls-in-master-pages-vb/samples/sample9.aspx)]

<span data-ttu-id="e35fe-201">Tandis que l’attribut `href` de l’élément `<link>` est relatif, il est automatiquement converti en chemin d’accès approprié au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e35fe-201">While the `<link>` element's `href` attribute is relative, it's automatically converted to an appropriate path at runtime.</span></span> <span data-ttu-id="e35fe-202">Comme nous l’avons vu dans la section [*spécification du titre, des balises meta et d’autres en-têtes HTML du didacticiel page maître*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) , la `<head>` région est en fait un contrôle côté serveur, ce qui lui permet de modifier le contenu de ses contrôles internes lorsqu’il est rendu.</span><span class="sxs-lookup"><span data-stu-id="e35fe-202">As we discussed in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial, the `<head>` region is actually a server-side control, which enables it to modify the contents of its inner controls when it is rendered.</span></span>

<span data-ttu-id="e35fe-203">Pour vérifier cela, revisitez la page de `~/Admin/Default.aspx` et affichez la source HTML envoyée au navigateur.</span><span class="sxs-lookup"><span data-stu-id="e35fe-203">To verify this, revisit the `~/Admin/Default.aspx` page and view the HTML source sent to the browser.</span></span> <span data-ttu-id="e35fe-204">Comme le montre l’extrait de code ci-dessous, l’attribut `href` de l’élément `<link>` a été automatiquement modifié en URL relative appropriée, `../Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="e35fe-204">As the snippet below illustrates, the `<link>` element's `href` attribute has been automatically modified to an appropriate relative URL, `../Styles.css`.</span></span>

[!code-html[Main](urls-in-master-pages-vb/samples/sample10.html)]

## <a name="summary"></a><span data-ttu-id="e35fe-205">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="e35fe-205">Summary</span></span>

<span data-ttu-id="e35fe-206">Les pages maîtres incluent très souvent des liens, des images et d’autres ressources externes qui doivent être spécifiées via une URL.</span><span class="sxs-lookup"><span data-stu-id="e35fe-206">Master pages very often include links, images, and other external resources that must be specified via a URL.</span></span> <span data-ttu-id="e35fe-207">Étant donné que la page maître et les pages de contenu peuvent ne pas exister dans le même dossier, il est important de s’abstenir d’utiliser des URL relatives.</span><span class="sxs-lookup"><span data-stu-id="e35fe-207">Because the master page and content pages might not exist in the same folder, it is important to abstain from using relative URLs.</span></span> <span data-ttu-id="e35fe-208">Bien qu’il soit possible d’utiliser des URL absolues codées en dur, cela permet de coupler étroitement l’URL absolue à l’application Web.</span><span class="sxs-lookup"><span data-stu-id="e35fe-208">While it is possible to use hard coded absolute URLs, doing so tightly couples the absolute URL to the web application.</span></span> <span data-ttu-id="e35fe-209">Si l’URL absolue change, comme c’est souvent le cas lors du déplacement ou du déploiement d’une application Web, vous devez vous souvenir de revenir en arrière et de mettre à jour les URL absolues.</span><span class="sxs-lookup"><span data-stu-id="e35fe-209">If the absolute URL changes - as it often does when moving or deploying a web application - you'll have to remember to go back and update the absolute URLs.</span></span>

<span data-ttu-id="e35fe-210">L’approche idéale consiste à utiliser le tilde (`~`) pour indiquer la racine de l’application.</span><span class="sxs-lookup"><span data-stu-id="e35fe-210">The ideal approach is to use the tilde (`~`) to indicate the application root.</span></span> <span data-ttu-id="e35fe-211">Les contrôles Web ASP.NET qui contiennent des propriétés liées à l’URL mappent les `~` à la racine de l’application au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e35fe-211">ASP.NET Web controls that contain URL-related properties map the `~` to the application root at runtime.</span></span> <span data-ttu-id="e35fe-212">En interne, les contrôles Web utilisent la méthode `ResolveClientUrl` de la classe `Control` pour générer une URL relative valide.</span><span class="sxs-lookup"><span data-stu-id="e35fe-212">Internally, the Web controls use the `Control` class's `ResolveClientUrl` method to generate a valid relative URL.</span></span> <span data-ttu-id="e35fe-213">Cette méthode est publique et disponible à partir de chaque contrôle serveur (y compris la classe `Page`). vous pouvez donc l’utiliser par programmation à partir de vos classes code-behind, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="e35fe-213">This method is public and available from every server control (including the `Page` class), so you can use it programmatically from your code-behind classes, if needed.</span></span>

<span data-ttu-id="e35fe-214">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="e35fe-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="e35fe-215">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="e35fe-215">Further Reading</span></span>

<span data-ttu-id="e35fe-216">Pour plus d’informations sur les sujets abordés dans ce didacticiel, reportez-vous aux ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="e35fe-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e35fe-217">Pages maîtres dans ASP.NET</span><span class="sxs-lookup"><span data-stu-id="e35fe-217">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/Articles/419.aspx)
- [<span data-ttu-id="e35fe-218">Relocalisation d’URL dans une page maître</span><span class="sxs-lookup"><span data-stu-id="e35fe-218">URL Rebasing in a Master Page</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx#urls)
- [<span data-ttu-id="e35fe-219">Utilisation de `ResolveClientUrl` dans le balisage</span><span class="sxs-lookup"><span data-stu-id="e35fe-219">Using `ResolveClientUrl` in Markup</span></span>](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)

### <a name="about-the-author"></a><span data-ttu-id="e35fe-220">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="e35fe-220">About the Author</span></span>

<span data-ttu-id="e35fe-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de plusieurs ouvrages ASP/ASP. net et fondateur de 4GuysFromRolla.com, travaille avec les technologies Web de Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="e35fe-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e35fe-222">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="e35fe-222">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e35fe-223">Son dernier livre est [*Sams vous apprend vous-même ASP.NET 3,5 en 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e35fe-223">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e35fe-224">Scott peut être contacté au [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) ou via son blog à l’adresse [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="e35fe-224">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="e35fe-225">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="e35fe-225">Special Thanks To</span></span>

<span data-ttu-id="e35fe-226">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="e35fe-226">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e35fe-227">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="e35fe-227">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e35fe-228">[Précédent](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
> [Suivant](control-id-naming-in-content-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e35fe-228">[Previous](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
[Next](control-id-naming-in-content-pages-vb.md)</span></span>
