---
uid: web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
title: URL dans les Pages maîtres (VB) | Microsoft Docs
author: rick-anderson
description: Adresses comment les URL dans la page maître peuvent fonctionner en raison du fichier de page maître en cours dans un autre répertoire relatif à la page de contenu. Examine la relocalisation...
ms.author: riande
ms.date: 06/10/2008
ms.assetid: 43d1e83c-0092-4dcf-977c-e709c4dce7c3
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 881debeeaa98a7f2be7ccadb501c019e698b22f2
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57035556"
---
<a name="urls-in-master-pages-vb"></a><span data-ttu-id="d29c9-104">URL dans les pages maîtres (VB)</span><span class="sxs-lookup"><span data-stu-id="d29c9-104">URLs in Master Pages (VB)</span></span>
====================
<span data-ttu-id="d29c9-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d29c9-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d29c9-106">[Télécharger le Code](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) ou [télécharger le PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="d29c9-106">[Download Code](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) or [Download PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)</span></span>

> <span data-ttu-id="d29c9-107">Adresses comment les URL dans la page maître peuvent fonctionner en raison du fichier de page maître en cours dans un autre répertoire relatif à la page de contenu.</span><span class="sxs-lookup"><span data-stu-id="d29c9-107">Addresses how URLs in the master page can break due to the master page file being in a different relative directory than the content page.</span></span> <span data-ttu-id="d29c9-108">Examine l’URL par le biais de la relocalisation ~ dans la syntaxe déclarative et à l’aide de ResolveUrl et ResolveClientUrl par programmation.</span><span class="sxs-lookup"><span data-stu-id="d29c9-108">Looks at rebasing URLs via ~ in the declarative syntax and using ResolveUrl and ResolveClientUrl programmatically.</span></span> <span data-ttu-id="d29c9-109">(Également examiner</span><span class="sxs-lookup"><span data-stu-id="d29c9-109">(Also look at</span></span>


## <a name="introduction"></a><span data-ttu-id="d29c9-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="d29c9-110">Introduction</span></span>

<span data-ttu-id="d29c9-111">Dans tous les exemples nous avons vu jusqu’ici, que les pages maîtres et de contenu ont été localisées dans le même dossier (du site Web racine).</span><span class="sxs-lookup"><span data-stu-id="d29c9-111">In all the examples we've seen thus far, the master and content pages have been located in the same folder (the website's root folder).</span></span> <span data-ttu-id="d29c9-112">Mais il n’existe aucune raison pourquoi les pages maîtres et de contenu doivent être dans le même dossier.</span><span class="sxs-lookup"><span data-stu-id="d29c9-112">But there's no reason why the master and content pages must be in the same folder.</span></span> <span data-ttu-id="d29c9-113">Vous pouvez certainement créer des pages de contenu dans les sous-dossiers.</span><span class="sxs-lookup"><span data-stu-id="d29c9-113">You can certainly create content pages in subfolders.</span></span> <span data-ttu-id="d29c9-114">De même, vous pouvez créer un `~/MasterPages/` dossier dans lequel vous placez des pages maîtres de votre site.</span><span class="sxs-lookup"><span data-stu-id="d29c9-114">Similarly, you might create a `~/MasterPages/` folder where you place your site's master pages.</span></span>

<span data-ttu-id="d29c9-115">Un problème potentiel au placement des pages maîtres et de contenu dans des dossiers différents implique URL rompues.</span><span class="sxs-lookup"><span data-stu-id="d29c9-115">One potential issue with placing master and content pages in different folders involves broken URLs.</span></span> <span data-ttu-id="d29c9-116">Si la page maître contient des URL relatives dans les liens hypertexte, des images ou autres éléments, le lien n’est pas valide pour les pages de contenu qui se trouvent dans un autre dossier.</span><span class="sxs-lookup"><span data-stu-id="d29c9-116">If the master page contains relative URLs in hyperlinks, images, or other elements, the link will be invalid for content pages that reside in a different folder.</span></span> <span data-ttu-id="d29c9-117">Dans ce didacticiel, nous examinons la source de ce problème, ainsi que les solutions de contournement.</span><span class="sxs-lookup"><span data-stu-id="d29c9-117">In this tutorial we examine the source of this problem as well as workarounds.</span></span>

## <a name="the-problem-with-relative-urls"></a><span data-ttu-id="d29c9-118">Le problème avec des URL relatives</span><span class="sxs-lookup"><span data-stu-id="d29c9-118">The Problem with Relative URLs</span></span>

<span data-ttu-id="d29c9-119">Une URL sur une page web est dite un *URL relative* si l’emplacement de la ressource qu’il pointe vers est par rapport à l’emplacement de la page web dans la structure de dossiers du site Web.</span><span class="sxs-lookup"><span data-stu-id="d29c9-119">A URL on a web page is said to be a *relative URL* if the location of the resource it points to is relative to the web page's location in the website's folder structure.</span></span> <span data-ttu-id="d29c9-120">N’importe quelle URL ne commence pas par une barre oblique (`/`) ou un protocole (tel que `http://`) est relatif, car il est résolu par le navigateur basé sur l’emplacement de la page web qui contient l’URL.</span><span class="sxs-lookup"><span data-stu-id="d29c9-120">Any URL that does not start with a leading forward slash (`/`) or a protocol (such as `http://`) is relative because it is resolved by the browser based on the location of the web page that contains the URL.</span></span>

<span data-ttu-id="d29c9-121">Par exemple, notre site Web a un `~/Images/` dossier avec un seul fichier image, `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-121">For example, our website has an `~/Images/` folder with a single image file, `PoweredByASPNET.gif`.</span></span> <span data-ttu-id="d29c9-122">Le fichier de page maître `Site.master` a un `<img>` élément dans le `footerContent` région par le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="d29c9-122">The master page file `Site.master` has an `<img>` element in the `footerContent` region with the following markup:</span></span>


[!code-html[Main](urls-in-master-pages-vb/samples/sample1.html)]

<span data-ttu-id="d29c9-123">Le `src` attribut la valeur dans le `<img>` élément est une URL relative, car il ne commence pas par `/` ou `http://`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-123">The `src` attribute value in the `<img>` element is a relative URL because it does not start with `/` or `http://`.</span></span> <span data-ttu-id="d29c9-124">En bref, le `src` valeur d’attribut indique au navigateur pour rechercher le `Images` sous-dossier pour un fichier nommé `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-124">In short, the `src` attribute value tells the browser to look in the `Images` subfolder for a file named `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="d29c9-125">Lorsque vous visitez une page de contenu, le balisage ci-dessus est envoyé directement au navigateur.</span><span class="sxs-lookup"><span data-stu-id="d29c9-125">When visiting a content page, the above markup is sent directly to the browser.</span></span> <span data-ttu-id="d29c9-126">Prenez un moment pour visiter `About.aspx` et afficher la source HTML envoyée au navigateur.</span><span class="sxs-lookup"><span data-stu-id="d29c9-126">Take a moment to visit `About.aspx` and view the HTML source sent to the browser.</span></span> <span data-ttu-id="d29c9-127">Vous constaterez que le même balisage exact dans la page maître a été envoyé au navigateur.</span><span class="sxs-lookup"><span data-stu-id="d29c9-127">You will find that the exact same markup in the master page was sent to the browser.</span></span>


[!code-html[Main](urls-in-master-pages-vb/samples/sample2.html)]

<span data-ttu-id="d29c9-128">Si la page de contenu se trouve dans le dossier racine (comme est `About.aspx`) tout fonctionne comme prévu, car il existe un `Images` sous-dossier relatif au dossier racine.</span><span class="sxs-lookup"><span data-stu-id="d29c9-128">If the content page is in the root folder (as is `About.aspx`) everything works as expected because there is an `Images` subfolder relative to the root folder.</span></span> <span data-ttu-id="d29c9-129">Toutefois, les choses décomposent la si la page de contenu se trouve dans un dossier autre que celui de la page maître.</span><span class="sxs-lookup"><span data-stu-id="d29c9-129">However, things break down if the content page is in a different folder than the master page.</span></span> <span data-ttu-id="d29c9-130">Pour illustrer cela, créez un sous-dossier nommé `Admin`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-130">To illustrate this, create a subfolder named `Admin`.</span></span> <span data-ttu-id="d29c9-131">Ensuite, ajoutez une page de contenu nommée `Default.aspx` à la `Admin` dossier, en veillant à lier la nouvelle page à la `Site.master` page maître.</span><span class="sxs-lookup"><span data-stu-id="d29c9-131">Next, add a content page named `Default.aspx` to the `Admin` folder, making sure to bind the new page to the `Site.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="d29c9-132">Dans le [ *spécifiant le titre, les balises Meta et les autres en-têtes HTML dans la Page maître* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) didacticiel, nous avons créé une classe de page de base personnalisée nommée `BasePage` qui définir automatiquement le contenu du titre de page (si elle a été pas explicitement affectée).</span><span class="sxs-lookup"><span data-stu-id="d29c9-132">In the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that automatically set the content page's title (if it was not explicitly assigned).</span></span> <span data-ttu-id="d29c9-133">N’oubliez pas d’avoir classe code-behind de la page nouvellement créé dérivent `BasePage` afin qu’il peut utiliser cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="d29c9-133">Don't forget to have the newly created page's code-behind class derive from `BasePage` so that it can utilize this functionality.</span></span>


<span data-ttu-id="d29c9-134">Une fois que vous avez créé cette page de contenu, l’Explorateur de solutions doit ressembler à la Figure 1.</span><span class="sxs-lookup"><span data-stu-id="d29c9-134">After you have created this content page, your Solution Explorer should look similar to Figure 1.</span></span>


![Un nouveau dossier et la Page ASP.NET ont été ajoutés au projet](urls-in-master-pages-vb/_static/image1.png)

<span data-ttu-id="d29c9-136">**Figure 01**: Un nouveau dossier et la Page ASP.NET ont été ajoutés au projet</span><span class="sxs-lookup"><span data-stu-id="d29c9-136">**Figure 01**: A New Folder and ASP.NET Page Have Been Added to the Project</span></span>


<span data-ttu-id="d29c9-137">Ensuite, mettez à jour le `Web.sitemap` fichier à inclure un nouveau `<siteMapNode>` entrée dans le cadre de cette leçon.</span><span class="sxs-lookup"><span data-stu-id="d29c9-137">Next, update the `Web.sitemap` file to include a new `<siteMapNode>` entry for this lesson.</span></span> <span data-ttu-id="d29c9-138">Le code XML suivant montre l’ensemble `Web.sitemap` balisage, qui inclut désormais l’ajout d’une troisième `<siteMapNode>` élément.</span><span class="sxs-lookup"><span data-stu-id="d29c9-138">The following XML shows the complete `Web.sitemap` markup, which now includes the addition of a third `<siteMapNode>` element.</span></span>


[!code-xml[Main](urls-in-master-pages-vb/samples/sample3.xml)]

<span data-ttu-id="d29c9-139">Nouvellement créé `Default.aspx` page doit avoir quatre contrôles de contenu correspondant aux quatre ContentPlaceHolders dans `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-139">The newly created `Default.aspx` page should have four Content controls corresponding to the four ContentPlaceHolders in `Site.master`.</span></span> <span data-ttu-id="d29c9-140">Ajouter du texte dans le contrôle de contenu faisant référence à la `MainContent` ContentPlaceHolder, puis visitez la page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d29c9-140">Add some text to the Content control referencing the `MainContent` ContentPlaceHolder and then visit the page through a browser.</span></span> <span data-ttu-id="d29c9-141">Comme le montre la Figure 2, le navigateur ne peut pas trouver le `PoweredByASPNET.gif` fichier image.</span><span class="sxs-lookup"><span data-stu-id="d29c9-141">As Figure 2 shows, the browser cannot find the `PoweredByASPNET.gif` image file.</span></span> <span data-ttu-id="d29c9-142">Qu'est-ce qui se passe ?</span><span class="sxs-lookup"><span data-stu-id="d29c9-142">What's going on here?</span></span>

<span data-ttu-id="d29c9-143">Le `~/Admin/Default.aspx` page de contenu est envoyé le même code HTML le `footerContent` région tel qu’il a été le `About.aspx` page :</span><span class="sxs-lookup"><span data-stu-id="d29c9-143">The `~/Admin/Default.aspx` content page is sent the same HTML for the `footerContent` region as was the `About.aspx` page:</span></span>


[!code-html[Main](urls-in-master-pages-vb/samples/sample4.html)]

<span data-ttu-id="d29c9-144">Étant donné que le `<img>` l’élément `src` attribut est une URL relative, le navigateur tente de rechercher un `Images` dossier par rapport à l’emplacement du dossier de la page web.</span><span class="sxs-lookup"><span data-stu-id="d29c9-144">Because the `<img>` element's `src` attribute is a relative URL, the browser attempts to look for an `Images` folder relative to the web page's folder location.</span></span> <span data-ttu-id="d29c9-145">En d’autres termes, le navigateur recherche le fichier image `Admin/Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-145">In other words, the browser is looking for the image file `Admin/Images/PoweredByASPNET.gif`.</span></span>


<span data-ttu-id="d29c9-146">[![Impossible de trouver le fichier Image de PoweredByASPNET.gif](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="d29c9-146">[![The PoweredByASPNET.gif Image File Cannot Be Found](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="d29c9-147">**Figure 02**: Le `PoweredByASPNET.gif` Image fichier est introuvable ([cliquez pour afficher l’image en taille réelle](urls-in-master-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d29c9-147">**Figure 02**: The `PoweredByASPNET.gif` Image File Cannot Be Found  ([Click to view full-size image](urls-in-master-pages-vb/_static/image4.png))</span></span>


### <a name="replacing-relative-urls-with-absolute-urls"></a><span data-ttu-id="d29c9-148">En remplaçant les URL relatives avec une URL absolue</span><span class="sxs-lookup"><span data-stu-id="d29c9-148">Replacing Relative URLs with Absolute URLs</span></span>

<span data-ttu-id="d29c9-149">L’inverse d’une URL relative est un *URL absolue*, qui est une qui commence par une barre oblique (`/`) ou un protocole comme `http://`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-149">The opposite of a relative URL is an *absolute URL*, which is one that starts with a forward slash (`/`) or a protocol such as `http://`.</span></span> <span data-ttu-id="d29c9-150">Parce qu’une URL absolue Spécifie l’emplacement d’une ressource à partir d’un point fixe connu, la même URL absolue est valide dans n’importe quelle page web, indépendamment de l’emplacement de la page web dans la structure de dossiers du site Web.</span><span class="sxs-lookup"><span data-stu-id="d29c9-150">Because an absolute URL specifies the location of a resource from a known fixed point, the same absolute URL is valid in any web page, regardless of the web page's location in the website's folder structure.</span></span>

<span data-ttu-id="d29c9-151">Pour remédier à l’image rompue indiqué dans la Figure 2, nous devons mettre à jour le `<img>` l’élément `src` afin qu’il utilise une URL absolue au lieu d’une relatif d’attribut.</span><span class="sxs-lookup"><span data-stu-id="d29c9-151">To remedy the broken image shown in Figure 2, we need to update the `<img>` element's `src` attribute so that it uses an absolute URL instead of a relative one.</span></span> <span data-ttu-id="d29c9-152">Pour déterminer la bonne URL absolue, reportez-vous à l’un des pages web dans votre site Web et examinez la barre d’adresses.</span><span class="sxs-lookup"><span data-stu-id="d29c9-152">To determine the correct absolute URL, visit one of the web pages in your website and examine the Address bar.</span></span> <span data-ttu-id="d29c9-153">Comme le montre la barre d’adresses dans la Figure 2, le chemin d’accès complet à l’application web est `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-153">As the Address bar in Figure 2 shows, the fully qualified path to the web application is `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`.</span></span> <span data-ttu-id="d29c9-154">Par conséquent, nous pouvons mettre à jour le `<img>` l’élément `src` d’attribut à un des deux URL absolus suivantes :</span><span class="sxs-lookup"><span data-stu-id="d29c9-154">Therefore, we could update the `<img>` element's `src` attribute to either of the following two absolute URLs:</span></span>

- `/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`
- `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`

<span data-ttu-id="d29c9-155">Prenez un moment pour mettre à jour le `<img>` l’élément `src` attribut à une URL absolue à l’aide d’une des formes illustrés ci-dessus, puis visitez le `~/Admin/Default.aspx` page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="d29c9-155">Take a moment to update the `<img>` element's `src` attribute to an absolute URL using one of the forms shown above and then visit the `~/Admin/Default.aspx` page through a browser.</span></span> <span data-ttu-id="d29c9-156">Cette fois, le navigateur sera correctement rechercher et afficher le `PoweredByASPNET.gif` fichier image (voir Figure 3).</span><span class="sxs-lookup"><span data-stu-id="d29c9-156">This time the browser will correctly find and display the `PoweredByASPNET.gif` image file (see Figure 3).</span></span>


<span data-ttu-id="d29c9-157">[![Le PoweredByASPNET.gif Image est maintenant affichée](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d29c9-157">[![The PoweredByASPNET.gif Image is Now Displayed](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="d29c9-158">**Figure 03**: Le `PoweredByASPNET.gif` Image est maintenant affichée ([cliquez pour afficher l’image en taille réelle](urls-in-master-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="d29c9-158">**Figure 03**: The `PoweredByASPNET.gif` Image is Now Displayed  ([Click to view full-size image](urls-in-master-pages-vb/_static/image7.png))</span></span>


<span data-ttu-id="d29c9-159">Bien que coder en dur dans l’URL absolue fonctionne, il associe étroitement votre code HTML pour les serveurs du site Web et l’emplacement de dossier, qui peut changer.</span><span class="sxs-lookup"><span data-stu-id="d29c9-159">While hard coding in the absolute URL works, it tightly couples your HTML to the website's server and folder location, which may change.</span></span> <span data-ttu-id="d29c9-160">À l’aide d’une URL absolue du formulaire `http://localhost:3908/...` est fragile car le numéro de port qui précède localhost est sélectionné automatiquement chaque démarrage d’un serveur Web de développement intégré ASP.NET de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d29c9-160">Using an absolute URL of the form `http://localhost:3908/...` is brittle because the port number preceding localhost is selected automatically each time Visual Studio's built-in ASP.NET Development Web Server is started.</span></span> <span data-ttu-id="d29c9-161">De même, la `http://localhost` partie est valide uniquement lorsque vous testez localement.</span><span class="sxs-lookup"><span data-stu-id="d29c9-161">Similarly, the `http://localhost` part is only valid when testing locally.</span></span> <span data-ttu-id="d29c9-162">Une fois le code est déployé sur un serveur de production, la base de l’URL changera à toute autre chose, comme `http://www.yourserver.com`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-162">Once the code is deployed to a production server, the URL base will change to something else, like `http://www.yourserver.com`.</span></span> <span data-ttu-id="d29c9-163">L’URL absolue sous la forme `/ASPNET_MasterPages_Tutorial_04_VB/...` souffre également la fragilité de même, car souvent, ce chemin d’accès de l’application est différent entre les serveurs de développement et de production.</span><span class="sxs-lookup"><span data-stu-id="d29c9-163">The absolute URL in the form `/ASPNET_MasterPages_Tutorial_04_VB/...` also suffers from the same brittleness because oftentimes this application path differs between development and production servers.</span></span>

<span data-ttu-id="d29c9-164">La bonne nouvelle est que ASP.NET offre une méthode pour générer une URL relative valide lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="d29c9-164">The good news is that ASP.NET offers a method for generating a valid relative URL at runtime.</span></span>

## <a name="usingandresolveclienturl"></a><span data-ttu-id="d29c9-165">À l’aide de`~`et`ResolveClientUrl`</span><span class="sxs-lookup"><span data-stu-id="d29c9-165">Using`~`and`ResolveClientUrl`</span></span>

<span data-ttu-id="d29c9-166">Plutôt que de coder en dur une URL absolue, ASP.NET permet aux développeurs de page d’utiliser le tilde (`~`) pour indiquer la racine de l’application web.</span><span class="sxs-lookup"><span data-stu-id="d29c9-166">Rather than hard code an absolute URL, ASP.NET allows page developers to use the tilde (`~`) to indicate the root of the web application.</span></span> <span data-ttu-id="d29c9-167">Par exemple, plus haut dans ce didacticiel, j’ai utilisé la notation `~/Admin/Default.aspx` dans le texte pour faire référence à la `Default.aspx` page dans le `Admin` dossier.</span><span class="sxs-lookup"><span data-stu-id="d29c9-167">For example, earlier in this tutorial I used the notation `~/Admin/Default.aspx` in the text to refer to the `Default.aspx` page in the `Admin` folder.</span></span> <span data-ttu-id="d29c9-168">Le `~` indique que le `Admin` dossier est un sous-dossier de la racine de l’application web.</span><span class="sxs-lookup"><span data-stu-id="d29c9-168">The `~` indicates that the `Admin` folder is a subfolder of the web application's root.</span></span>

<span data-ttu-id="d29c9-169">Le `Control` la classe [ `ResolveClientUrl` méthode](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) prend une URL et le modifie pour une URL relative appropriée pour la page web sur lequel réside le contrôle.</span><span class="sxs-lookup"><span data-stu-id="d29c9-169">The `Control` class's [`ResolveClientUrl` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) takes a URL and modifies it to a relative URL appropriate for the web page on which the control resides.</span></span> <span data-ttu-id="d29c9-170">Par exemple, l’appel `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` de `About.aspx` retourne `Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-170">For example, calling `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` from `About.aspx` returns `Images/PoweredByASPNET.gif`.</span></span> <span data-ttu-id="d29c9-171">Appelant à partir `~/Admin/Default.aspx`, toutefois, retourne `../Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-171">Calling it from `~/Admin/Default.aspx`, however, returns `../Images/PoweredByASPNET.gif`.</span></span>

> [!NOTE]
> <span data-ttu-id="d29c9-172">Étant donné que tous les contrôles de serveur ASP.NET dérivent le `Control` (classe), tous les contrôles serveur ont accès à la `ResolveClientUrl` (méthode).</span><span class="sxs-lookup"><span data-stu-id="d29c9-172">Because all ASP.NET server controls derive from the `Control` class, all server controls have access to the `ResolveClientUrl` method.</span></span> <span data-ttu-id="d29c9-173">Même si le `Page` classe dérive de la `Control` (classe), ce qui signifie que vous pouvez utiliser cette méthode directement à partir de classes de code-behind de vos pages ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d29c9-173">Even the `Page` class derives from the `Control` class, meaning that you can use this method directly from your ASP.NET pages' code-behind classes.</span></span>


### <a name="usingin-the-declarative-markup"></a><span data-ttu-id="d29c9-174">À l’aide de`~`dans le balisage déclaratif</span><span class="sxs-lookup"><span data-stu-id="d29c9-174">Using`~`in the Declarative Markup</span></span>

<span data-ttu-id="d29c9-175">Plusieurs contrôles Web ASP.NET incluent les propriétés liées par l’URL : le contrôle de lien hypertexte a un `NavigateUrl` propriété ; l’Image de contrôle a une `ImageUrl` propriété ; et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="d29c9-175">Several ASP.NET Web controls include URL-related properties: the HyperLink control has a `NavigateUrl` property; the Image control has an `ImageUrl` property; and so on.</span></span> <span data-ttu-id="d29c9-176">Lors du rendu, ces contrôles passent leur URL des valeurs de propriété à `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-176">When rendered, these controls pass their URL-related property values to `ResolveClientUrl`.</span></span> <span data-ttu-id="d29c9-177">Par conséquent, si ces propriétés contiennent une `~` pour indiquer la racine de l’application web, l’URL est modifié conformément à une URL relative valide.</span><span class="sxs-lookup"><span data-stu-id="d29c9-177">Consequently, if these properties contain a `~` to indicate the root of the web application, the URL will be modified to a valid relative URL.</span></span>

<span data-ttu-id="d29c9-178">N’oubliez pas qu’uniquement des contrôles serveur ASP.NET transformer le `~` dans leurs propriétés de l’URL.</span><span class="sxs-lookup"><span data-stu-id="d29c9-178">Keep in mind that only ASP.NET server controls transform the `~` in their URL-related properties.</span></span> <span data-ttu-id="d29c9-179">Si un `~` apparaît dans le balisage HTML statique, tel que `<img src="~/Images/PoweredByASPNET.gif" />`, le moteur ASP.NET envoie le `~` dans le navigateur avec le reste du contenu HTML.</span><span class="sxs-lookup"><span data-stu-id="d29c9-179">If a `~` appears in static HTML markup, such as `<img src="~/Images/PoweredByASPNET.gif" />`, the ASP.NET engine sends the `~` to the browser along with the rest of the HTML content.</span></span> <span data-ttu-id="d29c9-180">Le navigateur suppose que le `~` fait partie de l’URL.</span><span class="sxs-lookup"><span data-stu-id="d29c9-180">The browser assumes that the `~` is part of the URL.</span></span> <span data-ttu-id="d29c9-181">Par exemple, si le navigateur reçoit le balisage `<img src="~/Images/PoweredByASPNET.gif" />` il suppose qu’il existe un sous-dossier nommé `~` avec un sous-dossier `Images` qui contient le fichier image `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-181">For example, if the browser receives the markup `<img src="~/Images/PoweredByASPNET.gif" />` it assumes there is a subfolder named `~` with a subfolder `Images` that contains the image file `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="d29c9-182">Pour corriger le balisage de l’image dans `Site.master`, remplacez le `<img>` élément avec un contrôle ASP.NET Image Web.</span><span class="sxs-lookup"><span data-stu-id="d29c9-182">To fix the image markup in `Site.master`, replace the existing `<img>` element with an ASP.NET Image Web control.</span></span> <span data-ttu-id="d29c9-183">Définir le contrôle Image Web `ID` à `PoweredByImage`, ses `ImageUrl` propriété `~/Images/PoweredByASPNET.gif`et son `AlternateText` propriété à « Powered by ASP.NET ! »</span><span class="sxs-lookup"><span data-stu-id="d29c9-183">Set the Image Web control's `ID` to `PoweredByImage`, its `ImageUrl` property to `~/Images/PoweredByASPNET.gif`, and its `AlternateText` property to "Powered by ASP.NET!"</span></span>


[!code-aspx[Main](urls-in-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="d29c9-184">Après avoir apporté cette modification à la page maître, réexaminez la `~/Admin/Default.aspx` page à nouveau.</span><span class="sxs-lookup"><span data-stu-id="d29c9-184">After making this change to the master page, revisit the `~/Admin/Default.aspx` page again.</span></span> <span data-ttu-id="d29c9-185">Cette fois le `PoweredByASPNET.gif` fichier image s’affiche dans la page (voir Figure 3).</span><span class="sxs-lookup"><span data-stu-id="d29c9-185">This time the `PoweredByASPNET.gif` image file appears in the page (see Figure 3).</span></span> <span data-ttu-id="d29c9-186">Lorsque le Web de l’Image de contrôle est restitué il utilise le `ResolveClientUrl` méthode pour résoudre son `ImageUrl` valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="d29c9-186">When the Image Web control is rendered it uses the `ResolveClientUrl` method to resolve its `ImageUrl` property value.</span></span> <span data-ttu-id="d29c9-187">Dans `~/Admin/Default.aspx` le `ImageUrl` est convertie en une URL relative appropriée, comme l’extrait de code HTML source montre suivant :</span><span class="sxs-lookup"><span data-stu-id="d29c9-187">In `~/Admin/Default.aspx` the `ImageUrl` is converted into an appropriate relative URL, as the following snippet of HTML source shows:</span></span>


[!code-html[Main](urls-in-master-pages-vb/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="d29c9-188">En plus des propriétés du contrôle Web basé sur l’URL, le `~` peut également être utilisé lors de l’appel le `Response.Redirect` et `Server.MapPath` méthodes, entre autres.</span><span class="sxs-lookup"><span data-stu-id="d29c9-188">In addition to being used in URL-based Web control properties, the `~` can also be used when calling the `Response.Redirect` and `Server.MapPath` methods, among others.</span></span> <span data-ttu-id="d29c9-189">En outre, le `ResolveClientUrl` méthode peut être appelée directement à partir d’un ASP.NET ou le balisage déclaratif de la page maître, si nécessaire ; consultez [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)d’entrée de blog [Using `ResolveClientUrl` dans le balisage](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span><span class="sxs-lookup"><span data-stu-id="d29c9-189">Also, the `ResolveClientUrl` method may be invoked directly from an ASP.NET or master page's declarative markup, if needed; see [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)'s blog entry [Using `ResolveClientUrl` in Markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span></span>


## <a name="fixing-the-master-pages-remaining-relative-urls"></a><span data-ttu-id="d29c9-190">Correction de la Page maître restant des URL relatives</span><span class="sxs-lookup"><span data-stu-id="d29c9-190">Fixing the Master Page's Remaining Relative URLs</span></span>

<span data-ttu-id="d29c9-191">Outre le `<img>` élément dans le `footerContent` que nous avons résolu simplement, la page maître contient une URL relative plus nécessitant notre attention.</span><span class="sxs-lookup"><span data-stu-id="d29c9-191">In addition to the `<img>` element in the `footerContent` that we just fixed, the master page contains one more relative URL that requires our attention.</span></span> <span data-ttu-id="d29c9-192">Le `topContent` région inclut le lien « Master Pages didacticiels, » qui pointe vers `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-192">The `topContent` region includes the link "Master Pages Tutorials," which points to `Default.aspx`.</span></span>


[!code-html[Main](urls-in-master-pages-vb/samples/sample7.html)]

<span data-ttu-id="d29c9-193">Étant donné que cette URL est relative, il envoie l’utilisateur à la `Default.aspx` page dans le dossier de la page de contenu qu’ils visitent.</span><span class="sxs-lookup"><span data-stu-id="d29c9-193">Because this URL is relative, it will send the user to the `Default.aspx` page in the folder of the content page they are visiting.</span></span> <span data-ttu-id="d29c9-194">Pour que ce lien pointent toujours vers `Default.aspx` dans le dossier racine, nous devons remplacer le `<a>` élément avec un site Web HyperLink contrôler afin que nous pouvons utiliser le `~` notation.</span><span class="sxs-lookup"><span data-stu-id="d29c9-194">To have this link always point to `Default.aspx` in the root folder we need to replace the `<a>` element with a HyperLink Web control so that we can use the `~` notation.</span></span>

<span data-ttu-id="d29c9-195">Supprimer le `<a>` balisage d’élément et ajouter un contrôle de lien hypertexte à la place.</span><span class="sxs-lookup"><span data-stu-id="d29c9-195">Remove the `<a>` element markup and add a HyperLink control in its place.</span></span> <span data-ttu-id="d29c9-196">Valeur du lien hypertexte `ID` à `lnkHome`, ses `NavigateUrl` propriété `~/Default.aspx`et son `Text` propriété à « Didacticiels de Pages maître ».</span><span class="sxs-lookup"><span data-stu-id="d29c9-196">Set the HyperLink's `ID` to `lnkHome`, its `NavigateUrl` property to `~/Default.aspx`, and its `Text` property to "Master Pages Tutorials."</span></span>


[!code-aspx[Main](urls-in-master-pages-vb/samples/sample8.aspx)]

<span data-ttu-id="d29c9-197">C’est tout !</span><span class="sxs-lookup"><span data-stu-id="d29c9-197">That's it!</span></span> <span data-ttu-id="d29c9-198">À ce stade, toutes les URL dans notre page maître reposent correctement lors du rendu à une page de contenu, quel que soit les dossiers de la page maître et la page de contenu sont situés dans.</span><span class="sxs-lookup"><span data-stu-id="d29c9-198">At this point all the URLs in our master page are properly based when rendered by a content page regardless of what folders the master page and content page are located in.</span></span>

### <a name="automatic-url-resolution-in-theheadsection"></a><span data-ttu-id="d29c9-199">Résolution des URL automatique dans le`<head>`Section</span><span class="sxs-lookup"><span data-stu-id="d29c9-199">Automatic URL Resolution in the`<head>`Section</span></span>

<span data-ttu-id="d29c9-200">Dans le [ *création d’une disposition de l’échelle du Site à l’aide des Pages maîtres* ](creating-a-site-wide-layout-using-master-pages-vb.md) didacticiel, nous avons ajouté un `<link>` à la `Styles.css` de fichiers dans le `<head>` région :</span><span class="sxs-lookup"><span data-stu-id="d29c9-200">In the [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md) tutorial we added a `<link>` to the `Styles.css` file in the `<head>` region:</span></span>


[!code-aspx[Main](urls-in-master-pages-vb/samples/sample9.aspx)]

<span data-ttu-id="d29c9-201">Bien que le `<link>` l’élément `href` attribut est relatif, il est automatiquement converti en un chemin d’accès approprié lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="d29c9-201">While the `<link>` element's `href` attribute is relative, it's automatically converted to an appropriate path at runtime.</span></span> <span data-ttu-id="d29c9-202">Comme expliqué dans la [ *spécifiant le titre, les balises Meta et les autres en-têtes HTML dans la Page maître* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) didacticiel, le `<head>` région est en fait un contrôle côté serveur, ce qui lui permet de modifier le contenu de ses contrôles internes lorsqu’il est restitué.</span><span class="sxs-lookup"><span data-stu-id="d29c9-202">As we discussed in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial, the `<head>` region is actually a server-side control, which enables it to modify the contents of its inner controls when it is rendered.</span></span>

<span data-ttu-id="d29c9-203">Pour vérifier ceci, réexaminez la `~/Admin/Default.aspx` page et afficher la source HTML envoyée au navigateur.</span><span class="sxs-lookup"><span data-stu-id="d29c9-203">To verify this, revisit the `~/Admin/Default.aspx` page and view the HTML source sent to the browser.</span></span> <span data-ttu-id="d29c9-204">Comme l’illustre l’extrait de code ci-dessous, le `<link>` l’élément `href` attribut a été modifié automatiquement vers une URL relative appropriée, `../Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="d29c9-204">As the snippet below illustrates, the `<link>` element's `href` attribute has been automatically modified to an appropriate relative URL, `../Styles.css`.</span></span>


[!code-html[Main](urls-in-master-pages-vb/samples/sample10.html)]

## <a name="summary"></a><span data-ttu-id="d29c9-205">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="d29c9-205">Summary</span></span>

<span data-ttu-id="d29c9-206">Pages maîtres sont très souvent des liens, des images et autres ressources externes qui doivent être spécifiées via une URL.</span><span class="sxs-lookup"><span data-stu-id="d29c9-206">Master pages very often include links, images, and other external resources that must be specified via a URL.</span></span> <span data-ttu-id="d29c9-207">Étant donné que la page maître et les pages de contenu ne peuvent pas exister dans le même dossier, il est important de s’abstiennent d’à l’aide des URL relatives.</span><span class="sxs-lookup"><span data-stu-id="d29c9-207">Because the master page and content pages might not exist in the same folder, it is important to abstain from using relative URLs.</span></span> <span data-ttu-id="d29c9-208">Bien qu’il soit possible d’utiliser des URL absolues codée en dur, fait donc étroitement associe l’URL absolue à l’application web.</span><span class="sxs-lookup"><span data-stu-id="d29c9-208">While it is possible to use hard coded absolute URLs, doing so tightly couples the absolute URL to the web application.</span></span> <span data-ttu-id="d29c9-209">Si les modifications de l’URL absolue - comme il le fait souvent lors du déplacement ou de déploiement d’une application web - vous devrez n’oubliez pas de revenir en arrière et mettez à jour les URL absolues.</span><span class="sxs-lookup"><span data-stu-id="d29c9-209">If the absolute URL changes - as it often does when moving or deploying a web application - you'll have to remember to go back and update the absolute URLs.</span></span>

<span data-ttu-id="d29c9-210">L’approche idéale consiste à utiliser le tilde (`~`) pour indiquer la racine de l’application.</span><span class="sxs-lookup"><span data-stu-id="d29c9-210">The ideal approach is to use the tilde (`~`) to indicate the application root.</span></span> <span data-ttu-id="d29c9-211">Mappent les contrôles Web ASP.NET qui contiennent des propriétés liées en URL la `~` à la racine de l’application lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="d29c9-211">ASP.NET Web controls that contain URL-related properties map the `~` to the application root at runtime.</span></span> <span data-ttu-id="d29c9-212">En interne, les contrôles Web utilisent le `Control` la classe `ResolveClientUrl` méthode permettant de générer une URL relative valide.</span><span class="sxs-lookup"><span data-stu-id="d29c9-212">Internally, the Web controls use the `Control` class's `ResolveClientUrl` method to generate a valid relative URL.</span></span> <span data-ttu-id="d29c9-213">Cette méthode est publique et disponible à partir de chaque contrôle de serveur (y compris la `Page` classe), de sorte que vous pouvez l’utiliser par programme à partir de vos classes de code-behind, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="d29c9-213">This method is public and available from every server control (including the `Page` class), so you can use it programmatically from your code-behind classes, if needed.</span></span>

<span data-ttu-id="d29c9-214">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="d29c9-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="d29c9-215">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="d29c9-215">Further Reading</span></span>

<span data-ttu-id="d29c9-216">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="d29c9-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d29c9-217">Pages maître dans ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d29c9-217">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/Articles/419.aspx)
- [<span data-ttu-id="d29c9-218">URL relocalisation dans une Page maître</span><span class="sxs-lookup"><span data-stu-id="d29c9-218">URL Rebasing in a Master Page</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx#urls)
- [<span data-ttu-id="d29c9-219">À l’aide de `ResolveClientUrl` dans le balisage</span><span class="sxs-lookup"><span data-stu-id="d29c9-219">Using `ResolveClientUrl` in Markup</span></span>](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)

### <a name="about-the-author"></a><span data-ttu-id="d29c9-220">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="d29c9-220">About the Author</span></span>

<span data-ttu-id="d29c9-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de plusieurs livres de sur ASP/ASP.NET et fondateur de 4GuysFromRolla.com, travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="d29c9-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d29c9-222">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="d29c9-222">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d29c9-223">Son dernier livre s’intitule [ *Sams Teach vous-même ASP.NET 3.5 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d29c9-223">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d29c9-224">Scott peut être atteint à [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) ou via son blog à [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="d29c9-224">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="d29c9-225">Remerciements</span><span class="sxs-lookup"><span data-stu-id="d29c9-225">Special Thanks To</span></span>

<span data-ttu-id="d29c9-226">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="d29c9-226">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d29c9-227">Dans ce cas, envoyez-moi une ligne à [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="d29c9-227">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d29c9-228">[Précédent](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
> [Suivant](control-id-naming-in-content-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d29c9-228">[Previous](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
[Next](control-id-naming-in-content-pages-vb.md)</span></span>
