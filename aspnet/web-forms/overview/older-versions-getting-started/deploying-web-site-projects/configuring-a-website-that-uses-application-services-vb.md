---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-vb
title: Configuration d’un site Web qui utilise les Services d’Application (VB) | Microsoft Docs
author: rick-anderson
description: ASP.NET version 2.0 a introduit une série de services d’application, qui font partie du .NET Framework et de répondre à une suite de bloc de construction de services qui yo...
ms.author: riande
ms.date: 04/23/2009
ms.assetid: 9c31a42f-d8bb-4c0f-9ccc-597d4f70ac42
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-vb
msc.type: authoredcontent
ms.openlocfilehash: b8ec246c2f35f3d7fa5bcf67aa6f157195028176
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59379519"
---
# <a name="configuring-a-website-that-uses-application-services-vb"></a><span data-ttu-id="e48f3-103">Configuration d’un site web qui utilise les services d’application (VB)</span><span class="sxs-lookup"><span data-stu-id="e48f3-103">Configuring a Website that Uses Application Services (VB)</span></span>

<span data-ttu-id="e48f3-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e48f3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e48f3-105">[Télécharger le Code](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_VB.zip) ou [télécharger le PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="e48f3-105">[Download Code](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_VB.zip) or [Download PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_vb.pdf)</span></span>

> <span data-ttu-id="e48f3-106">ASP.NET version 2.0 a introduit une série de services d’application, qui font partie du .NET Framework et servent à une suite de services de bloc de construction que vous pouvez utiliser pour ajouter des fonctionnalités enrichies à votre application web.</span><span class="sxs-lookup"><span data-stu-id="e48f3-106">ASP.NET version 2.0 introduced a series of application services, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="e48f3-107">Ce didacticiel explique comment configurer un site Web dans l’environnement de production à utiliser les services d’application et résout les problèmes courants avec la gestion des comptes d’utilisateurs et rôles sur l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-107">This tutorial explores how to configure a website in the production environment to use application services and addresses common issues with managing user accounts and roles on the production environment.</span></span>


## <a name="introduction"></a><span data-ttu-id="e48f3-108">Introduction</span><span class="sxs-lookup"><span data-stu-id="e48f3-108">Introduction</span></span>

<span data-ttu-id="e48f3-109">ASP.NET version 2.0 a introduit une série de *les services d’application*, qui font partie du .NET Framework et constituent une suite de bloc de construction de services que vous pouvez utiliser pour ajouter des fonctionnalités enrichies à votre application web.</span><span class="sxs-lookup"><span data-stu-id="e48f3-109">ASP.NET version 2.0 introduced a series of *application services*, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="e48f3-110">Les services d’application sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="e48f3-110">The application services include:</span></span>

- <span data-ttu-id="e48f3-111">**L’appartenance** : API pour créer et gérer des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-111">**Membership** - an API for creating and managing user accounts.</span></span>
- <span data-ttu-id="e48f3-112">**Rôles** : API pour classer les utilisateurs en groupes.</span><span class="sxs-lookup"><span data-stu-id="e48f3-112">**Roles** - an API for categorizing users into groups.</span></span>
- <span data-ttu-id="e48f3-113">**Profil** : API de stockage du contenu personnalisé, spécifiques à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-113">**Profile** - an API for storing custom, user-specific content.</span></span>
- <span data-ttu-id="e48f3-114">**Plan du site** : API permettant de définir une structure logique du site s sous la forme d’une hiérarchie, ce qui peut ensuite être affichée via des contrôles de navigation, notamment les menus et barres de navigation.</span><span class="sxs-lookup"><span data-stu-id="e48f3-114">**Site Map** - an API for defining a site s logical structure in the form of a hierarchy, which can then be displayed via navigation controls, such as menus and breadcrumbs.</span></span>
- <span data-ttu-id="e48f3-115">**Personnalisation** : API pour gérer les préférences de personnalisation, plus souvent utilisés avec [ *WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span><span class="sxs-lookup"><span data-stu-id="e48f3-115">**Personalization** - an API for maintaining customization preferences, most often used with [*WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span></span>
- <span data-ttu-id="e48f3-116">**Analyse d’intégrité** : API pour la surveillance des performances, la sécurité, les erreurs et autres mesures de contrôle d’intégrité système pour une application web en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e48f3-116">**Health Monitoring** - an API for monitoring performance, security, errors, and other system health metrics for a running web application.</span></span>
  

<span data-ttu-id="e48f3-117">Les services d’application API ne sont pas liés à une implémentation spécifique.</span><span class="sxs-lookup"><span data-stu-id="e48f3-117">The application services APIs are not tied to a specific implementation.</span></span> <span data-ttu-id="e48f3-118">Au lieu de cela, vous demandez les services d’application à utiliser un particulier *fournisseur*, et ce fournisseur implémente le service à l’aide d’une technologie particulière.</span><span class="sxs-lookup"><span data-stu-id="e48f3-118">Instead, you instruct the application services to use a particular *provider*, and that provider implements the service using a particular technology.</span></span> <span data-ttu-id="e48f3-119">Les fournisseurs couramment utilisés pour les applications web basées sur Internet hébergées sur une société d’hébergement web sont les fournisseurs qui utilisent une implémentation de base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e48f3-119">The most commonly used providers for Internet-based web applications hosted at a web hosting company are those providers that use a SQL Server database implementation.</span></span> <span data-ttu-id="e48f3-120">Par exemple, le `SqlMembershipProvider` est un fournisseur pour l’API d’appartenance qui stocke les informations de compte utilisateur dans une base de données Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e48f3-120">For example, the `SqlMembershipProvider` is a provider for the Membership API that stores user account information in a Microsoft SQL Server database.</span></span>

<span data-ttu-id="e48f3-121">Les services d’application et les fournisseurs de SQL Server ajoute des défis lors du déploiement de l’application.</span><span class="sxs-lookup"><span data-stu-id="e48f3-121">Using the application services and SQL Server providers adds some challenges when deploying the application.</span></span> <span data-ttu-id="e48f3-122">Pour commencer, les objets de base de données d’application services doivent être créées correctement sur les bases de données à la fois le développement et de production et initialisés correctement.</span><span class="sxs-lookup"><span data-stu-id="e48f3-122">For starters, the application services database objects must be properly created on both the development and production databases and appropriately initialized.</span></span> <span data-ttu-id="e48f3-123">Il existe également des paramètres de configuration importants qui doivent être apportées.</span><span class="sxs-lookup"><span data-stu-id="e48f3-123">There are also important configuration settings that need to be made.</span></span>

> [!NOTE]
> <span data-ttu-id="e48f3-124">Les services d’application API ont été conçues à l’aide de la [ *modèle de fournisseur*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), un modèle de conception qui permet une API s détails d’implémentation doit être fourni lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e48f3-124">The application services APIs were designed using the [*provider model*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), a design pattern that allows for an API s implementation details to be provided at runtime.</span></span> <span data-ttu-id="e48f3-125">Le .NET Framework est livré avec un nombre de fournisseurs de services d’application qui peut être utilisée, telle que la `SqlMembershipProvider` et `SqlRoleProvider`, qui sont des fournisseurs pour l’appartenance et les API de rôles qui utilisent un serveur SQL Server de base de données mise en œuvre.</span><span class="sxs-lookup"><span data-stu-id="e48f3-125">The .NET Framework ships with a number of application service providers that can be used, such as the `SqlMembershipProvider` and `SqlRoleProvider`, which are providers for the Membership and Roles APIs that use a SQL Server database implementation.</span></span> <span data-ttu-id="e48f3-126">Vous pouvez également créer et plug-in un fournisseur personnalisé.</span><span class="sxs-lookup"><span data-stu-id="e48f3-126">You can also create and plug-in a custom provider.</span></span> <span data-ttu-id="e48f3-127">En fait, les critiques de livres web application contient déjà un fournisseur personnalisé pour l’API de mappage de Site (`ReviewSiteMapProvider`), qui construit le plan de site à partir des données dans le `Genres` et `Books` tables dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="e48f3-127">In fact, the Book Reviews web application already contains a custom provider for the Site Map API (`ReviewSiteMapProvider`), which constructs the site map from the data in the `Genres` and `Books` tables in the database.</span></span>


<span data-ttu-id="e48f3-128">Ce didacticiel commence par examiner comment j’ai étendu de l’application web de critiques de livres à utiliser l’appartenance et l’API de rôles.</span><span class="sxs-lookup"><span data-stu-id="e48f3-128">This tutorial starts with a look at how I extended the Book Reviews web application to use the Membership and Roles APIs.</span></span> <span data-ttu-id="e48f3-129">Ensuite, il guide de déploiement d’une application web qui utilise les services d’application avec une implémentation de base de données SQL Server et se termine en résolvant les problèmes courants liés à la gestion des comptes d’utilisateurs et rôles sur l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-129">It then walks through deploying a web application that uses application services with a SQL Server database implementation, and concludes by addressing common issues with managing user accounts and roles on the production environment.</span></span>

## <a name="updates-to-the-book-reviews-application"></a><span data-ttu-id="e48f3-130">Mises à jour de l’Application d’évaluations de livre</span><span class="sxs-lookup"><span data-stu-id="e48f3-130">Updates to the Book Reviews Application</span></span>

<span data-ttu-id="e48f3-131">Dernières didacticiels de que l’application web passe en revue du livre a été mis à jour à partir d’un site Web statique à une application web dynamique piloté par les données se termine avec un ensemble de pages d’administration pour la gestion des genres et révisions.</span><span class="sxs-lookup"><span data-stu-id="e48f3-131">Over the past couple tutorials the Book Reviews web application was updated from a static website to a dynamic, data-driven web application complete with a set of administration pages for managing genres and reviews.</span></span> <span data-ttu-id="e48f3-132">Toutefois, cette section d’administration n’est actuellement pas protégée : tout utilisateur qui sait (ou devine) l’URL de page d’administration permettre s’introduire dans et créer, modifier ou supprimer les révisions sur notre site.</span><span class="sxs-lookup"><span data-stu-id="e48f3-132">However, this administration section is currently not protected - any user who knows (or guesses) the administration page URL can waltz in and create, edit, or delete reviews on our site.</span></span> <span data-ttu-id="e48f3-133">Une méthode courante pour protéger certaines parties d’un site Web consiste à implémenter des comptes d’utilisateur et ensuite utiliser des règles d’autorisation d’URL pour restreindre l’accès à certains utilisateurs ou les rôles.</span><span class="sxs-lookup"><span data-stu-id="e48f3-133">A common way to protect certain portions of a website is to implement user accounts and then use URL authorization rules to restrict access to certain users or roles.</span></span> <span data-ttu-id="e48f3-134">L’application web critiques de livres disponible pour téléchargement avec ce didacticiel prend en charge les rôles et les comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-134">The Book Reviews web application available for download with this tutorial supports user accounts and roles.</span></span> <span data-ttu-id="e48f3-135">Il dispose d’un seul rôle défini nommé Administrateur, et seuls les utilisateurs de ce rôle peuvent accéder les pages d’administration.</span><span class="sxs-lookup"><span data-stu-id="e48f3-135">It has a single role defined named Admin and only users in this role can access the administration pages.</span></span>

> [!NOTE]
> <span data-ttu-id="e48f3-136">Je ve créé trois comptes d’utilisateurs dans l’application web de critiques de livres : Scott, Jisun et Alice.</span><span class="sxs-lookup"><span data-stu-id="e48f3-136">I ve created three user accounts in the Book Reviews web application: Scott, Jisun, and Alice.</span></span> <span data-ttu-id="e48f3-137">Tous les utilisateurs de trois ont le même mot de passe : **mot de passe !**</span><span class="sxs-lookup"><span data-stu-id="e48f3-137">All three users have the same password: **password!**</span></span> <span data-ttu-id="e48f3-138">Scott et Jisun se trouvent dans le rôle d’administrateur, Alice n’est pas.</span><span class="sxs-lookup"><span data-stu-id="e48f3-138">Scott and Jisun are in the Admin role, Alice is not.</span></span> <span data-ttu-id="e48f3-139">Les pages de non-administration de site s sont toujours accessibles aux utilisateurs anonymes.</span><span class="sxs-lookup"><span data-stu-id="e48f3-139">The site s non-administration pages are still accessible to anonymous users.</span></span> <span data-ttu-id="e48f3-140">Autrement dit, vous n’avez pas besoin pour vous connecter à visiter le site, sauf si vous souhaitez administrer, auquel cas vous devez être connecté en tant qu’utilisateur dans le rôle d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-140">That is, you do not need to sign in to visit the site, unless you want to administer it, in which case you must sign in as a user in the Admin role.</span></span>


<span data-ttu-id="e48f3-141">La page maître de critiques de livres application s a été mis à jour pour inclure une interface utilisateur différente pour les utilisateurs authentifiés et anonymes.</span><span class="sxs-lookup"><span data-stu-id="e48f3-141">The Book Reviews application s master page has been updated to include a different user interface for authenticated and anonymous users.</span></span> <span data-ttu-id="e48f3-142">Si un utilisateur anonyme visite le site, il voit un lien de connexion dans le coin supérieur droit.</span><span class="sxs-lookup"><span data-stu-id="e48f3-142">If an anonymous user visits the site she sees a Login link in the upper right corner.</span></span> <span data-ttu-id="e48f3-143">Un utilisateur authentifié voit le message « Bienvenue, *nom d’utilisateur*! »</span><span class="sxs-lookup"><span data-stu-id="e48f3-143">An authenticated user sees the message, "Welcome back, *username*!"</span></span> <span data-ttu-id="e48f3-144">et un lien pour se déconnecter. Cet emplacement s également une page de connexion (`~/Login.aspx`), qui contient un contrôle Web de connexion qui fournit l’interface utilisateur et la logique d’authentification d’un visiteur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-144">and a link to log out. There s also a login page (`~/Login.aspx`), which contains a Login Web control that provides the user interface and logic for authenticating a visitor.</span></span> <span data-ttu-id="e48f3-145">Seuls les administrateurs peuvent créer de nouveaux comptes.</span><span class="sxs-lookup"><span data-stu-id="e48f3-145">Only administrators can create new accounts.</span></span> <span data-ttu-id="e48f3-146">(Il existe des pages pour créer et gérer des comptes d’utilisateur dans le `~/Admin` dossier.)</span><span class="sxs-lookup"><span data-stu-id="e48f3-146">(There are pages for creating and managing user accounts in the `~/Admin` folder.)</span></span>

### <a name="configuring-the-membership-and-roles-apis"></a><span data-ttu-id="e48f3-147">Configuration de l’appartenance et l’API de rôles</span><span class="sxs-lookup"><span data-stu-id="e48f3-147">Configuring the Membership and Roles APIs</span></span>

<span data-ttu-id="e48f3-148">L’application web de critiques de livres utilise l’appartenance et l’API de rôles pour prendre en charge les comptes d’utilisateur et pour regrouper ces utilisateurs dans des rôles (à savoir, le rôle d’administrateur).</span><span class="sxs-lookup"><span data-stu-id="e48f3-148">The Book Reviews web application uses the Membership and Roles APIs to support user accounts and to group those users into roles (namely, the Admin role).</span></span> <span data-ttu-id="e48f3-149">Le `SqlMembershipProvider` et `SqlRoleProvider` des classes de fournisseur sont utilisées, car nous voulons stocker les informations de compte et le rôle dans une base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e48f3-149">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes are used because we want to store account and role information in a SQL Server database.</span></span>

> [!NOTE]
> <span data-ttu-id="e48f3-150">Ce n’est pas vocation à être un examen détaillé à la configuration d’une application web pour prendre en charge l’appartenance et l’API de rôles.</span><span class="sxs-lookup"><span data-stu-id="e48f3-150">This tutorial is not intended to be a detailed examination at configuring a web application to support the Membership and Roles APIs.</span></span> <span data-ttu-id="e48f3-151">Pour obtenir une présentation approfondie à ces API et les étapes à suivre pour configurer un site Web pour les utiliser, lisez mon [ *didacticiels de sécurité de site Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="e48f3-151">For a thorough look at these APIs and the steps you need to take to configure a website to use them, please read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>


<span data-ttu-id="e48f3-152">Pour utiliser les services d’application avec une base de données SQL Server, vous devez tout d’abord ajouter les objets de base de données utilisés par ces fournisseurs pour la base de données où vous souhaitez que le compte d’utilisateur et les informations de rôle stockées.</span><span class="sxs-lookup"><span data-stu-id="e48f3-152">To use the application services with a SQL Server database you must first add the database objects used by these providers to the database where you want the user account and role information stored.</span></span> <span data-ttu-id="e48f3-153">Ces objets de base de données requis incluent une variété de tables, vues et procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="e48f3-153">These requisite database objects include a variety of tables, views, and stored procedures.</span></span> <span data-ttu-id="e48f3-154">Sauf indication contraire, le `SqlMembershipProvider` et `SqlRoleProvider` des classes de fournisseur utilisent une base de données SQL Server Express Edition nommé `ASPNETDB` situé dans le s application `App_Data` dossier ; si une base de données n’existe pas, il est automatiquement créé avec les objets de base de données nécessaires par ces fournisseurs lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e48f3-154">Unless specified otherwise, the `SqlMembershipProvider` and `SqlRoleProvider` provider classes use a SQL Server Express Edition database named `ASPNETDB` located in the application s `App_Data` folder; if such a database does not exist, it is automatically created with the necessary database objects by these providers at runtime.</span></span>

<span data-ttu-id="e48f3-155">Il est possible, et généralement idéal pour créer des objets de base de données dans la même base de données où sont stockées les données spécifiques à l’application de s site Web services de l’application.</span><span class="sxs-lookup"><span data-stu-id="e48f3-155">It is possible, and usually ideal, to create the application services database objects in the same database where the website s application-specific data is stored.</span></span> <span data-ttu-id="e48f3-156">Le .NET Framework est livré avec un outil nommé `aspnet_regsql.exe` qui installe les objets de base de données sur une base de données spécifiée.</span><span class="sxs-lookup"><span data-stu-id="e48f3-156">The .NET Framework ships with a tool named `aspnet_regsql.exe` that installs the database objects on a specified database.</span></span> <span data-ttu-id="e48f3-157">J’ai poursuivi et cet outil permet d’ajouter ces objets à la `Reviews.mdf` de base de données dans le `App_Data` dossier (la base de données de développement).</span><span class="sxs-lookup"><span data-stu-id="e48f3-157">I have gone ahead and used this tool to add these objects to the `Reviews.mdf` database in the `App_Data` folder (the development database).</span></span> <span data-ttu-id="e48f3-158">Nous verrons comment utiliser cet outil plus loin dans ce didacticiel lorsque nous ajoutons à ces objets à la base de données de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-158">We'll see how to use this tool later in this tutorial when we add these objects to the production database.</span></span>

<span data-ttu-id="e48f3-159">Si vous ajoutez l’application services autres que les objets de base de données à une base de données `ASPNETDB` vous devez personnaliser le `SqlMembershipProvider` et `SqlRoleProvider` fournisseur classes configurations afin qu’ils utilisent la base de données approprié.</span><span class="sxs-lookup"><span data-stu-id="e48f3-159">If you add the application services database objects to a database other than `ASPNETDB` you will need to customize the `SqlMembershipProvider` and `SqlRoleProvider` provider classes configurations so that they use the appropriate database.</span></span> <span data-ttu-id="e48f3-160">Pour personnaliser le fournisseur d’appartenances ajouter un [  *&lt;appartenance&gt; élément* ](https://msdn.microsoft.com/library/1b9hw62f.aspx) au sein de la `<system.web>` section dans `Web.config`; utiliser le [  *&lt;roleManager&gt; élément* ](https://msdn.microsoft.com/library/ms164660.aspx) pour configurer le fournisseur de rôles.</span><span class="sxs-lookup"><span data-stu-id="e48f3-160">To customize the Membership provider add a [*&lt;membership&gt; element*](https://msdn.microsoft.com/library/1b9hw62f.aspx) within the `<system.web>` section in `Web.config`; use the [*&lt;roleManager&gt; element*](https://msdn.microsoft.com/library/ms164660.aspx) to configure the Roles provider.</span></span> <span data-ttu-id="e48f3-161">L’extrait de code suivant provient de la s d’application critiques de livres `Web.config` et affiche les paramètres de configuration pour l’appartenance et l’API de rôles.</span><span class="sxs-lookup"><span data-stu-id="e48f3-161">The following snippet is taken from the Book Reviews application s `Web.config` and shows the configure settings for the Membership and Roles APIs.</span></span> <span data-ttu-id="e48f3-162">Notez que les deux inscrire un nouveau fournisseur - `ReviewMembership` et `ReviewRole` -qui utilisent le `SqlMembershipProvider` et `SqlRoleProvider` fournisseurs, respectivement.</span><span class="sxs-lookup"><span data-stu-id="e48f3-162">Note that both register a new provider - `ReviewMembership` and `ReviewRole` - that use the `SqlMembershipProvider` and `SqlRoleProvider` providers, respectively.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-vb/samples/sample1.xml)]

<span data-ttu-id="e48f3-163">Le `Web.config` fichier s `<authentication>` élément a également été configuré pour prendre en charge l’authentification basée sur les formulaires.</span><span class="sxs-lookup"><span data-stu-id="e48f3-163">The `Web.config` file s `<authentication>` element has also been configured to support forms-based authentication.</span></span>
  

[!code-xml[Main](configuring-a-website-that-uses-application-services-vb/samples/sample2.xml)]

### <a name="limiting-access-to-the-administration-pages"></a><span data-ttu-id="e48f3-164">Limiter l’accès aux Pages d’Administration</span><span class="sxs-lookup"><span data-stu-id="e48f3-164">Limiting Access to the Administration Pages</span></span>

<span data-ttu-id="e48f3-165">ASP.NET facilite l’accorder ou refuser l’accès à un fichier particulier ou un dossier par utilisateur ou par rôle via son *l’autorisation d’URL* fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="e48f3-165">ASP.NET makes it easy to grant or deny access to a particular file or folder by user or by role via its *URL authorization* feature.</span></span> <span data-ttu-id="e48f3-166">(Nous avons abordé brièvement l’autorisation d’URL dans le *principales différences entre IIS et le serveur de développement ASP.NET* didacticiel et vous a montré comment IIS et le serveur de développement ASP.NET appliquent des règles d’autorisation d’URL différemment pour statique par rapport à un contenu dynamique.) Étant donné que nous souhaitons interdire l’accès à la `~/Admin` dossier à l’exception de ces utilisateurs dans le rôle d’administrateur, nous devons ajouter des règles d’autorisation d’URL dans ce dossier.</span><span class="sxs-lookup"><span data-stu-id="e48f3-166">(We briefly discussed URL authorization in the *Core Differences Between IIS and the ASP.NET Development Server* tutorial and showed how IIS and the ASP.NET Development Server apply URL authorization rules differently for static versus dynamic content.) Because we want to prohibit access to the `~/Admin` folder except for those users in the Admin role, we need to add URL authorization rules to this folder.</span></span> <span data-ttu-id="e48f3-167">Plus précisément, les règles d’autorisation d’URL devront autoriser les utilisateurs dans le rôle d’administrateur et refuser tous les autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="e48f3-167">Specifically, the URL authorization rules need to allow users in the Admin role and deny all other users.</span></span> <span data-ttu-id="e48f3-168">Cela s’effectue en ajoutant un `Web.config` de fichiers à la `~/Admin` dossier avec le contenu suivant :</span><span class="sxs-lookup"><span data-stu-id="e48f3-168">This is accomplished by adding a `Web.config` file to the `~/Admin` folder with the following contents:</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-vb/samples/sample3.xml)]

<span data-ttu-id="e48f3-169">Pour plus d’informations sur la fonctionnalité d’autorisation ASP.NET s URL et comment l’utiliser pour écrire des règles d’autorisation pour les utilisateurs et pour les rôles, veillez à lire le [ *autorisation basée sur l’utilisateur* ](../../older-versions-security/membership/user-based-authorization-vb.md) et [ *Autorisation basée sur le rôle* ](../../older-versions-security/roles/role-based-authorization-vb.md) didacticiels à partir de mon [ *didacticiels de sécurité de site Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="e48f3-169">For more information on ASP.NET s URL authorization feature and how to use it to spell out authorization rules for users and for roles, be sure to read the [*User-Based Authorization*](../../older-versions-security/membership/user-based-authorization-vb.md) and [*Role-Based Authorization*](../../older-versions-security/roles/role-based-authorization-vb.md) tutorials from my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

## <a name="deploying-a-web-application-that-uses-application-services"></a><span data-ttu-id="e48f3-170">Déploiement d’une Application Web qui utilise les Services d’Application</span><span class="sxs-lookup"><span data-stu-id="e48f3-170">Deploying a Web Application That Uses Application Services</span></span>

<span data-ttu-id="e48f3-171">Lorsque vous déployez un site Web qui utilise les services d’application et un fournisseur qui stocke les informations de services d’application dans une base de données, il est impératif que les objets de base de données requis par les services d’application créés sur la base de données de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-171">When deploying a website that uses application services and a provider that stores the application services information in a database, it is imperative that the database objects needed by the application services be created on the production database.</span></span> <span data-ttu-id="e48f3-172">Initialement la base de données de production ne contient pas de ces objets, donc lorsque l’application est déployée tout d’abord (ou lorsqu’elle est déployée pour la première fois après ont ajouté des services d’application), vous devez prendre des mesures supplémentaires pour obtenir ces objets de base de données requis sur le base de données de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-172">Initially the production database does not contain these objects, so when the application is first deployed (or when it is deployed for the first time after application services have been added), you must take extra steps to get these requisite database objects on the production database.</span></span>

<span data-ttu-id="e48f3-173">Un autre défi peut se produire lors du déploiement d’un site Web qui utilise les services d’application si vous souhaitez répliquer les comptes d’utilisateur créés dans l’environnement de développement à l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-173">Another challenge can arise when deploying a website that uses application services if you intend to replicate the user accounts created in the development environment to the production environment.</span></span> <span data-ttu-id="e48f3-174">Selon la configuration de l’appartenance et les rôles, il est possible que, même si vous copiez avec succès les comptes d’utilisateurs qui ont été créés dans l’environnement de développement pour la base de données de production, ces utilisateurs ne peuvent pas se connecter à l’application web en production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-174">Depending on the Membership and Roles configuration, it is possible that even if you successfully copy the user accounts that were created in the development environment to the production database, these users cannot sign into the web application in production.</span></span> <span data-ttu-id="e48f3-175">Nous allons examiner la cause de ce problème et discuter des méthodes pour l’empêcher de se produire.</span><span class="sxs-lookup"><span data-stu-id="e48f3-175">We'll look at the cause of this issue and discuss how to prevent it from happening.</span></span>

<span data-ttu-id="e48f3-176">ASP.NET est livré avec une belle [ *outil d’Administration de Site Web (WSAT)* ](https://msdn.microsoft.com/library/yy40ytx0.aspx) qui peut être lancé à partir de Visual Studio et permet à l’utilisateur compte, rôles, règles d’autorisation et d’être gérés via un sur le web interface.</span><span class="sxs-lookup"><span data-stu-id="e48f3-176">ASP.NET ships with a nice [*Web Site Administration Tool (WSAT)*](https://msdn.microsoft.com/library/yy40ytx0.aspx) that can be launched from Visual Studio and allows the user account, roles, and authorization rules to be managed through a web-based interface.</span></span> <span data-ttu-id="e48f3-177">Malheureusement, le WSAT fonctionne uniquement pour les sites Web locales, ce qui signifie qu’il ne peut pas être utilisé pour gérer à distance des comptes d’utilisateur, les rôles et les règles d’autorisation pour l’application web dans l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-177">Unfortunately, the WSAT only works for local websites, meaning that it cannot be used to remotely manage user accounts, roles, and authorization rules for the web application in the production environment.</span></span> <span data-ttu-id="e48f3-178">Nous allons examiner les différentes façons d’implémenter le comportement de WSAT à partir de votre site Web de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-178">We'll look at different ways to implement WSAT-like behavior from your production website.</span></span>

### <a name="adding-the-database-objects-using-aspnetregsqlexe"></a><span data-ttu-id="e48f3-179">Ajouter le compte aspnet à l’aide des objets de base de données\_regsql.exe</span><span class="sxs-lookup"><span data-stu-id="e48f3-179">Adding the Database Objects Using aspnet\_regsql.exe</span></span>

<span data-ttu-id="e48f3-180">Le *déploiement d’une base de données* didacticiel vous a montré comment copier les tables et les données à partir de la base de données de développement à la base de données de production, et ces techniques peuvent certainement être utilisées pour copier les objets de base de données de services application à la base de données de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-180">The *Deploying a Database* tutorial showed how to copy the tables and data from the development database to the production database, and these techniques can certainly be used to copy the application services database objects to the production database.</span></span> <span data-ttu-id="e48f3-181">Une autre option est la `aspnet_regsql.exe` outil, qui ajoute ou supprime les objets de base de données d’application services à partir d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="e48f3-181">Another option is the `aspnet_regsql.exe` tool, which adds or removes the application services database objects from a database.</span></span>

> [!NOTE]
> <span data-ttu-id="e48f3-182">Le `aspnet_regsql.exe` outil crée les objets de base de données sur une base de données spécifiée.</span><span class="sxs-lookup"><span data-stu-id="e48f3-182">The `aspnet_regsql.exe` tool creates the database objects on a specified database.</span></span> <span data-ttu-id="e48f3-183">Il ne migre pas les données dans ces objets de base de données à partir de la base de données de développement à la base de données de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-183">It does not migrate data in those database objects from the development database to the production database.</span></span> <span data-ttu-id="e48f3-184">Si vous souhaitez copier les informations de compte et le rôle d’utilisateur dans la base de données de développement à la base de données de production utiliser les techniques décrites dans le *déploiement d’une base de données* didacticiel.</span><span class="sxs-lookup"><span data-stu-id="e48f3-184">If you mean to copy the user account and role information in the development database to the production database use the techniques covered in the *Deploying a Database* tutorial.</span></span>


<span data-ttu-id="e48f3-185">S permettent de voir comment ajouter les objets de base de données à la base de données de production à l’aide du `aspnet_regsql.exe` outil.</span><span class="sxs-lookup"><span data-stu-id="e48f3-185">Let s look at how to add the database objects to the production database using the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="e48f3-186">Commencez par ouvrir l’Explorateur Windows et accédez au répertoire .NET Framework version 2.0 sur votre ordinateur, %WINDIR%\ Microsoft.NET\Framework\v2.0.50727.</span><span class="sxs-lookup"><span data-stu-id="e48f3-186">Start by opening Windows Explorer and navigating to the .NET Framework version 2.0 directory on your computer, %WINDIR%\ Microsoft.NET\Framework\v2.0.50727.</span></span> <span data-ttu-id="e48f3-187">Vous devriez voir le `aspnet_regsql.exe` outil.</span><span class="sxs-lookup"><span data-stu-id="e48f3-187">There you should find the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="e48f3-188">Cet outil peut être utilisé à partir de la ligne de commande, mais il inclut également une interface utilisateur graphique ; Double-cliquez sur le `aspnet_regsql.exe` fichier pour lancer son composant graphique.</span><span class="sxs-lookup"><span data-stu-id="e48f3-188">This tool can be used from the command-line, but it also includes a graphical user interface; double-click the `aspnet_regsql.exe` file to launch its graphical component.</span></span>

<span data-ttu-id="e48f3-189">L’outil démarre en affichant un écran de démarrage qui explique son objectif.</span><span class="sxs-lookup"><span data-stu-id="e48f3-189">The tool starts by displaying a splash screen explaining its purpose.</span></span> <span data-ttu-id="e48f3-190">Cliquez sur Suivant pour passer à l’écran « Sélectionnez une Option de configuration », qui est indiqué dans la Figure 1.</span><span class="sxs-lookup"><span data-stu-id="e48f3-190">Click Next to advance to the "Select a Setup Option" screen, which is shown in Figure 1.</span></span> <span data-ttu-id="e48f3-191">À partir de là, vous pouvez choisir d’ajouter les services d’application les objets de base de données ou les supprimer à partir d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="e48f3-191">From here you can choose to add the application services database objects or remove them from a database.</span></span> <span data-ttu-id="e48f3-192">Étant donné que nous souhaitons ajouter ces objets à la base de données de production, sélectionnez l’option « Configurer SQL Server pour les services d’application » et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="e48f3-192">Because we want to add these objects to the production database, select the "Configure SQL Server for application services" option and click Next.</span></span>


<span data-ttu-id="e48f3-193">[![Choisissez de configurer SQL Server pour les Services d’Application](configuring-a-website-that-uses-application-services-vb/_static/image2.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="e48f3-193">[![Choose to Configure SQL Server for Application Services](configuring-a-website-that-uses-application-services-vb/_static/image2.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image1.jpg)</span></span>

<span data-ttu-id="e48f3-194">**Figure 1**: Choisir de configurer SQL Server pour les Services d’Application ([cliquez pour afficher l’image en taille réelle](configuring-a-website-that-uses-application-services-vb/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="e48f3-194">**Figure 1**: Choose to Configure SQL Server for Application Services ([Click to view full-size image](configuring-a-website-that-uses-application-services-vb/_static/image3.jpg))</span></span>


<span data-ttu-id="e48f3-195">« Sélectionnez le serveur et base de données » invites pour plus d’informations pour vous connecter à la base de données.</span><span class="sxs-lookup"><span data-stu-id="e48f3-195">In "Select the Server and Database" screen prompts for information to connect to the database.</span></span> <span data-ttu-id="e48f3-196">Entrez le nom de la base de données fournie par votre société d’hébergement web, le serveur de base de données et les informations d’identification de sécurité et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="e48f3-196">Enter the database server, the security credentials, and the database name supplied to you by your web hosting company and click Next.</span></span>

> [!NOTE]
> <span data-ttu-id="e48f3-197">Après avoir entré votre serveur de base de données et les informations d’identification, vous pouvez obtenir une erreur lors du développement de la liste déroulante de base de données.</span><span class="sxs-lookup"><span data-stu-id="e48f3-197">After entering your database server and credentials you may get an error when expanding the database drop-down list.</span></span> <span data-ttu-id="e48f3-198">Le `aspnet_regsql.exe` outil requêtes le `sysdatabases` (table système) pour récupérer une liste de bases de données sur le serveur, mais certains web hébergeant les verrouiller de sociétés de leurs serveurs de base de données afin que ces informations ne sont pas disponibles publiquement.</span><span class="sxs-lookup"><span data-stu-id="e48f3-198">The `aspnet_regsql.exe` tool queries the `sysdatabases` system table to retrieve a list of databases on the server, but some web hosting companies lock down their database servers so that this information is not publicly available.</span></span> <span data-ttu-id="e48f3-199">Si vous obtenez cette erreur, vous pouvez taper le nom de la base de données directement dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="e48f3-199">If you get this error you can type the database name directly into the drop-down list.</span></span>


<span data-ttu-id="e48f3-200">[![Fournir l’outil avec vos informations de connexion de base de données s](configuring-a-website-that-uses-application-services-vb/_static/image5.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="e48f3-200">[![Supply the Tool With Your Database s Connection Information](configuring-a-website-that-uses-application-services-vb/_static/image5.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image4.jpg)</span></span>

<span data-ttu-id="e48f3-201">**Figure 2**: Fournir les informations de connexion de s avec votre base de l’outil ([cliquez pour afficher l’image en taille réelle](configuring-a-website-that-uses-application-services-vb/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="e48f3-201">**Figure 2**: Supply the Tool With Your Database s Connection Information ([Click to view full-size image](configuring-a-website-that-uses-application-services-vb/_static/image6.jpg))</span></span>


<span data-ttu-id="e48f3-202">L’écran suivant récapitule les actions qui doivent avoir lieu, à savoir ce qui les objets de base de données d’application services vont être ajoutés à la base de données spécifié.</span><span class="sxs-lookup"><span data-stu-id="e48f3-202">The subsequent screen summarizes the actions that are about to take place, namely that the application services database objects are going to be added to the specified database.</span></span> <span data-ttu-id="e48f3-203">Cliquez sur Suivant pour terminer cette action.</span><span class="sxs-lookup"><span data-stu-id="e48f3-203">Click Next to complete this action.</span></span> <span data-ttu-id="e48f3-204">Après quelques instants, le dernier écran s’affiche, en notant que les objets de base de données ont été ajoutés (voir Figure 3).</span><span class="sxs-lookup"><span data-stu-id="e48f3-204">After a few moments, the final screen is displayed, noting that the database objects have been added (see Figure 3).</span></span>


<span data-ttu-id="e48f3-205">[![Succès ! Les objets de base de données d’Application Services ont été ajoutés à la base de données de Production](configuring-a-website-that-uses-application-services-vb/_static/image8.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="e48f3-205">[![Success! The Application Services Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-vb/_static/image8.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image7.jpg)</span></span>

<span data-ttu-id="e48f3-206">**Figure 3**: Opération réussie</span><span class="sxs-lookup"><span data-stu-id="e48f3-206">**Figure 3**: Success!</span></span> <span data-ttu-id="e48f3-207">L’Application Services base de données objets ont été ajoutés à la base de données de Production ([cliquez pour afficher l’image en taille réelle](configuring-a-website-that-uses-application-services-vb/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="e48f3-207">The Application Services Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-vb/_static/image9.jpg))</span></span>


<span data-ttu-id="e48f3-208">Pour vérifier que les objets de base de données d’application services ont été ajoutés à la base de données de production, ouvrez SQL Server Management Studio et connectez-vous à votre base de données de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-208">To verify that the application services database objects were successfully added to the production database, open SQL Server Management Studio and connect to your production database.</span></span> <span data-ttu-id="e48f3-209">Comme le montre la Figure 4, vous devez maintenant voir les tables de base de données d’application services dans votre base de données, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="e48f3-209">As Figure 4 shows, you should now see the application services database tables in your database, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, and so forth.</span></span>


<span data-ttu-id="e48f3-210">[![Vérifier que les objets de base de données ont été ajoutés à la base de données de Production](configuring-a-website-that-uses-application-services-vb/_static/image11.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image10.jpg)</span><span class="sxs-lookup"><span data-stu-id="e48f3-210">[![Confirm That the Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-vb/_static/image11.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image10.jpg)</span></span>

<span data-ttu-id="e48f3-211">**Figure 4**: Vérifier que les objets de base de données ont été ajoutés à la base de données de Production ([cliquez pour afficher l’image en taille réelle](configuring-a-website-that-uses-application-services-vb/_static/image12.jpg))</span><span class="sxs-lookup"><span data-stu-id="e48f3-211">**Figure 4**: Confirm That the Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-vb/_static/image12.jpg))</span></span>


<span data-ttu-id="e48f3-212">Il vous suffit d’utiliser le `aspnet_regsql.exe` outil lors du déploiement de votre application web pour la première fois ou pour la première fois après avoir démarré à l’aide des services d’application.</span><span class="sxs-lookup"><span data-stu-id="e48f3-212">You will only need to use the `aspnet_regsql.exe` tool when deploying your web application for the first time or for the first time after you have started using the application services.</span></span> <span data-ttu-id="e48f3-213">Une fois ces objets de base de données sur la base de données de production qu’ils ne doivent pas être ajouté de nouveau ou modifié.</span><span class="sxs-lookup"><span data-stu-id="e48f3-213">Once these database objects are on the production database they won't need to be re-added or modified.</span></span>

### <a name="copying-user-accounts-from-development-to-production"></a><span data-ttu-id="e48f3-214">Copie des comptes d’utilisateur à partir de développement en Production</span><span class="sxs-lookup"><span data-stu-id="e48f3-214">Copying User Accounts from Development to Production</span></span>

<span data-ttu-id="e48f3-215">Lorsque vous utilisez le `SqlMembershipProvider` et `SqlRoleProvider` des classes de fournisseur pour stocker les informations de services d’application dans une base de données SQL Server, les informations de compte et le rôle utilisateur sont stockées dans une variété de tables de base de données, y compris `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, et `aspnet_UsersInRoles`, entre autres.</span><span class="sxs-lookup"><span data-stu-id="e48f3-215">When using the `SqlMembershipProvider` and `SqlRoleProvider` provider classes to store the application services information in a SQL Server database, the user account and role information is stored in a variety of database tables, including `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, and `aspnet_UsersInRoles`, among others.</span></span> <span data-ttu-id="e48f3-216">Si au cours du développement, vous créez des comptes d’utilisateur dans l’environnement de développement, vous pouvez répliquer ces comptes d’utilisateurs en production en copiant les enregistrements correspondants à partir des tables de base de données applicable.</span><span class="sxs-lookup"><span data-stu-id="e48f3-216">If during development you create user accounts in the development environment you can replicate those user accounts in production by copying the corresponding records from the applicable database tables.</span></span> <span data-ttu-id="e48f3-217">Si vous avez utilisé l’Assistant Publication de base de données pour déployer les objets de base de données de services application que vous pourrez également ont choisi de copier les enregistrements, ce qui entraîneraient les comptes d’utilisateur créés dans le développement pour également être mise en production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-217">If you used the Database Publishing Wizard to deploy the application services database objects you may have also elected to copy the records, which would result in the user accounts created in development to also be on production.</span></span> <span data-ttu-id="e48f3-218">Mais, en fonction de vos paramètres de configuration, vous découvrez que les utilisateurs dont les comptes ont été créés dans le développement et copiés en production ne parvenez pas à se connecter depuis le site Web de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-218">But, depending on your configuration settings, you may find that those users whose accounts were created in development and copied to production are unable to login from the production website.</span></span> <span data-ttu-id="e48f3-219">Ce qui donne ?</span><span class="sxs-lookup"><span data-stu-id="e48f3-219">What gives?</span></span>

<span data-ttu-id="e48f3-220">Le `SqlMembershipProvider` et `SqlRoleProvider` classes de fournisseur ont été conçus pour une base de données unique peut servir un magasin d’utilisateurs pour doivent de plusieurs applications, où chaque application peut, en théorie, les utilisateurs avec des noms d’utilisateur qui se chevauchent et les rôles portant le même nom.</span><span class="sxs-lookup"><span data-stu-id="e48f3-220">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes were designed such that a single database could serve as a user store for multiple applications, where each application could, in theory, have users with overlapping usernames and roles with the same name.</span></span> <span data-ttu-id="e48f3-221">Pour permettre cette flexibilité, la base de données gère une liste d’applications dans le `aspnet_Applications` table et chaque utilisateur est associé à un de ces applications.</span><span class="sxs-lookup"><span data-stu-id="e48f3-221">To allow for this flexibility, the database maintains a list of applications in the `aspnet_Applications` table, and each user is associated with one of these applications.</span></span> <span data-ttu-id="e48f3-222">Plus précisément, le `aspnet_Users` table a un `ApplicationId` colonne qui lie chaque utilisateur à un enregistrement dans le `aspnet_Applications` table.</span><span class="sxs-lookup"><span data-stu-id="e48f3-222">Specifically, the `aspnet_Users` table has an `ApplicationId` column that ties each user to a record in the `aspnet_Applications` table.</span></span>

<span data-ttu-id="e48f3-223">Outre le `ApplicationId` colonne, le `aspnet_Applications` table inclut également un `ApplicationName` colonne, qui fournit un nom plus convivial pour l’application.</span><span class="sxs-lookup"><span data-stu-id="e48f3-223">In addition to the `ApplicationId` column, the `aspnet_Applications` table also includes an `ApplicationName` column, which provides a more human-friendly name for the application.</span></span> <span data-ttu-id="e48f3-224">Lorsqu’un site Web tente de travailler avec un compte d’utilisateur, telles que la validation d’informations d’identification utilisateur s à partir de la page de connexion, il doit indiquer la `SqlMembershipProvider` classe application à utiliser.</span><span class="sxs-lookup"><span data-stu-id="e48f3-224">When a website attempts to work with a user account, such as validating a user s credentials from the login page, it must tell the `SqlMembershipProvider` class what application to work with.</span></span> <span data-ttu-id="e48f3-225">Il généralement effectue cela en fournissant le nom de l’application et cette valeur provient de la configuration du fournisseur s dans `Web.config` , en particulier via la `applicationName` attribut.</span><span class="sxs-lookup"><span data-stu-id="e48f3-225">It usually does this by supplying the application name, and the this value comes from the provider s configuration in `Web.config` - specifically via the `applicationName` attribute.</span></span>

<span data-ttu-id="e48f3-226">Mais que se passe-t-il si le `applicationName` attribut n’est pas spécifié dans `Web.config`?</span><span class="sxs-lookup"><span data-stu-id="e48f3-226">But what happens if the `applicationName` attribute is not specified in `Web.config`?</span></span> <span data-ttu-id="e48f3-227">Dans ce cas l’appartenance au système utilise le chemin d’accès racine en tant que le `applicationName` valeur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-227">In such a case the Membership system uses the application root path as the `applicationName` value.</span></span> <span data-ttu-id="e48f3-228">Si le `applicationName` attribut n’est pas explicitement défini `Web.config`, puis, il existe un risque que l’environnement de développement et l’environnement de production utilisent une racine d’application différents et par conséquent à associer à une autre application noms dans les services d’application.</span><span class="sxs-lookup"><span data-stu-id="e48f3-228">If the `applicationName` attribute is not explicitly set in `Web.config`, then, there is the possibility that the development environment and production environment use a different application root and therefore will be associated with different application names in the application services.</span></span> <span data-ttu-id="e48f3-229">Si une telle non-correspondance se produit ensuite ces utilisateurs créés dans l’environnement de développement aura une `ApplicationId` valeur ne correspond pas à la `ApplicationId` valeur pour l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-229">If such a mismatch occurs then those users created in the development environment will have an `ApplicationId` value that does not match with the `ApplicationId` value for the production environment.</span></span> <span data-ttu-id="e48f3-230">Le résultat net est que ces utilisateurs ne pourront pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="e48f3-230">The net result is that those users won't be able to login.</span></span>

> [!NOTE]
> <span data-ttu-id="e48f3-231">Si vous vous trouvez dans cette situation - comptes d’utilisateur copié en production avec un incompatibles `ApplicationId` valeur - vous pouvez écrire une requête pour mettre à jour ces incorrect `ApplicationId` valeurs à la `ApplicationId` utilisé sur la production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-231">If you find yourself in this situation - with user accounts copied to production with a mismatched `ApplicationId` value - you could write a query to update these incorrect `ApplicationId` values to the `ApplicationId` used on production.</span></span> <span data-ttu-id="e48f3-232">Une fois la mise à jour, les utilisateurs dont les comptes ont été créés sur l’environnement de développement seraient maintenant être en mesure de se connecter à l’application web sur la production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-232">Once updated, the users whose accounts were created on the development environment would now be able to sign into the web application on production.</span></span>


<span data-ttu-id="e48f3-233">La bonne nouvelle est qu’il existe une étape simple, vous pouvez prendre pour vous assurer que les deux environnements utilisent les mêmes `ApplicationId` - définissez explicitement le `applicationName` d’attribut dans `Web.config` pour l’ensemble de vos fournisseurs de services d’application.</span><span class="sxs-lookup"><span data-stu-id="e48f3-233">The good news is that there is a simple step you can take to ensure that the two environments use the same `ApplicationId` - explicitly set the `applicationName` attribute in `Web.config` for all of your application services providers.</span></span> <span data-ttu-id="e48f3-234">Définir explicitement la `applicationName` attribut « BookReviews » dans le `<membership>` et `<roleManager>` éléments en tant que cet extrait de code à partir de `Web.config` montre.</span><span class="sxs-lookup"><span data-stu-id="e48f3-234">I explicitly set the `applicationName` attribute to "BookReviews" in the `<membership>` and `<roleManager>` elements as this snippet from `Web.config` shows.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-vb/samples/sample4.xml)]

<span data-ttu-id="e48f3-235">Pour plus d’informations sur la configuration de la `applicationName` attribut et le raisonnement derrière lui, reportez-vous à [ *Scott Guthrie* ](https://weblogs.asp.net/scottgu/) billet de blog de s, [ *toujours défini applicationName propriété lors de la configuration de l’appartenance d’ASP.NET et d’autres fournisseurs*](https://weblogs.asp.net/scottgu/443634).</span><span class="sxs-lookup"><span data-stu-id="e48f3-235">For more discussion on setting the `applicationName` attribute and the rationale behind it, refer to [*Scott Guthrie*](https://weblogs.asp.net/scottgu/) s blog post, [*Always set the applicationName property when configuring ASP.NET Membership and other Providers*](https://weblogs.asp.net/scottgu/443634).</span></span>

### <a name="managing-user-accounts-in-the-production-environment"></a><span data-ttu-id="e48f3-236">La gestion des comptes d’utilisateur dans l’environnement de Production</span><span class="sxs-lookup"><span data-stu-id="e48f3-236">Managing User Accounts in the Production Environment</span></span>

<span data-ttu-id="e48f3-237">L’outil d’Administration de Microsoft ASP.NET Web Site (WSAT) rend plus facile créer et gérer des comptes d’utilisateurs, définir et appliquer des rôles et épeler utilisateur - et en fonction du rôle des règles d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="e48f3-237">The ASP.NET Web Site Administration Tool (WSAT) makes it easy to create and manage user accounts, define and apply roles, and spell out user- and role-based authorization rules.</span></span> <span data-ttu-id="e48f3-238">Vous pouvez lancer le WSAT à partir de Visual Studio en accédant à l’Explorateur de solutions et en cliquant sur l’icône de Configuration ASP.NET ou en sélectionnant les menus de site Web ou un projet et en sélectionnant l’élément de menu de Configuration ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e48f3-238">You can launch the WSAT from Visual Studio by going to the Solution Explorer and clicking the ASP.NET Configuration icon or by going to the Website or Project menus and selecting the ASP.NET Configuration menu item.</span></span> <span data-ttu-id="e48f3-239">Malheureusement, le WSAT ne peut fonctionner avec les sites Web locales.</span><span class="sxs-lookup"><span data-stu-id="e48f3-239">Unfortunately, the WSAT can only work with local websites.</span></span> <span data-ttu-id="e48f3-240">Par conséquent, vous ne pouvez pas utiliser le WSAT à partir de votre station de travail pour gérer le site Web dans l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-240">Therefore, you cannot use the WSAT from your workstation to manage the website in the production environment.</span></span>

<span data-ttu-id="e48f3-241">La bonne nouvelle est que toutes les fonctionnalités exposées fournies par le WSAT sont disponibles par programmation via l’appartenance et l’API de rôles ; en outre, la plupart des écrans WSAT utilisent les contrôles standards ASP.NET-associées à la connexion.</span><span class="sxs-lookup"><span data-stu-id="e48f3-241">The good news is that all of the functionality exposed provided by the WSAT is available programmatically through the Membership and Roles APIs; furthermore, many of the WSAT screens use the standard ASP.NET Login-related controls.</span></span> <span data-ttu-id="e48f3-242">En bref, vous pouvez ajouter des pages ASP.NET à votre site Web qui offrent les fonctionnalités de gestion nécessaires.</span><span class="sxs-lookup"><span data-stu-id="e48f3-242">In short, you can add ASP.NET pages to your website that offer the necessary management capabilities.</span></span>

<span data-ttu-id="e48f3-243">Rappelez-vous qu’un tutoriel précédent mis à jour l’application web de critiques de livres d’inclure un `~/Admin` dossier et que ce dossier a été configuré pour autoriser uniquement les utilisateurs dans le rôle d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-243">Recall that an earlier tutorial updated the Book Reviews web application to include an `~/Admin` folder, and this folder has been configured to only allow users in the Admin role.</span></span> <span data-ttu-id="e48f3-244">J’ai ajouté une page dans ce dossier nommé `CreateAccount.aspx` à partir de laquelle un administrateur peut créer un nouveau compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-244">I added a page to that folder named `CreateAccount.aspx` from which an administrator can create a new user account.</span></span> <span data-ttu-id="e48f3-245">Cette page utilise le contrôle CreateUserWizard pour afficher la logique utilisateur de l’interface et le serveur principal pour la création d’un nouveau compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e48f3-245">This page uses the CreateUserWizard control to display the user interface and backend logic for creating a new user account.</span></span> <span data-ttu-id="e48f3-246">Nouveautés plus, j’ai personnalisé le contrôle afin d’inclure une case à cocher qui vous demande si le nouvel utilisateur doit également être ajouté au rôle d’administrateur (voir Figure 5).</span><span class="sxs-lookup"><span data-stu-id="e48f3-246">What s more, I customized the control to include a CheckBox that prompts whether the new user should also be added to the Admin role (see Figure 5).</span></span> <span data-ttu-id="e48f3-247">Avec un peu de travail, vous pouvez créer un jeu personnalisé de pages qui implémente les tâches liées à la gestion de rôles et des utilisateurs qui seraient sinon fournies par le WSAT.</span><span class="sxs-lookup"><span data-stu-id="e48f3-247">With a little bit of work you can build a custom set of pages that implements the user and role management-related tasks that would otherwise be provided by the WSAT.</span></span>

> [!NOTE]
> <span data-ttu-id="e48f3-248">Pour plus d’informations sur l’utilisation de l’appartenance et l’API de rôles, ainsi que les contrôles Web de ASP.NET associées à la connexion, veillez à lire mon [ *didacticiels de sécurité de site Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="e48f3-248">For more information on using the Membership and Roles APIs along with the Login-related ASP.NET Web controls, be sure to read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span> <span data-ttu-id="e48f3-249">Pour plus d’informations sur la personnalisation du contrôle CreateUserWizard, consultez le [ *création de comptes utilisateur* ](../../older-versions-security/membership/creating-user-accounts-vb.md) et [ *stockant des informations utilisateur supplémentaires* ](../../older-versions-security/membership/storing-additional-user-information-vb.md) didacticiels ou extraction [ *Erich Peterson* ](http://www.erichpeterson.com/) article s, [ *personnalisation du contrôle CreateUserWizard* ](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="e48f3-249">For more on customizing the CreateUserWizard control refer to the [*Creating User Accounts*](../../older-versions-security/membership/creating-user-accounts-vb.md) and [*Storing Additional User Information*](../../older-versions-security/membership/storing-additional-user-information-vb.md) tutorials, or check out [*Erich Peterson*](http://www.erichpeterson.com/) s article, [*Customizing the CreateUserWizard Control*](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span></span>


<span data-ttu-id="e48f3-250">[![Les administrateurs peuvent créer de nouveaux comptes d’utilisateur](configuring-a-website-that-uses-application-services-vb/_static/image14.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image13.jpg)</span><span class="sxs-lookup"><span data-stu-id="e48f3-250">[![Administrators Can Create New User Accounts](configuring-a-website-that-uses-application-services-vb/_static/image14.jpg)](configuring-a-website-that-uses-application-services-vb/_static/image13.jpg)</span></span>

<span data-ttu-id="e48f3-251">**Figure 5**: Les administrateurs peuvent créer des comptes d’utilisateur ([cliquez pour afficher l’image en taille réelle](configuring-a-website-that-uses-application-services-vb/_static/image15.jpg))</span><span class="sxs-lookup"><span data-stu-id="e48f3-251">**Figure 5**: Administrators Can Create New User Accounts ([Click to view full-size image](configuring-a-website-that-uses-application-services-vb/_static/image15.jpg))</span></span>


<span data-ttu-id="e48f3-252">Si vous avez besoin de toutes les fonctionnalités de l’extraction WSAT [ *propagée votre propre Site Web Administration outil*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), dans lequel l’auteur Dan Clem vous explique le processus de création d’un outil WSAT de type personnalisé.</span><span class="sxs-lookup"><span data-stu-id="e48f3-252">If you need the full functionality of the WSAT check out [*Rolling Your Own Web Site Administration Tool*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), in which author Dan Clem walks through the process of building a custom WSAT-like tool.</span></span> <span data-ttu-id="e48f3-253">Dan partage son code source d’application s (en c#) et fournit des instructions détaillées pour l’ajouter à votre site Web hébergé.</span><span class="sxs-lookup"><span data-stu-id="e48f3-253">Dan shares his application s source code (in C#) and provides step-by-step instructions for adding it to your hosted website.</span></span>

## <a name="summary"></a><span data-ttu-id="e48f3-254">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="e48f3-254">Summary</span></span>

<span data-ttu-id="e48f3-255">Lorsque vous déployez une application web qui utilise l’implémentation de base de données de services application vous devez vous assurer que la base de données de production dispose les objets de base de données requis.</span><span class="sxs-lookup"><span data-stu-id="e48f3-255">When deploying a web application that uses the application services database implementation you must first ensure that the production database has the requisite database objects.</span></span> <span data-ttu-id="e48f3-256">Ces objets peuvent être ajoutés à l’aide de techniques abordées dans le *déploiement d’une base de données* didacticiel ; vous pouvez également utiliser le `aspnet_regsql.exe` outil, comme nous l’avons vu dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="e48f3-256">These objects can be added using the techniques discussed in the *Deploying a Database* tutorial; alternatively, you can use the `aspnet_regsql.exe` tool, as we saw in this tutorial.</span></span> <span data-ttu-id="e48f3-257">Autres défis dont nous avons parlé sur se concentrent autour de la synchronisation du nom d’application utilisé dans les environnements de développement et de production (ce qui est important si vous souhaitez que les utilisateurs et rôles créés dans l’environnement de développement soit valide sur la production) et les techniques de la gestion des utilisateurs et des rôles dans l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="e48f3-257">Other challenges we touched on center around synchronizing the application name used in the development and production environments (which is important if you want users and roles created in the development environment to be valid on production) and techniques for managing the users and roles in the production environment.</span></span>

<span data-ttu-id="e48f3-258">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="e48f3-258">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="e48f3-259">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="e48f3-259">Further Reading</span></span>

<span data-ttu-id="e48f3-260">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="e48f3-260">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e48f3-261">*ASP.NET SQL Server Registration Tool (aspnet_regsql.exe)*</span><span class="sxs-lookup"><span data-stu-id="e48f3-261">*ASP.NET SQL Server Registration Tool (aspnet_regsql.exe)*</span></span>](https://msdn.microsoft.com/library/ms229862.aspx)
- [<span data-ttu-id="e48f3-262">*Création de la base de données de Services d’Application pour SQL Server*</span><span class="sxs-lookup"><span data-stu-id="e48f3-262">*Creating the Application Services Database for SQL Server*</span></span>](https://msdn.microsoft.com/library/x28wfk74.aspx)
- [<span data-ttu-id="e48f3-263">*Création du schéma d’appartenance dans SQL Server*</span><span class="sxs-lookup"><span data-stu-id="e48f3-263">*Creating the Membership Schema in SQL Server*</span></span>](../../older-versions-security/membership/creating-the-membership-schema-in-sql-server-vb.md)
- [<span data-ttu-id="e48f3-264">*Examen de l’appartenance ASP.NET s, les rôles et profil*</span><span class="sxs-lookup"><span data-stu-id="e48f3-264">*Examining ASP.NET s Membership, Roles, and Profile*</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="e48f3-265">*Déploiement de votre propre outil d’Administration de Site Web*</span><span class="sxs-lookup"><span data-stu-id="e48f3-265">*Rolling Your Own Web Site Administration Tool*</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="e48f3-266">*Didacticiels de sécurité de site Web*</span><span class="sxs-lookup"><span data-stu-id="e48f3-266">*Website Security Tutorials*</span></span>](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)
- [<span data-ttu-id="e48f3-267">*Présentation de l’outil Administration Site Web*</span><span class="sxs-lookup"><span data-stu-id="e48f3-267">*Web Site Administration Tool Overview*</span></span>](https://msdn.microsoft.com/library/yy40ytx0.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="e48f3-268">[Précédent](configuring-the-production-web-application-to-use-the-production-database-vb.md)
> [Suivant](strategies-for-database-development-and-deployment-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e48f3-268">[Previous](configuring-the-production-web-application-to-use-the-production-database-vb.md)
[Next](strategies-for-database-development-and-deployment-vb.md)</span></span>
