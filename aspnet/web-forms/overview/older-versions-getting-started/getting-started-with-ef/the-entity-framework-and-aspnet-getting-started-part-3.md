---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
title: Bien démarrer avec Entity Framework 4.0 Database First et 4 d’ASP.NET Web Forms - partie 3 | Microsoft Docs
author: tdykstra
description: L’exemple d’application web Contoso University montre comment créer des applications Web Forms ASP.NET à l’aide d’Entity Framework. L’exemple d’application est en cours...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: ccdc3f8c-2568-40a7-8f8b-3c23d2e05388
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
msc.type: authoredcontent
ms.openlocfilehash: 162f93c0249d8fa11d67ea10c68bc2ca8bae7259
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57045556"
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-3"></a><span data-ttu-id="d3ea8-104">Bien démarrer avec Entity Framework 4.0 Database First et 4 les Web Forms ASP.NET - partie 3</span><span class="sxs-lookup"><span data-stu-id="d3ea8-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 3</span></span>
====================
<span data-ttu-id="d3ea8-105">par [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="d3ea8-106">L’exemple d’application web Contoso University montre comment créer des applications Web Forms ASP.NET à l’aide de l’Entity Framework 4.0 et Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="d3ea8-107">Pour plus d’informations sur la série de didacticiels, consultez [le premier didacticiel de la série](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="filtering-ordering-and-grouping-data"></a><span data-ttu-id="d3ea8-108">Tri, regroupement et filtrage des données</span><span class="sxs-lookup"><span data-stu-id="d3ea8-108">Filtering, Ordering, and Grouping Data</span></span>

<span data-ttu-id="d3ea8-109">Dans le didacticiel précédent, vous avez utilisé le `EntityDataSource` contrôle pour afficher et modifier des données.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-109">In the previous tutorial you used the `EntityDataSource` control to display and edit data.</span></span> <span data-ttu-id="d3ea8-110">Dans ce didacticiel, vous allez filtrer, classer et regrouper des données.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-110">In this tutorial you'll filter, order, and group data.</span></span> <span data-ttu-id="d3ea8-111">Quand vous procédez ainsi en définissant des propriétés de la `EntityDataSource` contrôle, la syntaxe est différente des autres contrôles de source de données.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-111">When you do this by setting properties of the `EntityDataSource` control, the syntax is different from other data source controls.</span></span> <span data-ttu-id="d3ea8-112">Comme vous le verrez, cependant, vous pouvez utiliser la `QueryExtender` contrôle afin de réduire ces différences.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-112">As you'll see, however, you can use the `QueryExtender` control to minimize these differences.</span></span>

<span data-ttu-id="d3ea8-113">Vous allez modifier le *Students.aspx* page pour filtrer pour les étudiants, triez par nom et la recherche de nom.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-113">You'll change the *Students.aspx* page to filter for students, sort by name, and search on name.</span></span> <span data-ttu-id="d3ea8-114">Vous devez également modifier le *Courses.aspx* page pour afficher les cours pour le département sélectionné et la recherche pour les cours par nom.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-114">You'll also change the *Courses.aspx* page to display courses for the selected department and search for courses by name.</span></span> <span data-ttu-id="d3ea8-115">Enfin, vous allez ajouter les statistiques des étudiants pour le *About.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-115">Finally, you'll add student statistics to the *About.aspx* page.</span></span>

<span data-ttu-id="d3ea8-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span></span>

<span data-ttu-id="d3ea8-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span></span>

<span data-ttu-id="d3ea8-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span></span>

<span data-ttu-id="d3ea8-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span></span>

## <a name="using-the-entitydatasource-where-property-to-filter-data"></a><span data-ttu-id="d3ea8-120">À l’aide de la EntityDataSource « Where » propriété pour filtrer les données</span><span class="sxs-lookup"><span data-stu-id="d3ea8-120">Using the EntityDataSource "Where" Property to Filter Data</span></span>

<span data-ttu-id="d3ea8-121">Ouvrez le *Students.aspx* page que vous avez créé dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-121">Open the *Students.aspx* page that you created in the previous tutorial.</span></span> <span data-ttu-id="d3ea8-122">Selon la configuration actuelle, le `GridView` contrôle dans la page affiche tous les noms à partir de la `People` jeu d’entités.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-122">As currently configured, the `GridView` control in the page displays all the names from the `People` entity set.</span></span> <span data-ttu-id="d3ea8-123">Toutefois, vous souhaitez afficher uniquement les étudiants, que vous pouvez trouver en sélectionnant `Person` entités ayant des dates d’inscription non null.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-123">However, you want to show only students, which you can find by selecting `Person` entities that have non-null enrollment dates.</span></span>

<span data-ttu-id="d3ea8-124">Basculez vers **conception** afficher, puis sélectionnez le `EntityDataSource` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-124">Switch to **Design** view and select the `EntityDataSource` control.</span></span> <span data-ttu-id="d3ea8-125">Dans la fenêtre **Propriétés** , définissez la propriété `Where` sur `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-125">In the **Properties** window, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>

<span data-ttu-id="d3ea8-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span></span>

<span data-ttu-id="d3ea8-127">La syntaxe à utiliser dans le `Where` propriété de la `EntityDataSource` contrôle est Entity SQL.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-127">The syntax you use in the `Where` property of the `EntityDataSource` control is Entity SQL.</span></span> <span data-ttu-id="d3ea8-128">Entity SQL est similaire à Transact-SQL, mais il est personnalisé pour une utilisation avec les entités plutôt que des objets de base de données.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-128">Entity SQL is similar to Transact-SQL, but it's customized for use with entities rather than database objects.</span></span> <span data-ttu-id="d3ea8-129">Dans l’expression `it.EnrollmentDate is not null`, le mot `it` représente une référence à l’entité retournée par la requête.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-129">In the expression `it.EnrollmentDate is not null`, the word `it` represents a reference to the entity returned by the query.</span></span> <span data-ttu-id="d3ea8-130">Par conséquent, `it.EnrollmentDate` fait référence à la `EnrollmentDate` propriété de la `Person` entité qui le `EntityDataSource` contrôler retourne.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-130">Therefore, `it.EnrollmentDate` refers to the `EnrollmentDate` property of the `Person` entity that the `EntityDataSource` control returns.</span></span>

<span data-ttu-id="d3ea8-131">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-131">Run the page.</span></span> <span data-ttu-id="d3ea8-132">La liste des étudiants contient désormais uniquement les étudiants.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-132">The students list now contains only students.</span></span> <span data-ttu-id="d3ea8-133">(Aucune ligne affiché où il n’existe aucune date d’inscription.)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-133">(There are no rows displayed where there's no enrollment date.)</span></span>

<span data-ttu-id="d3ea8-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span></span>

## <a name="using-the-entitydatasource-orderby-property-to-order-data"></a><span data-ttu-id="d3ea8-135">À l’aide de la propriété « OrderBy » EntityDataSource aux données de commande</span><span class="sxs-lookup"><span data-stu-id="d3ea8-135">Using the EntityDataSource "OrderBy" Property to Order Data</span></span>

<span data-ttu-id="d3ea8-136">Vous souhaitez également cette liste pour être dans l’ordre de nom lorsqu’il est tout d’abord affiché.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-136">You also want this list to be in name order when it's first displayed.</span></span> <span data-ttu-id="d3ea8-137">Avec le *Students.aspx* page toujours ouverte dans **conception** vue et avec le `EntityDataSource` contrôle toujours sélectionné, dans le **propriétés** fenêtre, définissez la  **OrderBy** propriété `it.LastName`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-137">With the *Students.aspx* page still open in **Design** view, and with the `EntityDataSource` control still selected, in the **Properties** window set the **OrderBy** property to `it.LastName`.</span></span>

<span data-ttu-id="d3ea8-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span></span>

<span data-ttu-id="d3ea8-139">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-139">Run the page.</span></span> <span data-ttu-id="d3ea8-140">La liste des étudiants est désormais dans l’ordre par nom de famille.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-140">The students list is now in order by last name.</span></span>

<span data-ttu-id="d3ea8-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span></span>

## <a name="using-a-control-parameter-to-set-the-where-property"></a><span data-ttu-id="d3ea8-142">À l’aide d’un paramètre de contrôle pour définir la propriété « Where »</span><span class="sxs-lookup"><span data-stu-id="d3ea8-142">Using a Control Parameter to Set the "Where" Property</span></span>

<span data-ttu-id="d3ea8-143">Comme avec d’autres contrôles de source de données, vous pouvez passer des valeurs de paramètre à la `Where` propriété.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-143">As with other data source controls, you can pass parameter values to the `Where` property.</span></span> <span data-ttu-id="d3ea8-144">Sur le *Courses.aspx* page que vous avez créé dans la partie 2 du didacticiel, vous pouvez utiliser cette méthode pour afficher les cours qui sont associés au service un utilisateur sélectionne dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-144">On the *Courses.aspx* page that you created in part 2 of the tutorial, you can use this method to display courses that are associated with the department that a user selects from the drop-down list.</span></span>

<span data-ttu-id="d3ea8-145">Ouvrez *Courses.aspx* et basculez vers **conception** vue.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-145">Open *Courses.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="d3ea8-146">Ajoutez une deuxième `EntityDataSource` le contrôle à la page et nommez-le `CoursesEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-146">Add a second `EntityDataSource` control to the page, and name it `CoursesEntityDataSource`.</span></span> <span data-ttu-id="d3ea8-147">Se connecter à la `SchoolEntities` de modèle, puis sélectionnez `Courses` en tant que le **EntitySetName** valeur.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-147">Connect it to the `SchoolEntities` model, and select `Courses` as the **EntitySetName** value.</span></span>

<span data-ttu-id="d3ea8-148">Dans le **propriétés** fenêtre, cliquez sur le bouton de sélection dans le **où** zone de propriété.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-148">In the **Properties** window, click the ellipsis in the **Where** property box.</span></span> <span data-ttu-id="d3ea8-149">(Assurez-vous que le `CoursesEntityDataSource` contrôle est toujours sélectionné avant d’utiliser le **propriétés** fenêtre.)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-149">(Make sure the `CoursesEntityDataSource` control is still selected before using the **Properties** window.)</span></span>

<span data-ttu-id="d3ea8-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span></span>

<span data-ttu-id="d3ea8-151">Le **Éditeur d’Expression** boîte de dialogue s’affiche.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-151">The **Expression Editor** dialog box is displayed.</span></span> <span data-ttu-id="d3ea8-152">Dans cette boîte de dialogue, sélectionnez **générer automatiquement Where expression basée sur les paramètres fournis**, puis cliquez sur **ajouter un paramètre**.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-152">In this dialog box, select **Automatically generate the Where expression based on the provided parameters**, and then click **Add Parameter**.</span></span> <span data-ttu-id="d3ea8-153">Nommez le paramètre `DepartmentID`, sélectionnez **contrôle** en tant que le **source du paramètre** valeur, puis sélectionnez **DepartmentsDropDownList** comme le **ControlID**  valeur.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-153">Name the parameter `DepartmentID`, select **Control** as the **Parameter source** value, and select **DepartmentsDropDownList** as the **ControlID** value.</span></span>

<span data-ttu-id="d3ea8-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span></span>

<span data-ttu-id="d3ea8-155">Cliquez sur **afficher les propriétés avancées**, puis, dans le **propriétés** fenêtre de la **Éditeur d’Expression** boîte de dialogue, choisissez le `Type` propriété `Int32`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-155">Click **Show advanced properties**, and in the **Properties** window of the **Expression Editor** dialog box, change the `Type` property to `Int32`.</span></span>

<span data-ttu-id="d3ea8-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span></span>

<span data-ttu-id="d3ea8-157">Lorsque vous avez terminé, cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-157">When you're done, click **OK**.</span></span>

<span data-ttu-id="d3ea8-158">Sous la liste déroulante, ajoutez un `GridView` le contrôle à la page et nommez-le `CoursesGridView`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-158">Below the drop-down list, add a `GridView` control to the page and name it `CoursesGridView`.</span></span> <span data-ttu-id="d3ea8-159">Se connecter à la `CoursesEntityDataSource` contrôle de source de données cliquez sur **actualiser le schéma**, cliquez sur **modifier les colonnes**et supprimer la `DepartmentID` colonne.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-159">Connect it to the `CoursesEntityDataSource` data source control, click **Refresh Schema**, click **Edit Columns**, and remove the `DepartmentID` column.</span></span> <span data-ttu-id="d3ea8-160">Le `GridView` balisage du contrôle ressemble à l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-160">The `GridView` control markup resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample1.aspx)]

<span data-ttu-id="d3ea8-161">Lorsque l’utilisateur modifie le département sélectionné dans la liste déroulante, vous souhaitez la liste de cours associés à modifier automatiquement.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-161">When the user changes the selected department in the drop-down list, you want the list of associated courses to change automatically.</span></span> <span data-ttu-id="d3ea8-162">Pour permettre cela se produit, sélectionnez la liste déroulante, puis, dans le **propriétés** fenêtre, définissez la `AutoPostBack` propriété `True`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-162">To make this happen, select the drop-down list, and in the **Properties** window set the `AutoPostBack` property to `True`.</span></span>

<span data-ttu-id="d3ea8-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span></span>

<span data-ttu-id="d3ea8-164">Maintenant que vous avez terminé de l’aide du concepteur, basculez vers **Source** Affichez et remplacez le `ConnectionString` et `DefaultContainer` nomment les propriétés de la `CoursesEntityDataSource` contrôler avec le `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribut.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-164">Now that you're finished using the designer, switch to **Source** view and replace the `ConnectionString` and `DefaultContainer` name properties of the `CoursesEntityDataSource` control with the `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="d3ea8-165">Lorsque vous avez terminé, le balisage pour le contrôle se présente comme l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-165">When you're done, the markup for the control will look like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample2.aspx)]

<span data-ttu-id="d3ea8-166">Exécutez la page et utilisez la liste déroulante pour sélectionner les différents services.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-166">Run the page and use the drop-down list to select different departments.</span></span> <span data-ttu-id="d3ea8-167">Seuls les cours proposés par le département sélectionné sont affichent dans le `GridView` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-167">Only courses that are offered by the selected department are displayed in the `GridView` control.</span></span>

<span data-ttu-id="d3ea8-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span></span>

## <a name="using-the-entitydatasource-groupby-property-to-group-data"></a><span data-ttu-id="d3ea8-169">À l’aide de la propriété « GroupBy » EntityDataSource pour regrouper les données</span><span class="sxs-lookup"><span data-stu-id="d3ea8-169">Using the EntityDataSource "GroupBy" Property to Group Data</span></span>

<span data-ttu-id="d3ea8-170">Supposons que Contoso University souhaite placer certaines statistiques de corps de l’étudiant sur sa page About.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-170">Suppose Contoso University wants to put some student-body statistics on its About page.</span></span> <span data-ttu-id="d3ea8-171">Plus précisément, elle souhaite afficher une répartition du nombre d’étudiants par la date de que leur inscription.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-171">Specifically, it wants to show a breakdown of numbers of students by the date they enrolled.</span></span>

<span data-ttu-id="d3ea8-172">Ouvrez *About.aspx*et dans **Source** afficher, remplacez le contenu existant de la `BodyContent` contrôler avec « Statistiques de corps étudiant » entre `h2` balises :</span><span class="sxs-lookup"><span data-stu-id="d3ea8-172">Open *About.aspx*, and in **Source** view, replace the existing contents of the `BodyContent` control with "Student Body Statistics" between `h2` tags:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample3.aspx)]

<span data-ttu-id="d3ea8-173">Après l’en-tête, ajoutez un `EntityDataSource` contrôler et nommez-le `StudentStatisticsEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-173">After the heading, add an `EntityDataSource` control and name it `StudentStatisticsEntityDataSource`.</span></span> <span data-ttu-id="d3ea8-174">Connectez-le à `SchoolEntities`, sélectionnez le `People` entité définie et laissez le **sélectionnez** zone dans l’Assistant inchangé.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-174">Connect it to `SchoolEntities`, select the `People` entity set, and leave the **Select** box in the wizard unchanged.</span></span> <span data-ttu-id="d3ea8-175">Définissez les propriétés suivantes le **propriétés** fenêtre :</span><span class="sxs-lookup"><span data-stu-id="d3ea8-175">Set the following properties in the **Properties** window:</span></span>

- <span data-ttu-id="d3ea8-176">Pour filtrer uniquement pour les étudiants, définissez le `Where` propriété `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-176">To filter for students only, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>
- <span data-ttu-id="d3ea8-177">Pour regrouper les résultats par la date d’inscription, définissez le `GroupBy` propriété `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-177">To group the results by the enrollment date, set the `GroupBy` property to `it.EnrollmentDate`.</span></span>
- <span data-ttu-id="d3ea8-178">Pour sélectionner la date d’inscription et le nombre d’élèves, définissez le `Select` propriété `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-178">To select the enrollment date and the number of students, set the `Select` property to `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span></span>
- <span data-ttu-id="d3ea8-179">Pour trier les résultats par date d’inscription, définissez le `OrderBy` propriété `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-179">To order the results by the enrollment date, set the `OrderBy` property to `it.EnrollmentDate`.</span></span>

<span data-ttu-id="d3ea8-180">Dans **Source** afficher, remplacez le `ConnectionString` et `DefaultContainer` nomment les propriétés avec un `ContextTypeName` propriété.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-180">In **Source** view, replace the `ConnectionString` and `DefaultContainer` name properties with a `ContextTypeName` property.</span></span> <span data-ttu-id="d3ea8-181">Le `EntityDataSource` balisage du contrôle ressemble maintenant à l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-181">The `EntityDataSource` control markup now resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample4.aspx)]

<span data-ttu-id="d3ea8-182">La syntaxe de la `Select`, `GroupBy`, et `Where` propriétés ressemble à Transact-SQL à l’exception de la `it` mot clé qui spécifie l’entité actuelle.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-182">The syntax of the `Select`, `GroupBy`, and `Where` properties resembles Transact-SQL except for the `it` keyword that specifies the current entity.</span></span>

<span data-ttu-id="d3ea8-183">Ajoutez le balisage suivant pour créer un `GridView` contrôle pour afficher les données.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-183">Add the following markup to create a `GridView` control to display the data.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample5.aspx)]

<span data-ttu-id="d3ea8-184">Exécutez la page pour afficher une liste indiquant le nombre d’élèves par date d’inscription.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-184">Run the page to see a list showing the number of students by enrollment date.</span></span>

<span data-ttu-id="d3ea8-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span></span>

## <a name="using-the-queryextender-control-for-filtering-and-ordering"></a><span data-ttu-id="d3ea8-186">À l’aide du contrôle QueryExtender pour le filtrage et tri</span><span class="sxs-lookup"><span data-stu-id="d3ea8-186">Using the QueryExtender Control for Filtering and Ordering</span></span>

<span data-ttu-id="d3ea8-187">Le `QueryExtender` contrôle fournit un moyen de spécifier le filtrage et le tri dans le balisage.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-187">The `QueryExtender` control provides a way to specify filtering and sorting in markup.</span></span> <span data-ttu-id="d3ea8-188">La syntaxe est indépendante du système de gestion de base de données (SGBD) que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-188">The syntax is independent of the database management system (DBMS) you're using.</span></span> <span data-ttu-id="d3ea8-189">Il est également généralement indépendante de l’Entity Framework, avec l’exception que vous utilisez pour les propriétés de navigation de syntaxe est unique à Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-189">It's also generally independent of the Entity Framework, with the exception that syntax you use for navigation properties is unique to the Entity Framework.</span></span>

<span data-ttu-id="d3ea8-190">Dans cette partie du didacticiel, vous allez utiliser un `QueryExtender` contrôle aux données de filtre et ordre et un seul champ order by sera une propriété de navigation.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-190">In this part of the tutorial you'll use a `QueryExtender` control to filter and order data, and one of the order-by fields will be a navigation property.</span></span>

<span data-ttu-id="d3ea8-191">(Si vous préférez utiliser le code au lieu de balisage pour étendre les requêtes qui sont générés automatiquement par le `EntityDataSource` contrôle, vous pouvez le faire gestion de la `QueryCreated` événement.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-191">(If you prefer to use code instead of markup to extend the queries that are automatically generated by the `EntityDataSource` control, you can do that by handling the `QueryCreated` event.</span></span> <span data-ttu-id="d3ea8-192">Voici comment la `QueryExtender` contrôle s’étend `EntityDataSource` contrôle également les requêtes.)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-192">This is how the `QueryExtender` control extends `EntityDataSource` control queries also.)</span></span>

<span data-ttu-id="d3ea8-193">Ouvrez le *Courses.aspx* page et sous le balisage que vous avez ajoutée précédemment, insérez le balisage suivant pour créer un en-tête, une zone de texte permettant d’entrer des chaînes de recherche, un bouton de recherche et un `EntityDataSource` contrôle qui est lié à la `Courses` jeu d’entités.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-193">Open the *Courses.aspx* page, and below the markup you added previously, insert the following markup to create a heading, a text box for entering search strings, a search button, and an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample6.aspx)]

<span data-ttu-id="d3ea8-194">Notez que le `EntityDataSource` du contrôle `Include` propriété est définie sur `Department`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-194">Notice that the `EntityDataSource` control's `Include` property is set to `Department`.</span></span> <span data-ttu-id="d3ea8-195">Dans la base de données, le `Course` table ne contient pas le nom du service ; il contient un `DepartmentID` colonne clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-195">In the database, the `Course` table does not contain the department name; it contains a `DepartmentID` foreign key column.</span></span> <span data-ttu-id="d3ea8-196">Si vous ont été interrogeant directement, la base de données pour obtenir le nom du service, ainsi que les données de cours, vous seriez obligé de joindre le `Course` et `Department` tables.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-196">If you were querying the database directly, to get the department name along with course data, you would have to join the `Course` and `Department` tables.</span></span> <span data-ttu-id="d3ea8-197">En définissant le `Include` propriété `Department`, vous spécifiez que Entity Framework doit effectuer le travail de mise en relation `Department` entité lorsqu’il atteint un `Course` entité.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-197">By setting the `Include` property to `Department`, you specify that the Entity Framework should do the work of getting the related `Department` entity when it gets a `Course` entity.</span></span> <span data-ttu-id="d3ea8-198">Le `Department` entité est ensuite stockée dans le `Department` propriété de navigation de la `Course` entité.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-198">The `Department` entity is then stored in the `Department` navigation property of the `Course` entity.</span></span> <span data-ttu-id="d3ea8-199">(Par défaut, le `SchoolEntities` classe qui a été généré par le Concepteur de modèle de données récupère les données associées lorsque cela est nécessaire, et vous avez lié le contrôle de source de données à cette classe, affectant ainsi la `Include` propriété n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-199">(By default, the `SchoolEntities` class that was generated by the data model designer retrieves related data when it's needed, and you've bound the data source control to that class, so setting the `Include` property is not necessary.</span></span> <span data-ttu-id="d3ea8-200">Toutefois, configurez-la améliore les performances de la page, car sinon Entity Framework rendrait des appels séparés à la base de données pour récupérer des données pour le `Course` entités et pour connexe `Department` entités.)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-200">However, setting it improves performance of the page, because otherwise the Entity Framework would make separate calls to the database to retrieve data for the `Course` entities and for the related `Department` entities.)</span></span>

<span data-ttu-id="d3ea8-201">Après le `EntityDataSource` contrôle que vous avez créé, insérez le balisage suivant pour créer un `QueryExtender` contrôle qui est lié à celui `EntityDataSource` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-201">After the `EntityDataSource` control you just created, insert the following markup to create a `QueryExtender` control that's bound to that `EntityDataSource` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample7.aspx)]

<span data-ttu-id="d3ea8-202">Le `SearchExpression` élément spécifie que vous souhaitez sélectionner des cours dont le titre correspond à la valeur entrée dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-202">The `SearchExpression` element specifies that you want to select courses whose titles match the value entered in the text box.</span></span> <span data-ttu-id="d3ea8-203">Uniquement comme le nombre de caractères sont entrés dans la zone de texte est comparée, car le `SearchType` propriété spécifie `StartsWith`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-203">Only as many characters as are entered in the text box will be compared, because the `SearchType` property specifies `StartsWith`.</span></span>

<span data-ttu-id="d3ea8-204">Le `OrderByExpression` élément spécifie que le jeu de résultats sera trié par titre du cours dans le nom du service.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-204">The `OrderByExpression` element specifies that the result set will be ordered by course title within department name.</span></span> <span data-ttu-id="d3ea8-205">Notez la façon dont le nom du service est spécifiée : `Department.Name`.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-205">Notice how department name is specified: `Department.Name`.</span></span> <span data-ttu-id="d3ea8-206">Étant donné que l’association entre le `Course` entité et la `Department` entité est-à-un, le `Department` contient de la propriété de navigation un `Department` entité.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-206">Because the association between the `Course` entity and the `Department` entity is one-to-one, the `Department` navigation property contains a `Department` entity.</span></span> <span data-ttu-id="d3ea8-207">(S’il s’agissait d’une relation un-à-plusieurs, la propriété contient une collection.) Pour obtenir le nom du service, vous devez spécifier le `Name` propriété de la `Department` entité.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-207">(If this were a one-to-many relationship, the property would contain a collection.) To get the department name, you must specify the `Name` property of the `Department` entity.</span></span>

<span data-ttu-id="d3ea8-208">Enfin, ajoutez un `GridView` contrôle pour afficher la liste des cours :</span><span class="sxs-lookup"><span data-stu-id="d3ea8-208">Finally, add a `GridView` control to display the list of courses:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample8.aspx)]

<span data-ttu-id="d3ea8-209">La première colonne est un champ de modèle qui affiche le nom du département.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-209">The first column is a template field that displays the department name.</span></span> <span data-ttu-id="d3ea8-210">Spécifie l’expression de liaison de données `Department.Name`, tout comme vous l’avez vu dans la `QueryExtender` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-210">The databinding expression specifies `Department.Name`, just as you saw in the `QueryExtender` control.</span></span>

<span data-ttu-id="d3ea8-211">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-211">Run the page.</span></span> <span data-ttu-id="d3ea8-212">L’affichage initial affiche une liste de tous les cours dans l’ordre par département, puis par titre du cours.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-212">The initial display shows a list of all courses in order by department and then by course title.</span></span>

<span data-ttu-id="d3ea8-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span></span>

<span data-ttu-id="d3ea8-214">Entrez un « m » et cliquez sur **recherche** pour voir tous les cours dont le titre commence par « m » (la recherche n'est pas la casse).</span><span class="sxs-lookup"><span data-stu-id="d3ea8-214">Enter an "m" and click **Search** to see all courses whose titles begin with "m" (the search is not case sensitive).</span></span>

<span data-ttu-id="d3ea8-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span></span>

## <a name="using-the-like-operator-to-filter-data"></a><span data-ttu-id="d3ea8-216">À l’aide de l’opérateur « Like » pour filtrer les données</span><span class="sxs-lookup"><span data-stu-id="d3ea8-216">Using the "Like" Operator to Filter Data</span></span>

<span data-ttu-id="d3ea8-217">Vous pouvez obtenir un effet similaire à la `QueryExtender` du contrôle `StartsWith`, `Contains`, et `EndsWith` rechercher des types à l’aide un `Like` opérateur dans le `EntityDataSource` du contrôle `Where` propriété.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-217">You can achieve an effect similar to the `QueryExtender` control's `StartsWith`, `Contains`, and `EndsWith` search types by using a `Like` operator in the `EntityDataSource` control's `Where` property.</span></span> <span data-ttu-id="d3ea8-218">Dans cette partie du didacticiel, vous allez apprendre à utiliser le `Like` opérateur à rechercher pour un étudiant par nom.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-218">In this part of the tutorial, you'll see how to use the `Like` operator to search for a student by name.</span></span>

<span data-ttu-id="d3ea8-219">Ouvrez *Students.aspx* dans **Source** vue.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-219">Open *Students.aspx* in **Source** view.</span></span> <span data-ttu-id="d3ea8-220">Après le `GridView` de contrôle, ajoutez le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="d3ea8-220">After the `GridView` control, add the following markup:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample9.aspx)]

<span data-ttu-id="d3ea8-221">Ce balisage est similaire à ce que vous avez vu précédemment à l’exception de la `Where` valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-221">This markup is similar to what you've seen earlier except for the `Where` property value.</span></span> <span data-ttu-id="d3ea8-222">La deuxième partie de la `Where` expression définit une recherche de sous-chaîne (`LIKE %FirstMidName% or LIKE %LastName%`) qui recherche les noms premier et derniers pour tout ce qui est entré dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-222">The second part of the `Where` expression defines a substring search (`LIKE %FirstMidName% or LIKE %LastName%`) that searches both the first and last names for whatever is entered in the text box.</span></span>

<span data-ttu-id="d3ea8-223">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-223">Run the page.</span></span> <span data-ttu-id="d3ea8-224">Initialement vous voir tous les étudiants, car la valeur par défaut pour le `StudentName` paramètre est « % ».</span><span class="sxs-lookup"><span data-stu-id="d3ea8-224">Initially you see all of the students because the default value for the `StudentName` parameter is "%".</span></span>

<span data-ttu-id="d3ea8-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span></span>

<span data-ttu-id="d3ea8-226">Entrez la lettre « g » dans la zone de texte et cliquez sur **recherche**.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-226">Enter the letter "g" in the text box and click **Search**.</span></span> <span data-ttu-id="d3ea8-227">Vous voyez une liste d’étudiants qui ont un « g » dans soit le premier ou le nom.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-227">You see a list of students that have a "g" in either the first or last name.</span></span>

<span data-ttu-id="d3ea8-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span></span>

<span data-ttu-id="d3ea8-229">Vous avez maintenant affichés, mis à jour, filtrés, classés et groupé des données à partir des tables individuelles.</span><span class="sxs-lookup"><span data-stu-id="d3ea8-229">You've now displayed, updated, filtered, ordered, and grouped data from individual tables.</span></span> <span data-ttu-id="d3ea8-230">Dans le didacticiel suivant, vous commencerez à travailler avec les données associées (scénarios maître / détail).</span><span class="sxs-lookup"><span data-stu-id="d3ea8-230">In the next tutorial you'll begin to work with related data (master-detail scenarios).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d3ea8-231">[Précédent](the-entity-framework-and-aspnet-getting-started-part-2.md)
> [Suivant](the-entity-framework-and-aspnet-getting-started-part-4.md)</span><span class="sxs-lookup"><span data-stu-id="d3ea8-231">[Previous](the-entity-framework-and-aspnet-getting-started-part-2.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-4.md)</span></span>
