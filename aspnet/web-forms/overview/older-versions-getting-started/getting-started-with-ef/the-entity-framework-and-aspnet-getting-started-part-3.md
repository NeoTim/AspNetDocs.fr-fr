---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
title: Prise en main avec Entity Framework 4,0 Database First et ASP.NET 4 Web Forms-part 3 | Microsoft Docs
author: tdykstra
description: L’exemple d’application Web Contoso University montre comment créer des applications de Web Forms ASP.NET à l’aide de l’Entity Framework. L’exemple d’application est...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: ccdc3f8c-2568-40a7-8f8b-3c23d2e05388
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
msc.type: authoredcontent
ms.openlocfilehash: 88debb11a9157dce9ff000b1cb459b876dbceaf3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78643247"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-3"></a><span data-ttu-id="15cec-104">Prise en main avec Entity Framework 4,0 Database First et ASP.NET 4 Web Forms-part 3</span><span class="sxs-lookup"><span data-stu-id="15cec-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 3</span></span>

<span data-ttu-id="15cec-105">par [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="15cec-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="15cec-106">L’exemple d’application Web Contoso University montre comment créer des applications ASP.NET Web Forms à l’aide de la Entity Framework 4,0 et de Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="15cec-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="15cec-107">Pour plus d’informations sur la série de didacticiels, consultez [le premier didacticiel de la série](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="15cec-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="filtering-ordering-and-grouping-data"></a><span data-ttu-id="15cec-108">Filtrage, classement et regroupement des données</span><span class="sxs-lookup"><span data-stu-id="15cec-108">Filtering, Ordering, and Grouping Data</span></span>

<span data-ttu-id="15cec-109">Dans le didacticiel précédent, vous avez utilisé le contrôle `EntityDataSource` pour afficher et modifier les données.</span><span class="sxs-lookup"><span data-stu-id="15cec-109">In the previous tutorial you used the `EntityDataSource` control to display and edit data.</span></span> <span data-ttu-id="15cec-110">Dans ce didacticiel, vous allez filtrer, classer et regrouper des données.</span><span class="sxs-lookup"><span data-stu-id="15cec-110">In this tutorial you'll filter, order, and group data.</span></span> <span data-ttu-id="15cec-111">Quand vous faites cela en définissant les propriétés du contrôle `EntityDataSource`, la syntaxe est différente de celle des autres contrôles de source de données.</span><span class="sxs-lookup"><span data-stu-id="15cec-111">When you do this by setting properties of the `EntityDataSource` control, the syntax is different from other data source controls.</span></span> <span data-ttu-id="15cec-112">Comme vous le verrez, toutefois, vous pouvez utiliser le contrôle `QueryExtender` pour réduire ces différences.</span><span class="sxs-lookup"><span data-stu-id="15cec-112">As you'll see, however, you can use the `QueryExtender` control to minimize these differences.</span></span>

<span data-ttu-id="15cec-113">Vous allez modifier la page *students. aspx* pour filtrer les élèves, les trier par nom et rechercher le nom.</span><span class="sxs-lookup"><span data-stu-id="15cec-113">You'll change the *Students.aspx* page to filter for students, sort by name, and search on name.</span></span> <span data-ttu-id="15cec-114">Vous allez également modifier la page *courses. aspx* pour afficher les cours du département sélectionné et rechercher les cours par nom.</span><span class="sxs-lookup"><span data-stu-id="15cec-114">You'll also change the *Courses.aspx* page to display courses for the selected department and search for courses by name.</span></span> <span data-ttu-id="15cec-115">Enfin, vous ajouterez les statistiques des étudiants à la page *about. aspx* .</span><span class="sxs-lookup"><span data-stu-id="15cec-115">Finally, you'll add student statistics to the *About.aspx* page.</span></span>

<span data-ttu-id="15cec-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span></span>

<span data-ttu-id="15cec-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span></span>

<span data-ttu-id="15cec-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span></span>

<span data-ttu-id="15cec-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span></span>

## <a name="using-the-entitydatasource-where-property-to-filter-data"></a><span data-ttu-id="15cec-120">Utilisation de la propriété « Where » EntityDataSource pour filtrer les données</span><span class="sxs-lookup"><span data-stu-id="15cec-120">Using the EntityDataSource "Where" Property to Filter Data</span></span>

<span data-ttu-id="15cec-121">Ouvrez la page *students. aspx* que vous avez créée dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="15cec-121">Open the *Students.aspx* page that you created in the previous tutorial.</span></span> <span data-ttu-id="15cec-122">Comme actuellement configuré, le contrôle `GridView` dans la page affiche tous les noms du jeu d’entités `People`.</span><span class="sxs-lookup"><span data-stu-id="15cec-122">As currently configured, the `GridView` control in the page displays all the names from the `People` entity set.</span></span> <span data-ttu-id="15cec-123">Toutefois, vous souhaitez afficher uniquement les élèves, que vous pouvez trouver en sélectionnant `Person` entités qui ont des dates d’inscription non null.</span><span class="sxs-lookup"><span data-stu-id="15cec-123">However, you want to show only students, which you can find by selecting `Person` entities that have non-null enrollment dates.</span></span>

<span data-ttu-id="15cec-124">Basculez en mode **conception** et sélectionnez le contrôle `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="15cec-124">Switch to **Design** view and select the `EntityDataSource` control.</span></span> <span data-ttu-id="15cec-125">Dans la fenêtre **Propriétés** , définissez la propriété `Where` sur `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="15cec-125">In the **Properties** window, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>

<span data-ttu-id="15cec-126">[![image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span></span>

<span data-ttu-id="15cec-127">La syntaxe que vous utilisez dans la propriété `Where` du contrôle `EntityDataSource` est Entity SQL.</span><span class="sxs-lookup"><span data-stu-id="15cec-127">The syntax you use in the `Where` property of the `EntityDataSource` control is Entity SQL.</span></span> <span data-ttu-id="15cec-128">Entity SQL est semblable à Transact-SQL, mais il est personnalisé pour une utilisation avec des entités plutôt que des objets de base de données.</span><span class="sxs-lookup"><span data-stu-id="15cec-128">Entity SQL is similar to Transact-SQL, but it's customized for use with entities rather than database objects.</span></span> <span data-ttu-id="15cec-129">Dans l' `it.EnrollmentDate is not null`d’expression, le mot `it` représente une référence à l’entité retournée par la requête.</span><span class="sxs-lookup"><span data-stu-id="15cec-129">In the expression `it.EnrollmentDate is not null`, the word `it` represents a reference to the entity returned by the query.</span></span> <span data-ttu-id="15cec-130">Par conséquent, `it.EnrollmentDate` fait référence à la propriété `EnrollmentDate` de l’entité `Person` que le contrôle `EntityDataSource` retourne.</span><span class="sxs-lookup"><span data-stu-id="15cec-130">Therefore, `it.EnrollmentDate` refers to the `EnrollmentDate` property of the `Person` entity that the `EntityDataSource` control returns.</span></span>

<span data-ttu-id="15cec-131">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="15cec-131">Run the page.</span></span> <span data-ttu-id="15cec-132">La liste des étudiants contient désormais uniquement les élèves.</span><span class="sxs-lookup"><span data-stu-id="15cec-132">The students list now contains only students.</span></span> <span data-ttu-id="15cec-133">(Aucune ligne n’est affichée lorsqu’il n’y a aucune date d’inscription.)</span><span class="sxs-lookup"><span data-stu-id="15cec-133">(There are no rows displayed where there's no enrollment date.)</span></span>

<span data-ttu-id="15cec-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span></span>

## <a name="using-the-entitydatasource-orderby-property-to-order-data"></a><span data-ttu-id="15cec-135">Utilisation de la propriété « OrderBy » EntityDataSource pour trier les données</span><span class="sxs-lookup"><span data-stu-id="15cec-135">Using the EntityDataSource "OrderBy" Property to Order Data</span></span>

<span data-ttu-id="15cec-136">Vous souhaitez également que cette liste soit dans l’ordre des noms lorsqu’elle est affichée pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="15cec-136">You also want this list to be in name order when it's first displayed.</span></span> <span data-ttu-id="15cec-137">Lorsque la page *students. aspx* est toujours ouverte en mode **conception** et que le contrôle `EntityDataSource` est toujours sélectionné, dans la fenêtre **Propriétés** , définissez la propriété **orderby** sur `it.LastName`.</span><span class="sxs-lookup"><span data-stu-id="15cec-137">With the *Students.aspx* page still open in **Design** view, and with the `EntityDataSource` control still selected, in the **Properties** window set the **OrderBy** property to `it.LastName`.</span></span>

<span data-ttu-id="15cec-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span></span>

<span data-ttu-id="15cec-139">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="15cec-139">Run the page.</span></span> <span data-ttu-id="15cec-140">La liste des étudiants est désormais triée par nom de famille.</span><span class="sxs-lookup"><span data-stu-id="15cec-140">The students list is now in order by last name.</span></span>

<span data-ttu-id="15cec-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span></span>

## <a name="using-a-control-parameter-to-set-the-where-property"></a><span data-ttu-id="15cec-142">Utilisation d’un paramètre de contrôle pour définir la propriété « Where »</span><span class="sxs-lookup"><span data-stu-id="15cec-142">Using a Control Parameter to Set the "Where" Property</span></span>

<span data-ttu-id="15cec-143">Comme pour les autres contrôles de source de données, vous pouvez passer des valeurs de paramètre à la propriété `Where`.</span><span class="sxs-lookup"><span data-stu-id="15cec-143">As with other data source controls, you can pass parameter values to the `Where` property.</span></span> <span data-ttu-id="15cec-144">Sur la page *courses. aspx* que vous avez créée dans la partie 2 du didacticiel, vous pouvez utiliser cette méthode pour afficher les cours qui sont associés au service qu’un utilisateur sélectionne dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="15cec-144">On the *Courses.aspx* page that you created in part 2 of the tutorial, you can use this method to display courses that are associated with the department that a user selects from the drop-down list.</span></span>

<span data-ttu-id="15cec-145">Ouvrez *courses. aspx* et basculez en mode **Design** .</span><span class="sxs-lookup"><span data-stu-id="15cec-145">Open *Courses.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="15cec-146">Ajoutez un deuxième contrôle `EntityDataSource` à la page, puis nommez-le `CoursesEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="15cec-146">Add a second `EntityDataSource` control to the page, and name it `CoursesEntityDataSource`.</span></span> <span data-ttu-id="15cec-147">Connectez-le au modèle `SchoolEntities`, puis sélectionnez `Courses` comme valeur **EntitySetName** .</span><span class="sxs-lookup"><span data-stu-id="15cec-147">Connect it to the `SchoolEntities` model, and select `Courses` as the **EntitySetName** value.</span></span>

<span data-ttu-id="15cec-148">Dans la fenêtre **Propriétés** , cliquez sur le bouton de sélection dans la zone de propriété **Where** .</span><span class="sxs-lookup"><span data-stu-id="15cec-148">In the **Properties** window, click the ellipsis in the **Where** property box.</span></span> <span data-ttu-id="15cec-149">(Assurez-vous que le contrôle `CoursesEntityDataSource` est toujours sélectionné avant d’utiliser la fenêtre **Propriétés** .)</span><span class="sxs-lookup"><span data-stu-id="15cec-149">(Make sure the `CoursesEntityDataSource` control is still selected before using the **Properties** window.)</span></span>

<span data-ttu-id="15cec-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span></span>

<span data-ttu-id="15cec-151">La boîte de dialogue **éditeur d’expressions** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="15cec-151">The **Expression Editor** dialog box is displayed.</span></span> <span data-ttu-id="15cec-152">Dans cette boîte de dialogue, sélectionnez **générer automatiquement l’expression WHERE en fonction des paramètres fournis**, puis cliquez sur **Ajouter un paramètre**.</span><span class="sxs-lookup"><span data-stu-id="15cec-152">In this dialog box, select **Automatically generate the Where expression based on the provided parameters**, and then click **Add Parameter**.</span></span> <span data-ttu-id="15cec-153">Nommez le paramètre `DepartmentID`, sélectionnez **Control** comme valeur **source du paramètre** , puis **DepartmentsDropDownList** comme valeur **ControlID** .</span><span class="sxs-lookup"><span data-stu-id="15cec-153">Name the parameter `DepartmentID`, select **Control** as the **Parameter source** value, and select **DepartmentsDropDownList** as the **ControlID** value.</span></span>

<span data-ttu-id="15cec-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span></span>

<span data-ttu-id="15cec-155">Cliquez sur **afficher les propriétés avancées**, puis, dans la fenêtre **Propriétés** de la boîte de dialogue **éditeur d’expressions** , remplacez la valeur de la propriété `Type` par `Int32`.</span><span class="sxs-lookup"><span data-stu-id="15cec-155">Click **Show advanced properties**, and in the **Properties** window of the **Expression Editor** dialog box, change the `Type` property to `Int32`.</span></span>

<span data-ttu-id="15cec-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span></span>

<span data-ttu-id="15cec-157">Quand vous avez terminé, cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="15cec-157">When you're done, click **OK**.</span></span>

<span data-ttu-id="15cec-158">Sous la liste déroulante, ajoutez un contrôle `GridView` à la page, puis nommez-le `CoursesGridView`.</span><span class="sxs-lookup"><span data-stu-id="15cec-158">Below the drop-down list, add a `GridView` control to the page and name it `CoursesGridView`.</span></span> <span data-ttu-id="15cec-159">Connectez-le au `CoursesEntityDataSource` contrôle de source de données, cliquez sur **Actualiser le schéma**, puis sur **modifier les colonnes**et supprimez la colonne `DepartmentID`.</span><span class="sxs-lookup"><span data-stu-id="15cec-159">Connect it to the `CoursesEntityDataSource` data source control, click **Refresh Schema**, click **Edit Columns**, and remove the `DepartmentID` column.</span></span> <span data-ttu-id="15cec-160">Le balisage de contrôle `GridView` ressemble à l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="15cec-160">The `GridView` control markup resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample1.aspx)]

<span data-ttu-id="15cec-161">Lorsque l’utilisateur modifie le service sélectionné dans la liste déroulante, vous souhaitez que la liste des cours associés change automatiquement.</span><span class="sxs-lookup"><span data-stu-id="15cec-161">When the user changes the selected department in the drop-down list, you want the list of associated courses to change automatically.</span></span> <span data-ttu-id="15cec-162">Pour ce faire, sélectionnez la liste déroulante, puis, dans la fenêtre **Propriétés** , affectez à la propriété `AutoPostBack` la valeur `True`.</span><span class="sxs-lookup"><span data-stu-id="15cec-162">To make this happen, select the drop-down list, and in the **Properties** window set the `AutoPostBack` property to `True`.</span></span>

<span data-ttu-id="15cec-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span></span>

<span data-ttu-id="15cec-164">Maintenant que vous avez terminé d’utiliser le concepteur, passez en mode **source** et remplacez les propriétés `ConnectionString` et `DefaultContainer` Name du contrôle `CoursesEntityDataSource` par l’attribut `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="15cec-164">Now that you're finished using the designer, switch to **Source** view and replace the `ConnectionString` and `DefaultContainer` name properties of the `CoursesEntityDataSource` control with the `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="15cec-165">Lorsque vous avez terminé, le balisage du contrôle doit ressembler à l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="15cec-165">When you're done, the markup for the control will look like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample2.aspx)]

<span data-ttu-id="15cec-166">Exécutez la page et utilisez la liste déroulante pour sélectionner différents services.</span><span class="sxs-lookup"><span data-stu-id="15cec-166">Run the page and use the drop-down list to select different departments.</span></span> <span data-ttu-id="15cec-167">Seuls les cours proposés par le service sélectionné s’affichent dans le contrôle `GridView`.</span><span class="sxs-lookup"><span data-stu-id="15cec-167">Only courses that are offered by the selected department are displayed in the `GridView` control.</span></span>

<span data-ttu-id="15cec-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span></span>

## <a name="using-the-entitydatasource-groupby-property-to-group-data"></a><span data-ttu-id="15cec-169">Utilisation de la propriété « GroupBy » EntityDataSource pour regrouper des données</span><span class="sxs-lookup"><span data-stu-id="15cec-169">Using the EntityDataSource "GroupBy" Property to Group Data</span></span>

<span data-ttu-id="15cec-170">Supposons que Contoso University souhaite placer des statistiques sur la page about de l’étudiant.</span><span class="sxs-lookup"><span data-stu-id="15cec-170">Suppose Contoso University wants to put some student-body statistics on its About page.</span></span> <span data-ttu-id="15cec-171">Plus précisément, il souhaite afficher une répartition du nombre d’élèves par date d’inscription.</span><span class="sxs-lookup"><span data-stu-id="15cec-171">Specifically, it wants to show a breakdown of numbers of students by the date they enrolled.</span></span>

<span data-ttu-id="15cec-172">Ouvrez *about. aspx*et, en mode **source** , remplacez le contenu existant du contrôle `BodyContent` par « statistiques du corps de l’étudiant » entre les balises `h2` :</span><span class="sxs-lookup"><span data-stu-id="15cec-172">Open *About.aspx*, and in **Source** view, replace the existing contents of the `BodyContent` control with "Student Body Statistics" between `h2` tags:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample3.aspx)]

<span data-ttu-id="15cec-173">Après l’en-tête, ajoutez un contrôle `EntityDataSource` et nommez-le `StudentStatisticsEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="15cec-173">After the heading, add an `EntityDataSource` control and name it `StudentStatisticsEntityDataSource`.</span></span> <span data-ttu-id="15cec-174">Connectez-le à `SchoolEntities`, sélectionnez le jeu d’entités `People` et laissez la zone **Sélectionner** dans l’Assistant inchangée.</span><span class="sxs-lookup"><span data-stu-id="15cec-174">Connect it to `SchoolEntities`, select the `People` entity set, and leave the **Select** box in the wizard unchanged.</span></span> <span data-ttu-id="15cec-175">Définissez les propriétés suivantes dans la fenêtre **Propriétés** :</span><span class="sxs-lookup"><span data-stu-id="15cec-175">Set the following properties in the **Properties** window:</span></span>

- <span data-ttu-id="15cec-176">Pour filtrer uniquement pour les élèves, affectez à la propriété `Where` la valeur `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="15cec-176">To filter for students only, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>
- <span data-ttu-id="15cec-177">Pour regrouper les résultats selon la date d’inscription, affectez à la propriété `GroupBy` la valeur `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="15cec-177">To group the results by the enrollment date, set the `GroupBy` property to `it.EnrollmentDate`.</span></span>
- <span data-ttu-id="15cec-178">Pour sélectionner la date d’inscription et le nombre d’élèves, affectez à la propriété `Select` la valeur `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span><span class="sxs-lookup"><span data-stu-id="15cec-178">To select the enrollment date and the number of students, set the `Select` property to `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span></span>
- <span data-ttu-id="15cec-179">Pour classer les résultats par date d’inscription, affectez à la propriété `OrderBy` la valeur `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="15cec-179">To order the results by the enrollment date, set the `OrderBy` property to `it.EnrollmentDate`.</span></span>

<span data-ttu-id="15cec-180">En mode **source** , remplacez les propriétés `ConnectionString` et `DefaultContainer` nom par une propriété `ContextTypeName`.</span><span class="sxs-lookup"><span data-stu-id="15cec-180">In **Source** view, replace the `ConnectionString` and `DefaultContainer` name properties with a `ContextTypeName` property.</span></span> <span data-ttu-id="15cec-181">Le balisage de contrôle `EntityDataSource` ressemble maintenant à l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="15cec-181">The `EntityDataSource` control markup now resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample4.aspx)]

<span data-ttu-id="15cec-182">La syntaxe des propriétés `Select`, `GroupBy`et `Where` ressemble à Transact-SQL, à l’exception du mot clé `it` qui spécifie l’entité actuelle.</span><span class="sxs-lookup"><span data-stu-id="15cec-182">The syntax of the `Select`, `GroupBy`, and `Where` properties resembles Transact-SQL except for the `it` keyword that specifies the current entity.</span></span>

<span data-ttu-id="15cec-183">Ajoutez le balisage suivant pour créer un contrôle de `GridView` pour afficher les données.</span><span class="sxs-lookup"><span data-stu-id="15cec-183">Add the following markup to create a `GridView` control to display the data.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample5.aspx)]

<span data-ttu-id="15cec-184">Exécutez la page pour afficher une liste qui indique le nombre d’élèves par date d’inscription.</span><span class="sxs-lookup"><span data-stu-id="15cec-184">Run the page to see a list showing the number of students by enrollment date.</span></span>

<span data-ttu-id="15cec-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span></span>

## <a name="using-the-queryextender-control-for-filtering-and-ordering"></a><span data-ttu-id="15cec-186">Utilisation du contrôle QueryExtender pour le filtrage et le tri</span><span class="sxs-lookup"><span data-stu-id="15cec-186">Using the QueryExtender Control for Filtering and Ordering</span></span>

<span data-ttu-id="15cec-187">Le contrôle `QueryExtender` permet de spécifier le filtrage et le tri dans le balisage.</span><span class="sxs-lookup"><span data-stu-id="15cec-187">The `QueryExtender` control provides a way to specify filtering and sorting in markup.</span></span> <span data-ttu-id="15cec-188">La syntaxe est indépendante du système de gestion de base de données (SGBD) que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="15cec-188">The syntax is independent of the database management system (DBMS) you're using.</span></span> <span data-ttu-id="15cec-189">Il est également généralement indépendant du Entity Framework, à l’exception que la syntaxe que vous utilisez pour les propriétés de navigation est propre à la Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="15cec-189">It's also generally independent of the Entity Framework, with the exception that syntax you use for navigation properties is unique to the Entity Framework.</span></span>

<span data-ttu-id="15cec-190">Dans cette partie du didacticiel, vous utiliserez un contrôle de `QueryExtender` pour filtrer et trier les données, et l’un des champs order-by sera une propriété de navigation.</span><span class="sxs-lookup"><span data-stu-id="15cec-190">In this part of the tutorial you'll use a `QueryExtender` control to filter and order data, and one of the order-by fields will be a navigation property.</span></span>

<span data-ttu-id="15cec-191">(Si vous préférez utiliser le code au lieu du balisage pour étendre les requêtes qui sont générées automatiquement par le contrôle `EntityDataSource`, vous pouvez le faire en gérant l’événement `QueryCreated`.</span><span class="sxs-lookup"><span data-stu-id="15cec-191">(If you prefer to use code instead of markup to extend the queries that are automatically generated by the `EntityDataSource` control, you can do that by handling the `QueryCreated` event.</span></span> <span data-ttu-id="15cec-192">C’est ainsi que le contrôle `QueryExtender` étend également `EntityDataSource` des requêtes de contrôle.)</span><span class="sxs-lookup"><span data-stu-id="15cec-192">This is how the `QueryExtender` control extends `EntityDataSource` control queries also.)</span></span>

<span data-ttu-id="15cec-193">Ouvrez la page *courses. aspx* et, sous le balisage que vous avez ajouté précédemment, insérez le balisage suivant pour créer un titre, une zone de texte pour entrer des chaînes de recherche, un bouton de recherche et un contrôle de `EntityDataSource` lié au jeu d’entités `Courses`.</span><span class="sxs-lookup"><span data-stu-id="15cec-193">Open the *Courses.aspx* page, and below the markup you added previously, insert the following markup to create a heading, a text box for entering search strings, a search button, and an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample6.aspx)]

<span data-ttu-id="15cec-194">Notez que la propriété `Include` du contrôle `EntityDataSource` a la valeur `Department`.</span><span class="sxs-lookup"><span data-stu-id="15cec-194">Notice that the `EntityDataSource` control's `Include` property is set to `Department`.</span></span> <span data-ttu-id="15cec-195">Dans la base de données, la table `Course` ne contient pas le nom du service ; Il contient une colonne de clé étrangère `DepartmentID`.</span><span class="sxs-lookup"><span data-stu-id="15cec-195">In the database, the `Course` table does not contain the department name; it contains a `DepartmentID` foreign key column.</span></span> <span data-ttu-id="15cec-196">Si vous interrogez la base de données directement, pour obtenir le nom du service ainsi que les données de cours, vous devez joindre les tables `Course` et `Department`.</span><span class="sxs-lookup"><span data-stu-id="15cec-196">If you were querying the database directly, to get the department name along with course data, you would have to join the `Course` and `Department` tables.</span></span> <span data-ttu-id="15cec-197">En affectant à la propriété `Include` la valeur `Department`, vous spécifiez que le Entity Framework doit effectuer le travail d’obtention de l’entité `Department` associée lorsqu’elle obtient une entité `Course`.</span><span class="sxs-lookup"><span data-stu-id="15cec-197">By setting the `Include` property to `Department`, you specify that the Entity Framework should do the work of getting the related `Department` entity when it gets a `Course` entity.</span></span> <span data-ttu-id="15cec-198">L’entité `Department` est ensuite stockée dans la propriété de navigation `Department` de l’entité `Course`.</span><span class="sxs-lookup"><span data-stu-id="15cec-198">The `Department` entity is then stored in the `Department` navigation property of the `Course` entity.</span></span> <span data-ttu-id="15cec-199">(Par défaut, la classe `SchoolEntities` qui a été générée par le concepteur de modèle de données récupère les données associées lorsqu’elles sont nécessaires, et que vous avez lié le contrôle de source de données à cette classe, la définition de la propriété `Include` n’est donc pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="15cec-199">(By default, the `SchoolEntities` class that was generated by the data model designer retrieves related data when it's needed, and you've bound the data source control to that class, so setting the `Include` property is not necessary.</span></span> <span data-ttu-id="15cec-200">Toutefois, la définition de cette valeur améliore les performances de la page, car dans le cas contraire, le Entity Framework effectuerait des appels distincts à la base de données pour récupérer des données pour les entités `Course` et pour les entités `Department` associées.)</span><span class="sxs-lookup"><span data-stu-id="15cec-200">However, setting it improves performance of the page, because otherwise the Entity Framework would make separate calls to the database to retrieve data for the `Course` entities and for the related `Department` entities.)</span></span>

<span data-ttu-id="15cec-201">Après le contrôle `EntityDataSource` que vous venez de créer, insérez le balisage suivant pour créer un contrôle `QueryExtender` lié à ce contrôle `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="15cec-201">After the `EntityDataSource` control you just created, insert the following markup to create a `QueryExtender` control that's bound to that `EntityDataSource` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample7.aspx)]

<span data-ttu-id="15cec-202">L’élément `SearchExpression` spécifie que vous souhaitez sélectionner des cours dont les titres correspondent à la valeur entrée dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="15cec-202">The `SearchExpression` element specifies that you want to select courses whose titles match the value entered in the text box.</span></span> <span data-ttu-id="15cec-203">Seuls le nombre de caractères entrés dans la zone de texte sont comparés, car la propriété `SearchType` spécifie `StartsWith`.</span><span class="sxs-lookup"><span data-stu-id="15cec-203">Only as many characters as are entered in the text box will be compared, because the `SearchType` property specifies `StartsWith`.</span></span>

<span data-ttu-id="15cec-204">L’élément `OrderByExpression` spécifie que le jeu de résultats sera classé par titre de cours dans le nom de service.</span><span class="sxs-lookup"><span data-stu-id="15cec-204">The `OrderByExpression` element specifies that the result set will be ordered by course title within department name.</span></span> <span data-ttu-id="15cec-205">Notez comment le nom du service est spécifié : `Department.Name`.</span><span class="sxs-lookup"><span data-stu-id="15cec-205">Notice how department name is specified: `Department.Name`.</span></span> <span data-ttu-id="15cec-206">Étant donné que l’association entre l’entité `Course` et l’entité `Department` est un-à-un, la propriété de navigation `Department` contient une entité `Department`.</span><span class="sxs-lookup"><span data-stu-id="15cec-206">Because the association between the `Course` entity and the `Department` entity is one-to-one, the `Department` navigation property contains a `Department` entity.</span></span> <span data-ttu-id="15cec-207">(S’il s’agissait d’une relation un-à-plusieurs, la propriété contiendrait une collection.) Pour récupérer le nom du service, vous devez spécifier la propriété `Name` de l’entité `Department`.</span><span class="sxs-lookup"><span data-stu-id="15cec-207">(If this were a one-to-many relationship, the property would contain a collection.) To get the department name, you must specify the `Name` property of the `Department` entity.</span></span>

<span data-ttu-id="15cec-208">Enfin, ajoutez un contrôle de `GridView` pour afficher la liste des cours :</span><span class="sxs-lookup"><span data-stu-id="15cec-208">Finally, add a `GridView` control to display the list of courses:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample8.aspx)]

<span data-ttu-id="15cec-209">La première colonne est un champ de modèle qui affiche le nom du service.</span><span class="sxs-lookup"><span data-stu-id="15cec-209">The first column is a template field that displays the department name.</span></span> <span data-ttu-id="15cec-210">L’expression DataBinding spécifie `Department.Name`, comme vous l’avez vu dans le contrôle `QueryExtender`.</span><span class="sxs-lookup"><span data-stu-id="15cec-210">The databinding expression specifies `Department.Name`, just as you saw in the `QueryExtender` control.</span></span>

<span data-ttu-id="15cec-211">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="15cec-211">Run the page.</span></span> <span data-ttu-id="15cec-212">L’affichage initial affiche une liste de tous les cours par service, puis par titre de cours.</span><span class="sxs-lookup"><span data-stu-id="15cec-212">The initial display shows a list of all courses in order by department and then by course title.</span></span>

<span data-ttu-id="15cec-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span></span>

<span data-ttu-id="15cec-214">Entrez un « m », puis cliquez sur **Rechercher** pour afficher tous les cours dont les titres commencent par « m » (la recherche ne respecte pas la casse).</span><span class="sxs-lookup"><span data-stu-id="15cec-214">Enter an "m" and click **Search** to see all courses whose titles begin with "m" (the search is not case sensitive).</span></span>

<span data-ttu-id="15cec-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span></span>

## <a name="using-the-like-operator-to-filter-data"></a><span data-ttu-id="15cec-216">Utilisation de l’opérateur « Like » pour filtrer les données</span><span class="sxs-lookup"><span data-stu-id="15cec-216">Using the "Like" Operator to Filter Data</span></span>

<span data-ttu-id="15cec-217">Vous pouvez obtenir un effet similaire aux types de recherche `StartsWith`, `Contains`et `EndsWith` du contrôle `QueryExtender` à l’aide d’un opérateur `Like` dans la propriété `EntityDataSource` du contrôle `Where`.</span><span class="sxs-lookup"><span data-stu-id="15cec-217">You can achieve an effect similar to the `QueryExtender` control's `StartsWith`, `Contains`, and `EndsWith` search types by using a `Like` operator in the `EntityDataSource` control's `Where` property.</span></span> <span data-ttu-id="15cec-218">Dans cette partie du didacticiel, vous allez apprendre à utiliser l’opérateur `Like` pour rechercher un élève par nom.</span><span class="sxs-lookup"><span data-stu-id="15cec-218">In this part of the tutorial, you'll see how to use the `Like` operator to search for a student by name.</span></span>

<span data-ttu-id="15cec-219">Ouvrez *students. aspx* en mode **source** .</span><span class="sxs-lookup"><span data-stu-id="15cec-219">Open *Students.aspx* in **Source** view.</span></span> <span data-ttu-id="15cec-220">Après le contrôle `GridView`, ajoutez le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="15cec-220">After the `GridView` control, add the following markup:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample9.aspx)]

<span data-ttu-id="15cec-221">Ce balisage est similaire à ce que vous avez vu précédemment, à l’exception de la valeur de propriété `Where`.</span><span class="sxs-lookup"><span data-stu-id="15cec-221">This markup is similar to what you've seen earlier except for the `Where` property value.</span></span> <span data-ttu-id="15cec-222">La deuxième partie de l’expression `Where` définit une recherche de sous-chaîne (`LIKE %FirstMidName% or LIKE %LastName%`) qui recherche le prénom et le nom de ce qui est entré dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="15cec-222">The second part of the `Where` expression defines a substring search (`LIKE %FirstMidName% or LIKE %LastName%`) that searches both the first and last names for whatever is entered in the text box.</span></span>

<span data-ttu-id="15cec-223">Exécutez la page.</span><span class="sxs-lookup"><span data-stu-id="15cec-223">Run the page.</span></span> <span data-ttu-id="15cec-224">Au départ, vous voyez tous les élèves, car la valeur par défaut du paramètre `StudentName` est « % ».</span><span class="sxs-lookup"><span data-stu-id="15cec-224">Initially you see all of the students because the default value for the `StudentName` parameter is "%".</span></span>

<span data-ttu-id="15cec-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span></span>

<span data-ttu-id="15cec-226">Entrez la lettre « g » dans la zone de texte, puis cliquez sur **Rechercher**.</span><span class="sxs-lookup"><span data-stu-id="15cec-226">Enter the letter "g" in the text box and click **Search**.</span></span> <span data-ttu-id="15cec-227">Vous voyez une liste des étudiants dont le prénom ou le nom contient un « g ».</span><span class="sxs-lookup"><span data-stu-id="15cec-227">You see a list of students that have a "g" in either the first or last name.</span></span>

<span data-ttu-id="15cec-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="15cec-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span></span>

<span data-ttu-id="15cec-229">Vous pouvez désormais afficher, mettre à jour, filtrer, trier et regrouper des données à partir de tables individuelles.</span><span class="sxs-lookup"><span data-stu-id="15cec-229">You've now displayed, updated, filtered, ordered, and grouped data from individual tables.</span></span> <span data-ttu-id="15cec-230">Dans le didacticiel suivant, vous commencerez à travailler avec des données associées (scénarios maître/détail).</span><span class="sxs-lookup"><span data-stu-id="15cec-230">In the next tutorial you'll begin to work with related data (master-detail scenarios).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="15cec-231">[Précédent](the-entity-framework-and-aspnet-getting-started-part-2.md)
> [Suivant](the-entity-framework-and-aspnet-getting-started-part-4.md)</span><span class="sxs-lookup"><span data-stu-id="15cec-231">[Previous](the-entity-framework-and-aspnet-getting-started-part-2.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-4.md)</span></span>
