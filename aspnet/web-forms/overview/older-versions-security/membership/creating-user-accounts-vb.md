---
uid: web-forms/overview/older-versions-security/membership/creating-user-accounts-vb
title: Création de comptes d’utilisateur (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons explorer l’utilisation de l’infrastructure d’appartenance (via SqlMembershipProvider) pour créer des comptes d’utilisateur. Nous verrons comment créer de nouveaux États-Unis...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 9ef3e893-bebe-4b13-9fe5-8b71720dd85e
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-user-accounts-vb
msc.type: authoredcontent
ms.openlocfilehash: 01be198c329f372ddcd529ad8a369f2d3426a9fc
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74628457"
---
# <a name="creating-user-accounts-vb"></a><span data-ttu-id="a4c23-104">Création de comptes d’utilisateurs (VB)</span><span class="sxs-lookup"><span data-stu-id="a4c23-104">Creating User Accounts (VB)</span></span>

<span data-ttu-id="a4c23-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a4c23-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a4c23-106">[Télécharger le code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_VB.zip) ou [Télécharger le PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="a4c23-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_vb.pdf)</span></span>

> <span data-ttu-id="a4c23-107">Dans ce didacticiel, nous allons explorer l’utilisation de l’infrastructure d’appartenance (via SqlMembershipProvider) pour créer des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-107">In this tutorial we will explore using the Membership framework (via the SqlMembershipProvider) to create new user accounts.</span></span> <span data-ttu-id="a4c23-108">Nous verrons comment créer des utilisateurs par programme et par le biais d’ASP. Contrôle CreateUserWizard intégré au réseau.</span><span class="sxs-lookup"><span data-stu-id="a4c23-108">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

## <a name="introduction"></a><span data-ttu-id="a4c23-109">Présentation</span><span class="sxs-lookup"><span data-stu-id="a4c23-109">Introduction</span></span>

<span data-ttu-id="a4c23-110">Dans le <a id="_msoanchor_1"> </a> [didacticiel précédent](creating-the-membership-schema-in-sql-server-vb.md) , nous avons installé le schéma des services d’application dans une base de données, qui a ajouté les tables, les vues et les procédures stockées nécessaires à la `SqlMembershipProvider` et `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-110">In the <a id="_msoanchor_1"></a>[preceding tutorial](creating-the-membership-schema-in-sql-server-vb.md) we installed the application services schema in a database, which added the tables, views, and stored procedures needed by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span> <span data-ttu-id="a4c23-111">Cela a créé l’infrastructure dont nous aurons besoin pour le reste des didacticiels de cette série.</span><span class="sxs-lookup"><span data-stu-id="a4c23-111">This created the infrastructure we will need for the remainder of the tutorials in this series.</span></span> <span data-ttu-id="a4c23-112">Dans ce didacticiel, nous allons explorer l’utilisation de l’infrastructure d’appartenance (via le `SqlMembershipProvider`) pour créer des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-112">In this tutorial we will explore using the Membership framework (via the `SqlMembershipProvider`) to create new user accounts.</span></span> <span data-ttu-id="a4c23-113">Nous verrons comment créer des utilisateurs par programme et par le biais d’ASP. Contrôle CreateUserWizard intégré au réseau.</span><span class="sxs-lookup"><span data-stu-id="a4c23-113">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

<span data-ttu-id="a4c23-114">En plus d’apprendre à créer des comptes d’utilisateur, nous devons également mettre à jour le site Web de démonstration que nous avons créé dans le didacticiel *<a id="_msoanchor_2"></a>[d’authentification des formulaires](../introduction/an-overview-of-forms-authentication-vb.md)* , puis amélioré dans le didacticiel sur *<a id="_msoanchor_3"></a>[la configuration de l'authentification par formulaire et les rubriques avancées](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="a4c23-114">In addition to learning how to create new user accounts, we will also need to update the demo website we first created in the *<a id="_msoanchor_2"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)* tutorial and then enhanced in the *<a id="_msoanchor_3"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* tutorial.</span></span> <span data-ttu-id="a4c23-115">Notre application Web de démonstration a une page de connexion qui valide les informations d’identification des utilisateurs par rapport à des paires nom d’utilisateur/mot de passe codées en dur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-115">Our demo web application has a login page that validates users' credentials against hard-coded username/password pairs.</span></span> <span data-ttu-id="a4c23-116">En outre, `Global.asax` comprend du code qui crée des objets `IPrincipal` et `IIdentity` personnalisés pour les utilisateurs authentifiés.</span><span class="sxs-lookup"><span data-stu-id="a4c23-116">Moreover, `Global.asax` includes code that creates custom `IPrincipal` and `IIdentity` objects for authenticated users.</span></span> <span data-ttu-id="a4c23-117">Nous allons mettre à jour la page de connexion pour valider les informations d’identification des utilisateurs par rapport à l’infrastructure d’appartenance et supprimer le principal personnalisé et la logique d’identité.</span><span class="sxs-lookup"><span data-stu-id="a4c23-117">We will update the login page to validate users' credentials against the Membership framework and remove the custom principal and identity logic.</span></span>

<span data-ttu-id="a4c23-118">Commençons !</span><span class="sxs-lookup"><span data-stu-id="a4c23-118">Let's get started!</span></span>

## <a name="the-forms-authentication-and-membership-checklist"></a><span data-ttu-id="a4c23-119">Liste de vérification de l’authentification et de l’appartenance aux formulaires</span><span class="sxs-lookup"><span data-stu-id="a4c23-119">The Forms Authentication and Membership Checklist</span></span>

<span data-ttu-id="a4c23-120">Avant de commencer à travailler avec l’infrastructure d’appartenance, nous allons prendre un moment pour passer en revue les étapes importantes que nous avons suivies pour atteindre ce point.</span><span class="sxs-lookup"><span data-stu-id="a4c23-120">Before we begin working with the Membership framework, let's take a moment to review the important steps we have taken to reach this point.</span></span> <span data-ttu-id="a4c23-121">Lors de l’utilisation de l’infrastructure d’appartenance avec l' `SqlMembershipProvider` dans un scénario d’authentification basé sur les formulaires, les étapes suivantes doivent être effectuées avant d’implémenter la fonctionnalité d’appartenance dans votre application Web :</span><span class="sxs-lookup"><span data-stu-id="a4c23-121">When using the Membership framework with the `SqlMembershipProvider` in a forms-based authentication scenario, the following steps need to be performed prior to implementing Membership functionality in your web application:</span></span>

1. <span data-ttu-id="a4c23-122">**Activez l’authentification basée sur les formulaires.**</span><span class="sxs-lookup"><span data-stu-id="a4c23-122">**Enable forms-based authentication.**</span></span> <span data-ttu-id="a4c23-123">Comme nous l’avons vu dans *<a id="_msoanchor_4"></a>[une vue d’ensemble de l’authentification par formulaire](../introduction/an-overview-of-forms-authentication-vb.md)* , l’authentification par formulaire est activée en modifiant `Web.config` et en affectant à l’attribut `mode` de l’élément `<authentication>` la valeur `Forms`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-123">As we discussed in *<a id="_msoanchor_4"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)*, forms authentication is enabled by editing `Web.config` and setting the `<authentication>` element's `mode` attribute to `Forms`.</span></span> <span data-ttu-id="a4c23-124">Lorsque l’authentification par formulaire est activée, chaque demande entrante est examinée pour obtenir un *ticket d’authentification par formulaire*, qui, le cas échéant, identifie le demandeur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-124">With forms authentication enabled, each incoming request is examined for a *forms authentication ticket*, which, if present, identifies the requestor.</span></span>
2. <span data-ttu-id="a4c23-125">**Ajoutez le schéma des services d’application à la base de données appropriée.**</span><span class="sxs-lookup"><span data-stu-id="a4c23-125">**Add the application services schema to the appropriate database.**</span></span> <span data-ttu-id="a4c23-126">Lors de l’utilisation de la `SqlMembershipProvider` vous devez installer le schéma des services d’application dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="a4c23-126">When using the `SqlMembershipProvider` we need to install the application services schema to a database.</span></span> <span data-ttu-id="a4c23-127">En général, ce schéma est ajouté à la base de données qui contient le modèle de données de l’application.</span><span class="sxs-lookup"><span data-stu-id="a4c23-127">Usually this schema is added to the same database that holds the application's data model.</span></span> <span data-ttu-id="a4c23-128">Le didacticiel *<a id="_msoanchor_5"></a>[Création du schéma d’appartenance dans SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* a été abordé à l’aide de l’outil `aspnet_regsql.exe` pour y parvenir.</span><span class="sxs-lookup"><span data-stu-id="a4c23-128">The *<a id="_msoanchor_5"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial looked at using the `aspnet_regsql.exe` tool to accomplish this.</span></span>
3. <span data-ttu-id="a4c23-129">**Personnalisez les paramètres de l’application Web pour faire référence à la base de données de l’étape 2.**</span><span class="sxs-lookup"><span data-stu-id="a4c23-129">**Customize the Web Application's Settings to reference the database from step 2.**</span></span> <span data-ttu-id="a4c23-130">Le didacticiel *création du schéma d’appartenance dans SQL Server* a montré deux façons de configurer l’application Web afin que le `SqlMembershipProvider` utilise la base de données sélectionnée à l’étape 2 : en modifiant le nom de la chaîne de connexion `LocalSqlServer` ; ou en ajoutant un nouveau fournisseur inscrit à la liste des fournisseurs d’infrastructure d’appartenance et en personnalisant ce nouveau fournisseur pour utiliser la base de données de l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="a4c23-130">The *Creating the Membership Schema in SQL Server* tutorial showed two ways to configure the web application so that the `SqlMembershipProvider` would use the database selected in step 2: by modifying the `LocalSqlServer` connection string name; or by adding a new registered provider to the list of Membership framework providers and customizing that new provider to use the database from step 2.</span></span>

<span data-ttu-id="a4c23-131">Lors de la création d’une application Web qui utilise la `SqlMembershipProvider` et l’authentification basée sur les formulaires, vous devez effectuer ces trois étapes avant d’utiliser la classe `Membership` ou les contrôles Web de connexion ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4c23-131">When building a web application that uses the `SqlMembershipProvider` and forms-based authentication, you will need to perform these three steps before using the `Membership` class or the ASP.NET Login Web controls.</span></span> <span data-ttu-id="a4c23-132">Étant donné que nous avons déjà effectué ces étapes dans les didacticiels précédents, nous sommes prêts à commencer à utiliser l’infrastructure d’appartenance !</span><span class="sxs-lookup"><span data-stu-id="a4c23-132">Since we already performed these steps in previous tutorials, we are ready to start using the Membership framework!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="a4c23-133">Étape 1 : Ajout de nouvelles pages ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a4c23-133">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="a4c23-134">Dans ce didacticiel et les trois suivants, nous examinerons diverses fonctions et fonctionnalités liées à l’appartenance.</span><span class="sxs-lookup"><span data-stu-id="a4c23-134">In this tutorial and the next three we will be examining various Membership-related functions and capabilities.</span></span> <span data-ttu-id="a4c23-135">Nous aurons besoin d’une série de pages ASP.NET pour implémenter les rubriques examinées dans ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="a4c23-135">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="a4c23-136">Nous allons créer ces pages, puis un fichier de plan de site `(Web.sitemap)`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-136">Let's create those pages and then a site map file `(Web.sitemap)`.</span></span>

<span data-ttu-id="a4c23-137">Commencez par créer un nouveau dossier dans le projet nommé `Membership`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-137">Start by creating a new folder in the project named `Membership`.</span></span> <span data-ttu-id="a4c23-138">Ensuite, ajoutez cinq nouvelles pages ASP.NET au dossier `Membership`, en liant chaque page à la page maître `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-138">Next, add five new ASP.NET pages to the `Membership` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="a4c23-139">Nommer les pages :</span><span class="sxs-lookup"><span data-stu-id="a4c23-139">Name the pages:</span></span>

- `CreatingUserAccounts.aspx`
- `UserBasedAuthorization.aspx`
- `EnhancedCreateUserWizard.aspx`
- `AdditionalUserInfo.aspx`
- `Guestbook.aspx`

<span data-ttu-id="a4c23-140">À ce stade, le Explorateur de solutions de votre projet doit ressembler à la capture d’écran illustrée à la figure 1.</span><span class="sxs-lookup"><span data-stu-id="a4c23-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="a4c23-141">[![cinq nouvelles pages ont été ajoutées au dossier d’appartenance](creating-user-accounts-vb/_static/image2.png)](creating-user-accounts-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-141">[![Five New Pages Have Been Added to the Membership Folder](creating-user-accounts-vb/_static/image2.png)](creating-user-accounts-vb/_static/image1.png)</span></span>

<span data-ttu-id="a4c23-142">**Figure 1**: Cinq nouvelles pages ont été ajoutées au dossier `Membership` ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-142">**Figure 1**: Five New Pages Have Been Added to the `Membership` Folder ([Click to view full-size image](creating-user-accounts-vb/_static/image3.png))</span></span>

<span data-ttu-id="a4c23-143">À ce stade, chaque page doit avoir les deux contrôles de contenu, un pour chaque ContentPlaceHolders : `MainContent` et `LoginContent`de la page maître.</span><span class="sxs-lookup"><span data-stu-id="a4c23-143">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample1.aspx)]

<span data-ttu-id="a4c23-144">N’oubliez pas que le balisage par défaut de `LoginContent` ContentPlaceHolder affiche un lien permettant d’ouvrir une session ou de se déconnecter du site, selon que l’utilisateur est authentifié ou non.</span><span class="sxs-lookup"><span data-stu-id="a4c23-144">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="a4c23-145">Toutefois, la présence du contrôle de contenu `Content2` remplace le balisage par défaut de la page maître.</span><span class="sxs-lookup"><span data-stu-id="a4c23-145">The presence of the `Content2` Content control, however, overrides the master page's default markup.</span></span> <span data-ttu-id="a4c23-146">Comme nous l’avons vu dans *<a id="_msoanchor_6"></a>[une vue d’ensemble du didacticiel sur l’authentification par formulaire](../introduction/an-overview-of-forms-authentication-vb.md)* , cela s’avère utile dans les pages où vous ne souhaitez pas afficher les options relatives à la connexion dans la colonne de gauche.</span><span class="sxs-lookup"><span data-stu-id="a4c23-146">As we discussed in *<a id="_msoanchor_6"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)* tutorial, this is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="a4c23-147">Toutefois, pour ces cinq pages, nous souhaitons afficher le balisage par défaut de la page maître pour le `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="a4c23-147">For these five pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="a4c23-148">Par conséquent, supprimez le balisage déclaratif pour le contrôle de contenu `Content2`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-148">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="a4c23-149">Après cela, chacun des balises de la page de cinq pages ne doit contenir qu’un seul contrôle de contenu.</span><span class="sxs-lookup"><span data-stu-id="a4c23-149">After doing so, each of the five page's markup should contain just one Content control.</span></span>

## <a name="step-2-creating-the-site-map"></a><span data-ttu-id="a4c23-150">Étape 2 : Création du plan de site</span><span class="sxs-lookup"><span data-stu-id="a4c23-150">Step 2: Creating the Site Map</span></span>

<span data-ttu-id="a4c23-151">Tous les sites Web, à l’exception des plus simples, doivent implémenter une forme d’interface utilisateur de navigation.</span><span class="sxs-lookup"><span data-stu-id="a4c23-151">All but the most trivial websites need to implement some form of a navigational user interface.</span></span> <span data-ttu-id="a4c23-152">L’interface utilisateur de navigation peut être une simple liste de liens vers les différentes sections du site.</span><span class="sxs-lookup"><span data-stu-id="a4c23-152">The navigation user interface may be a simple list of links to the various sections of the site.</span></span> <span data-ttu-id="a4c23-153">Ces liens peuvent également être organisés dans des menus ou des arborescences.</span><span class="sxs-lookup"><span data-stu-id="a4c23-153">Alternatively, these links may be arranged into menus or tree views.</span></span> <span data-ttu-id="a4c23-154">En tant que développeurs de pages, la création de l’interface utilisateur de navigation n’est que la moitié de l’histoire.</span><span class="sxs-lookup"><span data-stu-id="a4c23-154">As page developers, creating the navigational user interface is only half of the story.</span></span> <span data-ttu-id="a4c23-155">Nous avons également besoin d’un moyen de définir la structure logique du site dans un mode gérable et modifiable.</span><span class="sxs-lookup"><span data-stu-id="a4c23-155">We also need some means to define the site's logical structure in a maintainable and updateable fashion.</span></span> <span data-ttu-id="a4c23-156">À mesure que de nouvelles pages sont ajoutées ou que des pages existantes ont été supprimées, nous voulons être en mesure de mettre à jour une seule source, le plan du site, et les modifications sont reflétées dans l’interface utilisateur de navigation du site.</span><span class="sxs-lookup"><span data-stu-id="a4c23-156">As new pages are added or existing pages removed, we want to be able to update a single source - the site map - and have those modifications reflected across the site's navigational user interface.</span></span>

<span data-ttu-id="a4c23-157">Ces deux tâches, qui définissent le plan de site et implémentent une interface utilisateur de navigation basée sur le plan de site, sont faciles à accomplir grâce à l’infrastructure de plan de site et aux contrôles Web de navigation ajoutés à la version 2,0 de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4c23-157">These two tasks - defining the site map and implementing a navigational user interface based on the site map - are easy to accomplish thanks to the Site Map framework and the Navigation Web controls added in ASP.NET version 2.0.</span></span> <span data-ttu-id="a4c23-158">L’infrastructure de plan de site permet à un développeur de définir un plan de site, puis d’y accéder par le biais d’une API de programmation (la [classe`SiteMap`](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span><span class="sxs-lookup"><span data-stu-id="a4c23-158">The Site Map framework allows for a developer to define a site map and then to access it through a programmatic API (the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span></span> <span data-ttu-id="a4c23-159">Les contrôles Web de navigation intégrés incluent un [contrôle de menu](https://msdn.microsoft.com/library/bz09dy46.aspx), le [contrôle TreeView](https://msdn.microsoft.com/library/3eafky27.aspx)et le [contrôle SiteMapPath](https://msdn.microsoft.com/library/3eafky27.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4c23-159">The built-in Navigation Web controls include a [Menu control](https://msdn.microsoft.com/library/bz09dy46.aspx), the [TreeView control](https://msdn.microsoft.com/library/3eafky27.aspx), and the [SiteMapPath control](https://msdn.microsoft.com/library/3eafky27.aspx).</span></span>

<span data-ttu-id="a4c23-160">À l’instar des frameworks d’appartenance et de rôles, le Framework de plan de site est créé au-dessus du [modèle de fournisseur](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4c23-160">Like the Membership and Roles frameworks, the Site Map framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span></span> <span data-ttu-id="a4c23-161">La tâche de la classe de fournisseur de plan de site consiste à générer la structure en mémoire utilisée par la classe `SiteMap` à partir d’un magasin de données persistant, tel qu’un fichier XML ou une table de base de données.</span><span class="sxs-lookup"><span data-stu-id="a4c23-161">The job of the Site Map provider class is to generate the in-memory structure used by the `SiteMap` class from a persistent data store, such as an XML file or a database table.</span></span> <span data-ttu-id="a4c23-162">Le .NET Framework est fourni avec un fournisseur de plan de site par défaut qui lit les données de plan de site à partir d’un fichier XML ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), et il s’agit du fournisseur que nous allons utiliser dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="a4c23-162">The .NET Framework ships with a default Site Map provider that reads the site map data from an XML file ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), and this is the provider we will be using in this tutorial.</span></span> <span data-ttu-id="a4c23-163">Pour d’autres implémentations de fournisseur de plan de site, reportez-vous à la section lectures supplémentaires à la fin de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="a4c23-163">For some alternate Site Map provider implementations, refer to the Further Readings section at the end of this tutorial.</span></span>

<span data-ttu-id="a4c23-164">Le fournisseur de plan de site par défaut attend un fichier XML correctement mis en forme nommé `Web.sitemap` pour qu’il existe dans le répertoire racine.</span><span class="sxs-lookup"><span data-stu-id="a4c23-164">The default Site Map provider expects a properly-formatted XML file named `Web.sitemap` to exist the root directory.</span></span> <span data-ttu-id="a4c23-165">Étant donné que nous utilisons ce fournisseur par défaut, nous devons ajouter un fichier de ce type et définir la structure du plan de site dans le format XML approprié.</span><span class="sxs-lookup"><span data-stu-id="a4c23-165">Since we are using this default provider, we need to add such a file and define the site map's structure in the appropriate XML format.</span></span> <span data-ttu-id="a4c23-166">Pour ajouter le fichier, cliquez avec le bouton droit sur le nom du projet dans Explorateur de solutions et choisissez Ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="a4c23-166">To add the file, right-click on the project name in Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="a4c23-167">Dans la boîte de dialogue, choisissez d’ajouter un fichier de type plan du site nommé `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-167">From the dialog box, opt to add a file of type Site Map named `Web.sitemap`.</span></span>

<span data-ttu-id="a4c23-168">[![ajouter un fichier nommé Web. sitemap au répertoire racine du projet](creating-user-accounts-vb/_static/image5.png)](creating-user-accounts-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-168">[![Add a File Named Web.sitemap to the Project's Root Directory](creating-user-accounts-vb/_static/image5.png)](creating-user-accounts-vb/_static/image4.png)</span></span>

<span data-ttu-id="a4c23-169">**Figure 2**: Ajoutez un fichier nommé `Web.sitemap` au répertoire racine du projet ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-169">**Figure 2**: Add a File Named `Web.sitemap` to the Project's Root Directory ([Click to view full-size image](creating-user-accounts-vb/_static/image6.png))</span></span>

<span data-ttu-id="a4c23-170">Le fichier de plan de site XML définit la structure du site Web en tant que hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="a4c23-170">The XML site map file defines the website's structure as a hierarchy.</span></span> <span data-ttu-id="a4c23-171">Cette relation hiérarchique est modélisée dans le fichier XML via le ascendance des éléments de `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-171">This hierarchical relationship is modeled in the XML file via the ancestry of the `<siteMapNode>` elements.</span></span> <span data-ttu-id="a4c23-172">Le `Web.sitemap` doit commencer par un nœud parent `<siteMap>` qui a précisément un `<siteMapNode>` enfant.</span><span class="sxs-lookup"><span data-stu-id="a4c23-172">The `Web.sitemap` must start with a `<siteMap>` parent node that has precisely one `<siteMapNode>` child.</span></span> <span data-ttu-id="a4c23-173">Cet élément de `<siteMapNode>` de niveau supérieur représente la racine de la hiérarchie et peut avoir un nombre arbitraire de nœuds descendants.</span><span class="sxs-lookup"><span data-stu-id="a4c23-173">This top-level `<siteMapNode>` element represents the root of the hierarchy, and may have an arbitrary number of descendent nodes.</span></span> <span data-ttu-id="a4c23-174">Chaque élément `<siteMapNode>` doit inclure un attribut `title` et éventuellement inclure des attributs `url` et `description`, entre autres ; chaque attribut `url` non vide doit être unique.</span><span class="sxs-lookup"><span data-stu-id="a4c23-174">Each `<siteMapNode>` element must include a `title` attribute and may optionally include `url` and `description` attributes, among others; each non-empty `url` attribute must be unique.</span></span>

<span data-ttu-id="a4c23-175">Entrez le code XML suivant dans le fichier `Web.sitemap` :</span><span class="sxs-lookup"><span data-stu-id="a4c23-175">Enter the following XML into the `Web.sitemap` file:</span></span>

[!code-xml[Main](creating-user-accounts-vb/samples/sample2.xml)]

<span data-ttu-id="a4c23-176">Le balisage de plan de site ci-dessus définit la hiérarchie illustrée à la figure 3.</span><span class="sxs-lookup"><span data-stu-id="a4c23-176">The above site map markup defines the hierarchy shown in Figure 3.</span></span>

<span data-ttu-id="a4c23-177">[![le plan de site représente une structure de navigation hiérarchique](creating-user-accounts-vb/_static/image8.png)](creating-user-accounts-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-177">[![The Site Map Represents a Hierarchical Navigational Structure](creating-user-accounts-vb/_static/image8.png)](creating-user-accounts-vb/_static/image7.png)</span></span>

<span data-ttu-id="a4c23-178">**Figure 3**: Le plan de site représente une structure de navigation hiérarchique ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-178">**Figure 3**: The Site Map Represents a Hierarchical Navigational Structure ([Click to view full-size image](creating-user-accounts-vb/_static/image9.png))</span></span>

## <a name="step-3-updating-the-master-page-to-include-a-navigational-user-interface"></a><span data-ttu-id="a4c23-179">Étape 3 : Mise à jour de la page maître pour inclure une interface utilisateur de navigation</span><span class="sxs-lookup"><span data-stu-id="a4c23-179">Step 3: Updating the Master Page to Include a Navigational User Interface</span></span>

<span data-ttu-id="a4c23-180">ASP.NET comprend un certain nombre de contrôles Web relatifs à la navigation pour la conception d’une interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-180">ASP.NET includes a number of navigation-related Web controls for designing a user interface.</span></span> <span data-ttu-id="a4c23-181">Celles-ci incluent les contrôles menu, TreeView et SiteMapPath.</span><span class="sxs-lookup"><span data-stu-id="a4c23-181">These include the Menu, TreeView, and the SiteMapPath controls.</span></span> <span data-ttu-id="a4c23-182">Les contrôles menu et TreeView affichent la structure de plan de site dans un menu ou une arborescence, respectivement, tandis que SiteMapPath affiche un fil d’Ariane qui montre le nœud actuel visité ainsi que ses ancêtres.</span><span class="sxs-lookup"><span data-stu-id="a4c23-182">The Menu and TreeView controls render the site map structure in a menu or a tree, respectively, whereas the SiteMapPath displays a breadcrumb that shows the current node being visited as well as its ancestors.</span></span> <span data-ttu-id="a4c23-183">Les données de plan de site peuvent être liées à d’autres contrôles Web de données à l’aide du SiteMapDataSource et sont accessibles par programme par le biais de la classe `SiteMap`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-183">The site map data can be bound to other data Web controls using the SiteMapDataSource and can be accessed programmatically via the `SiteMap` class.</span></span>

<span data-ttu-id="a4c23-184">Dans la mesure où une présentation approfondie de l’infrastructure de plan de site et des contrôles de navigation dépasse le cadre de cette série de didacticiels, plutôt que de consacrer du temps à la création de notre propre interface utilisateur de navigation, nous allons emprunter celle utilisée dans la série de didacticiels *[utilisation de données dans ASP.NET 2,0](../../data-access/index.md)* , qui utilise un contrôle Repeater pour afficher une liste à puces en deux points,</span><span class="sxs-lookup"><span data-stu-id="a4c23-184">Since a thorough discussion of the Site Map framework and the Navigation controls is beyond the scope of this tutorial series, rather than spend time crafting our own navigational user interface let's instead borrow the one used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series, which uses a Repeater control to display a two-deep bulleted list of navigation links, as shown in Figure 4.</span></span>

### <a name="adding-a-two-level-list-of-links-in-the-left-column"></a><span data-ttu-id="a4c23-185">Ajout d’une liste de liens à deux niveaux dans la colonne de gauche</span><span class="sxs-lookup"><span data-stu-id="a4c23-185">Adding a Two-Level List of Links in the Left Column</span></span>

<span data-ttu-id="a4c23-186">Pour créer cette interface, ajoutez la balise déclarative suivante à la colonne de gauche de la page maître `Site.master` où le texte est TODO : Le menu s’affiche... réside actuellement.</span><span class="sxs-lookup"><span data-stu-id="a4c23-186">To create this interface, add the following declarative markup to the `Site.master` master page's left column where the text TODO: Menu will go here... currently resides.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample3.aspx)]

<span data-ttu-id="a4c23-187">Le balisage ci-dessus lie un contrôle Repeater nommé `menu` à un SiteMapDataSource, qui retourne la hiérarchie de plan de site définie dans `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-187">The above markup binds a Repeater control named `menu` to a SiteMapDataSource, which returns the site map hierarchy defined in `Web.sitemap`.</span></span> <span data-ttu-id="a4c23-188">Dans la mesure où la [propriété`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) du contrôle SiteMapDataSource est définie sur false, elle commence à retourner la hiérarchie du plan de site en commençant par les descendants du nœud de base.</span><span class="sxs-lookup"><span data-stu-id="a4c23-188">Since the SiteMapDataSource control's [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) is set to False it starts returning the site map's hierarchy starting with the descendents of the Home node.</span></span> <span data-ttu-id="a4c23-189">Le Repeater affiche chacun de ces nœuds (actuellement uniquement l’appartenance) dans un élément `<li>`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-189">The Repeater displays each of these nodes (currently just Membership ) in an `<li>` element.</span></span> <span data-ttu-id="a4c23-190">Un autre répéteur interne affiche ensuite les enfants du nœud actuel dans une liste non triée imbriquée.</span><span class="sxs-lookup"><span data-stu-id="a4c23-190">Another, inner Repeater then displays the current node's children in a nested unordered list.</span></span>

<span data-ttu-id="a4c23-191">La figure 4 illustre la sortie rendue du balisage ci-dessus avec la structure de plan de site créée à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="a4c23-191">Figure 4 shows the above markup's rendered output with the site map structure we created in Step 2.</span></span> <span data-ttu-id="a4c23-192">Le Repeater restitue le balisage de liste non triée vanille ; les règles de feuille de style en cascade définies dans `Styles.css` sont responsables de la disposition esthétiquement agréable.</span><span class="sxs-lookup"><span data-stu-id="a4c23-192">The Repeater renders vanilla unordered list markup; the cascading style sheet rules defined in `Styles.css` are responsible for the aesthetically-pleasing layout.</span></span> <span data-ttu-id="a4c23-193">Pour obtenir une description plus détaillée du fonctionnement du balisage ci-dessus, reportez-vous au didacticiel sur les [pages maîtres et la navigation](https://asp.net/learn/data-access/tutorial-03-vb.aspx) dans les sites.</span><span class="sxs-lookup"><span data-stu-id="a4c23-193">For a more detailed description of how the above markup works, refer to the [Master Pages and Site Navigation](https://asp.net/learn/data-access/tutorial-03-vb.aspx) tutorial.</span></span>

<span data-ttu-id="a4c23-194">[![l’interface utilisateur de navigation est rendue à l’aide de listes non triées imbriquées](creating-user-accounts-vb/_static/image11.png)](creating-user-accounts-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-194">[![The Navigational User Interface is Rendered Using Nested Unordered Lists](creating-user-accounts-vb/_static/image11.png)](creating-user-accounts-vb/_static/image10.png)</span></span>

<span data-ttu-id="a4c23-195">**Figure 4**: L’interface utilisateur de navigation est rendue à l’aide de listes imbriquées non triées ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-195">**Figure 4**: The Navigational User Interface is Rendered Using Nested Unordered Lists ([Click to view full-size image](creating-user-accounts-vb/_static/image12.png))</span></span>

### <a name="adding-breadcrumb-navigation"></a><span data-ttu-id="a4c23-196">Ajout d’une navigation de navigation</span><span class="sxs-lookup"><span data-stu-id="a4c23-196">Adding Breadcrumb Navigation</span></span>

<span data-ttu-id="a4c23-197">En plus de la liste de liens dans la colonne de gauche, nous avons également chaque page qui affiche un [fil d’Ariane](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span><span class="sxs-lookup"><span data-stu-id="a4c23-197">In addition to the list of links in the left column, let's also have each page display a [breadcrumb](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span></span> <span data-ttu-id="a4c23-198">Un fil d’Ariane est un élément d’interface utilisateur de navigation qui affiche rapidement les utilisateurs à leur position actuelle dans la hiérarchie de site.</span><span class="sxs-lookup"><span data-stu-id="a4c23-198">A breadcrumb is a navigational user interface element that quickly shows users their current position within the site hierarchy.</span></span> <span data-ttu-id="a4c23-199">Le contrôle SiteMapPath utilise l’infrastructure de plan de site pour déterminer l’emplacement de la page actuelle dans le plan de site, puis affiche un fil d’Ariane sur la base de ces informations.</span><span class="sxs-lookup"><span data-stu-id="a4c23-199">The SiteMapPath control uses the Site Map framework to determine the current page's location in the site map and then displays a breadcrumb based on this information.</span></span>

<span data-ttu-id="a4c23-200">En particulier, ajoutez un élément `<span>` à l’élément d’en-tête `<div>` de la page maître et définissez l’attribut `class` de l’élément `<span>` sur Breadcrumb.</span><span class="sxs-lookup"><span data-stu-id="a4c23-200">Specifically, add a `<span>` element to the master page's header `<div>` element, and set the new `<span>` element's `class` attribute to breadcrumb.</span></span> <span data-ttu-id="a4c23-201">(La classe `Styles.css` contient une règle pour une classe Breadcrumb.) Ensuite, ajoutez un SiteMapPath à ce nouvel élément `<span>`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-201">(The `Styles.css` class contains a rule for a breadcrumb class.) Next, add a SiteMapPath to this new `<span>` element.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample4.aspx)]

<span data-ttu-id="a4c23-202">La figure 5 illustre la sortie du SiteMapPath lorsque vous vous rendez `~/Membership/CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-202">Figure 5 shows the output of the SiteMapPath when visiting `~/Membership/CreatingUserAccounts.aspx`.</span></span>

<span data-ttu-id="a4c23-203">[![le Breadcrumb affiche la page actuelle et ses ancêtres dans le plan du site](creating-user-accounts-vb/_static/image14.png)](creating-user-accounts-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-203">[![The Breadcrumb Displays the Current Page and its Ancestors in the Site Map](creating-user-accounts-vb/_static/image14.png)](creating-user-accounts-vb/_static/image13.png)</span></span>

<span data-ttu-id="a4c23-204">**Figure 5**: Le Breadcrumb affiche la page actuelle et ses ancêtres dans le plan du site ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-204">**Figure 5**: The Breadcrumb Displays the Current Page and its Ancestors in the Site Map ([Click to view full-size image](creating-user-accounts-vb/_static/image15.png))</span></span>

## <a name="step-4-removing-the-custom-principal-and-identity-logic"></a><span data-ttu-id="a4c23-205">Étape 4 : Suppression de la logique d’identité et du principal personnalisé</span><span class="sxs-lookup"><span data-stu-id="a4c23-205">Step 4: Removing the Custom Principal and Identity Logic</span></span>

<span data-ttu-id="a4c23-206">Dans le didacticiel sur la *<a id="_msoanchor_7"></a>[configuration de l’authentification par formulaire et les rubriques avancées](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* , nous avons vu comment associer des objets principal et Identity personnalisés à l’utilisateur authentifié.</span><span class="sxs-lookup"><span data-stu-id="a4c23-206">In the *<a id="_msoanchor_7"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* tutorial we saw how to associate custom principal and identity objects to the authenticated user.</span></span> <span data-ttu-id="a4c23-207">Pour ce faire, nous avons créé un gestionnaire d’événements dans `Global.asax` pour l’événement `PostAuthenticateRequest` de l’application, qui se déclenche après que le `FormsAuthenticationModule` a authentifié l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-207">We accomplished this by creating an event handler in `Global.asax` for the application's `PostAuthenticateRequest` event, which fires after the `FormsAuthenticationModule` has authenticated the user.</span></span> <span data-ttu-id="a4c23-208">Dans ce gestionnaire d’événements, nous avons remplacé les objets `GenericPrincipal` et `FormsIdentity` ajoutés par le `FormsAuthenticationModule` par les objets `CustomPrincipal` et `CustomIdentity` que nous avons créés dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="a4c23-208">In this event handler we replaced the `GenericPrincipal` and `FormsIdentity` objects added by the `FormsAuthenticationModule` with the `CustomPrincipal` and `CustomIdentity` objects we created in that tutorial.</span></span>

<span data-ttu-id="a4c23-209">Bien que les objets principal et Identity personnalisés soient utiles dans certains scénarios, dans la plupart des cas, les objets `GenericPrincipal` et `FormsIdentity` sont suffisants.</span><span class="sxs-lookup"><span data-stu-id="a4c23-209">While custom principal and identity objects are useful in certain scenarios, in most cases the `GenericPrincipal` and `FormsIdentity` objects are sufficient.</span></span> <span data-ttu-id="a4c23-210">Par conséquent, je pense qu’il serait utile de revenir au comportement par défaut.</span><span class="sxs-lookup"><span data-stu-id="a4c23-210">Consequently, I think it would be worthwhile to return to the default behavior.</span></span> <span data-ttu-id="a4c23-211">Apportez cette modification en supprimant ou en commentant le gestionnaire d’événements `PostAuthenticateRequest` ou en supprimant entièrement le fichier `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-211">Make this change by either removing or commenting out the `PostAuthenticateRequest` event handler or by deleting the `Global.asax` file entirely.</span></span>

> [!NOTE]
> <span data-ttu-id="a4c23-212">Une fois que vous avez mis en commentaire ou supprimé le code dans `Global.asax`, vous devez commenter le code dans `Default.aspx's` classe code-behind qui effectue un cast de la propriété `User.Identity` en une instance `CustomIdentity`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-212">Once you've commented or removed the code in `Global.asax`, you will need to comment out the code in `Default.aspx's` code-behind class that casts the `User.Identity` property to a `CustomIdentity` instance.</span></span>

## <a name="step-5-programmatically-creating-a-new-user"></a><span data-ttu-id="a4c23-213">Étape 5 : Création d’un nouvel utilisateur par programmation</span><span class="sxs-lookup"><span data-stu-id="a4c23-213">Step 5: Programmatically Creating a New User</span></span>

<span data-ttu-id="a4c23-214">Pour créer un nouveau compte d’utilisateur par le biais de l’infrastructure d’appartenance, utilisez la [méthode`CreateUser`](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx)de la classe `Membership`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-214">To create a new user account through the Membership framework use the `Membership` class's [`CreateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx).</span></span> <span data-ttu-id="a4c23-215">Cette méthode a des paramètres d’entrée pour le nom d’utilisateur, le mot de passe et d’autres champs liés à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-215">This method has input parameters for the username, password, and other user-related fields.</span></span> <span data-ttu-id="a4c23-216">Lors de l’appel, il délègue la création du nouveau compte d’utilisateur au fournisseur d’appartenances configuré, puis retourne un [objet`MembershipUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) représentant le compte d’utilisateur créé juste.</span><span class="sxs-lookup"><span data-stu-id="a4c23-216">On invocation, it delegates the creation of the new user account to the configured Membership provider and then returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) representing the just-created user account.</span></span>

<span data-ttu-id="a4c23-217">La méthode `CreateUser` a quatre surcharges, chacune acceptant un nombre différent de paramètres d’entrée :</span><span class="sxs-lookup"><span data-stu-id="a4c23-217">The `CreateUser` method has four overloads, each accepting a different number of input parameters:</span></span>

- [`CreateUser(username, password)`](https://msdn.microsoft.com/library/d8t4h2es.aspx)
- [`CreateUser(username, password, email)`](https://msdn.microsoft.com/library/t8yy6w3h.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, MembershipCreateStatus)`](https://msdn.microsoft.com/library/82xx2e62.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, MembershipCreateStatus)`](https://msdn.microsoft.com/library/ms152012.aspx)

<span data-ttu-id="a4c23-218">Ces quatre surcharges diffèrent de la quantité d’informations collectées.</span><span class="sxs-lookup"><span data-stu-id="a4c23-218">These four overloads differ on the amount of information that is collected.</span></span> <span data-ttu-id="a4c23-219">La première surcharge, par exemple, nécessite simplement le nom d’utilisateur et le mot de passe du nouveau compte d’utilisateur, tandis que la deuxième nécessite également l’adresse de messagerie de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-219">The first overload, for example, requires just the username and password for the new user account, whereas the second one also requires the user's email address.</span></span>

<span data-ttu-id="a4c23-220">Ces surcharges existent parce que les informations nécessaires à la création d’un nouveau compte d’utilisateur dépendent des paramètres de configuration du fournisseur d’appartenances.</span><span class="sxs-lookup"><span data-stu-id="a4c23-220">These overloads exist because the information needed to create a new user account depends on the Membership provider's configuration settings.</span></span> <span data-ttu-id="a4c23-221">Dans le didacticiel *<a id="_msoanchor_8"></a>[Création du schéma d’appartenance dans SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* , nous avons examiné la spécification des paramètres de configuration du fournisseur d’appartenance dans `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-221">In the *<a id="_msoanchor_8"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial we examined specifying Membership provider configuration settings in `Web.config`.</span></span> <span data-ttu-id="a4c23-222">Le tableau 2 inclut une liste complète des paramètres de configuration.</span><span class="sxs-lookup"><span data-stu-id="a4c23-222">Table 2 included a complete list of the configuration settings.</span></span>

<span data-ttu-id="a4c23-223">L’un des paramètres de configuration de ce fournisseur d’appartenances ayant un impact sur les surcharges de `CreateUser` peut être utilisé est le paramètre `requiresQuestionAndAnswer`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-223">One such Membership provider configuration setting that impacts what `CreateUser` overloads may be used is the `requiresQuestionAndAnswer` setting.</span></span> <span data-ttu-id="a4c23-224">Si `requiresQuestionAndAnswer` est défini sur `true` (valeur par défaut), lorsque vous créez un nouveau compte d’utilisateur, nous devons spécifier une question et une réponse de sécurité.</span><span class="sxs-lookup"><span data-stu-id="a4c23-224">If `requiresQuestionAndAnswer` is set to `true` (the default), then when creating a new user account we must specify a security question and answer.</span></span> <span data-ttu-id="a4c23-225">Ces informations sont utilisées ultérieurement si l’utilisateur doit réinitialiser ou modifier son mot de passe.</span><span class="sxs-lookup"><span data-stu-id="a4c23-225">This information is later used if the user needs to reset or change their password.</span></span> <span data-ttu-id="a4c23-226">Plus précisément, à ce moment-là, la question de sécurité s’affiche et les utilisateurs doivent entrer la bonne réponse pour réinitialiser ou modifier leur mot de passe.</span><span class="sxs-lookup"><span data-stu-id="a4c23-226">Specifically, at that time they are shown the security question and they must enter the correct answer in order to reset or change their password.</span></span> <span data-ttu-id="a4c23-227">Par conséquent, si le `requiresQuestionAndAnswer` a la valeur `true` alors l’appel de l’une des deux premières surcharges `CreateUser` entraîne une exception, car la question de sécurité et la réponse sont manquantes.</span><span class="sxs-lookup"><span data-stu-id="a4c23-227">Consequently, if the `requiresQuestionAndAnswer` is set to `true` then calling either of the first two `CreateUser` overloads results in an exception because the security question and answer are missing.</span></span> <span data-ttu-id="a4c23-228">Étant donné que notre application est actuellement configurée pour exiger une question et une réponse de sécurité, nous devons utiliser l’une des deux surcharges lors de la création par programme de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-228">Since our application is currently configured to require a security question and answer, we will need to use one of the latter two overloads when creating user's programmatically.</span></span>

<span data-ttu-id="a4c23-229">Pour illustrer l’utilisation de la méthode `CreateUser`, nous allons créer une interface utilisateur qui invite l’utilisateur à entrer son nom, son mot de passe, son adresse de messagerie et une réponse à une question de sécurité prédéfinie.</span><span class="sxs-lookup"><span data-stu-id="a4c23-229">To illustrate using the `CreateUser` method, let's create a user interface where we prompt the user for their name, password, email, and an answer to a pre-defined security question.</span></span> <span data-ttu-id="a4c23-230">Ouvrez la page `CreatingUserAccounts.aspx` dans le dossier `Membership` et ajoutez les contrôles Web suivants au contrôle de contenu :</span><span class="sxs-lookup"><span data-stu-id="a4c23-230">Open the `CreatingUserAccounts.aspx` page in the `Membership` folder and add the following Web controls to the Content control:</span></span>

- <span data-ttu-id="a4c23-231">Une zone de texte nommée `Username`</span><span class="sxs-lookup"><span data-stu-id="a4c23-231">A TextBox named `Username`</span></span>
- <span data-ttu-id="a4c23-232">Une zone de texte nommée `Password`, dont la propriété `TextMode` a la valeur `Password`</span><span class="sxs-lookup"><span data-stu-id="a4c23-232">A TextBox named `Password`, whose `TextMode` property is set to `Password`</span></span>
- <span data-ttu-id="a4c23-233">Une zone de texte nommée `Email`</span><span class="sxs-lookup"><span data-stu-id="a4c23-233">A TextBox named `Email`</span></span>
- <span data-ttu-id="a4c23-234">Une étiquette nommée `SecurityQuestion` avec sa propriété `Text` supprimée</span><span class="sxs-lookup"><span data-stu-id="a4c23-234">A Label named `SecurityQuestion` with its `Text` property cleared out</span></span>
- <span data-ttu-id="a4c23-235">Une zone de texte nommée `SecurityAnswer`</span><span class="sxs-lookup"><span data-stu-id="a4c23-235">A TextBox named `SecurityAnswer`</span></span>
- <span data-ttu-id="a4c23-236">Un bouton nommé `CreateAccountButton` dont la propriété `Text` est définie pour créer le compte d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="a4c23-236">A Button named `CreateAccountButton` whose `Text` property is set to Create the User Account</span></span>
- <span data-ttu-id="a4c23-237">Contrôle Label nommé `CreateAccountResults` avec sa propriété `Text` supprimée</span><span class="sxs-lookup"><span data-stu-id="a4c23-237">A Label control named `CreateAccountResults` with its `Text` property cleared out</span></span>

<span data-ttu-id="a4c23-238">À ce stade, votre écran doit ressembler à la capture d’écran illustrée à la figure 6.</span><span class="sxs-lookup"><span data-stu-id="a4c23-238">At this point your screen should look similar to the screen shot shown in Figure 6.</span></span>

<span data-ttu-id="a4c23-239">[![ajouter les différents contrôles Web à la page CreatingUserAccounts. aspx](creating-user-accounts-vb/_static/image17.png)](creating-user-accounts-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-239">[![Add the Various Web Controls to the CreatingUserAccounts.aspx Page](creating-user-accounts-vb/_static/image17.png)](creating-user-accounts-vb/_static/image16.png)</span></span>

<span data-ttu-id="a4c23-240">**Figure 6**: Ajouter les différents contrôles Web au `CreatingUserAccounts.aspx Page` ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-240">**Figure 6**: Add the Various Web Controls to the `CreatingUserAccounts.aspx Page` ([Click to view full-size image](creating-user-accounts-vb/_static/image18.png))</span></span>

<span data-ttu-id="a4c23-241">Les `SecurityQuestion` étiquette et `SecurityAnswer` zone de texte sont destinées à afficher une question de sécurité prédéfinie et à collecter la réponse de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-241">The `SecurityQuestion` Label and `SecurityAnswer` TextBox are intended to display a pre-defined security question and collect the user's answer.</span></span> <span data-ttu-id="a4c23-242">Notez que la question de sécurité et la réponse sont stockées par utilisateur, par conséquent, il est possible d’autoriser chaque utilisateur à définir sa propre question de sécurité.</span><span class="sxs-lookup"><span data-stu-id="a4c23-242">Note that both the security question and answer are stored on a user-by-user basis, so it is possible to allow each user to define their own security question.</span></span> <span data-ttu-id="a4c23-243">Toutefois, pour cet exemple, j’ai décidé d’utiliser une question de sécurité universelle, à savoir : Quelle est votre couleur préférée ?</span><span class="sxs-lookup"><span data-stu-id="a4c23-243">However, for this example I have decided to use a universal security question, namely: What is your favorite color?</span></span>

<span data-ttu-id="a4c23-244">Pour implémenter cette question de sécurité prédéfinie, ajoutez une constante à la classe code-behind de la page nommée `passwordQuestion`, en lui assignant la question de sécurité.</span><span class="sxs-lookup"><span data-stu-id="a4c23-244">To implement this pre-defined security question, add a constant to the page's code-behind class named `passwordQuestion`, assigning it the security question.</span></span> <span data-ttu-id="a4c23-245">Ensuite, dans le gestionnaire d’événements `Page_Load`, assignez cette constante à la propriété `Text` de l’étiquette `SecurityQuestion` :</span><span class="sxs-lookup"><span data-stu-id="a4c23-245">Then, in the `Page_Load` event handler, assign this constant to the `SecurityQuestion` Label's `Text` property:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample5.vb)]

<span data-ttu-id="a4c23-246">Ensuite, créez un gestionnaire d’événements pour l’événement `CreateAccountButton'` s `Click` et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="a4c23-246">Next, create an event handler for the `CreateAccountButton'` s `Click` event and add the following code:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample6.vb)]

<span data-ttu-id="a4c23-247">Le gestionnaire d’événements `Click` commence par la définition d’une variable nommée `createStatus` de type [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4c23-247">The `Click` event handler starts by defining a variable named `createStatus` of type [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span></span> <span data-ttu-id="a4c23-248">`MembershipCreateStatus` est une énumération qui indique l’état de l’opération de `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-248">`MembershipCreateStatus` is an enumeration that indicates the status of the `CreateUser` operation.</span></span> <span data-ttu-id="a4c23-249">Par exemple, si le compte d’utilisateur est créé avec succès, l’instance de `MembershipCreateStatus` résultante est définie sur une valeur de `Success;` en revanche, si l’opération échoue parce qu’il existe déjà un utilisateur avec le même nom d’utilisateur, elle est définie sur la valeur `DuplicateUserName`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-249">For example, if the user account is created successfully, the resulting `MembershipCreateStatus` instance will be set to a value of `Success;` on the other hand, if the operation fails because there already exists a user with the same username, it will be set to a value of `DuplicateUserName`.</span></span> <span data-ttu-id="a4c23-250">Dans la `CreateUser` surcharge que nous utilisons, nous devons passer une instance `MembershipCreateStatus` dans la méthode.</span><span class="sxs-lookup"><span data-stu-id="a4c23-250">In the `CreateUser` overload we use, we need to pass a `MembershipCreateStatus` instance into the method.</span></span> <span data-ttu-id="a4c23-251">Ce paramètre est défini sur la valeur appropriée dans la méthode `CreateUser`, et nous pouvons examiner sa valeur après l’appel de la méthode pour déterminer si le compte d’utilisateur a été créé avec succès.</span><span class="sxs-lookup"><span data-stu-id="a4c23-251">This parameter is set to the appropriate value within the `CreateUser` method, and we can examine its value after the method call to determine whether the user account was successfully created.</span></span>

<span data-ttu-id="a4c23-252">Après l’appel de `CreateUser`, en passant `createStatus`, une instruction `Select Case` est utilisée pour générer un message approprié en fonction de la valeur assignée à `createStatus`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-252">After calling `CreateUser`, passing in `createStatus`, a `Select Case` statement is used to output an appropriate message depending on the value assigned to `createStatus`.</span></span> <span data-ttu-id="a4c23-253">Les figures 7 affichent la sortie lorsqu’un nouvel utilisateur a été créé avec succès.</span><span class="sxs-lookup"><span data-stu-id="a4c23-253">Figures 7 shows the output when a new user has successfully been created.</span></span> <span data-ttu-id="a4c23-254">Les figures 8 et 9 affichent la sortie lorsque le compte d’utilisateur n’est pas créé.</span><span class="sxs-lookup"><span data-stu-id="a4c23-254">Figures 8 and 9 show the output when the user account is not created.</span></span> <span data-ttu-id="a4c23-255">Dans la figure 8, le visiteur a entré un mot de passe de cinq lettres, qui ne répond pas aux exigences de la force de mot de passe dans les paramètres de configuration du fournisseur d’appartenances.</span><span class="sxs-lookup"><span data-stu-id="a4c23-255">In Figure 8, the visitor entered a five-letter password, which does not meet the password strength requirements spelled out in the Membership provider's configuration settings.</span></span> <span data-ttu-id="a4c23-256">Dans la figure 9, le visiteur tente de créer un compte d’utilisateur avec un nom d’utilisateur existant (celui créé à la figure 7).</span><span class="sxs-lookup"><span data-stu-id="a4c23-256">In Figure 9, the visitor is attempting to create a user account with an existing username (the one created in Figure 7).</span></span>

<span data-ttu-id="a4c23-257">[![un nouveau compte d’utilisateur a été créé](creating-user-accounts-vb/_static/image20.png)](creating-user-accounts-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-257">[![A New User Account is Successfully Created](creating-user-accounts-vb/_static/image20.png)](creating-user-accounts-vb/_static/image19.png)</span></span>

<span data-ttu-id="a4c23-258">**Figure 7**: Un nouveau compte d’utilisateur a été créé avec succès ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-258">**Figure 7**: A New User Account is Successfully Created  ([Click to view full-size image](creating-user-accounts-vb/_static/image21.png))</span></span>

<span data-ttu-id="a4c23-259">[![le compte d’utilisateur n’est pas créé, car le mot de passe fourni est trop faible](creating-user-accounts-vb/_static/image23.png)](creating-user-accounts-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-259">[![The User Account is Not Created Because the Supplied Password is Too Weak](creating-user-accounts-vb/_static/image23.png)](creating-user-accounts-vb/_static/image22.png)</span></span>

<span data-ttu-id="a4c23-260">**Figure 8**: Le compte d’utilisateur n’a pas été créé, car le mot de passe fourni est trop faible ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-260">**Figure 8**: The User Account is Not Created Because the Supplied Password is Too Weak ([Click to view full-size image](creating-user-accounts-vb/_static/image24.png))</span></span>

<span data-ttu-id="a4c23-261">[![le compte d’utilisateur n’est pas créé, car le nom d’utilisateur est déjà utilisé](creating-user-accounts-vb/_static/image26.png)](creating-user-accounts-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-261">[![The User Account is Not Created Because the Username is Already in Use](creating-user-accounts-vb/_static/image26.png)](creating-user-accounts-vb/_static/image25.png)</span></span>

<span data-ttu-id="a4c23-262">**Figure 9**: Le compte d’utilisateur n’est pas créé, car le nom d’utilisateur est déjà utilisé ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-262">**Figure 9**: The User Account is Not Created Because the Username is Already in Use ([Click to view full-size image](creating-user-accounts-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="a4c23-263">Vous vous demandez peut-être comment déterminer la réussite ou l’échec lors de l’utilisation de l’une des deux premières surcharges de méthode `CreateUser`, qui ne possèdent pas de paramètre de type `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-263">You may be wondering how to determine success or failure when using one of the first two `CreateUser` method overloads, neither of which has a parameter of type `MembershipCreateStatus`.</span></span> <span data-ttu-id="a4c23-264">Ces deux premières surcharges lèvent une [exception`MembershipCreateUserException`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) en cas d’échec, qui comprend une [propriété`StatusCode`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) de type `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-264">These first two overloads throw a [`MembershipCreateUserException` exception](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) in the face of a failure, which includes a [`StatusCode` property](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) of type `MembershipCreateStatus`.</span></span>

<span data-ttu-id="a4c23-265">Après avoir créé quelques comptes d’utilisateur, vérifiez que les comptes ont été créés en répertoriant le contenu des tables `aspnet_Users` et `aspnet_Membership` dans la base de données `SecurityTutorials.mdf`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-265">After creating a few user accounts, verify that the accounts have been created by listing the contents of the `aspnet_Users` and `aspnet_Membership` tables in the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="a4c23-266">Comme le montre la figure 10, j’ai ajouté deux utilisateurs via la page `CreatingUserAccounts.aspx` : Tito et Bruce.</span><span class="sxs-lookup"><span data-stu-id="a4c23-266">As Figure 10 shows, I have added two users via the `CreatingUserAccounts.aspx` page: Tito and Bruce.</span></span>

<span data-ttu-id="a4c23-267">[![deux utilisateurs se trouvent dans le magasin de l’utilisateur d’appartenance : Tito et Bruce](creating-user-accounts-vb/_static/image29.png)](creating-user-accounts-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-267">[![There are Two Users in the Membership User Store: Tito and Bruce](creating-user-accounts-vb/_static/image29.png)](creating-user-accounts-vb/_static/image28.png)</span></span>

<span data-ttu-id="a4c23-268">**Figure 10**: Il y a deux utilisateurs dans le magasin d’utilisateurs d’appartenance : Tito et Bruce ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-268">**Figure 10**: There are Two Users in the Membership User Store: Tito and Bruce ([Click to view full-size image](creating-user-accounts-vb/_static/image30.png))</span></span>

<span data-ttu-id="a4c23-269">Alors que le magasin de l’utilisateur d’appartenance comprend désormais les informations de compte Bruce et Tito, nous n’avons pas encore implémenté les fonctionnalités permettant à Bruce ou Tito de se connecter au site.</span><span class="sxs-lookup"><span data-stu-id="a4c23-269">While the Membership user store now includes Bruce and Tito's account information, we have yet to implement functionality that allows for Bruce or Tito to log on to the site.</span></span> <span data-ttu-id="a4c23-270">Actuellement, `Login.aspx` valide les informations d’identification de l’utilisateur par rapport à un ensemble codé en dur de paires nom d’utilisateur/mot de passe. il ne valide *pas* les informations d’identification fournies par rapport à l’infrastructure d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="a4c23-270">Currently, `Login.aspx` validates the user's credentials against a hard-coded set of username/password pairs - it does *not* validate the supplied credentials against the Membership framework.</span></span> <span data-ttu-id="a4c23-271">Pour l’instant, l’affichage des nouveaux comptes d’utilisateur dans les tables `aspnet_Users` et `aspnet_Membership` doit suffire.</span><span class="sxs-lookup"><span data-stu-id="a4c23-271">For now seeing the new user accounts in the `aspnet_Users` and `aspnet_Membership` tables will have to suffice.</span></span> <span data-ttu-id="a4c23-272">Dans le tutoriel suivant, *<a id="_msoanchor_9"></a>[Validation des informations d’identification de l’utilisateur auprès du magasin de l’utilisateur d’appartenance](validating-user-credentials-against-the-membership-user-store-vb.md)* , nous allons mettre à jour la page de connexion pour effectuer une validation auprès du magasin d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="a4c23-272">In the next tutorial, *<a id="_msoanchor_9"></a>[Validating User Credentials Against the Membership User Store](validating-user-credentials-against-the-membership-user-store-vb.md)*, we will update the login page to validate against the Membership store.</span></span>

> [!NOTE]
> <span data-ttu-id="a4c23-273">Si vous ne voyez aucun utilisateur dans votre base de données `SecurityTutorials.mdf`, cela peut être dû au fait que votre application Web utilise le fournisseur d’appartenances par défaut, `AspNetSqlMembershipProvider`, qui utilise la base de données `ASPNETDB.mdf` comme magasin de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-273">If you do not see any users in your `SecurityTutorials.mdf` database, it may be because your web application is using the default Membership provider, `AspNetSqlMembershipProvider`, which uses the `ASPNETDB.mdf` database as its user store.</span></span> <span data-ttu-id="a4c23-274">Pour déterminer s’il s’agit du problème, cliquez sur le bouton Actualiser dans la Explorateur de solutions.</span><span class="sxs-lookup"><span data-stu-id="a4c23-274">To determine if this is the problem, click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="a4c23-275">Si une base de données nommée `ASPNETDB.mdf` a été ajoutée au dossier `App_Data`, c’est le problème.</span><span class="sxs-lookup"><span data-stu-id="a4c23-275">If a database named `ASPNETDB.mdf` has been added to the `App_Data` folder, this is the problem.</span></span> <span data-ttu-id="a4c23-276">Revenez à l'étape 4 du tutoriel *<a id="_msoanchor_10"></a>[Création du schéma d’appartenance dans SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* pour obtenir des instructions sur la façon de configurer correctement le fournisseur d’appartenances.</span><span class="sxs-lookup"><span data-stu-id="a4c23-276">Return to Step 4 of the *<a id="_msoanchor_10"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial for instructions on how to properly configure the Membership provider.</span></span>

<span data-ttu-id="a4c23-277">Dans la plupart des scénarios de création de compte d’utilisateur, le visiteur reçoit une interface permettant d’entrer son nom d’utilisateur, son mot de passe, son adresse de messagerie et d’autres informations essentielles, à partir duquel un nouveau compte est créé.</span><span class="sxs-lookup"><span data-stu-id="a4c23-277">In most create user account scenarios, the visitor is presented with some interface to enter their username, password, email, and other essential information, at which point a new account is created.</span></span> <span data-ttu-id="a4c23-278">Au cours de cette étape, nous avons abordé la création d’une interface à la main, puis vu comment utiliser la méthode `Membership.CreateUser` pour ajouter par programmation le nouveau compte d’utilisateur en fonction des entrées de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-278">In this step we looked at building such an interface by hand and then saw how to use the `Membership.CreateUser` method to programmatically add the new user account based on the user's inputs.</span></span> <span data-ttu-id="a4c23-279">Notre code, cependant, vient de créer le nouveau compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-279">Our code, however, just created the new user account.</span></span> <span data-ttu-id="a4c23-280">Il n’a pas effectué d’actions de suivi, telles que la connexion de l’utilisateur au site sous le compte d’utilisateur juste créé, ou l’envoi d’un e-mail de confirmation à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-280">It did not perform any follow up actions, like logging in the user to the site under the just-created user account, or sending a confirmation email to the user.</span></span> <span data-ttu-id="a4c23-281">Ces étapes supplémentaires nécessiteraient un code supplémentaire dans le gestionnaire d’événements `Click` du bouton.</span><span class="sxs-lookup"><span data-stu-id="a4c23-281">These additional steps would require additional code in the Button's `Click` event handler.</span></span>

<span data-ttu-id="a4c23-282">ASP.NET est fourni avec le contrôle CreateUserWizard, qui est conçu pour gérer le processus de création de compte d’utilisateur, du rendu d’une interface utilisateur pour la création de nouveaux comptes d’utilisateur, à la création du compte dans l’infrastructure d’appartenance et à l’exécution de l’opération de publication de compte. des tâches de création, telles que l’envoi d’un e-mail de confirmation et l’enregistrement de l’utilisateur créé dans le site.</span><span class="sxs-lookup"><span data-stu-id="a4c23-282">ASP.NET ships with the CreateUserWizard control, which is designed to handle the user account creation process, from rendering a user interface for creating new user accounts, to creating the account in the Membership framework and performing post-account creation tasks, such as sending a confirmation email and logging the just-created user into the site.</span></span> <span data-ttu-id="a4c23-283">L’utilisation du contrôle CreateUserWizard est aussi simple que le fait de faire glisser le contrôle CreateUserWizard de la boîte à outils vers une page, puis de définir certaines propriétés.</span><span class="sxs-lookup"><span data-stu-id="a4c23-283">Using the CreateUserWizard control is as simple as dragging the CreateUserWizard control from the Toolbox onto a page, and then setting a few properties.</span></span> <span data-ttu-id="a4c23-284">Dans la plupart des cas, vous n’aurez pas besoin d’écrire une seule ligne de code.</span><span class="sxs-lookup"><span data-stu-id="a4c23-284">In most cases, you won't need to write a single line of code.</span></span> <span data-ttu-id="a4c23-285">Nous allons explorer ce contrôle génial en détail à l’étape 6.</span><span class="sxs-lookup"><span data-stu-id="a4c23-285">We will explore this nifty control in detail in Step 6.</span></span>

<span data-ttu-id="a4c23-286">Si de nouveaux comptes d’utilisateur sont créés uniquement par le biais d’une page Web de création de compte classique, il est peu probable que vous deviez écrire du code qui utilise la méthode `CreateUser`, car le contrôle CreateUserWizard répondra probablement à vos besoins.</span><span class="sxs-lookup"><span data-stu-id="a4c23-286">If new user accounts are only created through a typical Create Account web page, it is unlikely that you will ever need to write code that uses the `CreateUser` method, as the CreateUserWizard control will likely meet your needs.</span></span> <span data-ttu-id="a4c23-287">Toutefois, la méthode `CreateUser` est pratique dans les scénarios où vous avez besoin d’une expérience utilisateur de création de compte hautement personnalisée ou lorsque vous devez créer des comptes d’utilisateur par programmation par le biais d’une autre interface.</span><span class="sxs-lookup"><span data-stu-id="a4c23-287">However, the `CreateUser` method is handy in scenarios where you need a highly customized Create Account user experience or when you need to programmatically create new user accounts through an alternative interface.</span></span> <span data-ttu-id="a4c23-288">Par exemple, vous pouvez avoir une page qui permet à un utilisateur de télécharger un fichier XML qui contient des informations utilisateur à partir d’une autre application.</span><span class="sxs-lookup"><span data-stu-id="a4c23-288">For example, you might have a page that allows a user to upload an XML file that contains user information from some other application.</span></span> <span data-ttu-id="a4c23-289">La page peut analyser le contenu du fichier XML téléchargé et créer un nouveau compte pour chaque utilisateur représenté dans le code XML en appelant la méthode `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-289">The page might parses the contents of the uploaded XML file and create a new account for each user represented in the XML by calling the `CreateUser` method.</span></span>

## <a name="step-6-creating-a-new-user-with-the-createuserwizard-control"></a><span data-ttu-id="a4c23-290">Étape 6 : Création d’un utilisateur avec le contrôle CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="a4c23-290">Step 6: Creating a New User with the CreateUserWizard Control</span></span>

<span data-ttu-id="a4c23-291">ASP.NET est fourni avec un certain nombre de contrôles Web de connexion.</span><span class="sxs-lookup"><span data-stu-id="a4c23-291">ASP.NET ships with a number of Login Web controls.</span></span> <span data-ttu-id="a4c23-292">Ces contrôles aident dans de nombreux scénarios courants liés au compte d’utilisateur et à la connexion.</span><span class="sxs-lookup"><span data-stu-id="a4c23-292">These controls aid in many common user account- and login-related scenarios.</span></span> <span data-ttu-id="a4c23-293">Le [contrôle CreateUserWizard](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) est un contrôle qui est conçu pour présenter une interface utilisateur qui permet d’ajouter un nouveau compte d’utilisateur à l’infrastructure d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="a4c23-293">The [CreateUserWizard control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) is one such control that is designed to present a user interface for adding a new user account to the Membership framework.</span></span>

<span data-ttu-id="a4c23-294">Comme la plupart des autres contrôles Web liés à la connexion, le contrôle CreateUserWizard peut être utilisé sans écrire une seule ligne de code.</span><span class="sxs-lookup"><span data-stu-id="a4c23-294">Like many of the other Login-related Web controls, the CreateUserWizard can be used without writing a single line of code.</span></span> <span data-ttu-id="a4c23-295">Il fournit intuitivement une interface utilisateur basée sur les paramètres de configuration du fournisseur d’appartenance et appelle en interne la méthode `CreateUser` de la classe `Membership` une fois que l’utilisateur a entré les informations nécessaires et clique sur le bouton créer un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-295">It intuitively provides a user interface based on the Membership provider's configuration settings and internally calls the `Membership` class's `CreateUser` method after the user enters the necessary information and clicks the Create User button.</span></span> <span data-ttu-id="a4c23-296">Le contrôle CreateUserWizard est extrêmement personnalisable.</span><span class="sxs-lookup"><span data-stu-id="a4c23-296">The CreateUserWizard control is extremely customizable.</span></span> <span data-ttu-id="a4c23-297">Il existe un hôte d’événements qui se déclenchent au cours des différentes étapes du processus de création du compte.</span><span class="sxs-lookup"><span data-stu-id="a4c23-297">There are a host of events that fire during various stages of the account creation process.</span></span> <span data-ttu-id="a4c23-298">Nous pouvons créer des gestionnaires d’événements, si nécessaire, pour injecter une logique personnalisée dans le flux de travail de création de compte.</span><span class="sxs-lookup"><span data-stu-id="a4c23-298">We can create event handlers, as needed, to inject custom logic into the account creation workflow.</span></span> <span data-ttu-id="a4c23-299">En outre, l’apparence de CreateUserWizard est très flexible.</span><span class="sxs-lookup"><span data-stu-id="a4c23-299">Furthermore, the CreateUserWizard's appearance is very flexible.</span></span> <span data-ttu-id="a4c23-300">Il existe un certain nombre de propriétés qui définissent l’apparence de l’interface par défaut ; Si nécessaire, le contrôle peut être converti en un modèle ou des étapes d’inscription utilisateur supplémentaires peuvent être ajoutées.</span><span class="sxs-lookup"><span data-stu-id="a4c23-300">There are a number of properties that define the appearance of the default interface; if necessary, the control can be converted into a template or additional user registration steps may be added.</span></span>

<span data-ttu-id="a4c23-301">Commençons par examiner l’utilisation de l’interface et du comportement par défaut du contrôle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="a4c23-301">Let's start with a look at using the CreateUserWizard control's default interface and behavior.</span></span> <span data-ttu-id="a4c23-302">Nous allons ensuite étudier comment personnaliser l’apparence à l’aide des propriétés et des événements du contrôle.</span><span class="sxs-lookup"><span data-stu-id="a4c23-302">We'll then explore how to customize the appearance via the control's properties and events.</span></span>

### <a name="examining-the-createuserwizards-default-interface-and-behavior"></a><span data-ttu-id="a4c23-303">Examen de l’interface et du comportement par défaut de CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="a4c23-303">Examining the CreateUserWizard's Default Interface and Behavior</span></span>

<span data-ttu-id="a4c23-304">Revenez à la page `CreatingUserAccounts.aspx` dans le dossier `Membership`, basculez en mode création ou fractionnement, puis ajoutez un contrôle CreateUserWizard en haut de la page.</span><span class="sxs-lookup"><span data-stu-id="a4c23-304">Return to the `CreatingUserAccounts.aspx` page in the `Membership` folder, switch to the Design or Split mode, and then add a CreateUserWizard control to the top of the page.</span></span> <span data-ttu-id="a4c23-305">Le contrôle CreateUserWizard est classé dans la section des contrôles de connexion de la boîte à outils.</span><span class="sxs-lookup"><span data-stu-id="a4c23-305">The CreateUserWizard control is filed under the Toolbox's Login controls section.</span></span> <span data-ttu-id="a4c23-306">Après avoir ajouté le contrôle, définissez sa propriété `ID` sur `RegisterUser`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-306">After adding the control, set its `ID` property to `RegisterUser`.</span></span> <span data-ttu-id="a4c23-307">Comme le montre la capture d’écran de la figure 11, le contrôle CreateUserWizard affiche une interface avec des zones de texte pour le nom d’utilisateur, le mot de passe, l’adresse de messagerie et la question de sécurité du nouvel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-307">As the screen shot in Figure 11 shows, the CreateUserWizard renders an interface with textboxes for the new user's username, password, email address, and security question and answer.</span></span>

<span data-ttu-id="a4c23-308">[![le contrôle CreateUserWizard restitue une interface utilisateur de création générique](creating-user-accounts-vb/_static/image32.png)](creating-user-accounts-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-308">[![The CreateUserWizard Control Renders a Generic Create User Interface](creating-user-accounts-vb/_static/image32.png)](creating-user-accounts-vb/_static/image31.png)</span></span>

<span data-ttu-id="a4c23-309">**Figure 11**: Le contrôle CreateUserWizard restitue une interface utilisateur Create générique ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-309">**Figure 11**: The CreateUserWizard Control Renders a Generic Create User Interface ([Click to view full-size image](creating-user-accounts-vb/_static/image33.png))</span></span>

<span data-ttu-id="a4c23-310">Prenons un moment pour comparer l’interface utilisateur par défaut générée par le contrôle CreateUserWizard avec l’interface que nous avons créée à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="a4c23-310">Let's take a moment to compare the default user interface generated by the CreateUserWizard control with the interface we created in Step 5.</span></span> <span data-ttu-id="a4c23-311">Pour commencer, le contrôle CreateUserWizard permet au visiteur de spécifier à la fois la question et la réponse de sécurité, tandis que notre interface créée manuellement a utilisé une question de sécurité prédéfinie.</span><span class="sxs-lookup"><span data-stu-id="a4c23-311">For starters, the CreateUserWizard control allows the visitor to specify both the security question and answer, whereas our manually-created interface used a pre-defined security question.</span></span> <span data-ttu-id="a4c23-312">L’interface du contrôle CreateUserWizard comprend également des contrôles de validation, tandis que nous n’avions pas encore implémenté la validation sur les champs de formulaire de l’interface.</span><span class="sxs-lookup"><span data-stu-id="a4c23-312">The CreateUserWizard control's interface also includes validation controls, whereas we had yet to implement validation on our interface's form fields.</span></span> <span data-ttu-id="a4c23-313">Et l’interface de contrôle CreateUserWizard comprend une zone de texte Confirm Password (avec un CompareValidator pour s’assurer que le texte entré dans les zones de texte mot de passe et comparer le mot de passe est égal à).</span><span class="sxs-lookup"><span data-stu-id="a4c23-313">And the CreateUserWizard control interface includes a Confirm Password textbox (along with a CompareValidator to ensure that the text entered the Password and Compare Password textboxes are equal).</span></span>

<span data-ttu-id="a4c23-314">Ce qui est intéressant, c’est que le contrôle CreateUserWizard consulte les paramètres de configuration du fournisseur d’appartenance lors du rendu de son interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-314">What's interesting is that the CreateUserWizard control consults the Membership provider's configuration settings when rendering its user interface.</span></span> <span data-ttu-id="a4c23-315">Par exemple, les zones de texte question de sécurité et réponse ne s’affichent que si `requiresQuestionAndAnswer` a la valeur true.</span><span class="sxs-lookup"><span data-stu-id="a4c23-315">For example, the security question and answer textboxes are only displayed if `requiresQuestionAndAnswer` is set to True.</span></span> <span data-ttu-id="a4c23-316">De même, CreateUserWizard ajoute automatiquement un contrôle RegularExpressionValidator pour s’assurer que les exigences de la force de mot de passe sont respectées et définit ses propriétés `ErrorMessage` et `ValidationExpression` en fonction des paramètres de configuration `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`et `passwordStrengthRegularExpression`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-316">Likewise, CreateUserWizard automatically adds a RegularExpressionValidator control to ensure that the password strength requirements are met, and sets its `ErrorMessage` and `ValidationExpression` properties based on the `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`, and `passwordStrengthRegularExpression` configuration settings.</span></span>

<span data-ttu-id="a4c23-317">Le contrôle CreateUserWizard, comme son nom l’indique, est dérivé du [contrôle](https://msdn.microsoft.com/library/s2etd1ek.aspx)de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="a4c23-317">The CreateUserWizard control, as its name implies, is derived from the [Wizard control](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span></span> <span data-ttu-id="a4c23-318">Les contrôles de l’Assistant sont conçus pour fournir une interface permettant d’effectuer des tâches en plusieurs étapes.</span><span class="sxs-lookup"><span data-stu-id="a4c23-318">Wizard controls are designed to provide an interface for completing multi-step tasks.</span></span> <span data-ttu-id="a4c23-319">Un contrôle Wizard peut avoir un nombre arbitraire de `WizardSteps`, chacun d’eux étant un modèle qui définit les contrôles HTML et Web pour cette étape.</span><span class="sxs-lookup"><span data-stu-id="a4c23-319">A Wizard control may have an arbitrary number of `WizardSteps`, each of which is a template that defines the HTML and Web controls for that step.</span></span> <span data-ttu-id="a4c23-320">Le contrôle Wizard affiche initialement la première `WizardStep`, ainsi que des contrôles de navigation qui permettent à l’utilisateur de passer d’une étape à l’autre, ou de revenir aux étapes précédentes.</span><span class="sxs-lookup"><span data-stu-id="a4c23-320">The Wizard control initially displays the first `WizardStep`, along with navigation controls that permit the user to proceed from one step to the next, or to return to previous steps.</span></span>

<span data-ttu-id="a4c23-321">Comme le montre le balisage déclaratif de la figure 11, l’interface par défaut du contrôle CreateUserWizard comprend deux `WizardStep` s :</span><span class="sxs-lookup"><span data-stu-id="a4c23-321">As the declarative markup in Figure 11 shows, the CreateUserWizard control's default interface includes two `WizardStep` s:</span></span>

- <span data-ttu-id="a4c23-322">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) ?</span><span class="sxs-lookup"><span data-stu-id="a4c23-322">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) ?</span></span> <span data-ttu-id="a4c23-323">génère le rendu de l’interface pour collecter des informations pour la création du nouveau compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-323">renders the interface to collect information for creating the new user account.</span></span> <span data-ttu-id="a4c23-324">Il s’agit de l’étape illustrée dans la figure 11.</span><span class="sxs-lookup"><span data-stu-id="a4c23-324">This is the step shown in Figure 11.</span></span>
- <span data-ttu-id="a4c23-325">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) ?</span><span class="sxs-lookup"><span data-stu-id="a4c23-325">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) ?</span></span> <span data-ttu-id="a4c23-326">génère le rendu d’un message indiquant que le compte a été créé avec succès.</span><span class="sxs-lookup"><span data-stu-id="a4c23-326">renders a message indicating that the account has successfully been created.</span></span>

<span data-ttu-id="a4c23-327">L’apparence et le comportement de CreateUserWizard peuvent être modifiés en convertissant l’une de ces étapes en modèles, ou en ajoutant vos propres `WizardStep` s.</span><span class="sxs-lookup"><span data-stu-id="a4c23-327">The CreateUserWizard's appearance and behavior can be modified by converting either of these steps to templates, or by adding your own `WizardStep` s.</span></span> <span data-ttu-id="a4c23-328">Nous allons examiner l’ajout d’un `WizardStep` à l’interface d’inscription dans le didacticiel *sur le stockage des informations utilisateur supplémentaires* .</span><span class="sxs-lookup"><span data-stu-id="a4c23-328">We will look at adding a `WizardStep` to the registration interface in the *Storing Additional User Information* tutorial.</span></span>

<span data-ttu-id="a4c23-329">Voyons le contrôle CreateUserWizard en action.</span><span class="sxs-lookup"><span data-stu-id="a4c23-329">Let's see the CreateUserWizard control in action.</span></span> <span data-ttu-id="a4c23-330">Visitez la page `CreatingUserAccounts.aspx` via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-330">Visit the `CreatingUserAccounts.aspx` page through a browser.</span></span> <span data-ttu-id="a4c23-331">Commencez par entrer des valeurs non valides dans l’interface de CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="a4c23-331">Start by entering some invalid values into the CreateUserWizard's interface.</span></span> <span data-ttu-id="a4c23-332">Essayez d’entrer un mot de passe qui n’est pas conforme aux exigences de la force de mot de passe, ou laissez la zone de texte nom d’utilisateur vide.</span><span class="sxs-lookup"><span data-stu-id="a4c23-332">Try entering a password that doesn't conform to the password strength requirements, or leaving the User Name textbox empty.</span></span> <span data-ttu-id="a4c23-333">CreateUserWizard affiche un message d’erreur approprié.</span><span class="sxs-lookup"><span data-stu-id="a4c23-333">The CreateUserWizard will display an appropriate error message.</span></span> <span data-ttu-id="a4c23-334">La figure 12 illustre la sortie lors d’une tentative de création d’un utilisateur avec un mot de passe fort insuffisant.</span><span class="sxs-lookup"><span data-stu-id="a4c23-334">Figure 12 shows the output when attempting to create a user with an insufficiently strong password.</span></span>

<span data-ttu-id="a4c23-335">[![que CreateUserWizard injecte automatiquement les contrôles de validation](creating-user-accounts-vb/_static/image35.png)](creating-user-accounts-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-335">[![The CreateUserWizard Automatically Injects Validation Controls](creating-user-accounts-vb/_static/image35.png)](creating-user-accounts-vb/_static/image34.png)</span></span>

<span data-ttu-id="a4c23-336">**Figure 12**: CreateUserWizard injecte automatiquement les contrôles de validation ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-336">**Figure 12**: The CreateUserWizard Automatically Injects Validation Controls ([Click to view full-size image](creating-user-accounts-vb/_static/image36.png))</span></span>

<span data-ttu-id="a4c23-337">Ensuite, entrez les valeurs appropriées dans CreateUserWizard, puis cliquez sur le bouton créer un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-337">Next, enter appropriate values into the CreateUserWizard and click the Create User button.</span></span> <span data-ttu-id="a4c23-338">En supposant que les champs requis ont été entrés et que la force du mot de passe soit suffisante, CreateUserWizard crée un nouveau compte d’utilisateur via l’infrastructure d’appartenance, puis affiche l’interface du `CompleteWizardStep`(voir figure 13).</span><span class="sxs-lookup"><span data-stu-id="a4c23-338">Assuming the required fields have been entered and the password's strength is sufficient, the CreateUserWizard will create a new user account through the Membership framework and then display the `CompleteWizardStep`'s interface (see Figure 13).</span></span> <span data-ttu-id="a4c23-339">En arrière-plan, CreateUserWizard appelle la méthode `Membership.CreateUser`, comme nous l’avons fait à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="a4c23-339">Behind the scenes, the CreateUserWizard calls the `Membership.CreateUser` method, just like we did in Step 5.</span></span>

<span data-ttu-id="a4c23-340">[![un nouveau compte d’utilisateur a été créé avec succès](creating-user-accounts-vb/_static/image38.png)](creating-user-accounts-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-340">[![A New User Account has Successfully Been Created](creating-user-accounts-vb/_static/image38.png)](creating-user-accounts-vb/_static/image37.png)</span></span>

<span data-ttu-id="a4c23-341">**Figure 13**: Un nouveau compte d’utilisateur a été créé avec succès ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-341">**Figure 13**: A New User Account has Successfully Been Created ([Click to view full-size image](creating-user-accounts-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="a4c23-342">Comme le montre la figure 13, l’interface de `CompleteWizardStep`comprend un bouton continuer.</span><span class="sxs-lookup"><span data-stu-id="a4c23-342">As Figure 13 shows, the `CompleteWizardStep`'s interface includes a Continue button.</span></span> <span data-ttu-id="a4c23-343">Toutefois, à ce stade, il suffit de cliquer dessus pour effectuer une publication, ce qui laisse le visiteur sur la même page.</span><span class="sxs-lookup"><span data-stu-id="a4c23-343">However, at this point clicking it just performs a postback, leaving the visitor on the same page.</span></span> <span data-ttu-id="a4c23-344">Dans la section personnalisation de l’apparence et du comportement de CreateUserWizard par le biais de sa section Propriétés, nous allons voir comment vous pouvez faire en sorte que ce bouton envoie le visiteur à `Default.aspx` (ou à une autre page).</span><span class="sxs-lookup"><span data-stu-id="a4c23-344">In the Customizing the CreateUserWizard's Appearance and Behavior Through Its Properties section we will look at how you can have this button send the visitor to `Default.aspx` (or some other page).</span></span>

<span data-ttu-id="a4c23-345">Après avoir créé un nouveau compte d’utilisateur, revenez à Visual Studio et examinez les `aspnet_Users` et `aspnet_Membership` tables comme nous l’avons fait à la figure 10 pour vérifier que le compte a bien été créé.</span><span class="sxs-lookup"><span data-stu-id="a4c23-345">After creating a new user account, return to Visual Studio and examine the `aspnet_Users` and `aspnet_Membership` tables like we did in Figure 10 to verify that the account was successfully created.</span></span>

### <a name="customizing-the-createuserwizards-behavior-and-appearance-through-its-properties"></a><span data-ttu-id="a4c23-346">Personnalisation du comportement et de l’apparence de CreateUserWizard par le biais de ses propriétés</span><span class="sxs-lookup"><span data-stu-id="a4c23-346">Customizing the CreateUserWizard's Behavior and Appearance Through Its Properties</span></span>

<span data-ttu-id="a4c23-347">L’CreateUserWizard peut être personnalisé de plusieurs façons, par le biais des propriétés, des `WizardStep` s et des gestionnaires d’événements.</span><span class="sxs-lookup"><span data-stu-id="a4c23-347">The CreateUserWizard can be customized in a variety of ways, through properties, `WizardStep` s, and event handlers.</span></span> <span data-ttu-id="a4c23-348">Dans cette section, nous allons voir comment personnaliser l’apparence du contrôle par le biais de ses propriétés. la section suivante examine l’extension du comportement du contrôle par le biais de gestionnaires d’événements.</span><span class="sxs-lookup"><span data-stu-id="a4c23-348">In this section we will look at how to customize the control's appearance through its properties; the next section looks at extending the control's behavior through event handlers.</span></span>

<span data-ttu-id="a4c23-349">Presque tout le texte affiché dans l’interface utilisateur par défaut du contrôle CreateUserWizard peut être personnalisé par le biais de sa multitude de propriétés.</span><span class="sxs-lookup"><span data-stu-id="a4c23-349">Virtually all of the text displayed in the CreateUserWizard control's default user interface can be customized through its plethora of properties.</span></span> <span data-ttu-id="a4c23-350">Par exemple, les propriétés nom d’utilisateur, mot de passe, confirmer le mot de passe, adresse de messagerie, question de sécurité et réponse de sécurité affichées à gauche des zones de texte peuvent être personnalisées par les propriétés [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx)et [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) , respectivement.</span><span class="sxs-lookup"><span data-stu-id="a4c23-350">For example, the User Name, Password, Confirm Password, E-mail, Security Question, and Security Answer labels displayed to the left of the textboxes can be customized by the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx), and [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) properties, respectively.</span></span> <span data-ttu-id="a4c23-351">De même, il existe des propriétés permettant de spécifier le texte des boutons CREATE USER et continue dans le `CreateUserWizardStep` et `CompleteWizardStep`, ainsi que si ces boutons sont rendus sous forme de boutons, LinkButtons ou ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="a4c23-351">Likewise, there are properties for specifying the text for the Create User and Continue buttons in the `CreateUserWizardStep` and `CompleteWizardStep`, as well as if these buttons are rendered as Buttons, LinkButtons, or ImageButtons.</span></span>

<span data-ttu-id="a4c23-352">Les couleurs, les bordures, les polices et d’autres éléments visuels peuvent être configurés via un hôte de propriétés de style.</span><span class="sxs-lookup"><span data-stu-id="a4c23-352">The colors, borders, fonts, and other visual elements are configurable through a host of style properties.</span></span> <span data-ttu-id="a4c23-353">Le contrôle CreateUserWizard lui-même possède les propriétés de style de contrôle Web communes (`BackColor`, `BorderStyle`, `CssClass`, `Font`, etc.), et il existe un certain nombre de propriétés de style pour définir l’apparence des sections particulières de l’interface de CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="a4c23-353">The CreateUserWizard control itself has the common Web control style properties - `BackColor`, `BorderStyle`, `CssClass`, `Font`, and so on - and there are a number of style properties for defining the appearance for particular sections of the CreateUserWizard's interface.</span></span> <span data-ttu-id="a4c23-354">La [propriété`TextBoxStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), par exemple, définit les styles des zones de texte dans le `CreateUserWizardStep`, tandis que la [propriété`TitleTextStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) définit le style du titre (s’inscrire à votre nouveau compte).</span><span class="sxs-lookup"><span data-stu-id="a4c23-354">The [`TextBoxStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), for instance, defines the styles for the textboxes in the `CreateUserWizardStep`, while the [`TitleTextStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) defines the style for the title ( Sign Up for Your New Account ).</span></span>

<span data-ttu-id="a4c23-355">Outre les propriétés relatives à l’apparence, il existe un certain nombre de propriétés qui affectent le comportement du contrôle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="a4c23-355">In addition to the appearance-related properties, there are a number of properties that affect the CreateUserWizard control's behavior.</span></span> <span data-ttu-id="a4c23-356">La [propriété`DisplayCancelButton`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), si elle est définie sur true, affiche un bouton Annuler en regard du bouton créer un utilisateur (la valeur par défaut est false).</span><span class="sxs-lookup"><span data-stu-id="a4c23-356">The [`DisplayCancelButton` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), if set to True, displays a Cancel button next to the Create User button (the default value is False).</span></span> <span data-ttu-id="a4c23-357">Si vous affichez le bouton Annuler, veillez à définir également la [propriété`CancelDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), qui spécifie la page à laquelle l’utilisateur est envoyé après avoir cliqué sur Annuler.</span><span class="sxs-lookup"><span data-stu-id="a4c23-357">If you display the Cancel button, be sure to also set the [`CancelDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), which specifies the page the user is sent to after clicking Cancel.</span></span> <span data-ttu-id="a4c23-358">Comme indiqué dans la section précédente, le bouton continuer de l’interface de `CompleteWizardStep`entraîne une publication (postback), mais laisse le visiteur sur la même page.</span><span class="sxs-lookup"><span data-stu-id="a4c23-358">As noted in the previous section, the Continue button in the `CompleteWizardStep`'s interface causes a postback, but leaves the visitor on the same page.</span></span> <span data-ttu-id="a4c23-359">Pour envoyer le visiteur à une autre page après avoir cliqué sur le bouton continuer, spécifiez simplement l’URL dans la [propriété`ContinueDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4c23-359">To send the visitor to some other page after clicking the Continue button, simply specify the URL in the [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span>

<span data-ttu-id="a4c23-360">Nous allons mettre à jour le contrôle `RegisterUser` CreateUserWizard pour afficher un bouton Annuler et pour envoyer le visiteur à `Default.aspx` lorsque l’utilisateur clique sur les boutons annuler ou continuer.</span><span class="sxs-lookup"><span data-stu-id="a4c23-360">Let's update the `RegisterUser` CreateUserWizard control to show a Cancel button and to send the visitor to `Default.aspx` when the Cancel or Continue buttons are clicked.</span></span> <span data-ttu-id="a4c23-361">Pour ce faire, affectez la valeur true à la propriété `DisplayCancelButton` et les propriétés `CancelDestinationPageUrl` et `ContinueDestinationPageUrl` à ~/default.aspx.</span><span class="sxs-lookup"><span data-stu-id="a4c23-361">To accomplish this, set the `DisplayCancelButton` property to True and both the `CancelDestinationPageUrl` and `ContinueDestinationPageUrl` properties to ~/Default.aspx.</span></span> <span data-ttu-id="a4c23-362">La figure 14 illustre la mise à jour de CreateUserWizard quand vous l’affichez dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-362">Figure 14 shows the updated CreateUserWizard when viewed through a browser.</span></span>

<span data-ttu-id="a4c23-363">[![CreateUserWizardStep contient un bouton Annuler](creating-user-accounts-vb/_static/image41.png)](creating-user-accounts-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-363">[![The CreateUserWizardStep Includes a Cancel Button](creating-user-accounts-vb/_static/image41.png)](creating-user-accounts-vb/_static/image40.png)</span></span>

<span data-ttu-id="a4c23-364">**Figure 14**: Le `CreateUserWizardStep` comprend un bouton Annuler ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-364">**Figure 14**: The `CreateUserWizardStep` Includes a Cancel Button ([Click to view full-size image](creating-user-accounts-vb/_static/image42.png))</span></span>

<span data-ttu-id="a4c23-365">Lorsqu’un visiteur entre un nom d’utilisateur, un mot de passe, une adresse de messagerie et une question de sécurité, puis clique sur créer un utilisateur, un nouveau compte d’utilisateur est créé et le visiteur est connecté en tant que l’utilisateur nouvellement créé.</span><span class="sxs-lookup"><span data-stu-id="a4c23-365">When a visitor enters a username, password, email address, and security question and answer and clicks Create User, a new user account is created and the visitor is logged in as that newly created user.</span></span> <span data-ttu-id="a4c23-366">En supposant que la personne visitant la page crée un nouveau compte pour lui-même, il s’agit probablement du comportement souhaité.</span><span class="sxs-lookup"><span data-stu-id="a4c23-366">Assuming that the person visiting the page is creating a new account for themselves, this is likely the desired behavior.</span></span> <span data-ttu-id="a4c23-367">Toutefois, vous souhaiterez peut-être autoriser les administrateurs à ajouter de nouveaux comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-367">However, you may want to allow Administrators to add new user accounts.</span></span> <span data-ttu-id="a4c23-368">Dans ce cas, le compte d’utilisateur est créé, mais l’administrateur reste connecté en tant qu’administrateur (et non en tant que compte nouvellement créé).</span><span class="sxs-lookup"><span data-stu-id="a4c23-368">In doing so, the user account would be created, but the Administrator would remain logged in as an Administrator (and not as the newly created account).</span></span> <span data-ttu-id="a4c23-369">Ce comportement peut être modifié à l’aide de la [propriété booléenne`LoginCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4c23-369">This behavior can be modified through the Boolean [`LoginCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span></span>

<span data-ttu-id="a4c23-370">Les comptes d’utilisateur dans l’infrastructure d’appartenance contiennent un indicateur approuvé ; les utilisateurs qui ne sont pas approuvés ne sont pas en mesure de se connecter au site.</span><span class="sxs-lookup"><span data-stu-id="a4c23-370">User accounts in the Membership framework contain an approved flag; users who are not approved are unable to log into the site.</span></span> <span data-ttu-id="a4c23-371">Par défaut, un compte nouvellement créé est marqué comme approuvé, ce qui permet à l’utilisateur de se connecter immédiatement au site.</span><span class="sxs-lookup"><span data-stu-id="a4c23-371">By default, a newly created account is marked as approved, allowing the user to log into the site immediately.</span></span> <span data-ttu-id="a4c23-372">Toutefois, il est possible que de nouveaux comptes d’utilisateur soient marqués comme non approuvés.</span><span class="sxs-lookup"><span data-stu-id="a4c23-372">It is possible, however, to have new user accounts marked as unapproved.</span></span> <span data-ttu-id="a4c23-373">Peut-être souhaitez-vous qu’un administrateur approuve manuellement les nouveaux utilisateurs avant qu’ils ne puissent se connecter ; ou vous souhaitez peut-être vérifier que l’adresse e-mail entrée lors de l’inscription est valide avant d’autoriser un utilisateur à se connecter.</span><span class="sxs-lookup"><span data-stu-id="a4c23-373">Perhaps you want an Administrator to manually approve new users before they can log in; or maybe you want to verify that the email address entered at signup is valid before permitting a user to log on.</span></span> <span data-ttu-id="a4c23-374">Quel que soit le cas, vous pouvez faire en sorte que le compte d’utilisateur nouvellement créé soit marqué comme non approuvé en affectant à la [propriété`DisableCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) du contrôle CreateUserWizard la valeur true (la valeur par défaut est false).</span><span class="sxs-lookup"><span data-stu-id="a4c23-374">Whatever the case may be, you can have the newly created user account marked as unapproved by setting the CreateUserWizard control's [`DisableCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) to True (the default is False).</span></span>

<span data-ttu-id="a4c23-375">D’autres propriétés liées au comportement de note incluent `AutoGeneratePassword` et `MailDefinition`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-375">Other behavior-related properties of note include `AutoGeneratePassword` and `MailDefinition`.</span></span> <span data-ttu-id="a4c23-376">Si la [propriété`AutoGeneratePassword`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) est définie sur true, le `CreateUserWizardStep` n’affiche pas les zones de texte mot de passe et confirmer le mot de passe. au lieu de cela, le mot de passe de l’utilisateur nouvellement créé est automatiquement généré à l’aide de la [méthode`GeneratePassword`](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx)de la classe `Membership`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-376">If the [`AutoGeneratePassword` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) is set to True, the `CreateUserWizardStep` does not display the Password and Confirm Password textboxes; instead, the newly-created user's password is automatically generated using the `Membership` class's [`GeneratePassword` method](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx).</span></span> <span data-ttu-id="a4c23-377">La méthode `GeneratePassword` construit un mot de passe d’une longueur spécifiée et avec un nombre suffisant de caractères non alphanumériques pour satisfaire les exigences de force de mot de passe configurées.</span><span class="sxs-lookup"><span data-stu-id="a4c23-377">The `GeneratePassword` method constructs a password of a specified length and with a sufficient number of non-alphanumeric characters to satisfy the configured password strength requirements.</span></span>

<span data-ttu-id="a4c23-378">La [propriété`MailDefinition`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) est utile si vous souhaitez envoyer un e-mail à l’adresse de messagerie spécifiée pendant le processus de création du compte.</span><span class="sxs-lookup"><span data-stu-id="a4c23-378">The [`MailDefinition` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) is useful if you want to send an email to the email address specified during the account creation process.</span></span> <span data-ttu-id="a4c23-379">La propriété `MailDefinition` comprend une série de sous-propriétés permettant de définir les informations relatives au message électronique construit.</span><span class="sxs-lookup"><span data-stu-id="a4c23-379">The `MailDefinition` property includes a series of subproperties for defining information about the constructed email message.</span></span> <span data-ttu-id="a4c23-380">Ces sous-propriétés incluent des options telles que `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`et `BodyFileName`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-380">These subproperties include options like `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`, and `BodyFileName`.</span></span> <span data-ttu-id="a4c23-381">La [propriété`BodyFileName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) pointe vers un fichier texte ou HTML qui contient le corps du message électronique.</span><span class="sxs-lookup"><span data-stu-id="a4c23-381">The [`BodyFileName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) points to a text or HTML file that contains the body for the email message.</span></span> <span data-ttu-id="a4c23-382">Le corps prend en charge deux espaces réservés prédéfinis : `<%UserName%>` et `<%Password%>`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-382">The body supports two pre-defined placeholders: `<%UserName%>` and `<%Password%>`.</span></span> <span data-ttu-id="a4c23-383">Ces espaces réservés, s’ils sont présents dans le fichier `BodyFileName`, seront remplacés par le nom et le mot de passe de l’utilisateur que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="a4c23-383">These placeholders, if present in the `BodyFileName` file, will be replaced with the just-created user's name and password.</span></span>

> [!NOTE]
> <span data-ttu-id="a4c23-384">La propriété `MailDefinition` du contrôle `CreateUserWizard` spécifie simplement des détails sur le message électronique envoyé lorsqu’un nouveau compte est créé.</span><span class="sxs-lookup"><span data-stu-id="a4c23-384">The `CreateUserWizard` control's `MailDefinition` property just specifies details about the email message that is sent when a new account is created.</span></span> <span data-ttu-id="a4c23-385">Il n’inclut pas de détails sur la façon dont le message électronique est réellement envoyé (c’est-à-dire, si un répertoire de dépôt de messagerie ou de serveur SMTP est utilisé, toutes les informations d’authentification, etc.).</span><span class="sxs-lookup"><span data-stu-id="a4c23-385">It does not include any details on how the email message is actually sent (that is, whether an SMTP server or mail drop directory is used, any authentication information, and so on).</span></span> <span data-ttu-id="a4c23-386">Ces détails de bas niveau doivent être définis dans la section `<system.net>` de `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-386">These low-level details need to be defined in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="a4c23-387">Pour plus d’informations sur ces paramètres de configuration et sur l’envoi de courrier électronique à partir de ASP.NET 2,0 en général, reportez-vous aux [questions fréquentes sur SystemNetMail.com](http://www.systemnetmail.com/) et mon article, [envoi de courrier électronique dans ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4c23-387">For more information on these configuration settings and on sending email from ASP.NET 2.0 in general, refer to the [FAQs at SystemNetMail.com](http://www.systemnetmail.com/) and my article, [Sending Email in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span></span>

### <a name="extending-the-createuserwizards-behavior-using-event-handlers"></a><span data-ttu-id="a4c23-388">Extension du comportement de CreateUserWizard à l’aide de gestionnaires d’événements</span><span class="sxs-lookup"><span data-stu-id="a4c23-388">Extending the CreateUserWizard's Behavior Using Event Handlers</span></span>

<span data-ttu-id="a4c23-389">Le contrôle CreateUserWizard déclenche un certain nombre d’événements pendant son flux de travail.</span><span class="sxs-lookup"><span data-stu-id="a4c23-389">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="a4c23-390">Par exemple, une fois qu’un visiteur entre son nom d’utilisateur, son mot de passe et d’autres informations pertinentes et clique sur le bouton créer un utilisateur, le contrôle CreateUserWizard déclenche son [événement`CreatingUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4c23-390">For example, after a visitor enters their username, password, and other pertinent information and clicks the Create User button, the CreateUserWizard control raises its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="a4c23-391">Si un problème survient au cours du processus de création, l' [événement`CreateUserError`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) est déclenché ; Toutefois, si l’utilisateur est correctement créé, l' [événement`CreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) est déclenché.</span><span class="sxs-lookup"><span data-stu-id="a4c23-391">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="a4c23-392">Des événements de contrôle CreateUserWizard supplémentaires sont déclenchés, mais ce sont les trois les plus allemands.</span><span class="sxs-lookup"><span data-stu-id="a4c23-392">There are additional CreateUserWizard control events that get raised, but these are the three most germane ones.</span></span>

<span data-ttu-id="a4c23-393">Dans certains scénarios, nous pouvons souhaiter exploiter le workflow CreateUserWizard, que nous pouvons faire en créant un gestionnaire d’événements pour l’événement approprié.</span><span class="sxs-lookup"><span data-stu-id="a4c23-393">In certain scenarios we may want to tap into the CreateUserWizard workflow, which we can do by creating an event handler for the appropriate event.</span></span> <span data-ttu-id="a4c23-394">Pour illustrer cela, nous allons améliorer le contrôle `RegisterUser` CreateUserWizard pour inclure une validation personnalisée sur le nom d’utilisateur et le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="a4c23-394">To illustrate this, let's enhance the `RegisterUser` CreateUserWizard control to include some custom validation on the username and password.</span></span> <span data-ttu-id="a4c23-395">En particulier, nous allons améliorer CreateUserWizard afin que les noms d’utilisateur ne puissent pas contenir d’espaces de début ou de fin, et le nom d’utilisateur ne peut pas apparaître n’importe où dans le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="a4c23-395">In particular, let's enhance our CreateUserWizard so that usernames cannot contain leading or trailing spaces and the username cannot appear anywhere in the password.</span></span> <span data-ttu-id="a4c23-396">En bref, nous voulons empêcher une personne de créer un nom d’utilisateur tel que « Scott », ou d’avoir une combinaison nom d’utilisateur/mot de passe comme Scott et Scott. 1234.</span><span class="sxs-lookup"><span data-stu-id="a4c23-396">In short, we want to prevent someone from creating a username like "Scott ", or having a username/password combination like Scott and Scott.1234 .</span></span>

<span data-ttu-id="a4c23-397">Pour ce faire, nous allons créer un gestionnaire d’événements pour l’événement `CreatingUser` pour effectuer nos contrôles de validation supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="a4c23-397">To accomplish this we will create an event handler for the `CreatingUser` event to perform our extra validation checks.</span></span> <span data-ttu-id="a4c23-398">Si les données fournies ne sont pas valides, nous devons annuler le processus de création.</span><span class="sxs-lookup"><span data-stu-id="a4c23-398">If the supplied data is not valid we need to cancel the creation process.</span></span> <span data-ttu-id="a4c23-399">Nous devons également ajouter un contrôle Web Label à la page pour afficher un message expliquant que le nom d’utilisateur ou le mot de passe n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="a4c23-399">We also need to add a Label Web control to the page to display a message explaining that the username or password is invalid.</span></span> <span data-ttu-id="a4c23-400">Commencez par ajouter un contrôle Label sous le contrôle CreateUserWizard, en affectant à sa propriété `ID` la valeur `InvalidUserNameOrPasswordMessage` et à sa propriété `ForeColor` la valeur `Red`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-400">Start by adding a Label control beneath the CreateUserWizard control, setting its `ID` property to `InvalidUserNameOrPasswordMessage` and its `ForeColor` property to `Red`.</span></span> <span data-ttu-id="a4c23-401">Effacez sa propriété `Text` et affectez à ses propriétés `EnableViewState` et `Visible` la valeur false.</span><span class="sxs-lookup"><span data-stu-id="a4c23-401">Clear out its `Text` property and set its `EnableViewState` and `Visible` properties to False.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample7.aspx)]

<span data-ttu-id="a4c23-402">Ensuite, créez un gestionnaire d’événements pour l’événement `CreatingUser` du contrôle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="a4c23-402">Next, create an event handler for the CreateUserWizard control's `CreatingUser` event.</span></span> <span data-ttu-id="a4c23-403">Pour créer un gestionnaire d’événements, sélectionnez le contrôle dans le concepteur, puis accédez au Fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="a4c23-403">To create an event handler, select the control in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="a4c23-404">À partir de là, cliquez sur l’icône représentant un éclair, puis double-cliquez sur l’événement approprié pour créer le gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="a4c23-404">From there, click on the lightning bolt icon and then double-click the appropriate event to create the event handler.</span></span>

<span data-ttu-id="a4c23-405">Ajoutez le code suivant au gestionnaire d'événements `CreatingUser` :</span><span class="sxs-lookup"><span data-stu-id="a4c23-405">Add the following code to the `CreatingUser` event handler:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample8.vb)]

<span data-ttu-id="a4c23-406">Notez que le nom d’utilisateur et le mot de passe entrés dans le contrôle CreateUserWizard sont disponibles par le biais de ses propriétés [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) et [`Password`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectivement.</span><span class="sxs-lookup"><span data-stu-id="a4c23-406">Note that the username and password entered into the CreateUserWizard control are available through its [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectively.</span></span> <span data-ttu-id="a4c23-407">Nous utilisons ces propriétés dans le gestionnaire d’événements ci-dessus pour déterminer si le nom d’utilisateur fourni contient des espaces de début ou de fin et si le nom d’utilisateur se trouve dans le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="a4c23-407">We use these properties in the above event handler to determine whether the supplied username contains leading or trailing spaces and whether the username is found within the password.</span></span> <span data-ttu-id="a4c23-408">Si l’une de ces conditions est remplie, un message d’erreur s’affiche dans l’étiquette `InvalidUserNameOrPasswordMessage` et la propriété `e.Cancel` du gestionnaire d’événements est définie sur `True`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-408">If either of these conditions is met, an error message is displayed in the `InvalidUserNameOrPasswordMessage` Label and the event handler's `e.Cancel` property is set to `True`.</span></span> <span data-ttu-id="a4c23-409">Si `e.Cancel` est défini sur `True`, le flux de travail de la gestion des comptes de compte CreateUserWizard réduit en fait le processus de création du compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-409">If `e.Cancel` is set to `True`, the CreateUserWizard short-circuits its workflow, effectively cancelling the user account creation process.</span></span>

<span data-ttu-id="a4c23-410">La figure 15 illustre une capture d’écran de `CreatingUserAccounts.aspx` lorsque l’utilisateur entre un nom d’utilisateur avec des espaces de début.</span><span class="sxs-lookup"><span data-stu-id="a4c23-410">Figure 15 shows a screen shot of `CreatingUserAccounts.aspx` when the user enters a username with leading spaces.</span></span>

<span data-ttu-id="a4c23-411">[![les noms d’utilisateur avec des espaces de début ou de fin ne sont pas autorisés](creating-user-accounts-vb/_static/image44.png)](creating-user-accounts-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="a4c23-411">[![Usernames with Leading or Trailing Spaces are not Permitted](creating-user-accounts-vb/_static/image44.png)](creating-user-accounts-vb/_static/image43.png)</span></span>

<span data-ttu-id="a4c23-412">**Figure 15**: Les noms d’utilisateur avec des espaces de début ou de fin ne sont pas autorisés ([cliquez pour afficher l’image en taille réelle](creating-user-accounts-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="a4c23-412">**Figure 15**: Usernames with Leading or Trailing Spaces are not Permitted ([Click to view full-size image](creating-user-accounts-vb/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="a4c23-413">Nous verrons un exemple d’utilisation de l’événement `CreatedUser` du contrôle CreateUserWizard dans le tutoriel *<a id="_msoanchor_11"></a>[Stockage d’informations supplémentaires sur l’utilisateur](storing-additional-user-information-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="a4c23-413">We will see an example of using the CreateUserWizard control's `CreatedUser` event in the *<a id="_msoanchor_11"></a>[Storing Additional User Information](storing-additional-user-information-vb.md)* tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="a4c23-414">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="a4c23-414">Summary</span></span>

<span data-ttu-id="a4c23-415">La méthode `CreateUser` de la classe `Membership` crée un nouveau compte d’utilisateur dans l’infrastructure d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="a4c23-415">The `Membership` class's `CreateUser` method creates a new user account in the Membership framework.</span></span> <span data-ttu-id="a4c23-416">Pour ce faire, il délègue l’appel au fournisseur d’appartenances configuré.</span><span class="sxs-lookup"><span data-stu-id="a4c23-416">It does so by delegating the call to the configured Membership provider.</span></span> <span data-ttu-id="a4c23-417">Dans le cas de la `SqlMembershipProvider`, la méthode `CreateUser` ajoute un enregistrement aux tables de base de données `aspnet_Users` et `aspnet_Membership`.</span><span class="sxs-lookup"><span data-stu-id="a4c23-417">In the case of the `SqlMembershipProvider`, the `CreateUser` method adds a record to the `aspnet_Users` and `aspnet_Membership` database tables.</span></span>

<span data-ttu-id="a4c23-418">Alors que de nouveaux comptes d’utilisateur peuvent être créés par programme (comme nous l’avons vu à l’étape 5), une approche plus rapide et plus facile consiste à utiliser le contrôle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="a4c23-418">While new user accounts can be created programmatically (as we saw in Step 5), a faster and easier approach is to use the CreateUserWizard control.</span></span> <span data-ttu-id="a4c23-419">Ce contrôle restitue une interface utilisateur à plusieurs étapes pour la collecte d’informations utilisateur et la création d’un nouvel utilisateur dans l’infrastructure d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="a4c23-419">This control renders a multi-step user interface for collecting user information and creating a new user in the Membership framework.</span></span> <span data-ttu-id="a4c23-420">En coulisses, ce contrôle utilise la même méthode de `Membership.CreateUser` que celle examinée à l’étape 5, mais le contrôle crée l’interface utilisateur, les contrôles de validation et répond aux erreurs de création de compte d’utilisateur sans avoir à écrire de code.</span><span class="sxs-lookup"><span data-stu-id="a4c23-420">Underneath the covers, this control uses the same `Membership.CreateUser` method as examined in Step 5, but the control creates the user interface, validation controls, and responds to user account creation errors without having to write a lick of code.</span></span>

<span data-ttu-id="a4c23-421">À ce stade, nous avons la fonctionnalité en place pour créer des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a4c23-421">At this point we have the functionality in place to create new user accounts.</span></span> <span data-ttu-id="a4c23-422">Toutefois, la page de connexion est toujours validée par rapport aux informations d’identification codées en dur que nous avons spécifiées dans le deuxième didacticiel.</span><span class="sxs-lookup"><span data-stu-id="a4c23-422">However, the login page still is validating against those hard-coded credentials we specified back in the second tutorial.</span></span> <span data-ttu-id="a4c23-423">Dans le <a id="_msoanchor_12"> </a> [didacticiel suivant](validating-user-credentials-against-the-membership-user-store-vb.md) , nous allons mettre à jour `Login.aspx` pour valider les informations d’identification fournies par l’utilisateur par rapport à l’infrastructure d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="a4c23-423">In the <a id="_msoanchor_12"></a>[next tutorial](validating-user-credentials-against-the-membership-user-store-vb.md) we will update `Login.aspx` to validate the user's supplied credentials against the Membership framework.</span></span>

<span data-ttu-id="a4c23-424">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="a4c23-424">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="a4c23-425">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="a4c23-425">Further Reading</span></span>

<span data-ttu-id="a4c23-426">Pour plus d’informations sur les sujets abordés dans ce didacticiel, reportez-vous aux ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="a4c23-426">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="a4c23-427">Documentation technique `CreateUser`</span><span class="sxs-lookup"><span data-stu-id="a4c23-427">`CreateUser` Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.security.membershipprovider.createuser.aspx)
- [<span data-ttu-id="a4c23-428">Vue d’ensemble du contrôle CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="a4c23-428">CreateUserWizard Control Overview</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx)
- [<span data-ttu-id="a4c23-429">Création d’un fournisseur de plan de site basé sur un système de fichiers</span><span class="sxs-lookup"><span data-stu-id="a4c23-429">Creating a File System-Based Site Map Provider</span></span>](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)
- [<span data-ttu-id="a4c23-430">Création d’une interface utilisateur pas à pas avec le contrôle de l’Assistant ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="a4c23-430">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="a4c23-431">Examen de la navigation de site de ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="a4c23-431">Examining ASP.NET 2.0's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="a4c23-432">Pages maîtres et navigation dans les sites</span><span class="sxs-lookup"><span data-stu-id="a4c23-432">Master Pages and Site Navigation</span></span>](https://asp.net/learn/data-access/tutorial-03-vb.aspx)
- [<span data-ttu-id="a4c23-433">Le fournisseur de plan de site SQL que vous attendiez</span><span class="sxs-lookup"><span data-stu-id="a4c23-433">The SQL Site Map Provider You've Been Waiting For</span></span>](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="a4c23-434">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="a4c23-434">About the Author</span></span>

<span data-ttu-id="a4c23-435">Scott Mitchell, auteur de plusieurs ouvrages ASP/ASP. NET et fondateur de 4GuysFromRolla.com, travaille avec les technologies Web de Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="a4c23-435">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a4c23-436">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="a4c23-436">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a4c23-437">Son dernier ouvrage est *[SAM animer vous-même ASP.NET 2.0 des dernières 24 heures](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="a4c23-437">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="a4c23-438">Scott peut être atteint à [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) ou via son blog à [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="a4c23-438">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="a4c23-439">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="a4c23-439">Special Thanks To</span></span>

<span data-ttu-id="a4c23-440">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="a4c23-440">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a4c23-441">Le réviseur de leads pour ce didacticiel était Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="a4c23-441">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="a4c23-442">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="a4c23-442">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a4c23-443">Si c’est le cas, insérez une ligne sur [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span><span class="sxs-lookup"><span data-stu-id="a4c23-443">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a4c23-444">[Précédent](creating-the-membership-schema-in-sql-server-vb.md)
> [Suivant](validating-user-credentials-against-the-membership-user-store-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a4c23-444">[Previous](creating-the-membership-schema-in-sql-server-vb.md)
[Next](validating-user-credentials-against-the-membership-user-store-vb.md)</span></span>
