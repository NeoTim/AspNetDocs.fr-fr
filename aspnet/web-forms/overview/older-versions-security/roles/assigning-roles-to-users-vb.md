---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
title: Attribution de rôles aux utilisateurs (VB) | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons créer deux pages ASP.NET afin de faciliter la gestion de ce que les utilisateurs appartiennent à quels rôles. La première page comprend les ressources nécessaires pour voir ce que...
ms.author: riande
ms.date: 03/24/2008
ms.assetid: fd208ee9-69cc-4467-9783-b4e039bdd1d3
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
msc.type: authoredcontent
ms.openlocfilehash: 9efe20a1e8a5982d7494914a0ed865db0ab0f52e
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65130193"
---
# <a name="assigning-roles-to-users-vb"></a><span data-ttu-id="e4092-104">Attribution de rôles aux utilisateurs (VB)</span><span class="sxs-lookup"><span data-stu-id="e4092-104">Assigning Roles to Users (VB)</span></span>

<span data-ttu-id="e4092-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e4092-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e4092-106">[Télécharger le Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) ou [télécharger le PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="e4092-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span></span>

> <span data-ttu-id="e4092-107">Dans ce didacticiel, nous allons créer deux pages ASP.NET afin de faciliter la gestion de ce que les utilisateurs appartiennent à quels rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="e4092-108">La première page comprend les ressources nécessaires pour voir quels utilisateurs appartiennent à un rôle donné, les rôles qu’un utilisateur particulier appartient et la capacité d’affecter ou supprimer un utilisateur particulier à partir d’un rôle particulier.</span><span class="sxs-lookup"><span data-stu-id="e4092-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="e4092-109">Dans la deuxième page, nous augmenterons le contrôle CreateUserWizard afin qu’il inclue une étape pour spécifier quels rôles appartient l’utilisateur nouvellement créé.</span><span class="sxs-lookup"><span data-stu-id="e4092-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="e4092-110">Cela est utile dans les scénarios où un administrateur est en mesure de créer de nouveaux comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

## <a name="introduction"></a><span data-ttu-id="e4092-111">Introduction</span><span class="sxs-lookup"><span data-stu-id="e4092-111">Introduction</span></span>

<span data-ttu-id="e4092-112">Le <a id="_msoanchor_1"> </a> [didacticiel précédent](creating-and-managing-roles-vb.md) examiné le framework de rôles et les `SqlRoleProvider`; nous avons vu comment utiliser le `Roles` classe à créer, récupérer et supprimer des rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-vb.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="e4092-113">Outre la création et la suppression de rôles, nous devons être en mesure d’attribuer ou supprimer des utilisateurs d’un rôle.</span><span class="sxs-lookup"><span data-stu-id="e4092-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="e4092-114">Malheureusement, ASP.NET n’est pas fourni avec tous les contrôles Web pour la gestion de ce que les utilisateurs appartiennent à quels rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="e4092-115">Au lieu de cela, nous devons créer nos propres pages ASP.NET pour gérer ces associations.</span><span class="sxs-lookup"><span data-stu-id="e4092-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="e4092-116">La bonne nouvelle est que l’ajout et suppression d’utilisateurs aux rôles est très simple.</span><span class="sxs-lookup"><span data-stu-id="e4092-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="e4092-117">Le `Roles` classe contient un nombre de méthodes d’ajout d’un ou plusieurs utilisateurs à un ou plusieurs rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="e4092-118">Dans ce didacticiel, nous allons créer deux pages ASP.NET afin de faciliter la gestion de ce que les utilisateurs appartiennent à quels rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="e4092-119">La première page comprend les ressources nécessaires pour voir quels utilisateurs appartiennent à un rôle donné, les rôles qu’un utilisateur particulier appartient et la capacité d’affecter ou supprimer un utilisateur particulier à partir d’un rôle particulier.</span><span class="sxs-lookup"><span data-stu-id="e4092-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="e4092-120">Dans la deuxième page, nous augmenterons le contrôle CreateUserWizard afin qu’il inclue une étape pour spécifier quels rôles appartient l’utilisateur nouvellement créé.</span><span class="sxs-lookup"><span data-stu-id="e4092-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="e4092-121">Cela est utile dans les scénarios où un administrateur est en mesure de créer de nouveaux comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="e4092-122">C’est parti !</span><span class="sxs-lookup"><span data-stu-id="e4092-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="e4092-123">Liste de ce que les utilisateurs appartiennent à quels rôles</span><span class="sxs-lookup"><span data-stu-id="e4092-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="e4092-124">La première chose pour ce didacticiel consiste à créer une page web à partir de laquelle les utilisateurs peuvent être affectés aux rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="e4092-125">Avant de nous concernent nous-mêmes comment affecter des utilisateurs aux rôles, nous allons d’abord vous concentrer sur la façon de déterminer quels utilisateurs appartiennent à quels rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="e4092-126">Il existe deux façons d’afficher ces informations : « par rôle » ou « par utilisateur. »</span><span class="sxs-lookup"><span data-stu-id="e4092-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="e4092-127">Nous pouvons autoriser le visiteur à sélectionner un rôle et les afficher tous les utilisateurs qui appartiennent au rôle (l’affichage « par rôle »), ou nous pouvons inviter le visiteur pour sélectionner un utilisateur et de leur montrer les rôles attribués à cet utilisateur (l’affichage « par utilisateur »).</span><span class="sxs-lookup"><span data-stu-id="e4092-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="e4092-128">La vue « par rôle » est utile dans les cas où le visiteur souhaite connaître l’ensemble des utilisateurs qui appartiennent à un rôle particulier ; la vue « par utilisateur » est idéale lorsque le visiteur doit connaître l’ou les rôles d’un utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="e4092-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="e4092-129">Nous allons inclure dans notre page « par un rôle » et « par utilisateur » interfaces.</span><span class="sxs-lookup"><span data-stu-id="e4092-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="e4092-130">Nous allons commencer par la création de l’interface « par utilisateur ».</span><span class="sxs-lookup"><span data-stu-id="e4092-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="e4092-131">Cette interface se compose d’une liste déroulante et une liste de cases à cocher.</span><span class="sxs-lookup"><span data-stu-id="e4092-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="e4092-132">La liste déroulante contiendra l’ensemble des utilisateurs dans le système ; les cases à cocher énumère les rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="e4092-133">Sélection d’un utilisateur dans la liste déroulante vérifie ces rôles de que l’utilisateur appartient.</span><span class="sxs-lookup"><span data-stu-id="e4092-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="e4092-134">La personne visitant la page puis vérifiez ou désactivez les cases à cocher pour ajouter ou supprimer l’utilisateur sélectionné à partir des rôles correspondants.</span><span class="sxs-lookup"><span data-stu-id="e4092-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="e4092-135">À l’aide d’une liste déroulante liste à la liste les comptes d’utilisateur n’est pas un choix idéal pour les sites Web où il peut y avoir des centaines de comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="e4092-136">Une liste déroulante est conçue pour permettre à un utilisateur de choisir un élément dans une liste relativement courte des options.</span><span class="sxs-lookup"><span data-stu-id="e4092-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="e4092-137">Il peut devenir difficile à gérer que le nombre d’éléments de liste augmente.</span><span class="sxs-lookup"><span data-stu-id="e4092-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="e4092-138">Si vous créez un site Web qui aura un grand nombre de comptes d’utilisateur, vous souhaiterez à l’aide d’une autre interface utilisateur, telles que les un GridView paginable ou une interface filtrable qui répertorie les invites visiteur à choisir une lettre, puis uniquement Affiche les utilisateurs dont nom d’utilisateur commence par la lettre sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e4092-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>

## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="e4092-139">Étape 1 : Création de l’Interface utilisateur « Par utilisateur »</span><span class="sxs-lookup"><span data-stu-id="e4092-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="e4092-140">Ouvrez le `UsersAndRoles.aspx` page.</span><span class="sxs-lookup"><span data-stu-id="e4092-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="e4092-141">En haut de la page, ajoutez un contrôle Web Label nommé `ActionStatus` et effacer son `Text` propriété.</span><span class="sxs-lookup"><span data-stu-id="e4092-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="e4092-142">Nous allons utiliser cette étiquette pour fournir des commentaires sur les actions effectuées, affichage des messages comme, « utilisateur Tito a été ajouté au rôle Administrateurs » ou « Jisun de l’utilisateur a été supprimé du rôle superviseurs. »</span><span class="sxs-lookup"><span data-stu-id="e4092-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="e4092-143">Afin de rendre ces messages se distinguent, définie l’étiquette `CssClass` propriété à « Important ».</span><span class="sxs-lookup"><span data-stu-id="e4092-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample1.aspx)]

<span data-ttu-id="e4092-144">Ensuite, ajoutez la définition de classe CSS suivante à la `Styles.css` feuille de style :</span><span class="sxs-lookup"><span data-stu-id="e4092-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-vb/samples/sample2.css)]

<span data-ttu-id="e4092-145">Cette définition CSS indique au navigateur pour afficher l’étiquette à l’aide d’une police rouge volumineuse.</span><span class="sxs-lookup"><span data-stu-id="e4092-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="e4092-146">Figure 1 montre à cet effet par le biais du concepteur Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e4092-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>

<span data-ttu-id="e4092-147">[![La propriété l’étiquette CssClass entraîne une grande police rouge](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span></span>

<span data-ttu-id="e4092-148">**Figure 1**: L’étiquette `CssClass` propriété entraîne une grande taille, police de rouge ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image3.png))</span></span>

<span data-ttu-id="e4092-149">Ensuite, ajoutez un contrôle DropDownList à la page, définissez son `ID` propriété `UserList`et définissez son `AutoPostBack` True à la propriété.</span><span class="sxs-lookup"><span data-stu-id="e4092-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="e4092-150">Nous utiliserons cette DropDownList pour répertorier tous les utilisateurs dans le système.</span><span class="sxs-lookup"><span data-stu-id="e4092-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="e4092-151">Cette DropDownList sera lié à une collection d’objets de MembershipUser.</span><span class="sxs-lookup"><span data-stu-id="e4092-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="e4092-152">Étant donné que nous voulons DropDownList pour afficher la propriété de nom d’utilisateur de l’objet MembershipUser (et l’utiliser comme la valeur des éléments de liste), définissez la DropDownList `DataTextField` et `DataValueField` propriétés « UserName ».</span><span class="sxs-lookup"><span data-stu-id="e4092-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="e4092-153">Sous l’objet DropDownList, ajoutez un répéteur nommé `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="e4092-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="e4092-154">Ce Repeater répertorie tous les rôles dans le système en tant que série de cases à cocher.</span><span class="sxs-lookup"><span data-stu-id="e4092-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="e4092-155">Définir le Repeater `ItemTemplate` utilisant le balisage déclaratif suivant :</span><span class="sxs-lookup"><span data-stu-id="e4092-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample3.aspx)]

<span data-ttu-id="e4092-156">Le `ItemTemplate` balisage inclut un contrôle de case à cocher Web unique nommé `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="e4092-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="e4092-157">La case à cocher `AutoPostBack` propriété est définie sur True et la `Text` propriété est liée à `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="e4092-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="e4092-158">La raison de la syntaxe de liaison de données est simplement `Container.DataItem` effet, le framework de rôles renvoie la liste des noms de rôles en tant que tableau de chaînes, et il est ce tableau de chaînes qui nous sera contraignant pour le contrôle Repeater.</span><span class="sxs-lookup"><span data-stu-id="e4092-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="e4092-159">Une description détaillée de la raison pour laquelle cette syntaxe est utilisée pour afficher le contenu d’un tableau lié à un contrôle Web de données n’entre pas dans le cadre de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="e4092-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="e4092-160">Pour plus d’informations sur ce sujet, reportez-vous à [un tableau scalaire de liaison à un contrôle Web de données](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4092-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="e4092-161">À ce stade balisage déclaratif de votre interface de « par utilisateur » doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="e4092-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample4.aspx)]

<span data-ttu-id="e4092-162">Nous sommes maintenant prêts à écrire le code pour lier l’ensemble des comptes d’utilisateur à la liste DropDownList et de l’ensemble de rôles pour le contrôle Repeater.</span><span class="sxs-lookup"><span data-stu-id="e4092-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="e4092-163">Dans la classe de code-behind de la page, ajoutez une méthode nommée `BindUsersToUserList` et un autre nommé `BindRolesList`, en utilisant le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e4092-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample5.vb)]

<span data-ttu-id="e4092-164">Le `BindUsersToUserList` méthode récupère tous les comptes d’utilisateur dans le système via le [ `Membership.GetAllUsers` méthode](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4092-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="e4092-165">Cette commande renvoie un [ `MembershipUserCollection` objet](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), qui est une collection de [ `MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4092-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="e4092-166">Cette collection est ensuite liée à la `UserList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e4092-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="e4092-167">Le `MembershipUser` cette composition de la collection contient un certain nombre de propriétés, telles que les instances `UserName`, `Email`, `CreationDate`, et `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="e4092-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="e4092-168">Pour indiquer à l’objet DropDownList pour afficher la valeur de la `UserName` propriété, vérifiez que le `UserList` de DropDownList `DataTextField` et `DataValueField` propriétés ont été définies à « UserName ».</span><span class="sxs-lookup"><span data-stu-id="e4092-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="e4092-169">Le `Membership.GetAllUsers` méthode a deux surcharges : une qui n’accepte aucun paramètre d’entrée et retourne tous les utilisateurs et une qui prend les valeurs entières pour les index et la taille de la page et retourne uniquement le sous-ensemble spécifié d’utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="e4092-170">Lorsqu’il existe de grandes quantités de comptes d’utilisateur qui est affichés dans un élément d’interface utilisateur paginable, la deuxième surcharge peut être utilisé de parcourir plus efficacement les utilisateurs dans la mesure où elle retourne uniquement le sous-ensemble précis de comptes d’utilisateurs plutôt que tous les.</span><span class="sxs-lookup"><span data-stu-id="e4092-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>

<span data-ttu-id="e4092-171">Le `BindRolesToList` méthode démarre en appelant le `Roles` la classe [ `GetAllRoles` méthode](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), qui retourne un tableau de chaînes contenant les rôles dans le système.</span><span class="sxs-lookup"><span data-stu-id="e4092-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="e4092-172">Ce tableau de chaînes est ensuite lié au répéteur.</span><span class="sxs-lookup"><span data-stu-id="e4092-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="e4092-173">Enfin, nous devons appeler ces deux méthodes lorsque la page est chargée.</span><span class="sxs-lookup"><span data-stu-id="e4092-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="e4092-174">Ajoutez le code suivant au gestionnaire d'événements `Page_Load` :</span><span class="sxs-lookup"><span data-stu-id="e4092-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample6.vb)]

<span data-ttu-id="e4092-175">Avec ce code en place, prenez un moment pour visiter la page via un navigateur ; votre écran doit ressembler à la Figure 2.</span><span class="sxs-lookup"><span data-stu-id="e4092-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="e4092-176">Tous les comptes d’utilisateurs sont remplis dans la liste déroulante et, en dessous, chaque rôle apparaît sous la forme d’une case à cocher.</span><span class="sxs-lookup"><span data-stu-id="e4092-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="e4092-177">Car nous avons défini le `AutoPostBack` propriétés des cases à cocher et DropDownList sur True, modification de l’utilisateur sélectionné ou en activant ou en désactivant un rôle provoque une publication (postback).</span><span class="sxs-lookup"><span data-stu-id="e4092-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="e4092-178">Aucune action n’est effectuée, toutefois, étant donné que nous devons encore écrire du code pour gérer ces actions.</span><span class="sxs-lookup"><span data-stu-id="e4092-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="e4092-179">Nous les aborderons ces tâches dans les deux sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="e4092-179">We'll tackle these tasks in the next two sections.</span></span>

<span data-ttu-id="e4092-180">[![La Page affiche les utilisateurs et rôles](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span></span>

<span data-ttu-id="e4092-181">**Figure 2**: La Page affiche les utilisateurs et les rôles ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image6.png))</span></span>

### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="e4092-182">Vérifier les rôles de l’utilisateur sélectionné appartient</span><span class="sxs-lookup"><span data-stu-id="e4092-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="e4092-183">Lorsque la page est chargée, ou chaque fois que le visiteur sélectionne un nouvel utilisateur dans la liste déroulante, nous devons mettre à jour le `UsersRoleList`de cases à cocher afin qu’une case à cocher du rôle donné est activée uniquement si l’utilisateur sélectionné appartient à ce rôle.</span><span class="sxs-lookup"><span data-stu-id="e4092-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="e4092-184">Pour ce faire, créez une méthode nommée `CheckRolesForSelectedUser` avec le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e4092-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample7.vb)]

<span data-ttu-id="e4092-185">Le code ci-dessus commence par déterminer qui est l’utilisateur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="e4092-186">Il utilise ensuite la classe rôles [ `GetRolesForUser(userName)` méthode](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) pour renvoyer l’ensemble de l’utilisateur spécifié des rôles en tant que tableau de chaînes.</span><span class="sxs-lookup"><span data-stu-id="e4092-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="e4092-187">Ensuite, les éléments de répéteur sont énumérées et de chaque élément `RoleCheckBox` case à cocher est référencé par programmation.</span><span class="sxs-lookup"><span data-stu-id="e4092-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="e4092-188">La case à cocher est activée uniquement si le rôle qu’il correspond à est contenu dans le `selectedUsersRoles` tableau de chaînes.</span><span class="sxs-lookup"><span data-stu-id="e4092-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="e4092-189">Le `Linq.Enumerable.Contains(Of String)(...)` syntaxe ne compilera pas si vous n’utilisez pas ASP.NET version 2.0.</span><span class="sxs-lookup"><span data-stu-id="e4092-189">The `Linq.Enumerable.Contains(Of String)(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="e4092-190">Le `Contains(Of String)` méthode fait partie de la [bibliothèque LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query), qui est une nouveauté pour ASP.NET 3.5.</span><span class="sxs-lookup"><span data-stu-id="e4092-190">The `Contains(Of String)` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="e4092-191">Si vous continuez d’utiliser ASP.NET version 2.0, utilisez la [ `Array.IndexOf(Of String)` méthode](https://msdn.microsoft.com/library/eha9t187.aspx) à la place.</span><span class="sxs-lookup"><span data-stu-id="e4092-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf(Of String)` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>

<span data-ttu-id="e4092-192">Le `CheckRolesForSelectedUser` méthode doit être appelée dans deux cas : lorsque la page est chargée et chaque fois que le `UserList` de DropDownList sélectionné est modifié.</span><span class="sxs-lookup"><span data-stu-id="e4092-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="e4092-193">Par conséquent, appelez cette méthode à partir de la `Page_Load` Gestionnaire d’événements (après les appels à `BindUsersToUserList` et `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="e4092-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="e4092-194">En outre, créez un gestionnaire d’événements pour la DropDownList `SelectedIndexChanged` événement et appeler cette méthode à partir de là.</span><span class="sxs-lookup"><span data-stu-id="e4092-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample8.vb)]

<span data-ttu-id="e4092-195">Avec ce code en place, vous pouvez tester la page via le navigateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="e4092-196">Toutefois, étant donné que le `UsersAndRoles.aspx` page ne dispose pas actuellement la possibilité d’affecter des utilisateurs aux rôles, aucun utilisateur n’a de rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="e4092-197">Nous allons créer l’interface pour l’affectation d’utilisateurs aux rôles dans un instant, afin de prendre mon mot que ce code fonctionne et vérifiez qu’il le fait ultérieurement, ou vous pouvez ajouter manuellement des utilisateurs aux rôles en insérant des enregistrements dans la `aspnet_UsersInRoles` table afin de tester cette functi onality maintenant.</span><span class="sxs-lookup"><span data-stu-id="e4092-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="e4092-198">Affectation et la suppression des utilisateurs des rôles</span><span class="sxs-lookup"><span data-stu-id="e4092-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="e4092-199">Lorsque le visiteur vérifie ou désactive une case à cocher dans la `UsersRoleList` Repeater, nous devons ajouter ou supprimer l’utilisateur sélectionné dans le rôle correspondant.</span><span class="sxs-lookup"><span data-stu-id="e4092-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="e4092-200">La case à cocher `AutoPostBack` propriété est actuellement définie sur True, ce qui provoque une publication (postback) chaque fois qu’une case à cocher dans le contrôle Repeater est activée ou désactivée.</span><span class="sxs-lookup"><span data-stu-id="e4092-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="e4092-201">En bref, nous devons créer un gestionnaire d’événements pour la case à cocher `CheckChanged` événement.</span><span class="sxs-lookup"><span data-stu-id="e4092-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="e4092-202">Étant donné que la case à cocher est dans un contrôle Repeater, nous devons ajouter manuellement la plomberie de gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="e4092-203">Commencez par ajouter le Gestionnaire d’événements à la classe code-behind, comme un `Protected` (méthode), comme suit :</span><span class="sxs-lookup"><span data-stu-id="e4092-203">Start by adding the event handler to the code-behind class as a `Protected` method, like so:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample9.vb)]

<span data-ttu-id="e4092-204">Nous retournera pour écrire le code pour ce gestionnaire d’événements dans un instant.</span><span class="sxs-lookup"><span data-stu-id="e4092-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="e4092-205">Mais tout d’abord terminons la plomberie de gestion d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="e4092-206">À partir de la case à cocher dans le répéteur `ItemTemplate`, ajoutez `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="e4092-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="e4092-207">Cette syntaxe associe la `RoleCheckBox_CheckChanged` Gestionnaire d’événements à la `RoleCheckBox`de `CheckedChanged` événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample10.aspx)]

<span data-ttu-id="e4092-208">La dernière tâche consiste à effectuer la `RoleCheckBox_CheckChanged` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="e4092-209">Nous devons commencer en référençant le contrôle de case à cocher qui a déclenché l’événement, car cette instance de la case à cocher indique que le rôle a été activée ou désactivée par le biais de son `Text` et `Checked` propriétés.</span><span class="sxs-lookup"><span data-stu-id="e4092-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="e4092-210">À l’aide de ces informations avec le nom d’utilisateur de l’utilisateur sélectionné, nous ajouter ou supprimer l’utilisateur du rôle via le `Roles` la classe [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) ou [ `RemoveUserFromRole` méthode](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4092-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample11.vb)]

<span data-ttu-id="e4092-211">Le code ci-dessus commence par référencer par programmation de la case à cocher qui a déclenché l’événement, qui est disponible via le `sender` paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="e4092-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="e4092-212">Si la case à cocher est activée, l’utilisateur sélectionné est ajouté au rôle spécifié, sinon qu'ils sont supprimés du rôle.</span><span class="sxs-lookup"><span data-stu-id="e4092-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="e4092-213">Dans les deux cas, le `ActionStatus` étiquette affiche un message qui résume l’action qui vient d’être exécutée.</span><span class="sxs-lookup"><span data-stu-id="e4092-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="e4092-214">Prenez un moment pour tester cette page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="e4092-215">Sélectionnez utilisateur Tito, puis ajoutez Tito aux rôles les administrateurs et les superviseurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>

<span data-ttu-id="e4092-216">[![Tito a été ajoutée pour les administrateurs et les rôles de superviseurs](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span></span>

<span data-ttu-id="e4092-217">**Figure 3**: Tito a été ajoutée pour les administrateurs et les rôles de superviseurs ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image9.png))</span></span>

<span data-ttu-id="e4092-218">Ensuite, sélectionnez utilisateur Bruce dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="e4092-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="e4092-219">Il existe une publication (postback) et les cases à cocher du répéteur sont mis à jour le `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="e4092-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="e4092-220">Dans la mesure où Bruce n’appartient pas encore à tous les rôles, les deux cases sont désactivés.</span><span class="sxs-lookup"><span data-stu-id="e4092-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="e4092-221">Ensuite, ajoutez Bruce au rôle superviseurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-221">Next, add Bruce to the Supervisors role.</span></span>

<span data-ttu-id="e4092-222">[![Bruce a été ajouté au rôle superviseurs](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span></span>

<span data-ttu-id="e4092-223">**Figure 4**: Bruce a été ajouté au rôle superviseurs ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image12.png))</span></span>

<span data-ttu-id="e4092-224">Pour vérifier les fonctionnalités de la `CheckRolesForSelectedUser` (méthode), sélectionnez un utilisateur autre que Tito ou Bruce.</span><span class="sxs-lookup"><span data-stu-id="e4092-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="e4092-225">Notez la façon dont les cases à cocher sont automatiquement désactivés, indiquant qu’ils n’appartiennent pas à tous les rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="e4092-226">Revenir à Tito.</span><span class="sxs-lookup"><span data-stu-id="e4092-226">Return to Tito.</span></span> <span data-ttu-id="e4092-227">Les administrateurs et les superviseurs cases à cocher doit être vérifiée.</span><span class="sxs-lookup"><span data-stu-id="e4092-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="e4092-228">Étape 2 : Création de l’Interface utilisateur « Par les rôles »</span><span class="sxs-lookup"><span data-stu-id="e4092-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="e4092-229">À ce stade nous l’interface « par les utilisateurs » s’est terminé et que vous êtes prêts à commencer à vous attaquer l’interface « par rôles ».</span><span class="sxs-lookup"><span data-stu-id="e4092-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="e4092-230">L’interface « par rôles » invite l’utilisateur à sélectionner un rôle dans la liste déroulante, puis affiche l’ensemble des utilisateurs qui appartiennent à ce rôle dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="e4092-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="e4092-231">Ajoutez un autre contrôle DropDownList pour la `UsersAndRoles.aspx page`.</span><span class="sxs-lookup"><span data-stu-id="e4092-231">Add another DropDownList control to the `UsersAndRoles.aspx page`.</span></span> <span data-ttu-id="e4092-232">Placer celle-ci sous le contrôle Repeater, nommez-le `RoleList`et définissez son `AutoPostBack` True à la propriété.</span><span class="sxs-lookup"><span data-stu-id="e4092-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="e4092-233">En dessous, ajoutez un GridView et nommez-le `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="e4092-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="e4092-234">Ce GridView répertorie les utilisateurs qui appartiennent au rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="e4092-235">Définir le GridView `AutoGenerateColumns` propriété sur False, ajouter un TemplateField à la grille `Columns` collection et définissez son `HeaderText` propriété à « Utilisateurs ».</span><span class="sxs-lookup"><span data-stu-id="e4092-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="e4092-236">Définir le TemplateField `ItemTemplate` afin qu’il affiche la valeur de l’expression de liaison de données `Container.DataItem` dans le `Text` propriété d’une étiquette nommée `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="e4092-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="e4092-237">Après avoir ajouté et configuré le contrôle GridView, balisage déclaratif de votre interface de « par le rôle » doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="e4092-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample12.aspx)]

<span data-ttu-id="e4092-238">Nous avons besoin remplir le `RoleList` DropDownList avec l’ensemble de rôles dans le système.</span><span class="sxs-lookup"><span data-stu-id="e4092-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="e4092-239">Pour ce faire, mettez à jour le `BindRolesToList` méthode voilà lie le tableau de chaînes retourné par la `Roles.GetAllRoles` méthode à la `RolesList` DropDownList (ainsi que le `UsersRoleList` Repeater).</span><span class="sxs-lookup"><span data-stu-id="e4092-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample13.vb)]

<span data-ttu-id="e4092-240">Les deux dernières lignes dans le `BindRolesToList` méthode ont été ajoutées pour lier l’ensemble de rôles à le `RoleList` contrôle DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e4092-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="e4092-241">La figure 5 illustre le résultat final, lorsqu’ils sont affichés via un navigateur : une liste déroulante remplie avec les rôles du système.</span><span class="sxs-lookup"><span data-stu-id="e4092-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>

<span data-ttu-id="e4092-242">[![Les rôles sont affichés dans RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span></span>

<span data-ttu-id="e4092-243">**Figure 5**: Les rôles sont affichés dans le `RoleList` DropDownList ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image15.png))</span></span>

### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="e4092-244">Afficher les utilisateurs qui appartiennent au rôle sélectionné</span><span class="sxs-lookup"><span data-stu-id="e4092-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="e4092-245">Lorsque la page est chargée, ou quand un nouveau rôle est sélectionné dans le `RoleList` DropDownList, nous avons besoin afficher la liste des utilisateurs qui appartiennent à ce rôle dans le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="e4092-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="e4092-246">Créez une méthode nommée `DisplayUsersBelongingToRole` utilisant le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e4092-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample14.vb)]

<span data-ttu-id="e4092-247">Cette méthode démarre en obtenant le rôle sélectionné à partir de la `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e4092-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="e4092-248">Il utilise ensuite le [ `Roles.GetUsersInRole(roleName)` méthode](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) pour récupérer un tableau de chaînes des noms d’utilisateur des utilisateurs qui appartiennent à ce rôle.</span><span class="sxs-lookup"><span data-stu-id="e4092-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="e4092-249">Ce tableau est ensuite lié à la `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="e4092-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="e4092-250">Cette méthode doit être appelée dans deux cas : lorsque la page est chargée initialement et lorsque le rôle sélectionné dans la `RoleList` DropDownList modifications.</span><span class="sxs-lookup"><span data-stu-id="e4092-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="e4092-251">Par conséquent, mettre à jour le `Page_Load` Gestionnaire d’événements afin que cette méthode est appelée après l’appel à `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="e4092-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="e4092-252">Ensuite, créez un gestionnaire d’événements pour le `RoleList`de `SelectedIndexChanged` événement et appeler cette méthode à partir de là, trop.</span><span class="sxs-lookup"><span data-stu-id="e4092-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample15.vb)]

<span data-ttu-id="e4092-253">Avec ce code en place, le `RolesUserList` GridView doit afficher les utilisateurs qui appartiennent au rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="e4092-254">Comme le montre la Figure 6, le rôle superviseurs se compose de deux membres : Bruce et Tito.</span><span class="sxs-lookup"><span data-stu-id="e4092-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>

<span data-ttu-id="e4092-255">[![Le contrôle GridView répertorie les utilisateurs qui appartiennent au rôle sélectionné](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span></span>

<span data-ttu-id="e4092-256">**Figure 6**: Le GridView répertorie ceux les utilisateurs qu’appartiennent au rôle sélectionné ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image18.png))</span></span>

### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="e4092-257">Suppression d’utilisateurs dans le rôle sélectionné</span><span class="sxs-lookup"><span data-stu-id="e4092-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="e4092-258">Nous allons augmenter la `RolesUserList` GridView afin qu’il inclue une colonne de « supprimer » de boutons.</span><span class="sxs-lookup"><span data-stu-id="e4092-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="e4092-259">En cliquant sur le bouton « Supprimer » pour un utilisateur particulier supprime les de ce rôle.</span><span class="sxs-lookup"><span data-stu-id="e4092-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="e4092-260">Commencez par ajouter un champ de bouton de suppression pour le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="e4092-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="e4092-261">Rendre ce champ apparaissent sous la forme la plus archivé de gauche et de modifier son `DeleteText` propriété à partir de « Delete » (la valeur par défaut) à « Supprimer ».</span><span class="sxs-lookup"><span data-stu-id="e4092-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>

<span data-ttu-id="e4092-262">[![Ajouter le](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-262">[![Add the](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span></span>

<span data-ttu-id="e4092-263">**Figure 7**: Ajouter le bouton « Supprimer » pour le contrôle GridView ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image21.png))</span></span>

<span data-ttu-id="e4092-264">Un clic sur le bouton « Supprimer » est une publication (postback) s’ensuit et le GridView `RowDeleting` événement est déclenché.</span><span class="sxs-lookup"><span data-stu-id="e4092-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="e4092-265">Nous devons créer un gestionnaire d’événements pour cet événement et d’écrire du code qui supprime l’utilisateur le rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="e4092-266">Créer le Gestionnaire d’événements et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e4092-266">Create the event handler and then add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample16.vb)]

<span data-ttu-id="e4092-267">Le code commence par déterminer le nom du rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="e4092-268">Puis par programmation références le `UserNameLabel` contrôle à partir de la ligne dont bouton « Supprimer » a été utilisé afin de déterminer le nom d’utilisateur de l’utilisateur à supprimer.</span><span class="sxs-lookup"><span data-stu-id="e4092-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="e4092-269">L’utilisateur est ensuite supprimé le rôle via un appel à la `Roles.RemoveUserFromRole` (méthode).</span><span class="sxs-lookup"><span data-stu-id="e4092-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="e4092-270">Le `RolesUserList` GridView est alors actualisée et un message s’affiche la `ActionStatus` contrôle Label.</span><span class="sxs-lookup"><span data-stu-id="e4092-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="e4092-271">Le bouton « Supprimer » ne nécessite pas une forme quelconque de confirmation de l’utilisateur avant de supprimer l’utilisateur du rôle.</span><span class="sxs-lookup"><span data-stu-id="e4092-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="e4092-272">Je vous invite à ajouter un niveau de confirmation de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="e4092-273">Une des méthodes plus simples pour confirmer une action est via une boîte de dialogue de confirmation du côté client.</span><span class="sxs-lookup"><span data-stu-id="e4092-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="e4092-274">Pour plus d’informations sur cette technique, consultez [Ajout côté Client Confirmation lors de la suppression](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4092-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>

<span data-ttu-id="e4092-275">La figure 8 illustre la page une fois que l’utilisateur Tito a été supprimé du groupe superviseurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>

<span data-ttu-id="e4092-276">[![Hélas, Tito n’est plus un superviseur](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span></span>

<span data-ttu-id="e4092-277">**Figure 8**: Hélas, Tito n’est plus un superviseur ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image24.png))</span></span>

### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="e4092-278">Ajout de nouveaux utilisateurs au rôle sélectionné</span><span class="sxs-lookup"><span data-stu-id="e4092-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="e4092-279">Ainsi que la suppression d’utilisateurs dans le rôle sélectionné, le visiteur à cette page doit également être en mesure d’ajouter un utilisateur au rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="e4092-280">La meilleure interface pour l’ajout d’un utilisateur au rôle sélectionné varie selon le nombre de comptes d’utilisateur que vous prévoyez d’avoir.</span><span class="sxs-lookup"><span data-stu-id="e4092-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="e4092-281">Si votre site Web va héberger quelques comptes d’utilisateur douzaines ou moins, vous pouvez utiliser un DropDownList ici.</span><span class="sxs-lookup"><span data-stu-id="e4092-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="e4092-282">S’il peut y avoir des milliers de comptes d’utilisateur, vous pouvez inclure une interface utilisateur qui autorise le visiteur pour parcourir les comptes, recherche d’un compte particulier, ou de filtrer les comptes d’utilisateur d’une autre façon.</span><span class="sxs-lookup"><span data-stu-id="e4092-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="e4092-283">Pour cette page Nous allons utiliser une interface très simple qui fonctionne indépendamment du nombre de comptes d’utilisateur dans le système.</span><span class="sxs-lookup"><span data-stu-id="e4092-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="e4092-284">À savoir, nous allons utiliser une zone de texte, en invitant le visiteur à taper le nom d’utilisateur de l’utilisateur que vous souhaitez ajouter au rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="e4092-285">Si aucun utilisateur portant ce nom n’existe, ou si l’utilisateur est déjà un membre du rôle, nous affichons un message dans `ActionStatus` étiquette.</span><span class="sxs-lookup"><span data-stu-id="e4092-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="e4092-286">Mais si l’utilisateur existe et n’est pas un membre du rôle, nous allons les ajouter au rôle et actualiser la grille.</span><span class="sxs-lookup"><span data-stu-id="e4092-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="e4092-287">Ajoutez une zone de texte et un bouton sous le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="e4092-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="e4092-288">Définir la zone de texte `ID` à `UserNameToAddToRole` et affectez à la `ID` et `Text` propriétés à `AddUserToRoleButton` et « Ajouter au rôle d’utilisateur », respectivement.</span><span class="sxs-lookup"><span data-stu-id="e4092-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample17.aspx)]

<span data-ttu-id="e4092-289">Ensuite, créez un `Click` Gestionnaire d’événements pour le `AddUserToRoleButton` et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e4092-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample18.vb)]

<span data-ttu-id="e4092-290">La majorité du code dans le `Click` Gestionnaire d’événements effectue plusieurs vérifications de validation.</span><span class="sxs-lookup"><span data-stu-id="e4092-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="e4092-291">Elle garantit que le visiteur fourni un nom d’utilisateur dans le `UserNameToAddToRole` zone de texte, que l’utilisateur existe dans le système, et qui ils n’appartiennent pas déjà pour le rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="e4092-292">Si aucune de ces vérifications échoue, un message approprié s’affiche dans `ActionStatus` et que le Gestionnaire d’événements est quitté.</span><span class="sxs-lookup"><span data-stu-id="e4092-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="e4092-293">Si toutes les vérifications réussissent, l’utilisateur est ajouté au rôle via le `Roles.AddUserToRole` (méthode).</span><span class="sxs-lookup"><span data-stu-id="e4092-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="e4092-294">Après de cela, la zone de texte `Text` nettoyée de propriété, le contrôle GridView est actualisé et le `ActionStatus` étiquette affiche un message indiquant que l’utilisateur spécifié a été ajouté au rôle sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e4092-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="e4092-295">Pour vous assurer que l’utilisateur spécifié n’appartient pas déjà pour le rôle sélectionné, nous utilisons le [ `Roles.IsUserInRole(userName, roleName)` méthode](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), qui retourne une valeur booléenne indiquant si *nom d’utilisateur* est un membre de *roleName*.</span><span class="sxs-lookup"><span data-stu-id="e4092-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="e4092-296">Nous allons utiliser cette méthode à nouveau dans le <a id="_msoanchor_2"> </a> [didacticiel suivant](role-based-authorization-vb.md) lorsque nous examinons en fonction du rôle de l’autorisation.</span><span class="sxs-lookup"><span data-stu-id="e4092-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-vb.md) when we look at role-based authorization.</span></span>

<span data-ttu-id="e4092-297">Visitez la page via un navigateur et sélectionnez le rôle superviseurs à partir de la `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e4092-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="e4092-298">Essayez d’entrer un nom d’utilisateur non valide : vous devez voir un message expliquant que l’utilisateur n’existe pas dans le système.</span><span class="sxs-lookup"><span data-stu-id="e4092-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>

<span data-ttu-id="e4092-299">[![Impossible d’ajouter un utilisateur Non existants à un rôle](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span></span>

<span data-ttu-id="e4092-300">**Figure 9**: Vous ne pouvez pas ajouter un utilisateur d’inexistant à un rôle ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image27.png))</span></span>

<span data-ttu-id="e4092-301">Maintenant essayez d’ajouter un utilisateur valide.</span><span class="sxs-lookup"><span data-stu-id="e4092-301">Now try adding a valid user.</span></span> <span data-ttu-id="e4092-302">Continuez et ajoutez de nouveau Tito au rôle superviseurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-302">Go ahead and re-add Tito to the Supervisors role.</span></span>

<span data-ttu-id="e4092-303">[![Tito est à nouveau un superviseur !](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span></span>

<span data-ttu-id="e4092-304">**Figure 10**: Tito est à nouveau un superviseur !</span><span class="sxs-lookup"><span data-stu-id="e4092-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="e4092-305">([Cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-305">([Click to view full-size image](assigning-roles-to-users-vb/_static/image30.png))</span></span>

## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="e4092-306">Étape 3 : La mise à jour entre le « Par utilisateur » et « Par rôle » Interfaces</span><span class="sxs-lookup"><span data-stu-id="e4092-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="e4092-307">Le `UsersAndRoles.aspx` page offre deux interfaces distinctes pour la gestion des utilisateurs et des rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="e4092-308">Actuellement, ces deux interfaces agissent indépendamment les uns des autres, il est possible qu’une modification effectuée dans une interface n’est pas répercutée immédiatement dans l’autre.</span><span class="sxs-lookup"><span data-stu-id="e4092-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="e4092-309">Par exemple, imaginez que le visiteur à la page Sélectionne le rôle de superviseurs à partir de la `RoleList` DropDownList, qui répertorie les Bruce et Tito en tant que ses membres.</span><span class="sxs-lookup"><span data-stu-id="e4092-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="e4092-310">Ensuite, le visiteur sélectionne Tito à partir de la `UserList` DropDownList, qui vérifie les cases à cocher des contrôleurs et des administrateurs dans le `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="e4092-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="e4092-311">Si le visiteur désactive ensuite le rôle superviseur de répéteur, Tito est supprimé du rôle superviseurs, mais cette modification n’est pas répercutée dans l’interface « par rôle ».</span><span class="sxs-lookup"><span data-stu-id="e4092-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="e4092-312">Le contrôle GridView apparaît toujours Tito comme étant un membre du rôle superviseurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="e4092-313">Pour corriger cela nous devons actualiser le GridView chaque fois qu’un rôle est activé ou désactivé à partir de la `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="e4092-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="e4092-314">De même, nous devons actualiser le Repeater chaque fois qu’un utilisateur est supprimé ou ajouté à un rôle à partir de l’interface « par rôle ».</span><span class="sxs-lookup"><span data-stu-id="e4092-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="e4092-315">Le Repeater dans l’interface « par utilisateur » est actualisé en appelant le `CheckRolesForSelectedUser` (méthode).</span><span class="sxs-lookup"><span data-stu-id="e4092-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="e4092-316">L’interface « par rôle » peut être modifié dans le `RolesUserList` contrôle GridView `RowDeleting` Gestionnaire d’événements et le `AddUserToRoleButton` du bouton `Click` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="e4092-317">Par conséquent, nous devons appeler le `CheckRolesForSelectedUser` méthode à partir de chacune de ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="e4092-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample19.vb)]

<span data-ttu-id="e4092-318">De même, le contrôle GridView dans l’interface « par rôle » est actualisé en appelant le `DisplayUsersBelongingToRole` (méthode) et l’interface « par utilisateur » est modifié via le `RoleCheckBox_CheckChanged` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="e4092-319">Par conséquent, nous devons appeler le `DisplayUsersBelongingToRole` méthode à partir de ce gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample20.vb)]

<span data-ttu-id="e4092-320">Avec ces modifications mineures au code, le « par utilisateur » et « par rôle » interfaces désormais correctement entre la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="e4092-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="e4092-321">Pour vérifier ceci, visitez la page via un navigateur et sélectionnez Tito et superviseurs à partir de la `UserList` et `RoleList` DropDownList, respectivement.</span><span class="sxs-lookup"><span data-stu-id="e4092-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="e4092-322">Notez que comme vous désactivez le rôle superviseurs Tito à partir de l’opération de répétition dans l’interface « par utilisateur », Tito est automatiquement supprimé de la GridView dans l’interface « par rôle ».</span><span class="sxs-lookup"><span data-stu-id="e4092-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="e4092-323">Ajout automatique Tito au rôle superviseurs à partir de l’interface « par le rôle » vérifie à nouveau la case à cocher superviseurs dans l’interface « par utilisateur ».</span><span class="sxs-lookup"><span data-stu-id="e4092-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="e4092-324">Étape 4 : Personnalisation CreateUserWizard pour inclure une étape « Spécifier les rôles »</span><span class="sxs-lookup"><span data-stu-id="e4092-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="e4092-325">Dans le <a id="_msoanchor_3"> </a> [ *création de comptes utilisateur* ](../membership/creating-user-accounts-vb.md) didacticiel, nous avons vu comment utiliser le contrôle CreateUserWizard Web pour fournir une interface pour la création d’un nouveau compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-vb.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="e4092-326">Le contrôle CreateUserWizard peut être utilisé de deux manières :</span><span class="sxs-lookup"><span data-stu-id="e4092-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="e4092-327">Comme un moyen pour les visiteurs de créer leur propre compte d’utilisateur sur le site, et</span><span class="sxs-lookup"><span data-stu-id="e4092-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="e4092-328">Comme un moyen pour les administrateurs de créer des comptes</span><span class="sxs-lookup"><span data-stu-id="e4092-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="e4092-329">Dans le premier cas d’utilisation, un visiteur est fourni pour le site et remplit le contrôle CreateUserWizard, saisie des informations afin de s’inscrire sur le site.</span><span class="sxs-lookup"><span data-stu-id="e4092-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="e4092-330">Dans le deuxième cas, un administrateur crée un nouveau compte pour une autre personne.</span><span class="sxs-lookup"><span data-stu-id="e4092-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="e4092-331">Lorsqu’un compte est créé par un administrateur d’une autre personne, il peut être utile d’autoriser l’administrateur de spécifier les rôles que le nouveau compte d’utilisateur appartient.</span><span class="sxs-lookup"><span data-stu-id="e4092-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="e4092-332">Dans le <a id="_msoanchor_4"> </a> [ *stockage* *des informations utilisateur supplémentaires* ](../membership/storing-additional-user-information-vb.md) didacticiel, nous avons vu comment personnaliser le contrôle CreateUserWizard en ajoutant supplémentaires `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="e4092-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="e4092-333">Nous allons examiner comment ajouter une étape supplémentaire pour le contrôle CreateUserWizard afin de spécifier les rôles du nouvel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="e4092-334">Ouvrez le `CreateUserWizardWithRoles.aspx` page et ajoutez un contrôle CreateUserWizard nommé `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="e4092-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="e4092-335">Définir le contrôle `ContinueDestinationPageUrl` propriété à « ~ / Default.aspx ».</span><span class="sxs-lookup"><span data-stu-id="e4092-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="e4092-336">Étant donné que l’idée ici est qu’un administrateur l’utiliserez ce contrôle CreateUserWizard pour créer de nouveaux comptes d’utilisateur, définissez le contrôle `LoginCreatedUser` False à la propriété.</span><span class="sxs-lookup"><span data-stu-id="e4092-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="e4092-337">Cela `LoginCreatedUser` propriété spécifie si le visiteur est automatiquement connecté en tant que l’utilisateur récemment créée, et sa valeur par défaut sur True.</span><span class="sxs-lookup"><span data-stu-id="e4092-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="e4092-338">Nous affectez-lui la valeur False, car lorsqu’un administrateur crée un nouveau compte nous souhaitons lui connecté en tant que lui-même.</span><span class="sxs-lookup"><span data-stu-id="e4092-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="e4092-339">Ensuite, sélectionnez le « Ajout/suppression `WizardSteps`... » option à partir de la balise active de CreateUserWizard et ajouter un nouveau `WizardStep`, ce qui affecte son `ID` à `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="e4092-339">Next, select the "Add/Remove `WizardSteps`…" option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="e4092-340">Déplacer le `SpecifyRolesStep WizardStep` afin qu’il s’agit d’après l’étape « Sign Up for votre nouveau compte », mais avant l’étape « Complete ».</span><span class="sxs-lookup"><span data-stu-id="e4092-340">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="e4092-341">Définir le `WizardStep`de `Title` propriété à « Spécifier les rôles », son `StepType` propriété `Step`et son `AllowReturn` False à la propriété.</span><span class="sxs-lookup"><span data-stu-id="e4092-341">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>

<span data-ttu-id="e4092-342">[![Ajouter le](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-342">[![Add the](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span></span>

<span data-ttu-id="e4092-343">**Figure 11**: Ajouter le « spécifier les rôles » `WizardStep` à CreateUserWizard ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-343">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image33.png))</span></span>

<span data-ttu-id="e4092-344">Après cette modification balisage déclaratif de votre CreateUserWizard doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="e4092-344">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample21.aspx)]

<span data-ttu-id="e4092-345">Dans le « spécifier les rôles » `WizardStep`, ajouter CheckBoxList nommé `RoleList.` CheckBoxList This répertorie les rôles disponibles, l’activation de la personne visitant la page vérifier quels rôles de l’utilisateur nouvellement créé appartient.</span><span class="sxs-lookup"><span data-stu-id="e4092-345">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList.` This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="e4092-346">Nous restons confrontés à deux tâches de codage : nous devons tout d’abord remplir la `RoleList` CheckBoxList avec les rôles dans le système ; ensuite, nous devons ajouter l’utilisateur créé pour les rôles sélectionnés lorsque l’utilisateur déplace à partir de l’étape « Spécifier les rôles » à l’étape « Terminé ».</span><span class="sxs-lookup"><span data-stu-id="e4092-346">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="e4092-347">Nous pouvons atteindre la première tâche dans le `Page_Load` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4092-347">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="e4092-348">Le code suivant par programmation références le `RoleList` case à cocher dans la première, visitez la page et lie les rôles dans le système à celle-ci.</span><span class="sxs-lookup"><span data-stu-id="e4092-348">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample22.vb)]

<span data-ttu-id="e4092-349">Le code ci-dessus doit sembler familière.</span><span class="sxs-lookup"><span data-stu-id="e4092-349">The above code should look familiar.</span></span> <span data-ttu-id="e4092-350">Dans le <a id="_msoanchor_5"> </a> [ *stockage* *des informations utilisateur supplémentaires* ](../membership/storing-additional-user-information-vb.md) didacticiel, nous avons utilisé deux `FindControl` instructions pour référencer un contrôle Web à partir de dans un personnalisé `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="e4092-350">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="e4092-351">Et le code qui lie les rôles à CheckBoxList a été extraite précédemment dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="e4092-351">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="e4092-352">Pour effectuer la seconde tâche de programmation, nous devons savoir quand l’étape « Spécifier les rôles » a été effectuée.</span><span class="sxs-lookup"><span data-stu-id="e4092-352">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="e4092-353">Souvenez-vous que le contrôle CreateUserWizard a un `ActiveStepChanged` événement qui se déclenche chaque fois que le visiteur accède à partir d’une seule étape à l’autre.</span><span class="sxs-lookup"><span data-stu-id="e4092-353">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="e4092-354">Ici, nous pouvons déterminer si l’utilisateur a atteint l’étape « Terminé ». Dans ce cas, nous devons ajouter l’utilisateur pour les rôles sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="e4092-354">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="e4092-355">Créer un gestionnaire d’événements pour le `ActiveStepChanged` événement et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="e4092-355">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample23.vb)]

<span data-ttu-id="e4092-356">Si l’utilisateur a atteint uniquement l’étape « Terminé », le Gestionnaire d’événements énumère les éléments de la `RoleList` CheckBoxList et l’utilisateur nouvellement créé est affectée aux rôles sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="e4092-356">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="e4092-357">Visitez cette page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-357">Visit this page through a browser.</span></span> <span data-ttu-id="e4092-358">La première étape dans le contrôle CreateUserWizard est l’étape « Sign Up for votre nouveau compte » standard, qui invite à entrer le nouveau nom d’utilisateur, mot de passe, messagerie et autres informations clés.</span><span class="sxs-lookup"><span data-stu-id="e4092-358">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="e4092-359">Entrez les informations pour créer un utilisateur nommé Wanda.</span><span class="sxs-lookup"><span data-stu-id="e4092-359">Enter the information to create a new user named Wanda.</span></span>

<span data-ttu-id="e4092-360">[![Créer un utilisateur nommé Wanda](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-360">[![Create a New User Named Wanda](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span></span>

<span data-ttu-id="e4092-361">**Figure 12**: Créer un nouveau Wanda de nommé utilisateur ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-361">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image36.png))</span></span>

<span data-ttu-id="e4092-362">Cliquez sur le bouton « Create User ».</span><span class="sxs-lookup"><span data-stu-id="e4092-362">Click the "Create User" button.</span></span> <span data-ttu-id="e4092-363">CreateUserWizard appelle en interne la `Membership.CreateUser` méthode, la création du nouveau compte d’utilisateur, puis passe à l’étape suivante, « spécifier les rôles ».</span><span class="sxs-lookup"><span data-stu-id="e4092-363">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="e4092-364">Ici, les rôles de système sont répertoriés.</span><span class="sxs-lookup"><span data-stu-id="e4092-364">Here the system roles are listed.</span></span> <span data-ttu-id="e4092-365">Activez la case à cocher superviseurs et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="e4092-365">Check the Supervisors checkbox and click Next.</span></span>

<span data-ttu-id="e4092-366">[![Faire Wanda un membre du rôle superviseurs](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-366">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span></span>

<span data-ttu-id="e4092-367">**Figure 13**: Faire Wanda un membre du rôle superviseurs ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-367">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image39.png))</span></span>

<span data-ttu-id="e4092-368">Clic sur suivant provoque une publication (postback) et les mises à jour le `ActiveStep` à l’étape « Terminé ».</span><span class="sxs-lookup"><span data-stu-id="e4092-368">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="e4092-369">Dans le `ActiveStepChanged` Gestionnaire d’événements, le compte d’utilisateur récemment créé est affecté au rôle superviseurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-369">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="e4092-370">Pour vérifier ceci, revenez à la `UsersAndRoles.aspx` page et sélectionnez les superviseurs à partir de la `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e4092-370">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="e4092-371">Comme le montre la Figure 14, les superviseurs sont désormais constitués de trois utilisateurs : Bruce, Tito et Wanda.</span><span class="sxs-lookup"><span data-stu-id="e4092-371">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>

<span data-ttu-id="e4092-372">[![Bruce, Tito et Wanda sont tous les superviseurs](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="e4092-372">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span></span>

<span data-ttu-id="e4092-373">**Figure 14**: Bruce, Tito et Wanda sont tous les superviseurs ([cliquez pour afficher l’image en taille réelle](assigning-roles-to-users-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="e4092-373">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image42.png))</span></span>

## <a name="summary"></a><span data-ttu-id="e4092-374">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="e4092-374">Summary</span></span>

<span data-ttu-id="e4092-375">L’infrastructure de rôles offre des méthodes pour récupérer des informations sur les rôles et des méthodes pour déterminer quels utilisateurs appartiennent à un rôle spécifié d’un utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="e4092-375">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="e4092-376">En outre, il existe plusieurs méthodes pour ajouter et supprimer un ou plusieurs utilisateurs à un ou plusieurs rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-376">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="e4092-377">Dans ce didacticiel, nous nous sommes concentrés sur deux de ces méthodes : `AddUserToRole` et `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="e4092-377">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="e4092-378">Il existe des variantes supplémentaires conçues pour ajouter plusieurs utilisateurs à un rôle unique et pour affecter plusieurs rôles à un seul utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4092-378">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="e4092-379">Ce didacticiel comprend également un coup de œil à étendre le contrôle CreateUserWizard à inclure un `WizardStep` pour spécifier des rôles de l’utilisateur nouvellement créé.</span><span class="sxs-lookup"><span data-stu-id="e4092-379">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="e4092-380">Une étape de ce type peut aider l’administrateur à rationaliser le processus de création de comptes d’utilisateur pour les nouveaux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="e4092-380">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="e4092-381">À ce stade, nous avons vu comment créer et supprimer des rôles et comment ajouter et supprimer des utilisateurs des rôles.</span><span class="sxs-lookup"><span data-stu-id="e4092-381">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="e4092-382">Mais nous devons encore examiner l’application d’autorisation en fonction du rôle.</span><span class="sxs-lookup"><span data-stu-id="e4092-382">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="e4092-383">Dans le <a id="_msoanchor_6"> </a> [didacticiel suivant](role-based-authorization-vb.md) nous allons examiner la définition de règles d’autorisation d’URL sur une base de rôle par rôle, ainsi que la manière dont pour limiter la fonctionnalité de niveau de page basée sur les rôles de l’utilisateur actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="e4092-383">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-vb.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="e4092-384">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="e4092-384">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="e4092-385">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="e4092-385">Further Reading</span></span>

<span data-ttu-id="e4092-386">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="e4092-386">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e4092-387">Présentation de l’outil Administration Site Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="e4092-387">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="e4092-388">Examen ASP. Appartenance, rôles et profil du NET</span><span class="sxs-lookup"><span data-stu-id="e4092-388">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="e4092-389">Déploiement de votre propre outil d’Administration de site Web</span><span class="sxs-lookup"><span data-stu-id="e4092-389">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="e4092-390">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="e4092-390">About the Author</span></span>

<span data-ttu-id="e4092-391">Scott Mitchell, auteur de plusieurs livres sur ASP/ASP.NET et fondateur de 4GuysFromRolla.com, travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="e4092-391">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e4092-392">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="e4092-392">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e4092-393">Son dernier ouvrage est *[SAM animer vous-même ASP.NET 2.0 des dernières 24 heures](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="e4092-393">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="e4092-394">Scott peut être atteint à [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) ou via son blog à [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="e4092-394">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="e4092-395">Remerciements particuliers à...</span><span class="sxs-lookup"><span data-stu-id="e4092-395">Special Thanks To…</span></span>

<span data-ttu-id="e4092-396">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="e4092-396">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e4092-397">Entraîner un réviseur pour ce didacticiel a été Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="e4092-397">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="e4092-398">Qui souhaitent consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="e4092-398">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e4092-399">Dans ce cas, envoyez-moi une ligne à [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e4092-399">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e4092-400">[Précédent](creating-and-managing-roles-vb.md)
> [Suivant](role-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e4092-400">[Previous](creating-and-managing-roles-vb.md)
[Next](role-based-authorization-vb.md)</span></span>
