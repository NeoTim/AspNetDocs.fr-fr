---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
title: Création d’une interface pour sélectionner un compte d’utilisateur àC#partir de nombreux () | Microsoft Docs
author: rick-anderson
description: Dans ce didacticiel, nous allons créer une interface utilisateur avec une grille paginée et filtrable. En particulier, notre interface utilisateur se compose d’une série de LinkButtons pour...
ms.author: riande
ms.date: 04/01/2008
ms.assetid: 9e4e687c-b4ec-434f-a4ef-edb0b8f365e4
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
msc.type: authoredcontent
ms.openlocfilehash: 8057cfbcd33c74376076363bc27940cebd522c08
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74576000"
---
# <a name="building-an-interface-to-select-one-user-account-from-many-c"></a><span data-ttu-id="f454b-104">Création d’une interface pour sélectionner un compte d’utilisateur parmi de nombreux comptes (C#)</span><span class="sxs-lookup"><span data-stu-id="f454b-104">Building an Interface to Select One User Account from Many (C#)</span></span>

<span data-ttu-id="f454b-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f454b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f454b-106">[Télécharger le code](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip) ou [Télécharger le PDF](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="f454b-106">[Download Code](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip) or [Download PDF](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span></span>

> <span data-ttu-id="f454b-107">Dans ce didacticiel, nous allons créer une interface utilisateur avec une grille paginée et filtrable.</span><span class="sxs-lookup"><span data-stu-id="f454b-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="f454b-108">En particulier, notre interface utilisateur se compose d’une série de LinkButtons pour filtrer les résultats en fonction de la lettre de départ du nom d’utilisateur, et d’un contrôle GridView pour afficher les utilisateurs correspondants.</span><span class="sxs-lookup"><span data-stu-id="f454b-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="f454b-109">Nous allons commencer par répertorier tous les comptes d’utilisateur dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="f454b-110">Ensuite, à l’étape 3, nous ajouterons le filtre LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="f454b-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="f454b-111">L’étape 4 examine la pagination des résultats filtrés.</span><span class="sxs-lookup"><span data-stu-id="f454b-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="f454b-112">L’interface construite dans les étapes 2 à 4 sera utilisée dans les didacticiels suivants pour effectuer des tâches d’administration pour un compte d’utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="f454b-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

## <a name="introduction"></a><span data-ttu-id="f454b-113">Introduction</span><span class="sxs-lookup"><span data-stu-id="f454b-113">Introduction</span></span>

<span data-ttu-id="f454b-114">Dans le <a id="_msoanchor_1"> </a>didacticiel [*attribution de rôles aux utilisateurs*](../roles/assigning-roles-to-users-cs.md) , nous avons créé une interface rudimentaire permettant à un administrateur de sélectionner un utilisateur et de gérer ses rôles.</span><span class="sxs-lookup"><span data-stu-id="f454b-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="f454b-115">Plus précisément, l’interface a présenté à l’administrateur une liste déroulante de tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="f454b-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="f454b-116">Une telle interface est appropriée lorsqu’il y a une douzaine de comptes d’utilisateur, mais qu’elle est difficile pour les sites avec des centaines ou des milliers de comptes.</span><span class="sxs-lookup"><span data-stu-id="f454b-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="f454b-117">Une grille paginée et filtrable est une interface utilisateur plus appropriée pour les sites Web avec des bases d’utilisateurs volumineuses.</span><span class="sxs-lookup"><span data-stu-id="f454b-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="f454b-118">Dans ce didacticiel, nous allons créer une interface utilisateur de ce type.</span><span class="sxs-lookup"><span data-stu-id="f454b-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="f454b-119">En particulier, notre interface utilisateur se compose d’une série de LinkButtons pour filtrer les résultats en fonction de la lettre de départ du nom d’utilisateur, et d’un contrôle GridView pour afficher les utilisateurs correspondants.</span><span class="sxs-lookup"><span data-stu-id="f454b-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="f454b-120">Nous allons commencer par répertorier tous les comptes d’utilisateur dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="f454b-121">Ensuite, à l’étape 3, nous ajouterons le filtre LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="f454b-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="f454b-122">L’étape 4 examine la pagination des résultats filtrés.</span><span class="sxs-lookup"><span data-stu-id="f454b-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="f454b-123">L’interface construite dans les étapes 2 à 4 sera utilisée dans les didacticiels suivants pour effectuer des tâches d’administration pour un compte d’utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="f454b-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="f454b-124">Commençons !</span><span class="sxs-lookup"><span data-stu-id="f454b-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="f454b-125">Étape 1 : ajout de nouvelles pages ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f454b-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="f454b-126">Dans ce didacticiel et les deux prochaines, nous examinerons diverses fonctions et fonctionnalités liées à l’administration.</span><span class="sxs-lookup"><span data-stu-id="f454b-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="f454b-127">Nous aurons besoin d’une série de pages ASP.NET pour implémenter les rubriques examinées dans ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="f454b-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="f454b-128">Nous allons créer ces pages et mettre à jour le plan du site.</span><span class="sxs-lookup"><span data-stu-id="f454b-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="f454b-129">Commencez par créer un nouveau dossier dans le projet nommé `Administration`.</span><span class="sxs-lookup"><span data-stu-id="f454b-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="f454b-130">Ensuite, ajoutez deux nouvelles pages ASP.NET au dossier, en liant chaque page à la page maître `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="f454b-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="f454b-131">Nommer les pages :</span><span class="sxs-lookup"><span data-stu-id="f454b-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="f454b-132">Ajoutez également deux pages dans le répertoire racine du site Web : `ChangePassword.aspx` et `RecoverPassword.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f454b-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="f454b-133">À ce stade, ces quatre pages disposent de deux contrôles de contenu, un pour chaque ContentPlaceHolders : `MainContent` et `LoginContent`de la page maître.</span><span class="sxs-lookup"><span data-stu-id="f454b-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample1.aspx)]

<span data-ttu-id="f454b-134">Nous souhaitons afficher le balisage par défaut de la page maître pour le `LoginContent` ContentPlaceHolder pour ces pages.</span><span class="sxs-lookup"><span data-stu-id="f454b-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="f454b-135">Par conséquent, supprimez le balisage déclaratif pour le contrôle de contenu `Content2`.</span><span class="sxs-lookup"><span data-stu-id="f454b-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="f454b-136">Après cela, le balisage des pages ne doit contenir qu’un seul contrôle de contenu.</span><span class="sxs-lookup"><span data-stu-id="f454b-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="f454b-137">Les pages ASP.NET dans le dossier `Administration` sont destinées uniquement aux utilisateurs administratifs.</span><span class="sxs-lookup"><span data-stu-id="f454b-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="f454b-138">Nous avons ajouté un rôle administrateurs au système dans le <a id="_msoanchor_2"> </a>didacticiel [*création et gestion des rôles*](../roles/creating-and-managing-roles-cs.md) . Limitez l’accès à ces deux pages à ce rôle.</span><span class="sxs-lookup"><span data-stu-id="f454b-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-cs.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="f454b-139">Pour ce faire, ajoutez un fichier `Web.config` dans le dossier `Administration` et configurez son élément `<authorization>` pour admettre les utilisateurs du rôle administrateurs et pour refuser tous les autres.</span><span class="sxs-lookup"><span data-stu-id="f454b-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample2.xml)]

<span data-ttu-id="f454b-140">À ce stade, le Explorateur de solutions de votre projet doit ressembler à la capture d’écran illustrée à la figure 1.</span><span class="sxs-lookup"><span data-stu-id="f454b-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="f454b-141">[![quatre nouvelles pages et un fichier Web. config ont été ajoutés au site Web](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span></span>

<span data-ttu-id="f454b-142">**Figure 1**: quatre nouvelles pages et un fichier de `Web.config` ont été ajoutés au site Web ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))</span></span>

<span data-ttu-id="f454b-143">Enfin, mettez à jour le plan de site (`Web.sitemap`) pour inclure une entrée sur la page de `ManageUsers.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f454b-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="f454b-144">Ajoutez le code XML suivant après le `<siteMapNode>` que nous avons ajouté pour les didacticiels de rôles.</span><span class="sxs-lookup"><span data-stu-id="f454b-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample3.xml)]

<span data-ttu-id="f454b-145">Une fois le plan de site mis à jour, accédez au site via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="f454b-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="f454b-146">Comme le montre la figure 2, la navigation à gauche comprend maintenant des éléments pour les didacticiels d’administration.</span><span class="sxs-lookup"><span data-stu-id="f454b-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>

<span data-ttu-id="f454b-147">[![le plan du site comprend un nœud intitulé Administration des utilisateurs](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span></span>

<span data-ttu-id="f454b-148">**Figure 2**: le plan de site comprend un nœud intitulé Administration des utilisateurs ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-148">**Figure 2**: The Site Map Includes a Node Titled User Administration  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))</span></span>

## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="f454b-149">Étape 2 : répertorier tous les comptes d’utilisateur dans un GridView</span><span class="sxs-lookup"><span data-stu-id="f454b-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="f454b-150">Notre objectif final pour ce didacticiel est de créer une grille paginée, filtrable, par l’intermédiaire de laquelle un administrateur peut sélectionner un compte d’utilisateur à gérer.</span><span class="sxs-lookup"><span data-stu-id="f454b-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="f454b-151">Commençons par répertorier *tous* les utilisateurs dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="f454b-152">Une fois cette opération terminée, nous ajouterons les interfaces et les fonctionnalités de filtrage et de pagination.</span><span class="sxs-lookup"><span data-stu-id="f454b-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="f454b-153">Ouvrez la page `ManageUsers.aspx` dans le dossier `Administration` et ajoutez un GridView, en affectant à sa `ID` la valeur `UserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="f454b-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts`.</span></span> <span data-ttu-id="f454b-154">Dans un moment, nous allons écrire du code pour lier l’ensemble des comptes d’utilisateur au GridView à l’aide de la méthode `GetAllUsers` de la classe `Membership`.</span><span class="sxs-lookup"><span data-stu-id="f454b-154">In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="f454b-155">Comme indiqué dans les didacticiels précédents, la méthode GetAllUsers retourne un objet `MembershipUserCollection`, qui est une collection d’objets `MembershipUser`.</span><span class="sxs-lookup"><span data-stu-id="f454b-155">As discussed in earlier tutorials, the GetAllUsers method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="f454b-156">Chaque `MembershipUser` de la collection comprend des propriétés comme `UserName`, `Email`, `IsApproved`, etc.</span><span class="sxs-lookup"><span data-stu-id="f454b-156">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="f454b-157">Pour afficher les informations de compte d’utilisateur souhaitées dans le GridView, affectez la valeur false à la propriété `AutoGenerateColumns` de GridView et ajoutez BoundFields pour les propriétés `UserName`, `Email`et `Comment` et CheckBoxFields pour les propriétés `IsApproved`, `IsLockedOut`et `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="f454b-157">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="f454b-158">Cette configuration peut être appliquée via le balisage déclaratif du contrôle ou via la boîte de dialogue champs.</span><span class="sxs-lookup"><span data-stu-id="f454b-158">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="f454b-159">La figure 3 illustre une capture d’écran de la boîte de dialogue champs après la désactivation de la case à cocher générer automatiquement les champs et l’ajout et la configuration des BoundFields et des CheckBoxFields.</span><span class="sxs-lookup"><span data-stu-id="f454b-159">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>

<span data-ttu-id="f454b-160">[![ajouter trois BoundFields et trois CheckBoxFields au GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-160">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span></span>

<span data-ttu-id="f454b-161">**Figure 3**: ajouter trois BoundFields et trois CheckBoxFields au contrôle GridView ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-161">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))</span></span>

<span data-ttu-id="f454b-162">Après avoir configuré votre GridView, assurez-vous que son balisage déclaratif ressemble à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="f454b-162">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample4.aspx)]

<span data-ttu-id="f454b-163">Ensuite, nous devons écrire du code qui lie les comptes d’utilisateur au GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-163">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="f454b-164">Créez une méthode nommée `BindUserAccounts` pour effectuer cette tâche, puis appelez-la à partir du gestionnaire d’événements `Page_Load` sur la première page visitée.</span><span class="sxs-lookup"><span data-stu-id="f454b-164">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample5.cs)]

<span data-ttu-id="f454b-165">Prenez un moment pour tester la page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="f454b-165">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="f454b-166">Comme le montre la figure 4, le `UserAccounts` GridView répertorie le nom d’utilisateur, l’adresse de messagerie et d’autres informations de compte pertinentes pour tous les utilisateurs du système.</span><span class="sxs-lookup"><span data-stu-id="f454b-166">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>

<span data-ttu-id="f454b-167">[![les comptes d’utilisateur sont répertoriés dans le contrôle GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-167">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span></span>

<span data-ttu-id="f454b-168">**Figure 4**: les comptes d’utilisateur sont répertoriés dans le contrôle GridView ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-168">**Figure 4**: The User Accounts are Listed in the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))</span></span>

## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="f454b-169">Étape 3 : filtrage des résultats selon la première lettre du nom d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="f454b-169">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="f454b-170">Actuellement, le `UserAccounts` GridView affiche *tous* les comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f454b-170">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="f454b-171">Pour les sites Web avec des centaines ou des milliers de comptes d’utilisateur, il est impératif que l’utilisateur soit en mesure de réduire rapidement les comptes affichés.</span><span class="sxs-lookup"><span data-stu-id="f454b-171">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="f454b-172">Pour ce faire, vous pouvez ajouter le filtrage LinkButtons à la page.</span><span class="sxs-lookup"><span data-stu-id="f454b-172">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="f454b-173">Nous allons ajouter 27 LinkButtons à la page : un intitulé tout avec un LinkButton pour chaque lettre de l’alphabet.</span><span class="sxs-lookup"><span data-stu-id="f454b-173">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="f454b-174">Si un visiteur clique sur le LinkButton tout, le GridView affiche tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="f454b-174">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="f454b-175">S’ils cliquent sur une lettre particulière, seuls les utilisateurs dont le nom d’utilisateur commence par la lettre sélectionnée seront affichés.</span><span class="sxs-lookup"><span data-stu-id="f454b-175">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="f454b-176">Notre première tâche consiste à ajouter les 27 contrôles LinkButton.</span><span class="sxs-lookup"><span data-stu-id="f454b-176">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="f454b-177">Une option consisterait à créer les 27 LinkButtons de façon déclarative, un par un.</span><span class="sxs-lookup"><span data-stu-id="f454b-177">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="f454b-178">Une approche plus souple consiste à utiliser un contrôle Repeater avec un `ItemTemplate` qui restitue un LinkButton, puis lie les options de filtrage au Repeater en tant que tableau `string`.</span><span class="sxs-lookup"><span data-stu-id="f454b-178">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `string` array.</span></span>

<span data-ttu-id="f454b-179">Commencez par ajouter un contrôle Repeater à la page au-dessus du `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-179">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="f454b-180">Définissez la propriété `ID` du répétiteur sur `FilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="f454b-180">Set the Repeater's `ID` property to `FilteringUI`.</span></span> <span data-ttu-id="f454b-181">Configurez les modèles de Repeater afin que son `ItemTemplate` restitue un LinkButton dont les propriétés `Text` et `CommandName` sont liées à l’élément de tableau actuel.</span><span class="sxs-lookup"><span data-stu-id="f454b-181">Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="f454b-182">Comme nous l’avons vu <a id="_msoanchor_3"> </a>dans le didacticiel [*attribution de rôles aux utilisateurs*](../roles/assigning-roles-to-users-cs.md) , cela peut être accompli à l’aide de la syntaxe de liaison de liaison `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="f454b-182">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="f454b-183">Utilisez la `SeparatorTemplate` du répéteur pour afficher une ligne verticale entre chaque lien.</span><span class="sxs-lookup"><span data-stu-id="f454b-183">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample6.aspx)]

<span data-ttu-id="f454b-184">Pour remplir ce répéteur avec les options de filtrage souhaitées, créez une méthode nommée `BindFilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="f454b-184">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="f454b-185">Veillez à appeler cette méthode à partir du gestionnaire d’événements `Page_Load` lors du premier chargement de la page.</span><span class="sxs-lookup"><span data-stu-id="f454b-185">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample7.cs)]

<span data-ttu-id="f454b-186">Cette méthode spécifie les options de filtrage en tant qu’éléments dans le tableau de `string` `filterOptions`.</span><span class="sxs-lookup"><span data-stu-id="f454b-186">This method specifies the filtering options as elements in the `string` array `filterOptions`.</span></span> <span data-ttu-id="f454b-187">Pour chaque élément du tableau, le Repeater restitue un LinkButton avec son `Text` et `CommandName` propriétés assignées à la valeur de l’élément de tableau.</span><span class="sxs-lookup"><span data-stu-id="f454b-187">For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="f454b-188">La figure 5 illustre la page de `ManageUsers.aspx` lorsque vous l’affichez dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="f454b-188">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>

<span data-ttu-id="f454b-189">[![les listes de répéteurs 27 LinkButtons de filtrage](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-189">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span></span>

<span data-ttu-id="f454b-190">**Figure 5**: listes de répétitions 27 LinkButtons de filtrage ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-190">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f454b-191">Les noms d’utilisateur peuvent commencer par n’importe quel caractère, y compris des chiffres et des signes de ponctuation.</span><span class="sxs-lookup"><span data-stu-id="f454b-191">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="f454b-192">Pour afficher ces comptes, l’administrateur doit utiliser l’option tous les LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="f454b-192">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="f454b-193">Vous pouvez également ajouter un LinkButton pour retourner tous les comptes d’utilisateur qui commencent par un chiffre.</span><span class="sxs-lookup"><span data-stu-id="f454b-193">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="f454b-194">Je laisse cela en tant qu’exercice pour le lecteur.</span><span class="sxs-lookup"><span data-stu-id="f454b-194">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="f454b-195">Le fait de cliquer sur l’un des LinkButtons de filtrage provoque une publication et déclenche l’événement de `ItemCommand` du répéteur, mais il n’y a aucune modification dans la grille, car nous n’avons pas encore écrit de code pour filtrer les résultats.</span><span class="sxs-lookup"><span data-stu-id="f454b-195">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="f454b-196">La classe `Membership` comprend une [méthode`FindUsersByName`](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) qui retourne les comptes d’utilisateurs dont le nom d’utilisateur correspond à un modèle de recherche spécifié.</span><span class="sxs-lookup"><span data-stu-id="f454b-196">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="f454b-197">Nous pouvons utiliser cette méthode pour récupérer uniquement les comptes d’utilisateurs dont les noms d’utilisateur commencent par la lettre spécifiée par le `CommandName` du LinkButton filtré sur lequel l’utilisateur a cliqué.</span><span class="sxs-lookup"><span data-stu-id="f454b-197">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="f454b-198">Commencez par mettre à jour la classe code-behind de la page `ManageUser.aspx` pour qu’elle inclue une propriété nommée `UsernameToMatch`.</span><span class="sxs-lookup"><span data-stu-id="f454b-198">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch`.</span></span> <span data-ttu-id="f454b-199">Cette propriété rend persistante la chaîne de filtre de nom d’utilisateur entre les publications (postback) :</span><span class="sxs-lookup"><span data-stu-id="f454b-199">This property persists the username filter string across postbacks:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample8.cs)]

<span data-ttu-id="f454b-200">La propriété `UsernameToMatch` stocke sa valeur affectée dans la collection `ViewState` à l’aide de la clé UsernameToMatch.</span><span class="sxs-lookup"><span data-stu-id="f454b-200">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key UsernameToMatch.</span></span> <span data-ttu-id="f454b-201">Lorsque la valeur de cette propriété est lue, elle vérifie si une valeur existe dans la collection `ViewState` ; Si ce n’est pas le cas, elle retourne la valeur par défaut, une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="f454b-201">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="f454b-202">La propriété `UsernameToMatch` présente un modèle commun, à savoir la persistance d’une valeur à l’état d’affichage afin que toutes les modifications apportées à la propriété soient rendues persistantes entre les publications.</span><span class="sxs-lookup"><span data-stu-id="f454b-202">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="f454b-203">Pour plus d’informations sur ce modèle, consultez [comprendre l’état d’affichage de ASP.net](https://msdn.microsoft.com/library/ms972976.aspx).</span><span class="sxs-lookup"><span data-stu-id="f454b-203">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoft.com/library/ms972976.aspx).</span></span>

<span data-ttu-id="f454b-204">Ensuite, mettez à jour la méthode `BindUserAccounts` afin qu’au lieu d’appeler `Membership.GetAllUsers`, elle appelle `Membership.FindUsersByName`, en passant la valeur de la propriété `UsernameToMatch` ajoutée au caractère générique SQL,%.</span><span class="sxs-lookup"><span data-stu-id="f454b-204">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample9.cs)]

<span data-ttu-id="f454b-205">Pour afficher uniquement les utilisateurs dont le nom d’utilisateur commence par la lettre A, affectez à la propriété `UsernameToMatch` la valeur et appelez ensuite `BindUserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="f454b-205">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts`.</span></span> <span data-ttu-id="f454b-206">Cela entraînerait un appel à `Membership.FindUsersByName("A%")`, qui renverra tous les utilisateurs dont le nom d’utilisateur commence par un. de la même manière, pour retourner *tous* les utilisateurs, assignez une chaîne vide à la propriété `UsernameToMatch` afin que la méthode `BindUserAccounts` appelle `Membership.FindUsersByName("%")`, renvoyant ainsi tous les comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f454b-206">This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="f454b-207">Créez un gestionnaire d’événements pour l’événement `ItemCommand` du répéteur.</span><span class="sxs-lookup"><span data-stu-id="f454b-207">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="f454b-208">Cet événement est déclenché chaque fois qu’un utilisateur clique sur l’un des LinkButtons de filtre ; la valeur `CommandName` du LinkButton cliqué est passée par le biais de l’objet `RepeaterCommandEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="f454b-208">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="f454b-209">Nous devons affecter la valeur appropriée à la propriété `UsernameToMatch`, puis appeler la méthode `BindUserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="f454b-209">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="f454b-210">Si le `CommandName` est All, assignez une chaîne vide à `UsernameToMatch` afin que tous les comptes d’utilisateur soient affichés.</span><span class="sxs-lookup"><span data-stu-id="f454b-210">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="f454b-211">Sinon, assignez la valeur `CommandName` à `UsernameToMatch`.</span><span class="sxs-lookup"><span data-stu-id="f454b-211">Otherwise, assign the `CommandName` value to `UsernameToMatch`.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample10.cs)]

<span data-ttu-id="f454b-212">Avec ce code en place, testez la fonctionnalité de filtrage.</span><span class="sxs-lookup"><span data-stu-id="f454b-212">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="f454b-213">Lorsque la page est visitée pour la première fois, tous les comptes d’utilisateur sont affichés (reportez-vous à la figure 5).</span><span class="sxs-lookup"><span data-stu-id="f454b-213">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="f454b-214">Le fait de cliquer sur un LinkButton entraîne une publication (postback) et filtre les résultats, en affichant uniquement les comptes d’utilisateur qui commencent par un.</span><span class="sxs-lookup"><span data-stu-id="f454b-214">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>

<span data-ttu-id="f454b-215">[![utiliser le filtre LinkButtons pour afficher les utilisateurs dont le nom d’utilisateur commence par une lettre donnée](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-215">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span></span>

<span data-ttu-id="f454b-216">**Figure 6**: utiliser le filtre LinkButtons pour afficher les utilisateurs dont le nom d’utilisateur commence par une lettre ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-216">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))</span></span>

## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="f454b-217">Étape 4 : mise à jour de GridView pour utiliser la pagination</span><span class="sxs-lookup"><span data-stu-id="f454b-217">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="f454b-218">Le contrôle GridView présenté dans les figures 5 et 6 répertorie tous les enregistrements retournés par la méthode `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="f454b-218">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="f454b-219">S’il y a des centaines ou des milliers de comptes d’utilisateur, cela peut entraîner une surcharge d’informations lors de l’affichage de tous les comptes (comme c’est le cas lorsque vous cliquez sur le bouton tout ou lorsque vous visitez initialement la page).</span><span class="sxs-lookup"><span data-stu-id="f454b-219">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="f454b-220">Pour aider à présenter les comptes d’utilisateur dans des segments plus gérables, nous allons configurer le contrôle GridView pour afficher 10 comptes d’utilisateur à la fois.</span><span class="sxs-lookup"><span data-stu-id="f454b-220">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="f454b-221">Le contrôle GridView offre deux types de pagination :</span><span class="sxs-lookup"><span data-stu-id="f454b-221">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="f454b-222">**Pagination par défaut** : facile à implémenter, mais inefficace.</span><span class="sxs-lookup"><span data-stu-id="f454b-222">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="f454b-223">En résumé, avec la pagination par défaut, le GridView attend *tous* les enregistrements de sa source de données.</span><span class="sxs-lookup"><span data-stu-id="f454b-223">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="f454b-224">Il affiche ensuite uniquement la page d’enregistrements appropriée.</span><span class="sxs-lookup"><span data-stu-id="f454b-224">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="f454b-225">**Pagination personnalisée** : nécessite plus de travail à implémenter, mais elle est plus efficace que la pagination par défaut, car avec la pagination personnalisée, la source de données retourne uniquement le jeu d’enregistrements précis à afficher.</span><span class="sxs-lookup"><span data-stu-id="f454b-225">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="f454b-226">La différence de performances entre la pagination par défaut et la pagination personnalisée peut être très importante lors de la pagination de milliers d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="f454b-226">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="f454b-227">Étant donné que nous créons cette interface en supposant qu’il peut y avoir des centaines ou des milliers de comptes d’utilisateur, utilisons la pagination personnalisée.</span><span class="sxs-lookup"><span data-stu-id="f454b-227">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="f454b-228">Pour une discussion plus approfondie sur les différences entre la pagination par défaut et la pagination personnalisée, ainsi que sur les défis liés à l’implémentation de la pagination personnalisée, reportez-vous à [pagination efficace de grandes quantités de données](https://asp.net/learn/data-access/tutorial-25-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="f454b-228">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-cs.aspx).</span></span> <span data-ttu-id="f454b-229">Pour une analyse de la différence de performances entre la pagination par défaut et la pagination personnalisée, consultez [pagination personnalisée dans ASP.net avec SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="f454b-229">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>

<span data-ttu-id="f454b-230">Pour implémenter la pagination personnalisée, nous avons d’abord besoin d’un mécanisme permettant de récupérer le sous-ensemble précis d’enregistrements affichés par le GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-230">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="f454b-231">La bonne nouvelle, c’est que la méthode `FindUsersByName` de la classe `Membership` a une surcharge qui nous permet de spécifier l’index de page et la taille de page, et de retourner uniquement les comptes d’utilisateur qui se trouvent dans cette plage d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="f454b-231">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="f454b-232">En particulier, cette surcharge a la signature suivante : [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span><span class="sxs-lookup"><span data-stu-id="f454b-232">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="f454b-233">Le paramètre *pageIndex* spécifie la page de comptes d’utilisateur à retourner ; *pageSize* indique le nombre d’enregistrements à afficher par page.</span><span class="sxs-lookup"><span data-stu-id="f454b-233">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="f454b-234">Le paramètre *totalRecords* est un paramètre `out` qui retourne le nombre total de comptes d’utilisateur dans le magasin de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f454b-234">The *totalRecords* parameter is an `out` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="f454b-235">Les données retournées par `FindUsersByName` sont triées par nom d’utilisateur ; les critères de tri ne peuvent pas être personnalisés.</span><span class="sxs-lookup"><span data-stu-id="f454b-235">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>

<span data-ttu-id="f454b-236">Le GridView peut être configuré pour utiliser la pagination personnalisée, mais uniquement lorsqu’il est lié à un contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f454b-236">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="f454b-237">Pour que le contrôle ObjectDataSource implémente la pagination personnalisée, il requiert deux méthodes : une qui reçoit un index de début de ligne et le nombre maximal d’enregistrements à afficher, et retourne le sous-ensemble précis des enregistrements qui se trouvent dans cette étendue. et une méthode qui retourne le nombre total d’enregistrements paginés.</span><span class="sxs-lookup"><span data-stu-id="f454b-237">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="f454b-238">La surcharge `FindUsersByName` accepte un index de page et une taille de page, et retourne le nombre total d’enregistrements via un paramètre `out`.</span><span class="sxs-lookup"><span data-stu-id="f454b-238">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through an `out` parameter.</span></span> <span data-ttu-id="f454b-239">Il y a donc une incompatibilité d’interface ici.</span><span class="sxs-lookup"><span data-stu-id="f454b-239">So there is an interface mismatch here.</span></span>

<span data-ttu-id="f454b-240">Une option consiste à créer une classe proxy qui expose l’interface attendue par ObjectDataSource, puis appelle en interne la méthode `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="f454b-240">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="f454b-241">Une autre option, et celle que nous allons utiliser pour cet article, consiste à créer votre propre interface de pagination et à l’utiliser à la place de l’interface de pagination intégrée de GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-241">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="f454b-242">Création d’une première interface de pagination, précédent, suivant, dernière</span><span class="sxs-lookup"><span data-stu-id="f454b-242">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="f454b-243">Nous allons créer une interface de pagination avec les LinkButtons First, Previous, Next et Last.</span><span class="sxs-lookup"><span data-stu-id="f454b-243">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="f454b-244">Le premier LinkButton, quand vous cliquez dessus, envoie l’utilisateur à la première page de données, tandis que précédent le retourne à la page précédente.</span><span class="sxs-lookup"><span data-stu-id="f454b-244">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="f454b-245">De même, le suivant et le dernier déplace l’utilisateur vers la page suivante et la dernière page, respectivement.</span><span class="sxs-lookup"><span data-stu-id="f454b-245">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="f454b-246">Ajoutez les quatre contrôles LinkButton sous le `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-246">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample11.aspx)]

<span data-ttu-id="f454b-247">Ensuite, créez un gestionnaire d’événements pour chaque événement `Click` du LinkButton.</span><span class="sxs-lookup"><span data-stu-id="f454b-247">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="f454b-248">La figure 7 illustre les quatre LinkButtons affichés dans Visual Web Developer Mode Création.</span><span class="sxs-lookup"><span data-stu-id="f454b-248">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>

<span data-ttu-id="f454b-249">[![ajouter tout d’abord, précédent, suivant et dernier LinkButtons sous le contrôle GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-249">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span></span>

<span data-ttu-id="f454b-250">**Figure 7**: ajouter en premier, précédent, suivant et dernier LinkButtons sous le contrôle GridView ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-250">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))</span></span>

### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="f454b-251">Suivi de l’index de la page active</span><span class="sxs-lookup"><span data-stu-id="f454b-251">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="f454b-252">Quand un utilisateur visite pour la première fois la page de `ManageUsers.aspx` ou clique sur l’un des boutons de filtrage, nous souhaitons afficher la première page de données dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="f454b-252">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="f454b-253">Toutefois, lorsque l’utilisateur clique sur l’un des LinkButtons de navigation, nous devons mettre à jour l’index de la page.</span><span class="sxs-lookup"><span data-stu-id="f454b-253">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="f454b-254">Pour conserver l’index de page et le nombre d’enregistrements à afficher par page, ajoutez les deux propriétés suivantes à la classe code-behind de la page :</span><span class="sxs-lookup"><span data-stu-id="f454b-254">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample12.cs)]

<span data-ttu-id="f454b-255">À l’instar de la propriété `UsernameToMatch`, la propriété `PageIndex` rend sa valeur persistante dans l’état d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f454b-255">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="f454b-256">La propriété `PageSize` en lecture seule retourne une valeur codée en dur, 10.</span><span class="sxs-lookup"><span data-stu-id="f454b-256">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="f454b-257">J’invite le lecteur intéressé à mettre à jour cette propriété pour qu’elle utilise le même modèle que `PageIndex`, puis à augmenter la page `ManageUsers.aspx` de telle sorte que la personne visitant la page puisse spécifier le nombre de comptes d’utilisateur à afficher par page.</span><span class="sxs-lookup"><span data-stu-id="f454b-257">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="f454b-258">Récupération des enregistrements de la page actuelle uniquement, mise à jour de l’index de la page et activation et désactivation de l’interface de pagination LinkButtons</span><span class="sxs-lookup"><span data-stu-id="f454b-258">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="f454b-259">Une fois l’interface de pagination en place et les propriétés `PageIndex` et `PageSize` ajoutées, nous sommes prêts à mettre à jour la méthode `BindUserAccounts` afin qu’elle utilise la surcharge `FindUsersByName` appropriée.</span><span class="sxs-lookup"><span data-stu-id="f454b-259">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="f454b-260">En outre, cette méthode doit activer ou désactiver l’interface de pagination en fonction de la page affichée.</span><span class="sxs-lookup"><span data-stu-id="f454b-260">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="f454b-261">Lorsque vous affichez la première page de données, les liens précédents et précédents doivent être désactivés. Next et Last doivent être désactivés lors de l’affichage de la dernière page.</span><span class="sxs-lookup"><span data-stu-id="f454b-261">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="f454b-262">Mettez à jour la méthode `BindUserAccounts` avec le code suivant :</span><span class="sxs-lookup"><span data-stu-id="f454b-262">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample13.cs)]

<span data-ttu-id="f454b-263">Notez que le nombre total d’enregistrements paginés est déterminé par le dernier paramètre de la méthode `FindUsersByName`.</span><span class="sxs-lookup"><span data-stu-id="f454b-263">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="f454b-264">Il s’agit d’un paramètre `out`, donc nous devons d’abord déclarer une variable pour contenir cette valeur (`totalRecords`), puis la préfixer avec le mot clé `out`.</span><span class="sxs-lookup"><span data-stu-id="f454b-264">This is an `out` parameter, so we need to first declare a variable to hold this value (`totalRecords`) and then prefix it with the `out` keyword.</span></span>

<span data-ttu-id="f454b-265">Une fois la page spécifiée de comptes d’utilisateur retournée, les quatre LinkButtons sont activés ou désactivés, selon que la première ou la dernière page de données est affichée.</span><span class="sxs-lookup"><span data-stu-id="f454b-265">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="f454b-266">La dernière étape consiste à écrire le code pour les quatre gestionnaires d’événements `Click` « LinkButtons ».</span><span class="sxs-lookup"><span data-stu-id="f454b-266">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="f454b-267">Ces gestionnaires d’événements doivent mettre à jour la propriété `PageIndex`, puis relier les données au contrôle GridView via un appel à `BindUserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="f454b-267">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts`.</span></span> <span data-ttu-id="f454b-268">Les gestionnaires d’événements First, Previous et Next sont très simples.</span><span class="sxs-lookup"><span data-stu-id="f454b-268">The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="f454b-269">Toutefois, le gestionnaire d’événements `Click` pour le dernier LinkButton est un peu plus complexe, car vous devez déterminer le nombre d’enregistrements affichés pour déterminer le dernier index de page.</span><span class="sxs-lookup"><span data-stu-id="f454b-269">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample14.cs)]

<span data-ttu-id="f454b-270">Les figures 8 et 9 montrent l’interface de pagination personnalisée en action.</span><span class="sxs-lookup"><span data-stu-id="f454b-270">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="f454b-271">La figure 8 illustre la page de `ManageUsers.aspx` lors de l’affichage de la première page de données pour tous les comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f454b-271">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="f454b-272">Notez que seuls 10 des 13 comptes sont affichés.</span><span class="sxs-lookup"><span data-stu-id="f454b-272">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="f454b-273">Le fait de cliquer sur le lien suivant ou le dernier déclenche une publication (postback), met à jour la `PageIndex` à 1 et lie la deuxième page de comptes d’utilisateur à la grille (voir figure 9).</span><span class="sxs-lookup"><span data-stu-id="f454b-273">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>

<span data-ttu-id="f454b-274">[![les 10 premiers comptes d’utilisateur sont affichés](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-274">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span></span>

<span data-ttu-id="f454b-275">**Figure 8**: les 10 premiers comptes d’utilisateur sont affichés ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-275">**Figure 8**: The First 10 User Accounts are Displayed  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))</span></span>

<span data-ttu-id="f454b-276">[![cliquant sur le lien suivant affiche la deuxième page des comptes d’utilisateur](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f454b-276">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span></span>

<span data-ttu-id="f454b-277">**Figure 9**: cliquer sur le lien suivant affiche la deuxième page de comptes d’utilisateur ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f454b-277">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))</span></span>

## <a name="summary"></a><span data-ttu-id="f454b-278">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="f454b-278">Summary</span></span>

<span data-ttu-id="f454b-279">Les administrateurs doivent souvent sélectionner un utilisateur dans la liste des comptes.</span><span class="sxs-lookup"><span data-stu-id="f454b-279">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="f454b-280">Dans les didacticiels précédents, nous avons examiné à l’aide d’une liste déroulante remplie avec les utilisateurs, mais cette approche n’est pas très adaptée.</span><span class="sxs-lookup"><span data-stu-id="f454b-280">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="f454b-281">Dans ce didacticiel, nous avons exploré une meilleure alternative : une interface filtrable dont les résultats sont affichés dans un GridView paginé.</span><span class="sxs-lookup"><span data-stu-id="f454b-281">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="f454b-282">Avec cette interface utilisateur, les administrateurs peuvent localiser et sélectionner rapidement et efficacement un compte d’utilisateur parmi les milliers.</span><span class="sxs-lookup"><span data-stu-id="f454b-282">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="f454b-283">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="f454b-283">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f454b-284">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="f454b-284">Further Reading</span></span>

<span data-ttu-id="f454b-285">Pour plus d’informations sur les sujets abordés dans ce didacticiel, reportez-vous aux ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="f454b-285">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f454b-286">Pagination personnalisée dans ASP.NET avec SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="f454b-286">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="f454b-287">Pagination efficace de grandes quantités de données</span><span class="sxs-lookup"><span data-stu-id="f454b-287">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-cs.aspx)
- [<span data-ttu-id="f454b-288">Déploiement de votre propre outil d’administration de site Web</span><span class="sxs-lookup"><span data-stu-id="f454b-288">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="f454b-289">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="f454b-289">About the Author</span></span>

<span data-ttu-id="f454b-290">Scott Mitchell, auteur de plusieurs ouvrages ASP/ASP. NET et fondateur de 4GuysFromRolla.com, travaille avec les technologies Web de Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="f454b-290">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f454b-291">Scott travaille en tant que consultant, formateur et auteur indépendant.</span><span class="sxs-lookup"><span data-stu-id="f454b-291">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f454b-292">Son dernier livre est *[Sams vous apprend vous-même ASP.NET 2,0 en 24 heures](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="f454b-292">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="f454b-293">Scott peut être contacté au [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) ou via son blog à l’adresse [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="f454b-293">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="f454b-294">Remerciements à</span><span class="sxs-lookup"><span data-stu-id="f454b-294">Special Thanks To</span></span>

<span data-ttu-id="f454b-295">Cette série de didacticiels a été examinée par de nombreux réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="f454b-295">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f454b-296">Le réviseur de leads pour ce didacticiel était Alicja maziarz.</span><span class="sxs-lookup"><span data-stu-id="f454b-296">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="f454b-297">Vous souhaitez revoir mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="f454b-297">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f454b-298">Dans ce cas, insérez une ligne à [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f454b-298">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f454b-299">Suivant</span><span class="sxs-lookup"><span data-stu-id="f454b-299">Next</span></span>](recovering-and-changing-passwords-cs.md)
