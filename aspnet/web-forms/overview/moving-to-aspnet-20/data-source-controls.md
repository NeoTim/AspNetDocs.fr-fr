---
uid: web-forms/overview/moving-to-aspnet-20/data-source-controls
title: Contrôles de Source de données | Microsoft Docs
author: microsoft
description: Le contrôle DataGrid dans ASP.NET 1.x a marqué une amélioration considérable de l’accès aux données dans les applications Web. Toutefois, il n’était pas aussi conviviale qu’il aurait pu être...
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 78fd0e92-f9c6-4e96-a5e9-0375b307a828
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/data-source-controls
msc.type: authoredcontent
ms.openlocfilehash: a2e2cfbec3e5aebf42a2de30bab7d45b4b610298
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65109574"
---
# <a name="data-source-controls"></a><span data-ttu-id="10fc7-104">Contrôles de source de données</span><span class="sxs-lookup"><span data-stu-id="10fc7-104">Data Source Controls</span></span>

<span data-ttu-id="10fc7-105">by [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="10fc7-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="10fc7-106">Le contrôle DataGrid dans ASP.NET 1.x a marqué une amélioration considérable de l’accès aux données dans les applications Web.</span><span class="sxs-lookup"><span data-stu-id="10fc7-106">The DataGrid control in ASP.NET 1.x marked a great improvement in data access in Web applications.</span></span> <span data-ttu-id="10fc7-107">Toutefois, il n’était pas aussi conviviale qu’il aurait pu être.</span><span class="sxs-lookup"><span data-stu-id="10fc7-107">However, it wasn't as user-friendly as it could have been.</span></span> <span data-ttu-id="10fc7-108">Il exigeait une quantité considérable de code pour obtenir un grand nombre de fonctionnalités utile à partir de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="10fc7-108">It still required a considerable amount of code to obtain much useful functionality from it.</span></span> <span data-ttu-id="10fc7-109">C’est le modèle dans tous les domaines d’accès aux données dans la version 1.x.</span><span class="sxs-lookup"><span data-stu-id="10fc7-109">Such is the model in all data access endeavors in 1.x.</span></span>

<span data-ttu-id="10fc7-110">Le contrôle DataGrid dans ASP.NET 1.x a marqué une amélioration considérable de l’accès aux données dans les applications Web.</span><span class="sxs-lookup"><span data-stu-id="10fc7-110">The DataGrid control in ASP.NET 1.x marked a great improvement in data access in Web applications.</span></span> <span data-ttu-id="10fc7-111">Toutefois, il n’était pas aussi conviviale qu’il aurait pu être.</span><span class="sxs-lookup"><span data-stu-id="10fc7-111">However, it wasn't as user-friendly as it could have been.</span></span> <span data-ttu-id="10fc7-112">Il exigeait une quantité considérable de code pour obtenir un grand nombre de fonctionnalités utile à partir de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="10fc7-112">It still required a considerable amount of code to obtain much useful functionality from it.</span></span> <span data-ttu-id="10fc7-113">C’est le modèle dans tous les domaines d’accès aux données dans la version 1.x.</span><span class="sxs-lookup"><span data-stu-id="10fc7-113">Such is the model in all data access endeavors in 1.x.</span></span>

<span data-ttu-id="10fc7-114">ASP.NET 2.0 avec répond en partie avec les contrôles de source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-114">ASP.NET 2.0 addresses this with in part with data source controls.</span></span> <span data-ttu-id="10fc7-115">Les contrôles de source de données dans ASP.NET 2.0 offrent aux développeurs un modèle déclaratif pour la récupération des données, l’affichage des données et la modification des données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-115">The data source controls in ASP.NET 2.0 provide developers with a declarative model for retrieving data, displaying data, and editing data.</span></span> <span data-ttu-id="10fc7-116">L’objectif de contrôles de source de données consiste à fournir une représentation cohérente des données aux contrôles liés aux données, quel que soit la source de ces données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-116">The purpose of data source controls is to provide a consistent representation of data to data-bound controls regardless of the source of those data.</span></span> <span data-ttu-id="10fc7-117">Au cœur des contrôles de source de données dans ASP.NET 2.0 est la classe abstraite DataSourceControl.</span><span class="sxs-lookup"><span data-stu-id="10fc7-117">At the heart of the data source controls in ASP.NET 2.0 is the DataSourceControl abstract class.</span></span> <span data-ttu-id="10fc7-118">La classe DataSourceControl fournit une implémentation de base de l’interface de IDataSource et de l’interface IListSource, ce dernier qui vous autorise à affecter le contrôle de source de données en tant que la source de données d’un contrôle lié aux données (par le biais de la nouvelle propriété DataSourceId abordée plus tard) et exposer les données qui y sont sous forme de liste.</span><span class="sxs-lookup"><span data-stu-id="10fc7-118">The DataSourceControl class provides a base implementation of the IDataSource interface and the IListSource interface, the latter of which allows you to assign the data source control as the DataSource of a data-bound control (via the new DataSourceId property discussed later) and expose the data therein as a list.</span></span> <span data-ttu-id="10fc7-119">Chaque liste de données à partir d’un contrôle de source de données est exposée en tant qu’objet DataSourceView.</span><span class="sxs-lookup"><span data-stu-id="10fc7-119">Each list of data from a data source control is exposed as a DataSourceView object.</span></span> <span data-ttu-id="10fc7-120">Accès aux instances DataSourceView est fourni par l’interface IDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-120">Access to the DataSourceView instances is provided by the IDataSource interface.</span></span> <span data-ttu-id="10fc7-121">Par exemple, la méthode GetViewNames retourne une ICollection qui vous permet d’énumérer les DataSourceViews associé à un contrôle de source de données particulière, et la méthode GetView vous permet d’accéder à une instance de DataSourceView particulière en nom.</span><span class="sxs-lookup"><span data-stu-id="10fc7-121">For example, the GetViewNames method returns an ICollection that allows you to enumerate the DataSourceViews associated with a particular data source control, and the GetView method allows you to access a particular DataSourceView instance by name.</span></span>

<span data-ttu-id="10fc7-122">Contrôles de source de données n’ont aucune interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="10fc7-122">Data source controls have no user-interface.</span></span> <span data-ttu-id="10fc7-123">Ils sont implémentés en tant que contrôles de serveur afin qu’ils peuvent prendre en charge la syntaxe déclarative et afin qu’ils aient accès à l’état de la page si vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="10fc7-123">They are implemented as server controls so that they can support declarative syntax and so that they have access to page state if desired.</span></span> <span data-ttu-id="10fc7-124">Contrôles de source de données ne s’affichent pas toutes les balises HTML au client.</span><span class="sxs-lookup"><span data-stu-id="10fc7-124">Data source controls do not render any HTML markup to the client.</span></span>

> [!NOTE]
> <span data-ttu-id="10fc7-125">Comme vous le verrez plus tard, il sont également la mise en cache les avantages obtenus à l’aide de contrôles de source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-125">As you'll see later, there are also caching benefits obtained by using data source controls.</span></span>

## <a name="storing-connection-strings"></a><span data-ttu-id="10fc7-126">Stockage de chaînes de connexion</span><span class="sxs-lookup"><span data-stu-id="10fc7-126">Storing Connection Strings</span></span>

<span data-ttu-id="10fc7-127">Avant de passer à regarder comment configurer des contrôles de source de données, nous devons couvrent une nouveauté dans ASP.NET 2.0 concernant les chaînes de connexion.</span><span class="sxs-lookup"><span data-stu-id="10fc7-127">Before we get into looking at how to configure data source controls, we should cover a new capability in ASP.NET 2.0 concerning connection strings.</span></span> <span data-ttu-id="10fc7-128">ASP.NET 2.0 introduit une nouvelle section dans le fichier de configuration qui vous permet de stocker aisément des chaînes de connexion qui peuvent être lues de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="10fc7-128">ASP.NET 2.0 introduces a new section in the configuration file that allows you to easily store connection strings that can be read dynamically at runtime.</span></span> <span data-ttu-id="10fc7-129">Le &lt;connectionStrings&gt; section vous permet de stocker des chaînes de connexion.</span><span class="sxs-lookup"><span data-stu-id="10fc7-129">The &lt;connectionStrings&gt; section makes it easy to store connection strings.</span></span>

<span data-ttu-id="10fc7-130">L’extrait de code ci-dessous ajoute une nouvelle chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="10fc7-130">The snippet below adds a new connection string.</span></span>

[!code-xml[Main](data-source-controls/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="10fc7-131">Comme avec la &lt;appSettings&gt; section, le &lt;connectionStrings&gt; section apparaît en dehors de la &lt;system.web&gt; section dans le fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="10fc7-131">Just as with the &lt;appSettings&gt; section, the &lt;connectionStrings&gt; section appears outside of the &lt;system.web&gt; section in the configuration file.</span></span>

<span data-ttu-id="10fc7-132">Pour utiliser cette chaîne de connexion, vous pouvez utiliser la syntaxe suivante lors de la définition de l’attribut ConnectionString d’un contrôle serveur.</span><span class="sxs-lookup"><span data-stu-id="10fc7-132">To use this connection string, you can use the following syntax when setting the ConnectionString attribute of a server control.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample2.aspx)]

<span data-ttu-id="10fc7-133">Le &lt;connectionStrings&gt; section peut également être chiffrée afin que des informations sensibles ne sont pas exposées.</span><span class="sxs-lookup"><span data-stu-id="10fc7-133">The &lt;connectionStrings&gt; section can also be encrypted so that sensitive information is not exposed.</span></span> <span data-ttu-id="10fc7-134">Cette capacité est abordée dans un autre module.</span><span class="sxs-lookup"><span data-stu-id="10fc7-134">That ability will be covered in a later module.</span></span>

## <a name="caching-data-sources"></a><span data-ttu-id="10fc7-135">La mise en cache des Sources de données</span><span class="sxs-lookup"><span data-stu-id="10fc7-135">Caching Data Sources</span></span>

<span data-ttu-id="10fc7-136">Chaque DataSourceControl fournit quatre propriétés de configuration de la mise en cache ; EnableCaching CacheDuration, CacheExpirationPolicy et CacheKeyDependency.</span><span class="sxs-lookup"><span data-stu-id="10fc7-136">Each DataSourceControl provides four properties for configuring caching; EnableCaching, CacheDuration, CacheExpirationPolicy, and CacheKeyDependency.</span></span>

## <a name="enablecaching"></a><span data-ttu-id="10fc7-137">EnableCaching</span><span class="sxs-lookup"><span data-stu-id="10fc7-137">EnableCaching</span></span>

<span data-ttu-id="10fc7-138">EnableCaching est une propriété booléenne qui détermine si la mise en cache est activée pour le contrôle de source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-138">EnableCaching is a Boolean property that determines whether or not caching is enabled for the data source control.</span></span>

## <a name="cacheduration-property"></a><span data-ttu-id="10fc7-139">Propriété CacheDuration</span><span class="sxs-lookup"><span data-stu-id="10fc7-139">CacheDuration Property</span></span>

<span data-ttu-id="10fc7-140">La propriété CacheDuration définit le nombre de secondes pendant lesquelles le cache reste valid.</span><span class="sxs-lookup"><span data-stu-id="10fc7-140">The CacheDuration property sets the number of seconds that the cache remains valid.</span></span> <span data-ttu-id="10fc7-141">Si cette propriété **0** , le cache reste valide jusqu'à ce qu’explicitement.</span><span class="sxs-lookup"><span data-stu-id="10fc7-141">Setting this property to **0** causes the cache to remain valid until explicitly invalidated.</span></span>

## <a name="cacheexpirationpolicy-property"></a><span data-ttu-id="10fc7-142">Propriété de CacheExpirationPolicy</span><span class="sxs-lookup"><span data-stu-id="10fc7-142">CacheExpirationPolicy Property</span></span>

<span data-ttu-id="10fc7-143">La propriété CacheExpirationPolicy peut être définie sur **absolu** ou **coulissante**.</span><span class="sxs-lookup"><span data-stu-id="10fc7-143">The CacheExpirationPolicy property can be set to either **Absolute** or **Sliding**.</span></span> <span data-ttu-id="10fc7-144">La valeur absolue signifie que la quantité maximale de temps les données seront mise en cache est le nombre de secondes spécifié par la propriété CacheDuration.</span><span class="sxs-lookup"><span data-stu-id="10fc7-144">Setting it to Absolute means that the maximum amount of time that the data will be cached is the number of seconds specified by the CacheDuration property.</span></span> <span data-ttu-id="10fc7-145">En lui affectant fenêtre glissante, le délai d’expiration est réinitialisé lors de chaque opération est effectuée.</span><span class="sxs-lookup"><span data-stu-id="10fc7-145">By setting it to Sliding, the expiration time is reset when each operation is performed.</span></span>

## <a name="cachekeydependency-property"></a><span data-ttu-id="10fc7-146">Propriété CacheKeyDependency</span><span class="sxs-lookup"><span data-stu-id="10fc7-146">CacheKeyDependency Property</span></span>

<span data-ttu-id="10fc7-147">Si une valeur de chaîne est spécifiée pour la propriété CacheKeyDependency, ASP.NET définit une nouvelle dépendance de cache basé sur cette chaîne.</span><span class="sxs-lookup"><span data-stu-id="10fc7-147">If a string value is specified for the CacheKeyDependency property, ASP.NET will set up a new cache dependency based on that string.</span></span> <span data-ttu-id="10fc7-148">Cela vous permet à explicitement invalider le cache en modifiant ou en supprimant le CacheKeyDependency simplement.</span><span class="sxs-lookup"><span data-stu-id="10fc7-148">This allows you to explicitly invalidate the cache by simply changing or removing the CacheKeyDependency.</span></span>

<span data-ttu-id="10fc7-149">**Important** : Si l’emprunt d’identité est activé et l’accès à la source de données et/ou le contenu de données est basée sur l’identité du client, il est recommandé que la mise en cache désactivée en définissant EnableCaching sur False.</span><span class="sxs-lookup"><span data-stu-id="10fc7-149">**Important**: If impersonation is enabled and access to the data source and/or content of data are based upon client identity, it is recommended that caching be disabled by setting EnableCaching to False.</span></span> <span data-ttu-id="10fc7-150">Si la mise en cache est activée dans ce scénario et un utilisateur autre que l’utilisateur qui a demandé les données émet une demande, l’autorisation à la source de données n’est pas appliquée.</span><span class="sxs-lookup"><span data-stu-id="10fc7-150">If caching is enabled in this scenario and a user other than the user who originally requested the data issues a request, authorization to the data source is not enforced.</span></span> <span data-ttu-id="10fc7-151">Les données seront traitées simplement à partir du cache.</span><span class="sxs-lookup"><span data-stu-id="10fc7-151">The data will simply be served from cache.</span></span>

## <a name="the-sqldatasource-control"></a><span data-ttu-id="10fc7-152">Le contrôle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-152">The SqlDataSource Control</span></span>

<span data-ttu-id="10fc7-153">Le contrôle SqlDataSource permet au développeur d’accéder aux données stockées dans une base de données relationnelle qui prend en charge ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="10fc7-153">The SqlDataSource control allows a developer to access data stored in any relational database that supports ADO.NET.</span></span> <span data-ttu-id="10fc7-154">Il peut utiliser le fournisseur System.Data.SqlClient pour accéder à une base de données SQL Server, le fournisseur System.Data.OleDb, le fournisseur System.Data.Odbc ou le fournisseur System.Data.OracleClient pour accéder à Oracle.</span><span class="sxs-lookup"><span data-stu-id="10fc7-154">It can use the System.Data.SqlClient provider to access a SQL Server database, the System.Data.OleDb provider, the System.Data.Odbc provider, or the System.Data.OracleClient provider to access Oracle.</span></span> <span data-ttu-id="10fc7-155">Par conséquent, SqlDataSource est certainement pas uniquement utilisé pour accéder aux données dans une base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="10fc7-155">Therefore, the SqlDataSource is certainly not only used for accessing data in a SQL Server database.</span></span>

<span data-ttu-id="10fc7-156">Pour pouvoir utiliser SqlDataSource, vous simplement fournissez une valeur pour la propriété ConnectionString et spécifier une commande SQL ou procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="10fc7-156">In order to use the SqlDataSource, you simply provide a value for the ConnectionString property and specify a SQL command or stored procedure.</span></span> <span data-ttu-id="10fc7-157">Le contrôle SqlDataSource s’occupe de l’utilisation de l’architecture ADO.NET sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="10fc7-157">The SqlDataSource control takes care of working with the underlying ADO.NET architecture.</span></span> <span data-ttu-id="10fc7-158">Il ouvre la connexion, interroge la source de données ou exécute la procédure stockée, retourne les données, puis ferme la connexion pour vous.</span><span class="sxs-lookup"><span data-stu-id="10fc7-158">It opens the connection, queries the data source or executes the stored procedure, returns the data, and then closes the connection for you.</span></span>

> [!NOTE]
> <span data-ttu-id="10fc7-159">Étant donné que la classe DataSourceControl ferme automatiquement la connexion pour vous, il doit réduire le nombre d’appels de client généré par la fuite des connexions de base de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-159">Because the DataSourceControl class automatically closes the connection for you, it should reduce the number of customer calls generated by leaking database connections.</span></span>

<span data-ttu-id="10fc7-160">L’extrait de code suivant lie un contrôle DropDownList à un contrôle SqlDataSource à l’aide de la chaîne de connexion qui est stockée dans le fichier de configuration, comme indiqué ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="10fc7-160">The code snippet below binds a DropDownList control to a SqlDataSource control using the connection string that is stored in the configuration file as shown above.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample3.aspx)]

<span data-ttu-id="10fc7-161">Comme illustré ci-dessus, la propriété DataSourceMode de SqlDataSource Spécifie le mode pour la source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-161">As illustrated above, the DataSourceMode property of the SqlDataSource specifies the mode for the data source.</span></span> <span data-ttu-id="10fc7-162">Dans l’exemple ci-dessus, le DataSourceMode est défini à DataReader.</span><span class="sxs-lookup"><span data-stu-id="10fc7-162">In the example above, the DataSourceMode is set to DataReader.</span></span> <span data-ttu-id="10fc7-163">Dans ce cas, SqlDataSource retournera un objet IDataReader à l’aide d’un curseur avant uniquement et en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="10fc7-163">In that case, the SqlDataSource will return an IDataReader object using a forward-only and read-only cursor.</span></span> <span data-ttu-id="10fc7-164">Le type spécifié de l’objet retourné est contrôlé par le fournisseur qui est utilisé.</span><span class="sxs-lookup"><span data-stu-id="10fc7-164">The specified type of object that is returned is controlled by the provider that is used.</span></span> <span data-ttu-id="10fc7-165">Dans ce cas, j’utilise le fournisseur System.Data.SqlClient tel que spécifié dans le &lt;connectionStrings&gt; section du fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="10fc7-165">In this case, I'm using the System.Data.SqlClient provider as specified in the &lt;connectionStrings&gt; section of the web.config file.</span></span> <span data-ttu-id="10fc7-166">Par conséquent, l’objet retourné sera de type SqlDataReader.</span><span class="sxs-lookup"><span data-stu-id="10fc7-166">Therefore, the object that is returned will be of type SqlDataReader.</span></span> <span data-ttu-id="10fc7-167">En spécifiant une valeur DataSourceMode du jeu de données, les données peuvent être stockées dans un jeu de données sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="10fc7-167">By specifying a DataSourceMode value of DataSet, the data can be stored in a DataSet on the server.</span></span> <span data-ttu-id="10fc7-168">Ce mode vous permet d’ajouter des fonctionnalités telles que le tri, la pagination, etc. Si j’avais été la liaison de données SqlDataSource à un contrôle GridView, j’ai choisissions le mode de jeu de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-168">This mode allows you to add features such as sorting, paging, etc. If I had been data-binding the SqlDataSource to a GridView control, I would have chosen the DataSet mode.</span></span> <span data-ttu-id="10fc7-169">Toutefois, dans le cas d’un contrôle DropDownList, le mode de DataReader est le bon choix.</span><span class="sxs-lookup"><span data-stu-id="10fc7-169">However, in the case of a DropDownList, the DataReader mode is the correct choice.</span></span>

> [!NOTE]
> <span data-ttu-id="10fc7-170">Lors de la mise en cache un SqlDataSource ou un AccessDataSource, vous devez définir la propriété DataSourceMode au jeu de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-170">When caching a SqlDataSource or an AccessDataSource, the DataSourceMode property must be set to DataSet.</span></span> <span data-ttu-id="10fc7-171">Une exception se produit si vous activez la mise en cache avec un DataSourceMode de DataReader.</span><span class="sxs-lookup"><span data-stu-id="10fc7-171">An exception will occur if you enable caching with a DataSourceMode of DataReader.</span></span>

## <a name="sqldatasource-properties"></a><span data-ttu-id="10fc7-172">Propriétés de SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-172">SqlDataSource Properties</span></span>

<span data-ttu-id="10fc7-173">Voici certaines des propriétés du contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-173">The following are some of the properties of the SqlDataSource control.</span></span>

### <a name="cancelselectonnullparameter"></a><span data-ttu-id="10fc7-174">CancelSelectOnNullParameter</span><span class="sxs-lookup"><span data-stu-id="10fc7-174">CancelSelectOnNullParameter</span></span>

<span data-ttu-id="10fc7-175">Valeur booléenne qui spécifie si une commande select est annulée si l’un des paramètres a la valeur null.</span><span class="sxs-lookup"><span data-stu-id="10fc7-175">A Boolean value that specifies whether a select command is canceled if one of the parameters is null.</span></span> <span data-ttu-id="10fc7-176">True par défaut.</span><span class="sxs-lookup"><span data-stu-id="10fc7-176">True by default.</span></span>

### <a name="conflictdetection"></a><span data-ttu-id="10fc7-177">ConflictDetection</span><span class="sxs-lookup"><span data-stu-id="10fc7-177">ConflictDetection</span></span>

<span data-ttu-id="10fc7-178">Dans une situation où plusieurs utilisateurs peuvent être mise à jour une source de données en même temps, la propriété ConflictDetection détermine le comportement du contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-178">In a situation where multiple users may be updating a data source at the same time, the ConflictDetection property determines the behavior of the SqlDataSource control.</span></span> <span data-ttu-id="10fc7-179">Cette propriété correspond à une des valeurs de l’énumération ConflictOptions.</span><span class="sxs-lookup"><span data-stu-id="10fc7-179">This property evaluates to one of the values of the ConflictOptions enumeration.</span></span> <span data-ttu-id="10fc7-180">Ces valeurs sont **CompareAllValues** et **OverwriteChanges**.</span><span class="sxs-lookup"><span data-stu-id="10fc7-180">Those values are **CompareAllValues** and **OverwriteChanges**.</span></span> <span data-ttu-id="10fc7-181">Si set OverwriteChanges, la dernière personne à écrire des données dans la source de données remplace toutes les modifications précédentes.</span><span class="sxs-lookup"><span data-stu-id="10fc7-181">If set to OverwriteChanges, the last person to write data to the data source overwrites any previous changes.</span></span> <span data-ttu-id="10fc7-182">Toutefois, si la propriété ConflictDetection est définie à CompareAllValues, paramètres sont créés pour les colonnes retournées par SelectCommand et paramètres sont également créées pour stocker les valeurs d’origine dans chacune de ces colonnes autorisant SqlDataSource à déterminer si les valeurs ont changé dans la mesure où SelectCommand a été exécutée.</span><span class="sxs-lookup"><span data-stu-id="10fc7-182">However, if the ConflictDetection property is set to CompareAllValues, parameters get created for the columns returned by the SelectCommand and parameters are also created to hold the original values in each of those columns allowing the SqlDataSource to determine whether or not the values have changed since the SelectCommand was executed.</span></span>

### <a name="deletecommand"></a><span data-ttu-id="10fc7-183">DeleteCommand</span><span class="sxs-lookup"><span data-stu-id="10fc7-183">DeleteCommand</span></span>

<span data-ttu-id="10fc7-184">Définit ou obtient la chaîne SQL utilisée lors de la suppression de lignes à partir de la base de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-184">Sets or gets the SQL string used when deleting rows from the database.</span></span> <span data-ttu-id="10fc7-185">Il peut s’agir d’une requête SQL ou un nom de procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="10fc7-185">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="deletecommandtype"></a><span data-ttu-id="10fc7-186">DeleteCommandType</span><span class="sxs-lookup"><span data-stu-id="10fc7-186">DeleteCommandType</span></span>

<span data-ttu-id="10fc7-187">Définit ou obtient le type de commande de suppression, soit une requête SQL (texte) ou une procédure stockée (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="10fc7-187">Sets or gets the type of delete command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="deleteparameters"></a><span data-ttu-id="10fc7-188">DeleteParameters</span><span class="sxs-lookup"><span data-stu-id="10fc7-188">DeleteParameters</span></span>

<span data-ttu-id="10fc7-189">Retourne les paramètres utilisés par la propriété DeleteCommand de l’objet SqlDataSourceView associé au contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-189">Returns the parameters that are used by the DeleteCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

### <a name="oldvaluesparameterformatstring"></a><span data-ttu-id="10fc7-190">OldValuesParameterFormatString</span><span class="sxs-lookup"><span data-stu-id="10fc7-190">OldValuesParameterFormatString</span></span>

<span data-ttu-id="10fc7-191">Cette propriété est utilisée pour spécifier le format des paramètres des valeurs d’origine dans les cas où la propriété ConflictDetection a CompareAllValues.</span><span class="sxs-lookup"><span data-stu-id="10fc7-191">This property is used to specify the format of the original value parameters in cases where the ConflictDetection property is set to CompareAllValues.</span></span> <span data-ttu-id="10fc7-192">La valeur par défaut est {0} ce qui signifie que les paramètres de valeur d’origine prend le même nom que le paramètre d’origine.</span><span class="sxs-lookup"><span data-stu-id="10fc7-192">The default is {0} which means that original value parameters will take the same name as the original parameter.</span></span> <span data-ttu-id="10fc7-193">En d’autres termes, si le nom du champ est EmployeeID, le paramètre de valeur d’origine serait @EmployeeID.</span><span class="sxs-lookup"><span data-stu-id="10fc7-193">In other words, if the field name is EmployeeID, the original value parameter would be @EmployeeID.</span></span>

### <a name="selectcommand"></a><span data-ttu-id="10fc7-194">SelectCommand</span><span class="sxs-lookup"><span data-stu-id="10fc7-194">SelectCommand</span></span>

<span data-ttu-id="10fc7-195">Définit ou obtient la chaîne SQL qui est utilisée pour récupérer des données à partir de la base de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-195">Sets or gets the SQL string that is used to retrieve data from the database.</span></span> <span data-ttu-id="10fc7-196">Il peut s’agir d’une requête SQL ou un nom de procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="10fc7-196">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="selectcommandtype"></a><span data-ttu-id="10fc7-197">SelectCommandType</span><span class="sxs-lookup"><span data-stu-id="10fc7-197">SelectCommandType</span></span>

<span data-ttu-id="10fc7-198">Définit ou obtient le type de commande select, soit une requête SQL (texte) ou une procédure stockée (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="10fc7-198">Sets or gets the type of select command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="selectparameters"></a><span data-ttu-id="10fc7-199">SelectParameters</span><span class="sxs-lookup"><span data-stu-id="10fc7-199">SelectParameters</span></span>

<span data-ttu-id="10fc7-200">Retourne les paramètres qui sont utilisés par SelectCommand de l’objet SqlDataSourceView associé au contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-200">Returns the parameters that are used by the SelectCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

### <a name="sortparametername"></a><span data-ttu-id="10fc7-201">SortParameterName</span><span class="sxs-lookup"><span data-stu-id="10fc7-201">SortParameterName</span></span>

<span data-ttu-id="10fc7-202">Obtient ou définit le nom d’un paramètre de procédure stockée qui est utilisé lorsque le tri des données récupérées par le contrôle de source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-202">Gets or sets the name of a stored procedure parameter that is used when sorting data retrieved by the data source control.</span></span> <span data-ttu-id="10fc7-203">Valide uniquement lorsque SelectCommandType est défini sur StoredProcedure.</span><span class="sxs-lookup"><span data-stu-id="10fc7-203">Valid only when SelectCommandType is set to StoredProcedure.</span></span>

### <a name="sqlcachedependency"></a><span data-ttu-id="10fc7-204">SqlCacheDependency</span><span class="sxs-lookup"><span data-stu-id="10fc7-204">SqlCacheDependency</span></span>

<span data-ttu-id="10fc7-205">Chaîne spécifiant les bases de données et les tables utilisées dans une dépendance de cache SQL Server, séparés par un point-virgule.</span><span class="sxs-lookup"><span data-stu-id="10fc7-205">A semi-colon delimited string specifying the databases and tables used in a SQL Server cache dependency.</span></span> <span data-ttu-id="10fc7-206">(Les dépendances de cache SQL seront abordées dans un autre module.)</span><span class="sxs-lookup"><span data-stu-id="10fc7-206">(SQL cache dependencies will be discussed in a later module.)</span></span>

### <a name="updatecommand"></a><span data-ttu-id="10fc7-207">UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="10fc7-207">UpdateCommand</span></span>

<span data-ttu-id="10fc7-208">Définit ou obtient la chaîne SQL qui est utilisée lors de la mise à jour des données dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-208">Sets or gets the SQL string that is used when updating data in the database.</span></span> <span data-ttu-id="10fc7-209">Il peut s’agir d’une requête SQL ou un nom de procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="10fc7-209">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="updatecommandtype"></a><span data-ttu-id="10fc7-210">UpdateCommandType</span><span class="sxs-lookup"><span data-stu-id="10fc7-210">UpdateCommandType</span></span>

<span data-ttu-id="10fc7-211">Définit ou obtient le type de commande de mise à jour, soit une requête SQL (texte) ou une procédure stockée (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="10fc7-211">Sets or gets the type of update command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="updateparameters"></a><span data-ttu-id="10fc7-212">UpdateParameters</span><span class="sxs-lookup"><span data-stu-id="10fc7-212">UpdateParameters</span></span>

<span data-ttu-id="10fc7-213">Retourne les paramètres utilisés par la propriété UpdateCommand de l’objet SqlDataSourceView associé au contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-213">Returns the parameters that are used by the UpdateCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

## <a name="the-accessdatasource-control"></a><span data-ttu-id="10fc7-214">Le contrôle AccessDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-214">The AccessDataSource Control</span></span>

<span data-ttu-id="10fc7-215">Le contrôle AccessDataSource dérive de la classe SqlDataSource et est utilisé pour lier les données à une base de données Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="10fc7-215">The AccessDataSource control derives from the SqlDataSource class and is used to data-bind to a Microsoft Access database.</span></span> <span data-ttu-id="10fc7-216">La propriété ConnectionString pour le contrôle AccessDataSource est une propriété en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="10fc7-216">The ConnectionString property for the AccessDataSource control is a read-only property.</span></span> <span data-ttu-id="10fc7-217">Au lieu d’utiliser la propriété ConnectionString, la propriété de fichier de données est utilisée pour pointer vers la base de données Access comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="10fc7-217">Instead of using the ConnectionString property, the DataFile property is used to point to the Access Database as shown below.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample4.aspx)]

<span data-ttu-id="10fc7-218">Le AccessDataSource sera toujours la valeur de base SqlDataSource ProviderName System.Data.OleDb et se connecte à la base de données à l’aide du fournisseur OLE DB Microsoft.Jet.OLEDB.4.0.</span><span class="sxs-lookup"><span data-stu-id="10fc7-218">The AccessDataSource will always set the ProviderName of the base SqlDataSource to System.Data.OleDb and connects to the database using the Microsoft.Jet.OLEDB.4.0 OLE DB provider.</span></span> <span data-ttu-id="10fc7-219">Vous ne pouvez pas utiliser le contrôle AccessDataSource pour se connecter à une base de données Access protégé par mot de passe.</span><span class="sxs-lookup"><span data-stu-id="10fc7-219">You cannot use the AccessDataSource control to connect to a password-protected Access database.</span></span> <span data-ttu-id="10fc7-220">Si vous devez vous connecter à une base de données protégé par mot de passe, vous devez utiliser le contrôle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-220">If you have to connect to a password protected database, you should use the SqlDataSource control.</span></span>

> [!NOTE]
> <span data-ttu-id="10fc7-221">Bases de données Access stockées dans le site Web doivent être placés dans l’application\_répertoire de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-221">Access databases stored within the Web site should be placed in the App\_Data directory.</span></span> <span data-ttu-id="10fc7-222">ASP.NET n’autorise pas les fichiers dans ce répertoire à Explorer.</span><span class="sxs-lookup"><span data-stu-id="10fc7-222">ASP.NET does not allow files in this directory to be browsed.</span></span> <span data-ttu-id="10fc7-223">Vous devez accorder des autorisations en lecture et en écriture à l’application le compte de processus\_répertoire de données lors de l’utilisation de bases de données Access.</span><span class="sxs-lookup"><span data-stu-id="10fc7-223">You will need to grant the process account Read and Write permissions to the App\_Data directory when using Access databases.</span></span>

## <a name="the-xmldatasource-control"></a><span data-ttu-id="10fc7-224">Le contrôle XmlDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-224">The XmlDataSource Control</span></span>

<span data-ttu-id="10fc7-225">XmlDataSource est utilisé pour lier des données XML à des contrôles liés aux données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-225">The XmlDataSource is used to data-bind XML data to data-bound controls.</span></span> <span data-ttu-id="10fc7-226">Vous pouvez lier à un fichier XML à l’aide de la propriété de fichier de données, ou vous pouvez lier à une chaîne XML à l’aide de la propriété de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-226">You can bind to an XML file using the DataFile property or you can bind to an XML string using the Data property.</span></span> <span data-ttu-id="10fc7-227">XmlDataSource expose des attributs XML en tant que champs pouvant être liées.</span><span class="sxs-lookup"><span data-stu-id="10fc7-227">The XmlDataSource exposes XML attributes as bindable fields.</span></span> <span data-ttu-id="10fc7-228">Dans le cas où vous devez lier à des valeurs qui ne sont pas représentés en tant qu’attributs, vous devez utiliser une transformation XSL.</span><span class="sxs-lookup"><span data-stu-id="10fc7-228">In cases where you need to bind to values that are not represented as attributes, you will need to use an XSL transform.</span></span> <span data-ttu-id="10fc7-229">Vous pouvez également utiliser des expressions XPath pour filtrer les données XML.</span><span class="sxs-lookup"><span data-stu-id="10fc7-229">You can also use XPath expressions to filter XML data.</span></span>

<span data-ttu-id="10fc7-230">Prenez en compte le fichier XML suivant :</span><span class="sxs-lookup"><span data-stu-id="10fc7-230">Consider the following XML file:</span></span>

[!code-xml[Main](data-source-controls/samples/sample5.xml)]

<span data-ttu-id="10fc7-231">Notez que XmlDataSource utilise une propriété XPath de *personnes ou d’une personne* afin de filtrer sur uniquement le &lt;personne&gt; nœuds.</span><span class="sxs-lookup"><span data-stu-id="10fc7-231">Notice that the XmlDataSource uses an XPath property of *People/Person* in order to filter on just the &lt;Person&gt; nodes.</span></span> <span data-ttu-id="10fc7-232">L’objet DropDownList puis données établit une liaison à l’attribut LastName à l’aide de la propriété DataTextField.</span><span class="sxs-lookup"><span data-stu-id="10fc7-232">The DropDownList then data-binds to the LastName attribute using the DataTextField property.</span></span>

<span data-ttu-id="10fc7-233">Tandis que le contrôle XmlDataSource est principalement utilisé pour lier les données à des données XML en lecture seule, il est possible de modifier le fichier de données XML.</span><span class="sxs-lookup"><span data-stu-id="10fc7-233">While the XmlDataSource control is primarily used to data-bind to read-only XML data, it is possible to edit the XML data file.</span></span> <span data-ttu-id="10fc7-234">Notez que dans ce cas, l’insertion automatique, la mise à jour et suppression d’informations dans le fichier XML n’est pas automatique comme il le fait avec d’autres contrôles de source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-234">Note that in such cases, automatic insertion, updating, and deletion of information in the XML file does not happen automatically as it does with other data source controls.</span></span> <span data-ttu-id="10fc7-235">Au lieu de cela, vous devrez écrire du code pour modifier manuellement les données à l’aide des méthodes suivantes du contrôle XmlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-235">Instead, you will have to write code to manually edit the data using the following methods of the XmlDataSource control.</span></span>

### <a name="getxmldocument"></a><span data-ttu-id="10fc7-236">GetXmlDocument</span><span class="sxs-lookup"><span data-stu-id="10fc7-236">GetXmlDocument</span></span>

<span data-ttu-id="10fc7-237">Récupère un objet XmlDocument qui contient le code XML récupéré par le XmlDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-237">Retrieves an XmlDocument object containing the XML code retrieved by the XmlDataSource.</span></span>

### <a name="save"></a><span data-ttu-id="10fc7-238">Enregistrer</span><span class="sxs-lookup"><span data-stu-id="10fc7-238">Save</span></span>

<span data-ttu-id="10fc7-239">Enregistre le XmlDocument en mémoire à la source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-239">Saves the in-memory XmlDocument back to the data source.</span></span>

<span data-ttu-id="10fc7-240">Il est important de savoir que la méthode Save fonctionne uniquement lorsque les deux conditions suivantes sont remplies :</span><span class="sxs-lookup"><span data-stu-id="10fc7-240">It's important to realize that the Save method will only work when the following two conditions are met:</span></span>

1. <span data-ttu-id="10fc7-241">XmlDataSource est à l’aide de la propriété de fichier de données à lier à un fichier XML au lieu de la propriété de données à lier aux données XML en mémoire.</span><span class="sxs-lookup"><span data-stu-id="10fc7-241">The XmlDataSource is using the DataFile property to bind to an XML file instead of the Data property to bind to in-memory XML data.</span></span>
2. <span data-ttu-id="10fc7-242">Aucune transformation n’est spécifiée via la propriété de transformation ou TransformFile.</span><span class="sxs-lookup"><span data-stu-id="10fc7-242">No transformation is specified via the Transform or TransformFile property.</span></span>

<span data-ttu-id="10fc7-243">Notez également que la méthode Save peut produire des résultats inattendus lorsqu’elle est appelée par plusieurs utilisateurs simultanément.</span><span class="sxs-lookup"><span data-stu-id="10fc7-243">Note also that the Save method can yield unexpected results when called by multiple users concurrently.</span></span>

## <a name="the-objectdatasource-control"></a><span data-ttu-id="10fc7-244">Le contrôle ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-244">The ObjectDataSource Control</span></span>

<span data-ttu-id="10fc7-245">Les contrôles de source de données que nous avons décrites jusqu’ici sont un choix excellent pour les applications à deux niveaux où le contrôle de source de données communique directement avec le magasin de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-245">The data source controls that we have covered up to this point are excellent choices for two-tier applications where the data source control communicates directly to the data store.</span></span> <span data-ttu-id="10fc7-246">Toutefois, de nombreuses applications du monde réel sont des applications multiniveau où un contrôle de source de données peut-être avoir besoin communiquer avec un objet métier qui, à son tour, communique avec la couche données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-246">However, many real-world applications are multi-tier applications where a data source control might need to communicate to a business object which, in turn, communicates with the data layer.</span></span> <span data-ttu-id="10fc7-247">Dans ces situations, ObjectDataSource remplit la facture parfaitement.</span><span class="sxs-lookup"><span data-stu-id="10fc7-247">In these situations, the ObjectDataSource fills the bill nicely.</span></span> <span data-ttu-id="10fc7-248">ObjectDataSource fonctionne conjointement avec un objet source.</span><span class="sxs-lookup"><span data-stu-id="10fc7-248">The ObjectDataSource works in conjunction with a source object.</span></span> <span data-ttu-id="10fc7-249">Le contrôle ObjectDataSource crée une instance de l’objet source, appelez la méthode spécifiée et supprime l’instance d’objet tout dans l’étendue d’une demande unique, si votre objet possède des méthodes d’instance au lieu de méthodes statiques (Shared en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="10fc7-249">The ObjectDataSource control will create an instance of the source object, call the specified method, and dispose of the object instance all within the scope of a single request, if your object has instance methods instead of static methods (Shared in Visual Basic).</span></span> <span data-ttu-id="10fc7-250">Par conséquent, votre objet doit être sans état.</span><span class="sxs-lookup"><span data-stu-id="10fc7-250">Therefore, your object must be stateless.</span></span> <span data-ttu-id="10fc7-251">Autrement dit, votre objet doit acquérir et libérer toutes les ressources nécessaires au sein de l’étendue d’une demande unique.</span><span class="sxs-lookup"><span data-stu-id="10fc7-251">That is, your object should acquire and release all required resources within the span of a single request.</span></span> <span data-ttu-id="10fc7-252">Vous pouvez contrôler la façon dont l’objet source est créé en gérant l’événement ObjectCreating du contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-252">You can control how the source object is created by handling the ObjectCreating event of the ObjectDataSource control.</span></span> <span data-ttu-id="10fc7-253">Vous pouvez créer une instance de l’objet source et puis définissez la propriété ObjectInstance de la classe ObjectDataSourceEventArgs à cette instance.</span><span class="sxs-lookup"><span data-stu-id="10fc7-253">You can create an instance of the source object, and then set the ObjectInstance property of the ObjectDataSourceEventArgs class to that instance.</span></span> <span data-ttu-id="10fc7-254">Le contrôle ObjectDataSource utilisera l’instance qui est créé dans l’événement ObjectCreating au lieu de créer une instance sur son propre.</span><span class="sxs-lookup"><span data-stu-id="10fc7-254">The ObjectDataSource control will use the instance that is created in the ObjectCreating event instead of creating an instance on its own.</span></span>

<span data-ttu-id="10fc7-255">Si l’objet source pour un contrôle ObjectDataSource expose des méthodes statiques publiques (Shared en Visual Basic) qui peuvent être appelés pour extraire et modifier des données, un contrôle ObjectDataSource appelle ces méthodes directement.</span><span class="sxs-lookup"><span data-stu-id="10fc7-255">If the source object for an ObjectDataSource control exposes public static methods (Shared in Visual Basic) that can be called to retrieve and modify data, an ObjectDataSource control will call those methods directly.</span></span> <span data-ttu-id="10fc7-256">Si un contrôle ObjectDataSource doit créer une instance de l’objet source afin d’effectuer des appels de méthode, l’objet doit inclure un constructeur public qui n’accepte aucun paramètre.</span><span class="sxs-lookup"><span data-stu-id="10fc7-256">If an ObjectDataSource control must create an instance of the source object in order to make method calls, the object must include a public constructor that takes no parameters.</span></span> <span data-ttu-id="10fc7-257">Le contrôle ObjectDataSource appelle ce constructeur lorsqu’il crée une nouvelle instance de l’objet source.</span><span class="sxs-lookup"><span data-stu-id="10fc7-257">The ObjectDataSource control will call this constructor when it creates a new instance of the source object.</span></span>

<span data-ttu-id="10fc7-258">Si l’objet source ne contient pas de constructeur public sans paramètres, vous pouvez créer une instance de l’objet source qui sera utilisé par le contrôle ObjectDataSource dans l’événement ObjectCreating.</span><span class="sxs-lookup"><span data-stu-id="10fc7-258">If the source object does not contain a public constructor without parameters, you can create an instance of the source object that will be used by the ObjectDataSource control in the ObjectCreating event.</span></span>

## <a name="specifying-object-methods"></a><span data-ttu-id="10fc7-259">Spécification des méthodes d’objet</span><span class="sxs-lookup"><span data-stu-id="10fc7-259">Specifying Object Methods</span></span>

<span data-ttu-id="10fc7-260">L’objet source pour un contrôle ObjectDataSource peut contenir un nombre illimité de méthodes qui sont utilisées pour sélectionner, insérer, mettre à jour ou supprimer des données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-260">The source object for an ObjectDataSource control can contain any number of methods that are used to select, insert, update, or delete data.</span></span> <span data-ttu-id="10fc7-261">Ces méthodes sont appelées par le contrôle ObjectDataSource basé sur le nom de la méthode, tel qu’identifié à l’aide de la méthode SelectMethod, InsertMethod, UpdateMethod, DeleteMethod propriété ou du contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="10fc7-261">These methods are called by the ObjectDataSource control based on the name of the method, as identified by using either the SelectMethod, InsertMethod, UpdateMethod, or DeleteMethod property of the ObjectDataSource control.</span></span> <span data-ttu-id="10fc7-262">L’objet source peut également inclure une méthode SelectCount facultative, ce qui est identifiée par le contrôle ObjectDataSource à l’aide de la propriété SelectCountMethod, qui retourne le nombre du nombre total d’objets à la source de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-262">The source object can also include an optional SelectCount method, which is identified by the ObjectDataSource control using the SelectCountMethod property, that returns the count of the total number of objects at the data source.</span></span> <span data-ttu-id="10fc7-263">Le contrôle ObjectDataSource appelle la méthode SelectCount après qu’une méthode Select a été appelée pour récupérer le nombre total d’enregistrements à la source de données pour une utilisation lors de la pagination.</span><span class="sxs-lookup"><span data-stu-id="10fc7-263">The ObjectDataSource control will call the SelectCount method after a Select method has been called to retrieve the total number of records at the data source for use when paging.</span></span>

## <a name="lab-using-data-source-controls"></a><span data-ttu-id="10fc7-264">Laboratoire à l’aide de contrôles de Source de données</span><span class="sxs-lookup"><span data-stu-id="10fc7-264">Lab Using Data Source Controls</span></span>

## <a name="exercise-1---displaying-data-with-the-sqldatasource-control"></a><span data-ttu-id="10fc7-265">Exercice 1 : affichage des données avec le contrôle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-265">Exercise 1 - Displaying Data with the SqlDataSource Control</span></span>

<span data-ttu-id="10fc7-266">L’exercice suivant utilise le contrôle SqlDataSource pour se connecter à la base de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="10fc7-266">The following exercise uses the SqlDataSource control to connect to the Northwind database.</span></span> <span data-ttu-id="10fc7-267">Il suppose que vous avez accès à la base de données Northwind sur une instance de SQL Server 2000.</span><span class="sxs-lookup"><span data-stu-id="10fc7-267">It assumes that you have access to the Northwind database on a SQL Server 2000 instance.</span></span>

1. <span data-ttu-id="10fc7-268">Créez un site Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="10fc7-268">Create a new ASP.NET Web site.</span></span>
2. <span data-ttu-id="10fc7-269">Ajouter un nouveau fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="10fc7-269">Add a new web.config file.</span></span>

    1. <span data-ttu-id="10fc7-270">Avec le bouton droit sur le projet dans l’Explorateur de solutions, puis cliquez sur Ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="10fc7-270">Right-click on the project in Solution Explorer and click Add New Item.</span></span>
    2. <span data-ttu-id="10fc7-271">Choisissez le fichier de Configuration Web à partir de la liste des modèles et cliquez sur Ajouter.</span><span class="sxs-lookup"><span data-stu-id="10fc7-271">Choose Web Configuration File from the list of templates and click Add.</span></span>
3. <span data-ttu-id="10fc7-272">Modifier le &lt;connectionStrings&gt; section comme suit :</span><span class="sxs-lookup"><span data-stu-id="10fc7-272">Edit the &lt;connectionStrings&gt; section as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample6.aspx)]
4. <span data-ttu-id="10fc7-273">Basculez en mode Code et ajoutez un attribut ConnectionString et un attribut de SelectCommand à la &lt;asp : SqlDataSource&gt; contrôler comme suit :</span><span class="sxs-lookup"><span data-stu-id="10fc7-273">Switch to Code view and add a ConnectionString attribute and a SelectCommand attribute to the &lt;asp:SqlDataSource&gt; control as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample7.aspx)]
5. <span data-ttu-id="10fc7-274">À partir de la vue de conception, ajoutez un nouveau contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="10fc7-274">From Design view, add a new GridView control.</span></span>
6. <span data-ttu-id="10fc7-275">Dans la liste déroulante Choisir la Source de données dans le menu Tâches GridView, choisissez SqlDataSource1.</span><span class="sxs-lookup"><span data-stu-id="10fc7-275">From the Choose Data Source dropdown in the GridView Tasks menu, choose SqlDataSource1.</span></span>
7. <span data-ttu-id="10fc7-276">Avec le bouton droit sur Default.aspx et choisissez Afficher dans le navigateur à partir du menu.</span><span class="sxs-lookup"><span data-stu-id="10fc7-276">Right-click on Default.aspx and choose View in Browser from the menu.</span></span> <span data-ttu-id="10fc7-277">Cliquez sur Oui lorsque vous êtes invité à enregistrer.</span><span class="sxs-lookup"><span data-stu-id="10fc7-277">Click Yes when prompted to save.</span></span>
8. <span data-ttu-id="10fc7-278">Le contrôle GridView affiche les données à partir de la table Products.</span><span class="sxs-lookup"><span data-stu-id="10fc7-278">The GridView displays the data from the Products table.</span></span>

## <a name="exercise-2---editing-data-with-the-sqldatasource-control"></a><span data-ttu-id="10fc7-279">Exercice 2 : modification des données avec le contrôle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-279">Exercise 2 - Editing Data with the SqlDataSource Control</span></span>

<span data-ttu-id="10fc7-280">L’exercice suivant montre comment lier des données DropDownList contrôler à l’aide de la syntaxe déclarative et permet de modifier les données présentées dans le contrôle DropDownList.</span><span class="sxs-lookup"><span data-stu-id="10fc7-280">The following exercise demonstrates how to data bind a DropDownList control using the declarative syntax and allows you to edit the data presented in the DropDownList control.</span></span>

1. <span data-ttu-id="10fc7-281">En mode conception, supprimez le contrôle GridView Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="10fc7-281">In Design view, delete the GridView control from Default.aspx.</span></span> 

    <span data-ttu-id="10fc7-282">**Important** : Laissez le contrôle SqlDataSource sur la page.</span><span class="sxs-lookup"><span data-stu-id="10fc7-282">**Important**: Leave the SqlDataSource control on the page.</span></span>
2. <span data-ttu-id="10fc7-283">Ajouter un contrôle DropDownList à Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="10fc7-283">Add a DropDownList control to Default.aspx.</span></span>
3. <span data-ttu-id="10fc7-284">Basculer en mode Source.</span><span class="sxs-lookup"><span data-stu-id="10fc7-284">Switch to Source view.</span></span>
4. <span data-ttu-id="10fc7-285">Ajoutez un attribut DataSourceId, DataTextField et DataValueField à la &lt;asp : DropDownList&gt; contrôler comme suit :</span><span class="sxs-lookup"><span data-stu-id="10fc7-285">Add a DataSourceId, DataTextField, and DataValueField attribute to the &lt;asp:DropDownList&gt; control as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample8.aspx)]
5. <span data-ttu-id="10fc7-286">Enregistrez Default.aspx et affichez-le dans le navigateur.</span><span class="sxs-lookup"><span data-stu-id="10fc7-286">Save Default.aspx and view it in the browser.</span></span> <span data-ttu-id="10fc7-287">Notez que l’objet DropDownList contient tous les produits à partir de la base de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="10fc7-287">Note that the DropDownList contains all of the products from the Northwind database.</span></span>
6. <span data-ttu-id="10fc7-288">Fermez le navigateur.</span><span class="sxs-lookup"><span data-stu-id="10fc7-288">Close the browser.</span></span>
7. <span data-ttu-id="10fc7-289">Dans la vue de Source de Default.aspx, ajoutez un nouveau contrôle de zone de texte sous le contrôle DropDownList.</span><span class="sxs-lookup"><span data-stu-id="10fc7-289">In Source view of Default.aspx, add a new TextBox control below the DropDownList control.</span></span> <span data-ttu-id="10fc7-290">Modifier la propriété ID de la zone de texte à txtProductName.</span><span class="sxs-lookup"><span data-stu-id="10fc7-290">Change the ID property of the TextBox to txtProductName.</span></span>
8. <span data-ttu-id="10fc7-291">Sous le contrôle de zone de texte, ajoutez un nouveau contrôle de bouton.</span><span class="sxs-lookup"><span data-stu-id="10fc7-291">Under the TextBox control, add a new Button control.</span></span> <span data-ttu-id="10fc7-292">Modifier la propriété ID du bouton btnUpdate et la propriété de texte à **nom de produit de mise à jour**.</span><span class="sxs-lookup"><span data-stu-id="10fc7-292">Change the ID property of the Button to btnUpdate and the Text property to **Update Product Name**.</span></span>
9. <span data-ttu-id="10fc7-293">Dans la vue de Source de Default.aspx, ajoutez une propriété UpdateCommand et deux UpdateParameters nouveau comme suit à la balise SqlDataSource :</span><span class="sxs-lookup"><span data-stu-id="10fc7-293">In Source view of Default.aspx, add an UpdateCommand property and two new UpdateParameters to the SqlDataSource tag as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample9.aspx)]

    > [!NOTE]
    > <span data-ttu-id="10fc7-294">Notez qu’il existe que deux paramètres (ProductName et ProductID) ajoutés dans ce code de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="10fc7-294">Note that there are two update parameters (ProductName and ProductID) added in this code.</span></span> <span data-ttu-id="10fc7-295">Ces paramètres sont mappés à la propriété de texte de la zone de texte txtProductName et la propriété SelectedValue de la ddlProducts DropDownList.</span><span class="sxs-lookup"><span data-stu-id="10fc7-295">These parameters are mapped to the Text property of the txtProductName TextBox and the SelectedValue property of the ddlProducts DropDownList.</span></span>
10. <span data-ttu-id="10fc7-296">Basculez en mode Design et double-cliquez sur le contrôle bouton pour ajouter un gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="10fc7-296">Switch to Design view and double-click on the Button control to add an event handler.</span></span>
11. <span data-ttu-id="10fc7-297">Ajoutez le code suivant à la btnUpdate\_cliquez sur le code :</span><span class="sxs-lookup"><span data-stu-id="10fc7-297">Add the following code to the btnUpdate\_Click code:</span></span> 

    [!code-csharp[Main](data-source-controls/samples/sample10.cs)]
12. <span data-ttu-id="10fc7-298">Avec le bouton droit sur Default.aspx, puis choisissez et les afficher dans le navigateur.</span><span class="sxs-lookup"><span data-stu-id="10fc7-298">Right-click on Default.aspx and choose to view it in the browser.</span></span> <span data-ttu-id="10fc7-299">Lorsque vous êtes invité à enregistrer toutes les modifications, cliquez sur Oui.</span><span class="sxs-lookup"><span data-stu-id="10fc7-299">Click Yes when prompted to save all changes.</span></span>
13. <span data-ttu-id="10fc7-300">ASP.NET 2.0 les classes partielles permettent de compilation lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="10fc7-300">ASP.NET 2.0 partial classes allow for compilation at runtime.</span></span> <span data-ttu-id="10fc7-301">Il n’est pas nécessaire générer une application afin de voir les modifications de code prendre effet.</span><span class="sxs-lookup"><span data-stu-id="10fc7-301">It is not necessary to build an application in order to see code changes take effect.</span></span>
14. <span data-ttu-id="10fc7-302">Sélectionnez un produit dans la liste DropDownList.</span><span class="sxs-lookup"><span data-stu-id="10fc7-302">Select a product from the DropDownList.</span></span>
15. <span data-ttu-id="10fc7-303">Entrez un nouveau nom pour le produit sélectionné dans la zone de texte, puis sur le bouton de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="10fc7-303">Enter a new name for the selected product in the TextBox and then click the Update button.</span></span>
16. <span data-ttu-id="10fc7-304">Le nom du produit est mis à jour dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="10fc7-304">The product name is updated in the database.</span></span>

## <a name="exercise-3-using-the-objectdatasource-control"></a><span data-ttu-id="10fc7-305">Exercice 3 en utilisant le contrôle ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="10fc7-305">Exercise 3 Using the ObjectDataSource Control</span></span>

<span data-ttu-id="10fc7-306">Cet exercice vous montrer comment utiliser le contrôle ObjectDataSource et un objet source pour interagir avec la base de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="10fc7-306">This exercise will demonstrate how to use the ObjectDataSource control and a source object to interact with the Northwind database.</span></span>

1. <span data-ttu-id="10fc7-307">Avec le bouton droit sur le projet dans l’Explorateur de solutions, puis cliquez sur Ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="10fc7-307">Right-click on the project in Solution Explorer and click on Add New Item.</span></span>
2. <span data-ttu-id="10fc7-308">Sélectionnez le formulaire Web dans la liste des modèles.</span><span class="sxs-lookup"><span data-stu-id="10fc7-308">Select Web Form in the templates list.</span></span> <span data-ttu-id="10fc7-309">Remplacez le nom object.aspx et cliquez sur Ajouter.</span><span class="sxs-lookup"><span data-stu-id="10fc7-309">Change the name to object.aspx and click Add.</span></span>
3. <span data-ttu-id="10fc7-310">Avec le bouton droit sur le projet dans l’Explorateur de solutions, puis cliquez sur Ajouter un nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="10fc7-310">Right-click on the project in Solution Explorer and click on Add New Item.</span></span>
4. <span data-ttu-id="10fc7-311">Sélectionnez la classe dans la liste des modèles.</span><span class="sxs-lookup"><span data-stu-id="10fc7-311">Select Class in the templates list.</span></span> <span data-ttu-id="10fc7-312">Remplacez le nom de la classe NorthwindData.cs et cliquez sur Ajouter.</span><span class="sxs-lookup"><span data-stu-id="10fc7-312">Change the name of the class to NorthwindData.cs and click Add.</span></span>
5. <span data-ttu-id="10fc7-313">Cliquez sur Oui lorsque vous êtes invité à ajouter la classe à l’application\_dossier de Code.</span><span class="sxs-lookup"><span data-stu-id="10fc7-313">Click Yes when prompted to add the class to the App\_Code folder.</span></span>
6. <span data-ttu-id="10fc7-314">Ajoutez le code suivant au fichier NorthwindData.cs :</span><span class="sxs-lookup"><span data-stu-id="10fc7-314">Add the following code to the NorthwindData.cs file:</span></span> 

    [!code-csharp[Main](data-source-controls/samples/sample11.cs)]
7. <span data-ttu-id="10fc7-315">Ajoutez le code suivant à la vue de Source de object.aspx :</span><span class="sxs-lookup"><span data-stu-id="10fc7-315">Add the following code to the Source view of object.aspx:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample12.aspx)]
8. <span data-ttu-id="10fc7-316">Enregistrez tous les fichiers et parcourir object.aspx.</span><span class="sxs-lookup"><span data-stu-id="10fc7-316">Save all files and browse object.aspx.</span></span>
9. <span data-ttu-id="10fc7-317">Interagir avec l’interface en affichant les détails, modification des employés, l’ajout des employés et suppression des employés.</span><span class="sxs-lookup"><span data-stu-id="10fc7-317">Interact with the interface by viewing details, editing employees, adding employees, and deleting employees.</span></span>
