---
uid: signalr/overview/performance/scaleout-in-signalr
title: Introduction à la montée en puissance parallèle dans SignalR | Microsoft Docs
author: bradygaster
description: Versions des logiciels utilisés dans cette rubrique Visual Studio 2013, .NET 4.5 SignalR les versions précédentes de la version 2 de cette rubrique pour plus d’informations sur les versions antérieures de...
ms.author: bradyg
ms.date: 06/10/2014
ms.assetid: 7e781fc1-1c1f-45a8-bc1d-338e96dbe9c9
msc.legacyurl: /signalr/overview/performance/scaleout-in-signalr
msc.type: authoredcontent
ms.openlocfilehash: 60ae0353745284796eb7e0ddb6397ecb48eceaf0
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57036366"
---
<a name="introduction-to-scaleout-in-signalr"></a><span data-ttu-id="6c420-103">Introduction au scale-out dans SignalR</span><span class="sxs-lookup"><span data-stu-id="6c420-103">Introduction to Scaleout in SignalR</span></span>
====================
<span data-ttu-id="6c420-104">par [Mike Wasson](https://github.com/MikeWasson), [Patrick Fletcher](https://github.com/pfletcher)</span><span class="sxs-lookup"><span data-stu-id="6c420-104">by [Mike Wasson](https://github.com/MikeWasson), [Patrick Fletcher](https://github.com/pfletcher)</span></span>

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> ## <a name="software-versions-used-in-this-topic"></a><span data-ttu-id="6c420-105">Versions des logiciels utilisées dans cette rubrique</span><span class="sxs-lookup"><span data-stu-id="6c420-105">Software versions used in this topic</span></span>
>
>
> - [<span data-ttu-id="6c420-106">Visual Studio 2013</span><span class="sxs-lookup"><span data-stu-id="6c420-106">Visual Studio 2013</span></span>](https://my.visualstudio.com/Downloads?q=visual%20studio%202013)
> - <span data-ttu-id="6c420-107">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="6c420-107">.NET 4.5</span></span>
> - <span data-ttu-id="6c420-108">SignalR version 2</span><span class="sxs-lookup"><span data-stu-id="6c420-108">SignalR version 2</span></span>
>
>
>
> ## <a name="previous-versions-of-this-topic"></a><span data-ttu-id="6c420-109">Versions précédentes de cette rubrique</span><span class="sxs-lookup"><span data-stu-id="6c420-109">Previous versions of this topic</span></span>
>
> <span data-ttu-id="6c420-110">Pour plus d’informations sur les versions antérieures de SignalR, consultez [les Versions antérieures de SignalR](../older-versions/index.md).</span><span class="sxs-lookup"><span data-stu-id="6c420-110">For information about earlier versions of SignalR, see [SignalR Older Versions](../older-versions/index.md).</span></span>
>
> ## <a name="questions-and-comments"></a><span data-ttu-id="6c420-111">Questions et commentaires</span><span class="sxs-lookup"><span data-stu-id="6c420-111">Questions and comments</span></span>
>
> <span data-ttu-id="6c420-112">Veuillez laisser des commentaires sur la façon dont vous avez apprécié ce didacticiel et ce que nous pouvions améliorer dans les commentaires en bas de la page.</span><span class="sxs-lookup"><span data-stu-id="6c420-112">Please leave feedback on how you liked this tutorial and what we could improve in the comments at the bottom of the page.</span></span> <span data-ttu-id="6c420-113">Si vous avez des questions qui ne sont pas directement liées à ce didacticiel, vous pouvez les publier à le [ASP.NET SignalR forum](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) ou [StackOverflow.com](http://stackoverflow.com/).</span><span class="sxs-lookup"><span data-stu-id="6c420-113">If you have questions that are not directly related to the tutorial, you can post them to the [ASP.NET SignalR forum](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) or [StackOverflow.com](http://stackoverflow.com/).</span></span>


<span data-ttu-id="6c420-114">En règle générale, il existe deux façons de mettre à l’échelle une application web : *monter en puissance* et *monter en charge*.</span><span class="sxs-lookup"><span data-stu-id="6c420-114">In general, there are two ways to scale a web application: *scale up* and *scale out*.</span></span>

- <span data-ttu-id="6c420-115">Monter en puissance implique l’utilisation d’un plus grand serveur (ou une plus grande machine virtuelle) avec plus de RAM, UC, etc.</span><span class="sxs-lookup"><span data-stu-id="6c420-115">Scale up means using a larger server (or a larger VM) with more RAM, CPUs, etc.</span></span>
- <span data-ttu-id="6c420-116">Monter en charge signifie ajouter davantage de serveurs pour gérer la charge.</span><span class="sxs-lookup"><span data-stu-id="6c420-116">Scale out means adding more servers to handle the load.</span></span>

<span data-ttu-id="6c420-117">Le problème de montée en puissance est vite appuyé sur une limite de la taille de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6c420-117">The problem with scaling up is that you quickly hit a limit on the size of the machine.</span></span> <span data-ttu-id="6c420-118">En outre, vous devez monter en charge. Toutefois, lorsque vous faites évoluer, les clients peuvent obtenir acheminés vers différents serveurs.</span><span class="sxs-lookup"><span data-stu-id="6c420-118">Beyond that, you need to scale out. However, when you scale out, clients can get routed to different servers.</span></span> <span data-ttu-id="6c420-119">Un client qui est connecté à un seul serveur ne recevra pas les messages envoyés à partir d’un autre serveur.</span><span class="sxs-lookup"><span data-stu-id="6c420-119">A client that is connected to one server will not receive messages sent from another server.</span></span>

![](scaleout-in-signalr/_static/image1.png)

<span data-ttu-id="6c420-120">Une solution consiste à transférer les messages entre les serveurs, à l’aide d’un composant appelé un *fond de panier*.</span><span class="sxs-lookup"><span data-stu-id="6c420-120">One solution is to forward messages between servers, using a component called a *backplane*.</span></span> <span data-ttu-id="6c420-121">Avec un fond de panier est activée, chaque instance d’application envoie des messages au fond de panier, et le fond de panier les transfère vers les autres instances de l’application.</span><span class="sxs-lookup"><span data-stu-id="6c420-121">With a backplane enabled, each application instance sends messages to the backplane, and the backplane forwards them to the other application instances.</span></span> <span data-ttu-id="6c420-122">(En électronique, un fond de panier est un groupe de connecteurs parallèles.</span><span class="sxs-lookup"><span data-stu-id="6c420-122">(In electronics, a backplane is a group of parallel connectors.</span></span> <span data-ttu-id="6c420-123">Par analogie, un fond de panier SignalR connecte plusieurs serveurs.)</span><span class="sxs-lookup"><span data-stu-id="6c420-123">By analogy, a SignalR backplane connects multiple servers.)</span></span>

![](scaleout-in-signalr/_static/image2.png)

<span data-ttu-id="6c420-124">SignalR fournit actuellement trois fonds de panier :</span><span class="sxs-lookup"><span data-stu-id="6c420-124">SignalR currently provides three backplanes:</span></span>

- <span data-ttu-id="6c420-125">**Azure Service Bus**.</span><span class="sxs-lookup"><span data-stu-id="6c420-125">**Azure Service Bus**.</span></span> <span data-ttu-id="6c420-126">Service Bus est une infrastructure de messagerie qui permet aux composants envoyer des messages d’une manière faiblement couplée.</span><span class="sxs-lookup"><span data-stu-id="6c420-126">Service Bus is a messaging infrastructure that allows components to send messages in a loosely coupled way.</span></span>
- <span data-ttu-id="6c420-127">**Redis**.</span><span class="sxs-lookup"><span data-stu-id="6c420-127">**Redis**.</span></span> <span data-ttu-id="6c420-128">Redis est un magasin de clé-valeur en mémoire.</span><span class="sxs-lookup"><span data-stu-id="6c420-128">Redis is an in-memory key-value store.</span></span> <span data-ttu-id="6c420-129">Redis prend en charge un modèle de publication/abonnement (« pub/sub ») pour envoyer des messages.</span><span class="sxs-lookup"><span data-stu-id="6c420-129">Redis supports a publish/subscribe ("pub/sub") pattern for sending messages.</span></span>
- <span data-ttu-id="6c420-130">**SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="6c420-130">**SQL Server**.</span></span> <span data-ttu-id="6c420-131">Le fond de panier de SQL Server écrit les messages dans les tables SQL.</span><span class="sxs-lookup"><span data-stu-id="6c420-131">The SQL Server backplane writes messages to SQL tables.</span></span> <span data-ttu-id="6c420-132">Le fond de panier utilise Service Broker de messagerie efficace.</span><span class="sxs-lookup"><span data-stu-id="6c420-132">The backplane uses Service Broker for efficient messaging.</span></span> <span data-ttu-id="6c420-133">Toutefois, elle fonctionne également si Service Broker n’est pas activé.</span><span class="sxs-lookup"><span data-stu-id="6c420-133">However, it also works if Service Broker is not enabled.</span></span>

<span data-ttu-id="6c420-134">Si vous déployez votre application sur Azure, envisagez d’utiliser le fond de panier de Redis à l’aide [Cache Redis Azure](https://azure.microsoft.com/services/cache/).</span><span class="sxs-lookup"><span data-stu-id="6c420-134">If you deploy your application on Azure, consider using the Redis backplane using [Azure Redis Cache](https://azure.microsoft.com/services/cache/).</span></span> <span data-ttu-id="6c420-135">Si vous déployez sur votre propre batterie de serveurs, envisagez de SQL Server ou des fonds de panier de Redis.</span><span class="sxs-lookup"><span data-stu-id="6c420-135">If you are deploying to your own server farm, consider the SQL Server or Redis backplanes.</span></span>

<span data-ttu-id="6c420-136">Les rubriques suivantes contiennent des didacticiels pas à pas pour chaque fond de panier :</span><span class="sxs-lookup"><span data-stu-id="6c420-136">The following topics contain step-by-step tutorials for each backplane:</span></span>

- [<span data-ttu-id="6c420-137">Montée en puissance parallèle de SignalR avec Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="6c420-137">SignalR Scaleout with Azure Service Bus</span></span>](scaleout-with-windows-azure-service-bus.md)
- [<span data-ttu-id="6c420-138">Montée en puissance parallèle de SignalR avec Redis</span><span class="sxs-lookup"><span data-stu-id="6c420-138">SignalR Scaleout with Redis</span></span>](scaleout-with-redis.md)
- [<span data-ttu-id="6c420-139">Montée en puissance parallèle de SignalR avec SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c420-139">SignalR Scaleout with SQL Server</span></span>](scaleout-with-sql-server.md)

## <a name="implementation"></a><span data-ttu-id="6c420-140">Implémentation</span><span class="sxs-lookup"><span data-stu-id="6c420-140">Implementation</span></span>

<span data-ttu-id="6c420-141">Dans SignalR, chaque message est envoyé via un bus de messages.</span><span class="sxs-lookup"><span data-stu-id="6c420-141">In SignalR, every message is sent through a message bus.</span></span> <span data-ttu-id="6c420-142">Un bus de messages implémente le [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) interface, qui fournit une abstraction de publication/abonnement.</span><span class="sxs-lookup"><span data-stu-id="6c420-142">A message bus implements the [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) interface, which provides a publish/subscribe abstraction.</span></span> <span data-ttu-id="6c420-143">Les fonds de panier fonctionnent en remplaçant la valeur par défaut **IMessageBus** avec un bus conçu ce fond de panier.</span><span class="sxs-lookup"><span data-stu-id="6c420-143">The backplanes work by replacing the default **IMessageBus** with a bus designed for that backplane.</span></span> <span data-ttu-id="6c420-144">Par exemple, le bus de messages pour Redis est [RedisMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.redis.redismessagebus(v=vs.100).aspx), et il utilise le cache Redis [pub/sub](http://redis.io/topics/pubsub) mécanisme pour envoyer et recevoir des messages.</span><span class="sxs-lookup"><span data-stu-id="6c420-144">For example, the message bus for Redis is [RedisMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.redis.redismessagebus(v=vs.100).aspx), and it uses the Redis [pub/sub](http://redis.io/topics/pubsub) mechanism to send and receive messages.</span></span>

<span data-ttu-id="6c420-145">Chaque instance de serveur se connecte à l’infrastructure d’intégration via le bus.</span><span class="sxs-lookup"><span data-stu-id="6c420-145">Each server instance connects to the backplane through the bus.</span></span> <span data-ttu-id="6c420-146">Lorsqu’un message est envoyé, il est placé dans le fond de panier, et le fond de panier envoie à chaque serveur.</span><span class="sxs-lookup"><span data-stu-id="6c420-146">When a message is sent, it goes to the backplane, and the backplane sends it to every server.</span></span> <span data-ttu-id="6c420-147">Lorsqu’un serveur reçoit un message du fond de panier, il place le message dans sa mémoire cache locale.</span><span class="sxs-lookup"><span data-stu-id="6c420-147">When a server gets a message from the backplane, it puts the message in its local cache.</span></span> <span data-ttu-id="6c420-148">Le serveur remet ensuite les messages aux clients à partir de sa mémoire cache locale.</span><span class="sxs-lookup"><span data-stu-id="6c420-148">The server then delivers messages to clients from its local cache.</span></span>

<span data-ttu-id="6c420-149">Pour chaque connexion client, progression du client dans la lecture du flux de message est suivie à l’aide d’un curseur.</span><span class="sxs-lookup"><span data-stu-id="6c420-149">For each client connection, the client's progress in reading the message stream is tracked using a cursor.</span></span> <span data-ttu-id="6c420-150">(Un curseur représente une position dans le flux de message.) Si un client se déconnecte, puis se reconnecte, il demande le bus de messages reçus après la valeur du curseur du client.</span><span class="sxs-lookup"><span data-stu-id="6c420-150">(A cursor represents a position in the message stream.) If a client disconnects and then reconnects, it asks the bus for any messages that arrived after the client's cursor value.</span></span> <span data-ttu-id="6c420-151">La même chose se produit lorsqu’une connexion utilise [interrogation longue](../getting-started/introduction-to-signalr.md#transports).</span><span class="sxs-lookup"><span data-stu-id="6c420-151">The same thing happens when a connection uses [long polling](../getting-started/introduction-to-signalr.md#transports).</span></span> <span data-ttu-id="6c420-152">Après l’achèvement d’une requête d’interrogation longue, le client ouvre une nouvelle connexion et vous demande des messages reçus après le curseur.</span><span class="sxs-lookup"><span data-stu-id="6c420-152">After a long poll request completes, the client opens a new connection and asks for messages that arrived after the cursor.</span></span>

<span data-ttu-id="6c420-153">Le fonctionnement du mécanisme curseur même si un client est acheminé vers un autre serveur sur se reconnecter.</span><span class="sxs-lookup"><span data-stu-id="6c420-153">The cursor mechanism works even if a client is routed to a different server on reconnect.</span></span> <span data-ttu-id="6c420-154">Le fond de panier tient compte de tous les serveurs, et peu importe le serveur auquel le client se connecte.</span><span class="sxs-lookup"><span data-stu-id="6c420-154">The backplane is aware of all the servers, and it doesn't matter which server a client connects to.</span></span>

## <a name="limitations"></a><span data-ttu-id="6c420-155">Limitations</span><span class="sxs-lookup"><span data-stu-id="6c420-155">Limitations</span></span>

<span data-ttu-id="6c420-156">À l’aide d’un fond de panier, le débit de message maximale est inférieur à ce que c’est lorsque les clients communiquent directement avec un seul nœud serveur.</span><span class="sxs-lookup"><span data-stu-id="6c420-156">Using a backplane, the maximum message throughput is lower than it is when clients talk directly to a single server node.</span></span> <span data-ttu-id="6c420-157">C’est parce que le fond de panier transfère tous les messages à tous les nœuds, donc le fond de panier peut devenir un goulot d’étranglement.</span><span class="sxs-lookup"><span data-stu-id="6c420-157">That's because the backplane forwards every message to every node, so the backplane can become a bottleneck.</span></span> <span data-ttu-id="6c420-158">Si cette limitation est un problème dépend de l’application.</span><span class="sxs-lookup"><span data-stu-id="6c420-158">Whether this limitation is a problem depends on the application.</span></span> <span data-ttu-id="6c420-159">Par exemple, voici quelques scénarios classiques de SignalR :</span><span class="sxs-lookup"><span data-stu-id="6c420-159">For example, here are some typical SignalR scenarios:</span></span>

- <span data-ttu-id="6c420-160">[Diffusion de serveur](../getting-started/tutorial-server-broadcast-with-signalr.md) (par exemple, les cotations boursières) : Fonds de panier fonctionnent bien pour ce scénario, étant donné que le serveur contrôle la fréquence à laquelle les messages sont envoyés.</span><span class="sxs-lookup"><span data-stu-id="6c420-160">[Server broadcast](../getting-started/tutorial-server-broadcast-with-signalr.md) (e.g., stock ticker): Backplanes work well for this scenario, because the server controls the rate at which messages are sent.</span></span>
- <span data-ttu-id="6c420-161">[Client à](../getting-started/tutorial-getting-started-with-signalr.md) (par exemple, chat) : Dans ce scénario, le fond de panier peut être un goulot d’étranglement si le nombre de messages évolue avec le nombre de clients ; Autrement dit, si le taux de messages augmente proportionnellement à sa plus de clients joindre.</span><span class="sxs-lookup"><span data-stu-id="6c420-161">[Client-to-client](../getting-started/tutorial-getting-started-with-signalr.md) (e.g., chat): In this scenario, the backplane might be a bottleneck if the number of messages scales with the number of clients; that is, if the rate of messages grows proportionally as more clients join.</span></span>
- <span data-ttu-id="6c420-162">[En temps réel haute fréquence](../getting-started/tutorial-high-frequency-realtime-with-signalr.md) (par exemple, des jeux en temps réel) : Fond de panier n’est pas recommandée pour ce scénario.</span><span class="sxs-lookup"><span data-stu-id="6c420-162">[High-frequency realtime](../getting-started/tutorial-high-frequency-realtime-with-signalr.md) (e.g., real-time games): A backplane is not recommended for this scenario.</span></span>

## <a name="enabling-tracing-for-signalr-scaleout"></a><span data-ttu-id="6c420-163">Activation du suivi pour la montée en puissance parallèle de SignalR</span><span class="sxs-lookup"><span data-stu-id="6c420-163">Enabling Tracing For SignalR Scaleout</span></span>

<span data-ttu-id="6c420-164">Pour activer le suivi pour les fonds de panier, ajoutez les sections suivantes au fichier web.config, sous la racine **configuration** élément :</span><span class="sxs-lookup"><span data-stu-id="6c420-164">To enable tracing for the backplanes, add the following sections to the web.config file, under the root **configuration** element:</span></span>

[!code-html[Main](scaleout-in-signalr/samples/sample1.html)]
