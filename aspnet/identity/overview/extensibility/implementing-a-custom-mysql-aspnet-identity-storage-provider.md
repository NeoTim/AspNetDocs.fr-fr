---
uid: identity/overview/extensibility/implementing-a-custom-mysql-aspnet-identity-storage-provider
title: Implémentation d’un fournisseur de stockage ASP.NET Identity MySQL personnalisé - ASP.NET 4.x
author: raquelsa
description: ASP.NET Identity est un système extensible qui vous permet de créer votre propre fournisseur de stockage et le connecter à votre application sans utiliser de nouveau l’appli...
ms.author: riande
ms.date: 05/22/2015
ms.assetid: 248f5fe7-39ba-40ea-ab1e-71a69b0bd649
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/extensibility/implementing-a-custom-mysql-aspnet-identity-storage-provider
msc.type: authoredcontent
ms.openlocfilehash: 227a48d76f099f948d89f38219e25ced026d7dcd
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65118104"
---
# <a name="implementing-a-custom-mysql-aspnet-identity-storage-provider"></a><span data-ttu-id="d8599-103">Implémentation d’un fournisseur de stockage ASP.NET Identity MySQL personnalisé</span><span class="sxs-lookup"><span data-stu-id="d8599-103">Implementing a Custom MySQL ASP.NET Identity Storage Provider</span></span>

<span data-ttu-id="d8599-104">par [Raquel Soares De Almeida](https://github.com/raquelsa), [Suhas Joshi](https://github.com/suhasj), [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="d8599-104">by [Raquel Soares De Almeida](https://github.com/raquelsa), [Suhas Joshi](https://github.com/suhasj), [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="d8599-105">ASP.NET Identity est un système extensible qui vous permet de créer votre propre fournisseur de stockage et le connecter à votre application sans utiliser de nouveau l’application.</span><span class="sxs-lookup"><span data-stu-id="d8599-105">ASP.NET Identity is an extensible system which enables you to create your own storage provider and plug it into your application without re-working the application.</span></span> <span data-ttu-id="d8599-106">Cette rubrique décrit comment créer un fournisseur de stockage MySQL pour ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="d8599-106">This topic describes how to create a MySQL storage provider for ASP.NET Identity.</span></span> <span data-ttu-id="d8599-107">Pour une vue d’ensemble de la création de fournisseurs de stockage personnalisés, consultez [vue d’ensemble de stockage fournisseurs personnalisés pour ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="d8599-107">For an overview of creating custom storage providers, see [Overview of Custom Storage Providers for ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span></span>
> 
> <span data-ttu-id="d8599-108">Pour suivre ce didacticiel, vous devez disposer de Visual Studio 2013 avec Update 2.</span><span class="sxs-lookup"><span data-stu-id="d8599-108">To complete this tutorial, you must have Visual Studio 2013 with Update 2.</span></span>
> 
> <span data-ttu-id="d8599-109">Ce didacticiel va :</span><span class="sxs-lookup"><span data-stu-id="d8599-109">This tutorial will:</span></span>
> 
> - <span data-ttu-id="d8599-110">Montrer comment créer une instance de base de données MySQL sur Azure.</span><span class="sxs-lookup"><span data-stu-id="d8599-110">Show how to create a MySQL database instance on Azure.</span></span>
> - <span data-ttu-id="d8599-111">Montrer comment utiliser un outil client de MySQL (MySQL Workbench) pour créer des tables et gérer votre base de données à distance sur Azure.</span><span class="sxs-lookup"><span data-stu-id="d8599-111">Show how to use a MySQL client tool (MySQL Workbench) to create tables and manage your remote database on Azure.</span></span>
> - <span data-ttu-id="d8599-112">Montrer comment remplacer l’implémentation de stockage d’identité ASP.NET par défaut par notre implémentation personnalisée sur un projet d’application MVC.</span><span class="sxs-lookup"><span data-stu-id="d8599-112">Show how to replace the default ASP.NET Identity storage implementation with our custom implementation on a MVC application project.</span></span>
> 
> <span data-ttu-id="d8599-113">Ce didacticiel a été initialement écrit par Raquel Soares De Almeida et Rick Anderson ( [ @RickAndMSFT ](https://twitter.com/#!/RickAndMSFT) ).</span><span class="sxs-lookup"><span data-stu-id="d8599-113">This tutorial was originally written by Raquel Soares De Almeida and Rick Anderson ( [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ).</span></span> <span data-ttu-id="d8599-114">L’exemple de projet a été mis à jour pour l’identité 2.0 par Suhas Joshi.</span><span class="sxs-lookup"><span data-stu-id="d8599-114">The sample project was updated for Identity 2.0 by Suhas Joshi.</span></span> <span data-ttu-id="d8599-115">La rubrique a été mis à jour pour l’identité 2.0 par Tom FitzMacken.</span><span class="sxs-lookup"><span data-stu-id="d8599-115">The topic was updated for Identity 2.0 by Tom FitzMacken.</span></span>

## <a name="download-completed-project"></a><span data-ttu-id="d8599-116">Projet de téléchargement terminé</span><span class="sxs-lookup"><span data-stu-id="d8599-116">Download completed project</span></span>

<span data-ttu-id="d8599-117">À la fin de ce didacticiel, vous disposerez un projet d’application MVC avec ASP.NET Identity fonctionne avec une base de données MySQL hébergée sur Azure.</span><span class="sxs-lookup"><span data-stu-id="d8599-117">At the end of this tutorial, you will have an MVC application project with ASP.NET Identity working with a MySQL database hosted on Azure.</span></span>

<span data-ttu-id="d8599-118">Vous pouvez télécharger le fournisseur de stockage MySQL terminé à [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span><span class="sxs-lookup"><span data-stu-id="d8599-118">You can download the completed MySQL storage provider at [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span></span>

## <a name="the-steps-you-will-perform"></a><span data-ttu-id="d8599-119">Les étapes que vous allez effectuer</span><span class="sxs-lookup"><span data-stu-id="d8599-119">The steps you will perform</span></span>

<span data-ttu-id="d8599-120">Dans ce didacticiel, vous allez :</span><span class="sxs-lookup"><span data-stu-id="d8599-120">In this tutorial you will:</span></span>

1. <span data-ttu-id="d8599-121">Créer une base de données MySQL sur Azure</span><span class="sxs-lookup"><span data-stu-id="d8599-121">Create a MySQL database on Azure</span></span>
2. <span data-ttu-id="d8599-122">Créer des tables de l’identité ASP.NET dans MySQL</span><span class="sxs-lookup"><span data-stu-id="d8599-122">Create the ASP.NET Identity tables in MySQL</span></span>
3. <span data-ttu-id="d8599-123">Créer une application MVC et configurez-le pour utiliser le fournisseur MySQL</span><span class="sxs-lookup"><span data-stu-id="d8599-123">Create an MVC application and configure it to use the MySQL provider</span></span>
4. <span data-ttu-id="d8599-124">Exécuter l'application</span><span class="sxs-lookup"><span data-stu-id="d8599-124">Run the app</span></span>

<span data-ttu-id="d8599-125">Cette rubrique ne couvre pas l’architecture d’identité ASP.NET et les décisions à prendre lors de l’implémentation d’un fournisseur de stockage client.</span><span class="sxs-lookup"><span data-stu-id="d8599-125">This topic does not cover the architecture of ASP.NET Identity and the decisions you must make when implementing a customer storage provider.</span></span> <span data-ttu-id="d8599-126">Pour plus d’informations, consultez [vue d’ensemble de fournisseurs de stockage personnalisés pour ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="d8599-126">For that information, see [Overview of Custom Storage Providers for ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span></span>

## <a name="review-mysql-storage-provider-classes"></a><span data-ttu-id="d8599-127">Passez en revue les classes de fournisseur de stockage MySQL</span><span class="sxs-lookup"><span data-stu-id="d8599-127">Review MySQL storage provider classes</span></span>

<span data-ttu-id="d8599-128">Avant d’aborder les étapes pour créer le fournisseur de stockage MySQL, passons en revue les classes qui composent le fournisseur de stockage.</span><span class="sxs-lookup"><span data-stu-id="d8599-128">Before jumping into the steps to create the MySQL storage provider, let's look at the classes that make up the storage provider.</span></span> <span data-ttu-id="d8599-129">Vous devez les classes qui gèrent les opérations de base de données et des classes qui sont appelées à partir de l’application pour gérer les utilisateurs et rôles.</span><span class="sxs-lookup"><span data-stu-id="d8599-129">You will need classes that manage the database operations and classes that are called from the application to manage users and roles.</span></span>

### <a name="storage-classes"></a><span data-ttu-id="d8599-130">Classes de stockage</span><span class="sxs-lookup"><span data-stu-id="d8599-130">Storage classes</span></span>

- <span data-ttu-id="d8599-131">[IdentityUser](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityUser.cs) -contient les propriétés de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8599-131">[IdentityUser](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityUser.cs) - contains properties for the user.</span></span>
- <span data-ttu-id="d8599-132">[UserStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserStore.cs) -contient des opérations d’ajout, de la mise à jour ou de récupération des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="d8599-132">[UserStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserStore.cs) - contains operations for adding, updating or retrieving users.</span></span>
- <span data-ttu-id="d8599-133">[IdentityRole](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityRole.cs) -contient les propriétés des rôles.</span><span class="sxs-lookup"><span data-stu-id="d8599-133">[IdentityRole](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityRole.cs) - contains properties for roles.</span></span>
- <span data-ttu-id="d8599-134">[RoleStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleStore.cs) -contient des opérations pour l’ajout, la suppression, la mise à jour et récupération des rôles.</span><span class="sxs-lookup"><span data-stu-id="d8599-134">[RoleStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleStore.cs) - contains operations for adding, deleting, updating and retrieving roles.</span></span>

### <a name="data-access-layer-classes"></a><span data-ttu-id="d8599-135">Classes de couche d’accès aux données</span><span class="sxs-lookup"><span data-stu-id="d8599-135">Data access layer classes</span></span>

<span data-ttu-id="d8599-136">Pour cet exemple, les classes de couche d’accès aux données contiennent des instructions SQL pour travailler avec les tables ; Toutefois, dans votre code, vous souhaiterez utiliser mappage objet-relationnel (ORM) tel que Entity Framework ou NHibernate.</span><span class="sxs-lookup"><span data-stu-id="d8599-136">For this example, the data access layer classes contain SQL statements for working with the tables; however, in your code you might want to use object-relational mapping (ORM) such as Entity Framework or NHibernate.</span></span> <span data-ttu-id="d8599-137">En particulier, votre application peut rencontrer des performances médiocres sans un ORM qui inclut le chargement différé et la mise en cache de l’objet.</span><span class="sxs-lookup"><span data-stu-id="d8599-137">In particular, your application may experience poor performance without an ORM that includes lazy loading and object caching.</span></span> <span data-ttu-id="d8599-138">Pour plus d’informations, consultez [ASP.NET Identity 2.0 sans Entity Framework ?](https://aspnetidentity.codeplex.com/discussions/561828)</span><span class="sxs-lookup"><span data-stu-id="d8599-138">For more information, see [ASP.NET Identity 2.0 without Entity Framework?](https://aspnetidentity.codeplex.com/discussions/561828)</span></span>

- <span data-ttu-id="d8599-139">[MySQLDatabase](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) -contient la connexion de base de données MySQL et des méthodes pour effectuer des opérations de base de données.</span><span class="sxs-lookup"><span data-stu-id="d8599-139">[MySQLDatabase](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) - contains the MySQL database connection and methods for performing database operations.</span></span> <span data-ttu-id="d8599-140">UserStore et RoleStore sont instanciés avec une instance de cette classe.</span><span class="sxs-lookup"><span data-stu-id="d8599-140">UserStore and RoleStore are both instantiated with an instance of this class.</span></span>
- <span data-ttu-id="d8599-141">[RoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleTable.cs) -contient des opérations de base de données pour la table qui stocke les rôles.</span><span class="sxs-lookup"><span data-stu-id="d8599-141">[RoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleTable.cs) - contains database operations for the table that stores roles.</span></span>
- <span data-ttu-id="d8599-142">[UserClaimsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) -contient des opérations de base de données pour la table qui stocke des revendications d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8599-142">[UserClaimsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) - contains database operations for the table that stores user claims.</span></span>
- <span data-ttu-id="d8599-143">[UserLoginsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) -contient des opérations de base de données pour la table qui stocke les informations de connexion utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8599-143">[UserLoginsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) - contains database operations for the table that stores user login information.</span></span>
- <span data-ttu-id="d8599-144">[UserRoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) -contient des opérations de base de données pour la table qui stocke les utilisateurs sont affectés à des rôles.</span><span class="sxs-lookup"><span data-stu-id="d8599-144">[UserRoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) - contains database operations for the table that stores which users are assigned to which roles.</span></span>
- <span data-ttu-id="d8599-145">[UserTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserTable.cs) -contient des opérations de base de données pour la table qui stocke les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="d8599-145">[UserTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserTable.cs) - contains database operations for the table that stores users.</span></span>

## <a name="create-a-mysql-database-instance-on-azure"></a><span data-ttu-id="d8599-146">Créer une instance de base de données MySQL sur Azure</span><span class="sxs-lookup"><span data-stu-id="d8599-146">Create a MySQL database instance on Azure</span></span>

1. <span data-ttu-id="d8599-147">Connectez-vous au [portail Azure](https://manage.windowsazure.com/).</span><span class="sxs-lookup"><span data-stu-id="d8599-147">Log in to the [Azure Portal](https://manage.windowsazure.com/).</span></span>
2. <span data-ttu-id="d8599-148">Cliquez sur **+ nouveau** en bas de la page, puis sélectionnez **STORE**.</span><span class="sxs-lookup"><span data-stu-id="d8599-148">Click **+NEW** at the bottom of the page, and then select **STORE**.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image1.png)
3. <span data-ttu-id="d8599-149">Dans le **choisir et du module complémentaire** Assistant, sélectionnez **base de données MySQL ClearDB** , puis cliquez sur la flèche suivant en bas à droite de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="d8599-149">In the **Choose and Add-on** wizard, select **ClearDB MySQL Database** and click on the next arrow at the bottom right of the dialog.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image2.png)
4. <span data-ttu-id="d8599-150">Conservez la valeur par défaut **gratuit** planifier et de modifier le **nom** à **IdentityMySQLDatabase**.</span><span class="sxs-lookup"><span data-stu-id="d8599-150">Keep the default **Free** plan and change the **Name** to **IdentityMySQLDatabase**.</span></span> <span data-ttu-id="d8599-151">Sélectionnez la région plus proche de vous et puis cliquez sur la flèche suivant.</span><span class="sxs-lookup"><span data-stu-id="d8599-151">Select the region nearest you and then click the next arrow.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.png)
5. <span data-ttu-id="d8599-152">Cliquez sur la coche pour terminer la création de la base de données.</span><span class="sxs-lookup"><span data-stu-id="d8599-152">Click the checkmark to complete the database creation.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image4.png)
6. <span data-ttu-id="d8599-153">Une fois que votre base de données a été créé, vous pouvez le gérer à partir de la **modules complémentaires** onglet dans le portail de gestion.</span><span class="sxs-lookup"><span data-stu-id="d8599-153">After your database has been created, you can manage it from the **ADD-ONS** tab in the management portal.</span></span>   
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image5.png)
7. <span data-ttu-id="d8599-154">Vous pouvez obtenir les informations de connexion de base de données en cliquant sur **informations de connexion** en bas de la page.</span><span class="sxs-lookup"><span data-stu-id="d8599-154">You can get the database connection information by clicking on **CONNECTION INFO** at the bottom of the page.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image6.png)
8. <span data-ttu-id="d8599-155">Copier la chaîne de connexion en cliquant sur le bouton de copie et l’enregistrer afin de pouvoir utiliser ultérieurement dans votre application MVC.</span><span class="sxs-lookup"><span data-stu-id="d8599-155">Copy the connection string by clicking on the copy button and save it so you can use later in your MVC application.</span></span>   
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image7.png)

## <a name="create-the-aspnet-identity-tables-in-a-mysql-database"></a><span data-ttu-id="d8599-156">Créer des tables de l’identité ASP.NET dans une base de données MySQL</span><span class="sxs-lookup"><span data-stu-id="d8599-156">Create the ASP.NET Identity tables in a MySQL database</span></span>

### <a name="install-mysql-workbench-tool-to-connect-and-manage-mysql-database"></a><span data-ttu-id="d8599-157">Installer l’outil MySQL Workbench pour vous connecter et gérer la base de données MySQL</span><span class="sxs-lookup"><span data-stu-id="d8599-157">Install MySQL Workbench tool to connect and manage MySQL database</span></span>

1. <span data-ttu-id="d8599-158">Installer le **MySQL Workbench** outil à partir de la [page des téléchargements de MySQL](http://dev.mysql.com/downloads/windows/installer/)</span><span class="sxs-lookup"><span data-stu-id="d8599-158">Install the **MySQL Workbench** tool from the [MySQL downloads page](http://dev.mysql.com/downloads/windows/installer/)</span></span>
2. <span data-ttu-id="d8599-159">Lancez l’application et ajouter un clic sur le **MySQLConnections +** pour ajouter une nouvelle connexion.</span><span class="sxs-lookup"><span data-stu-id="d8599-159">Launch the app and add click on the **MySQLConnections +** button to add a new connection.</span></span> <span data-ttu-id="d8599-160">Utiliser les données de chaîne de connexion que vous avez copié à partir de la base de données Azure MySQL que vous avez créé précédemment dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="d8599-160">Use the connection string data you copied from the Azure MySQL database you created earlier in this tutorial.</span></span>
3. <span data-ttu-id="d8599-161">Après avoir établi la connexion, ouvrez une nouvelle **requête** onglet ; collez les commandes à partir de [MySQLIdentity.sql](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql) dans la requête et exécutez-le pour créer les tables de base de données.</span><span class="sxs-lookup"><span data-stu-id="d8599-161">After establishing the connection, open a new **Query** tab; paste the commands from [MySQLIdentity.sql](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql) into the query and execute it in order to create the database tables.</span></span>
4. <span data-ttu-id="d8599-162">Vous avez maintenant toutes les tables nécessaires ASP.NET Identity créés sur une base de données MySQL hébergée sur Azure, comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="d8599-162">You now have all the ASP.NET Identity necessary tables created on a MySQL database hosted on Azure as shown below.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image1.jpg)

## <a name="create-an-mvc-application-project-from-template-and-configure-it-to-use-mysql-provider"></a><span data-ttu-id="d8599-163">Créer un projet d’application MVC de modèle et configurez-le pour utiliser le fournisseur MySQL</span><span class="sxs-lookup"><span data-stu-id="d8599-163">Create an MVC application project from template and configure it to use MySQL provider</span></span>

<span data-ttu-id="d8599-164">Si nécessaire, installez [Visual Studio Express 2013 pour le Web](https://go.microsoft.com/fwlink/?LinkId=299058) ou [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566) avec Update 2.</span><span class="sxs-lookup"><span data-stu-id="d8599-164">If needed, install either [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566) with Update 2.</span></span>

### <a name="download-the-aspnetidentitymysql-project-from-codeplex"></a><span data-ttu-id="d8599-165">Télécharger le projet ASP.NET.Identity.MySQL à partir de CodePlex</span><span class="sxs-lookup"><span data-stu-id="d8599-165">Download the ASP.NET.Identity.MySQL project from CodePlex</span></span>

1. <span data-ttu-id="d8599-166">Accédez à l’URL de référentiel [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span><span class="sxs-lookup"><span data-stu-id="d8599-166">Browse to the repository URL at [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span></span>
2. <span data-ttu-id="d8599-167">Télécharger le code source.</span><span class="sxs-lookup"><span data-stu-id="d8599-167">Download the source code.</span></span>
3. <span data-ttu-id="d8599-168">Extrayez le fichier .zip dans un dossier local.</span><span class="sxs-lookup"><span data-stu-id="d8599-168">Extract the .zip file into a local folder.</span></span>
4. <span data-ttu-id="d8599-169">Ouvrez la solution AspNet.Identity.MySQL et générez-le.</span><span class="sxs-lookup"><span data-stu-id="d8599-169">Open the AspNet.Identity.MySQL solution and build it.</span></span>

### <a name="create-a-new-mvc-application-project-from-template"></a><span data-ttu-id="d8599-170">Créer un nouveau projet d’application MVC de modèle</span><span class="sxs-lookup"><span data-stu-id="d8599-170">Create a new MVC application project from template</span></span>

1. <span data-ttu-id="d8599-171">Bouton droit sur le **AspNet.Identity.MySQL** solution et **ajouter**, **nouveau projet**</span><span class="sxs-lookup"><span data-stu-id="d8599-171">Right click the **AspNet.Identity.MySQL** solution and **Add**, **New Project**</span></span>
2. <span data-ttu-id="d8599-172">Dans le **ajouter un nouveau projet** select de la boîte de dialogue **Visual C#** sur la gauche, puis **Web** , puis sélectionnez **Application Web ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="d8599-172">In the **Add New Project** Dialog select **Visual C#** on the left, then **Web** and then select **ASP.NET Web Application**.</span></span> <span data-ttu-id="d8599-173">Nommez votre projet **IdentityMySQLDemo**; puis cliquez sur OK.</span><span class="sxs-lookup"><span data-stu-id="d8599-173">Name your project **IdentityMySQLDemo**; and then click OK.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image2.jpg)
3. <span data-ttu-id="d8599-174">Dans le **nouveau projet ASP.NET** boîte de dialogue, sélectionnez le modèle MVC avec les options par défaut (qui inclut **comptes d’utilisateur individuels** comme méthode d’authentification) et cliquez sur **OK** .![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.jpg)</span><span class="sxs-lookup"><span data-stu-id="d8599-174">In the **New ASP.NET Project** dialog, select the MVC template with the default options (that includes **Individual User Accounts** as authentication method) and click **OK**.![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.jpg)</span></span>
4. <span data-ttu-id="d8599-175">Dans l’Explorateur de solutions, cliquez sur votre projet IdentityMySQLDemo et sélectionnez **gérer les Packages NuGet**.</span><span class="sxs-lookup"><span data-stu-id="d8599-175">In Solution Explorer, right-click your IdentityMySQLDemo project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="d8599-176">Dans la boîte de dialogue zone de texte de recherche, tapez **Identity.EntityFramework**.</span><span class="sxs-lookup"><span data-stu-id="d8599-176">In the search text box dialog, type **Identity.EntityFramework**.</span></span> <span data-ttu-id="d8599-177">Sélectionnez ce package dans la liste des résultats, cliquez sur **désinstallation**.</span><span class="sxs-lookup"><span data-stu-id="d8599-177">Select this package in the list of results and click **Uninstall**.</span></span> <span data-ttu-id="d8599-178">Vous devrez désinstaller le package de dépendance EntityFramework.</span><span class="sxs-lookup"><span data-stu-id="d8599-178">You will be prompted to uninstall the dependency package EntityFramework.</span></span> <span data-ttu-id="d8599-179">Cliquez sur Oui comme nous ne seront plus ce package sur cette application.</span><span class="sxs-lookup"><span data-stu-id="d8599-179">Click on Yes as we will no longer this package on this application.</span></span>
5. <span data-ttu-id="d8599-180">Cliquez avec le bouton droit sur le projet IdentityMySQLDemo, sélectionnez **ajouter**, **référence, Solution, les projets ;** sélectionnez le projet AspNet.Identity.MySQL et cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="d8599-180">Right click the IdentityMySQLDemo project, select **Add**, **Reference, Solution, Projects;** select the AspNet.Identity.MySQL project and click **OK**.</span></span>
6. <span data-ttu-id="d8599-181">Dans le projet IdentityMySQLDemo, remplacez toutes les références à</span><span class="sxs-lookup"><span data-stu-id="d8599-181">In the IdentityMySQLDemo project, replace all references to</span></span>  
    `using Microsoft.AspNet.Identity.EntityFramework;`  
   <span data-ttu-id="d8599-182">par</span><span class="sxs-lookup"><span data-stu-id="d8599-182">with</span></span>  
     `using AspNet.Identity.MySQL;`
7. <span data-ttu-id="d8599-183">Dans IdentityModels.cs, définissez **ApplicationDbContext** dériver **MySqlDatabase** et inclure un constructeur qui accepte un seul paramètre avec le nom de connexion.</span><span class="sxs-lookup"><span data-stu-id="d8599-183">In IdentityModels.cs, set **ApplicationDbContext** to derive from **MySqlDatabase** and include a constructor that take a single parameter with the connection name.</span></span>  

    [!code-csharp[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample1.cs)]
8. <span data-ttu-id="d8599-184">Ouvrez le fichier IdentityConfig.cs.</span><span class="sxs-lookup"><span data-stu-id="d8599-184">Open the IdentityConfig.cs file.</span></span> <span data-ttu-id="d8599-185">Dans le **ApplicationUserManager.Create** (méthode), remplacez l’instanciation UserManager par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="d8599-185">In the **ApplicationUserManager.Create** method, replace instantiating UserManager with the following code:</span></span>  

    [!code-csharp[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample2.cs)]
9. <span data-ttu-id="d8599-186">Ouvrez le fichier web.config et remplacez la chaîne de connexion par défaut par cette entrée en remplaçant les valeurs en surbrillance avec la chaîne de connexion de la base de données MySQL que vous avez créé sur les étapes précédentes :</span><span class="sxs-lookup"><span data-stu-id="d8599-186">Open the web.config file and replace the DefaultConnection string with this entry replacing the highlighted values with the connection string of the MySQL database you created on previous steps:</span></span>  

    [!code-xml[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample3.xml?highlight=2)]

## <a name="run-the-app-and-connect-to-the-mysql-db"></a><span data-ttu-id="d8599-187">Exécutez l’application et se connecter à la base de données MySQL</span><span class="sxs-lookup"><span data-stu-id="d8599-187">Run the app and connect to the MySQL DB</span></span>

1. <span data-ttu-id="d8599-188">Bouton droit sur le **IdentityMySQLDemo** de projet et sélectionnez **définir comme projet de démarrage**</span><span class="sxs-lookup"><span data-stu-id="d8599-188">Right click the **IdentityMySQLDemo** project and select **Set as Startup Project**</span></span>
2. <span data-ttu-id="d8599-189">Appuyez sur **Ctrl + F5** pour générer et exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="d8599-189">Press **Ctrl + F5** to build and run the app.</span></span>
3. <span data-ttu-id="d8599-190">Cliquez sur **inscrire** onglet en haut de la page.</span><span class="sxs-lookup"><span data-stu-id="d8599-190">Click on **Register** tab on the top of the page.</span></span>
4. <span data-ttu-id="d8599-191">Entrez un nouveau nom d’utilisateur et le mot de passe, puis cliquez sur **inscrire**.</span><span class="sxs-lookup"><span data-stu-id="d8599-191">Enter a new user name and password and then click on **Register**.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image8.png)
5. <span data-ttu-id="d8599-192">Le nouvel utilisateur est maintenant inscrit et connecté.</span><span class="sxs-lookup"><span data-stu-id="d8599-192">The new user is now registered and logged in.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image9.png)
6. <span data-ttu-id="d8599-193">Revenez à l’outil MySQL Workbench et inspecter le **IdentityMySQLDatabase** contenu de la table.</span><span class="sxs-lookup"><span data-stu-id="d8599-193">Go back to the MySQL Workbench tool and inspect the **IdentityMySQLDatabase** table's contents.</span></span> <span data-ttu-id="d8599-194">Inspecter le tableau des utilisateurs pour les entrées que vous inscrivez des nouveaux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="d8599-194">Inspect the users table for the entries as you register new users.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image10.png)

## <a name="next-steps"></a><span data-ttu-id="d8599-195">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="d8599-195">Next Steps</span></span>

<span data-ttu-id="d8599-196">Pour plus d’informations sur l’activation d’autres méthodes d’authentification sur cette application, consultez [créer une application ASP.NET MVC 5 avec Facebook et Google OAuth2 et OpenID Sign-on](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md).</span><span class="sxs-lookup"><span data-stu-id="d8599-196">For more information on how to enable other authentication methods on this app, refer to [Create an ASP.NET MVC 5 App with Facebook and Google OAuth2 and OpenID Sign-on](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md).</span></span>

<span data-ttu-id="d8599-197">Pour apprendre à intégrer votre base de données avec OAuth et de définir des rôles pour limiter l’accès des utilisateurs à votre application, consultez [déployer une application sécurisée ASP.NET MVC 5 avec appartenance, OAuth et base de données SQL dans Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span><span class="sxs-lookup"><span data-stu-id="d8599-197">To learn how to integrate your DB with OAuth and to set up roles to limit users access to your app, see [Deploy a Secure ASP.NET MVC 5 app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span>
