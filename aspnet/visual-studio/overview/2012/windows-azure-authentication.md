---
uid: visual-studio/overview/2012/windows-azure-authentication
title: Windows Azure Authentication | Microsoft Docs
author: Rick-Anderson
description: Outils Microsoft ASP.NET pour Windows Azure Active Directory permet de facilement activer l’authentification pour les applications web hébergées sur les Sites Web Windows Azure...
ms.author: riande
ms.date: 02/20/2013
ms.assetid: a3cef801-a54b-4ebd-93c3-55764e2e14b1
msc.legacyurl: /visual-studio/overview/2012/windows-azure-authentication
msc.type: authoredcontent
ms.openlocfilehash: 46dd491b275b43be4e76c029b53f9454146663ae
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65126191"
---
# <a name="windows-azure-authentication"></a><span data-ttu-id="d3e55-103">Authentification Windows Azure</span><span class="sxs-lookup"><span data-stu-id="d3e55-103">Windows Azure Authentication</span></span>

<span data-ttu-id="d3e55-104">par [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="d3e55-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="d3e55-105">Outils de Microsoft ASP.NET pour Windows Azure Active Directory fait simple activer l’authentification pour les applications web hébergées sur [Sites Web Windows Azure](https://www.windowsazure.com/home/features/web-sites/).</span><span class="sxs-lookup"><span data-stu-id="d3e55-105">Microsoft ASP.NET tools for Windows Azure Active Directory makes it simple to enable authentication for web applications hosted on [Windows Azure Web Sites](https://www.windowsazure.com/home/features/web-sites/).</span></span> <span data-ttu-id="d3e55-106">Vous pouvez utiliser l’authentification Windows Azure pour authentifier les utilisateurs d’Office 365 à partir de votre organisation, les comptes d’entreprise synchronisés à partir de votre annuaire local Active Directory ou les utilisateurs créés dans votre propre domaine personnalisé de Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d3e55-106">You can use Windows Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Windows Azure Active Directory domain.</span></span> <span data-ttu-id="d3e55-107">Activation de l’authentification de Windows Azure configure votre application pour authentifier les utilisateurs à l’aide d’un seul [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) locataire.</span><span class="sxs-lookup"><span data-stu-id="d3e55-107">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>
>
> <span data-ttu-id="d3e55-108">L’outil ASP.NET Windows Azure Authentication n’est pas pris en charge pour les rôles web dans un service cloud, mais nous prévoyons de le faire dans une version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="d3e55-108">The ASP.NET Windows Azure Authentication tool is not supported for web roles in a cloud service but we plan to do so in a future release.</span></span> <span data-ttu-id="d3e55-109">[Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) est pris en charge dans les rôles web Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="d3e55-109">[Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) is supported in Windows Azure web roles.</span></span>
>
> <span data-ttu-id="d3e55-110">Pour plus d’informations sur la configuration de la synchronisation entre votre annuaire local Active Directory et votre locataire Windows Azure Active Directory, consultez [utiliser AD FS 2.0 pour implémenter et gérer l’authentification unique](https://technet.microsoft.com/library/jj205462.aspx).</span><span class="sxs-lookup"><span data-stu-id="d3e55-110">For details on how to setup synchronization between your on-premise Active Directory and your Windows Azure Active Directory tenant please see [Use AD FS 2.0 to implement and manage single sign-on](https://technet.microsoft.com/library/jj205462.aspx).</span></span>
>
> <span data-ttu-id="d3e55-111">Windows Azure Active Directory est actuellement disponible en tant qu’un [libre service en version préliminaire](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="d3e55-111">Windows Azure Active Directory is currently available as a [free preview service](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>

## <a name="requirements"></a><span data-ttu-id="d3e55-112">Configuration requise :</span><span class="sxs-lookup"><span data-stu-id="d3e55-112">Requirements:</span></span>

- <span data-ttu-id="d3e55-113">Visual Studio 2012 ou [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span><span class="sxs-lookup"><span data-stu-id="d3e55-113">Visual Studio 2012 or [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span></span>
- <span data-ttu-id="d3e55-114">[Extensions pour Visual Studio 2012 d’outils Web](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) ou [Web Tools Extensions pour Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="d3e55-114">[Web Tools Extensions for Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) or [Web Tools Extensions for Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span></span>
- <span data-ttu-id="d3e55-115">[Outils de Microsoft ASP.NET pour Windows Azure Active Directory – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) ou [des outils Microsoft ASP.NET pour Windows Azure Active Directory – Visual Studio Express 2012 pour le Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span><span class="sxs-lookup"><span data-stu-id="d3e55-115">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) or [Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio Express 2012 for Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span></span>

## <a name="create-an-aspnet-web-application-with-visual-studio-2012"></a><span data-ttu-id="d3e55-116">Créer une Application Web ASP.NET avec Visual Studio 2012</span><span class="sxs-lookup"><span data-stu-id="d3e55-116">Create an ASP.NET Web Application with Visual Studio 2012</span></span>

<span data-ttu-id="d3e55-117">Vous pouvez créer n’importe quelle Application Web avec Visual Studio 2012, ce didacticiel utilise le modèle d’intranet ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="d3e55-117">You can create any Web Application with Visual Studio 2012, this tutorial uses the ASP.NET MVC intranet template.</span></span>

1. <span data-ttu-id="d3e55-118">Créer une nouvelle Application Intranet ASP.NET MVC 4 et acceptez toutes les valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="d3e55-118">Create a new ASP.NET MVC 4 Intranet Application and accept all the defaults.</span></span> <span data-ttu-id="d3e55-119">(Il doit être un In **tra** net et non dans **RET** projet net).</span><span class="sxs-lookup"><span data-stu-id="d3e55-119">(It must be an In **tra** net and not In **ter** net project).</span></span>
     ![](windows-azure-authentication/_static/image1.png)

## <a name="enable-window-azure-authentication-when-you-are-a-global-administrator-of-the-tenet"></a><span data-ttu-id="d3e55-120">Activer l’authentification de Windows Azure (lorsque vous êtes un administrateur du principe général)</span><span class="sxs-lookup"><span data-stu-id="d3e55-120">Enable Window Azure Authentication (When you are a Global Administrator of the Tenet)</span></span>

<span data-ttu-id="d3e55-121">Si vous n’avez pas d’un locataire Windows Azure Active Directory existant (par exemple, via un compte Office 365 existant), vous pouvez créer un nouveau locataire en vous connectant à un [nouveau compte Windows Azure Active Directory](http://g.microsoftonline.com/0AX00en/5).</span><span class="sxs-lookup"><span data-stu-id="d3e55-121">If you do not have an existing Windows Azure Active Directory tenant (For example, through an existing Office 365 account) you can create a new tenant by signing up for a [new Windows Azure Active Directory account](http://g.microsoftonline.com/0AX00en/5).</span></span>

1. <span data-ttu-id="d3e55-122">Dans le menu projet, sélectionnez **activer l’authentification Windows Azure**:</span><span class="sxs-lookup"><span data-stu-id="d3e55-122">From the Project menu select **Enable Windows Azure Authentication**:</span></span>

   ![](windows-azure-authentication/_static/image2.png)

2. <span data-ttu-id="d3e55-123">Entrez le domaine de votre locataire Windows Azure Active Directory (par exemple, contoso.onmicrosoft.com) et cliquez sur **activer**:</span><span class="sxs-lookup"><span data-stu-id="d3e55-123">Enter the domain for your Windows Azure Active Directory tenant (for example, contoso.onmicrosoft.com) and click **Enable**:</span></span>

![](windows-azure-authentication/_static/image3.png)

3. <span data-ttu-id="d3e55-124">Dans l’authentification Web boîte de dialogue de connexion en tant qu’administrateur pour votre locataire Windows Azure Active Directory :</span><span class="sxs-lookup"><span data-stu-id="d3e55-124">In the Web Authentication dialog sign in as an administrator for your Windows Azure Active Directory tenant:</span></span>

   ![](windows-azure-authentication/_static/image4.png)

![](windows-azure-authentication/_static/image5.png)

## <a name="enable-window-azure-by-a-non-administrator-of-the-tenet"></a><span data-ttu-id="d3e55-125">Activer Windows Azure à un compte non administrateur du principe</span><span class="sxs-lookup"><span data-stu-id="d3e55-125">Enable Window Azure by a non-administrator of the Tenet</span></span>

<span data-ttu-id="d3e55-126">Si vous n’avez pas de privilèges d’administrateur Global pour votre locataire Windows Azure Active Directory, vous pouvez décocher la case à cocher pour l’approvisionnement de l’application.</span><span class="sxs-lookup"><span data-stu-id="d3e55-126">If you do not have Global Administrator privilege for your Windows Azure Active Directory tenant, you can uncheck the checkbox for provisioning the application.</span></span>

![](windows-azure-authentication/_static/image6.png)

<span data-ttu-id="d3e55-127">La boîte de dialogue affichera le **domaine**, **Id de Principal de l’Application** et **URL de réponse** qui sont requis pour l’approvisionnement de l’application avec Azure Active Directory principe.</span><span class="sxs-lookup"><span data-stu-id="d3e55-127">The dialog will display the **Domain**, **Application Principal Id** and **Reply URL** which are required for provisioning the application with an Azure Active Directory tenet.</span></span> <span data-ttu-id="d3e55-128">Vous devez donner à ces informations à une personne qui a des privilèges suffisants pour configurer l’application.</span><span class="sxs-lookup"><span data-stu-id="d3e55-128">You need to give this information to someone who has sufficient privilege to provision the application.</span></span> <span data-ttu-id="d3e55-129">Consultez[comment implémenter l’authentification unique avec Windows Azure Active Directory - Application ASP.NET](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) pour plus d’informations sur la façon d’utiliser l’applet de commande pour créer le principal du service manuellement.</span><span class="sxs-lookup"><span data-stu-id="d3e55-129">See[How to implement single sign-on with Windows Azure Active Directory - ASP.NET Application](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) for details on how to use cmdlet to create the service principal manually.</span></span>
<span data-ttu-id="d3e55-130">Une fois que l’application a été configurée correctement, vous pouvez cliquer sur **continuer à mettre à jour web.config avec les paramètres sélectionnés**.</span><span class="sxs-lookup"><span data-stu-id="d3e55-130">Once the application has been successfully provisioned, you can click on **Continue to update web.config with the selected settings**.</span></span> <span data-ttu-id="d3e55-131">Si vous souhaitez continuer à développer l’application lors de l’attente pour l’approvisionnement se produise, vous pouvez cliquer sur **fermer pour mémoriser les paramètres dans le fichier projet**.</span><span class="sxs-lookup"><span data-stu-id="d3e55-131">If you want to continue developing the application while waiting for provisioning to happen, you can click **Close to remember the settings in project file**.</span></span> <span data-ttu-id="d3e55-132">La prochaine fois vous appeler activer l’authentification Windows Azure et décochez la case à cocher approvisionnement, vous verrez les mêmes paramètres et vous pouvez cliquer sur **continuer**, puis cliquez sur, **appliquer ces paramètres dans le fichier web.config**.</span><span class="sxs-lookup"><span data-stu-id="d3e55-132">The next time you invoke Enable Windows Azure Authentication and uncheck the provisioning checkbox, you will see the same settings and you can click **Continue**, then click, **Apply these settings in web.config**.</span></span>

1. <span data-ttu-id="d3e55-133">Patienter pendant que votre application est configurée pour l’authentification Windows Azure et configurée avec Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d3e55-133">Wait while your application is configured for Windows Azure Authentication and provisioned with Windows Azure Active Directory.</span></span>
2. <span data-ttu-id="d3e55-134">Une fois l’authentification Windows Azure a été activée pour votre application, cliquez sur **fermer :**</span><span class="sxs-lookup"><span data-stu-id="d3e55-134">Once Windows Azure Authentication has been enabled for your application, click **Close:**</span></span>

    ![](windows-azure-authentication/_static/image7.png)
3. <span data-ttu-id="d3e55-135">Appuyez sur F5 pour exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="d3e55-135">Hit F5 to run your application.</span></span> <span data-ttu-id="d3e55-136">Il est possible que vous devez obtenir automatiquement redirigé vers la page de connexion.</span><span class="sxs-lookup"><span data-stu-id="d3e55-136">You should automatically get redirected to login page.</span></span> <span data-ttu-id="d3e55-137">Utiliser les informations d’identification utilisateur de répertoire principe pour se connecter à l’application...</span><span class="sxs-lookup"><span data-stu-id="d3e55-137">Use the directory tenet user credentials to login to the application..</span></span>

    ![](windows-azure-authentication/_static/image1.jpg)
4. <span data-ttu-id="d3e55-138">Étant donné que votre application utilise actuellement un certificat auto-signé de test vous recevrez un avertissement à partir du navigateur le certificat n’a pas été émis par une autorité de certification approuvée.</span><span class="sxs-lookup"><span data-stu-id="d3e55-138">Because your application is currently using a self-signed test certificate you will receive a warning from the browser that the certificate was not issued by a trusted certificate authority.</span></span>

    <span data-ttu-id="d3e55-139">Cet avertissement peut être ignoré en toute sécurité pendant le développement local en cliquant sur **poursuivre sur ce site Web :**</span><span class="sxs-lookup"><span data-stu-id="d3e55-139">This warning can be safely ignored during local development by clicking **Continue to this website:**</span></span>

    ![](windows-azure-authentication/_static/image8.png)
5. <span data-ttu-id="d3e55-140">Vous avez maintenant correctement connecté à votre application à l’aide de l’authentification Windows Azure !</span><span class="sxs-lookup"><span data-stu-id="d3e55-140">You have now successfully logged in to your application using Windows Azure Authentication!</span></span>

    ![](windows-azure-authentication/_static/image2.jpg)

<span data-ttu-id="d3e55-141">L’activation de Windows Azure authentication apporte les modifications suivantes à votre application :</span><span class="sxs-lookup"><span data-stu-id="d3e55-141">Enabling Windows Azure authentication makes the following changes to your application:</span></span>

- <span data-ttu-id="d3e55-142">Une falsification de requête Anti-Cross-Site ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) classe ( *application\_Start\AntiXsrfConfig.cs* ) est ajouté à votre projet.</span><span class="sxs-lookup"><span data-stu-id="d3e55-142">An Anti-Cross-Site Request Forgery ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) class ( *App\_Start\AntiXsrfConfig.cs* ) is added to your project.</span></span>
- <span data-ttu-id="d3e55-143">Les packages NuGet `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` est ajouté à votre projet.</span><span class="sxs-lookup"><span data-stu-id="d3e55-143">The NuGet packages `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` is added to your project.</span></span>
- <span data-ttu-id="d3e55-144">Paramètres de Windows Identity Foundation dans votre application seront configurés pour accepter les jetons de sécurité à partir de votre locataire Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d3e55-144">Windows Identity Foundation settings in your application will be configured to accept security tokens from your Windows Azure Active Directory tenant.</span></span> <span data-ttu-id="d3e55-145">Cliquez sur l’image ci-dessous pour afficher une vue développée des modifications apportées à la *Web.config* fichier.</span><span class="sxs-lookup"><span data-stu-id="d3e55-145">Click on the image below to see an expanded view of the changes made to the *Web.config* file.</span></span>

     ![](windows-azure-authentication/_static/image9.png)
- <span data-ttu-id="d3e55-146">Un principal de service pour votre application dans votre locataire Windows Azure Active Directory est approvisionné.</span><span class="sxs-lookup"><span data-stu-id="d3e55-146">A service principal for your application in your Windows Azure Active Directory tenant will be provisioned.</span></span>
- <span data-ttu-id="d3e55-147">HTTPS est activé.</span><span class="sxs-lookup"><span data-stu-id="d3e55-147">HTTPS is enabled.</span></span>

## <a name="deploy-the-application-to-windows-azure"></a><span data-ttu-id="d3e55-148">Déployer l’application sur Windows Azure</span><span class="sxs-lookup"><span data-stu-id="d3e55-148">Deploy the application to Windows Azure</span></span>

<span data-ttu-id="d3e55-149">Pour obtenir des instructions complètes, consultez [déploiement d’une Application Web de ASP.NET sur un Site Web de Windows Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="d3e55-149">For complete instructions, see [Deploying an ASP.NET Web Application to a Windows Azure Web Site](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>

<span data-ttu-id="d3e55-150">Pour publier une application à l’aide de l’authentification sur un Site Web Azure de Windows Azure :</span><span class="sxs-lookup"><span data-stu-id="d3e55-150">To publish an application using Windows Azure Authentication to an Azure Web Site:</span></span>

1. <span data-ttu-id="d3e55-151">Cliquez avec le bouton droit sur votre application et sélectionnez **publier :**</span><span class="sxs-lookup"><span data-stu-id="d3e55-151">Right click on your application and select **Publish:**</span></span>

    ![](windows-azure-authentication/_static/image3.jpg)
2. <span data-ttu-id="d3e55-152">À partir de la boîte de dialogue Publier le site Web télécharger et importer un profil de publication pour votre Site Web Azure.</span><span class="sxs-lookup"><span data-stu-id="d3e55-152">From the Publish Web dialog download and import a publishing profile for your Azure Web Site.</span></span>

    ![](windows-azure-authentication/_static/image4.jpg)
3. <span data-ttu-id="d3e55-153">Le **connexion** onglet montre le **URL de Destination** (URL publique pour votre application accessible sur).</span><span class="sxs-lookup"><span data-stu-id="d3e55-153">The **Connection** tab shows the **Destination URL** (the public facing URL for your application).</span></span> <span data-ttu-id="d3e55-154">Cliquez sur **valider la connexion** pour tester votre connexion :</span><span class="sxs-lookup"><span data-stu-id="d3e55-154">Click **Validate Connection** to test your connection:</span></span>

    ![](windows-azure-authentication/_static/image5.jpg)
4. <span data-ttu-id="d3e55-155">Si vous avez publié sur ce Site Web Azure précédemment envisagez de vérifier le **supprimer les fichiers supplémentaires à la destination** paramètre pour que votre application publie correctement.</span><span class="sxs-lookup"><span data-stu-id="d3e55-155">If you have published to this Azure Web Site previously consider checking the **Remove additional files at destination** setting to ensure your application publishes cleanly.</span></span> <span data-ttu-id="d3e55-156">Notez que le **activer l’authentification Windows Azure** case à cocher est activée.</span><span class="sxs-lookup"><span data-stu-id="d3e55-156">Notice the **Enable Windows Azure Authentication** check box is selected.</span></span>

    ![](windows-azure-authentication/_static/image10.png)
5. <span data-ttu-id="d3e55-157">Facultatif : Sur le **aperçu** onglet, cliquez sur **démarrer l’aperçu** pour afficher les fichiers déployés.</span><span class="sxs-lookup"><span data-stu-id="d3e55-157">Optional: On the **Preview** tab click **Start Preview** to see the files deployed.</span></span>

    ![](windows-azure-authentication/_static/image6.jpg)
6. <span data-ttu-id="d3e55-158">Cliquez sur **publier.**</span><span class="sxs-lookup"><span data-stu-id="d3e55-158">Click **Publish.**</span></span>

    <span data-ttu-id="d3e55-159">Vous êtes invité à activer l’authentification Windows Azure pour l’hôte cible.</span><span class="sxs-lookup"><span data-stu-id="d3e55-159">You will be prompted to enable Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="d3e55-160">Cliquez sur **activer** pour continuer :</span><span class="sxs-lookup"><span data-stu-id="d3e55-160">Click **Enable** to continue:</span></span>

    ![](windows-azure-authentication/_static/image11.png)
7. <span data-ttu-id="d3e55-161">Entrez vos informations d’identification d’administrateur pour votre locataire Windows Azure Active Directory :</span><span class="sxs-lookup"><span data-stu-id="d3e55-161">Enter your administrator credentials for your Windows Azure Active Directory tenant:</span></span>

    ![](windows-azure-authentication/_static/image7.jpg)
8. <span data-ttu-id="d3e55-162">Une fois que votre application a été publiée, un navigateur s’ouvre sur le site web publié.</span><span class="sxs-lookup"><span data-stu-id="d3e55-162">Once your application has been successfully published, a browser will open to the published web site.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d3e55-163">Il peut prendre jusqu'à cinq minutes (généralement doit moins) pour votre application soit entièrement configurée avec Windows Azure Active Directory après l’activation de l’authentification Windows Azure pour l’hôte cible.</span><span class="sxs-lookup"><span data-stu-id="d3e55-163">It may take up to five minutes (typically must less) for your application to be fully provisioned with Windows Azure Active Directory after enabling Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="d3e55-164">Lorsque vous exécutez tout d’abord votre application si vous recevez l’erreur ACS50001 : Partie de confiance avec le nom « [realm] » est introuvable, puis patientez quelques minutes et essayez à nouveau l’application en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="d3e55-164">When you first run your application if you receive error ACS50001: Relying party with name ‘[realm]' was not found, then wait a few minutes and try running the application again.</span></span>
9. <span data-ttu-id="d3e55-165">Lorsque vous y êtes invité, connectez-vous en tant qu’utilisateur dans votre répertoire :</span><span class="sxs-lookup"><span data-stu-id="d3e55-165">When prompted, log in as a user in your directory:</span></span>

    ![](windows-azure-authentication/_static/image8.jpg)
10. <span data-ttu-id="d3e55-166">Vous avez maintenant correctement connecté à votre Azure hébergé l’application à l’aide de l’authentification Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="d3e55-166">You have now successfully logged into your Azure hosted application using Windows Azure Authentication.</span></span>

     ![](windows-azure-authentication/_static/image9.jpg)

## <a name="known-issues"></a><span data-ttu-id="d3e55-167">Problèmes connus</span><span class="sxs-lookup"><span data-stu-id="d3e55-167">Known Issues</span></span>

#### <a name="role-based-authorization-fails-when-using-windows-azure-authentication"></a><span data-ttu-id="d3e55-168">Autorisation basée sur un rôle échoue lors de l’utilisation de l’authentification Windows Azure</span><span class="sxs-lookup"><span data-stu-id="d3e55-168">Role-based authorization fails when using Windows Azure Authentication</span></span>

<span data-ttu-id="d3e55-169">L’authentification Windows Azure ne fournit pas actuellement la revendication de rôle nécessaires afin que l’autorisation basée sur le rôle peut être effectuée.</span><span class="sxs-lookup"><span data-stu-id="d3e55-169">Windows Azure Authentication does not currently provide the necessary role claim so that role-based authorization can be performed.</span></span> <span data-ttu-id="d3e55-170">Le rôle de l’utilisateur authentifié doit être récupéré manuellement à partir de Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d3e55-170">The role of the authenticated user must be manually retrieved from Windows Azure Active Directory.</span></span>

#### <a name="browsing-to-an-application-with-windows-azure-authentication-results-in-the-error-acs20016-the-domain-of-the-logged-in-user-livecom-does-not-match-any-allowed-domain-of-this-sts"></a><span data-ttu-id="d3e55-171">Résultats de navigation à une application avec Windows Azure Authentication dans l’erreur « ACS20016 le domaine de l’utilisateur connecté (live.com) ne correspond pas à toute autorisé domaine de ce STS »</span><span class="sxs-lookup"><span data-stu-id="d3e55-171">Browsing to an application with Windows Azure Authentication results in the error "ACS20016 The domain of the logged in user (live.com) does not match any allowed domain of this STS"</span></span>

<span data-ttu-id="d3e55-172">Si vous êtes déjà connecté à un Account Microsoft (par exemple hotmail.com, live.com, outlook.com) et que vous tentez d’accéder à une application qui a activé l’authentification Windows Azure vous pouvez obtenir une réponse de 400 erreur, car le domaine de votre Account Microsoft n’est pas reconnu par Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d3e55-172">If you are already logged in to a Microsoft Account (for example hotmail.com, live.com, outlook.com) and you attempt to access an application that has enabled Windows Azure Authentication you may get a 400 error response because the domain of your Microsoft Account is not recognized by Windows Azure Active Directory.</span></span> <span data-ttu-id="d3e55-173">Pour vous connecter à l’application, se déconnecter de votre Account Microsoft premier.</span><span class="sxs-lookup"><span data-stu-id="d3e55-173">To log into the application, log out from your Microsoft Account first.</span></span>

#### <a name="logging-into-an-application-with-windows-azure-authentication-enabled-and-a-x509certificatevalidationmode-other-than-none-results-in-certificate-validation-errors-for-the-accountsaccesscontrolwindowsnet-certificate"></a><span data-ttu-id="d3e55-174">Journalisation dans une application avec authentification Windows Azure est activée et un X509CertificateValidationMode autre que None entraîne dans les erreurs de validation de certificat pour le certificat accounts.accesscontrol.windows.net</span><span class="sxs-lookup"><span data-stu-id="d3e55-174">Logging into an application with Windows Azure Authentication enabled and a X509CertificateValidationMode other than None results in certificate validation errors for the accounts.accesscontrol.windows.net certificate</span></span>

<span data-ttu-id="d3e55-175">Validation du certificat n’est pas obligatoire et doit rester désactivée.</span><span class="sxs-lookup"><span data-stu-id="d3e55-175">Certificate validation is not required and should be left disabled.</span></span> <span data-ttu-id="d3e55-176">L’empreinte numérique du certificat de l’émetteur est validé par le WSFederationAuthenticationModule.</span><span class="sxs-lookup"><span data-stu-id="d3e55-176">The thumbprint of the issuer certificate is validated by the WSFederationAuthenticationModule.</span></span>

#### <a name="when-attempting-to-enable-windows-azure-authentication-the-web-authentication-dialog-shows-the-error-acs20016-the-domain-of-the-logged-in-user-contosoonmicrosoftcom-does-not-match-any-allowed-domain-of-this-sts"></a><span data-ttu-id="d3e55-177">Lorsque vous tentez d’activer l’authentification de Windows Azure la boîte de dialogue d’authentification Web affiche l’erreur « ACS20016 : Le domaine de l’utilisateur connecté (contoso.onmicrosoft.com) ne correspond pas à aucun domaine autorisé de ce STS. »</span><span class="sxs-lookup"><span data-stu-id="d3e55-177">When attempting to enable Windows Azure Authentication the Web Authentication dialog shows the error "ACS20016: The domain of the logged in user (contoso.onmicrosoft.com) does not match any allowed domain of this STS."</span></span>

<span data-ttu-id="d3e55-178">Vous pouvez voir cette erreur lorsque vous avez précédemment connecté avec succès à l’aide d’un compte Windows Azure Active Directory différent de dans le même processus Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d3e55-178">You may see this error when you have previously successfully logged in using a different Windows Azure Active Directory account from within the same Visual Studio process.</span></span> <span data-ttu-id="d3e55-179">Déconnectez-vous du compte spécifié, ou redémarrez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d3e55-179">Log out from the specified account or restart Visual Studio.</span></span> <span data-ttu-id="d3e55-180">Si connecté précédemment et sélectionné l’option « Maintenir la connexion » vous devez effacer les cookies de votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="d3e55-180">If you previously logged in and selected the option to "Keep me signed in" then you may need to clear your browser cookies.</span></span>

## <a name="acs20012-the-request-is-not-a-valid-ws-federation-protocol-message"></a><span data-ttu-id="d3e55-181">ACS20012: La demande n’est pas un message de protocole WS-Federation valid</span><span class="sxs-lookup"><span data-stu-id="d3e55-181">ACS20012: The request is not a valid WS-Federation protocol message</span></span>

<span data-ttu-id="d3e55-182">Cela peut se produire si vous êtes déjà connecté avec certains autres ID Microsoft à un des services Azure.</span><span class="sxs-lookup"><span data-stu-id="d3e55-182">This can happen if you are already logged in with some other Microsoft ID to one of the Azure services.</span></span> <span data-ttu-id="d3e55-183">Fenêtre de navigateur d’utilisation privée telles que InPrivate dans Internet Explorer ou Incognito dans Chrome ou effacer tous les cookies.</span><span class="sxs-lookup"><span data-stu-id="d3e55-183">Use Private browser window like InPrivate in IE or Incognito in Chrome or clear all the cookies.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="d3e55-184">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="d3e55-184">Additional Resources</span></span>

- <span data-ttu-id="d3e55-185">[Outils de Microsoft ASP.NET pour Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="d3e55-185">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="d3e55-186">Windows Azure fonctionnalités : Identity</span><span class="sxs-lookup"><span data-stu-id="d3e55-186">Windows Azure Features: Identity</span></span>](https://docs.microsoft.com/azure/active-directory/)
- [<span data-ttu-id="d3e55-187">TechNet : Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d3e55-187">TechNet: Windows Azure Active Directory</span></span>](https://technet.microsoft.com/library/hh967619.aspx)
- [<span data-ttu-id="d3e55-188">Windows Azure Active Directory : Développer des applications pour votre organisation</span><span class="sxs-lookup"><span data-stu-id="d3e55-188">Windows Azure Active Directory: Develop Apps for your organization</span></span>](https://activedirectory.windowsazure.com/Develop/Single-Tenant.aspx)
- [<span data-ttu-id="d3e55-189">Windows Azure Active Directory : Développer des applications pour plusieurs organisations</span><span class="sxs-lookup"><span data-stu-id="d3e55-189">Windows Azure Active Directory: Develop Apps for multiple organizations</span></span>](https://activedirectory.windowsazure.com/Develop/Multi-Tenant.aspx)
- [<span data-ttu-id="d3e55-190">Comment implémenter l’authentification unique avec Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d3e55-190">How to implement single sign-on with Windows Azure Active Directory</span></span>](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect)
- <span data-ttu-id="d3e55-191">[Single Sign-On avec Windows Azure Active Directory : présentation approfondie de](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="d3e55-191">[Single Sign-On with Windows Azure Active Directory: a Deep Dive](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="d3e55-192">Utiliser AD FS 2.0 pour implémenter et gérer l’authentification unique</span><span class="sxs-lookup"><span data-stu-id="d3e55-192">Use AD FS 2.0 to implement and manage single sign-on</span></span>](https://technet.microsoft.com/library/jj205462.aspx)
